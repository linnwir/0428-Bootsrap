/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.2.0 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/requirejs/LICENSE
 */
var requirejs,require,define;!function(global){function commentReplace(a,b,c,d){return d||""}function isFunction(a){return"[object Function]"===ostring.call(a)}function isArray(a){return"[object Array]"===ostring.call(a)}function each(a,b){if(a){var c;for(c=0;c<a.length&&(!a[c]||!b(a[c],c,a));c+=1);}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1&&(!a[c]||!b(a[c],c,a));c-=1);}}function hasProp(a,b){return hasOwn.call(a,b)}function getOwn(a,b){return hasProp(a,b)&&a[b]}function eachProp(a,b){var c;for(c in a)if(hasProp(a,c)&&b(a[c],c))break}function mixin(a,b,c,d){return b&&eachProp(b,function(b,e){!c&&hasProp(a,e)||(!d||"object"!=typeof b||!b||isArray(b)||isFunction(b)||b instanceof RegExp?a[e]=b:(a[e]||(a[e]={}),mixin(a[e],b,c,d)))}),a}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(a){throw a}function getGlobal(a){if(!a)return a;var b=global;return each(a.split("."),function(a){b=b[a]}),b}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);return e.requireType=a,e.requireModules=d,c&&(e.originalError=c),e}function newContext(a){function b(a){var b,c;for(b=0;b<a.length;b++)if(c=a[b],"."===c)a.splice(b,1),b-=1;else if(".."===c){if(0===b||1===b&&".."===a[2]||".."===a[b-1])continue;b>0&&(a.splice(b-1,2),b-=2)}}function c(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=c&&c.split("/"),r=x.map,s=r&&r["*"];if(a&&(a=a.split("/"),k=a.length-1,x.nodeIdCompat&&jsSuffixRegExp.test(a[k])&&(a[k]=a[k].replace(jsSuffixRegExp,"")),"."===a[0].charAt(0)&&q&&(p=q.slice(0,q.length-1),a=p.concat(a)),b(a),a=a.join("/")),d&&r&&(q||s)){g=a.split("/");a:for(h=g.length;h>0;h-=1){if(j=g.slice(0,h).join("/"),q)for(i=q.length;i>0;i-=1)if(f=getOwn(r,q.slice(0,i).join("/")),f&&(f=getOwn(f,j))){l=f,m=h;break a}!n&&s&&getOwn(s,j)&&(n=getOwn(s,j),o=h)}!l&&n&&(l=n,m=o),l&&(g.splice(0,m,l),a=g.join("/"))}return e=getOwn(x.pkgs,a),e?e:a}function d(a){isBrowser&&each(scripts(),function(b){return b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===u.contextName?(b.parentNode.removeChild(b),!0):void 0})}function e(a){var b=getOwn(x.paths,a);return b&&isArray(b)&&b.length>1?(b.shift(),u.require.undef(a),u.makeRequire(null,{skipMap:!0})([a]),!0):void 0}function f(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function g(a,b,d,e){var g,h,i,j,k=null,l=b?b.name:null,m=a,n=!0,o="";return a||(n=!1,a="_@r"+(F+=1)),j=f(a),k=j[0],a=j[1],k&&(k=c(k,l,e),h=getOwn(C,k)),a&&(k?o=h&&h.normalize?h.normalize(a,function(a){return c(a,l,e)}):-1===a.indexOf("!")?c(a,l,e):a:(o=c(a,l,e),j=f(o),k=j[0],o=j[1],d=!0,g=u.nameToUrl(o))),i=!k||h||d?"":"_unnormalized"+(G+=1),{prefix:k,name:o,parentMap:b,unnormalized:!!i,url:g,originalName:m,isDefine:n,id:(k?k+"!"+o:o)+i}}function h(a){var b=a.id,c=getOwn(y,b);return c||(c=y[b]=new u.Module(a)),c}function i(a,b,c){var d=a.id,e=getOwn(y,d);!hasProp(C,d)||e&&!e.defineEmitComplete?(e=h(a),e.error&&"error"===b?c(e.error):e.on(b,c)):"defined"===b&&c(C[d])}function j(a,b){var c=a.requireModules,d=!1;b?b(a):(each(c,function(b){var c=getOwn(y,b);c&&(c.error=a,c.events.error&&(d=!0,c.emit("error",a)))}),d||req.onError(a))}function k(){globalDefQueue.length&&(each(globalDefQueue,function(a){var b=a[0];"string"==typeof b&&(u.defQueueMap[b]=!0),B.push(a)}),globalDefQueue=[])}function l(a){delete y[a],delete z[a]}function m(a,b,c){var d=a.map.id;a.error?a.emit("error",a.error):(b[d]=!0,each(a.depMaps,function(d,e){var f=d.id,g=getOwn(y,f);!g||a.depMatched[e]||c[f]||(getOwn(b,f)?(a.defineDep(e,C[f]),a.check()):m(g,b,c))}),c[d]=!0)}function n(){var a,b,c=1e3*x.waitSeconds,f=c&&u.startTime+c<(new Date).getTime(),g=[],h=[],i=!1,k=!0;if(!s){if(s=!0,eachProp(z,function(a){var c=a.map,j=c.id;if(a.enabled&&(c.isDefine||h.push(a),!a.error))if(!a.inited&&f)e(j)?(b=!0,i=!0):(g.push(j),d(j));else if(!a.inited&&a.fetched&&c.isDefine&&(i=!0,!c.prefix))return k=!1}),f&&g.length)return a=makeError("timeout","Load timeout for modules: "+g,null,g),a.contextName=u.contextName,j(a);k&&each(h,function(a){m(a,{},{})}),f&&!b||!i||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,n()},50)),s=!1}}function o(a){hasProp(C,a[0])||h(g(a[0],null,!0)).init(a[1],a[2])}function p(a,b,c,d){a.detachEvent&&!isOpera?d&&a.detachEvent(d,b):a.removeEventListener(c,b,!1)}function q(a){var b=a.currentTarget||a.srcElement;return p(b,u.onScriptLoad,"load","onreadystatechange"),p(b,u.onScriptError,"error"),{node:b,id:b&&b.getAttribute("data-requiremodule")}}function r(){var a;for(k();B.length;){if(a=B.shift(),null===a[0])return j(makeError("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));o(a)}u.defQueueMap={}}var s,t,u,v,w,x={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},y={},z={},A={},B=[],C={},D={},E={},F=1,G=1;return v={require:function(a){return a.require?a.require:a.require=u.makeRequire(a.map)},exports:function(a){return a.usingExports=!0,a.map.isDefine?a.exports?C[a.map.id]=a.exports:a.exports=C[a.map.id]={}:void 0},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return getOwn(x.config,a.map.id)||{}},exports:a.exports||(a.exports={})}}},t=function(a){this.events=getOwn(A,a.id)||{},this.map=a,this.shim=getOwn(x.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},t.prototype={init:function(a,b,c,d){d=d||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=bind(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,u.startTime=(new Date).getTime();var a=this.map;return this.shim?void u.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return a.prefix?this.callPlugin():this.load()})):a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;D[a]||(D[a]=!0,u.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id,d=this.depExports,e=this.exports,f=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(f)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{e=u.execCb(c,f,d,e)}catch(b){a=b}else e=u.execCb(c,f,d,e);if(this.map.isDefine&&void 0===e&&(b=this.module,b?e=b.exports:this.usingExports&&(e=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",j(this.error=a)}else e=f;if(this.exports=e,this.map.isDefine&&!this.ignore&&(C[c]=e,req.onResourceLoad)){var g=[];each(this.depMaps,function(a){g.push(a.normalizedMap||a)}),req.onResourceLoad(u,this.map,g)}l(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(u.defQueueMap,c)||this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=g(a.prefix);this.depMaps.push(d),i(d,"defined",bind(this,function(d){var e,f,k,m=getOwn(E,this.map.id),n=this.map.name,o=this.map.parentMap?this.map.parentMap.name:null,p=u.makeRequire(a.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(d.normalize&&(n=d.normalize(n,function(a){return c(a,o,!0)})||""),f=g(a.prefix+"!"+n,this.map.parentMap),i(f,"defined",bind(this,function(a){this.map.normalizedMap=f,this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),k=getOwn(y,f.id),void(k&&(this.depMaps.push(f),this.events.error&&k.on("error",bind(this,function(a){this.emit("error",a)})),k.enable()))):m?(this.map.url=u.nameToUrl(m),void this.load()):(e=bind(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=bind(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],eachProp(y,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&l(a.map.id)}),j(a)}),e.fromText=bind(this,function(c,d){var f=a.name,i=g(f),k=useInteractive;d&&(c=d),k&&(useInteractive=!1),h(i),hasProp(x.config,b)&&(x.config[f]=x.config[b]);try{req.exec(c)}catch(a){return j(makeError("fromtexteval","fromText eval for "+b+" failed: "+a,a,[b]))}k&&(useInteractive=!0),this.depMaps.push(i),u.completeLoad(f),p([f],e)}),void d.load(a.name,p,e,x))})),u.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){z[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(a,b){var c,d,e;if("string"==typeof a){if(a=g(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,e=getOwn(v,a.id))return void(this.depExports[b]=e(this));this.depCount+=1,i(a,"defined",bind(this,function(a){this.undefed||(this.defineDep(b,a),this.check())})),this.errback?i(a,"error",bind(this,this.errback)):this.events.error&&i(a,"error",bind(this,function(a){this.emit("error",a)}))}c=a.id,d=y[c],hasProp(v,c)||!d||d.enabled||u.enable(a,this)})),eachProp(this.pluginMaps,bind(this,function(a){var b=getOwn(y,a.id);b&&!b.enabled&&u.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},u={config:x,contextName:a,registry:y,defined:C,urlFetched:D,defQueue:B,defQueueMap:{},Module:t,makeModuleMap:g,nextTick:req.nextTick,onError:j,configure:function(a){if(a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/"),"string"==typeof a.urlArgs){var b=a.urlArgs;a.urlArgs=function(a,c){return(-1===c.indexOf("?")?"?":"&")+b}}var c=x.shim,d={paths:!0,bundles:!0,config:!0,map:!0};eachProp(a,function(a,b){d[b]?(x[b]||(x[b]={}),mixin(x[b],a,!0,!0)):x[b]=a}),a.bundles&&eachProp(a.bundles,function(a,b){each(a,function(a){a!==b&&(E[a]=b)})}),a.shim&&(eachProp(a.shim,function(a,b){isArray(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=u.makeShimExports(a)),c[b]=a}),x.shim=c),a.packages&&each(a.packages,function(a){var b,c;a="string"==typeof a?{name:a}:a,c=a.name,b=a.location,b&&(x.paths[c]=a.location),x.pkgs[c]=a.name+"/"+(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(y,function(a,b){a.inited||a.map.unnormalized||(a.map=g(b,null,!0))}),(a.deps||a.callback)&&u.require(a.deps||[],a.callback)},makeShimExports:function(a){function b(){var b;return a.init&&(b=a.init.apply(global,arguments)),b||a.exports&&getGlobal(a.exports)}return b},makeRequire:function(b,e){function f(c,d,i){var k,l,m;return e.enableBuildCallback&&d&&isFunction(d)&&(d.__requireJsBuild=!0),"string"==typeof c?isFunction(d)?j(makeError("requireargs","Invalid require call"),i):b&&hasProp(v,c)?v[c](y[b.id]):req.get?req.get(u,c,b,f):(l=g(c,b,!1,!0),k=l.id,hasProp(C,k)?C[k]:j(makeError("notloaded",'Module name "'+k+'" has not been loaded yet for context: '+a+(b?"":". Use require([])")))):(r(),u.nextTick(function(){r(),m=h(g(null,b)),m.skipMap=e.skipMap,m.init(c,d,i,{enabled:!0}),n()}),f)}return e=e||{},mixin(f,{isBrowser:isBrowser,toUrl:function(a){var d,e=a.lastIndexOf("."),f=a.split("/")[0],g="."===f||".."===f;return-1!==e&&(!g||e>1)&&(d=a.substring(e,a.length),a=a.substring(0,e)),u.nameToUrl(c(a,b&&b.id,!0),d,!0)},defined:function(a){return hasProp(C,g(a,b,!1,!0).id)},specified:function(a){return a=g(a,b,!1,!0).id,hasProp(C,a)||hasProp(y,a)}}),b||(f.undef=function(a){k();var c=g(a,b,!0),e=getOwn(y,a);e.undefed=!0,d(a),delete C[a],delete D[c.url],delete A[a],eachReverse(B,function(b,c){b[0]===a&&B.splice(c,1)}),delete u.defQueueMap[a],e&&(e.events.defined&&(A[a]=e.events),l(a))}),f},enable:function(a){var b=getOwn(y,a.id);b&&h(a).enable()},completeLoad:function(a){var b,c,d,f=getOwn(x.shim,a)||{},g=f.exports;for(k();B.length;){if(c=B.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);o(c)}if(u.defQueueMap={},d=getOwn(y,a),!b&&!hasProp(C,a)&&d&&!d.inited){if(!(!x.enforceDefine||g&&getGlobal(g)))return e(a)?void 0:j(makeError("nodefine","No define call for "+a,null,[a]));o([a,f.deps||[],f.exportsFn])}n()},nameToUrl:function(a,b,c){var d,e,f,g,h,i,j,k=getOwn(x.pkgs,a);if(k&&(a=k),j=getOwn(E,a))return u.nameToUrl(j,b,c);if(req.jsExtRegExp.test(a))h=a+(b||"");else{for(d=x.paths,e=a.split("/"),f=e.length;f>0;f-=1)if(g=e.slice(0,f).join("/"),i=getOwn(d,g)){isArray(i)&&(i=i[0]),e.splice(0,f,i);break}h=e.join("/"),h+=b||(/^data\:|^blob\:|\?/.test(h)||c?"":".js"),h=("/"===h.charAt(0)||h.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+h}return x.urlArgs&&!/^blob\:/.test(h)?h+x.urlArgs(a,h):h},load:function(a,b){req.load(u,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=q(a);u.completeLoad(b.id)}},onScriptError:function(a){var b=q(a);if(!e(b.id)){var c=[];return eachProp(y,function(a,d){0!==d.indexOf("_@r")&&each(a.depMaps,function(a){return a.id===b.id?(c.push(d),!0):void 0})}),j(makeError("scripterror",'Script error for "'+b.id+(c.length?'", needed by: '+c.join(", "):'"'),a,[b.id]))}}},u.require=u.makeRequire(),u}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(a){return"interactive"===a.readyState?interactiveScript=a:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.2.0",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(a,b,c,d){var e,f,g=defContextName;return isArray(a)||"string"==typeof a||(f=a,isArray(b)?(a=b,b=c,c=d):a=[]),f&&f.context&&(g=f.context),e=getOwn(contexts,g),e||(e=contexts[g]=req.s.newContext(g)),f&&e.configure(f),e.require(a,b,c)},req.config=function(a){return req(a)},req.nextTick="undefined"!=typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(a){req[a]=function(){var b=contexts[defContextName];return b.require[a].apply(b,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(a,b,c){var d=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return d.type=a.scriptType||"text/javascript",d.charset="utf-8",d.async=!0,d},req.load=function(a,b,c){var d,e=a&&a.config||{};if(isBrowser)return d=req.createNode(e,b,c),d.setAttribute("data-requirecontext",a.contextName),d.setAttribute("data-requiremodule",b),!d.attachEvent||d.attachEvent.toString&&d.attachEvent.toString().indexOf("[native code")<0||isOpera?(d.addEventListener("load",a.onScriptLoad,!1),d.addEventListener("error",a.onScriptError,!1)):(useInteractive=!0,d.attachEvent("onreadystatechange",a.onScriptLoad)),d.src=c,e.onNodeCreated&&e.onNodeCreated(d,e,b,c),currentlyAddingScript=d,baseElement?head.insertBefore(d,baseElement):head.appendChild(d),currentlyAddingScript=null,d;if(isWebWorker)try{setTimeout(function(){},0),importScripts(c),a.completeLoad(b)}catch(d){a.onError(makeError("importscripts","importScripts failed for "+b+" at "+c,d,[b]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(a){return head||(head=a.parentNode),dataMain=a.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(a,b,c){var d,e;"string"!=typeof a&&(c=b,b=a,a=null),isArray(b)||(c=b,b=null),!b&&isFunction(c)&&(b=[],c.length&&(c.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(a,c){b.push(c)}),b=(1===c.length?["require"]:["require","exports","module"]).concat(b))),useInteractive&&(d=currentlyAddingScript||getInteractiveScript(),d&&(a||(a=d.getAttribute("data-requiremodule")),e=contexts[d.getAttribute("data-requirecontext")])),e?(e.defQueue.push([a,b,c]),e.defQueueMap[a]=!0):globalDefQueue.push([a,b,c])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("node_modules/requirejs/require",function(){}),/*!
 * jQuery Migrate - v1.4.0 - 2016-02-26
 * Copyright jQuery Foundation and other contributors
 */
function(a,b,c){function d(c){var d=b.console;f[c]||(f[c]=!0,a.migrateWarnings.push(c),d&&d.warn&&!a.migrateMute&&(d.warn("JQMIGRATE: "+c),a.migrateTrace&&d.trace&&d.trace()))}function e(b,c,e,f){if(Object.defineProperty)try{return void Object.defineProperty(b,c,{configurable:!0,enumerable:!0,get:function(){return d(f),e},set:function(a){d(f),e=a}})}catch(a){}a._definePropertyBroken=!0,b[c]=e}a.migrateVersion="1.4.0";var f={};a.migrateWarnings=[],b.console&&b.console.log&&b.console.log("JQMIGRATE: Migrate is installed"+(a.migrateMute?"":" with logging active")+", version "+a.migrateVersion),a.migrateTrace===c&&(a.migrateTrace=!0),a.migrateReset=function(){f={},a.migrateWarnings.length=0},"BackCompat"===document.compatMode&&d("jQuery is not compatible with Quirks Mode");var g=a("<input/>",{size:1}).attr("size")&&a.attrFn,h=a.attr,i=a.attrHooks.value&&a.attrHooks.value.get||function(){return null},j=a.attrHooks.value&&a.attrHooks.value.set||function(){return c},k=/^(?:input|button)$/i,l=/^[238]$/,m=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,n=/^(?:checked|selected)$/i;e(a,"attrFn",g||{},"jQuery.attrFn is deprecated"),a.attr=function(b,e,f,i){var j=e.toLowerCase(),o=b&&b.nodeType;return i&&(h.length<4&&d("jQuery.fn.attr( props, pass ) is deprecated"),b&&!l.test(o)&&(g?e in g:a.isFunction(a.fn[e])))?a(b)[e](f):("type"===e&&f!==c&&k.test(b.nodeName)&&b.parentNode&&d("Can't change the 'type' of an input or button in IE 6/7/8"),!a.attrHooks[j]&&m.test(j)&&(a.attrHooks[j]={get:function(b,d){var e,f=a.prop(b,d);return f===!0||"boolean"!=typeof f&&(e=b.getAttributeNode(d))&&e.nodeValue!==!1?d.toLowerCase():c},set:function(b,c,d){var e;return c===!1?a.removeAttr(b,d):(e=a.propFix[d]||d,e in b&&(b[e]=!0),b.setAttribute(d,d.toLowerCase())),d}},n.test(j)&&d("jQuery.fn.attr('"+j+"') might use property instead of attribute")),h.call(a,b,e,f))},a.attrHooks.value={get:function(a,b){var c=(a.nodeName||"").toLowerCase();return"button"===c?i.apply(this,arguments):("input"!==c&&"option"!==c&&d("jQuery.fn.attr('value') no longer gets properties"),b in a?a.value:null)},set:function(a,b){var c=(a.nodeName||"").toLowerCase();return"button"===c?j.apply(this,arguments):("input"!==c&&"option"!==c&&d("jQuery.fn.attr('value', val) no longer sets properties"),void(a.value=b))}};var o,p,q=a.fn.init,r=a.parseJSON,s=/^\s*</,t=/\[\s*\w+\s*[~|^$*]?=\s*(?![\s'"])[^#\]]*#/,u=/^([^<]*)(<[\w\W]+>)([^>]*)$/;a.fn.init=function(b,e,f){var g,h;return b&&"string"==typeof b&&!a.isPlainObject(e)&&(g=u.exec(a.trim(b)))&&g[0]&&(s.test(b)||d("$(html) HTML strings must start with '<' character"),g[3]&&d("$(html) HTML text after last tag is ignored"),"#"===g[0].charAt(0)&&(d("HTML string cannot start with a '#' character"),a.error("JQMIGRATE: Invalid selector string (XSS)")),e&&e.context&&(e=e.context),a.parseHTML)?q.call(this,a.parseHTML(g[2],e&&e.ownerDocument||e||document,!0),e,f):("#"===b?(d("jQuery( '#' ) is not a valid selector"),b=[]):t.test(b)&&d("Attribute selectors with '#' must be quoted: '"+b+"'"),h=q.apply(this,arguments),b&&b.selector!==c?(h.selector=b.selector,h.context=b.context):(h.selector="string"==typeof b?b:"",b&&(h.context=b.nodeType?b:e||document)),h)},a.fn.init.prototype=a.fn,a.parseJSON=function(a){return a?r.apply(this,arguments):(d("jQuery.parseJSON requires a valid JSON string"),null)},a.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},a.browser||(o=a.uaMatch(navigator.userAgent),p={},o.browser&&(p[o.browser]=!0,p.version=o.version),p.chrome?p.webkit=!0:p.webkit&&(p.safari=!0),a.browser=p),e(a,"browser",a.browser,"jQuery.browser is deprecated"),a.boxModel=a.support.boxModel="CSS1Compat"===document.compatMode,e(a,"boxModel",a.boxModel,"jQuery.boxModel is deprecated"),e(a.support,"boxModel",a.support.boxModel,"jQuery.support.boxModel is deprecated"),a.sub=function(){function b(a,c){return new b.fn.init(a,c)}a.extend(!0,b,this),b.superclass=this,b.fn=b.prototype=this(),b.fn.constructor=b,b.sub=this.sub,b.fn.init=function(d,e){var f=a.fn.init.call(this,d,e,c);return f instanceof b?f:b(f)},b.fn.init.prototype=b.fn;var c=b(document);return d("jQuery.sub() is deprecated"),b},a.fn.size=function(){return d("jQuery.fn.size() is deprecated; use the .length property"),this.length};var v=!1;a.swap&&a.each(["height","width","reliableMarginRight"],function(b,c){var d=a.cssHooks[c]&&a.cssHooks[c].get;d&&(a.cssHooks[c].get=function(){var a;return v=!0,a=d.apply(this,arguments),v=!1,a})}),a.swap=function(a,b,c,e){var f,g,h={};v||d("jQuery.swap() is undocumented and deprecated");for(g in b)h[g]=a.style[g],a.style[g]=b[g];f=c.apply(a,e||[]);for(g in b)a.style[g]=h[g];return f},a.ajaxSetup({converters:{"text json":a.parseJSON}});var w=a.fn.data;a.fn.data=function(b){var e,f,g=this[0];return!g||"events"!==b||1!==arguments.length||(e=a.data(g,b),f=a._data(g,b),e!==c&&e!==f||f===c)?w.apply(this,arguments):(d("Use of jQuery.fn.data('events') is deprecated"),f)};var x=/\/(java|ecma)script/i;a.clean||(a.clean=function(b,c,e,f){c=c||document,c=!c.nodeType&&c[0]||c,c=c.ownerDocument||c,d("jQuery.clean() is deprecated");var g,h,i,j,k=[];if(a.merge(k,a.buildFragment(b,c).childNodes),e)for(i=function(a){return!a.type||x.test(a.type)?f?f.push(a.parentNode?a.parentNode.removeChild(a):a):e.appendChild(a):void 0},g=0;null!=(h=k[g]);g++)a.nodeName(h,"script")&&i(h)||(e.appendChild(h),"undefined"!=typeof h.getElementsByTagName&&(j=a.grep(a.merge([],h.getElementsByTagName("script")),i),k.splice.apply(k,[g+1,0].concat(j)),g+=j.length));return k});var y=a.event.add,z=a.event.remove,A=a.event.trigger,B=a.fn.toggle,C=a.fn.live,D=a.fn.die,E=a.fn.load,F="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",G=new RegExp("\\b(?:"+F+")\\b"),H=/(?:^|\s)hover(\.\S+|)\b/,I=function(b){return"string"!=typeof b||a.event.special.hover?b:(H.test(b)&&d("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),b&&b.replace(H,"mouseenter$1 mouseleave$1"))};a.event.props&&"attrChange"!==a.event.props[0]&&a.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),a.event.dispatch&&e(a.event,"handle",a.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),a.event.add=function(a,b,c,e,f){a!==document&&G.test(b)&&d("AJAX events should be attached to document: "+b),y.call(this,a,I(b||""),c,e,f)},a.event.remove=function(a,b,c,d,e){z.call(this,a,I(b)||"",c,d,e)},a.each(["load","unload","error"],function(b,c){a.fn[c]=function(){var a=Array.prototype.slice.call(arguments,0);return"load"===c&&"string"==typeof a[0]?E.apply(this,a):(d("jQuery.fn."+c+"() is deprecated"),a.splice(0,0,c),arguments.length?this.bind.apply(this,a):(this.triggerHandler.apply(this,a),this))}}),a.fn.toggle=function(b,c){if(!a.isFunction(b)||!a.isFunction(c))return B.apply(this,arguments);d("jQuery.fn.toggle(handler, handler...) is deprecated");var e=arguments,f=b.guid||a.guid++,g=0,h=function(c){var d=(a._data(this,"lastToggle"+b.guid)||0)%g;return a._data(this,"lastToggle"+b.guid,d+1),c.preventDefault(),e[d].apply(this,arguments)||!1};for(h.guid=f;g<e.length;)e[g++].guid=f;return this.click(h)},a.fn.live=function(b,c,e){return d("jQuery.fn.live() is deprecated"),C?C.apply(this,arguments):(a(this.context).on(b,this.selector,c,e),this)},a.fn.die=function(b,c){return d("jQuery.fn.die() is deprecated"),D?D.apply(this,arguments):(a(this.context).off(b,this.selector||"**",c),this)},a.event.trigger=function(a,b,c,e){return c||G.test(a)||d("Global events are undocumented and deprecated"),A.call(this,a,b,c||document,e)},a.each(F.split("|"),function(b,c){a.event.special[c]={setup:function(){var b=this;return b!==document&&(a.event.add(document,c+"."+a.guid,function(){a.event.trigger(c,Array.prototype.slice.call(arguments,1),b,!0)}),a._data(this,c,a.guid++)),!1},teardown:function(){return this!==document&&a.event.remove(document,c+"."+a._data(this,c)),!1}}}),a.event.special.ready={setup:function(){this===document&&d("'ready' event is deprecated")}};var J=a.fn.andSelf||a.fn.addBack,K=a.fn.find;if(a.fn.andSelf=function(){return d("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),J.apply(this,arguments)},a.fn.find=function(a){var b=K.apply(this,arguments);return b.context=this.context,b.selector=this.selector?this.selector+" "+a:a,b},a.Callbacks){var L=a.Deferred,M=[["resolve","done",a.Callbacks("once memory"),a.Callbacks("once memory"),"resolved"],["reject","fail",a.Callbacks("once memory"),a.Callbacks("once memory"),"rejected"],["notify","progress",a.Callbacks("memory"),a.Callbacks("memory")]];a.Deferred=function(b){var c=L(),e=c.promise();return c.pipe=e.pipe=function(){var b=arguments;return d("deferred.pipe() is deprecated"),a.Deferred(function(d){a.each(M,function(f,g){var h=a.isFunction(b[f])&&b[f];c[g[1]](function(){var b=h&&h.apply(this,arguments);b&&a.isFunction(b.promise)?b.promise().done(d.resolve).fail(d.reject).progress(d.notify):d[g[0]+"With"](this===e?d.promise():this,h?[b]:arguments)})}),b=null}).promise()},c.isResolved=function(){return d("deferred.isResolved is deprecated"),"resolved"===c.state()},c.isRejected=function(){return d("deferred.isRejected is deprecated"),"rejected"===c.state()},b&&b.call(c,c),c}}}(jQuery,window),define("jquery-migrate",function(){}),function(a){function b(a){var b=a.length,d=c.type(a);return"function"===d||c.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===d||0===b||"number"==typeof b&&b>0&&b-1 in a}if(!a.jQuery){var c=function(a,b){return new c.fn.init(a,b)};c.isWindow=function(a){return null!=a&&a==a.window},c.type=function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?e[g.call(a)]||"object":typeof a},c.isArray=Array.isArray||function(a){return"array"===c.type(a)},c.isPlainObject=function(a){var b;if(!a||"object"!==c.type(a)||a.nodeType||c.isWindow(a))return!1;try{if(a.constructor&&!f.call(a,"constructor")&&!f.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}for(b in a);return void 0===b||f.call(a,b)},c.each=function(a,c,d){var e,f=0,g=a.length,h=b(a);if(d){if(h)for(;g>f&&(e=c.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=c.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=c.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=c.call(a[f],f,a[f]),e===!1)break;return a},c.data=function(a,b,e){if(void 0===e){var f=a[c.expando],g=f&&d[f];if(void 0===b)return g;if(g&&b in g)return g[b]}else if(void 0!==b){var f=a[c.expando]||(a[c.expando]=++c.uuid);return d[f]=d[f]||{},d[f][b]=e,e}},c.removeData=function(a,b){var e=a[c.expando],f=e&&d[e];f&&c.each(b,function(a,b){delete f[b]})},c.extend=function(){var a,b,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[i]||{},i++),"object"!=typeof h&&"function"!==c.type(h)&&(h={}),i===j&&(h=this,i--);j>i;i++)if(null!=(f=arguments[i]))for(e in f)a=h[e],d=f[e],h!==d&&(k&&d&&(c.isPlainObject(d)||(b=c.isArray(d)))?(b?(b=!1,g=a&&c.isArray(a)?a:[]):g=a&&c.isPlainObject(a)?a:{},h[e]=c.extend(k,g,d)):void 0!==d&&(h[e]=d));return h},c.queue=function(a,d,e){function f(a,c){var d=c||[];return null!=a&&(b(Object(a))?!function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;)a[e++]=b[d++];if(c!==c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a}(d,"string"==typeof a?[a]:a):[].push.call(d,a)),d}if(a){d=(d||"fx")+"queue";var g=c.data(a,d);return e?(!g||c.isArray(e)?g=c.data(a,d,f(e)):g.push(e),g):g||[]}},c.dequeue=function(a,b){c.each(a.nodeType?[a]:a,function(a,d){b=b||"fx";var e=c.queue(d,b),f=e.shift();"inprogress"===f&&(f=e.shift()),f&&("fx"===b&&e.unshift("inprogress"),f.call(d,function(){c.dequeue(d,b)}))})},c.fn=c.prototype={init:function(a){if(a.nodeType)return this[0]=a,this;throw new Error("Not a DOM node.")},offset:function(){var b=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:b.top+(a.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:b.left+(a.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function a(){for(var a=this.offsetParent||document;a&&"html"===!a.nodeType.toLowerCase&&"static"===a.style.position;)a=a.offsetParent;return a||document}var b=this[0],a=a.apply(b),d=this.offset(),e=/^(?:body|html)$/i.test(a.nodeName)?{top:0,left:0}:c(a).offset();return d.top-=parseFloat(b.style.marginTop)||0,d.left-=parseFloat(b.style.marginLeft)||0,a.style&&(e.top+=parseFloat(a.style.borderTopWidth)||0,e.left+=parseFloat(a.style.borderLeftWidth)||0),{top:d.top-e.top,left:d.left-e.left}}};var d={};c.expando="velocity"+(new Date).getTime(),c.uuid=0;for(var e={},f=e.hasOwnProperty,g=e.toString,h="Boolean Number String Function Array Date RegExp Object Error".split(" "),i=0;i<h.length;i++)e["[object "+h[i]+"]"]=h[i].toLowerCase();c.fn.init.prototype=c.fn,a.Velocity={Utilities:c}}}(window),function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a():"function"==typeof define&&define.amd?define("velocity",a):a()}(function(){return function(a,b,c,d){/* Array compacting. Copyright Lo-Dash. MIT License: https://github.com/lodash/lodash/blob/master/LICENSE.txt */
function e(a){for(var b=-1,c=a?a.length:0,d=[];++b<c;){var e=a[b];e&&d.push(e)}return d}function f(a){return p.isWrapped(a)?a=[].slice.call(a):p.isNode(a)&&(a=[a]),a}function g(a){var b=m.data(a,"velocity");return null===b?d:b}function h(a){return function(b){return Math.round(b*a)*(1/a)}}/* Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */
function i(a,c,d,e){function f(a,b){return 1-3*b+3*a}function g(a,b){return 3*b-6*a}function h(a){return 3*a}function i(a,b,c){return((f(b,c)*a+g(b,c))*a+h(b))*a}function j(a,b,c){return 3*f(b,c)*a*a+2*g(b,c)*a+h(b)}function k(b,c){for(var e=0;p>e;++e){var f=j(c,a,d);if(0===f)return c;var g=i(c,a,d)-b;c-=g/f}return c}function l(){for(var b=0;t>b;++b)x[b]=i(b*u,a,d)}function m(b,c,e){var f,g,h=0;do g=c+(e-c)/2,f=i(g,a,d)-b,f>0?e=g:c=g;while(Math.abs(f)>r&&++h<s);return g}function n(b){for(var c=0,e=1,f=t-1;e!=f&&x[e]<=b;++e)c+=u;--e;var g=(b-x[e])/(x[e+1]-x[e]),h=c+g*u,i=j(h,a,d);return i>=q?k(b,h):0==i?h:m(b,c,c+u)}function o(){y=!0,a==c&&d==e||l()}var p=4,q=.001,r=1e-7,s=10,t=11,u=1/(t-1),v="Float32Array"in b;if(4!==arguments.length)return!1;for(var w=0;4>w;++w)if("number"!=typeof arguments[w]||isNaN(arguments[w])||!isFinite(arguments[w]))return!1;a=Math.min(a,1),d=Math.min(d,1),a=Math.max(a,0),d=Math.max(d,0);var x=v?new Float32Array(t):new Array(t),y=!1,z=function(b){return y||o(),a===c&&d===e?b:0===b?0:1===b?1:i(n(b),c,e)};z.getControlPoints=function(){return[{x:a,y:c},{x:d,y:e}]};var A="generateBezier("+[a,c,d,e]+")";return z.toString=function(){return A},z}function j(a,b){var c=a;return p.isString(a)?t.Easings[a]||(c=!1):c=p.isArray(a)&&1===a.length?h.apply(null,a):p.isArray(a)&&2===a.length?u.apply(null,a.concat([b])):p.isArray(a)&&4===a.length?i.apply(null,a):!1,c===!1&&(c=t.Easings[t.defaults.easing]?t.defaults.easing:s),c}function k(a){if(a){var b=(new Date).getTime(),c=t.State.calls.length;c>1e4&&(t.State.calls=e(t.State.calls));for(var f=0;c>f;f++)if(t.State.calls[f]){var h=t.State.calls[f],i=h[0],j=h[2],n=h[3],o=!!n,q=null;n||(n=t.State.calls[f][3]=b-16);for(var r=Math.min((b-n)/j.duration,1),s=0,u=i.length;u>s;s++){var w=i[s],y=w.element;if(g(y)){var z=!1;if(j.display!==d&&null!==j.display&&"none"!==j.display){if("flex"===j.display){var A=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];m.each(A,function(a,b){v.setPropertyValue(y,"display",b)})}v.setPropertyValue(y,"display",j.display)}j.visibility!==d&&"hidden"!==j.visibility&&v.setPropertyValue(y,"visibility",j.visibility);for(var B in w)if("element"!==B){var C,D=w[B],E=p.isString(D.easing)?t.Easings[D.easing]:D.easing;if(1===r)C=D.endValue;else{var F=D.endValue-D.startValue;if(C=D.startValue+F*E(r,j,F),!o&&C===D.currentValue)continue}if(D.currentValue=C,"tween"===B)q=C;else{if(v.Hooks.registered[B]){var G=v.Hooks.getRoot(B),H=g(y).rootPropertyValueCache[G];H&&(D.rootPropertyValue=H)}var I=v.setPropertyValue(y,B,D.currentValue+(0===parseFloat(C)?"":D.unitType),D.rootPropertyValue,D.scrollData);v.Hooks.registered[B]&&(v.Normalizations.registered[G]?g(y).rootPropertyValueCache[G]=v.Normalizations.registered[G]("extract",null,I[1]):g(y).rootPropertyValueCache[G]=I[1]),"transform"===I[0]&&(z=!0)}}j.mobileHA&&g(y).transformCache.translate3d===d&&(g(y).transformCache.translate3d="(0px, 0px, 0px)",z=!0),z&&v.flushTransformCache(y)}}j.display!==d&&"none"!==j.display&&(t.State.calls[f][2].display=!1),j.visibility!==d&&"hidden"!==j.visibility&&(t.State.calls[f][2].visibility=!1),j.progress&&j.progress.call(h[1],h[1],r,Math.max(0,n+j.duration-b),n,q),1===r&&l(f)}}t.State.isTicking&&x(k)}function l(a,b){if(!t.State.calls[a])return!1;for(var c=t.State.calls[a][0],e=t.State.calls[a][1],f=t.State.calls[a][2],h=t.State.calls[a][4],i=!1,j=0,k=c.length;k>j;j++){var l=c[j].element;if(b||f.loop||("none"===f.display&&v.setPropertyValue(l,"display",f.display),"hidden"===f.visibility&&v.setPropertyValue(l,"visibility",f.visibility)),f.loop!==!0&&(m.queue(l)[1]===d||!/\.velocityQueueEntryFlag/i.test(m.queue(l)[1]))&&g(l)){g(l).isAnimating=!1,g(l).rootPropertyValueCache={};var n=!1;m.each(v.Lists.transforms3D,function(a,b){var c=/^scale/.test(b)?1:0,e=g(l).transformCache[b];g(l).transformCache[b]!==d&&new RegExp("^\\("+c+"[^.]").test(e)&&(n=!0,delete g(l).transformCache[b])}),f.mobileHA&&(n=!0,delete g(l).transformCache.translate3d),n&&v.flushTransformCache(l),v.Values.removeClass(l,"velocity-animating")}if(!b&&f.complete&&!f.loop&&j===k-1)try{f.complete.call(e,e)}catch(a){setTimeout(function(){throw a},1)}h&&f.loop!==!0&&h(e),g(l)&&f.loop===!0&&!b&&(m.each(g(l).tweensContainer,function(a,b){/^rotate/.test(a)&&360===parseFloat(b.endValue)&&(b.endValue=0,b.startValue=360),/^backgroundPosition/.test(a)&&100===parseFloat(b.endValue)&&"%"===b.unitType&&(b.endValue=0,b.startValue=100)}),t(l,"reverse",{loop:!0,delay:f.delay})),f.queue!==!1&&m.dequeue(l,f.queue)}t.State.calls[a]=!1;for(var o=0,p=t.State.calls.length;p>o;o++)if(t.State.calls[o]!==!1){i=!0;break}i===!1&&(t.State.isTicking=!1,delete t.State.calls,t.State.calls=[])}var m,n=function(){if(c.documentMode)return c.documentMode;for(var a=7;a>4;a--){var b=c.createElement("div");if(b.innerHTML="<!--[if IE "+a+"]><span></span><![endif]-->",b.getElementsByTagName("span").length)return b=null,a}return d}(),o=function(){var a=0;return b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||function(b){var c,d=(new Date).getTime();/* Technique by Erik Moller. MIT license: https://gist.github.com/paulirish/1579671 */
return c=Math.max(0,16-(d-a)),a=d+c,setTimeout(function(){b(d+c)},c)}}(),p={isString:function(a){return"string"==typeof a},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},isNode:function(a){return a&&a.nodeType},/* Copyright Martin Bohm. MIT License: https://gist.github.com/Tomalak/818a78a226a0738eaade */
isNodeList:function(a){return"object"==typeof a&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(a))&&a.length!==d&&(0===a.length||"object"==typeof a[0]&&a[0].nodeType>0)},isWrapped:function(a){return a&&(a.jquery||b.Zepto&&b.Zepto.zepto.isZ(a))},isSVG:function(a){return b.SVGElement&&a instanceof b.SVGElement},isEmptyObject:function(a){for(var b in a)return!1;return!0}},q=!1;if(a.fn&&a.fn.jquery?(m=a,q=!0):m=b.Velocity.Utilities,8>=n&&!q)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(7>=n)return void(jQuery.fn.velocity=jQuery.fn.animate);var r=400,s="swing",t={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:b.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:c.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:m,Redirects:{},Easings:{},Promise:b.Promise,defaults:{queue:"",duration:r,easing:s,begin:d,complete:d,progress:d,display:d,visibility:d,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(a){m.data(a,"velocity",{isSVG:p.isSVG(a),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};b.pageYOffset!==d?(t.State.scrollAnchor=b,t.State.scrollPropertyLeft="pageXOffset",t.State.scrollPropertyTop="pageYOffset"):(t.State.scrollAnchor=c.documentElement||c.body.parentNode||c.body,t.State.scrollPropertyLeft="scrollLeft",t.State.scrollPropertyTop="scrollTop");/* Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */
var u=function(){function a(a){return-a.tension*a.x-a.friction*a.v}function b(b,c,d){var e={x:b.x+d.dx*c,v:b.v+d.dv*c,tension:b.tension,friction:b.friction};return{dx:e.v,dv:a(e)}}function c(c,d){var e={dx:c.v,dv:a(c)},f=b(c,.5*d,e),g=b(c,.5*d,f),h=b(c,d,g),i=1/6*(e.dx+2*(f.dx+g.dx)+h.dx),j=1/6*(e.dv+2*(f.dv+g.dv)+h.dv);return c.x=c.x+i*d,c.v=c.v+j*d,c}return function a(b,d,e){var f,g,h,i={x:-1,v:0,tension:null,friction:null},j=[0],k=0,l=1e-4,m=.016;for(b=parseFloat(b)||500,d=parseFloat(d)||20,e=e||null,i.tension=b,i.friction=d,f=null!==e,f?(k=a(b,d),g=k/e*m):g=m;;)if(h=c(h||i,g),j.push(1+h.x),k+=16,!(Math.abs(h.x)>l&&Math.abs(h.v)>l))break;return f?function(a){return j[a*(j.length-1)|0]}:k}}();t.Easings={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},spring:function(a){return 1-Math.cos(4.5*a*Math.PI)*Math.exp(6*-a)}},m.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(a,b){t.Easings[b[0]]=i.apply(null,b[1])});var v=t.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var a=0;a<v.Lists.colors.length;a++){var b="color"===v.Lists.colors[a]?"0 0 0 1":"255 255 255 1";v.Hooks.templates[v.Lists.colors[a]]=["Red Green Blue Alpha",b]}var c,d,e;if(n)for(c in v.Hooks.templates){d=v.Hooks.templates[c],e=d[0].split(" ");var f=d[1].match(v.RegEx.valueSplit);"Color"===e[0]&&(e.push(e.shift()),f.push(f.shift()),v.Hooks.templates[c]=[e.join(" "),f.join(" ")])}for(c in v.Hooks.templates){d=v.Hooks.templates[c],e=d[0].split(" ");for(var a in e){var g=c+e[a],h=a;v.Hooks.registered[g]=[c,h]}}},getRoot:function(a){var b=v.Hooks.registered[a];return b?b[0]:a},cleanRootPropertyValue:function(a,b){return v.RegEx.valueUnwrap.test(b)&&(b=b.match(v.RegEx.valueUnwrap)[1]),v.Values.isCSSNullValue(b)&&(b=v.Hooks.templates[a][1]),b},extractValue:function(a,b){var c=v.Hooks.registered[a];if(c){var d=c[0],e=c[1];return b=v.Hooks.cleanRootPropertyValue(d,b),b.toString().match(v.RegEx.valueSplit)[e]}return b},injectValue:function(a,b,c){var d=v.Hooks.registered[a];if(d){var e,f,g=d[0],h=d[1];return c=v.Hooks.cleanRootPropertyValue(g,c),e=c.toString().match(v.RegEx.valueSplit),e[h]=b,f=e.join(" ")}return c}},Normalizations:{registered:{clip:function(a,b,c){switch(a){case"name":return"clip";case"extract":var d;return v.RegEx.wrappedValueAlreadyExtracted.test(c)?d=c:(d=c.toString().match(v.RegEx.valueUnwrap),d=d?d[1].replace(/,(\s+)?/g," "):c),d;case"inject":return"rect("+c+")"}},blur:function(a,b,c){switch(a){case"name":return t.State.isFirefox?"filter":"-webkit-filter";case"extract":var d=parseFloat(c);if(!d&&0!==d){var e=c.toString().match(/blur\(([0-9]+[A-z]+)\)/i);d=e?e[1]:0}return d;case"inject":return parseFloat(c)?"blur("+c+")":"none"}},opacity:function(a,b,c){if(8>=n)switch(a){case"name":return"filter";case"extract":var d=c.toString().match(/alpha\(opacity=(.*)\)/i);return c=d?d[1]/100:1;case"inject":return b.style.zoom=1,parseFloat(c)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(c),10)+")"}else switch(a){case"name":return"opacity";case"extract":return c;case"inject":return c}}},register:function(){9>=n||t.State.isGingerbread||(v.Lists.transformsBase=v.Lists.transformsBase.concat(v.Lists.transforms3D));for(var a=0;a<v.Lists.transformsBase.length;a++)!function(){var b=v.Lists.transformsBase[a];v.Normalizations.registered[b]=function(a,c,e){switch(a){case"name":return"transform";case"extract":return g(c)===d||g(c).transformCache[b]===d?/^scale/i.test(b)?1:0:g(c).transformCache[b].replace(/[()]/g,"");case"inject":var f=!1;switch(b.substr(0,b.length-1)){case"translate":f=!/(%|px|em|rem|vw|vh|\d)$/i.test(e);break;case"scal":case"scale":t.State.isAndroid&&g(c).transformCache[b]===d&&1>e&&(e=1),f=!/(\d)$/i.test(e);break;case"skew":f=!/(deg|\d)$/i.test(e);break;case"rotate":f=!/(deg|\d)$/i.test(e)}return f||(g(c).transformCache[b]="("+e+")"),g(c).transformCache[b]}}}();for(var a=0;a<v.Lists.colors.length;a++)!function(){var b=v.Lists.colors[a];v.Normalizations.registered[b]=function(a,c,e){switch(a){case"name":return b;case"extract":var f;if(v.RegEx.wrappedValueAlreadyExtracted.test(e))f=e;else{var g,h={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(e)?g=h[e]!==d?h[e]:h.black:v.RegEx.isHex.test(e)?g="rgb("+v.Values.hexToRgb(e).join(" ")+")":/^rgba?\(/i.test(e)||(g=h.black),f=(g||e).toString().match(v.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return 8>=n||3!==f.split(" ").length||(f+=" 1"),f;case"inject":return 8>=n?4===e.split(" ").length&&(e=e.split(/\s+/).slice(0,3).join(" ")):3===e.split(" ").length&&(e+=" 1"),(8>=n?"rgb":"rgba")+"("+e.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(a){return a.replace(/-(\w)/g,function(a,b){return b.toUpperCase()})},SVGAttribute:function(a){var b="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(n||t.State.isAndroid&&!t.State.isChrome)&&(b+="|transform"),new RegExp("^("+b+")$","i").test(a)},prefixCheck:function(a){if(t.State.prefixMatches[a])return[t.State.prefixMatches[a],!0];for(var b=["","Webkit","Moz","ms","O"],c=0,d=b.length;d>c;c++){var e;if(e=0===c?a:b[c]+a.replace(/^\w/,function(a){return a.toUpperCase()}),p.isString(t.State.prefixElement.style[e]))return t.State.prefixMatches[a]=e,[e,!0]}return[a,!1]}},Values:{/* Hex to RGB conversion. Copyright Tim Down: http://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb */
hexToRgb:function(a){var b,c=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return a=a.replace(c,function(a,b,c,d){return b+b+c+c+d+d}),b=d.exec(a),b?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]:[0,0,0]},isCSSNullValue:function(a){return 0==a||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(a)},getUnitType:function(a){return/^(rotate|skew)/i.test(a)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(a)?"":"px"},getDisplayType:function(a){var b=a&&a.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(b)?"inline":/^(li)$/i.test(b)?"list-item":/^(tr)$/i.test(b)?"table-row":/^(table)$/i.test(b)?"table":/^(tbody)$/i.test(b)?"table-row-group":"block"},addClass:function(a,b){a.classList?a.classList.add(b):a.className+=(a.className.length?" ":"")+b},removeClass:function(a,b){a.classList?a.classList.remove(b):a.className=a.className.toString().replace(new RegExp("(^|\\s)"+b.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(a,c,e,f){function h(a,c){function e(){j&&v.setPropertyValue(a,"display","none")}var i=0;if(8>=n)i=m.css(a,c);else{var j=!1;if(/^(width|height)$/.test(c)&&0===v.getPropertyValue(a,"display")&&(j=!0,v.setPropertyValue(a,"display",v.Values.getDisplayType(a))),!f){if("height"===c&&"border-box"!==v.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var k=a.offsetHeight-(parseFloat(v.getPropertyValue(a,"borderTopWidth"))||0)-(parseFloat(v.getPropertyValue(a,"borderBottomWidth"))||0)-(parseFloat(v.getPropertyValue(a,"paddingTop"))||0)-(parseFloat(v.getPropertyValue(a,"paddingBottom"))||0);return e(),k}if("width"===c&&"border-box"!==v.getPropertyValue(a,"boxSizing").toString().toLowerCase()){var l=a.offsetWidth-(parseFloat(v.getPropertyValue(a,"borderLeftWidth"))||0)-(parseFloat(v.getPropertyValue(a,"borderRightWidth"))||0)-(parseFloat(v.getPropertyValue(a,"paddingLeft"))||0)-(parseFloat(v.getPropertyValue(a,"paddingRight"))||0);return e(),l}}var o;o=g(a)===d?b.getComputedStyle(a,null):g(a).computedStyle?g(a).computedStyle:g(a).computedStyle=b.getComputedStyle(a,null),"borderColor"===c&&(c="borderTopColor"),i=9===n&&"filter"===c?o.getPropertyValue(c):o[c],""!==i&&null!==i||(i=a.style[c]),e()}if("auto"===i&&/^(top|right|bottom|left)$/i.test(c)){var p=h(a,"position");("fixed"===p||"absolute"===p&&/top|left/i.test(c))&&(i=m(a).position()[c]+"px")}return i}var i;if(v.Hooks.registered[c]){var j=c,k=v.Hooks.getRoot(j);e===d&&(e=v.getPropertyValue(a,v.Names.prefixCheck(k)[0])),v.Normalizations.registered[k]&&(e=v.Normalizations.registered[k]("extract",a,e)),i=v.Hooks.extractValue(j,e)}else if(v.Normalizations.registered[c]){var l,o;l=v.Normalizations.registered[c]("name",a),"transform"!==l&&(o=h(a,v.Names.prefixCheck(l)[0]),v.Values.isCSSNullValue(o)&&v.Hooks.templates[c]&&(o=v.Hooks.templates[c][1])),i=v.Normalizations.registered[c]("extract",a,o)}if(!/^[\d-]/.test(i))if(g(a)&&g(a).isSVG&&v.Names.SVGAttribute(c))if(/^(height|width)$/i.test(c))try{i=a.getBBox()[c]}catch(a){i=0}else i=a.getAttribute(c);else i=h(a,v.Names.prefixCheck(c)[0]);return v.Values.isCSSNullValue(i)&&(i=0),t.debug>=2&&console.log("Get "+c+": "+i),i},setPropertyValue:function(a,c,d,e,f){var h=c;if("scroll"===c)f.container?f.container["scroll"+f.direction]=d:"Left"===f.direction?b.scrollTo(d,f.alternateValue):b.scrollTo(f.alternateValue,d);else if(v.Normalizations.registered[c]&&"transform"===v.Normalizations.registered[c]("name",a))v.Normalizations.registered[c]("inject",a,d),h="transform",d=g(a).transformCache[c];else{if(v.Hooks.registered[c]){var i=c,j=v.Hooks.getRoot(c);e=e||v.getPropertyValue(a,j),d=v.Hooks.injectValue(i,d,e),c=j}if(v.Normalizations.registered[c]&&(d=v.Normalizations.registered[c]("inject",a,d),c=v.Normalizations.registered[c]("name",a)),h=v.Names.prefixCheck(c)[0],8>=n)try{a.style[h]=d}catch(a){t.debug&&console.log("Browser does not support ["+d+"] for ["+h+"]")}else g(a)&&g(a).isSVG&&v.Names.SVGAttribute(c)?a.setAttribute(c,d):a.style[h]=d;t.debug>=2&&console.log("Set "+c+" ("+h+"): "+d)}return[h,d]},flushTransformCache:function(a){function b(b){return parseFloat(v.getPropertyValue(a,b))}var c="";if((n||t.State.isAndroid&&!t.State.isChrome)&&g(a).isSVG){var d={translate:[b("translateX"),b("translateY")],skewX:[b("skewX")],skewY:[b("skewY")],scale:1!==b("scale")?[b("scale"),b("scale")]:[b("scaleX"),b("scaleY")],rotate:[b("rotateZ"),0,0]};m.each(g(a).transformCache,function(a){/^translate/i.test(a)?a="translate":/^scale/i.test(a)?a="scale":/^rotate/i.test(a)&&(a="rotate"),d[a]&&(c+=a+"("+d[a].join(" ")+") ",delete d[a])})}else{var e,f;m.each(g(a).transformCache,function(b){return e=g(a).transformCache[b],"transformPerspective"===b?(f=e,!0):(9===n&&"rotateZ"===b&&(b="rotate"),void(c+=b+e+" "))}),f&&(c="perspective"+f+" "+c)}v.setPropertyValue(a,"transform",c)}};v.Hooks.register(),v.Normalizations.register(),t.hook=function(a,b,c){var e=d;return a=f(a),m.each(a,function(a,f){if(g(f)===d&&t.init(f),c===d)e===d&&(e=t.CSS.getPropertyValue(f,b));else{var h=t.CSS.setPropertyValue(f,b,c);"transform"===h[0]&&t.CSS.flushTransformCache(f),e=h}}),e};var w=function(){function a(){return h?B.promise||null:i}function e(){function a(a){function l(a,b){var c=d,e=d,g=d;return p.isArray(a)?(c=a[0],!p.isArray(a[1])&&/^[\d-]/.test(a[1])||p.isFunction(a[1])||v.RegEx.isHex.test(a[1])?g=a[1]:(p.isString(a[1])&&!v.RegEx.isHex.test(a[1])||p.isArray(a[1]))&&(e=b?a[1]:j(a[1],h.duration),a[2]!==d&&(g=a[2]))):c=a,b||(e=e||h.easing),p.isFunction(c)&&(c=c.call(f,y,x)),p.isFunction(g)&&(g=g.call(f,y,x)),[c||0,e,g]}function n(a,b){var c,d;return d=(b||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(a){return c=a,""}),c||(c=v.Values.getUnitType(a)),[d,c]}function r(){var a={myParent:f.parentNode||c.body,position:v.getPropertyValue(f,"position"),fontSize:v.getPropertyValue(f,"fontSize")},d=a.position===I.lastPosition&&a.myParent===I.lastParent,e=a.fontSize===I.lastFontSize;I.lastParent=a.myParent,I.lastPosition=a.position,I.lastFontSize=a.fontSize;var h=100,i={};if(e&&d)i.emToPx=I.lastEmToPx,i.percentToPxWidth=I.lastPercentToPxWidth,i.percentToPxHeight=I.lastPercentToPxHeight;else{var j=g(f).isSVG?c.createElementNS("http://www.w3.org/2000/svg","rect"):c.createElement("div");t.init(j),a.myParent.appendChild(j),m.each(["overflow","overflowX","overflowY"],function(a,b){t.CSS.setPropertyValue(j,b,"hidden")}),t.CSS.setPropertyValue(j,"position",a.position),t.CSS.setPropertyValue(j,"fontSize",a.fontSize),t.CSS.setPropertyValue(j,"boxSizing","content-box"),m.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(a,b){t.CSS.setPropertyValue(j,b,h+"%")}),t.CSS.setPropertyValue(j,"paddingLeft",h+"em"),i.percentToPxWidth=I.lastPercentToPxWidth=(parseFloat(v.getPropertyValue(j,"width",null,!0))||1)/h,i.percentToPxHeight=I.lastPercentToPxHeight=(parseFloat(v.getPropertyValue(j,"height",null,!0))||1)/h,i.emToPx=I.lastEmToPx=(parseFloat(v.getPropertyValue(j,"paddingLeft"))||1)/h,a.myParent.removeChild(j)}return null===I.remToPx&&(I.remToPx=parseFloat(v.getPropertyValue(c.body,"fontSize"))||16),null===I.vwToPx&&(I.vwToPx=parseFloat(b.innerWidth)/100,I.vhToPx=parseFloat(b.innerHeight)/100),i.remToPx=I.remToPx,i.vwToPx=I.vwToPx,i.vhToPx=I.vhToPx,t.debug>=1&&console.log("Unit ratios: "+JSON.stringify(i),f),i}if(h.begin&&0===y)try{h.begin.call(o,o)}catch(a){setTimeout(function(){throw a},1)}if("scroll"===C){var u,w,z,A=/^x$/i.test(h.axis)?"Left":"Top",D=parseFloat(h.offset)||0;h.container?p.isWrapped(h.container)||p.isNode(h.container)?(h.container=h.container[0]||h.container,u=h.container["scroll"+A],z=u+m(f).position()[A.toLowerCase()]+D):h.container=null:(u=t.State.scrollAnchor[t.State["scrollProperty"+A]],w=t.State.scrollAnchor[t.State["scrollProperty"+("Left"===A?"Top":"Left")]],z=m(f).offset()[A.toLowerCase()]+D),i={scroll:{rootPropertyValue:!1,startValue:u,currentValue:u,endValue:z,unitType:"",easing:h.easing,scrollData:{container:h.container,direction:A,alternateValue:w}},element:f},t.debug&&console.log("tweensContainer (scroll): ",i.scroll,f)}else if("reverse"===C){if(!g(f).tweensContainer)return void m.dequeue(f,h.queue);"none"===g(f).opts.display&&(g(f).opts.display="auto"),"hidden"===g(f).opts.visibility&&(g(f).opts.visibility="visible"),g(f).opts.loop=!1,g(f).opts.begin=null,g(f).opts.complete=null,s.easing||delete h.easing,s.duration||delete h.duration,h=m.extend({},g(f).opts,h);var E=m.extend(!0,{},g(f).tweensContainer);for(var F in E)if("element"!==F){var G=E[F].startValue;E[F].startValue=E[F].currentValue=E[F].endValue,E[F].endValue=G,p.isEmptyObject(s)||(E[F].easing=h.easing),t.debug&&console.log("reverse tweensContainer ("+F+"): "+JSON.stringify(E[F]),f)}i=E}else if("start"===C){var E;g(f).tweensContainer&&g(f).isAnimating===!0&&(E=g(f).tweensContainer),m.each(q,function(a,b){if(RegExp("^"+v.Lists.colors.join("$|^")+"$").test(a)){var c=l(b,!0),e=c[0],f=c[1],g=c[2];if(v.RegEx.isHex.test(e)){for(var h=["Red","Green","Blue"],i=v.Values.hexToRgb(e),j=g?v.Values.hexToRgb(g):d,k=0;k<h.length;k++){var m=[i[k]];f&&m.push(f),j!==d&&m.push(j[k]),q[a+h[k]]=m}delete q[a]}}});for(var H in q){var K=l(q[H]),L=K[0],M=K[1],N=K[2];H=v.Names.camelCase(H);var O=v.Hooks.getRoot(H),P=!1;if(g(f).isSVG||"tween"===O||v.Names.prefixCheck(O)[1]!==!1||v.Normalizations.registered[O]!==d){(h.display!==d&&null!==h.display&&"none"!==h.display||h.visibility!==d&&"hidden"!==h.visibility)&&/opacity|filter/.test(H)&&!N&&0!==L&&(N=0),h._cacheValues&&E&&E[H]?(N===d&&(N=E[H].endValue+E[H].unitType),P=g(f).rootPropertyValueCache[O]):v.Hooks.registered[H]?N===d?(P=v.getPropertyValue(f,O),N=v.getPropertyValue(f,H,P)):P=v.Hooks.templates[O][1]:N===d&&(N=v.getPropertyValue(f,H));var Q,R,S,T=!1;if(Q=n(H,N),N=Q[0],S=Q[1],Q=n(H,L),L=Q[0].replace(/^([+-\/*])=/,function(a,b){return T=b,""}),R=Q[1],N=parseFloat(N)||0,L=parseFloat(L)||0,"%"===R&&(/^(fontSize|lineHeight)$/.test(H)?(L/=100,R="em"):/^scale/.test(H)?(L/=100,R=""):/(Red|Green|Blue)$/i.test(H)&&(L=L/100*255,R="")),/[\/*]/.test(T))R=S;else if(S!==R&&0!==N)if(0===L)R=S;else{e=e||r();var U=/margin|padding|left|right|width|text|word|letter/i.test(H)||/X$/.test(H)||"x"===H?"x":"y";switch(S){case"%":N*="x"===U?e.percentToPxWidth:e.percentToPxHeight;break;case"px":break;default:N*=e[S+"ToPx"]}switch(R){case"%":N*=1/("x"===U?e.percentToPxWidth:e.percentToPxHeight);break;case"px":break;default:N*=1/e[R+"ToPx"]}}switch(T){case"+":L=N+L;break;case"-":L=N-L;break;case"*":L=N*L;break;case"/":L=N/L}i[H]={rootPropertyValue:P,startValue:N,currentValue:N,endValue:L,unitType:R,easing:M},t.debug&&console.log("tweensContainer ("+H+"): "+JSON.stringify(i[H]),f)}else t.debug&&console.log("Skipping ["+O+"] due to a lack of browser support.")}i.element=f}i.element&&(v.Values.addClass(f,"velocity-animating"),J.push(i),""===h.queue&&(g(f).tweensContainer=i,g(f).opts=h),g(f).isAnimating=!0,y===x-1?(t.State.calls.push([J,o,h,null,B.resolver]),t.State.isTicking===!1&&(t.State.isTicking=!0,k())):y++)}var e,f=this,h=m.extend({},t.defaults,s),i={};switch(g(f)===d&&t.init(f),parseFloat(h.delay)&&h.queue!==!1&&m.queue(f,h.queue,function(a){t.velocityQueueEntryFlag=!0,g(f).delayTimer={setTimeout:setTimeout(a,parseFloat(h.delay)),next:a}}),h.duration.toString().toLowerCase()){case"fast":h.duration=200;break;case"normal":h.duration=r;break;case"slow":h.duration=600;break;default:h.duration=parseFloat(h.duration)||1}t.mock!==!1&&(t.mock===!0?h.duration=h.delay=1:(h.duration*=parseFloat(t.mock)||1,h.delay*=parseFloat(t.mock)||1)),h.easing=j(h.easing,h.duration),h.begin&&!p.isFunction(h.begin)&&(h.begin=null),h.progress&&!p.isFunction(h.progress)&&(h.progress=null),h.complete&&!p.isFunction(h.complete)&&(h.complete=null),h.display!==d&&null!==h.display&&(h.display=h.display.toString().toLowerCase(),"auto"===h.display&&(h.display=t.CSS.Values.getDisplayType(f))),h.visibility!==d&&null!==h.visibility&&(h.visibility=h.visibility.toString().toLowerCase()),h.mobileHA=h.mobileHA&&t.State.isMobile&&!t.State.isGingerbread,h.queue===!1?h.delay?setTimeout(a,h.delay):a():m.queue(f,h.queue,function(b,c){return c===!0?(B.promise&&B.resolver(o),!0):(t.velocityQueueEntryFlag=!0,void a(b))}),""!==h.queue&&"fx"!==h.queue||"inprogress"===m.queue(f)[0]||m.dequeue(f)}var h,i,n,o,q,s,u=arguments[0]&&(arguments[0].p||m.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||p.isString(arguments[0].properties));if(p.isWrapped(this)?(h=!1,n=0,o=this,i=this):(h=!0,n=1,o=u?arguments[0].elements||arguments[0].e:arguments[0]),o=f(o)){u?(q=arguments[0].properties||arguments[0].p,s=arguments[0].options||arguments[0].o):(q=arguments[n],s=arguments[n+1]);var x=o.length,y=0;if(!/^(stop|finish)$/i.test(q)&&!m.isPlainObject(s)){var z=n+1;s={};for(var A=z;A<arguments.length;A++)p.isArray(arguments[A])||!/^(fast|normal|slow)$/i.test(arguments[A])&&!/^\d/.test(arguments[A])?p.isString(arguments[A])||p.isArray(arguments[A])?s.easing=arguments[A]:p.isFunction(arguments[A])&&(s.complete=arguments[A]):s.duration=arguments[A]}var B={promise:null,resolver:null,rejecter:null};h&&t.Promise&&(B.promise=new t.Promise(function(a,b){B.resolver=a,B.rejecter=b}));var C;switch(q){case"scroll":C="scroll";break;case"reverse":C="reverse";break;case"finish":case"stop":m.each(o,function(a,b){g(b)&&g(b).delayTimer&&(clearTimeout(g(b).delayTimer.setTimeout),g(b).delayTimer.next&&g(b).delayTimer.next(),delete g(b).delayTimer)});var D=[];return m.each(t.State.calls,function(a,b){b&&m.each(b[1],function(c,e){var f=s===d?"":s;return f===!0||b[2].queue===f||s===d&&b[2].queue===!1?void m.each(o,function(c,d){d===e&&((s===!0||p.isString(s))&&(m.each(m.queue(d,p.isString(s)?s:""),function(a,b){p.isFunction(b)&&b(null,!0)}),m.queue(d,p.isString(s)?s:"",[])),"stop"===q?(g(d)&&g(d).tweensContainer&&f!==!1&&m.each(g(d).tweensContainer,function(a,b){b.endValue=b.currentValue}),D.push(a)):"finish"===q&&(b[2].duration=1))}):!0})}),"stop"===q&&(m.each(D,function(a,b){l(b,!0)}),B.promise&&B.resolver(o)),a();default:if(!m.isPlainObject(q)||p.isEmptyObject(q)){if(p.isString(q)&&t.Redirects[q]){var E=m.extend({},s),F=E.duration,G=E.delay||0;return E.backwards===!0&&(o=m.extend(!0,[],o).reverse()),m.each(o,function(a,b){parseFloat(E.stagger)?E.delay=G+parseFloat(E.stagger)*a:p.isFunction(E.stagger)&&(E.delay=G+E.stagger.call(b,a,x)),E.drag&&(E.duration=parseFloat(F)||(/^(callout|transition)/.test(q)?1e3:r),E.duration=Math.max(E.duration*(E.backwards?1-a/x:(a+1)/x),.75*E.duration,200)),t.Redirects[q].call(b,b,E||{},a,x,o,B.promise?B:d)}),a()}var H="Velocity: First argument ("+q+") was not a property map, a known action, or a registered redirect. Aborting.";return B.promise?B.rejecter(new Error(H)):console.log(H),a()}C="start"}var I={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},J=[];m.each(o,function(a,b){p.isNode(b)&&e.call(b)});var K,E=m.extend({},t.defaults,s);if(E.loop=parseInt(E.loop),K=2*E.loop-1,E.loop)for(var L=0;K>L;L++){var M={delay:E.delay,progress:E.progress};L===K-1&&(M.display=E.display,M.visibility=E.visibility,M.complete=E.complete),w(o,"reverse",M)}return a()}};t=m.extend(w,t),t.animate=w;var x=b.requestAnimationFrame||o;return t.State.isMobile||c.hidden===d||c.addEventListener("visibilitychange",function(){c.hidden?(x=function(a){return setTimeout(function(){a(!0)},16)},k()):x=b.requestAnimationFrame||o}),a.Velocity=t,a!==b&&(a.fn.velocity=w,a.fn.velocity.defaults=t.defaults),m.each(["Down","Up"],function(a,b){t.Redirects["slide"+b]=function(a,c,e,f,g,h){var i=m.extend({},c),j=i.begin,k=i.complete,l={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},n={};i.display===d&&(i.display="Down"===b?"inline"===t.CSS.Values.getDisplayType(a)?"inline-block":"block":"none"),i.begin=function(){j&&j.call(g,g);for(var c in l){n[c]=a.style[c];var d=t.CSS.getPropertyValue(a,c);l[c]="Down"===b?[d,0]:[0,d]}n.overflow=a.style.overflow,a.style.overflow="hidden"},i.complete=function(){for(var b in n)a.style[b]=n[b];k&&k.call(g,g),h&&h.resolver(g)},t(a,l,i)}}),m.each(["In","Out"],function(a,b){t.Redirects["fade"+b]=function(a,c,e,f,g,h){var i=m.extend({},c),j={opacity:"In"===b?1:0},k=i.complete;e!==f-1?i.complete=i.begin=null:i.complete=function(){k&&k.call(g,g),h&&h.resolver(g)},i.display===d&&(i.display="In"===b?"auto":"none"),t(this,j,i)}}),t}(window.jQuery||window.Zepto||window,window,document)}),define("jquery",["require","jquery-migrate","velocity"],function(a){return a("jquery-migrate"),a("velocity"),$.fx.speeds._default=200,$.Velocity.defaults.duration=200,$}),
//     Underscore may be freely distributed under the MIT license.
function(){function a(a){function b(b,c,d,e,f,g){for(;f>=0&&g>f;f+=a){var h=e?e[f]:f;d=c(d,b[h],h,b)}return d}return function(c,d,e,f){d=t(d,f,4);var g=!A(c)&&s.keys(c),h=(g||c).length,i=a>0?0:h-1;return arguments.length<3&&(e=c[g?g[i]:i],i+=a),b(c,d,e,g,i,h)}}function b(a){return function(b,c,d){c=u(c,d);for(var e=z(b),f=a>0?0:e-1;f>=0&&e>f;f+=a)if(c(b[f],f,b))return f;return-1}}function c(a,b,c){return function(d,e,f){var g=0,h=z(d);if("number"==typeof f)a>0?g=f>=0?f:Math.max(f+h,g):h=f>=0?Math.min(f+1,h):f+h+1;else if(c&&f&&h)return f=c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(k.call(d,g,h),s.isNaN),f>=0?f+g:-1;for(f=a>0?g:h-1;f>=0&&h>f;f+=a)if(d[f]===e)return f;return-1}}function d(a,b){var c=F.length,d=a.constructor,e=s.isFunction(d)&&d.prototype||h,f="constructor";for(s.has(a,f)&&!s.contains(b,f)&&b.push(f);c--;)f=F[c],f in a&&a[f]!==e[f]&&!s.contains(b,f)&&b.push(f)}var e=this,f=e._,g=Array.prototype,h=Object.prototype,i=Function.prototype,j=g.push,k=g.slice,l=h.toString,m=h.hasOwnProperty,n=Array.isArray,o=Object.keys,p=i.bind,q=Object.create,r=function(){},s=function(a){return a instanceof s?a:this instanceof s?void(this._wrapped=a):new s(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=s),exports._=s):e._=s,s.VERSION="1.8.3";var t=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},u=function(a,b,c){return null==a?s.identity:s.isFunction(a)?t(a,b,c):s.isObject(a)?s.matcher(a):s.property(a)};s.iteratee=function(a,b){return u(a,b,1/0)};var v=function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var e=1;d>e;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;h>i;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}},w=function(a){if(!s.isObject(a))return{};if(q)return q(a);r.prototype=a;var b=new r;return r.prototype=null,b},x=function(a){return function(b){return null==b?void 0:b[a]}},y=Math.pow(2,53)-1,z=x("length"),A=function(a){var b=z(a);return"number"==typeof b&&b>=0&&y>=b};s.each=s.forEach=function(a,b,c){b=t(b,c);var d,e;if(A(a))for(d=0,e=a.length;e>d;d++)b(a[d],d,a);else{var f=s.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},s.map=s.collect=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=Array(e),g=0;e>g;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f},s.reduce=s.foldl=s.inject=a(1),s.reduceRight=s.foldr=a(-1),s.find=s.detect=function(a,b,c){var d;return d=A(a)?s.findIndex(a,b,c):s.findKey(a,b,c),void 0!==d&&-1!==d?a[d]:void 0},s.filter=s.select=function(a,b,c){var d=[];return b=u(b,c),s.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},s.reject=function(a,b,c){return s.filter(a,s.negate(u(b)),c)},s.every=s.all=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},s.some=s.any=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},s.contains=s.includes=s.include=function(a,b,c,d){return A(a)||(a=s.values(a)),("number"!=typeof c||d)&&(c=0),s.indexOf(a,b,c)>=0},s.invoke=function(a,b){var c=k.call(arguments,2),d=s.isFunction(b);return s.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})},s.pluck=function(a,b){return s.map(a,s.property(b))},s.where=function(a,b){return s.filter(a,s.matcher(b))},s.findWhere=function(a,b){return s.find(a,s.matcher(b))},s.max=function(a,b,c){var d,e,f=-(1/0),g=-(1/0);if(null==b&&null!=a){a=A(a)?a:s.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],d>f&&(f=d)}else b=u(b,c),s.each(a,function(a,c,d){e=b(a,c,d),(e>g||e===-(1/0)&&f===-(1/0))&&(f=a,g=e)});return f},s.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=A(a)?a:s.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=u(b,c),s.each(a,function(a,c,d){e=b(a,c,d),(g>e||e===1/0&&f===1/0)&&(f=a,g=e)});return f},s.shuffle=function(a){for(var b,c=A(a)?a:s.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=s.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},s.sample=function(a,b,c){return null==b||c?(A(a)||(a=s.values(a)),a[s.random(a.length-1)]):s.shuffle(a).slice(0,Math.max(0,b))},s.sortBy=function(a,b,c){return b=u(b,c),s.pluck(s.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var B=function(a){return function(b,c,d){var e={};return c=u(c,d),s.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};s.groupBy=B(function(a,b,c){s.has(a,c)?a[c].push(b):a[c]=[b]}),s.indexBy=B(function(a,b,c){a[c]=b}),s.countBy=B(function(a,b,c){s.has(a,c)?a[c]++:a[c]=1}),s.toArray=function(a){return a?s.isArray(a)?k.call(a):A(a)?s.map(a,s.identity):s.values(a):[]},s.size=function(a){return null==a?0:A(a)?a.length:s.keys(a).length},s.partition=function(a,b,c){b=u(b,c);var d=[],e=[];return s.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},s.first=s.head=s.take=function(a,b,c){return null!=a?null==b||c?a[0]:s.initial(a,a.length-b):void 0},s.initial=function(a,b,c){return k.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},s.last=function(a,b,c){return null!=a?null==b||c?a[a.length-1]:s.rest(a,Math.max(0,a.length-b)):void 0},s.rest=s.tail=s.drop=function(a,b,c){return k.call(a,null==b||c?1:b)},s.compact=function(a){return s.filter(a,s.identity)};var C=function(a,b,c,d){for(var e=[],f=0,g=d||0,h=z(a);h>g;g++){var i=a[g];if(A(i)&&(s.isArray(i)||s.isArguments(i))){b||(i=C(i,b,c));var j=0,k=i.length;for(e.length+=k;k>j;)e[f++]=i[j++]}else c||(e[f++]=i)}return e};s.flatten=function(a,b){return C(a,b,!1)},s.without=function(a){return s.difference(a,k.call(arguments,1))},s.uniq=s.unique=function(a,b,c,d){s.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=u(c,d));for(var e=[],f=[],g=0,h=z(a);h>g;g++){var i=a[g],j=c?c(i,g,a):i;b?(g&&f===j||e.push(i),f=j):c?s.contains(f,j)||(f.push(j),e.push(i)):s.contains(e,i)||e.push(i)}return e},s.union=function(){return s.uniq(C(arguments,!0,!0))},s.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=z(a);e>d;d++){var f=a[d];if(!s.contains(b,f)){for(var g=1;c>g&&s.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},s.difference=function(a){var b=C(arguments,!0,!0,1);return s.filter(a,function(a){return!s.contains(b,a)})},s.zip=function(){return s.unzip(arguments)},s.unzip=function(a){for(var b=a&&s.max(a,z).length||0,c=Array(b),d=0;b>d;d++)c[d]=s.pluck(a,d);return c},s.object=function(a,b){for(var c={},d=0,e=z(a);e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},s.findIndex=b(1),s.findLastIndex=b(-1),s.sortedIndex=function(a,b,c,d){c=u(c,d,1);for(var e=c(b),f=0,g=z(a);g>f;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f},s.indexOf=c(1,s.findIndex,s.sortedIndex),s.lastIndexOf=c(-1,s.findLastIndex),s.range=function(a,b,c){null==b&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var D=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=w(a.prototype),g=a.apply(f,e);return s.isObject(g)?g:f};s.bind=function(a,b){if(p&&a.bind===p)return p.apply(a,k.call(arguments,1));if(!s.isFunction(a))throw new TypeError("Bind must be called on a function");var c=k.call(arguments,2),d=function(){return D(a,d,b,this,c.concat(k.call(arguments)))};return d},s.partial=function(a){var b=k.call(arguments,1),c=function(){for(var d=0,e=b.length,f=Array(e),g=0;e>g;g++)f[g]=b[g]===s?arguments[d++]:b[g];for(;d<arguments.length;)f.push(arguments[d++]);return D(a,c,this,this,f)};return c},s.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=s.bind(a[c],a);return a},s.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return s.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},s.delay=function(a,b){var c=k.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},s.defer=s.partial(s.delay,s,1),s.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:s.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=s.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(g&&(clearTimeout(g),g=null),h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},s.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=s.now()-g;b>j&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=s.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},s.wrap=function(a,b){return s.partial(b,a)},s.negate=function(a){return function(){return!a.apply(this,arguments)}},s.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},s.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},s.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),1>=a&&(b=null),c}},s.once=s.partial(s.before,2);var E=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];s.keys=function(a){if(!s.isObject(a))return[];if(o)return o(a);var b=[];for(var c in a)s.has(a,c)&&b.push(c);return E&&d(a,b),b},s.allKeys=function(a){if(!s.isObject(a))return[];var b=[];for(var c in a)b.push(c);return E&&d(a,b),b},s.values=function(a){for(var b=s.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},s.mapObject=function(a,b,c){b=u(b,c);for(var d,e=s.keys(a),f=e.length,g={},h=0;f>h;h++)d=e[h],g[d]=b(a[d],d,a);return g},s.pairs=function(a){for(var b=s.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},s.invert=function(a){for(var b={},c=s.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},s.functions=s.methods=function(a){var b=[];for(var c in a)s.isFunction(a[c])&&b.push(c);return b.sort()},s.extend=v(s.allKeys),s.extendOwn=s.assign=v(s.keys),s.findKey=function(a,b,c){b=u(b,c);for(var d,e=s.keys(a),f=0,g=e.length;g>f;f++)if(d=e[f],b(a[d],d,a))return d},s.pick=function(a,b,c){var d,e,f={},g=a;if(null==g)return f;s.isFunction(b)?(e=s.allKeys(g),d=t(b,c)):(e=C(arguments,!1,!1,1),d=function(a,b,c){return b in c},g=Object(g));for(var h=0,i=e.length;i>h;h++){var j=e[h],k=g[j];d(k,j,g)&&(f[j]=k)}return f},s.omit=function(a,b,c){if(s.isFunction(b))b=s.negate(b);else{var d=s.map(C(arguments,!1,!1,1),String);b=function(a,b){return!s.contains(d,b)}}return s.pick(a,b,c)},s.defaults=v(s.allKeys,!0),s.create=function(a,b){var c=w(a);return b&&s.extendOwn(c,b),c},s.clone=function(a){return s.isObject(a)?s.isArray(a)?a.slice():s.extend({},a):a},s.tap=function(a,b){return b(a),a},s.isMatch=function(a,b){var c=s.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;d>f;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var G=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof s&&(a=a._wrapped),b instanceof s&&(b=b._wrapped);var e=l.call(a);if(e!==l.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var f="[object Array]"===e;if(!f){if("object"!=typeof a||"object"!=typeof b)return!1;var g=a.constructor,h=b.constructor;if(g!==h&&!(s.isFunction(g)&&g instanceof g&&s.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var i=c.length;i--;)if(c[i]===a)return d[i]===b;if(c.push(a),d.push(b),f){if(i=a.length,i!==b.length)return!1;for(;i--;)if(!G(a[i],b[i],c,d))return!1}else{var j,k=s.keys(a);if(i=k.length,s.keys(b).length!==i)return!1;for(;i--;)if(j=k[i],!s.has(b,j)||!G(a[j],b[j],c,d))return!1}return c.pop(),d.pop(),!0};s.isEqual=function(a,b){return G(a,b)},s.isEmpty=function(a){return null==a?!0:A(a)&&(s.isArray(a)||s.isString(a)||s.isArguments(a))?0===a.length:0===s.keys(a).length},s.isElement=function(a){return!(!a||1!==a.nodeType)},s.isArray=n||function(a){return"[object Array]"===l.call(a)},s.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},s.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(a){s["is"+a]=function(b){return l.call(b)==="[object "+a+"]"}}),s.isArguments(arguments)||(s.isArguments=function(a){return s.has(a,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(s.isFunction=function(a){return"function"==typeof a||!1}),s.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},s.isNaN=function(a){return s.isNumber(a)&&a!==+a},s.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===l.call(a)},s.isNull=function(a){return null===a},s.isUndefined=function(a){return void 0===a},s.has=function(a,b){return null!=a&&m.call(a,b)},s.noConflict=function(){return e._=f,this},s.identity=function(a){return a},s.constant=function(a){return function(){return a}},s.noop=function(){},s.property=x,s.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},s.matcher=s.matches=function(a){return a=s.extendOwn({},a),function(b){return s.isMatch(b,a)}},s.times=function(a,b,c){var d=Array(Math.max(0,a));b=t(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},s.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},s.now=Date.now||function(){return(new Date).getTime()};var H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},I=s.invert(H),J=function(a){var b=function(b){return a[b]},c="(?:"+s.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};s.escape=J(H),s.unescape=J(I),s.result=function(a,b,c){var d=null==a?void 0:a[b];return void 0===d&&(d=c),s.isFunction(d)?d.call(a):d};var K=0;s.uniqueId=function(a){var b=++K+"";return a?a+b:b},s.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\u2028|\u2029/g,O=function(a){return"\\"+M[a]};s.template=function(a,b,c){!b&&c&&(b=c),b=s.defaults({},b,s.templateSettings);var d=RegExp([(b.escape||L).source,(b.interpolate||L).source,(b.evaluate||L).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(N,O),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(a){throw a.source=f,a}var h=function(a){return g.call(this,a,s)},i=b.variable||"obj";return h.source="function("+i+"){\n"+f+"}",h},s.chain=function(a){var b=s(a);return b._chain=!0,b};var P=function(a,b){return a._chain?s(b).chain():b};s.mixin=function(a){s.each(s.functions(a),function(b){var c=s[b]=a[b];s.prototype[b]=function(){var a=[this._wrapped];return j.apply(a,arguments),P(this,c.apply(s,a))}})},s.mixin(s),s.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=g[a];s.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],P(this,c)}}),s.each(["concat","join","slice"],function(a){var b=g[a];s.prototype[a]=function(){return P(this,b.apply(this._wrapped,arguments))}}),s.prototype.value=function(){return this._wrapped},s.prototype.valueOf=s.prototype.toJSON=s.prototype.value,s.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return s})}.call(this),
//     Backbone may be freely distributed under the MIT license.
function(a){var b="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(c,d,e){b.Backbone=a(b,e,c,d)});else if("undefined"!=typeof exports){var c,d=require("underscore");try{c=require("jquery")}catch(a){}a(b,exports,d,c)}else b.Backbone=a(b,{},b._,b.jQuery||b.Zepto||b.ender||b.$)}(function(a,b,c,d){var e=a.Backbone,f=Array.prototype.slice;b.VERSION="1.3.3",b.$=d,b.noConflict=function(){return a.Backbone=e,this},b.emulateHTTP=!1,b.emulateJSON=!1;var g=function(a,b,d){switch(a){case 1:return function(){return c[b](this[d])};case 2:return function(a){return c[b](this[d],a)};case 3:return function(a,e){return c[b](this[d],i(a,this),e)};case 4:return function(a,e,f){return c[b](this[d],i(a,this),e,f)};default:return function(){var a=f.call(arguments);return a.unshift(this[d]),c[b].apply(c,a)}}},h=function(a,b,d){c.each(b,function(b,e){c[e]&&(a.prototype[e]=g(b,e,d))})},i=function(a,b){return c.isFunction(a)?a:c.isObject(a)&&!b._isModel(a)?j(a):c.isString(a)?function(b){return b.get(a)}:a},j=function(a){var b=c.matches(a);return function(a){return b(a.attributes)}},k=b.Events={},l=/\s+/,m=function(a,b,d,e,f){var g,h=0;if(d&&"object"==typeof d){void 0!==e&&"context"in f&&void 0===f.context&&(f.context=e);for(g=c.keys(d);h<g.length;h++)b=m(a,b,g[h],d[g[h]],f)}else if(d&&l.test(d))for(g=d.split(l);h<g.length;h++)b=a(b,g[h],e,f);else b=a(b,d,e,f);return b};k.on=function(a,b,c){return n(this,a,b,c)};var n=function(a,b,c,d,e){if(a._events=m(o,a._events||{},b,c,{context:d,ctx:a,listening:e}),e){var f=a._listeners||(a._listeners={});f[e.id]=e}return a};k.listenTo=function(a,b,d){if(!a)return this;var e=a._listenId||(a._listenId=c.uniqueId("l")),f=this._listeningTo||(this._listeningTo={}),g=f[e];if(!g){var h=this._listenId||(this._listenId=c.uniqueId("l"));g=f[e]={obj:a,objId:e,id:h,listeningTo:f,count:0}}return n(a,b,d,this,g),this};var o=function(a,b,c,d){if(c){var e=a[b]||(a[b]=[]),f=d.context,g=d.ctx,h=d.listening;h&&h.count++,e.push({callback:c,context:f,ctx:f||g,listening:h})}return a};k.off=function(a,b,c){return this._events?(this._events=m(p,this._events,a,b,{context:c,listeners:this._listeners}),this):this},k.stopListening=function(a,b,d){var e=this._listeningTo;if(!e)return this;for(var f=a?[a._listenId]:c.keys(e),g=0;g<f.length;g++){var h=e[f[g]];if(!h)break;h.obj.off(b,d,this)}return this};var p=function(a,b,d,e){if(a){var f,g=0,h=e.context,i=e.listeners;if(b||d||h){for(var j=b?[b]:c.keys(a);g<j.length;g++){b=j[g];var k=a[b];if(!k)break;for(var l=[],m=0;m<k.length;m++){var n=k[m];d&&d!==n.callback&&d!==n.callback._callback||h&&h!==n.context?l.push(n):(f=n.listening,f&&0===--f.count&&(delete i[f.id],delete f.listeningTo[f.objId]))}l.length?a[b]=l:delete a[b]}return a}for(var o=c.keys(i);g<o.length;g++)f=i[o[g]],delete i[f.id],delete f.listeningTo[f.objId]}};k.once=function(a,b,d){var e=m(q,{},a,b,c.bind(this.off,this));return"string"==typeof a&&null==d&&(b=void 0),this.on(e,b,d)},k.listenToOnce=function(a,b,d){var e=m(q,{},b,d,c.bind(this.stopListening,this,a));return this.listenTo(a,e)};var q=function(a,b,d,e){if(d){var f=a[b]=c.once(function(){e(b,f),d.apply(this,arguments)});f._callback=d}return a};k.trigger=function(a){if(!this._events)return this;for(var b=Math.max(0,arguments.length-1),c=Array(b),d=0;b>d;d++)c[d]=arguments[d+1];return m(r,this._events,a,void 0,c),this};var r=function(a,b,c,d){if(a){var e=a[b],f=a.all;e&&f&&(f=f.slice()),e&&s(e,d),f&&s(f,[b].concat(d))}return a},s=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}};k.bind=k.on,k.unbind=k.off,c.extend(b,k);var t=b.Model=function(a,b){var d=a||{};b||(b={}),this.cid=c.uniqueId(this.cidPrefix),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(d=this.parse(d,b)||{});var e=c.result(this,"defaults");d=c.defaults(c.extend({},e,d),e),this.set(d,b),this.changed={},this.initialize.apply(this,arguments)};c.extend(t.prototype,k,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(a){return c.clone(this.attributes)},sync:function(){return b.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return c.escape(this.get(a))},has:function(a){return null!=this.get(a)},matches:function(a){return!!c.iteratee(a,this)(this.attributes)},set:function(a,b,d){if(null==a)return this;var e;if("object"==typeof a?(e=a,d=b):(e={})[a]=b,d||(d={}),!this._validate(e,d))return!1;var f=d.unset,g=d.silent,h=[],i=this._changing;this._changing=!0,i||(this._previousAttributes=c.clone(this.attributes),this.changed={});var j=this.attributes,k=this.changed,l=this._previousAttributes;for(var m in e)b=e[m],c.isEqual(j[m],b)||h.push(m),c.isEqual(l[m],b)?delete k[m]:k[m]=b,f?delete j[m]:j[m]=b;if(this.idAttribute in e&&(this.id=this.get(this.idAttribute)),!g){h.length&&(this._pending=d);for(var n=0;n<h.length;n++)this.trigger("change:"+h[n],this,j[h[n]],d)}if(i)return this;if(!g)for(;this._pending;)d=this._pending,this._pending=!1,this.trigger("change",this,d);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,c.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var d in this.attributes)b[d]=void 0;return this.set(b,c.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!c.isEmpty(this.changed):c.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?c.clone(this.changed):!1;var b=this._changing?this._previousAttributes:this.attributes,d={};for(var e in a){var f=a[e];c.isEqual(b[e],f)||(d[e]=f)}return c.size(d)?d:!1},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return c.clone(this._previousAttributes)},fetch:function(a){a=c.extend({parse:!0},a);var b=this,d=a.success;return a.success=function(c){var e=a.parse?b.parse(c,a):c;return b.set(e,a)?(d&&d.call(a.context,b,c,a),void b.trigger("sync",b,c,a)):!1},P(this,a),this.sync("read",this,a)},save:function(a,b,d){var e;null==a||"object"==typeof a?(e=a,d=b):(e={})[a]=b,d=c.extend({validate:!0,parse:!0},d);var f=d.wait;if(e&&!f){if(!this.set(e,d))return!1}else if(!this._validate(e,d))return!1;var g=this,h=d.success,i=this.attributes;d.success=function(a){g.attributes=i;var b=d.parse?g.parse(a,d):a;return f&&(b=c.extend({},e,b)),b&&!g.set(b,d)?!1:(h&&h.call(d.context,g,a,d),void g.trigger("sync",g,a,d))},P(this,d),e&&f&&(this.attributes=c.extend({},i,e));var j=this.isNew()?"create":d.patch?"patch":"update";"patch"!==j||d.attrs||(d.attrs=e);var k=this.sync(j,this,d);return this.attributes=i,k},destroy:function(a){a=a?c.clone(a):{};var b=this,d=a.success,e=a.wait,f=function(){b.stopListening(),b.trigger("destroy",b,b.collection,a)};a.success=function(c){e&&f(),d&&d.call(a.context,b,c,a),b.isNew()||b.trigger("sync",b,c,a)};var g=!1;return this.isNew()?c.defer(a.success):(P(this,a),g=this.sync("delete",this,a)),e||f(),g},url:function(){var a=c.result(this,"urlRoot")||c.result(this.collection,"url")||O();if(this.isNew())return a;var b=this.get(this.idAttribute);return a.replace(/[^\/]$/,"$&/")+encodeURIComponent(b)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},c.extend({},a,{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=c.extend({},this.attributes,a);var d=this.validationError=this.validate(a,b)||null;return d?(this.trigger("invalid",this,d,c.extend(b,{validationError:d})),!1):!0}});var u={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};h(t,u,"attributes");var v=b.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,c.extend({silent:!0},b))},w={add:!0,remove:!0,merge:!0},x={add:!0,remove:!1},y=function(a,b,c){c=Math.min(Math.max(c,0),a.length);var d,e=Array(a.length-c),f=b.length;for(d=0;d<e.length;d++)e[d]=a[d+c];for(d=0;f>d;d++)a[d+c]=b[d];for(d=0;d<e.length;d++)a[d+f+c]=e[d]};c.extend(v.prototype,k,{model:t,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return b.sync.apply(this,arguments)},add:function(a,b){return this.set(a,c.extend({merge:!1},b,x))},remove:function(a,b){b=c.extend({},b);var d=!c.isArray(a);a=d?[a]:a.slice();var e=this._removeModels(a,b);return!b.silent&&e.length&&(b.changes={added:[],merged:[],removed:e},this.trigger("update",this,b)),d?e[0]:e},set:function(a,b){if(null!=a){b=c.extend({},w,b),b.parse&&!this._isModel(a)&&(a=this.parse(a,b)||[]);var d=!c.isArray(a);a=d?[a]:a.slice();var e=b.at;null!=e&&(e=+e),e>this.length&&(e=this.length),0>e&&(e+=this.length+1);var f,g,h=[],i=[],j=[],k=[],l={},m=b.add,n=b.merge,o=b.remove,p=!1,q=this.comparator&&null==e&&b.sort!==!1,r=c.isString(this.comparator)?this.comparator:null;for(g=0;g<a.length;g++){f=a[g];var s=this.get(f);if(s){if(n&&f!==s){var t=this._isModel(f)?f.attributes:f;b.parse&&(t=s.parse(t,b)),s.set(t,b),j.push(s),q&&!p&&(p=s.hasChanged(r))}l[s.cid]||(l[s.cid]=!0,h.push(s)),a[g]=s}else m&&(f=a[g]=this._prepareModel(f,b),f&&(i.push(f),this._addReference(f,b),l[f.cid]=!0,h.push(f)))}if(o){for(g=0;g<this.length;g++)f=this.models[g],l[f.cid]||k.push(f);k.length&&this._removeModels(k,b)}var u=!1,v=!q&&m&&o;if(h.length&&v?(u=this.length!==h.length||c.some(this.models,function(a,b){return a!==h[b]}),this.models.length=0,y(this.models,h,0),this.length=this.models.length):i.length&&(q&&(p=!0),y(this.models,i,null==e?this.length:e),this.length=this.models.length),p&&this.sort({silent:!0}),!b.silent){for(g=0;g<i.length;g++)null!=e&&(b.index=e+g),f=i[g],f.trigger("add",f,this,b);(p||u)&&this.trigger("sort",this,b),(i.length||k.length||j.length)&&(b.changes={added:i,removed:k,merged:j},this.trigger("update",this,b))}return d?a[0]:a}},reset:function(a,b){b=b?c.clone(b):{};for(var d=0;d<this.models.length;d++)this._removeReference(this.models[d],b);return b.previousModels=this.models,this._reset(),a=this.add(a,c.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,c.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a)},unshift:function(a,b){return this.add(a,c.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a)},slice:function(){return f.apply(this.models,arguments)},get:function(a){return null!=a?this._byId[a]||this._byId[this.modelId(a.attributes||a)]||a.cid&&this._byId[a.cid]:void 0},has:function(a){return null!=this.get(a)},at:function(a){return 0>a&&(a+=this.length),this.models[a]},where:function(a,b){return this[b?"find":"filter"](a)},findWhere:function(a){return this.where(a,!0)},sort:function(a){var b=this.comparator;if(!b)throw new Error("Cannot sort a set without a comparator");a||(a={});var d=b.length;return c.isFunction(b)&&(b=c.bind(b,this)),1===d||c.isString(b)?this.models=this.sortBy(b):this.models.sort(b),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return this.map(a+"")},fetch:function(a){a=c.extend({parse:!0},a);var b=a.success,d=this;return a.success=function(c){var e=a.reset?"reset":"set";d[e](c,a),b&&b.call(a.context,d,c,a),d.trigger("sync",d,c,a)},P(this,a),this.sync("read",this,a)},create:function(a,b){b=b?c.clone(b):{};var d=b.wait;if(a=this._prepareModel(a,b),!a)return!1;d||this.add(a,b);var e=this,f=b.success;return b.success=function(a,b,c){d&&e.add(a,c),f&&f.call(c.context,a,b,c)},a.save(null,b),a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(a){return a[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(this._isModel(a))return a.collection||(a.collection=this),a;b=b?c.clone(b):{},b.collection=this;var d=new this.model(a,b);return d.validationError?(this.trigger("invalid",this,d.validationError,b),!1):d},_removeModels:function(a,b){for(var c=[],d=0;d<a.length;d++){var e=this.get(a[d]);if(e){var f=this.indexOf(e);this.models.splice(f,1),this.length--,delete this._byId[e.cid];var g=this.modelId(e.attributes);null!=g&&delete this._byId[g],b.silent||(b.index=f,e.trigger("remove",e,this,b)),c.push(e),this._removeReference(e,b)}}return c},_isModel:function(a){return a instanceof t},_addReference:function(a,b){this._byId[a.cid]=a;var c=this.modelId(a.attributes);null!=c&&(this._byId[c]=a),a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){delete this._byId[a.cid];var c=this.modelId(a.attributes);null!=c&&delete this._byId[c],this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if(b){if(("add"===a||"remove"===a)&&c!==this)return;if("destroy"===a&&this.remove(b,d),"change"===a){var e=this.modelId(b.previousAttributes()),f=this.modelId(b.attributes);e!==f&&(null!=e&&delete this._byId[e],null!=f&&(this._byId[f]=b))}}this.trigger.apply(this,arguments)}});var z={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};h(v,z,"models");var A=b.View=function(a){this.cid=c.uniqueId("view"),c.extend(this,c.pick(a,C)),this._ensureElement(),this.initialize.apply(this,arguments)},B=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];c.extend(A.prototype,k,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(a){return this.undelegateEvents(),this._setElement(a),this.delegateEvents(),this},_setElement:function(a){this.$el=a instanceof b.$?a:b.$(a),this.el=this.$el[0]},delegateEvents:function(a){if(a||(a=c.result(this,"events")),!a)return this;this.undelegateEvents();for(var b in a){var d=a[b];if(c.isFunction(d)||(d=this[d]),d){var e=b.match(B);this.delegate(e[1],e[2],c.bind(d,this))}}return this},delegate:function(a,b,c){return this.$el.on(a+".delegateEvents"+this.cid,b,c),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(a,b,c){return this.$el.off(a+".delegateEvents"+this.cid,b,c),this},_createElement:function(a){return document.createElement(a)},_ensureElement:function(){if(this.el)this.setElement(c.result(this,"el"));else{var a=c.extend({},c.result(this,"attributes"));this.id&&(a.id=c.result(this,"id")),this.className&&(a.class=c.result(this,"className")),this.setElement(this._createElement(c.result(this,"tagName"))),this._setAttributes(a)}},_setAttributes:function(a){this.$el.attr(a)}}),b.sync=function(a,d,e){var f=D[a];c.defaults(e||(e={}),{emulateHTTP:b.emulateHTTP,emulateJSON:b.emulateJSON});var g={type:f,dataType:"json"};if(e.url||(g.url=c.result(d,"url")||O()),null!=e.data||!d||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(e.attrs||d.toJSON(e))),e.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),e.emulateHTTP&&("PUT"===f||"DELETE"===f||"PATCH"===f)){g.type="POST",e.emulateJSON&&(g.data._method=f);var h=e.beforeSend;e.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",f),h?h.apply(this,arguments):void 0}}"GET"===g.type||e.emulateJSON||(g.processData=!1);var i=e.error;e.error=function(a,b,c){e.textStatus=b,e.errorThrown=c,i&&i.call(e.context,a,b,c)};var j=e.xhr=b.ajax(c.extend(g,e));return d.trigger("request",d,j,e),j};var D={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};b.ajax=function(){return b.$.ajax.apply(b.$,arguments)};var E=b.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},F=/\((.*?)\)/g,G=/(\(\?)?:\w+/g,H=/\*\w+/g,I=/[\-{}\[\]+?.,\\\^$|#\s]/g;c.extend(E.prototype,k,{initialize:function(){},route:function(a,d,e){c.isRegExp(a)||(a=this._routeToRegExp(a)),c.isFunction(d)&&(e=d,d=""),e||(e=this[d]);var f=this;return b.history.route(a,function(c){var g=f._extractParameters(a,c);f.execute(e,g,d)!==!1&&(f.trigger.apply(f,["route:"+d].concat(g)),f.trigger("route",d,g),b.history.trigger("route",f,d,g))}),this},execute:function(a,b,c){a&&a.apply(this,b)},navigate:function(a,c){return b.history.navigate(a,c),this},_bindRoutes:function(){if(this.routes){this.routes=c.result(this,"routes");for(var a,b=c.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(I,"\\$&").replace(F,"(?:$1)?").replace(G,function(a,b){return b?a:"([^/?]+)"}).replace(H,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var d=a.exec(b).slice(1);return c.map(d,function(a,b){return b===d.length-1?a||null:a?decodeURIComponent(a):null})}});var J=b.History=function(){this.handlers=[],this.checkUrl=c.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},K=/^[#\/]|\s+$/g,L=/^\/+|\/+$/g,M=/#.*$/;J.started=!1,c.extend(J.prototype,k,{interval:50,atRoot:function(){var a=this.location.pathname.replace(/[^\/]$/,"$&/");return a===this.root&&!this.getSearch()},matchRoot:function(){var a=this.decodeFragment(this.location.pathname),b=a.slice(0,this.root.length-1)+"/";return b===this.root},decodeFragment:function(a){return decodeURI(a.replace(/%25/g,"%2525"))},getSearch:function(){var a=this.location.href.replace(/#.*/,"").match(/\?.+/);return a?a[0]:""},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getPath:function(){var a=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===a.charAt(0)?a.slice(1):a},getFragment:function(a){return null==a&&(a=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),a.replace(K,"")},start:function(a){if(J.started)throw new Error("Backbone.history has already been started");if(J.started=!0,this.options=c.extend({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(L,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var b=this.root.slice(0,-1)||"/";return this.location.replace(b+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var d=document.body,e=d.insertBefore(this.iframe,d.firstChild).contentWindow;e.document.open(),e.document.close(),e.location.hash="#"+this.fragment}var f=window.addEventListener||function(a,b){return attachEvent("on"+a,b)};return this._usePushState?f("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?f("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var a=window.removeEventListener||function(a,b){return detachEvent("on"+a,b)};this._usePushState?a("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&a("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),J.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();return b===this.fragment&&this.iframe&&(b=this.getHash(this.iframe.contentWindow)),b===this.fragment?!1:(this.iframe&&this.navigate(b),void this.loadUrl())},loadUrl:function(a){return this.matchRoot()?(a=this.fragment=this.getFragment(a),c.some(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})):!1},navigate:function(a,b){if(!J.started)return!1;b&&b!==!0||(b={trigger:!!b}),a=this.getFragment(a||"");var c=this.root;""!==a&&"?"!==a.charAt(0)||(c=c.slice(0,-1)||"/");var d=c+a;if(a=this.decodeFragment(a.replace(M,"")),this.fragment!==a){if(this.fragment=a,this._usePushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,d);else{if(!this._wantsHashChange)return this.location.assign(d);if(this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getHash(this.iframe.contentWindow)){var e=this.iframe.contentWindow;b.replace||(e.document.open(),e.document.close()),this._updateHash(e.location,a,b.replace)}}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),b.history=new J;var N=function(a,b){var d,e=this;return d=a&&c.has(a,"constructor")?a.constructor:function(){return e.apply(this,arguments)},c.extend(d,e,b),d.prototype=c.create(e.prototype,a),d.prototype.constructor=d,d.__super__=e.prototype,d};t.extend=v.extend=E.extend=A.extend=J.extend=N;var O=function(){throw new Error('A "url" property or function must be specified')},P=function(a,b){var c=b.error;b.error=function(d){c&&c.call(b.context,a,d,b),a.trigger("error",a,d,b)}};return b}),define("core/lib/backbone_base_class",["require","underscore","backbone"],function(a){"use strict";var b=a("underscore"),c=a("backbone"),d=function(a){b.each(a,function(b,c){"undefined"==typeof b&&delete a[c]}),this.options=a=b.extend({},b.result(this,"defaults"),a),this.initialize.call(this,a)};return b.extend(d.prototype,c.Events,{initialize:function(){}}),d.extend=c.Model.extend,d}),function(a,b){/**
 * Unobtrusive scripting adapter for jQuery
 * https://github.com/rails/jquery-ujs
 *
 * Requires jQuery 1.8.0 or later.
 *
 * Released under the MIT license
 *
 */
a.rails!==b&&a.error("jquery-ujs has already been loaded!");var c,d=a(document);a.rails=c={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with], a[data-disable]",buttonClickSelector:"button[data-remote]:not(form button), button[data-confirm]:not(form button)",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",disableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]",csrfToken:function(){return a("meta[name=csrf-token]").attr("content")},csrfParam:function(){return a("meta[name=csrf-param]").attr("content")},CSRFProtection:function(a){var b=c.csrfToken();b&&a.setRequestHeader("X-CSRF-Token",b)},refreshCSRFTokens:function(){a('form input[name="'+c.csrfParam()+'"]').val(c.csrfToken())},fire:function(b,c,d){var e=a.Event(c);return b.trigger(e,d),e.result!==!1},confirm:function(a){return confirm(a)},ajax:function(b){return a.ajax(b)},href:function(a){return a[0].href},handleRemote:function(d){var e,f,g,h,i,j;if(c.fire(d,"ajax:before")){if(h=d.data("with-credentials")||null,i=d.data("type")||a.ajaxSettings&&a.ajaxSettings.dataType,d.is("form")){e=d.attr("method"),f=d.attr("action"),g=d.serializeArray();var k=d.data("ujs:submit-button");k&&(g.push(k),d.data("ujs:submit-button",null))}else d.is(c.inputChangeSelector)?(e=d.data("method"),f=d.data("url"),g=d.serialize(),d.data("params")&&(g=g+"&"+d.data("params"))):d.is(c.buttonClickSelector)?(e=d.data("method")||"get",f=d.data("url"),g=d.serialize(),d.data("params")&&(g=g+"&"+d.data("params"))):(e=d.data("method"),f=c.href(d),g=d.data("params")||null);return j={type:e||"GET",data:g,dataType:i,beforeSend:function(a,e){return e.dataType===b&&a.setRequestHeader("accept","*/*;q=0.5, "+e.accepts.script),c.fire(d,"ajax:beforeSend",[a,e])?void d.trigger("ajax:send",a):!1},success:function(a,b,c){d.trigger("ajax:success",[a,b,c])},complete:function(a,b){d.trigger("ajax:complete",[a,b])},error:function(a,b,c){d.trigger("ajax:error",[a,b,c])},crossDomain:c.isCrossDomain(f)},h&&(j.xhrFields={withCredentials:h}),f&&(j.url=f),c.ajax(j)}return!1},isCrossDomain:function(a){var b=document.createElement("a");b.href=location.href;var c=document.createElement("a");try{return c.href=a,c.href=c.href,!c.protocol||!c.host||b.protocol+"//"+b.host!=c.protocol+"//"+c.host}catch(a){return!0}},handleMethod:function(d){var e=c.href(d),f=d.data("method"),g=d.attr("target"),h=c.csrfToken(),i=c.csrfParam(),j=a('<form method="post" action="'+e+'"></form>'),k='<input name="_method" value="'+f+'" type="hidden" />';i===b||h===b||c.isCrossDomain(e)||(k+='<input name="'+i+'" value="'+h+'" type="hidden" />'),g&&j.attr("target",g),j.hide().append(k).appendTo("body"),j.submit()},formElements:function(b,c){return b.is("form")?a(b[0].elements).filter(c):b.find(c)},disableFormElements:function(b){c.formElements(b,c.disableSelector).each(function(){c.disableFormElement(a(this))})},disableFormElement:function(a){var c,d;c=a.is("button")?"html":"val",d=a.data("disable-with"),a.data("ujs:enable-with",a[c]()),d!==b&&a[c](d),a.prop("disabled",!0)},enableFormElements:function(b){c.formElements(b,c.enableSelector).each(function(){c.enableFormElement(a(this))})},enableFormElement:function(a){var b=a.is("button")?"html":"val";a.data("ujs:enable-with")&&a[b](a.data("ujs:enable-with")),a.prop("disabled",!1)},allowAction:function(a){var b,d=a.data("confirm"),e=!1;if(!d)return!0;if(c.fire(a,"confirm")){try{e=c.confirm(d)}catch(a){(console.error||console.log).call(console,a.stack||a)}b=c.fire(a,"confirm:complete",[e])}return e&&b},blankInputs:function(b,c,d){var e,f,g=a(),h=c||"input,textarea",i=b.find(h);return i.each(function(){if(e=a(this),f=e.is("input[type=checkbox],input[type=radio]")?e.is(":checked"):e.val(),!f==!d){if(e.is("input[type=radio]")&&i.filter('input[type=radio]:checked[name="'+e.attr("name")+'"]').length)return!0;g=g.add(e)}}),g.length?g:!1},nonBlankInputs:function(a,b){return c.blankInputs(a,b,!0)},stopEverything:function(b){return a(b.target).trigger("ujs:everythingStopped"),b.stopImmediatePropagation(),!1},disableElement:function(a){var d=a.data("disable-with");a.data("ujs:enable-with",a.html()),d!==b&&a.html(d),a.bind("click.railsDisable",function(a){return c.stopEverything(a)})},enableElement:function(a){a.data("ujs:enable-with")!==b&&(a.html(a.data("ujs:enable-with")),a.removeData("ujs:enable-with")),a.unbind("click.railsDisable")}},c.fire(d,"rails:attachBindings")&&(a.ajaxPrefilter(function(a,b,d){a.crossDomain||c.CSRFProtection(d)}),a(window).on("pageshow.rails",function(){a(a.rails.enableSelector).each(function(){var b=a(this);b.data("ujs:enable-with")&&a.rails.enableFormElement(b)}),a(a.rails.linkDisableSelector).each(function(){var b=a(this);b.data("ujs:enable-with")&&a.rails.enableElement(b)})}),d.delegate(c.linkDisableSelector,"ajax:complete",function(){c.enableElement(a(this))}),d.delegate(c.buttonDisableSelector,"ajax:complete",function(){c.enableFormElement(a(this))}),d.delegate(c.linkClickSelector,"click.rails",function(d){var e=a(this),f=e.data("method"),g=e.data("params"),h=d.metaKey||d.ctrlKey;if(!c.allowAction(e))return c.stopEverything(d);if(!h&&e.is(c.linkDisableSelector)&&c.disableElement(e),e.data("remote")!==b){if(h&&(!f||"GET"===f)&&!g)return!0;var i=c.handleRemote(e);return i===!1?c.enableElement(e):i.fail(function(){c.enableElement(e)}),!1}return f?(c.handleMethod(e),!1):void 0}),d.delegate(c.buttonClickSelector,"click.rails",function(b){var d=a(this);if(!c.allowAction(d))return c.stopEverything(b);d.is(c.buttonDisableSelector)&&c.disableFormElement(d);var e=c.handleRemote(d);return e===!1?c.enableFormElement(d):e.fail(function(){c.enableFormElement(d)}),!1}),d.delegate(c.inputChangeSelector,"change.rails",function(b){var d=a(this);return c.allowAction(d)?(c.handleRemote(d),!1):c.stopEverything(b)}),d.delegate(c.formSubmitSelector,"submit.rails",function(d){var e,f,g=a(this),h=g.data("remote")!==b;if(!c.allowAction(g))return c.stopEverything(d);if(g.attr("novalidate")==b&&(e=c.blankInputs(g,c.requiredInputSelector),e&&c.fire(g,"ajax:aborted:required",[e])))return c.stopEverything(d);if(h){if(f=c.nonBlankInputs(g,c.fileInputSelector)){setTimeout(function(){c.disableFormElements(g)},13);var i=c.fire(g,"ajax:aborted:file",[f]);return i||setTimeout(function(){c.enableFormElements(g)},13),i}return c.handleRemote(g),!1}setTimeout(function(){c.disableFormElements(g)},13)}),d.delegate(c.formInputClickSelector,"click.rails",function(b){var d=a(this);if(!c.allowAction(d))return c.stopEverything(b);var e=d.attr("name"),f=e?{name:e,value:d.val()}:null;d.closest("form").data("ujs:submit-button",f)}),d.delegate(c.formSubmitSelector,"ajax:send.rails",function(b){this==b.target&&c.disableFormElements(a(this))}),d.delegate(c.formSubmitSelector,"ajax:complete.rails",function(b){this==b.target&&c.enableFormElements(a(this))}),a(function(){c.refreshCSRFTokens()}))}(jQuery),define("jquery-ujs",["jquery"],function(){}),define("core/lib/util/authenticity_token",["require","underscore","jquery","core/lib/backbone_base_class","jquery-ujs"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/backbone_base_class");a("jquery-ujs");var e=d.extend({defaults:{_token:void 0},get:function(){return this._token||this._getFromDom()},set:function(a){this._token=a,this._setInDom()},_getFromDom:b.memoize(function(){return c("meta[name=csrf-token]").attr("content")||c("#authenticity_token").attr("content")||c('input[name="authenticity_token"]').val()}),_setInDom:function(){var a=c(document.head||document.getElementsByTagName("head")[0]),b=c("meta[name=csrf-token]"),d=c("meta[name=csrf-param]");b.length?b.attr("content",this._token):(b=c('<meta name="csrf-token" content="'+this._token+'"/>'),a.append(b)),d.length||(d=c('<meta name="csrf-param" content="authenticity_token"/>'),a.append(d))}});return new e}),define("core/lib/yammer_config",["require","underscore"],function(a){function b(){var a;if(2===arguments.length&&"string"==typeof arguments[0]){var b=arguments[0],c=arguments[1];e[b]=c}else 1===arguments.length&&(a=arguments[0]);return a&&"object"==typeof a&&(e=d.extend(e,a)),d.extend({},e)}function c(){e={}}var d=a("underscore"),e={debug:!1};return yam.config=b,{config:b,destroy:c}}),define("core/lib/adapters/console_shim",[],function(){window.console||(window.console={}),function(){var a,b,c=function(){},d=["assert","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","time","timeEnd","trace","warn"];for(a=d.length;a--;)b=d[a],console[b]||(console[b]=c)}()}),define("core/lib/log",["require","underscore","core/lib/yammer_config","core/lib/adapters/console_shim"],function(a){var b=a("underscore"),c=a("core/lib/yammer_config");a("core/lib/adapters/console_shim");var d=function(a){var d,e,f=Array.prototype.slice.call(arguments,1),g=c.config();if(e=g.debugModules,e=e&&e.split(","),g.debug||e){var h,i=f[0];if("string"==typeof i?h=b.find(e,function(a){return-1!==i.indexOf(a)}):(console.log("First arg to yam."+a+" must be a string so we can do module-filtering."),console.log(i)),e&&!h)return;d=(new Date).toString(),f.push(d),console[a].apply(console,f)}},e={log:function(){var a=function(){};return"undefined"!=typeof console&&"function"==typeof console.log&&(a=b.partial(d,"log")),a}(),warn:function(){var a=function(){},c="undefined"!=typeof console;return!window.jasmine&&c&&"function"==typeof console.warn?a=b.partial(d,"warn"):c&&"function"==typeof console.log&&(a=b.partial(d,"log")),function(){var b=Array.prototype.slice.call(arguments,0);b.unshift("[YJ Warning]"),a.apply(null,b)}}(),deprecate:function(a,b,c){var d="string"==typeof a?a:a.declaredClass,e="deprecation warning for "+d+"."+b;c&&(e+=": "+c),this.log(e)}};return e}),define("core/lib/cookie_helper",["require","underscore"],function(a){"use strict";var b=a("underscore"),c=function(a){return"string"==typeof a.domain?"Domain="+a.domain:void 0},d=function(a){var b="string"==typeof a.path?a.path:"/";return"Path="+b},e=function(a){var c;if("string"==typeof a.expiry)c=a.expiry;else if(b.isDate(a.expiry))c=a.expiry.toUTCString();else{var d=new Date;d.setDate(d.getDate()+f(a)),c=d.toUTCString()}return"Expires="+c},f=function(a){return"number"==typeof a.days?a.days:30},g=function(a){var c="Secure";return"string"==typeof a.flags?c=a.flags:b.isArray(a.flags)&&(c=a.flags.join("; ")),c},h={get:function(a){var b=this.readCookie(),c=b&&(b.match("(^|; )"+a+"=([^;]*)")||0)[2];return null!=c?decodeURIComponent(c):c},set:function(a){if(!(a&&a.name&&a.value))throw new Error("CookieHelper.set was not given a name and value");var f=a.name+"="+b.chain([encodeURIComponent(a.value),c(a),d(a),e(a),g(a)]).compact().join("; ").value();this.assignCookie(f)},unset:function(a){if(!a||!a.name)throw new Error("CookieHelper.unset was not given a name");a.expiry=new Date("1970/01/01 00:00:01 GMT").toUTCString();var f=a.name+"=; "+b.chain([c(a),d(a),e(a)]).compact().join("; ").value();this.assignCookie(f)},assignCookie:function(a){document.cookie=a},readCookie:function(){return document.cookie}};return h}),define("core/lib/session",["require","underscore","core/lib/cookie_helper"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/cookie_helper");return{getCurrentUser:function(){return this._currentUser},setCurrentUser:function(a){return a&&!a.declaredClass&&(a=yam.model.User.save(a)),this._currentUser=a,a&&this._updateLocaleCookie(),a},_updateLocaleCookie:function(){var a=this.getUserSetting("locale");null!=a&&c.set({name:"locale",value:a,days:365})},getCurrentNetwork:function(){return this._currentNetwork},setCurrentNetwork:function(a){return a&&!a.declaredClass&&(a=yam.model.Network.save(a)),this._currentNetwork=a,a},getAllNetworks:function(){return this._allNetworks},setAllNetworks:function(a){return a=b.map(a,function(a){return a&&!a.declaredClass?yam.model.Network.save(b.extend({is_current:a.id===this._currentNetwork.id},a)):a},this),this._allNetworks=a,a},getUserSetting:function(a){return this._sanitizeValue(this._webPreferences()[a])},getUserNetworkSetting:function(a){return this._sanitizeValue(this._networkPreferences()[a])},_webPreferences:function(){return this._currentUser.web_preferences||{}},_networkPreferences:function(){return this._webPreferences().network_settings||{}},_sanitizeValue:function(a){switch(a){case"true":return!0;case"false":return!1;default:return a}}}}),define("core/lib/string_helper",["require","underscore"],function(a){var b=a("underscore"),c={};c.escapeRegExp=function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};var d=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;c.trim=function(a){return a?a.replace(d,""):""},c.snakeize=function(){var a=/([A-Z]+)/g,b=/^_/g;return function(d,e){var f=e||"_",g=e?new RegExp("^"+c.escapeRegExp(f),"g"):b;return d.replace(a,f+"$1").toLowerCase().replace(g,"")}}(),c.camelize=function(){var a=/[-_](\w)/g;return function(b,d){var e=b.replace(a,function(a,b){return b.toUpperCase()});return e=d?c.capitalize(e):e}}(),c.capitalize=function(a){return a?a.substr(0,1).toUpperCase()+a.substr(1):void 0},c.singularize=function(a){return a.replace(/s$/,"")};var e,f,g=function(a){return void 0===e&&(e=document.createElement("div")),e.innerHTML=a,e.textContent||e.innerText},h=function(a){return a.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")},i=function(){return void 0===f&&(f="hello world"===g("<p>hello</p> world")),f};c.stripHtmlTags=function(a){return i()?g(a):h(a)},c.convertStringyBoolean=function(a){return"false"===a||"0"===a?!1:!!a};var j=function(a,b,c){if(!a)return"";a+="";var d=c||{};if(a.length<=b||d.max&&a.length<=d.max)return a;var e="";return d.file?(e=a.substring(0,b-b/2),e+=d.truncationChar||"…",e+=a.substring(a.length,a.length-b/2)):(e=d.truncateOnWords?a.substring(0,b).replace(/\s\S+$|\s$/,""):a.substring(0,b),e+=d.truncationChar||"…"),e};return c.truncate=b.memoize(function(a,b,c){return j(a,b,c)},function(a,b,c){return""+a+b+JSON.stringify(c||{})}),c._synonymsList=[["a","à","á","â","ã","ä","å"],["ae","æ"],["c","ç"],["e","è","é","ê","ë"],["i","ì","í","î","ï"],["l","ł"],["n","ñ"],["o","ò","ó","ô","õ","ö"],["oe","œ"],["u","ù","ú","û","ü"],["y","ý","ÿ"]],c.removeAccents=function(a){return b(c._synonymsList).each(function(b){for(var c=b[0],d=1;d<b.length;d++){var e=b[d];a=a.replace(new RegExp(e,"g"),c)}}),a},c}),define("core/lib/uri_helper",["require","underscore","core/lib/session","core/lib/string_helper"],function(a){
// To prevent jsmin from removing copyright, /*! */ is added.
/*!
  // a node.js module fork of
  // parseUri 1.2.2
  // (c) Steven Levithan <stevenlevithan.com>
  // MIT License
  // see: http://blog.stevenlevithan.com/archives/parseuri
  // see: http://stevenlevithan.com/demo/parseuri/js/
  */
function b(a){for(var c=b.options,d=c.parser[c.strictMode?"strict":"loose"].exec(a||""),e={},f=c.key.length;f--;)e[c.key[f]]=d[f]||"";return e[c.q.name]=g.objectify(e.query)||{},e}function c(a){return"/"===d.last(a)}var d=a("underscore"),e=a("core/lib/session"),f=a("core/lib/string_helper"),g={};b.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},g.parse=b,g.stringify=function(a){for(var b,c=["protocol","user","password","host","port","directory","file","query","anchor"],d="",e=0,f=c.length;f>e;e++){if(b=c[e],"password"===b&&a[b]&&(d+=":"),"host"===b&&a.userInfo&&(d+="@"),"port"===b&&a[b]&&(d+=":"),"anchor"===b&&a[b]&&(d+="#"),"query"===b&&a.queryKey){var h=g.paramify(a.queryKey);h=h||a[b],h&&(d+="?"+h)}else d+=a[b];"protocol"===b&&a[b]&&(d+="://")}return d},g.replaceParam=function(a,b,c){if(void 0===c)return a;var d=new RegExp("\\b("+b+"=).*?(&|$)");return a.search(d)>-1?a.replace(d,"$1"+c+"$2"):a+(a.indexOf("?")>0?"&":"?")+b+"="+c},g.normalize=function(a){a.match(/^[^:\/?#]+:\/\/.*/)||(a="http://"+a);var b=[],d=this.parse(a);null!=d.protocol&&b.push(d.protocol.toLowerCase()+":"),null!=d.authority&&b.push("//"+d.authority);for(var e=(d.path||"/").split("/"),f=[],g=0;g<e.length;g++){var h=e[g];"."!==h&&(".."===h?f.pop():h&&f.push(h))}var i="/"+f.join("/");return c(d.path)&&!c(i)&&(i+="/"),b.push(i),d.query&&b.push("?"+d.query),d.anchor&&b.push("#"+d.anchor),b.join("")},g.isIntranet=function(a){return a.indexOf(".")<0},g.isInternal=function(a){var b=["www.yammer.dev","www.yammer.com","www.staging.yammer.com"],c=this.parse(a).host;return d.contains(b,c)};var h=function(a,b){if(!g.isNetworkRelative(a))return!1;var c=g.parse(a),d=c.path.match(b);return d&&d[1]?parseInt(d[1],10):(d=c.anchor.match(b),d&&d[1]?parseInt(d[1],10):!1)};/*
   * Copyright (C) Matthew Eernisse
   *       https://github.com/mde/geddy
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *      http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return g.extractNoteId=function(a){return h(a,/notes\/(\d+)/)},g.extractFileId=function(a){return h(a,/files\/(\d+)/)},g.isNetworkRelative=function(a){var b=this.parse(a),c=b.protocol+"://"+b.authority+b.path,d=e.getCurrentNetwork(),f=d.web_url;return 0===c.indexOf(f)},g.extractThreadId=function(a){var b,c,d;return g.isNetworkRelative(a)&&(d=this.parse(a),c=d.path.match(/messages\/(\d+)/),null!=c&&c.length>0?b=c[1]:(c=d.anchor.match(/threadId=(\d+)/),null!=c&&c.length>0&&(b=c[1]))),b},g.HREF_PATTERN=new RegExp("\\b((?:https?:(?:\\/{1,3}|[a-z0-9%])|www\\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]+\\/)(?:[^\\s()<>]|\\((?:[^\\s()<>]|(?:\\([^s()<>]\\)))*\\))+(?:\\((?:[^\\s()<>]|(?:\\([^\\s()<>]+\\)))*\\)|[^&=\\s`!()\\[\\];:'\".,<>?«»“”‘’]))","gi"),g.objectify=function(a,b){var c=b||{},d={},e="undefined"==typeof c.consolidate?!0:c.consolidate,f=/\+/g;if(a)for(var g=a.split("&"),h=0;h<g.length;h++){var i=g[h].split("="),j=i[0],k=i[1];try{k=decodeURIComponent((i[1]||"").replace(f,"%20"))}catch(a){}"undefined"!=typeof d[j]&&e?("string"==typeof d[j]&&(d[j]=[d[j]]),d[j].push(k)):d[j]=k}return d},g.paramify=function(a,b){var c,e,g,h,i,j=b||{},k="",l=[];for(var m in a)if(Object.prototype.hasOwnProperty.call(a,m))if(e=a[m],g=!(null===e||void 0===e||"number"==typeof e&&isNaN(e)),c=j.snakeize?f.snakeize(m):m,g){if(d.isArray(e)&&e.length){h=[];for(var n=0,o=e.length;o>n;n++)i=e[n],g=!(null===i||void 0===i||"number"==typeof i&&isNaN(i)),h[n]=g?encodeURIComponent(i):"",j.escapeVals&&(h[n]=d.escape(h[n]));j.consolidate?l.push(c+"="+h.join(",")):l.push(c+"="+h.join("&"+c+"="))}else j.escapeVals&&(e=d.escape(e)),l.push(c+"="+encodeURIComponent(e));k+="&"}else j.includeEmpty&&l.push(c+"=");return l.join("&")},g}),define("core/lib/location_helper",[],function(){var a=function(a){return function(){return window.location[a]}};return{hash:a("hash"),host:a("host"),hostname:a("hostname"),href:a("href"),origin:a("origin"),pathname:a("pathname"),port:a("port"),protocol:a("protocol"),search:a("search"),assign:function(a){window.location.assign(a)},replace:function(a){window.location.replace(a)},reload:function(a){window.location.reload(!!a)},back:function(){window.history.back()},forward:function(){window.history.forward()}}}),define("core/lib/yammer_uri",["require","core/lib/session","core/lib/uri_helper","core/lib/yammer_config","core/lib/string_helper","core/lib/location_helper","underscore"],function(a){"use strict";var b=a("core/lib/session"),c=a("core/lib/uri_helper"),d=a("core/lib/yammer_config"),e=a("core/lib/string_helper"),f=a("core/lib/location_helper"),g=a("underscore"),h=function(a){return a&&0!==a.indexOf("/")&&1!==a.indexOf("/")?a.substr(a.indexOf("/",8)):a},i={_hostJoin:function(a,b){return b.unshift(a),this.join.apply(this,b)},base:function(){var a=g.toArray(arguments),b=d.config().baseURI;return a.length>0?this._hostJoin(b,a):b||""},cdn:function(){return this._hostJoin(d.config().cdnAssetHost,g.toArray(arguments))},mugshot:function(){return this._hostJoin(d.config().cdnMugshotHost,g.toArray(arguments))},apiBase:function(){var a=d.config();return a.appId?a.apiBaseURI?a.apiBaseURI:this.base().replace("www.","api."):this.base()},_appendParameters:function(a,b){var d=a.indexOf("?")>=0;return a+(d?"&":"?")+c.paramify(b)},app:function(a,c){var d=b.getCurrentNetwork(),e=d&&d.permalink,f=e?this.join(this.base(),e,a):this.join(this.base(),a);return c&&(f=this._appendParameters(f,c)),f},_api:function(a,b,c){var d=this.join(this.apiBase(),a,b);return c&&(d=this._appendParameters(d,c)),d},api:function(a,b){return this._api("api/v1",a,b)},apiV2:function(a,b){return this._api("api/v2",a,b)},join:function(){for(var a,b=[],c="",d=0;d<arguments.length;++d)a=arguments[d],a=g.isString(a)||g.isNumber(a)?""+a:!1,a&&(d>0&&(a=a.replace(/^\//,"")),b.push(a));return c=b.join("/"),arguments[0]||(c="/"+c),c=c.replace(/([^:])\/{2,}/g,"$1/"),c=c.replace(/^\/{2,}#/g,"/#")},getNetworkFromUrl:function(){var a=decodeURIComponent(f.pathname()),b=new RegExp("^/([^/]+)(/.*|/?$)","i"),c=a.match(b);return c&&c[1]},isHomeLocation:function(a){a=a||b.getCurrentNetwork();var c=f.pathname(),d=new RegExp("^/"+e.escapeRegExp(a.permalink||"")+"/?$","i");return!!decodeURIComponent(c).match(d)},makeAbsoluteUrl:function(a){return i.base(h(a))}};return i}),define("core/lib/yammer_bootstrap_utils",["require","jquery","underscore","core/lib/cookie_helper"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/cookie_helper"),e=function(){var a=c.reduce(window.localStorage,function(a,b,c){var d=window.localStorage.key(c);return d&&d.match(/^(tokens|networks|usage-policy|user-.*)$/)&&a.push(d),a},[]);return c.each(a,function(a){window.localStorage.removeItem(a)}),b.Deferred().resolve().promise()},f=function(){return d.unset({name:"browser_token"}),d.unset({name:"oauth_token"}),d.unset({name:"last_network"}),b.Deferred().resolve().promise()};return{clearLocalStorage:e,clearStaticCookies:f}}),define("core/lib/yammer_request",["require","jquery","underscore","core/lib/util/authenticity_token","core/lib/log","core/lib/session","core/lib/uri_helper","core/lib/yammer_config","core/lib/yammer_uri","core/lib/location_helper","core/lib/yammer_bootstrap_utils"],function(a){var b,c=a("jquery"),d=a("underscore"),e=a("core/lib/util/authenticity_token"),f=a("core/lib/log"),g=a("core/lib/session"),h=a("core/lib/uri_helper"),i=a("core/lib/yammer_config"),j=a("core/lib/yammer_uri"),k=a("core/lib/location_helper"),l=a("core/lib/yammer_bootstrap_utils"),m=1e6,n="yammer_page_load_id_",o={_authToken:null,_getAuthToken:function(a){var b=this,c=a.error||function(){},d=a.complete||function(){},e=j.join(j.base(),"oauth2/access_token.json");C.send({url:e,auth:!1,data:{client_id:i.config().appId},success:function(c){return c&&c.access_token?(b._authToken=c.access_token,b.onRetry(a)):void this.error()},error:function(){b._authToken=null,"function"==typeof c&&c.apply(a,arguments)},complete:function(){b._authToken||d.apply(this,arguments)}})},setAuthToken:function(a){return"string"==typeof a?void(this._authToken={token:a}):void(this._authToken=a)},onRetry:function(){y.apply(null,arguments)},getAuthenticationToken:function(){return this._authToken&&this._authToken.token},getAuthenticationHeaders:function(){return this._authToken?{Authorization:"Bearer "+this._authToken.token}:{}},getParamsForWrite:function(){return this._authToken?{access_token:this._authToken.token}:{}},_authFailed:function(a,b){return 401==b.status&&b.getResponseHeader("WWW-Authenticate")},_addRetryHandler:function(a){var b=this,c=1,d=a.error;"undefined"==typeof a._retries||null==a._retries?a._retries=c:a._retries--;var e=function(c,e){return a.error=d,"error"===e&&b._authFailed(a,c)&&i.config().appId&&(b.setAuthToken(null),a.context===a&&delete a.context,a._retries>0)?(f.log("oauth2 retry:",a),y(a)):"function"==typeof d?d.apply(this,arguments):void 0};a.error=e},beforeSend:function(a,b){var c=this;return c._authToken?(c._authToken&&c._addRetryHandler(b),void C.util.addAuthenticationParams(b,a,c,c._networkId)):(window.setTimeout(function(){c._getAuthToken(b)},10),!1)}},p=function(a){var c=b;if(a&&"auth"in a&&(a.auth===!1&&(c=null),a.auth&&"object"==typeof a.auth&&(c=a.auth),"string"==typeof a.auth))switch(a.auth){case"oauth2":c=o}return c},q=function(a){return b="string"==typeof a?p({auth:a}):a},r=d.once(function(){q(o)}),s=function(a){var b=/\.{2,}(\/|$)/g;if(b.test(a)){var d=h.parse(a);d.directory=c.trim(d.directory).replace(b,""),d.file=c.trim(d.file).replace(b,""),a=h.stringify(d)}return a},t=function(a,b){a=d.extend({},a);var c=a["yammer-capabilities"];return c=null==c?b:d.union(c.split(","),[b]).join(","),d.extend(a,{"yammer-capabilities":c})},u=function(a,b){var c=d.extend({},a.headers);a.headers=d.extend(c,b)},v=function(a){var b=d.extend({dataType:"json",cache:!1},a);b.url=s(b.url),b.method?b.type=b.method:(b.type=b.type||"GET",b.method=b.type),"PUT"!=b.type&&"PATCH"!=b.type&&"DELETE"!=b.type||(b.data||(b.data={}),b.data._method=b.type,b.type=b.method="POST");var f=b.dataFilter;if(b.dataFilter=function(a,b){return a="json"==b&&""===c.trim(a)?"{}":a,f&&(a=f(a,b)),a},0===b.url.indexOf(j.api())){var g=a.headers||{};if(g=t(g,"external-messaging"),g=t(g,"parsed-body-only2"),g=t(g,"user-sidebar"),g=t(g,"external-groups"),b.headers=g,i.config().isEmbed&&u(b,{"yammer-client-id-override":m}),u(b,{"yammer-page-load-id":C.getPageLoadId(),"yammer-client-load-time":C.getClientLoadTime(),"yammer-client-event-time":Date.now()}),i.config().sendTelemetryIdHeaders){var h=n+C.getPageLoadId();u(b,{HTTP_X_TELEMETRY_SESSIONID:h})}}var k=a.beforeSend;b.beforeSend=function(){return w.apply(this,arguments)===!1?!1:"function"!=typeof k||k.apply(this,arguments)!==!1};var l=b.url||"",o=/\/api\/v1\/notes\/\d+\/revert_to_version\/\d+/.test(l),p="POST"==(b.type||b.method||"GET").toUpperCase();return p&&o&&C.util.addData(b,{authenticity_token:e.get()}),b},w=function(a){var b,c=p(this,a);return c&&"function"==typeof c.beforeSend&&(b=c.beforeSend(a,this)),b},x=function(a){return r(),a=v(a),a.error=z(null,a),c.ajax.apply(null,arguments)},y=function(){c.ajax.apply(null,arguments)},z=function(a,b){var c=b.error||function(){},d=b.url,e=!!d&&d.indexOf("//")>=0&&d.indexOf(i.config().baseURI)<0,h=/\/whoville\//.test(d),j=/\/(auto)?complete\//.test(d),k=/\/streams\//.test(d),l=/\/suggest\//.test(d),m=/\/language\/translate\//.test(d),n=/\/experiments\//.test(d),o=/\/banners\//.test(d),p=/\/o365\/verified_domains/.test(d),q=/\/network_migrations/.test(d),r=/\/events$/.test(d);if(!d||e||h||j||k||l||m||n||o||p||q||r)return function(a,b,g){f.log("Do NOT logout session for unauthorized status code.\nREASON: ","isWhoville=",h,"isCompletie=",j,"isStreams=",k,"isSuggests=",l,"isTranslate=",m,"isExperimentUrl=",n,"isExternal=",e,"isBannersUrl=",o,"isFusionDomain=",p,"isFusionMigration=",q,"isEventsUrl=",r,"hasNoUrl=",!d,"\nrequestUrl=",d),c.apply(this,[a,b,g])};var s=function(a,b,e){c.apply(this,[a,b,e]);var h=401==a.status,j=g.getCurrentUser(),k=j?yam.helper.user.isInactive(j):!1,l="?trk_event=session_mgmt_logout_"+(a.status||"unknown")+"&trk_unauthorized_url_trunc="+encodeURIComponent((d||"").replace(i.config().baseURI,"").substr(0,70));f.log("session_mgmt_logout check on API response error:\n","requestUrl=",d,"\nerrObj.status=",a.status,"\nWill trigger session logout?=",h&&!k,"\nisAccessDenied401=",h,"isDeactivatedOrDeletedUser=",k),h&&!k&&C.send({type:"POST",url:"/logout"+l,data:{_method:"delete"},complete:C.util.goToLogoutLanding})};return s},A=d.memoize(function(){var a=Date.now(),b=Math.floor(1e7*Math.random());return a+"."+b}),B=d.memoize(function(){return Date.now()}),C={send:x,getAuthenticator:p,setAuthenticator:q,getPageLoadId:A,getClientLoadTime:B};return C.util={isChangeRequest:function(a){var b=a.type.toLowerCase();return"get"!==b&&"head"!==b},reEncoded:/application\/x-www-form-urlencoded/i,isURLEncoded:function(a){return"undefined"==typeof a.contentType||this.reEncoded.test(a.contentType)},addData:function(a,b){b&&(a.data=a.data||"","object"==typeof a.data?("string"==typeof b&&(b=h.objectify(b)),a.data=d.extend(a.data,b)):("object"==typeof b&&(b=h.paramify(b,{includeEmpty:!0})),a.data+="&"+b))},addAuthenticationParams:function(a,b,c,e){var f,g,h;if(this._isAPICall(a.url)&&"function"==typeof c.getAuthenticationHeaders){g=c.getAuthenticationHeaders(e),a.headers||(a.headers={}),d.extend(a.headers,g);for(f in g)b.setRequestHeader(f,g[f])}this.isChangeRequest(a)&&this.isURLEncoded(a)&&"function"==typeof c.getParamsForWrite&&(h=c.getParamsForWrite(e),this.addData(a,h),a.data&&(a.headers||(a.headers={}),a.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",b.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")))},_isAPICall:function(a){var b=0===a.indexOf(j.api()),c=0===a.indexOf(j.apiV2());return b||c?!0:0===a.indexOf("/api/")},goToLogoutLanding:function(){l.clearLocalStorage(),l.clearStaticCookies(),k.assign("/logout_landing")}},yam.request=C,C}),define("core/lib/util/sync_with_request",["require","underscore","core/lib/yammer_request"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/yammer_request"),d={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"},e=function(a,e,f){var g=d[a];b.defaults(f,{type:g,dataType:"json",url:b.result(e,"url")}),"PUT"!==g&&"DELETE"!==g&&"PATCH"!==g||(f.type="POST",f.data=b.extend({_method:g},f.data),f.headers=b.extend({"X-HTTP-Method-Override":g},f.headers));var h=c.send(f);return e.trigger("request",e,h.xhr,f),h.xhr};return e}),function(a){function b(){try{return g in a&&a[g]}catch(a){return!1}}function c(a){return a.replace(/^d/,"___$&").replace(l,"___")}var d,e={},f=a.document,g="localStorage",h="script";if(e.disabled=!1,e.version="1.3.17",e.set=function(a,b){},e.get=function(a,b){},e.has=function(a){return void 0!==e.get(a)},e.remove=function(a){},e.clear=function(){},e.transact=function(a,b,c){null==c&&(c=b,b=null),null==b&&(b={});var d=e.get(a,b);c(d),e.set(a,d)},e.getAll=function(){},e.forEach=function(){},e.serialize=function(a){return JSON.stringify(a)},e.deserialize=function(a){if("string"==typeof a)try{return JSON.parse(a)}catch(b){return a||void 0}},b())d=a[g],e.set=function(a,b){return void 0===b?e.remove(a):(d.setItem(a,e.serialize(b)),b)},e.get=function(a,b){var c=e.deserialize(d.getItem(a));return void 0===c?b:c},e.remove=function(a){d.removeItem(a)},e.clear=function(){d.clear()},e.getAll=function(){var a={};return e.forEach(function(b,c){a[b]=c}),a},e.forEach=function(a){for(var b=0;b<d.length;b++){var c=d.key(b);a(c,e.get(c))}};else if(f.documentElement.addBehavior){var i,j;try{j=new ActiveXObject("htmlfile"),j.open(),j.write("<"+h+">document.w=window</"+h+'><iframe src="/favicon.ico"></iframe>'),j.close(),i=j.w.frames[0].document,d=i.createElement("div")}catch(a){d=f.createElement("div"),i=f.body}var k=function(a){return function(){var b=Array.prototype.slice.call(arguments,0);b.unshift(d),i.appendChild(d),d.addBehavior("#default#userData"),d.load(g);var c=a.apply(e,b);return i.removeChild(d),c}},l=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");e.set=k(function(a,b,d){return b=c(b),void 0===d?e.remove(b):(a.setAttribute(b,e.serialize(d)),a.save(g),d)}),e.get=k(function(a,b,d){b=c(b);var f=e.deserialize(a.getAttribute(b));return void 0===f?d:f}),e.remove=k(function(a,b){b=c(b),a.removeAttribute(b),a.save(g)}),e.clear=k(function(a){var b=a.XMLDocument.documentElement.attributes;a.load(g);for(var c,d=0;c=b[d];d++)a.removeAttribute(c.name);a.save(g)}),e.getAll=function(a){var b={};return e.forEach(function(a,c){b[a]=c}),b},e.forEach=k(function(a,b){for(var c,d=a.XMLDocument.documentElement.attributes,f=0;c=d[f];++f)b(c.name,e.deserialize(a.getAttribute(c.name)))})}try{var m="__storejs__";e.set(m,m),e.get(m)!=m&&(e.disabled=!0),e.remove(m)}catch(a){e.disabled=!0}e.enabled=!e.disabled,"undefined"!=typeof module&&module.exports&&this.module!==module?module.exports=e:"function"==typeof define&&define.amd?define("store",e):a.store=e}(Function("return this")()),define("core/lib/adapters/store_adapter",["require","jquery","underscore","backbone","store","core/lib/session"],function(a){function b(a){d.defer(function(){var b=a.originalEvent,c=b.key;if(g.getCurrentNetwork()&&g.getCurrentUser()){var e="-"+g.getCurrentNetwork().id+"-"+g.getCurrentUser().id;if(c.indexOf(e)===c.length-e.length){var h=JSON.parse(b.newValue),i=h&&h.id,j=h&&h.value,k=h&&h.suppress,l=f.removeSuffix(c);k||d.indexOf(f.idList,i)>-1||(f.trigger("storageEvent",l),f.trigger("storageEvent:"+l,{newValue:j}))}}},a)}var c=a("jquery"),d=a("underscore"),e=a("backbone"),f=a("store"),g=a("core/lib/session");d.extend(f,e.Events),c(window).on("storage",b),"onstorage"in document&&c(document).on("storage",function(a){var c=localStorage.getItem("_ie8_last_storage_event_key");null!==c&&(a.originalEvent.key=c,a.originalEvent.newValue=localStorage.getItem(a.originalEvent.key),b.call(this,a))}),f.addSuffix=function(a){return a+"-"+g.getCurrentNetwork().id+"-"+g.getCurrentUser().id};var h=f.get.bind(f),i=f.set.bind(f),j=f.remove.bind(f);return f.unwrapped={get:h,set:i,remove:j},f.get=function(a){arguments[0]=f.addSuffix(a);var b=h.apply(this,arguments);return b?b.value:void 0},f.set=function(a,b,c){arguments[0]=f.addSuffix(a);var d=Date.now();if(b=c===!0?{value:b,suppress:c,id:d}:{value:b,id:d},f.idList){var e=20;f.idList.length>e&&f.idList.pop(),f.idList.unshift(d)}else f.idList=[d];try{return i.apply(this,arguments)}catch(a){}},f.remove=function(a){return arguments[0]=f.addSuffix(a),j.apply(this,arguments)},f.removeSuffix=function(a){var b="-"+g.getCurrentNetwork().id+"-"+g.getCurrentUser().id;return a.replace(b,"")},f}),define("models/banner",["require","underscore","backbone","core/lib/log","core/lib/util/sync_with_request","core/lib/adapters/store_adapter"],function(a){"use strict";var b=a("underscore"),c=a("backbone"),d=a("core/lib/log"),e=a("core/lib/util/sync_with_request"),f=a("core/lib/adapters/store_adapter"),g=c.Model.extend({idAttribute:"key",defaults:{key:null,count:0,opted_out:void 0},initialize:function(){this.listenTo(f,"storageEvent:"+this.storageKey(),this.onStorageUpdate),this.updateFromStorage(),this.on("change",this.saveToStorage,this)},parse:function(a){var c,d=a.banners?a.banners.length?a.banners[0]:null:a;return b.isEmpty(d)||(c={},c.opted_out=d.opted_out,c.key=d.key,c.count=d.count),c},increment:function(){var a=this.get("count");this.save({count:++a})},isOptedOut:function(){return this.get("opted_out")},optOut:function(){this.save({opted_out:!0})},sync:function(a,b,c){if("patch"===a||"update"===a){var d={};b.hasChanged("count")&&(d.count={op:"increment",value:1}),b.hasChanged("opted_out")&&(d.opted_out={op:"set",value:b.get("opted_out")}),c.data=d,a="patch"}return e.call(this,a,b,c)},storageKey:function(){return"banner-"+this.get("key")},saveToStorage:function(){try{f.set(this.storageKey(),this.toJSON())}catch(a){d.warn("Failed to save banner to local storage")}},updateFromStorage:function(){try{var a=f.get(this.storageKey());null!=a&&this.set(a)}catch(a){d.warn("Failed to update banner from localstorage")}},onStorageUpdate:function(a){this.set(a.newValue)},url:function(){return this.collection.bannerBaseUrl()+"/"+this.get("key")}});return g}),define("core/lib/collection_with_yammer_request",["require","core/lib/util/sync_with_request"],function(a){"use strict";var b=a("core/lib/util/sync_with_request"),c=function(){this.sync=b};return c}),define("core/lib/namespace",["require","underscore"],function(a){var b=a("underscore");return{val:function(a,b,c){for(var d=a,e=b.split("."),f=3===arguments.length,g=e.length-1,h=0,i=e.length;i>h;h++){var j=e[h];if(d[j]){if(h===g)return f?d[j]=c:d[j]}else{if(!f)return d[j];d[j]=h===g?c:{}}d=d[j]}},ns:function(a,c){if(!a)throw new Error("namespace.ns requires at least one parameter");for(var d=window,e="string"==typeof a?a.split("."):a,f=0;f<e.length;f++){var g=e[f];d[g]||(d[g]={}),d=d[g]}return c&&b.extend(d,c),d}}}),define("collections/yammer_collection",["require","underscore","backbone","core/lib/namespace"],function(a){"use strict";function b(a,b,c){var e,f,g={};return a instanceof d.Model?(e=a.get(b),f=a.get(c)):(e=a[b],f=a[c]),g[b]=e,g[c]=f,e&&f?this.findWhere(g):void 0}var c=a("underscore"),d=a("backbone"),e=a("core/lib/namespace"),f={add:function(a,b){return b=c.extend({merge:!0},b),d.Collection.prototype.add.call(this,a,b)},addWithCompositeKey:function(a,d){var e,f=!c.isArray(a),g=d.compositeKey;if(a)if(f){if(e=b.call(this,a,g[0],g[1]),void 0!==e)return e}else{a=c.clone(a);for(var i=0,j=a.length;j>i;i++)e=b.call(this,a[i],g[0],g[1]),e&&(a[i]=e)}return h.prototype.add.call(this,a,d)}},g={extend:function(a){var b=d.Collection.extend.apply(this,arguments),e=a.mixins;return delete a.mixins,c.reduce(e,function(a,b){return b.call(a.prototype),a},b)}},h=d.Collection.extend(f,g);return e.ns("yam.backbone.collection"),yam.backbone.collection.YammerCollection=h,h}),define("collections/banners",["require","underscore","models/banner","core/lib/yammer_uri","core/lib/log","core/lib/collection_with_yammer_request","collections/yammer_collection"],function(a){"use strict";var b=a("underscore"),c=a("models/banner"),d=a("core/lib/yammer_uri"),e=a("core/lib/log"),f=a("core/lib/collection_with_yammer_request"),g=a("collections/yammer_collection"),h=g.extend({model:c,mixins:[f],url:function(){return this.bannerBaseUrl()+"?keys="+this._keys.join(",")},bootstrap:function(a,c){this._keys=a,this._currentUserId=c.id,this._remoteHasAnswered=!1,this._localBootstrap(),this.fetch({error:b.bind(this._onRemoteError,this)})},hasFetched:function(){return this._remoteHasAnswered},parse:function(a){return this._remoteHasAnswered=!0,a.banners},bannerBaseUrl:function(){return d.api("banners/users/"+this._currentUserId+"/banners")},getOrFetch:function(a){var b=this.get(a);return b||(b=this._addModel(a),b.fetch()),b},isOptedOut:function(a){var b=this.getOrFetch(a),c=b.isOptedOut();return"undefined"!=typeof c||this._remoteHasAnswered||(c=!0),!!c},_onRemoteError:function(a){e.warn("Failed to talk to banner service:",a.status)},_localBootstrap:function(){b.each(this._keys,this._addModel,this)},_addModel:function(a){return this.add({key:a},{merge:!0})}}),i=new h;return i}),define("core/lib/treatment",["require","collections/banners","core/lib/log","core/lib/session","core/lib/yammer_uri","core/lib/yammer_request"],function(a){"use strict";var b=a("collections/banners"),c=a("core/lib/log"),d=a("core/lib/session"),e=a("core/lib/yammer_uri"),f=a("core/lib/yammer_request");return{treatment:function(a){var b=d.getCurrentUser(),g=b&&b.treatments,h=b&&b.treatments_meta_data,i=h&&h[a];return a?b?g?(i&&i.enabled&&b.fix_treated_activated&&!(i.in_flight||i.override||i.treated)&&(i.in_flight=!0,f.send({url:e.apiBase()+"/api/v1/experiments/"+a+"/treated",type:"POST"}).done(function(){i.treated=!0}).fail(function(){c.warn("treatment: treated call failed",a)}).always(function(){i.in_flight=!1})),g.hasOwnProperty(a)?g[a]:void 0):void c.warn("treatment: no treatments data in current user"):void c.warn("treatment: current user not initialized"):void 0},treatmentWithoutLogging:function(a){var b=d.getCurrentUser();return b&&b.treatments?b.treatments[a]:void c.warn("treatment: current user not initialized")},usePriorityCopy:function(){var a=b.get("tom_inbox_web_wording");return!!(a&&!a.isOptedOut()&&a.get("count")>0&&this.treatmentWithoutLogging("android_group_updates_v4"))}}}),/**
 * @license RequireJS text 2.0.12 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */
define("text",["module"],function(a){"use strict";var b,c,d,e,f,g=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],h=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,i=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,j="undefined"!=typeof location&&location.href,k=j&&location.protocol&&location.protocol.replace(/\:/,""),l=j&&location.hostname,m=j&&(location.port||void 0),n={},o=a.config&&a.config()||{};return b={version:"2.0.12",strip:function(a){if(a){a=a.replace(h,"");var b=a.match(i);b&&(a=b[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:o.createXhr||function(){var a,b,c;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(b=0;3>b;b+=1){c=g[b];try{a=new ActiveXObject(c)}catch(a){}if(a){g=[c];break}}return a},parseName:function(a){var b,c,d,e=!1,f=a.indexOf("."),g=0===a.indexOf("./")||0===a.indexOf("../");return-1!==f&&(!g||f>1)?(b=a.substring(0,f),c=a.substring(f+1,a.length)):b=a,d=c||b,f=d.indexOf("!"),-1!==f&&(e="strip"===d.substring(f+1),d=d.substring(0,f),c?c=d:b=d),{moduleName:b,ext:c,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,e){var f,g,h,i=b.xdRegExp.exec(a);return i?(f=i[2],g=i[3],g=g.split(":"),h=g[1],g=g[0],!(f&&f!==c||g&&g.toLowerCase()!==d.toLowerCase()||(h||g)&&h!==e)):!0},finishLoad:function(a,c,d,e){d=c?b.strip(d):d,o.isBuild&&(n[a]=d),e(d)},load:function(a,c,d,e){if(e&&e.isBuild&&!e.inlineText)return void d();o.isBuild=e&&e.isBuild;var f=b.parseName(a),g=f.moduleName+(f.ext?"."+f.ext:""),h=c.toUrl(g),i=o.useXhr||b.useXhr;
//!strip part to avoid file system issues.
return 0===h.indexOf("empty:")?void d():void(!j||i(h,k,l,m)?b.get(h,function(c){b.finishLoad(a,f.strip,c,d)},function(a){d.error&&d.error(a)}):c([g],function(a){b.finishLoad(f.moduleName+"."+f.ext,f.strip,a,d)}))},write:function(a,c,d,e){if(n.hasOwnProperty(c)){var f=b.jsEscape(n[c]);d.asModule(a+"!"+c,"define(function () { return '"+f+"';});\n")}},writeFile:function(a,c,d,e,f){var g=b.parseName(c),h=g.ext?"."+g.ext:"",i=g.moduleName+h,j=d.toUrl(g.moduleName+h)+".js";b.load(i,d,function(c){var d=function(a){return e(j,a)};d.asModule=function(a,b){return e.asModule(a,j,b)},b.write(a,i,d,f)},f)}},"node"===o.env||!o.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(c=require.nodeRequire("fs"),b.get=function(a,b,d){try{var e=c.readFileSync(a,"utf8");0===e.indexOf("\ufeff")&&(e=e.substring(1)),b(e)}catch(a){d&&d(a)}}):"xhr"===o.env||!o.env&&b.createXhr()?b.get=function(a,c,d,e){var f,g=b.createXhr();if(g.open("GET",a,!0),e)for(f in e)e.hasOwnProperty(f)&&g.setRequestHeader(f.toLowerCase(),e[f]);o.onXhr&&o.onXhr(g,a),g.onreadystatechange=function(b){var e,f;4===g.readyState&&(e=g.status||0,e>399&&600>e?(f=new Error(a+" HTTP status: "+e),f.xhr=g,d&&d(f)):c(g.responseText),o.onXhrComplete&&o.onXhrComplete(g,a))},g.send(null)}:"rhino"===o.env||!o.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?b.get=function(a,b){var c,d,e="utf-8",f=new java.io.File(a),g=java.lang.System.getProperty("line.separator"),h=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f),e)),i="";try{for(c=new java.lang.StringBuffer,d=h.readLine(),d&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1)),null!==d&&c.append(d);null!==(d=h.readLine());)c.append(g),c.append(d);i=String(c.toString())}finally{h.close()}b(i)}:("xpconnect"===o.env||!o.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(d=Components.classes,e=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),f="@mozilla.org/windows-registry-key;1"in d,b.get=function(a,b){var c,g,h,i={};f&&(a=a.replace(/\//g,"\\")),h=new FileUtils.File(a);try{c=d["@mozilla.org/network/file-input-stream;1"].createInstance(e.nsIFileInputStream),c.init(h,1,0,!1),g=d["@mozilla.org/intl/converter-input-stream;1"].createInstance(e.nsIConverterInputStream),g.init(c,"utf-8",c.available(),e.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),g.readString(c.available(),i),g.close(),c.close(),b(i.value)}catch(a){throw new Error((h&&h.path||"")+": "+a)}}),b}),define("json",["text"],function(text){var parseJSON=JSON&&JSON.parse?JSON.parse:function(val){return eval("("+val+")")};return{load:function(a,b,c,d){d.isBuild?c(""):b(["text!"+a],function(a){c(parseJSON(a))})},loadFromFileSystem:function(a,b){var c=nodeRequire("fs"),d=require.toUrl(b),e=c.readFileSync(d).toString();return e='define("'+a+"!"+b+'", function () {\nreturn '+e+";\n});\n"},write:function(a,b,c){c(this.loadFromFileSystem(a,b))}}}),define("json!core/lib/rtl_languages.json",function(){return["ar","fa","he","ur"]}),define("core/lib/i18n",["require","underscore","core/lib/cookie_helper","backbone","json!./rtl_languages.json"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/cookie_helper"),d=a("backbone"),e=a("json!./rtl_languages.json"),f={LeftToRight:"ltr",RightToLeft:"rtl"},g=["^","[^֐-׿؀-ۿݐ-ݿࢠ-ࣿיִ-ﭏﭐ-﷿ﹰ-\ufeff]*","[","A-Za-z","À-Ö","Ø-ö","ø-ʸ","̀-֐","ࠀ-῿","Ⰰ-﬜","︀-﹯","﻽-￿","]"].join(""),h=["^","[^A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿Ⰰ-﬜︀-﹯﻽-￿]*","[","֐-׿","؀-ۿ","ݐ-ݿ","ࢠ-ࣿ","יִ-ﭏ","ﭐ-﷿","ﹰ-\ufeff","]"].join(""),i=b.memoize(function(){return{ltr:new RegExp(g),rtl:new RegExp(h)}}),j=function(a){return a.toLowerCase().substring(0,2)},k=function(a){if("qps-ploc"===a)return a;var c=a.split("-"),d=c[0],e=c[1];return b.compact([d&&d.toLowerCase(),e&&e.toUpperCase()]).join("-")},l=function(a){return b.contains(e,j(a))},m={TextDirection:f,defaults:{locale:"en-US",translations:{},originalTranslationKeys:{}},initialize:function(){b.bindAll(this,"setLocale"),this.setLocale(yam.locale||this.defaults)},getLocale:function(){return this._locale},getShortLocale:function(){return j(this.getLocale())},getTranslations:function(){return this._translations},getOriginalTranslationKeys:function(){return this._originalTranslationKeys},getTextDirectionByCurrentUiLocale:function(){return this.getTextDirectionByLanguageCode(this.getLocale())},getTextDirectionByLanguageCode:function(a){return l(a)?f.RightToLeft:f.LeftToRight},getTextDirectionByFirstStrongCharacter:function(a){if(!a)return null;var b=i();return b.ltr.test(a)?f.LeftToRight:b.rtl.test(a)?f.RightToLeft:null},setLocale:function(a){this._locale=k(a.locale),this._translations=a.translations,this._originalTranslationKeys=a.originalTranslationKeys,c.set({name:"locale",value:this._locale,days:365}),d.trigger("locale-changed")}};return m.initialize(),m}),!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define("rosettajs",[],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Rosetta=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a,b,c){return a>=b&&c>=a}function e(a,b,c){var d,e,g,i=[];if(!a)throw new Error("Invalid key");for(b=b||{},c=c||this.locale,g=f(b[x]),e=this.getPluralName(b[w],c),g&&e&&i.push([a,e,g].join(v)),e?i.push([a,e].join(v)):g&&i.push([a,g].join(v)),i.push(a);!d&&i.length;)d=this.phrases[i.shift()];if(!d)throw new Error("No string found");return d&&b&&(d=h(d,b,this.tokenRegex)),d}function f(a){return t[a]||t[u]}function g(a,b){var c=E[b]||C,d=D[c];return m[d(a)]}function h(a,b,c){return a.replace(c,function(a,c){var d=b[c];return void 0==d?a:d})}function i(a){switch(a.length){case 0:case 1:return a.join("");case 2:return a.join(this.t(y));case 3:return a[0]+this.t(z)+a[1]+this.t(B)+a[2];default:return a[0]+this.t(z)+a.slice(1,a.length-1).join(this.t(A))+this.t(B)+a[a.length-1]}}function j(a){a=a||{},this.locale=a.locale||k,this.tokenRegex=a.tokenRegex||l,this.phrases=a.phrases||{}}var k="en",l=/\{([^\}]+)\}/g,m=["zero","one","two","few","many","other"],n=0,o=1,p=2,q=3,r=4,s=5,t=["male","female",""],u=2,v="|",w="count",x="gender",y="list_separator_1",z="list_separator_2",A="list_separator_3",B="list_separator_4",C=0,D=[function(a){return s},function(a){return 1==a?o:s},function(a){return d(a,0,1)?o:s},function(a){return a%10==0||d(a%100,11,19)?n:a%10==1&&a%100!=11?o:s},function(a){return 1==a||11==a?o:2==a||12==a?p:d(a,3,10)||d(a,13,19)?q:s},function(a){return 1==a?o:0==a||d(a%100,1,19)?q:s},function(a){return a%10!=1||d(a%100,11,19)?d(a%10,2,9)&&!d(a%100,11,19)?q:s:o},function(a){return a%10==1&&a%100!=11?o:d(a%10,2,4)&&!d(a%100,12,14)?q:a%10==0||d(a%10,5,9)||d(a%100,11,14)?r:s},function(a){return 1==a?o:d(a,2,4)?q:s},function(a){return 1==a?o:d(a%10,2,4)&&!d(a%100,12,14)?q:d(a%10,0,1)||d(a%10,5,9)||d(a%100,12,14)?r:s},function(a){return a%100==1?o:a%100==2?p:d(a%100,3,4)?q:s},function(a){return 1==a?o:2==a?p:d(a,3,6)?q:d(a,7,10)?r:s},function(a){return 0==a?n:1==a?o:2==a?p:d(a%100,3,10)?q:d(a%100,11,99)?r:s},function(a){return 1==a?o:0==a||d(a%100,2,10)?q:d(a%100,11,19)?r:s},function(a){return a%10==1?o:s},function(a){return a%10==1&&a%100!=11?o:s},function(a){var b=a%10,c=a%100;return 1==b&&11!=c&&71!=c&&91!=c?o:2==b&&12!=c&&72!=c&&92!=c?p:!d(b,3,4)&&9!=b||d(c,10,19)||d(c,70,79)||d(c,90,99)?0!=a&&a%1e6==0?r:s:q},function(a){return 0==a?n:1==a?o:2==a?p:3==a?q:6==a?r:s},function(a){return a%10==1&&a%100!=11?o:d(a%10,2,4)&&!d(a%100,12,14)?q:s}],E={af:1,sq:1,ar:12,eu:1,br:16,bg:1,ca:1,zh:0,hr:18,cs:8,da:1,nl:1,en:1,et:1,fr:2,gl:1,de:1,fi:1,el:1,he:1,hi:2,hu:1,is:15,id:0,ga:11,it:1,ja:0,ko:0,lv:3,lt:6,ms:0,ml:1,mt:13,mk:14,nb:1,nn:1,fa:2,pl:9,pt:1,ro:5,ru:7,gd:4,sr:18,es:1,sk:8,sl:10,sv:1,th:0,tr:0,uk:7,vi:0,cy:17},F=j.prototype;F.t=e,F.list=i,F.getPluralName=function(){return g.apply(this,arguments)},b.exports=j},{}]},{},[1])(1)}),define("core/lib/tr_helper",["require","underscore","./string_helper"],function(a){function b(a,b){return null!=a?a.replace(h,function(a,c){var e=b[c];return d.isString(e)?e:""}):""}function c(a,c){var h={};return d.each(c,function(a,b){d.isObject(a)&&(h[b]=a,delete c[b])}),c=d.extend({},f,c),a=a.replace(g,function(a,f,g){var i=c[f],j=d.extend({},{0:e.trim(g)},h[f]);return b(i,j)})}var d=a("underscore"),e=a("./string_helper"),f={strong:"<strong>{$0}</strong>",em:"<em>{$0}</em>",link:'<a href="{$1}">{$0}</a>'},g=/\[(\w+):([^\]]*)\]/g,h=/\{\$([0-9]+)\}/g;return{resolveHelpers:c}}),define("core/lib/tr",["require","underscore","core/lib/i18n","rosettajs","core/lib/log","backbone","./tr_helper"],function(a){function b(a){return e.contains(f.getOriginalTranslationKeys(),a)}function c(a){return"qps"===a}function d(a,b){var c="[:PSEUDOLOCED_";for(c+=a;c.length<b.length;)c+="_";return c+"]"}var e=a("underscore"),f=a("core/lib/i18n"),g=a("rosettajs"),h=a("core/lib/log"),i=a("backbone"),j=a("./tr_helper"),k={};return k.t=function(a,e){var f;try{b(a)?(f=k.rosetta.t(a,e,"en"),c(k.rosetta.locale)&&(f=d(a,f))):f=k.rosetta.t(a,e),f=j.resolveHelpers(f,e)}catch(b){"No string found"===b.message?(h.warn("string with key = "+a+" is not found"),f=a):"Invalid key"===b.message&&(f="")}return f},k.loadLocale=function(){k.rosetta=new g({locale:f.getShortLocale(),phrases:f.getTranslations()})},k.tlist=function(a){var b;try{b=k.rosetta.list(a)}catch(c){"No string found"===c.message&&h.warn("string with a list separator is not found"),b=a.join(", ")}return b},k.loadLocale(),i.on("locale-changed",k.loadLocale),e.extend(yam,k),k}),define("core/lib/filename_helper",["require","underscore","core/lib/tr"],function(a){var b=a("underscore"),c=a("core/lib/tr"),d={};d.DEFAULT_ICON_CLASS="default";var e=function(a){return b.reduce(a,function(a,c){return b.each(c.values.split(" "),function(b){a[b]=c.key}),a},{})};d.getExtension=function(a){var b;return a&&(b=/.+\.(\w+$)/.exec(a)),b&&b[1]?b[1].toLowerCase():""};var f=[{key:"doc",values:"doc docx docm dot dotx dotm"},{key:"xls",values:"xls xlsx xlsm xlsb ods"},{key:"ppt",values:"ppt pptx pptm pps ppsx ppsm pot potx potm ppam odp"},{key:"ai",values:"ai svg"},{key:"swf",values:"swf flv"},{key:"mov",values:"mov avi mpg vob mp4 wmv 3gp mpeg ogm mkv ogv ogg m4v"},{key:"image",values:"jpg jpeg gif png tif bmp"},{key:"mp3",values:"mp3 aac flac wav aif iff mpa wma m4a"},{key:"zip",values:"zip gz pkg rar"},{key:null,values:"adp fla html pdf php psd pst txt"}],g=e(f);d.getCanonicalExtension=function(a){var c=d.getExtension(a),e=g[c];return b.isString(e)?e:null===e?c:"default"},d.getClass=function(a){var c=d.getCanonicalExtension(a),e="Other";return b.contains(["doc","ppt","pdf"],c)?e="Document":"image"===c?e="Image":"mov"===c&&(e="Video"),e};var h=[{key:"code",values:"c cpp css rb php java js pl xml html"},{key:"graph",values:"ppt pptx pptm ppam ppsx ppsm pot potx potm"},{key:"pdf",values:"pdf"},{key:"picture",values:"png jpg jpeg gif"},{key:"sound",values:"mp3 m4a flac ogg"},{key:"spreadsheet",values:"xls xlsx xlsm xlsb xlam xll xlt xltx xltm csv tsv ods"},{key:"doc",values:"doc docx docm dot dotx dotm"},{key:"text",values:"txt rtf"},{key:"video",values:"avi mpeg mpg wmv ogm ogv mkv 3gp flv mov mp4"},{key:"zip",values:"zip tar gz"}],i=e(h),j={code:c.t("item_type_code_file"),graph:c.t("item_type_powerpoint_file"),pdf:c.t("item_type_pdf_file"),picture:c.t("item_type_image_file"),sound:c.t("item_type_sound_file"),spreadsheet:c.t("item_type_excel_file"),doc:c.t("item_type_word_file"),text:c.t("item_type_text_file"),video:c.t("item_type_video_file"),zip:c.t("item_type_archive_file"),default:c.t("item_type_file")};return d.getFileIconClass=function(a){var b=d.getExtension(a),c=i[b];return c?c:this.DEFAULT_ICON_CLASS},d.getFileIconClassAltText=function(a){return j[a]},d}),define("core/lib/util/hydrant_grammar",["require","underscore"],function(a){"use strict";function b(a){for(var b="",c=[],d={},e=d,f=0,g=a.length,h=null;g>f;f++)h=a.charAt(f),"("===h?(d[b]={},c.push(d),d=d[b],b=""):")"===h?(b&&(d[b]=!0),d=c.pop(),b=""):","===h?(d[b]=!0,b=""):" "!==h&&(b+=h);if(d!==e)throw new SyntaxError("Invalid expression");return e}function c(a,b){var e;return d.isObject(a)?(e=d.compact(d.reduce(a,function(a,b,d){return a.push(c(b,d)),a},[])),e=e.join(","),b&&e.length>0&&(e=b+"("+e+")")):a&&(e=b),e}var d=a("underscore");return{parse:b,stringify:c}}),define("core/lib/external_messaging_state",{ENABLED:"enabled",INBOUND_ONLY:"inbound_only",DISABLED:"disabled",INVALID:"invalid_state"}),define("models/helpers/network",["require","underscore","core/lib/tr","core/lib/external_messaging_state"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/external_messaging_state"),e=function(a,b){var c=b.getCurrentNetwork();return!!a&&!!c&&c.id===a.id},f=function(a){return!!a.moderated},g=function(a){return a.unseen_notification_count||0},h=function(a){return g(a)+i(a)},i=function(a){return a.inbox_unseen_thread_count||0},j=function(a){return!!h(a)},k=function(a,b,c){var d;if(b.isInbox()){if("yam.model.Thread"!==c.declaredClass||1!==b.getUnseenCountFor(c))return;d=i(a),a.update({inbox_unseen_thread_count:d+1})}},l=function(a,b,c){if(b.isInbox()){if("yam.model.Thread"!==c.declaredClass||0!==b.getUnseenCountFor(c))return;var d=i(a);d>0&&a.update({inbox_unseen_thread_count:d-1})}},m=function(a){return a.community?c.t("all_network"):c.t("all_company")},n=function(){return"#/threads/company?type=general"},o=function(a){return b.pick(a,"type","name")},p=function(a){return"network"===a.type},q=function(a){return a.external_messaging_state===d.ENABLED};return{isNetwork:p,isCurrent:e,isModerated:f,getUnseenNotificationCount:g,getUnseenCount:h,getInboxUnseenThreadCount:i,hasUnseen:j,incrementCountFor:k,decrementCountFor:l,getCompanyGroupName:m,getCompanyGroupUrl:n,toOriginalHash:o,isExternalMessagingEnabled:q}}),define("models/yammer_model",["require","underscore","backbone","core/lib/namespace","core/lib/session"],function(a){"use strict";var b=a("underscore"),c=a("backbone"),d=a("core/lib/namespace"),e=a("core/lib/session");c.emulateHTTP=!0;var f=c.Model.extend({sync:function(a,b,d){var f=e.getCurrentUser().web_oauth_access_token;f&&(d||(d={}),d.headers||(d.headers={}),d.headers.Authorization="Bearer "+f),"patch"===a&&(a="update"),c.sync.call(this,a,b,d)},toORM:function(){return b.clone(this.attributes)}});return d.ns("yam.backbone.model"),yam.backbone.model.YammerModel=f,f}),define("models/group",["require","underscore","core/lib/tr","core/lib/session","core/lib/namespace","core/lib/yammer_config","core/lib/yammer_uri","models/helpers/network","models/yammer_model","collections/yammer_collection"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("core/lib/namespace"),f=a("core/lib/yammer_config"),g=a("core/lib/yammer_uri"),h=a("models/helpers/network"),i=a("models/yammer_model"),j=a("collections/yammer_collection"),k="#264f8c",l=i.extend({defaults:{type:"group"},initialize:function(a){a=a||{},this.set(b.reduce(l.NESTED_COLLECTIONS,function(c,d,e){return b.has(a,e)||(c[e]=null),c},{},this),{silent:!0})},set:function(a,c,d){var e;return null==a?this:("object"==typeof a?(e=a,d=c):(e={})[a]=c,e=b.reduce(e,function(a,c,d){var e=this.get(d);return b.has(l.NESTED_COLLECTIONS,d)&&(null==e?(c=new j(c,{model:l.NESTED_COLLECTIONS[d]}),this.listenTo(c,"add remove reset",b.bind(function(){this.trigger("change:"+d),this.trigger("change")},this))):(e.reset(c),c=e)),a[d]=c,a},{},this),i.prototype.set.call(this,e,d))},clear:function(a){b.each(l.NESTED_COLLECTIONS,function(a,b){b=this.get(b),b&&b.reset(null)},this);var c=b.omit(this.attributes,l.NESTED_COLLECTIONS);for(var d in c)c[d]=this.defaults[d];return this.set(c,b.extend({},a)),this.trigger("clear")}},{ALL_COMPANY:function(){return new l({id:"COMPANY_GROUP_ID",type:"group",color:k,full_name:h.getCompanyGroupName(d.getCurrentNetwork()),privacy:"public",description:c.t("this_is_the_default_group_for_everyone",{network:d.getCurrentNetwork().name}),mugshot_url:f.config().cdnMugshotHost+"/images/48x48/all_company.png",photo:g.cdn("assets/images/company_group_profile.png")})}});return l.ALL_COMPANY=b.memoize(l.ALL_COMPANY),l.NESTED_COLLECTIONS={featured_users:null,related_contents:null,related_groups:l,related_networks:null},e.ns("yam.backbone.model"),yam.backbone.model.Group=l,l}),define("collections/groups",["require","collections/yammer_collection","models/group","core/lib/namespace"],function(a){"use strict";var b=a("collections/yammer_collection"),c=a("models/group"),d=a("core/lib/namespace"),e=b.extend({model:c,url:function(){return"/api/v1/groups"}});return d.ns("yam.backbone.collection"),yam.backbone.collection.Groups=new e,yam.backbone.collection.Groups}),define("core/lib/util/hydrant_helper",["require","underscore","core/lib/session","core/lib/yammer_uri","core/lib/uri_helper","core/lib/filename_helper","core/lib/util/hydrant_grammar","core/lib/treatment","collections/groups"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/yammer_uri"),e=a("core/lib/uri_helper"),f=a("core/lib/filename_helper"),g=a("core/lib/util/hydrant_grammar"),h=a("core/lib/treatment"),i=a("collections/groups"),j={UNREAD:"inbox_unseen",ALL:"unarchived",CHAT:"inbox_chat"},k=function(a){return function(c){try{return c.apply(null,b.rest(arguments))}catch(b){return console.error("Error transforming payload:",b.message),a}}},l=function(a){return b.reduce(a,function(a,c,d){return b.isUndefined(c)||(a[d]=c),a},{})},m=function(a,b,c){return a.reference_data&&a.reference_data[b]&&a.reference_data[b][c]||{}},n=function(a){if(a){var b=new Date(a);return b.toISOString().replace(/-/g,"/").replace(/T/g," ").replace(/\.\d{3}Z$/," +0000")}},o=function(a){return a.messages=a.messages.map(function(b){return b.in_private_conversation=a.in_private_conversation,b.conversation_id=a.in_private_conversation&&a.id,b}),a},p=function(a,d){if(a){var e=c.getCurrentNetwork();return d=b.extend({network_permalink:e.get("permalink")},d),a=a.replace(/\{([^{}]*)\}/g,function(a,b){var c=d[b];return"string"==typeof c||"number"==typeof c?c:a})}},q=function(a){return 0===a.indexOf("image")?"image":"file"},r=function(a){return a.private?"private":a.moderated?"restricted":"public"},s=function(a){var b=a.in_private_conversation||"chat"===a.message_type;return a.privacy||(b?"private":"public")},t=function(a){var b=a.in_private_conversation||a.in_private_group;return b?"private":"public"},u=function(a){return b.map(a,function(a){return{id:a,type:"topic"}})},v=function(a,c){return b.map(c,function(b){return R(a,m(a,"users",b))})},w=function(a){return"normal"===a?"update":a},x=function(a){var b;switch(a.message_type){case"announcement":b={rich:a.body||""};break;case"shared_message":b={plain:a.body||""};break;default:b={parsed:a.body||""}}return b.highlighted=b.parsed,a.rich_body&&(b.highlighted=a.rich_body,delete a.rich_body),b},y=function(a,b){return b.map(function(b){var c=m(a,"users",b);return l({user_id:c.id,network_id:c.network_id,permalink:c.permalink,full_name:c.full_name})})},z=function(a,b){return b.file_ids.map(m.bind(null,a,"files")).map(A.bind(null,a.url_templates)).map(B.bind(null,a))},A=function(a,c){if("deleted"===c.state)return{id:c.id,name:"(deleted)",type:"deleted_message_attachment",real_type:"uploaded_file",web_url:d.app("/uploaded_files/deleted")};var e=q(c.content_type),g=f.getClass(c.original_name),h=p(a.attachment_preview,b.extend({original_name:c.name},c)),i=p(a.attachment_thumbnail,b.extend({version_id:c.latest_version_id},c)),j=p(a.attachment_scaled,{id:c.id,version_id:c.latest_version_id,width:"{{width}}",height:"{{height}}"});"Other"===g&&(h=null,i=null,j=void 0);var k=l({id:c.id,network_id:c.network_id,group_id:c.group_id,name:c.name,original_name:c.original_name,full_name:c.name.substr(0,c.name.lastIndexOf(".")),description:c.description,content_type:c.content_type,content_class:g,size:c.size,height:c.height,width:c.width,transcoded:c.transcoded,privacy:t(c),created_at:n(c.created_at),last_uploaded_at:n(c.last_uploaded_at),type:e,real_type:"uploaded_file",uploader_id:c.uploader_id,snippets:(c.snippets||[]).map(function(a){return a.html}),url:p(a.attachment,c),web_url:p(a.attachment_web,c),download_url:p(a.attachment_download,c),preview_url:h,thumbnail_url:i,scaled_url:j,large_icon_url:p(a.file_large_icon,c),edit_url:c.is_editable&&p(a.attachment_edit,c)});return"Image"===g?k.image={thumbnail_url:i,url:h}:k.file={size:k.size,url:k.url},"Video"===g&&(k.streaming_url=p(a.attachment_stream,b.extend({version_id:c.latest_version_id},c))),k},B=function(a,b){return b.is_following&&a.followed_references.push({id:b.id,type:"uploaded_file"}),b},C=function(a,b){var c=a.url_templates;return"deleted"===b.state?{id:b.fakeId,real_id:b.id,name:"(deleted)",type:"deleted_message_attachment",real_type:"page",web_url:d.app("/notes/deleted")}:l({id:b.fakeId||b.id,real_id:b.id,group_id:b.group_id,network_id:b.network_id,name:b.title,type:"ymodule",real_type:"page",draft:!b.latest_version_id,last_published_at:n(b.latest_published_at||b.updated_at),owner_id:b.owner_id,creator_id:b.creator_id,last_published_by:b.latest_published_by_id,ymodule:{app_id:"",icon_url:"blank.gif"},web_url:p(c.page_web,b),preview_url:p(c.page_preview,b),api_preview_url:p(c.page,b)})},D=function(a,b){var c=b.page_ids;return c.map(m.bind(null,a,"pages")).map(function(c){return c.is_following&&a.followed_references.push({id:c.id,type:"page"}),c.fakeId=b.id+1e8*c.id,c}).map(C.bind(null,a))},E=function(a,b){var c=b.references.opengraphobject.attached;return c.map(function(c){var d=m(a,"opengraphobjects",c),e=b.id+10*d.record_id;return d.is_following&&a.followed_references.push({id:d.id,type:"open_graph_object"}),"active"!==d.state?{id:e,record_id:d.record_id,type:"deleted_message_attachment",real_type:"open_graph_object"}:{id:e,record_id:d.record_id,network_id:d.network_id,name:d.title,description:d.description,type:"ymodule",ymodule:{app_id:"",icon_url:"blank.gif",web_app_id:"open_graph_object"},web_url:d.url,thumbnail_url:d.image}})},F=function(a,b){var c=a.url_templates,d=m(a,"topics_reverse",b);return{id:b,network_id:d.network_id,name:d.normalized_name,url:p(c.tag,{id:b}),web_url:p(c.topic_web,d)}},G=function(a,b){return b?b.map(function(b){return F(a,b)}):void 0},H=function(a,b){b&&b.length&&(a.reference_data.tags=a.reference_data.tags||{},b.forEach(function(b){a.reference_data.tags[b.id]=b}))},I=function(a,b){var c=a.url_templates;return l({id:b.id,network_id:b.network_id,name:b.name,normalized_name:b.normalized_name,permalink:b.normalized_name,url:p(c.topic,b),web_url:p(c.topic_web,b)})},J=function(a){return b.reduce(a.reference_data.topics,function(a,b){return b.tag_id&&(a[b.tag_id]=b),a},{})},K=function(a,b){var c=a.url_templates;H(a,G(a,b.references&&b.references.tag&&b.references.tag.tagged));var d="chat"===b.message_type,e=d||b.in_private_conversation;return l({id:b.id,group_id:b.group_id,network_id:b.network_id,replied_to_id:b.replied_to_id||null,sender_id:b.sender_id,thread_id:b.thread_id,created_at:n(b.created_at),direct_message:e,conversation_id:e&&b.thread_id||void 0,chat_client_sequence:d&&b.created_at||void 0,language:b.language,message_type:w(b.message_type),privacy:s(b),sender_type:b.sender_type,system_message:"system"===b.message_type,system_message_properties:"system"===b.message_type&&{subtype:b.message_subtype}||void 0,url:p(c.message,b),web_url:p(c.message_web,b)})},L=function(a,c){var d,e=[],f=!c.replied_to_id,g=c.shared_message_id,h=m(a,"shared_messages",g),i=c.client_type_id,j=m(a,"client_applications",i),k=c.references,n=k&&k.user&&b.union(k.user.cc,k.user.tagged);return c.file_ids&&e.push.apply(e,z(a,c)),c.page_ids&&e.push.apply(e,D(a,c)),c.praise&&e.push(P(a,c.praise)),c.ymodule&&2===c.ymodule.ymodule_application_id&&e.push(Q(a,c.ymodule)),h.id&&e.push(N(a,h)),c.references&&c.references.opengraphobject&&c.references.opengraphobject.attached&&e.push.apply(e,E(a,c)),c.is_liked&&a.liked_message_ids.push(c.id),c.is_bookmarked&&a.bookmarked_message_ids.push(c.id),c.snippets&&(d=M(c),f?c.rich_body=d[0]&&d[0].snippet_html:a.snippets.push.apply(a.snippets,d)),b.extend(K(a,c),l({group_created_id:f&&c.group_id||void 0,shared_message_id:g&&(h.id||null),body:x(c),title:c.title,attachments:e,client_type:j.name,client_url:j.url,liked_by:{count:c.likes_count||0,names:c.like_ids&&y(a,c.like_ids)||[]},notified_user_ids:n||[]}))},M=function(a){return a.snippets.map(function(b){return{id:a.id,snippet_html:b.html,thread_starter_id:a.thread_id,sender_id:a.sender_id,sender_type:a.sender_type}})},N=function(a,c){return b.extend(K(a,c),l({body:x(c),content_excerpt:c.body,liked_by:c.likes_count,type:"message"}))},O=function(a,c){var d,e=a.url_templates;c.state&&(c.state.is_following&&a.threads_in_inbox.push(c.id),c.state.unseen_message_count&&(a.unseen_message_count_by_thread[c.id]=c.state.unseen_message_count),c.state.last_read_message&&(a.last_seen_message_id=c.state.last_read_message),d=c.state.priority_reason);var f=b.max(c.messages,"id"),g=c.latest_reply_id||f&&f.id;return l({id:c.id,group_id:c.group_ids&&c.group_ids[0],network_id:c.network_id,thread_starter_id:c.thread_starter_id,direct_message:c.in_private_conversation,invited_user_ids:c.participants||[],participants:v(a,c.participants),topics:u(c.topics),has_attachments:c.has_attachments,stats:{shares:c.share_count,updates:c.messages_count,first_reply_id:c.first_reply_id||null,latest_reply_at:c.latest_reply_at||null,latest_reply_id:g||null},read_only:c.read_only,url:p(e.thread,c),web_url:p(e.thread_web,c),priority_reason:d})},P=function(a,b){var c=a.url_templates;return l({id:b.id,network_id:b.network_id,praised_user_ids:b.praised_user_ids,name:"",full_name:"",description:"",comment:b.comment,icon:b.icon,type:"praise",url:p(c.message,{id:b.message_id}),web_url:p(c.message_web,{id:b.message_id})})},Q=function(a,b){return l({id:b.id,network_id:b.network_id,inline_html:"",name:"",type:"ymodule",ymodule:{app_id:"polls"}})},R=function(a,c){var d=a.url_templates,e=b.extend({},c,{mugshot_id:c.mugshot_id||"no_photo.png"}),f=b.extend({},e,{width:48,height:48});return c.is_following&&a.followed_user_ids.push(c.id),l({id:c.id,network_id:c.network_id,email:c.email,name:c.permalink,full_name:c.full_name,job_title:c.job_title,state:c.state,activated_at:n(c.activated_at),url:p(d.user,c),web_url:p(d.user_web,c),mugshot_url:p(d.user_mugshot,f),mugshot_url_template:p(d.user_mugshot,e)})},S=function(a,c){var d=a.url_templates,e=b.extend({},c,{mugshot_id:c.mugshot_id||"no_photo.png"}),f=b.extend({},e,{width:48,height:48});return l({id:c.id,network_id:c.network_id,name:c.permalink,full_name:c.full_name,url:p(d.user,c),web_url:p(d.user_web,c),mugshot_url:p(d.user_mugshot,f),mugshot_url_template:p(d.user_mugshot,e)})},T=function(a,c){var d=a.url_templates,e=b.extend({},c,{mugshot_id:c.mugshot_id||"group_profile.png"}),f=b.extend({},e,{width:48,height:48});return l({id:c.id,network_id:c.network_id,mugshot_id:c.mugshot_id,name:c.permalink,full_name:c.name,color:c.color,description:c.description,office365_url:null,stats:{members:c.members_count||0},created_at:n(c.created_at),privacy:r(c),url:p(d.group,c),web_url:p(d.group_web,c),mugshot_url:p(d.group_mugshot,f),mugshot_url_template:p(d.group_mugshot,e)})},U=function(a,b){return l({id:b.id,name:b.name})},V=function(a,b){return{id:b.id,network_id:b.network_id,privacy:s(b),url:p(a.url_templates.thread,b),participating_users_count:b.participants.length,participating_names:v(a,b.participants)}},W=function(a,c,d){switch(d){case"messages":return b.extend(N(a,c),{type:"message"});case"shared_messages":return b.extend(N(a,c),{type:"shared_message"});case"threads":return b.extend(O(a,c),{type:"thread"});case"thread_summaries":return b.extend(O(a,c),{type:null==a.threads?"thread":"shared_thread"});case"users":return b.extend(R(a,c),{type:"user"});case"guides":return b.extend(S(a,c),{type:"guide"});case"groups":return b.extend(T(a,c),{type:"group"});case"networks":return b.extend(U(a,c),{type:"network"});case"topics":return b.extend(I(a,c),{type:"topic"});case"tags":return b.extend({},c,{type:"tag"});case"conversations":return b.extend(V(a,c),{type:"conversation"})}},X=function(a){return a.messages&&a.messages.map(L.bind(null,a))},Y=function(a){return a.threads&&a.threads.map(function(c){var d=b.findWhere(c.messages,{id:c.thread_starter_id});return L(a,d)})},Z=function(a){return a.threads&&a.threads.reduce(function(c,d){var e=d.messages.filter(b.negate(b.matcher({id:d.thread_starter_id})));return e=e.map(function(b){return L(a,b)}),e.length&&(c[d.id]=e),c},{})},$=function(a,c,d){return b.reduce(a.reference_data,function(c,e,f){return e=b.filter(e,d(f)),e=e.map(function(b){return W(a,b,f)}),c.push.apply(c,b.compact(e)),c},c)},_=function(a,c){var d=a.threads&&a.threads.map(function(c){return b.extend(O(a,c),{type:"thread"})}),e=function(a){return function(b){var d=b["networks"===a?"id":"network_id"];return null==d||d===c}};return $(a,d||[],e)},aa=function(a,b){var c=function(a){return function(c){var d=c["networks"===a?"id":"network_id"];return null!=d&&d!==b}};return $(a,[],c)},ba=function(a){return l({older_available:!!a.has_older_threads,realtime:{channel_id:a.channel_id},threads_in_inbox:a.threads_in_inbox,last_seen_message_id:a.last_seen_message_id,unseen_thread_count:a.unseen_thread_count,unseen_message_count_by_thread:a.unseen_message_count_by_thread,unviewed_threads:a.unviewed_threads,followed_user_ids:a.followed_user_ids,followed_references:a.followed_references,liked_message_ids:a.liked_message_ids,bookmarked_message_ids:a.bookmarked_message_ids})},ca=function(a){return b.isString(a)&&a.match(/\/api\/v1\/messages\/in_thread\/(\d+)/)&&a.match(/older_than=(\d+)/)},da=function(a){return b.isString(a)&&a.match(/\/api\/v2\/search\//)},ea=function(a,d){a.failures&&console.warn("Hydrant reported failures: ",a.failures),a.reference_data=a.reference_data||{},a.threads_in_inbox=[],a.unseen_message_count_by_thread={},a.reference_data.topics_reverse=J(a),a.followed_user_ids=[],a.followed_references=[],a.liked_message_ids=[],a.bookmarked_message_ids=[],a.snippets=[],a.threads=a.threads&&a.threads.map(o);var e=a.threads||a.reference_data.thread_summaries,f=a.reference_data.replied_to_messages;a.reference_data.conversations=e&&b.reduce(e,function(a,b){return b.in_private_conversation&&(a[b.id]=b),a},a.reference_data.conversations||{}),a.reference_data.messages=e&&b.reduce(e,function(a,c){return b.each(c.messages,function(b){a[b.id]||(a[b.id]=b)}),a},a.reference_data.messages||{}),f&&(a.reference_data.messages=b.reduce(f,function(a,b){return a[b.id]||(a[b.id]=b),a},a.reference_data.messages||{}));var g=c.getCurrentNetwork().get("id"),h=X(a),i=Y(a),j=Z(a),k=_(a,g),m=aa(a,g),n=ba(a);return ca(d)&&(i.unshift.apply(i,j[i[0].id]),j=void 0),da(d)&&(j=void 0),l({messages:h||i||[],threaded_extended:j||{},references:k,external_references:m,meta:n,count:a.total_count,snippets:a.snippets})},fa=function(a){var b;if(a){var d=i.get(Number(a));d&&(b=d.get("network_id"))}return b||c.getCurrentNetwork().get("id")},ga=function(a,c,d){var e;return b.isString(a)?e=a.match(c):b.isObject(a)&&a.data&&d&&(e=[null,a.data[d]]),e&&e[1]},ha=function(a){var b=["general","following","my_all"];h.treatment("perf_hydrant_web_all_feeds")&&b.push("true_discovery");var c=new RegExp("/api/v1/messages/("+b.join("|")+")\\.json");return ga(a,/\/api\/v1\/messages\/in_group\/(\d+)\.json/,"groupId")||ga(a,c,"groupId")},ia=function(a){return ga(a,/\/api\/v1\/messages\/in_thread\/(\d+)\.json/,"threadId");
},ja=function(a){return ga(a,/\/api\/v1\/message_feeds\/(\d+)\.json/,"messageId")},ka=function(a){return ga(a,/\/api\/v1\/messages\/from_user\/(\d+)\.json/,"userId")},la=function(a){return ga(a,/\/api\/v1\/messages\/about_topic\/(\d+)\.json/,"topicId")},ma=function(a){return ga(a,/\/api\/v1\/messages\/about_file\/(\d+)\.json/,"fileId")},na=function(a){return ga(a,/\/api\/v1\/messages\/about_page\/(\d+)\.json/,"pageId")},oa=function(a){return ga(a,/\/api\/v1\/messages\/open_graph_objects\/(\d+)\.json/,"ogoId")},pa=function(a){if(!h.treatment("tow_vnext_inbox_chat_hydrant"))return ga(a,/\/api\/v1\/messages\/inbox.json\?.*(inbox_unseen|unarchived)/,"inboxType");if(!a.match(/\/api\/v1\/messages\/inbox.json/))return!1;var b=ta(a);switch(b){case"PRIVATE%3Bchat":return j.CHAT;case"unarchived%3Binbox_unseen":return j.UNREAD;case"unarchived":return j.ALL;default:return console.warn("Hydrant encountered unknown Inbox request type: ",a),!1}},qa=function(a){return ga(a,/older_than=(\d+)/)},ra=function(a){return ga(a,/newer_than=(\d+)/)},sa=function(a){return ga(a,/use_unviewed=([^&]*)/)},ta=function(a){return ga(a,/filter=([^&]*)/)},ua=function(a){var b=h.treatment("perf_hydrant_web_all_feeds"),c=h.treatment("tow_vnext_inbox_hydrant");return!!ha(a)||!!ia(a)&&b||!!ja(a)&&b||!!la(a)&&b||!!ma(a)&&b||!!na(a)&&b||!!oa(a)&&b||!!pa(a)&&c||!!ka(a)},va=function(a){var e=ha(a),f=fa(e),g=ia(a),i=ja(a),j=la(a),k=ma(a),l=na(a),m=oa(a),n=ka(a),o=c.getCurrentUser().get("id"),p=h.treatment("tow_vnext_inbox_hydrant")&&pa(a),q=d.apiBase();return e?(q+="/api/v2/networks/"+f,b.isNaN(parseInt(e,10))?"following"===e?q+="/feeds/following/"+o:"my_all"===e?q+="/feeds/my_all/"+o:"true_discovery"===e?q+="/feeds/discovery":"general"===e&&(q+="/feeds/general"):q+="/feeds/group/"+e):g?q+="/api/v2/threads/"+g:i?q+="/api/v2/messages/"+i:n?(q+="/api/v2/networks/"+f,q+="/feeds/user/"+n):j?(q+="/api/v2/networks/"+f,q+="/feeds/topic/"+j):k?(q+="/api/v2/networks/"+f,q+="/feeds/uploaded_file/"+k):l?(q+="/api/v2/networks/"+f,q+="/feeds/page/"+l):m?(q+="/api/v2/networks/"+f,q+="/feeds/open_graph_object/"+m):p&&(q+="/api/v2/inboxes"),(e||g||i||n||j||k||l||m||p)&&q},wa=function(a){var c="true"===sa(a),d=b.contains([j.UNREAD,j.ALL],pa(a)),e=!!ja(a),f={id:!0,name:!0},i={id:!0,network_id:!0,mugshot_id:!0,permalink:!0,name:!0,private:!0,moderated:!0,color:!0},k={id:!0,network_id:!0,mugshot_id:!0,activated_at:!0,permalink:!0,full_name:!0,job_title:!0,state:!0,email:!0,is_following:!0},l={id:!0,network_id:!0,mugshot_id:!0,permalink:!0,full_name:!0},m={id:!0,network_id:!0,group_id:!0,latest_version_id:!0,created_at:!0,last_uploaded_at:!0,name:!0,original_name:!0,description:!0,content_type:!0,size:!0,width:!0,height:!0,transcoded:!0,in_private_conversation:!0,in_private_group:!0,icon:!0,state:!0,is_following:!0,is_editable:!0},n={id:!0,record_id:!0,network_id:!0,url:!0,image:!0,title:!0,description:!0,state:!0,is_following:!0},o={id:!0,network_id:!0,group_id:!0,latest_version_id:!0,updated_at:!0,title:!0,official:!0,state:!0,is_following:!0},p={id:!0},q={id:!0,tag_id:!0,network_id:!0,name:!0,normalized_name:!0},r={id:!0,network_id:!0,message_id:!0,praised_user_ids:!0,comment:!0,icon:!0},s={id:!0,network_id:!0,ymodule_application_id:!0},t={id:!0,name:!0,url:!0},u={id:!0,network_id:!0,group_id:!0,thread_id:!0,sender_id:!0,replied_to_id:!0,shared_message_id:!0,file_ids:!0,page_ids:!0,client_type_id:!0,created_at:!0,language:!0,message_type:!0,sender_type:!0,message_subtype:!0,body:!0,title:!0,is_bookmarked:!0,is_liked:!0,like_ids:!0,likes_count:!0,in_private_conversation:!0,references:!0,praise:r,ymodule:s},v={id:!0,network_id:!0,group_ids:!0,thread_starter_id:!0,in_private_conversation:!0,messages_count:!0,share_count:!0},w={unseen_message_count:c||d,last_read_message:!0,is_following:!0,priority_reason:!0},x={id:!0,network_id:!0,group_ids:!0,thread_starter_id:!0,first_reply_id:!0,latest_reply_at:!0,latest_reply_id:!0,read_only:!0,has_attachments:!0,messages_count:!0,share_count:!0,topics:!0,participants:!0,in_private_conversation:!0,messages:u,state:w},y={client_applications:t,networks:f,groups:i,users:k,guides:l,files:m,opengraphobjects:n,pages:o,tags:p,topics:q,shared_messages:u,replied_to_messages:u,thread_summaries:e?x:v},z={thread:!0,thread_web:!0,message:!0,message_web:!0,attachment:!0,attachment_web:!0,attachment_download:!0,attachment_thumbnail:!0,attachment_scaled:!0,attachment_preview:!0,attachment_stream:!0,attachment_edit:!0,file_large_icon:!0,page:!0,page_web:!0,page_preview:!0,user:!0,user_web:!0,user_mugshot:!0,group:!0,group_web:!0,group_mugshot:!0,topic:!0,topic_web:!0,tag:!0},A={id:!0,network_id:!0,channel_id:!0,last_seen_message_id:!0,has_older_threads:!0,unseen_thread_count:!0,unviewed_threads:c,threads:x,reference_data:y,url_templates:z};return h.treatment("tow_vnext_inbox_hydrant")&&pa(a)?g.stringify({inboxes:A}):g.stringify({feed:A})},xa=function(a){var b={include_thread_starter:!0,threads_count:8,messages_count:ca(a)?20:2},c=ta(a);if(c){var d=pa(a);d?(b.threads_count=20,b.followed_threads=!0,d===j.UNREAD?b.thread_read_state="UNREAD":d===j.CHAT&&(b.private_threads="true",b.threads_count=0,b.messages_count=0)):b.filter=c}var f=qa(a);f&&(b.older_than=f);var g=ra(a);return g&&(b.newer_than=g),e.paramify(b)},ya=function(a,c){return b.wrap(a,function(a,b){return a(za.transform(b,c))})},za={canConvertUrl:b.wrap(ua,k(!1)),convertUrl:b.wrap(va,k(null)),getFieldsForUrl:b.wrap(wa,k(null)),getParamsForUrl:b.wrap(xa,k(null)),convertCallback:ya,transform:b.wrap(ea,k({})),generateUrl:p,generateUser:R,generateGroup:T,generateFile:A,generateNetwork:U,generatePage:C};return za}),define("core/lib/yammer_api",["require","underscore","core/lib/treatment","core/lib/yammer_request","core/lib/yammer_uri","core/lib/uri_helper","core/lib/util/hydrant_helper","core/lib/util/hydrant_grammar","core/lib/session"],function(a){"use strict";function b(a,b){var c,d={};if(b&&b>0&&(a=Array.prototype.slice.call(a,b)),a.length>4)throw new Error("Invalid argument list");if(1!=a.length||a[0].data||a[0].success||a[0].complete||a[0].error){if(1==a.length&&"function"!=typeof a[0])l.extend(d,a[0]);else if(a.length>=1){c=["success","error","data","category"];for(var e=0,f=a.length;f>e;e++)d[c[e]]=a[e]}}else d.data=a[0];return d}function c(a,b){return a.replace(/:([a-zA-Z_]+)/g,function(a,c){var d=b[c];return delete b[c],d})}function d(a,b,d){return b=l.defaults({},b,d),b.data=l.clone(b.data),b.url=o.api(c(a,b.data)),n.send(b)}function e(a,b,d){return b=l.defaults({},b,d),b.data=l.clone(b.data),b.url=o.apiV2(c(a,b.data)),n.send(b)}function f(a,b){return b=l.defaults({},b,v),b.contentType="text/plain; charset=UTF-8",b.url=o.apiV2(c(a,b.data)),b.data=r.stringify(b.data.query),n.send(b)}function g(a,b,c){var d={method:"POST",contentType:"text/plain; charset=UTF-8",url:q.convertUrl(a)+"?"+q.getParamsForUrl(a),data:q.getFieldsForUrl(a)};return n.send(d).then(q.convertCallback(b,a),c)}function h(a,b,d){return b=l.defaults({},b,d),b.data=l.clone(b.data),b.url=o.app(c(a,b.data)),n.send(b)}function i(a,b){return b.total_count=b[a].total_count,b[a]=b[a].results,b}function j(a){return q.transform(a,o.apiV2("search/"))}function k(){return m.treatment("suite_groups_enforce_blocked_words")?e:d}var l=a("underscore"),m=a("core/lib/treatment"),n=a("core/lib/yammer_request"),o=a("core/lib/yammer_uri"),p=a("core/lib/uri_helper"),q=a("core/lib/util/hydrant_helper"),r=a("core/lib/util/hydrant_grammar"),s=a("core/lib/session"),t={method:"GET",data:{},dataType:"json",auth:"oauth2"},u=l.extend({},t,{headers:{"Cache-Control":"no-cache, no-store"}}),v={method:"POST",data:{},dataType:"json",auth:"oauth2"},w=function(a){return l.extend({},v,{contentType:"application/json; charset=UTF-8",beforeSend:function(a,b){"string"!=typeof b.data&&(b.data=JSON.stringify(b.data))},processData:!1,data:a})},x=function(a,b){return l.extend({},a,{_network:b.id})},y={method:"PUT",data:{},dataType:"text",auth:"oauth2"},z={method:"DELETE",data:{},dataType:"text",auth:"oauth2"},A={event:function(a,b){var c={events:[{name:a,properties:b||{}}]};return e("events/log",w(c))},getUser:function(a){return d("users/:id.json",{data:a},t)},updateUser:function(a){return d("users/:id.json",{data:a},y)},updateCurrentMetaUser:function(a){return d("meta_users/current.json",{data:a},y)},getUsers:function(a){return d("users.json",{data:a},t)},getUsersWhoLikedMessage:function(a){return d("users/liked_message/:message_id",{data:a},t)},getUsersFollowing:function(a){return d("users/following/:user_id",{data:a},t)},getUsersFollowedBy:function(a){return d("users/followed_by/:id.json",{data:a},t)},getUsersInGroup:function(a){return d("users/in_group/:id.json",{data:a},t)},getUsersFollowingTopic:function(a){return d("users/following_topic/:topic_id",{data:a},t)},getUsersFollowingUploadedFile:function(a){return d("users/following_uploaded_file/:file_id",{data:a},t)},getUsersFollowingNote:function(a){return d("users/following_note/:note_id",{data:a},t)},getUsersByEmail:function(a){return d("users/by_email.json",{data:a},t)},getUsersByIds:function(a){return d("users/by_user_ids.json",{data:a},t)},validateGroupName:function(a){var b=k();return b("groups/validate_group_name",{data:a},v)},validateExternalNetworkName:function(a){return d("networks/validate_external_network_name",{data:a},v)},createGroup:function(a){return d("groups",{data:a},v)},deleteGroup:function(a){return d("groups/:id",{data:a},z)},getGroup:function(a){return d("groups/:id.json",{data:a},t)},getGroups:function(a){return d("groups.json",{data:a},t)},joinGroup:function(a){return d("group_memberships",{data:a,dataType:"text"},v)},leaveGroup:function(a){return d("group_memberships",{data:a,dataType:"text"},z)},updateGroup:function(a){return d("groups/:id.json",{data:a},y)},getGroupColorPalette:function(a){return d("groups/predefined_group_colors",{data:a},t)},updateNetworkInfo:function(a){return h("groups/company/infos/:id.json",{data:a},y)},getNetworks:function(a){return d("networks/current.json",{data:l.defaults(a||{},{exclude_own_messages_from_unseen:!0})},t)},getTokens:function(a){return d("oauth/tokens.json",{data:a},u)},getSubscriptions:function(a){return d("subscriptions.json",{data:a},t)},getSubscriptionToTarget:function(a){return d("subscriptions/to_target",{data:a},t)},getAutocomplete:function(a){return d("autocomplete",{data:a},t)},getAutocompleteRanked:function(a){return d("autocomplete/ranked",{data:a},t)},getSubscriptionToUser:function(a){return d("subscriptions/to_user/:userId.json",{data:a},t)},getSubscriptionsToTopic:function(a){return d("subscriptions/to_topic/:id.json",{data:a},t)},getTopic:function(a){return d("topics/:topic_id",{data:a},t)},postMessage:function(){var a=b(arguments);return d("messages",a,v)},getYmoduleData:function(a){return d("ymodules/:ymodule_id",{data:a},t)},sendYmoduleForm:function(a){return d("ymodules/:ymodule_id/inline",{data:a,dataType:"text"},v)},getAttachmentInlineHtml:function(a){return d("ymodules/:ymodule_id/inline",{auth:!1,data:a,dataType:"text"},t)},getThread:function(a){var b=o.api(c("messages/in_thread/:threadId.json",l.clone(a)));return q.canConvertUrl(b)&&m.treatment("perf_hydrant_web_all_feeds")?g(b,l.identity):d("messages/in_thread/:threadId.json",{data:a},t)},getThreadInfo:function(a){var b=o.api(c("messages/in_thread/:thread_id.json",l.clone(a)));return q.canConvertUrl(b)&&m.treatment("perf_hydrant_web_all_feeds")?g(b,function(b){var c=l.findWhere(b.references,{id:a.thread_id,type:"thread"});return c.references=b.references,c}):d("threads/:thread_id",{data:a},t)},getMessage:function(a){var b=o.api(c("messages/by_id/:id.json",l.clone(a)));return q.canConvertUrl(b)&&m.treatment("perf_hydrant_web_all_feeds")?g(b,l.identity):d("messages/by_id/:id.json",{data:a},t)},getMessageFeed:function(a){var b=o.api(c("message_feeds/:id.json",l.clone(a)));return q.canConvertUrl(b)&&m.treatment("perf_hydrant_web_all_feeds")?g(b,function(a){return{type:"message",data:a}}):d("message_feeds/:id.json",{data:a},t)},getInboxMessageFeed:function(a){return d("messages/inbox",{data:a},t)},followThreadInInbox:function(){var a=b(arguments);return d("threads/:threadId/follow.json",a,y)},unfollowThreadInInbox:function(){var a=b(arguments);return d("threads/:threadId/follow.json",a,z)},deleteMessage:function(a){return d("messages/:id.json",{data:a},z)},likeMessage:function(a){return d("messages/liked_by/current",{data:a,dataType:"text"},v)},unlikeMessage:function(a){return d("messages/liked_by/current",{data:a,dataType:"text"},z)},bookmarkMessage:function(a){return d("messages/favorites_of/current",{data:a,dataType:"text"},v)},unbookmarkMessage:function(a){return d("messages/favorites_of/current",{data:a,dataType:"text"},z)},getActivities:function(a){return d("streams/activities",{data:a},t)},getUserSuggestions:function(a){return d("suggestions.json",{data:l.defaults(a||{},{limit:21})},t)},logUserSuggestions:function(a){return d("suggestions/log.json",{data:a,dataType:"text"},v)},acceptUserSuggestion:function(a){return d("suggestions/:id.json",{data:a,dataType:"json"},y)},declineUserSuggestion:function(a){return d("suggestions/:id.json",{data:a},z)},getInboxGroups:function(a){return d("groups/unviewed.json",{data:a},t)},getGroupSuggestions:function(a){return d("group_suggestions.json",{data:l.defaults(a||{},{limit:21})},t)},logGroupSuggestions:function(a){return d("group_suggestions/log.json",{data:a,dataType:"text"},v)},acceptGroupSuggestion:function(a){return d("group_suggestions/:id.json",{data:a,dataType:"json"},y)},declineGroupSuggestion:function(a){return d("group_suggestions/:id.json",{data:a},z)},setThreadLastSeen:function(){var a=b(arguments);return d("messages/last_seen_in_thread.json",a,v)},postViewedThreads:function(){var a=b(arguments);return d("messages/viewed_messages.json",a,v)},addThreadParticipant:function(a){return d("threads/:threadId.json",{data:a,dataType:"json"},y)},removeThreadParticipants:function(a){return d("threads/:threadId/participants/:participantIds",{data:a,dataType:"json"},z)},moveToGroup:function(a){return d("threads/:id/move_to_group",{data:a,dataType:"json"},y)},applyTreatment:function(a){return d("experiments/:id/treated.json",{data:a},v)},getUploadedFile:function(a){return d("uploaded_files/:id.json",{data:a},t)},getRealtime:function(a){return d("realtime.json",{data:a},t)},getSignupInfo:function(a){return d("signup/network_info.json",{data:a},t)},changeEmail:function(a){return d("signup/change_email.json",{data:a},v)},validatePassword:function(a){return d("signup/validate_password.json",{data:a},v)},activateUser:function(a){return d("signup/complete_activation.json",{data:a},v)},updateOpenGraphObjects:function(){var a=l.defaults(b(arguments),{dataType:"json"});return d("open_graph_objects/update.json",a,y)},markMessageAsSpam:function(){var a=l.defaults(b(arguments),{dataType:"text"});return d("messages/:id/mark_as_spam",a,v)},muteThread:function(a){return d("threads/:thread_id/mute",{data:a},y)},unmuteThread:function(a){return d("threads/:thread_id/mute",{data:a},z)},getCurrentUser:function(a){return a||(a={with_prefs:!0,include_group_memberships:!0,with_attachments:!0}),d("users/current",{data:a},t)},switchLanguage:function(a){return d("language",{data:l.defaults({locale_type:"standard"},a)},v)},switchLanguageFromPublicSite:function(a){return h("tr8n/language/switch",{data:l.defaults({locale_type:"standard"},a)},l.defaults({auth:!1},v))},updateFeedSubscriptions:function(a){return h("feed_subscriptions/:client_type",{data:a},y)},createContentRelationship:function(a){return d("content_relationships",{data:a},v)},getContentRelationships:function(a){return d("content_relationships",{data:a},t)},updateContentRelationship:function(a){return d("content_relationships/:relationship_id",{data:a},y)},deleteContentRelationship:function(a){return d("content_relationships/:relationship_id",{data:a},z)},getUsagePolicy:function(){return d("usage_policy/current",{},t)},acceptUsagePolicy:function(){return d("usage_policy",{},v)},getGroupFilesCount:function(a){return d("uploaded_files/in_group_count/:group_id",{data:a},t)},getGroupNotesCount:function(a){return d("notes/in_group_count/:group_id",{data:a},t)},makeNoteOfficial:function(a){return d("notes/:note_id/set_official",{data:l.extend(a,{official:!0})},y)},makeNoteUnofficial:function(a){return d("notes/:note_id/set_official",{data:l.extend(a,{official:!1})},y)},makeFileOfficial:function(a){return d("uploaded_files/:file_id/set_official",{data:l.extend(a,{official:!0})},y)},makeFileUnofficial:function(a){return d("uploaded_files/:file_id/set_official",{data:l.extend(a,{official:!1})},y)},createOpenGraphActivity:function(a){return d("activity",{data:a},v)},getOpenGraphObject:function(a){return d("open_graph_objects",{data:a},t)},deleteOpenGraphObject:function(a){return d("open_graph_objects/:ogo_id",{data:a},z)},createOpenGraphObject:function(a){return d("open_graph_objects",{dataType:"json",data:a},v)},fetchOpenGraphObject:function(a){return d("open_graph_objects/fetch",{data:l.pick(a,"url")},t)},getSubscriptionToOpenGraphObject:function(a){return d("subscriptions/to_open_graph_object/:id",{data:a},t)},getLikesForOpenGraphObject:function(a){return d("likes/open_graph_object/:id",{data:a},t)},removeLikeForOpenGraphObject:function(a){return d("likes/:id",{data:a},z)},subscribeToTarget:function(a){return d("subscriptions",{data:a},v)},unsubscribeFromTarget:function(a){return d("subscriptions",{data:a},z)},getMugshotsInGroup:function(a){if(m.treatment("perf_hydrant_web_all_feeds")){var b={feed:{threads:{messages:{sender_id:!0}},reference_data:{users:{mugshot_id:!0}},url_templates:{user_mugshot:!0}}},c={threads_count:1,messages_count:1,exclude_own_messages_from_unseen:!0},e="networks/:network_id/feeds/group/:group_id?"+p.paramify(c);return a=l.extend({},a,{network_id:s.getCurrentNetwork().id,group_id:a.group_id||"general",query:b}),f(e,{data:a})}return d("messages/"+(a.group_id?"in_group/:group_id":"general")+".json",{data:a},t)},getMugshotsInAllCompany:function(a){return this.getMugshotsInGroup(l.without(a,"group_id"))},createNote:function(a){return d("notes",{data:a},v)},getNote:function(a){return d("notes/:note_id",{data:a},t)},deleteNote:function(a){return d("notes/:note_id",{data:a},z)},updateNoteTitle:function(a){return d("notes/:note_id",{data:a},y)},revertNoteToVersion:function(a){return d("notes/:note_id/revert_to_version/:version_id",{data:a},v)},publishNote:function(a){return d("notes/:note_id/publish",{data:a},v)},updateFileTitle:function(a){return d("uploaded_files/:id",{data:a},y)},updateFileDescription:function(a){return d("uploaded_files/:id",{data:a},y)},deleteFile:function(a){return d("uploaded_files/:file_id",{data:a},z)},revertFileToVersion:function(a){return d("uploaded_files/:file_id/revert_to_version/:version_id",{data:a},v)},setUserPresence:function(a){return d("whoville/networks/:network_id/users/:user_id/:presence",{data:a},v)},getUsersPresence:function(a){return d("whoville/presence/networks/:network_id",w(a))},getVideoStreamingPath:function(a){return d(a&&a.version_id?"uploaded_files/:file_id/version/:version_id/stream":"uploaded_files/:file_id/stream",{data:a,dataType:"text"},t)},inviteOrFollow:function(a){return d("follow_invitations",{data:a},v)},inviteToGroup:function(a){return d("invitations",{data:a},v)},approveGroupMembership:function(a){return d("group_memberships/approve",{data:a},v)},allowGroupMembership:function(a){return d("group_memberships/allow",{data:a},v)},createGroupMembership:function(a){return d("group_memberships",{data:a},v)},deleteGroupMembership:function(a){return d("group_memberships",{data:a},z)},denyGroupMembership:function(a){return d("group_memberships/deny",{data:a},v)},addToGroup:function(a){return h("group_settings/process_additions/:group_id",{auth:!1,data:a},v)},claimGroup:function(a){return h("groups/:id/claim",{data:a},v)},emailMessage:function(a){return d("messages/email",{dataType:"text",data:a},t)},addThreadTopic:function(a){return d("threads/:thread_id/apply_topic",{data:a},v)},removeThreadTopic:function(a){return d("threads/:thread_id/remove_topic",{data:a},v)},addNoteTopic:function(a){return d("notes/:note_id/apply_topic",{data:a},v)},removeNoteTopic:function(a){return d("notes/:note_id/remove_topic",{data:a},v)},addFileTopic:function(a){return a.file_id||(a.file_id=a.itemId),d("uploaded_files/:file_id/apply_topic",{data:a},v)},removeFileTopic:function(a){return a.file_id||(a.file_id=a.itemId),d("uploaded_files/:file_id/remove_topic",{data:a},v)},recordOpenGraphClick:function(a){return d("open_graph_objects/click",{data:a},v)},getTreatments:function(a){return d("experiments/treatments",{data:a},t)},getTreatmentsMetaData:function(a){return d("experiments/treatments_meta_data",{data:a},t)},inviteToCollaborateOnNote:function(a){return d("notes/:note_id/invite",{data:a},v)},getTopSpammers:function(a){return h("admin/top_spammers",{data:a},t)},blockSpammer:function(a){return h("admin/top_spammers/:user_id/block",{data:a},v)},unblockSpammer:function(a){return h("admin/top_spammers/:user_id/unblock",{data:a},v)},setPrivateContentMode:function(a){return d("supervisor_mode/toggle",{data:a},v)},searchMessages:function(a){return a=x(a,s.getCurrentNetwork()),d("search_tabs",{cache:!0,data:a})},getSearchResultsTab:function(a){return a=x(a,s.getCurrentNetwork()),d("search_tabs",{dataType:"html",cache:!0,data:a})},getSearchResults:function(a){return a=x(a,s.getCurrentNetwork()),d("search.json",{cache:!0,data:a})},searchInbox:function(a){return a=x(a,s.getCurrentNetwork()),d("search_tabs",{data:a},t)},getSearchSummary:function(a){var b=l.extend({},t);return b.data=x(a,s.getCurrentNetwork()),b.url=o.apiV2("search/summary"),b.cache=!0,n.send(b)},searchV2:function(a,b){var c=l.extend({},t);return c.data=x(a,s.getCurrentNetwork()),c.url=o.apiV2(b||"search/models"),c.cache=!0,n.send(c).then(function(a){return a.failures&&console.warn("Search reported failures: ",a.failures),a})},searchMessagesV2:function(a){return this.searchV2(a).then(i.bind(null,"threads")).then(j)},searchUsersV2:function(a){return this.searchV2(a).then(i.bind(null,"users"))},searchInboxV2:function(a){return this.searchV2(a,"search_inbox").then(i.bind(null,"threads")).then(j)},searchGroupsV2:function(a){return this.searchV2(a).then(i.bind(null,"groups"))},searchTopicsV2:function(a){return this.searchV2(a).then(i.bind(null,"topics"))},getInvitableContactsForNetwork:function(a){return h("/contacts/network",{data:a},t)},searchFilesV2:function(a){return this.searchV2(a).then(i.bind(null,"files"))},searchPagesV2:function(a){return this.searchV2(a).then(i.bind(null,"pages"))},inviteToNetwork:function(a){return h("invitations/emails",{data:a},v)},inviteAllToNetwork:function(a){return h("invitations/inviteAll",{data:a},v)},startNetworkMigration:function(a){return d("network_migrations",{data:a},v)},getNetworkMigrationErrors:function(a){return d("network_migrations/:network_id/errors",{data:a},t)},getNetworkDomains:function(a){return d("network_domains",{data:a},t)},getInvites:function(){return d("networks/invites",{},t)},getVerifiedDomains:function(a){return d("o365/verified_domains",{data:a},t)},translate:function(a){return d("translate",{data:{json:JSON.stringify(a)}},v)},registerGroupVisit:function(a){return d("groups/:id/visit",{data:a},v)},getRequests:function(){return d("requests.json",{},t)},getYamjsToken:function(){return d("yamjs",{},t)},reportEvent:function(a){return e("events",w(a))},getUsersGroups:function(a){return d("groups/for_user/:id.json",{data:a},t)}};return A.getMessages=function(){var a=b(arguments);a=l.extend({},t,a);var c=a.success||l.identity,d=a.error||l.identity,e=a.processor||l.identity;delete a.success,delete a.error,delete a.processor;var f=e(c);return q.canConvertUrl(a.url)?g(a.url,f,d):n.send(a).then(f,d)},yam.api=A,A}),define("core/lib/report",["require","jquery","underscore","core/lib/log","core/lib/session","core/lib/yammer_config","core/lib/yammer_request","core/lib/yammer_api"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/log"),e=a("core/lib/session"),f=a("core/lib/yammer_config"),g=a("core/lib/yammer_request"),h=a("core/lib/yammer_api");return{_queuedEvents:[],_throttledReport:null,register:function(a){var b=window.mpq||void 0;if("undefined"!=typeof b){var c=e.getCurrentUser(),d=e.getCurrentNetwork();c&&d?(b.identify(c.id),b.register({network:d.id},"all",5)):"undefined"!=typeof a&&b.identify(a)}this.logRevisionSha()},logRevisionSha:c.once(function(){var a=document.querySelector('meta[name="yamjs-revision"]'),b=a?a.content:"";c.isString(b)&&b.length>0&&this.info({message:"YAMJS_REVISION",content:b})}),event:function(a,b){b=c.extend({},b||{}),b.page_load_id=g.getPageLoadId(),b.client_event_time=Date.now(),b.client_load_time=g.getClientLoadTime(),this._queuedEvents.push({name:a,properties:b}),this._throttledReport=this._throttledReport||this._createThrottledReport(),this._throttledReport()},_createThrottledReport:function(){return c.throttle(this._reportQueuedEvents.bind(this),1e3,{leading:!1})},_reportQueuedEvents:function(){var a=this._queuedEvents;h.reportEvent({events:a}),this._queuedEvents=[]},_RecordType:{ERROR:{logType:"error",eventName:"javascript_exception"},INFO:{logType:"info",eventName:"yamjs_info"}},_queuedLogs:{ERROR:[],INFO:[]},_throttledPost:null,error:function(a,b){this._reportLog(this._RecordType.ERROR,a,b)},info:function(a,b){this._reportLog(this._RecordType.INFO,a,b)},_reportLog:function(a,b,c){b=b||{},c&&c.stack&&(b.stack=c.stack);var d=this._buildRecord(a.logType,a.eventName,b);switch(a){case this._RecordType.ERROR:this._queuedLogs.ERROR.push(d);break;case this._RecordType.INFO:this._queuedLogs.INFO.push(d);break;default:return}this._throttledPost=this._throttledPost||this._createThrottledPost(),this._throttledPost()},_buildRecord:function(a,b,d){var f=c.extend({},d,{client_load_time:g.getClientLoadTime(),client_load_id:g.getPageLoadId()});return{ClientId:1,UserId:e.getCurrentUser()?e.getCurrentUser().id:null,NetworkId:e.getCurrentNetwork()?e.getCurrentNetwork().id:null,LogType:a,ClientTimeStamp:Date.now(),DeviceId:null,EventName:b,Parameters:f}},_createThrottledPost:function(){return c.throttle(this._post.bind(this),1e4)},_post:function(){var a=c.flatten(c.map(this._queuedLogs,function(a){return a}));b.ajax({url:f.config().reportPerfRequestUri,type:"POST",data:JSON.stringify(a),contentType:"application/json",error:function(a,b,c){d.warn("report._post: Error: "+b+" "+c)},success:function(){this._clearQueuedLogs()}.bind(this),headers:{Authorization:f.config().reportAuthorizationHeader}})},_clearQueuedLogs:function(){this._queuedLogs={ERROR:[],INFO:[]}}}}),define("core/lib/error_handler",["require","core/lib/report","core/lib/session"],function(a){"use strict";var b=a("core/lib/report"),c=a("core/lib/session"),d={};return d.toggleReporting=function(){var a=window.onerror||function(){};window.onerror=function(d,e,f,g,h){c.getCurrentUser()&&b.error({message:d,file:e,line:f,col:g},h),a.apply(this,arguments)}},d}),define("core/lib/secure_opener",["require","jquery","core/lib/log"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/log"),d={open:function(a){var b=window.open.apply(window,arguments);b&&(b.opener=null),c.log("Opener removed from link to "+a)},handleLinks:function(){b(function(){b("body").on("click",'a[target][rel~="noreferrer"]',function(a){d.open(this.href,this.target),a.preventDefault()})})}};return d}),define("workfeed/lib/app/bundles/token_bundle",["require","jquery","core/lib/yammer_request","core/lib/cookie_helper"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/yammer_request"),d=a("core/lib/cookie_helper");return{run:function(a){var c=a.currentUser.web_oauth_access_token,d=this._setToken.bind(this,c),e=this._setCookieIfChanged.bind(this,c);d(),b(window).on("focus",e)},_setToken:function(a){c.getAuthenticator({auth:"oauth2"}).setAuthToken({token:a})},_setCookieIfChanged:function(a){a!==d.get("oauth_token")&&d.set({name:"oauth_token",value:a})}}}),define("workfeed/lib/app/bundles/resource_bundle",["require","underscore","core/lib/yammer_config"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/yammer_config");return{run:function(a){c.config(b.pick(a,["assetHost","cdnAssetHost","mugshotHost","cdnMugshotHost","filesHost","baseURI","apiBaseURI","reportPerfRequestUri","reportAuthorizationHeader","refreshTokens","debug","videoStreamingUri","hasAppAlready","paddieHost"]))}}}),define("core/lib/client/lifecycle",["backbone","underscore"],function(){var a=require("backbone"),b=require("underscore");return b.extend({},a.Events,{isStarted:function(){return"started"===this._getLifecycleState()},isStarting:function(){return"starting"===this._getLifecycleState()},isStopping:function(){return"stopping"===this._getLifecycleState()},isStopped:function(){return"stopped"===this._getLifecycleState()},setStarting:function(){this._setLifecycleState("starting"),this.onStarting()},setStarted:function(){this._setLifecycleState("started"),this.onStarted()},setStopping:function(){this._setLifecycleState("stopping"),this.onStopping()},setStopped:function(){this._setLifecycleState("stopped"),this.onStopped()},_getLifecycleState:function(){return this._lifecycleState},_setLifecycleState:function(a){this._lifecycleState=a},onStarting:function(){},onStarted:function(){this.trigger("onStarted",arguments)},onStopping:function(){},onStopped:function(){}})}),define("core/lib/ctor",["require","underscore","core/lib/namespace"],function(a){var b=a("underscore"),c=a("core/lib/namespace"),d=!0,e=function(a,c){return b.extend.apply(b,[a].concat(c))};return function(){var a,f,g,h=[],i=arguments.length;if(2>i)throw new Error("ctor: ArgumentError: invalid argument combination");if(2===i)a=arguments[0],g=arguments[1];else if(3===i)a=arguments[0],g=arguments[2],b.isArray(arguments[1])?h=arguments[1]:f=arguments[1];else{if(4!==i)throw new Error("ctor: ArgumentError: invalid argument combination");a=arguments[0],f=arguments[1],h=arguments[2],g=arguments[3]}g.init=g.init||f&&f.prototype.init||function(){};var j=function(){d&&this.init.apply(this,arguments)},k=h.concat([g]);f&&(d=!1,j.prototype=new f,d=!0),e(j.prototype,k);var l;return a&&(l=a.split("."),c.ns(l.slice(0,-1))[l[l.length-1]]=j,j.prototype.declaredClass=a),j}}),define("core/lib/client/base_client",["require","core/lib/client/lifecycle","core/lib/ctor"],function(a){var b=a("core/lib/client/lifecycle"),c=a("core/lib/ctor");return c(null,[b],{init:function(a){this.setUrl(a.url)},start:function(){},stop:function(){},onData:function(){},onDataError:function(){},onPayload:function(){},onPayloadComplete:function(){},onConnectionOpening:function(){},onConnectionOpened:function(){this.setStarted(!0)},onConnectionOpenError:function(){},onConnectionReset:function(){},onConnectionClosing:function(){},onConnectionClosed:function(){},onConnectionCloseError:function(){},onConnectionReopening:function(){},onConnectionReopened:function(){},onConnectionReopenError:function(){},onConnectionInterrupted:function(){},onConnectionDenied:function(){},onConnectionTick:function(){},setConnection:function(){},onRealtimeFailure:function(){this.stop()},setUrl:function(a){this._url=a},getUrl:function(){return this._url}})}),define("core/lib/client/payload",["require","core/lib/ctor","core/lib/namespace"],function(a){var b=a("core/lib/ctor"),c=a("core/lib/namespace");return b(null,{init:function(a){this._raw=a},getRaw:function(){return this._raw},val:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift(this._raw),c.val.apply(c,a)}})}),define("core/lib/data/memory_store",["require","underscore","core/lib/ctor"],function(a){var b=a("underscore"),c=a("core/lib/ctor");return c(null,{init:function(){this._data={}},create:function(a){return this._data[a.id]=a,a},update:function(a,b){var c={before:{},after:{}};for(var d in b)b.hasOwnProperty(d)&&(c.before[d]=a[d],a[d]=b[d],c.after[d]=a[d]);return c},destroy:function(a){return delete this._data[a.id],
a},truncate:function(){this._data={}},all:function(){var a=this._data,b=[];for(var c in this._data)b.push(a[c]);return b},find:function(a,c){var d=this._data,e=[];c=b.isNumber(c)?c:1/0;for(var f in d){var g=!0,h=d[f];for(var i in a)if(!b.isEqual(h[i],a[i])){g=!1;break}if(g&&e.push(h),e.length>=c)break}return e},findById:function(a){return this._data[a]}})}),define("core/lib/data/remote_methods",["require","underscore","core/lib/log","core/lib/namespace","core/lib/yammer_request","core/lib/util/hydrant_helper","backbone"],function(a){function b(a){return a._clientKey+a.getUrl()}function c(a,c){c=d.extend({},a.getClientOptions(),c);var e=b(a),f=j[e];f||(c.url=a.getUrl(),f=new a._clientClass(c),f.onData=d.wrap(f.onData,function(){var b=Array.prototype.shift.call(arguments);b.apply(b,arguments),a.onDataSingle.apply(a,arguments)}.bind(this))),j[e]=f}var d=a("underscore"),e=a("core/lib/log"),f=a("core/lib/namespace"),g=a("core/lib/yammer_request"),h=a("core/lib/util/hydrant_helper"),i=a("backbone");f.ns("yam.client");var j=yam.client._clients={},k={onData:!0,onDataError:!0,onBeforeRequest:!0,onAfterProcess:!0,onFirstPayload:!0},l={getUrl:function(){return this.url},getClient:function(){return j[b(this)]},getClientOptions:function(){},isStarted:function(){var a=this.getClient();return!!a&&a.isStarted()},hasOlderAvailable:function(){var a=this.getClient();return a&&a.hasOlderAvailable()},onDataSingle:function(){var a=d.toArray(arguments).slice(0);this.onData.apply(this,a),this.getRepository().transaction(d.bind(function(){this.process.apply(this,a)},this)),this.trigger&&this.trigger.apply(this,["onAfterProcess"].concat(a)),this._hasFirstPayload||(this.trigger&&this.trigger.apply(this,["onFirstPayload"].concat(a)),this._hasFirstPayload=!0)},onDataError:function(){},process:function(){throw new Error("ORM Error: process method must be implemented for clientized models")},listen:function(a){a=a||{},c(this,a),a.startClient!==!1&&this.getClient().start()},isListening:function(){return this.getClient()&&this.getClient().isStarted()},fetchPayload:function(a){a=d.extend({dataType:"json"},a||{});var b=this,c=a.success||d.identity,f=a.error||d.identity,j=a.processor||d.identity;delete a.success,delete a.error,delete a.processor;var k=function(d){var f=arguments;try{return a.afterProcess=a.afterProcess||function(){},i.listenToOnce(b,"onAfterProcess",a.afterProcess.bind(a)),a.firstPayload=a.firstPayload||function(){},i.listenToOnce(b,"onFirstPayload",a.firstPayload.bind(a)),c.apply(a,f),b.onDataSingle(d),d}catch(a){e.warn("error occurred in fetchPayload success handler: ",a,a.stack)}finally{i.stopListening(b,"onAfterProcess onFirstPayload")}};a.beforeRequest=a.beforeRequest||function(){},i.listenToOnce(this,"onBeforeRequest",a.beforeRequest);try{this.trigger("onBeforeRequest",a),this.onBeforeRequest(a)}catch(a){e.log("error occurred in fetchPayload/beforeRequest")}finally{i.stopListening(this,"onBeforeRequest")}var l=j(k);if(h.canConvertUrl(a.url)){var m=a.url;a.method="POST",a.contentType="application/attrs; charset=UTF-8",a.url=h.convertUrl(a.url)+"?"+h.getParamsForUrl(m),a.data=h.getFieldsForUrl(m),l=h.convertCallback(l,m)}return g.send(a).then(l,f)},unlisten:function(){var a=b(this);this._hasFirstPayload=!1,j[a]&&(j[a].stop(),delete j[a])}},m=function(){l[arguments[1]]=function(){}};return d.each(k,m),l}),define("core/lib/data/dsl_methods",["require","underscore","core/lib/data/remote_methods"],function(a){var b=a("underscore"),c=a("core/lib/data/remote_methods");return{clientize:function(a,d){b.extend(this.prototype,c),this.prototype._clientClass=a,this.prototype._clientKey=d}}}),define("core/lib/data/instance_methods",["require","underscore"],function(a){var b=a("underscore");return{get:function(a){return this[a]},create:function(){var a=this.getRepository().create(this.declaredClass,this);if(yam.backbone.isBackboneModel(this.declaredClass)){var c={};b.each(b.pairs(a),function(a){c[a[0]]=a[1]});var d=yam.backbone.getBackboneCollectionInstance(this.declaredClass);d.add(c)}return a},update:function(a){var b=this.getRepository().update(this.declaredClass,this,a);if(yam.backbone.isBackboneModel(this.declaredClass)){var c=yam.backbone.getBackboneCollectionInstance(this.declaredClass).get(this.id);c&&c.set(b.after)}return b},destroy:function(){this.unlisten&&this.unlisten();var a=this.getRepository().destroy(this.declaredClass,this);return yam.backbone.isBackboneModel(this.declaredClass)&&yam.backbone.getBackboneCollectionInstance(this.declaredClass).remove(this.id),a},getRepository:function(){return this._repository},setRepository:function(a){this._repository=a},hasAutoKey:function(){return!!this._autoKey},assignAutoKey:function(){var a=this.constructor.prototype;this.id=a._autoKey++},isForeign:function(){return!1}}}),define("core/lib/data/static_methods",["require","core/lib/namespace"],function(a){var b=a("core/lib/namespace");return{all:function(){var a=this.prototype;return a._repository.all(a.declaredClass)},find:function(a,b){var c=this.prototype;return c._repository.find(c.declaredClass,a,b)},findById:function(a){var b=this.prototype;return b._repository.findById(b.declaredClass,a)},findFirst:function(a){return this.find(a,1)[0]},hasAutoKey:function(){return!!this.prototype._autoKey},findOrCreate:function(a){return this.findFirst(a)||this.create(a)},_findInstance:function(a){var b,c=a.id,d=this.hasAutoKey();return d?b=this.findFirst(a):c&&(b=this.findById(c)),b},create:function(a){var c=this.prototype.declaredClass,d=b.ns(c),e=new d(a);return e.create()},save:function(a){var b=this._findInstance(a);return b?b.update(a):b=this.create(a),b},update:function(a){var b=this._findInstance(a);return b.update(a),b},destroyAll:function(){var a=this.prototype;a._repository.destroyAll(a.declaredClass)},truncate:function(){var a=this.prototype;if(a._repository.truncate(a.declaredClass),a._autoKey&&(a._autoKey=1),yam.backbone.isBackboneModel(a.declaredClass)){var b=yam.backbone.getBackboneCollectionInstance(a.declaredClass);b.reset()}}}}),define("models/lib/events",["require","backbone","underscore"],function(a){var b=a("backbone"),c=a("underscore");return c.extend({},b.Events)}),define("core/lib/data/repository",["require","underscore","core/lib/data/memory_store","core/lib/ctor","core/lib/data/dsl_methods","core/lib/data/instance_methods","core/lib/log","core/lib/namespace","core/lib/data/static_methods","models/lib/events"],function(a){var b=a("underscore"),c=a("core/lib/data/memory_store"),d=a("core/lib/ctor"),e=a("core/lib/data/dsl_methods"),f=a("core/lib/data/instance_methods"),g=a("core/lib/log"),h=a("core/lib/namespace"),i=a("core/lib/data/static_methods"),j=a("models/lib/events");return d(null,{init:function(){this._models={},this._modelEventQueue=[],this._inTransaction=!1},create:function(a,b){b.hasAutoKey()&&b.assignAutoKey();var c=a.split(".")[2];return b=this.getModelStore(a).create(b),this._triggerEvent(c+"/create",b),this._triggerEvent(c+"/save",b),b},update:function(a,b,c){var d=this.getModelStore(a).update(b,c),e=a.split(".")[2];return this._triggerEvent(e+"/update",b,d),this._triggerEvent(e+"/"+b.id+"/update",b,d),this._triggerEvent(e+"/save",b,d),this._triggerEvent(e+"/"+b.id+"/save",b,d),d},destroy:function(a,b){var c=a.split(".")[2];return b=this.getModelStore(a).destroy(b),j.trigger(c+"/destroy",b),j.trigger(c+"/"+b.id+"/destroy",b),j.off(c+"/"+b.id+"/destroy"),j.off(c+"/"+b.id+"/save"),j.off(c+"/"+b.id+"/update"),j.off(c+"/"+b.id+"/create"),b},destroyAll:function(a){for(var b=h.ns(a),c=b.all(),d=0,e=c.length;e>d;++d)this.destroy(a,c[d])},clear:function(){var a=this._models;for(var b in a){var c=h.ns(b);c.truncate()}},truncate:function(a){return this.getModelStore(a).truncate()},all:function(a){return this.getModelStore(a).all()},findById:function(a,b){return this.getModelStore(a).findById(b)},find:function(a,b,c){return this.getModelStore(a).find(b,c)},getModelStore:function(a){return this._models[a]},register:function(a){var b=this._define.apply(this,arguments);return this._models[a]=new c,b},getEventQueue:function(){return this._modelEventQueue},begin:function(){this._inTransaction=!0},commit:function(){if(this._inTransaction){var a,b,c,d;try{for(;this._modelEventQueue.length;)d=this._modelEventQueue.shift(),d.changes?j.trigger(d.event,d.instance,d.changes):j.trigger(d.event,d.instance)}catch(d){var e=a&&a.prototype&&a.prototype.declaredClass;g.warn("transaction error: "+e+"."+b+" called with args: ",c,d,d.stack)}finally{this._inTransaction=!1,this._modelEventQueue=[]}}},transaction:function(a){this.begin(),a.call(a),this.commit()},inTransaction:function(){return this._inTransaction},_triggerEvent:function(a,b,c){this._inTransaction?this._modelEventQueue.push({event:a,instance:b,changes:c}):c?j.trigger(a,b,c):j.trigger(a,b)},_define:function(){var a=Array.prototype.slice.call(arguments,0),c=a.pop(),g=b.extend(function(){},e);g.prototype.declaredClass=a[0],b.extend(g.prototype,f),g.prototype.init=function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},b.extend(g,i),c.bind(g)();var h,j,k=d.apply(d,a.concat(g.prototype)),l=a[1],m=!!g.init;"function"==typeof l?(h=function(){},h.prototype=l,j=d("yam.___tmp",h,g).prototype,delete yam.___tmp,m||delete j.init):j=g;for(var n in j)j.hasOwnProperty(n)&&(k[n]=j[n]);return k.prototype.setRepository(this),k}})}),define("core/lib/model_helper",["require","underscore","core/lib/data/repository","core/lib/namespace","core/lib/string_helper","models/group","collections/groups"],function(a){var b=a("underscore"),c=a("core/lib/data/repository"),d=a("core/lib/namespace"),e=a("core/lib/string_helper"),f=a("models/group"),g=a("collections/groups");d.ns("yam.model");var h={};h.getGlobalModelRepository=function(){return yam.model.repository||(yam.model.repository=new c),yam.model.repository},h.define=function(){var a=h.getGlobalModelRepository();return a.register.apply(a,arguments)},h.objectForReference=function(a){if(!(a&&a.type&&a.id))throw new Error("Reference is no good: "+a);return i(a.id,a.type)},h.getModelByType=function(a){if(!a)throw new Error("Type is no good: "+a);return l(a)};var i=function(a,b){return b&&"group"===b.toLowerCase()?g.get(a):j(a,b)},j=function(a,c){var d=k(c);return b.has(yam.model,d)?yam.model[d].findById(a):yam.model.Unknown.findFirst({lookup_id:a+"/"+c})},k=function(a){return e.camelize(a,!0)},l=function(a){return"group"==a?f:m(a)},m=function(a){var c=k(a);return b.has(yam.model,c)?yam.model[c]:yam.model.Unknown};return h.toTypeStr=function(a){var b=a.declaredClass||a.prototype.declaredClass;return e.snakeize(b.split(".").pop())},b.extend(yam.model,h),h}),define("models/user",["require","core/lib/model_helper"],function(a){var b=a("core/lib/model_helper");return b.define("yam.model.User",function(){this.prototype.type="user"})}),define("core/lib/util/email_extractor",["require","underscore","core/lib/ctor"],function(a){var b=a("underscore"),c=a("core/lib/ctor"),d=c(null,{init:function(a){null!=a&&(this._filter=a.filter)},setFilter:function(a){this._filter=a},extractEmails:function(a){var c=a.match(j),d=b.groupBy(c,this.isAcceptableEmail,this),e=d[!0]||[],f=d[!1]||[];return{accepted:e,rejected:f}},isEmail:function(a){return i.test(a)},isAcceptableEmail:function(a){return this.isEmail(a)&&(null!=this._filter?this._filter.call(this,a):!0)}}),e="[-!#$%&*+/0-9=?A-Z^_a-z{|}~](?:\\.?[-!#$%&*+/0-9=?A-Z^_a-z{|}~])*@",f="[a-zA-Z0-9](?:-?[a-zA-Z0-9])*(?:\\.[a-zA-Z](?:-?[a-zA-Z0-9])*)+",g="("+e+f+")",h=new RegExp("^"+e),i=new RegExp("^"+g+"$"),j=new RegExp(g,"g"),k=/\s/;return d.getDomainFromEmail=function(a){if("string"==typeof a&&i.test(a)){var b=a.indexOf("@"),c=a.substring(b+1);return c.match(/\.[\w]{2,}$/)?c:void 0}},d.hasValidFirstHalfOfEmail=function(a){var b=h.test(a),c=k.test(a);return b&&!c},d.isValidEmail=function(a){return i.test(a)},d}),define("models/group_membership",["require","models/yammer_model","core/lib/namespace"],function(a){"use strict";var b=a("models/yammer_model"),c=a("core/lib/namespace"),d=b.extend({defaults:{type:"group_membership"}});return c.ns("yam.backbone.model"),yam.backbone.model.GroupMembership=d,d}),define("collections/group_memberships",["require","collections/yammer_collection","models/group_membership","core/lib/namespace"],function(a){"use strict";var b=a("collections/yammer_collection"),c=a("models/group_membership"),d=a("core/lib/namespace"),e=b.extend({model:c,add:function(a,c){return c=c||{},c.compositeKey=["group_id","user_id"],b.prototype.addWithCompositeKey.call(this,a,c)}});return d.ns("yam.backbone.collection"),yam.backbone.collection.GroupMemberships=new e,yam.backbone.collection.GroupMemberships}),define("models/helpers/user",["require","underscore","core/lib/tr","core/lib/util/email_extractor","core/lib/string_helper","collections/group_memberships","collections/groups","backbone","core/lib/yammer_api"],function(a){var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/util/email_extractor"),e=a("core/lib/string_helper"),f=a("collections/group_memberships"),g=a("collections/groups"),h=a("backbone"),i=a("core/lib/yammer_api"),j=function(a,b){return a[b]||a.get&&a.get(b)},k=function(a){return i.getUser({id:a})},l=function(a,b){var c=j(a,"network_id")||j(a,"networkId");if(null==c)return null;var d=b.findById(c);return null!=d?d.getPlainBody():null},m=function(a){var c=j(a,"type"),e=j(a,"email"),f=b.isFunction(a.getId)?a.getId():j(a,"id");return"domain"===c?d.getDomainFromEmail(f):d.getDomainFromEmail(e)},n=function(a){return j(a,"full_name")||j(a,"name")||j(a,"permalink")},o=function(a){var b=j(a,"first_name"),c=j(a,"full_name");return b&&b.length>0?b:c&&c.length>0?c.match(/\S+/)[0]:j(a,"name")},p=function(a,b){return l(a,b)||j(a,"network_name")||m(a)},q=function(a){return"user"===j(a,"type")},r=function(a,b){var c=j(a,"foreign");if("boolean"==typeof c)return c;var d=b.getCurrentNetwork(),e=d&&d.id,f=j(a,"network_id")||j(a,"networkId");return null!=e&&null!=f&&e!=f},s=function(a,b){var c=j(a,"id");return"<div class='yj-presence yj-presence-inline yamicon "+t(a,b)+"' data-yj-user-id='"+c+"' ></div>"},t=function(a,b){switch(A(a,b)){case"online":return"yamicon-circle yj-status-green yamicon-xy-small";case"mobile":return"yamicon-smartphone yj-status-green yamicon-regular";case"offline":return"yamicon-chat-here yj-status-gray yamicon-xy-small";default:return"yamicon-chat-here yj-status-gray yamicon-xy-small"}},u=function(a,b){switch(A(a,b)){case"online":return c.t("available");case"mobile":return c.t("on_device");case"offline":return c.t("offline_2");default:return c.t("offline_2")}},v=function(a){var b=j(a,"state");return"active"===b},w=function(a){var b=j(a,"state");return"suspended"===b||"deleted"===b},x=function(a,b){var c=new Date(b.getCurrentNetwork().created_at).getTime(),d=Date.now(),e=new Date(j(a,"activated_at")).getTime(),f=12096e5,g=d-c>=f&&e-c>=f,h=f>=d-e;return v(a)&&g&&h},y=function(a){var b=j(a,"contact");return b&&b.has_fake_email},z=function(a){var b=j(a,"web_preferences");return b&&b.has_mobile_client},A=function(a,b){var c="offline",d=j(a,"presence");return w(a)?c="offline":r(a,b)?c="foreign":d&&(c=d.status||d||c,"idle"===c&&(c="online")),c},B=function(a){var b=j(a,"web_preferences");return b&&b.network_settings},C=function(a){var b=B(a);return b?e.convertStringyBoolean(b.allow_attachments):!0},D=function(a){var b=B(a);return b?e.convertStringyBoolean(b.allow_notes):!0},E=function(a){var b=j(a,"mugshot_url");return b&&-1===b.indexOf("no_photo")},F=function(a){var b=new Date(j(a,"activated_at")).getTime(),c=864e5,d=Date.now()-b>c;return!E(a)&&v(a)&&d},G=function(a,b){return!H(a,b)&&j(a,"show_ask_for_photo")},H=function(a,b){var c=j(a,"id");return j(b.getCurrentUser(),"id")===c},I=function(a,c){var d=j(a,"contact"),e=b(d&&d.email_addresses||[]),f=e.find(function(a){return a.type===c});return f&&f.address||""},J=function(a){return I(a,"primary")},K=function(a,c){var d=j(a,"contact"),e=b(d&&d.phone_numbers||[]),f=e.find(function(a){return a.type===c});return f?f.number:void 0},L=function(a){return K(a,"work")||""},M=function(a){return K(a,"mobile")||""},N=function(a){return e.convertStringyBoolean(j(a,"admin"))},O=function(a){return e.convertStringyBoolean(j(a,"verified_admin"))},P=function(a){return e.convertStringyBoolean(j(a,"supervisor_admin"))},Q=function(a){var b=j(a,"web_preferences");return b&&b.prescribed_my_feed},R=function(a){var b=j(a,"web_preferences");return b&&b.sticky_my_feed},S=function(a,b){var c={user_id:j(a,"id"),group_id:j(b,"id")};return f.findWhere(c)},T=function(a,b){var c,d=null,e=j(a,"group_memberships")||[];if(!b)return!1;for(c=0;c<e.length;c++){var f=e[c],g=j(b,"realId")||j(b,"id");if(f.id===g){d=f;break}}return!(null===d||!d.admin)},U=function(a,b){if(!b.isForeign()&&(N(a)||O(a)))return!0;var c=b.system_message_properties;if(c&&("pm_to_group"===c.subtype||"added_participant"===c.subtype))return!1;var d=g.get(b.group_id);return b.sender_id===a.id||void 0!==b.group_id&&T(a,d)},V=function(a,b){if(!b.isSystemMessage()||"added_participant"!==b.getSystemMessageType())return!1;if(!b.isForeign()&&(N(a)||O(a)))return!0;var c=g.get(b.group_id);return b.sender_id===a.id||void 0!==b.group_id&&T(a,c)},W=function(a,b){return!j(b,"foreign")&&e.convertStringyBoolean(j(a,"can_broadcast"))?!0:b&&T(a,b)},X=function(a){return f.where({user_id:j(a,"id")})},Y=function(a,b){return!!f.where({user_id:j(a,"id"),group_id:b,invited:!0}).length},Z=function(a,b,c){a.following=a.following||{},a.following[b]=a.following[b]||new h.Collection,a.following[b].add({id:c})},$=function(a,b,c){a.following=a.following||new h.Collection,a.following[b]=a.following[b]||new h.Collection;var d=a.following[b].length;a.following[b].remove({id:c}),d||a.following[b].trigger("remove",{id:c})},_=function(a,b,c){return a.following=a.following||{},a.following[b]=a.following[b]||new h.Collection,!!a.following[b].get(c)},aa=function(a,b){return Z(a,"user",b)},ba=function(a,b){return $(a,"user",b)},ca=function(a,b){return j(a,"id")===b?!0:_(a,"user",b)},da=function(a,b){return $(a,"uploaded_file",b)},ea=function(a,b){return $(a,"page",b)},fa=function(a,b){return $(a,"open_graph_object",b)},ga=function(a,b){return Z(a,"uploaded_file",b)},ha=function(a,b){return Z(a,"page",b)},ia=function(a,b){return Z(a,"open_graph_object",b)},ja=function(a,b){return a.following=a.following||{},a.following[b]=a.following[b]||new h.Collection,a.following[b]},ka=function(a,b){if(b!==Q(a)){var c=j(a,"web_preferences");c.prescribed_my_feed=b,a.update({web_preferences:c}),R(a)&&i.updateUser({id:ma(a),prescribed_my_feed:b})}},la=function(a,b){if(R(a)!==b.isSticky){var c=j(a,"web_preferences");c.sticky_my_feed=b.isSticky,a.update({web_preferences:c}),i.updateUser({id:ma(a),sticky_my_feed:b.isSticky,prescribed_my_feed:b.feedType}).then(b.success)}},ma=function(a){return j(a,"id")},na=function(a){return i.getUsersGroups({id:a.id})};return yam.helper=yam.helper||{},yam.helper.user={getId:ma,isUser:q,getFirstName:o,getFullName:n,getUserName:n,getNetworkName:p,isForeign:r,isActive:v,isInactive:w,isNew:x,buildPresence:s,getPresenceCssClass:t,getPresenceLabel:u,getPresenceStatus:A,hasFakeEmail:y,usesMobile:z,allowsFiles:C,allowsNotes:D,showBigPhoto:F,askForPhoto:G,getPrimaryEmailAddress:J,getWorkPhoneNumber:L,getMobilePhoneNumber:M,isAdmin:N,isVerifiedAdmin:O,isSupervisorAdmin:P,getPrescribedFeedType:Q,isStickyMyFeed:R,isAdminOf:T,isMemberOf:S,canAnnounce:W,canDeleteMessage:U,canRevokeMessage:V,getGroupMemberships:X,isInvitedToGroup:Y,followUser:aa,unFollowUser:ba,isFollowingUser:ca,unfollowFile:da,unfollowPage:ea,followFile:ga,followPage:ha,follow:Z,unfollow:$,isFollowing:_,getFollowing:ja,setPrescribedFeed:ka,setStickyMyFeed:la,isCurrentUser:H,fetch:k,followOgo:ia,unfollowOgo:fa,getGroups:na}}),define("models/lib/client/presence_client",["require","underscore","core/lib/client/base_client","core/lib/ctor","core/lib/log","core/lib/client/payload","core/lib/session","models/user","backbone","core/lib/yammer_api","models/helpers/user","models/lib/events"],function(a){var b=a("underscore"),c=a("core/lib/client/base_client"),d=a("core/lib/ctor"),e=a("core/lib/log"),f=a("core/lib/client/payload"),g=a("core/lib/session"),h=a("models/user"),i=a("backbone"),j=a("core/lib/yammer_api"),k=a("models/helpers/user"),l=a("models/lib/events");return d(null,c,{BATCH_SIZE:175,INTERVAL:6e4,init:function(a){c.prototype.init.call(this,a),b.extend(this,i.Events),this._auth="oauth2",this._isIdle=!1,this._intervalId=null,this._intervalCounter=0,this._newUsers=[],this._debouncedGetPresenceForNewUsers=b.debounce(this.getPresenceForNewUsers.bind(this),5e3),b.bindAll(this,"onRestData","onUpdatePresence")},start:function(){this.isStarted()||this.isStarting()||(this.setStarting(),this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null),this._intervalId=setInterval(this.onInterval.bind(this),this.INTERVAL),this._intervalCounter=0,i.on("/app/idle/started",this.onIdleStarted,this),i.on("/app/idle/ended",this.onIdleEnded,this),this.listenTo(l,"User/create",this.onUserCreate.bind(this)),this.getUserList().length>1?this.onInterval():this.savePresence())},stop:function(){this.isStopping()||this.isStopped()||(this.setStopping(),this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null,this._intervalCounter=0),i.off("/app/idle/started",this.onIdleStarted,this),i.off("/app/idle/ended",this.onIdleEnded,this),this.stopListening(),this.setStopped())},onIdleStarted:function(){this._isIdle=!0,e.log("IDLE"),this.savePresence()},onIdleEnded:function(){this._isIdle=!1,e.log("ACTIVE"),this.savePresence()},isIdle:function(){return this._isIdle},savePresence:function(){j.setUserPresence({network_id:g.getCurrentNetwork().id,user_id:g.getCurrentUser().id,presence:this.getPresence()}).then(this.onUpdatePresence)},getPresence:function(){return this.isIdle()?"idle":"online"},getUserList:function(){var a,c=g.getCurrentNetwork()&&g.getCurrentNetwork().id,d=function(a){return null==a.network_id||a.network_id==c};return a=h.all().filter(d),b.pluck(a,"id")},onUserCreate:function(a){if(a&&!a.presence){var c=g.getCurrentNetwork()&&g.getCurrentNetwork().id,d=!b.has(a,"network_id"),e=a.network_id==c;(d||e)&&(this._newUsers.push(a.id),this._debouncedGetPresenceForNewUsers())}},getPresenceForNewUsers:function(){this._newUsers.length>0&&(this.getPresenceForUsers(this._newUsers),this._newUsers=[])},onInterval:function(){this._intervalCounter++,this.getPresenceForUsers(this.getUserList()),1!==this._intervalCounter&&this._intervalCounter%2!==0||this.savePresence(),this._newUsers=[]},getPresenceForUsers:function(a){a.length>0&&j.getUsersPresence({network_id:g.getCurrentNetwork().id,user_ids:a}).then(this.onRestData)},onRestData:function(a){this.isStarted()||this.setStarted(),this.onData(this._createPayload(a))},_createPayload:function(a){return new f(a)},onData:function(a){var c=a.getRaw().presence;b.each(c,function(a){var b=h.findById(a.user_id);if(b){var c=k.getPresenceStatus(b,g);if(c===a.state.toLowerCase())return;var d={presence:a.state.toLowerCase()};b.update(d)}})},onUpdatePresence:function(){}})}),define("models/delivery",["require","core/lib/model_helper","core/lib/string_helper","models/lib/events","backbone"],function(a){var b=a("core/lib/model_helper"),c=a("core/lib/string_helper"),d=a("models/lib/events"),e=a("backbone");return b.define("yam.model.Delivery",[e.Events],function(){this.prototype._autoKey=1,this.prototype._create=this.prototype.create,this.prototype.create=function(){this._create();var a,b=this.getObject(),c=this.getReceiver();return b&&(a=b.declaredClass.split(".")[2],this.listenTo(d,a+"/destroy",function(a){a!==b&&a!=this.type_id||this.onObjectDestroy()}.bind(this))),c&&(a=c.declaredClass.split(".")[2],this.listenTo(d,a+"/destroy",function(a){a!==c&&a!=this.type_id||this.onReceiverDestroy()}.bind(this))),this},this.prototype._destroy=this.prototype.destroy,this.prototype.destroy=function(a){return a&&a.pruned&&this.setAsPruned(),this.stopListening(),this._destroy()},this.prototype.onObjectDestroy=function(){this.destroy()},this.prototype.onReceiverDestroy=function(){this.destroy()},this.prototype.getReceiver=function(){return yam.model[c.camelize(this.receiver_type,!0)].findById(this.receiver_id)},this.prototype.getObject=function(){return yam.model[c.camelize(this.type,!0)].findById(this.type_id)},this.prototype.getMessage=function(){return"message"===this.type?this.getObject():void 0},this.prototype.getRollup=function(){return"rollup"===this.type?this.getObject():void 0},this.prototype.getThread=function(){return"thread"===this.type?this.getObject():void 0},this.prototype.setAsPruned=function(){this._pruned=!0},this.prototype.isPruned=function(){return!!this._pruned}}),yam.model.Delivery.setupGlobalListeners=function(){["update","destroy","save","create"].forEach(function(a){d.on("Delivery/"+a,function(b){if(b.receiver_id&&b.getObject()){var e=b.getReceiver(),f=c.camelize("on_"+b.type+"_"+a);e&&e[f]&&e[f](b.getObject()||b.type_id,b);var g=c.capitalize(b.type)+c.capitalize(b.receiver_type)+"Delivery";d.trigger(g+"/"+b.receiver_id+"/"+a,b.getObject()||b.type_id)}})})},yam.model.Delivery.setupGlobalListeners(),yam.model.Delivery}),define("models/lib/model/deliverable_static",["require","underscore","models/delivery","core/lib/model_helper","core/lib/namespace"],function(a){var b=a("underscore"),c=a("models/delivery"),d=a("core/lib/model_helper"),e=a("core/lib/namespace"),f=e.ns("yam.model._DeliverableStatic",{});return b(["create","update","save"]).each(function(a){f[a+"AndDeliver"]=function(b,e){var f=this[a](b),g={type:d.toTypeStr(f),type_id:f.id,receiver_id:e.id,receiver_type:d.toTypeStr(e)};return c[a](g),f}}),f}),define("models/activity",["require","underscore","models/lib/model/deliverable_static","core/lib/model_helper","models/lib/orm-models"],function(a){var b=a("underscore"),c=a("models/lib/model/deliverable_static"),d=a("core/lib/model_helper"),e=a("models/lib/orm-models");return d.define("yam.model.Activity",function(){b.extend(this,c),this.prototype.getSubject=function(){var a=e.Attachment();return a.findById(this.subject.id)},this._getName=function(){return"Activity"}})}),define("models/attachment",["require","core/lib/model_helper"],function(a){var b=a("core/lib/model_helper");return b.define("yam.model.Attachment",function(){})}),define("models/conversation",["require","core/lib/model_helper"],function(a){var b=a("core/lib/model_helper");return b.define("yam.model.Conversation",function(){})}),define("models/helpers/feed",["require","underscore","core/lib/session","core/lib/treatment","core/lib/uri_helper","core/lib/yammer_uri"],function(a){var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/treatment"),e=a("core/lib/uri_helper"),f=a("core/lib/yammer_uri");return{getAppId:function(a){return this._attachmentMap||(this._attachmentMap={},b.each(c.getCurrentUser().attachments,function(a){this._attachmentMap[a.app_id]=a.id},this)),this._attachmentMap[a]},getAllCompanyKey:function(){return"COMPANY_GROUP_ID"},_commonIds:{general:"general",generalUnviewed:"general",group:"group",groupUnviewed:"group",inboxUnread:"inbox",inboxAll:"inbox"},getCommonId:function(a){var b=this._commonIds[a.keyType];return b&&this._hasId[a.keyType]&&(b+=a.keyId),b||a.getUrl()},_primaryFeedKeys:["general","group"],getPrimaryFeed:function(a){var c=b.find(a,function(a){return b.contains(this._primaryFeedKeys,a.keyType)},this);return c||b.first(a)},_hasId:{algo:!1,bookmarks:!0,uploaded_file:!0,file:!0,following:!1,general:!1,generalUnviewed:!1,group:!0,groupUnviewed:!0,inboxChat:!1,inboxRead:!1,inboxUnread:!1,inboxAll:!1,myAll:!1,myFeed:!1,open_graph_object:!0,openGraphObject:!0,page:!0,search:!1,sharing:!0,thread:!0,topic:!0,topicAnnouncements:!0,topicLinks:!0,topicPolls:!0,user:!0,userAnnouncements:!0,userLinks:!0,userPolls:!0,userPraise:!0},validateKey:function(a,b){switch(this._hasId[a]){case!0:return!!b;case!1:return!b;default:return!1}},_logSources:{algo:"algo",bookmarks:"bookmarked_by",uploaded_file:"uploaded_file",file:"about_file",following:"following",general:"general",generalUnviewed:"general",group:"group",groupUnviewed:"group",inboxChat:"inbox",inboxRead:"inbox",inboxUnread:"inbox",inboxAll:"inbox",myAll:"my_all",myFeed:"my_feed",open_graph_object:"open_graph_objects",openGraphObject:"open_graph_objects",page:"about_page",search:void 0,sharing:void 0,thread:void 0,topic:"about_topic",topicAnnouncements:"about_topic_attachments",topicLinks:"about_topic_attachments",topicPolls:"about_topic_attachments",user:"from_user",userAnnouncements:"from_user_attachments",userLinks:"from_user_attachments",userPolls:"from_user_attachments",userPraise:"received_by_attachments"},getLogSource:function(a){return this._logSources[a]},getUrl:function(a,b){var c="&use_unviewed=true";switch(a){case"algo":return this._formatUrl("messages/true_discovery.json?keep_seen_threads=true&prevent_empty_feed=true");case"bookmarks":return this._formatUrl("messages/bookmarked_by/"+b+".json");case"uploaded_file":case"file":return this._formatUrl("messages/about_file/"+b+".json");case"following":return this._formatUrl("messages/following.json?limit=8");case"general":return this._formatUrl("messages/general.json?include_counts=true&limit=8"+c);case"generalUnviewed":return this._formatUrl("messages/general.json?include_counts=true&limit=8&filter=unviewed"+c);case"group":return this._formatUrl("messages/in_group/"+b+".json?include_counts=true&limit=8"+c);case"groupUnviewed":return this._formatUrl("messages/in_group/"+b+".json?include_counts=true&limit=8&filter=unviewed"+c);case"inboxChat":return this._formatUrl("messages/inbox.json?all_unseen=true&filter=PRIVATE%3Bchat&limit=1");case"inboxRead":return this._formatUrl("messages/inbox.json?all_unseen=true&filter=inbox_seen%3Bunarchived");case"inboxUnread":return this._formatUrl("messages/inbox.json?all_unseen=true&filter=unarchived%3Binbox_unseen");case"inboxAll":return this._formatUrl("messages/inbox.json?all_unseen=true&filter=unarchived");case"myAll":return this._formatUrl("messages/my_all.json?limit=8");case"myFeed":return this._formatUrl("messages/my_feed.json");case"open_graph_object":case"openGraphObject":return this._formatUrl("messages/open_graph_objects/"+b+".json");case"page":return this._formatUrl("messages/about_page/"+b+".json");case"search":return;case"sharing":return this._formatUrl("messages/sharing/"+b+".json");case"thread":return this._formatUrl("messages/in_thread/"+b+".json");case"topic":return this._formatUrl("messages/about_topic/"+b+".json");case"topicAnnouncements":return this._formatUrl("messages/about_topic/"+b+"/attachments/"+this.getAppId("announcements")+".json?filter=announcement");case"topicLinks":return this._formatUrl("messages/about_topic/"+b+"/attachments/"+this.getAppId("links")+".json?filter=link");case"topicPolls":return this._formatUrl("messages/about_topic/"+b+"/attachments/"+this.getAppId("polls")+".json?filter=poll");case"user":return this._formatUrl("messages/from_user/"+b+".json?limit=8");case"userAnnouncements":return this._formatUrl("messages/from_user/"+b+"/attachments/"+this.getAppId("announcements")+".json?filter=announcement");case"userLinks":return this._formatUrl("messages/from_user/"+b+"/attachments/"+this.getAppId("links")+".json?filter=link");case"userPolls":return this._formatUrl("messages/from_user/"+b+"/attachments/"+this.getAppId("polls")+".json?filter=poll");case"userPraise":return this._formatUrl("messages/received_by/"+b+"/attachments/"+this.getAppId("praise")+".json?filter=praise");default:throw"Unknown feed type"}},_formatUrl:function(a){var b=e.parse(f.api(a));return b.queryKey.threaded="extended",b.queryKey.exclude_own_messages_from_unseen=!0,e.stringify(b)},_disconnectedFeeds:["algo","sharing","inboxRead"],shouldConnectFeed:function(a){var c=a&&a.keyType,e=this._disconnectedFeeds;return"myAll"===c&&d.treatment("disable_my_all_realtime_v4")&&(e=e.concat("myAll")),!b.any(e,function(b){return a.hasKeyType(b)})},_reloadingFeeds:["algo"],shouldReloadFeed:function(a){
var c=a&&a.keyType,e=this._reloadingFeeds;return"myAll"===c&&d.treatment("disable_my_all_realtime_v4")&&(e=e.concat("myAll")),b.any(e,function(b){return a.hasKeyType(b)})}}}),define("models/lib/helper/feed_factory",["require","models/helpers/feed","models/lib/orm-models"],function(a){"use strict";var b=a("models/helpers/feed"),c=a("models/lib/orm-models");return{create:function(a,d){if(!b.validateKey(a,d))throw"Invalid feed key";return c.Feed().create({keyType:a,keyId:d&&window.parseInt(d,10)})},find:function(a,b){return c.Feed().findFirst({keyType:a,keyId:b&&window.parseInt(b,10)})},findOrCreate:function(a,b){return this.find(a,b)||this.create(a,b)}}}),define("models/count",["require","models/lib/helper/feed_factory","core/lib/log","core/lib/model_helper","models/lib/orm-models","core/lib/session","models/helpers/network","backbone","models/lib/events","underscore"],function(a){var b=a("models/lib/helper/feed_factory"),c=a("core/lib/log"),d=a("core/lib/model_helper"),e=a("models/lib/orm-models"),f=a("core/lib/session"),g=a("models/helpers/network"),h=a("backbone"),i=a("models/lib/events"),j=a("underscore");return d.define("yam.model.Count",function(){var a=this;this.prototype.getNetwork=function(){var a=e.Network();return a.findById(this.network_id)},this.prototype.getFeed=function(){var a=e.Feed();return a.findById(this.feed_id)},this.prototype.getThread=function(){var a=e.Thread();return a.findById(this.thread_id)},this.getKey=function(a){return"string"==typeof a?a:a?a.declaredClass+"-"+a.id:""},this.findOrCreateCounter=function(a){var b=this.getKey(a);return 0===yam.model.Count.find({id:b}).length&&yam.model.Count.create({id:b,counter:new d({type:a})}),yam.model.Count.findById(b)};var d=function(a){this.type=a.type,this._count=0,a.callback&&(a.callback.call(this,this.getCount()),this.on("update",a.callback)),this.listener=j.extend({},h.Events)};d.prototype.on=function(b,c){return a._getCounterStrategy(this.type).hookSetup(this,this.type,b,c)},d.prototype.removeEventListener=function(a){if(!(a instanceof Array))return this.listener.stopListening(null,null,a);for(var b=0;b<a.length;b++)this.listener.stopListening(null,null,a[b])},d.prototype.getCount=function(){return a._getCounterStrategy(this.type).getCount(this.type)},this.getCounter=function(a,b){return this._getCounterStrategy(a).getCounter(a,b)},this.getInboxCounter=function(a){return this._counterStrategies.inbox.getCounter(null,a)},this.getNotificationCounter=function(a){return this._counterStrategies.notifications.getCounter(null,a)},this.getCurrentNetworkCounter=function(a){return this._counterStrategies.currentNetwork.getCounter(null,a)},this._getCounterStrategy=function(a){var b=a,d=e.Network(),f=e.Feed();return"object"==typeof a&&(a instanceof f?b="feed":a instanceof d&&(b="network")),this._counterStrategies[b]||c.warn('"'+a+'" is an invalid Counts type'),this._counterStrategies[b]},this._counterStrategies={default:{getCounter:function(b,c){var d=a.findOrCreateCounter(b).counter;return c&&(c.call(d,d.getCount(),b),d.on("update",c)),d},getCount:function(a){return a.getUnseenCount()},hookSetup:function(){}},feed:{getCounter:function(b,c){return a._counterStrategies.default.getCounter(b,c)},getCount:function(b){return a._counterStrategies.default.getCount(b)},hookSetup:function(a,b,c,d){if("update"==c){var e=function(){var c=this.getCount(b);d.call(a,c,b)}.bind(this);return a.listener.listenTo(i,"Feed/"+b.id+"/save",e),e}}},network:{getCounter:function(b,c){var d=b==f.getCurrentNetwork()?"currentNetwork":"default";return a._counterStrategies[d].getCounter(b,c)},getCount:function(b){return a._counterStrategies.default.getCount(b)},hookSetup:function(a,b,c,d){if("update"==c){var e=function(b){var c=this.getCount(b);d.call(a,c,b)}.bind(this);return a.listener.listenTo(i,"Network/"+b.id+"/save",e),e}}},inbox:{getCounter:function(c,d){var e=b.findOrCreate("inboxUnread"),f=a.findOrCreateCounter(e).counter;return d&&(d.call(f,f.getCount(),e),f.on("update",d)),f},getCount:function(b){return a._counterStrategies.default.getCount(b)},hookSetup:function(b,c,d,e){return a._counterStrategies.feed.hookSetup(b,c,d,e)}},currentNetwork:{getCounter:function(b,c){var d=a.findOrCreateCounter("currentNetwork").counter;return c&&(c.call(d,d.getCount(),f.getCurrentNetwork()),d.on("update",c)),d},getCount:function(){return a.getInboxCounter().getCount()+a.getNotificationCounter().getCount()},hookSetup:function(b,c,d,e){var g=function(){var d=a._counterStrategies.currentNetwork.getCount();e.call(b,d,c)}.bind(this);return c=f.getCurrentNetwork(),"update"==d&&(yam.model.Count.getInboxCounter().on("update",g),b.listener.listenTo(i,"Network/"+c.id+"/save",g)),g}},notifications:{getCounter:function(b,c){var d=a.findOrCreateCounter("notifications").counter;return c&&(c.call(d,d.getCount(),f.getCurrentNetwork()),d.on("update",c)),d},getCount:function(){return g.getUnseenNotificationCount(f.getCurrentNetwork())},hookSetup:function(a,b,c,d){if("update"==c){var e=function(b){if(g.isCurrent(b,f)){var c=this.getCount();d.call(a,c,b)}}.bind(this);return a.listener.listenTo(i,"Network/update",e),e}}}}}),yam.model.Count}),define("models/lib/helper/assured_delivery_experiments",["require","underscore"],function(a){"use strict";var b=a("underscore");return{_treatmentValueForFeed:function(a,b){return b?this.isOcularSupportedFeed(b)?a:!1:a},isOcularSupportedFeed:function(a){var c=["group","groupUnviewed","general","generalUnviewed"];return b.some(c,a.hasKeyType,a)},newerRealtimeTreatment:function(a){return this._treatmentValueForFeed("throttled",a)}}}),define("models/lib/model/helper/feed_unseen_count_processor",["require","underscore","core/lib/backbone_base_class","models/lib/helper/assured_delivery_experiments"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_class"),d=a("models/lib/helper/assured_delivery_experiments");return c.extend({initialize:function(a){this.feed=a.feed},getUnseenThreadCount:function(){if(this._isUsingViewedStatesForCounts()){var a=this.feed.getLocalLastSeenMessageId();return d.isOcularSupportedFeed(this.feed)&&(a=0),this.feed.feedCounter.countUnviewed(a)}return this.feed.unseen_thread_count||0},updateCountFromNetwork:function(a){this.shouldAcceptNetworkCountUpdate()&&this.setUnseenThreadCount(a)},setUnseenThreadCount:function(a){b.isNumber(a)&&a!==this.feed.unseen_thread_count&&this.feed.update({unseen_thread_count:a})},shouldAcceptNetworkCountUpdate:function(){var a=!this.feed.isRealtimeConnected();return null==this.feed.unseen_thread_count||a},_isUsingViewedStatesForCounts:function(){return d.isOcularSupportedFeed(this.feed)&&this.feed.feedCounter&&this.feed.feedCounter.isUsingViewedStatesForCounts()}})}),define("models/viewed_state",["require","backbone"],function(a){"use strict";var b=a("backbone");return b.Model.extend({defaults:{type:"viewedState"}})}),define("collections/viewed_states",["require","backbone","models/viewed_state"],function(a){"use strict";var b=a("backbone"),c=a("models/viewed_state");return b.Collection.extend({model:c})}),define("collections/global_viewed_states",["require","collections/viewed_states"],function(a){"use strict";var b=a("collections/viewed_states");return new b}),define("models/lib/helper/viewed_state_helper",["require","underscore","collections/global_viewed_states"],function(a){"use strict";var b=a("underscore"),c=a("collections/global_viewed_states");return{isViewed:function(a){var c=a.get("lastViewedMessageId"),d=a.get("lastReplyMessageId"),e=b.isNumber(c)&&b.isNumber(d),f=c>=d;return!e||f},isNewerThan:function(a,b){var c=a.get("lastReplyMessageId")||a.id;return c>(b||0)},updateViewedState:function(a){if(!a||!a.id)return null;var b=this.addOrReconcileViewedStates([a]);return b&&b[0]},addOrReconcileViewedStates:function(a,b,d,e){a=this._adjustToUseExistingHigherIds(a);var f=c.add(a,{merge:!0});return b&&(d&&(f=this._adjustToMarkAllMissingAsViewed(f,b,e)),f=b.add(f,{merge:!0})),f},_adjustToUseExistingHigherIds:function(a){return b.map(a.models||a,this._adjustUpdateIfInvalid)},_adjustUpdateIfInvalid:function(a){a=a||{};var d=a.attributes||a,e=d.lastViewedMessageId,f=c.find({id:d.id}),g=f&&f.get("lastViewedMessageId"),h=b.isNumber(g),i=!b.isNumber(e)||g>e;if(f&&h&&i){var j=f.get("dataOrigin")||"",k="";b.isNumber(e)&&(k="payload_viewed_id_too_low"),a=b.extend(b.clone(d),{lastViewedMessageId:g,reconcileInfo:k,keepHigher:"keep_higher_"+j})}return a},_adjustToMarkAllMissingAsViewed:function(a,c,d){var e=[];return c.each(b.bind(function(c){if(!this.isViewed(c)&&!b.findWhere(a,{id:c.id})){var f=b.extend(b.clone(c.attributes),d,{lastViewedMessageId:void 0,reconcileInfo:"force_viewed_other_client"});e.push(f)}},this)),b.union(a,e)},markAllAsViewed:function(a,c){var d,e=[];a.each(b.bind(function(a){if(d=a.get("lastReplyMessageId")<=c,d&&!this.isViewed(a)){var b={id:a.id,lastViewedMessageId:a.get("lastReplyMessageId"),dataOrigin:"mark_all_as_viewed"};e.push(b)}},this)),a.add(e,{merge:!0})}}}),define("models/feed_counter",["require","underscore","backbone","collections/viewed_states","models/lib/helper/viewed_state_helper"],function(a){"use strict";var b=a("underscore"),c=a("backbone"),d=a("collections/viewed_states"),e=a("models/lib/helper/viewed_state_helper");return c.Model.extend({initialize:function(){this._useViewedStatesForCounts=!1,this._viewedStates=new d,this.listenTo(this._viewedStates,"add change",this._onUpdate),this.on("markAllAsViewedSuccess",this.markAllAsViewed)},_onUpdate:function(){this._useViewedStatesForCounts&&this.trigger("update")},addViewedStates:function(a,b,c){e.addOrReconcileViewedStates(a,this._viewedStates,b,c)},countUnviewed:function(a){return this._useViewedStatesForCounts?(a=a||0,this._viewedStates.filter(function(b){return e.isNewerThan(b,a)}).filter(this._isUnviewed).length):0},_isUnviewed:function(a){return!e.isViewed(a)},isUsingViewedStatesForCounts:function(){return this._useViewedStatesForCounts},useViewedStatesForCounts:function(){this._useViewedStatesForCounts=!0},markAllAsViewed:function(a){e.markAllAsViewed(this._viewedStates,a)},sync:b.noop})}),define("collections/feed_counters",["require","backbone","models/feed_counter"],function(a){var b=a("backbone"),c=a("models/feed_counter"),d=b.Collection.extend({model:c});return new d}),define("models/receiver",["require","underscore","models/delivery","core/lib/model_helper","core/lib/namespace"],function(a){var b=a("underscore"),c=a("models/delivery"),d=a("core/lib/model_helper"),e=a("core/lib/namespace");return e.ns("yam.model._Receiver",{getDeliverys:function(){return c.find({receiver_type:d.toTypeStr(this),receiver_id:this.id})},getDeliverysByType:function(a){return c.find({receiver_type:d.toTypeStr(this),receiver_id:this.id,type:a})},getDeliveryFor:function(a){return c.findFirst({receiver_type:d.toTypeStr(this),receiver_id:this.id,type:d.toTypeStr(a),type_id:a.id})},getDeliveryObjectsByType:function(a){return b(this.getDeliverysByType(a)).map(function(a){return a.getObject()})},destroyObjectsByType:function(a){return b(this.getDeliverysByType(a)).inject(function(a,b){return b.getObject().destroy(),b.destroy(),++a},0)}}),yam.model._Receiver}),define("core/lib/client/message_payload",["require","underscore","core/lib/client/payload","core/lib/ctor"],function(a){var b=a("underscore"),c=a("core/lib/client/payload"),d=a("core/lib/ctor"),e=Math.pow(2,53)-1,f=-(Math.pow(2,53)-1),g=d(null,c,{init:function(a){c.prototype.init.call(this,a),this._resetStats()},merge:function(a){this._resetStats();var b=new g(a);this.addReferences(b.getReferences()),this.addMessages(b.getMessages()),this.extendMeta(b.getMeta()),this.extendThreadedExtended(b.getThreadedExtended())},getReferences:function(){return this._raw.references||(this._raw.references=[]),this._raw.references},getMessages:function(){return this._raw.messages||(this._raw.messages=[]),this._raw.messages},getMeta:function(){return this._raw.meta||(this._raw.meta={}),this._raw.meta},getThreadedExtended:function(){return this._raw.threaded_extended||(this._raw.threaded_extended={}),this._raw.threaded_extended},getFullMessages:function(){return this.getMessages().concat(b.inject(this.getThreadedExtended(),function(a,b){return a.concat(b)},[]))},extendMeta:function(a){var c=this.getMeta().followed_user_ids||[],d=this.getMeta().bookmarked_message_ids||[],e=this.getMeta().ymodules||[];b.extend(this.getMeta(),a),this.addFollowedUserIds(c),this.addBookmarkedMessageIds(d),this.addAttachments(e)},extendThreadedExtended:function(a){for(var b in a)this.addThreadedExtended(b,a[b])},addFollowedUserIds:function(a){var b=this.getMeta(),c=b.followed_user_ids||[];c=c.concat(a),b.followed_user_ids=this._unique(c)},addBookmarkedMessageIds:function(a){var b=this.getMeta(),c=b.bookmarked_message_ids||[];c=c.concat(a),b.bookmarked_message_ids=this._unique(c)},addAttachments:function(a){var b=this.getMeta(),c=b.ymodules||[];c=c.concat(a),b.ymodules=this._unique(c,"id")},addThreadedExtended:function(a,b){var c=this.getThreadedExtended();c[a]||(c[a]=[]),c[a]=c[a].concat(b)},addMessages:function(a){if(a){var b=this.getMessages().concat(a);this._raw.messages=this._unique(b,"id")}},addReferences:function(a){var b=this.getReferences();if(0===b.length)return void(this._raw.references=a);for(var c=0,d=a.length;d>c;++c){for(var e=-1,f=a[c],g=0,h=b.length;h>g;++g){var i=b[g];if(f.id==i.id&&f.type==i.type){e=g;break}}e>-1?b[e]=f:b.push(f)}},getOldestMessageId:function(a){return this._getStat(a,"oldest")},getNewestMessageId:function(a){return this._getStat(a,"newest")},getThreadUpdatesTotal:function(){return this._getStat("threaded","updates")},_resetStats:function(){this._stats={},this._stats.basic={newest:void 0,oldest:void 0},this._stats.threaded={newest:void 0,oldest:void 0,updates:void 0}},_getStat:function(a,b){var c=this._stats[a][b];return void 0!==c?c:("basic"===a?this._extractMessageInfo():"threaded"===a&&this._extractThreadedInfo(),this._stats[a][b])},_extractMessageInfo:function(){for(var a=this.getMessages(),b=f,c=e,d=0,g=a.length;g>d;++d){var h=a[d].id;c>h&&(c=h),h>b&&(b=h)}this._stats.basic.oldest=c!=e?c:null,this._stats.basic.newest=b!=f?b:null},_extractThreadedInfo:function(){for(var a=this.getReferences(),b=f,c=e,d=0,g=this._stats.threaded,h=0,i=a.length;i>h;++h){var j=a[h];if("thread"===j.type){var k=j.stats.latest_reply_id;c>k&&(c=k),k>b&&(b=k),d+=j.stats.updates}}g.oldest=c!=e?c:null,g.newest=b!=f?b:null,g.updates=d},_unique:function(a,b){for(var c=[],d={},e=0,f=a.length;f>e;++e){var g=a[e],h=b?g[b]:g;d[h]||(c.push(g),d[h]=!0)}return c}});return g.createEmptyPayload=function(){return{messages:[],meta:{},references:[],threaded_extended:{}}},g}),define("core/lib/client/payload_helper",["require","core/lib/client/message_payload"],function(a){var b=a("core/lib/client/message_payload"),c={};return c.messagePayloadProcessor=function(a){return function(c){return a(new b(c))}},c.searchPayloadProcessor=function(a){return function(c){return c.messages&&c.messages.messages&&(c.meta=c.messages.meta,c.references=c.messages.references,c.snippets=c.messages.snippets,c.messages=c.messages.messages),a(new b(c))}},c}),define("core/lib/tokens",["require","core/lib/report","core/lib/session","core/lib/yammer_request"],function(a){"use strict";var b=a("core/lib/report"),c=a("core/lib/session"),d=a("core/lib/yammer_request"),e=function(){var a=d.getAuthenticator();return a&&a._authToken&&a._authToken.token},f=function(){var a=c.getCurrentUser();return a&&a.web_oauth_access_token},g=function(a){var b=a.split("-");return b.length>1?b[0]:""};return{logMismatch:function(){var a=e(),c=f();a&&c&&a!==c&&b.event("token_mismatch",{authNetworkId:g(a),sessionNetworkId:g(c)})}}}),define("models/lib/helper/feed_fetcher",["require","underscore","core/lib/client/payload_helper","core/lib/uri_helper","core/lib/yammer_api","core/lib/yammer_uri","models/lib/helper/assured_delivery_experiments","core/lib/tokens"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/client/payload_helper"),d=a("core/lib/uri_helper"),e=a("core/lib/yammer_api"),f=a("core/lib/yammer_uri"),g=a("models/lib/helper/assured_delivery_experiments"),h=a("core/lib/tokens"),i=11,j=6;return{fetch:function(a){return this._getMessages(a,a.getUrl())},fetchOlder:function(a,b){var c=a.getOldestThreadedId(),e=d.replaceParam(a.getUrl(),"older_than",c);return b&&(e=d.replaceParam(e,"limit",b)),this._getMessages(a,e)},fetchNewer:function(a){var b=a.getNewestMessageId(),c=d.replaceParam(a.getUrl(),"newer_than",b);return g.newerRealtimeTreatment(a)&&(c=d.replaceParam(c,"limit",i),c=d.replaceParam(c,"replies_per_thread",j)),this._getMessages(a,c)},fetchThread:function(a,c,e){var g=d.parse(f.api("messages/in_thread/"+c+".json"));return b.extend(g.queryKey,e),this._getMessages(a,d.stringify(g))},_getMessages:function(a,b){return h.logMismatch(),e.getMessages({url:b,processor:c.messagePayloadProcessor,success:function(a){return a}})},postMessage:function(a,b){return e.getMessages({url:f.api("messages"),data:b,auth:"oauth2",processor:c.messagePayloadProcessor,method:"POST",success:function(a){return a}})}}}),define("core/lib/backbone_base_view",["require","underscore","backbone"],function(a){"use strict";var b=a("underscore"),c=a("backbone");return c.View.extend({constructor:function(a){b.each(a,function(c,d){b.isUndefined(c)&&delete a[d]}),this.options=a=b.extend({},b.result(this,"defaults"),a),c.View.call(this,a)}},{extend:function(a){var d=c.View.extend.apply(this,arguments),e=a.mixins;return delete a.mixins,b.reduce(e,function(a,b){return b.call(a.prototype),a},d)}})}),define("core/lib/backbone_with_auto_render",["require","underscore","core/lib/treatment"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/treatment"),d=function(a){var b,c;null!=a.template&&(b=null!=a.getTemplateData?a.getTemplateData():null,c=a.template(b),a.$el.html(c))},e=function(a){var b,e;return c.treatment("subview_focus_restoration")&&$.contains(this.$el[0],document.activeElement)&&(e=document.activeElement.getAttribute("data-qaid")),d(this),b=a.call(this),e&&this.$el.find('[data-qaid="'+e+'"]').focus(),b},f=function(a,c,d){return c.render&&(c.render=b.wrap(c.render,e)),a.call(this,c,d)},g=function(){this.constructor.extend=b.wrap(this.constructor.extend,f),this.render=b.wrap(this.render,e)};return g}),define("core/lib/backbone_with_subviews",["require","underscore","core/lib/treatment"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/treatment"),d={},e=function(a){return a.replace(/<([A-Z][A-Za-z0-9]+)(.*)\/>/g,"<$1$2></$1>")},f=function(a,b){return a.getAttribute("data-"+b)},g=function(a){return d[a.cid]||(d[a.cid]={})},h=function(a,b){return g(a)[b]},i=function(a){delete d[a.cid]},j=function(a,c){var d=g(a),e=b.keys(d),f=b.difference(e,c);b.each(f,function(a){d[a].remove()})},k=function(a){var c=g(a),d=[];b.each(a.views,function(e,f){var g,h,i;for(e=b.isFunction(e)?e:a[e].bind(a),g=a.el.getElementsByTagName(f),i=0;h=g[0];i++)d.push(l(a,c,e,h,i))}),j(a,d)},l=function(a,c,d,e,g){var i=e.getAttribute("key")||g,j=e.tagName+i,k=h(a,j);return k||(k=c[j]=d(i,b.partial(f,e)),k.remove=b.wrap(k.remove,b.partial(s,a,j)),k.render()),e.parentNode.replaceChild(k.el,e),j},m=function(a){b.each(g(a),function(a){var b=a.el.parentNode;b&&b.removeChild(a.el)})},n=function(a,c,d){return c.initialize&&(c.initialize=b.wrap(c.initialize,o)),c.render&&(c.render=b.wrap(c.render,q)),c.remove&&(c.remove=b.wrap(c.remove,r)),a.call(this,c,d)},o=function(a,c){this.views=b.extend({},b.result(this,"views"),b.result(c,"views")),this.$el.html=b.wrap(this.$el.html,p.bind(this)),a.call(this,c)},p=function(a,c){return b.isString(c)&&(c=e(c)),a.call(this.$el,c)},q=function(a){var b,d;return c.treatment("subview_focus_restoration")&&$.contains(this.$el[0],document.activeElement)&&(d=document.activeElement),m(this),b=a.call(this),k(this),d&&document.activeElement!=d&&d.focus(),b},r=function(a){return b.invoke(g(this),"remove"),i(this),a.call(this)},s=function(a,b,c){var d=g(a);return delete d[b],c.call(this)},t=function(){this.constructor.extend=b.wrap(this.constructor.extend,n),this.initialize=b.wrap(this.initialize,o),this.render=b.wrap(this.render,q),this.remove=b.wrap(this.remove,r)};return t}),define("models/helpers/group",["require","underscore","core/lib/session","core/lib/yammer_api","models/group","collections/groups","core/lib/yammer_uri"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/yammer_api"),e=a("models/group"),f=a("collections/groups"),g=a("core/lib/yammer_uri"),h=function(a,b){return a[b]||a.get&&a.get(b)},i=function(a){var b=a&&h(a,"id");return"company"===b||"COMPANY_GROUP_ID"===b},j=function(a){return h(a,"full_name")},k=function(a){var b=f.get(a);if(null==b)return b=new e({id:a}),f.add(b),l(b);if(b.get("external"))return l(b);if(b.isUpdating)return b._updateRequest;l(b);var c=$.Deferred();return c.resolve(b).promise()},l=function(a){var b=a.get("id"),e=c.getCurrentNetwork(),f={id:b,num_featured_users:6,include_group_info:!0,include_group_subscriptions:!0,include_featured_users:!0,include_related_contents:!0,include_related_groups:!0,include_pending_requests_count:!0,include_invited_requests_count:!0,include_suggested_requests_count:!0};return"company"===b&&e.get("community")&&!e.get("is_primary")&&(f.include_related_networks=!0),a.isUpdating=!0,a._updateRequest=d.getGroup(f).then(function(b){return yam.modelController&&yam.modelController.onThreadInfo(b),a.set(b),a.isUpdating=!1,a}),a._updateRequest},m=function(a){return"group"===h(a,"type")},n=function(a){return h(a,"full_name")||h(a,"name")},o=function(a){return i(a)?g.app("/#/threads/company?type=general"):g.app("/#/threads/inGroup",{type:"in_group",feedId:h(a,"id")})},p=function(a){return"private"===h(a,"privacy")},q=function(a){return i(a)||!p(a)},r=function(a,b){var d=yam.helper.user;return d.isForeign(b,c)?!1:p(a)?d.isVerifiedAdmin(b):d.isAdmin(b)||d.isVerifiedAdmin(b)},s=function(a,b){var c=a.get("network_id");return null!=c&&c!=b.getCurrentNetwork().id},t="#264f8c",u=function(a){return a.get("color")||t},v=function(a){return a.get("can_add_members")},w=function(a){return!!h(a,"admin")},x=function(a){return!!h(a,"member")},y=function(a){return!!h(a,"pending")},z=function(a,b,c){var d=b.getCurrentUser(),e=A(a,c),f=!1;return d.network_id===e.id&&("false"!==d.verified_admin?f=!0:B(a)&&"false"!==d.admin&&(f=!0)),f},A=function(a,b){return b.findById(a.get("network_id"))},B=function(a){return"public"===a.get("privacy")},C=function(a){return a.get("external")===!0},D=function(a,b){var c=b.getCurrentUser(),d=a.get("network_id")==c.get("network_id"),e=C(a);return(d||e)&&(!p(a)||x(a)||w(a)||yam.helper.user.isSupervisorAdmin(c))},E=function(a){var b=c.getCurrentUser(),d=a.get("network_id")==b.get("network_id");return d&&G(a)&&(w(a)||!p(a)&&(yam.helper.user.isAdmin(b)||yam.helper.user.isVerifiedAdmin(b))||p(a)&&yam.helper.user.isVerifiedAdmin(b))},F=function(a,b,c){return x(a)?w(a)||z(a,b,c):z(a,b,c)},G=function(a){return!a.has("state")||"active"===a.get("state")},H=function(a,c){var d,e=A(a,c);if(e)d=e.getPlainBody();else if(a.get("network_name"))d=a.get("network_name");else{var f=a.get("participating_networks");f&&(e=b.findWhere(f,{id:a.get("network_id")}),e&&(d=e.name))}return d},I=function(a,b){var c=b.getCurrentUser(),d=a.get("network_id")==c.get("network_id"),e=C(a);return(d||e)&&a.get("can_add_members")},J=function(a,b){var c=b.getCurrentUser(),d=a.get("network_id")==c.get("network_id"),e=C(a);return(d||e)&&a.get("can_invite")},K=function(a){return p(a)||L(a)},L=function(a){return"restricted"===a.get("privacy")},M=function(a,c){var d=b.clone(a.get("stats"));d.members--,a.set("stats",d);var e=a.get("featured_users");e.remove(c)},N=function(a){return!!a.get("moderated")},O=function(a){var c=b.clone(a.get("stats"));c.members++,a.set("stats",c)},P=function(a){return!a.has("has_admin")||a.get("has_admin")},Q=function(a){return!h(a,"mugshot_url").match(/\/group_profile.png$/)},R=function(a){var b=h(a,"state");return"deleted"===b||"destroyed"===b},S=function(a,b){var c=h(a,"membership"),d=c&&(c.state||c.status);return c&&c.user_id===b&&"invited"===d};return yam.helper=yam.helper||{},yam.helper.group={isAllCompany:i,getPlainBody:j,fetch:k,update:l,isGroup:m,getFullName:n,getWebUrl:o,isPrivate:p,canShareNotes:q,isGroupAdminFromNetwork:r,getGroupColor:u,canUserApproveMembers:v,hasAdminFromNetwork:z,isPublic:B,isCurrentUserMember:x,isVisibleByCurrentUser:D,isEditableByCurrentUser:E,canCurrentUserDelete:F,isActive:G,getNetworkName:H,isExternal:C,isForeign:s,canCurrentUserAddMembers:I,canCurrentUserInviteMembers:J,isCurrentUserAdmin:w,getNetwork:A,isPrivateOrRestricted:K,isRestricted:L,isModerated:N,removeMember:M,addMember:O,hasAdmin:P,hasMugshot:Q,isDeleted:R,isUserInvited:S,isCurrentUserPending:y}}),define("models/helpers/guide",[],function(){"use strict";var a=function(a,b){return a[b]||a.get&&a.get(b)},b=function(b){return"guide"===a(b,"type")},c=function(b){return a(b,"full_name")},d=function(a){return c(a)},e=function(b){return a(b,"web_url")};return{isGuide:b,getFullName:d,getWebUrl:e}}),define("models/helpers/like",[],function(){"use strict";var a=function(a,b){return a[b]||a.get&&a.get(b)},b=function(b){return"like"===a(b,"type")},c=function(b){return a(b,"name")};return{isLike:b,getPlainBody:c}}),define("models/helpers/topic",["require","core/lib/session"],function(a){"use strict";var b=a("core/lib/session"),c=function(a,b){return a[b]||a.get&&a.get(b)},d=function(a){return"#"+c(a,"name")},e=function(a){var d=c(a,"network_id");return null!==d&&d!==b.getCurrentNetwork().id},f=function(a){return"tag"===c(a,"type")},g=function(a){var b=c(a,"type");return"tag"===b||"topic"===b};return{getPlainBody:d,isForeign:e,isTag:f,isTopic:g}}),define("models/helpers/file",["require","core/lib/tr","models/helpers/group","core/lib/filename_helper"],function(a){var b=a("core/lib/tr"),c=a("models/helpers/group"),d=a("core/lib/filename_helper"),e=["docx","pptx","xlsx"],f=["doc","docm","docx","dot","dotm","dotx","odt"],g=["odp","pot","potm","potx","pps","ppsm","ppsx","ppt","pptm","pptx"],h=["ods","xls","xlsb","xlsm","xlsx"],i=["pdf"],j=function(a,b,d){var e=yam.helper.user,f=v(a),g=e.isAdmin(b),h=e.isAdminOf(b,d),i=n(a,b),j=c.isAllCompany(d),k=c.isGroupAdminFromNetwork(d,b);return!f||i||j&&g||!j&&(h||k)},k=function(a,b,c){var f=d.getExtension(a.path);return j(a,b,c)&&-1!==e.indexOf(f)},l=function(a){var b=d.getExtension(a.path),c=[].concat(f,g,h,i);return-1!==c.indexOf(b)},m=function(a,b,d){var e=yam.helper.user,f=e.isAdmin(b),g=e.isAdminOf(b,d),h=c.isAllCompany(d),i=c.isGroupAdminFromNetwork(d,b);return h&&f||!h&&(g||i)},n=function(a,b){return r(a,"owner_id")===r(b,"id")},o=function(a,b,d,e){var f=yam.helper.user,g=f.isAdmin(b),h=f.isAdminOf(b,d),i=f.isForeign(b,e),j=c.isAllCompany(d),k=n(a,b);return k||!j&&h||!i&&g},p=function(a){return!c.isPrivate(a)()},q=function(a){return!!a.unpublished_contributor_ids.length},r=function(a,b){return a[b]||a.get&&a.get(b)},s=function(a){var b=r(a,"real_type")||r(a,"type");return"uploaded_file"===b||"file"===b},t=function(a){var b=r(a,"real_type")||r(a,"type");return"page"===b},u=function(a){return"private"===r(a,"privacy")},v=function(a){return!!r(a,"official")},w=function(a){return s(a)?b.t("official_badge_tooltip_file"):t(a)?b.t("official_badge_tooltip_note"):""},x=function(a){return r(a,"full_name")},y=function(a){var b=["Bytes","Kb","Mb","Gb","Tb","Pb"];if(0===a)return"0 Bytes";var c=parseInt(Math.floor(Math.log(a)/Math.log(1024)),10);return(0===c?a/Math.pow(1024,c):(a/Math.pow(1024,c)).toFixed(1))+" "+b[c]},z=function(a,b){return r(a,"network_id")!==b.getCurrentNetwork().id},A=function(a,b,c){var d=b.getCurrentUser();return!n(a,d)&&z(a,b)&&!c.findWhere({user_id:d.id,group_id:a.group_id})};return{canShare:p,canEdit:j,canMarkOfficial:m,canDelete:o,hasUnpublishedChanges:q,isFile:s,isPage:t,isPrivate:u,isOfficial:v,getOfficialTooltip:w,getPlainBody:x,bytesToSize:y,canViewInO365:l,canEditInO365:k,isForeign:z,isReadOnly:A}}),define("models/helpers/unknown",[],function(){"use strict";var a=function(a,b){return a[b]||a.get&&a.get(b)},b=function(b){return a(b,"full_name")||a(b,"name")};return{getPlainBody:b}}),define("models/helpers/models",["require","models/helpers/group","models/helpers/guide","models/helpers/like","models/helpers/topic","models/helpers/file","models/helpers/unknown"],function(a){var b=a("models/helpers/group"),c=a("models/helpers/guide"),d=a("models/helpers/like"),e=a("models/helpers/topic"),f=a("models/helpers/file"),g=a("models/helpers/unknown"),h=function(a,b){return a[b]||a.get&&a.get(b)},i=function(a){return a?yam.helper.user.isUser(a)?yam.helper.user:b.isGroup(a)?b:c.isGuide(a)?c:d.isLike(a)?d:e.isTopic(a)?e:f.isFile(a)||f.isPage(a)?f:g:void 0},j=function(a){return h(a,"id")};return{getHelperForModel:i,getId:j}}),define("models/helpers/ogo",[],function(){"use strict";var a=function(a,b){return a[b]||a.get&&a.get(b)},b=function(b){var c=a(b,"type");return"open_graph_object"===c||"ymodule"===c};return{isOpenGraphObject:b}}),define("core/lib/util/screen_helper",[],function(){var a={};return a.getPixelRatio=function(){return Math.ceil(window.devicePixelRatio||1)},a.getScaledDimension=function(b){return b*a.getPixelRatio()},a}),define("core/lib/urls",["require","core/lib/yammer_uri","models/helpers/file","models/helpers/user","models/helpers/group","models/helpers/topic","models/helpers/ogo","core/lib/util/screen_helper","core/lib/treatment"],function(a){var b=a("core/lib/yammer_uri"),c=a("models/helpers/file"),d=a("models/helpers/user"),e=a("models/helpers/group"),f=a("models/helpers/topic"),g=a("models/helpers/ogo"),h=a("core/lib/util/screen_helper"),i=a("core/lib/treatment"),j=function(a,b){return a[b]||a.get&&a.get(b)},k=function(){return b.app("/notifications")},l=function(){return b.app("/account/invitations")},m=function(){return b.app("/signup/email_confirm")},n=function(){return b.app("/home/signup_desktop_task")},o=function(a){return b.app("/getting_started/"+a)},p=function(a){return b.app("/#/home",a)},q=function(a){return b.app("/apps",a)},r=function(){return b.app("/usage_policy/")},s=function(){return b.app("/usage_policies/usage_policy_task")},t=function(){return"https://developer.yammer.com/"},u=function(a){return a=a||"en-US","https://products.office.com/"+a+"/yammer"},v=function(a){return a=a||"en-US","https://products.office.com/"+a+"/business/compare-office-365-for-business-plans"},w=function(a){return a=a||"en-US","https://products.office.com/"+a+"/yammer/terms-of-use"},x=function(a){return a=a||"en-US","https://www.microsoft.com/privacystatement/"+a+"/OnlineServices/default.aspx"},y=function(){return"https://careers.microsoft.com/yammer"},z=function(){return"https://blogs.office.com/yammer/"},A=function(a){return a=a||"en-US","https://community.office365.com/"+a+"/w/yammer/"},B=function(a){return b.app("/#/Threads/show?threadId="+a.id)},C=function(a){return b.app("messages/"+a.id)},D=function(){return b.app("communities")},E=function(){return b.app("communities/validate")},F=function(){return i.treatment("fast_switching_groups")?b.app("/#/groups"):b.app("groups")},G=function(){return i.treatment("fast_switching_groups")?b.app("/#/groups/mine"):b.app("groups?mine=true")},H=function(){return i.treatment("fast_switching_groups")?b.app("/#/groups/suggested"):b.app("groups?suggested=true")},I=function(){return b.app("/invitations/add_colleagues")},J=function(a){return i.treatment("fast_switching_user_profile")?b.app("/#/users/"+j(a,"id")):b.app("/users/"+j(a,"id"))},K=function(a){return b.app("/topics/"+a.id)},L=function(a){return i.treatment("fast_switching_ogos")?b.app("/#/graph/"+a.id):b.app("graph/"+a.id)},M=function(a){return b.app("/graph/"+a.id+"/users")},N=function(a){return e.isAllCompany(a)?b.app("/#/threads/company?type=general"):b.app("/#/threads/inGroup",{type:"in_group",feedId:a.id})},O=function(a){return e.isAllCompany(a)?b.app("/#/threads/company",{type:"general",view:"unviewed"}):b.app("/#/threads/inGroup",{type:"in_group",
feedId:a.id,view:"unviewed"})},P=function(a){return b.app("/groups/"+j(a,"name"))},Q=function(a){return e.isAllCompany(a)?b.app("/#/groups/company/info"):b.app("/#/groups/"+a.id+"/info")},R=function(a){return e.isAllCompany(a)?b.app("/groups/company/members"):N(a)},S=function(a){return e.isAllCompany(a)?b.app("/#/groups/company/files"):b.app("/#/groups/"+a.id+"/files")},T=function(a){return e.isAllCompany(a)?b.app("/#/groups/company/notes"):b.app("/#/groups/"+a.id+"/notes")},U=function(a){return e.isAllCompany(a)?b.app("/groups/company/settings"):b.app("/#/groups/"+a.id+"/settings")},V=function(a){return b.app("/#/groups/"+a.id+"/delete")},W=function(a,b,c){b&&c&&(b=h.getScaledDimension(b));var d=j(a,"mugshot_url_template");return b&&d?d.replace("{width}",b).replace("{height}",b):j(a,"mugshot_url")},X=function(a){var b=j(a,"mugshot_url_template");return b?b.replace(/\{width\}x\{height\}\/(.+)/,"$1"):""},Y=function(a){return b.app("#/notes/"+(j(a,"real_id")||a.id))},Z=function(a){return b.app("/notes/"+a.id+"/users")},$=function(a,c){return b.app("#/notes/"+a.id+"/compare/"+c.id)},_=function(a){return b.app("#/notes/"+a.id+"/edit")},aa=function(a){return b.app("#/files/"+a.id)},ba=function(a){return b.app("/uploaded_files/"+a.id+"/edit")},ca=function(a){return b.app("/uploaded_files/"+a.id+"/users")},da=function(a,c){return b.app("#/files/"+a.id+"?version="+c.id)},ea=function(a){return b.api("uploaded_files/"+a.id+"/download")},fa=function(a){return b.api("uploaded_files/"+a.id+"/preview/"+a.name)},ga=function(a){return b.base()+"/"+a.permalink},ha=function(a){return e.isGroup(a)?N(a):d.isUser(a)?J(a):c.isPage(a)?Y(a):c.isFile(a)?aa(a):f.isTag(a)?a.web_url:f.isTopic(a)?K(a):g.isOpenGraphObject(a)?L(a):b.base()};return{pendingRequests:k,pendingInvitations:l,emailConfirmation:m,desktopNotifierTask:n,gettingStartedTask:o,apps:q,home:p,usagePolicy:r,usagePolicyTask:s,developers:t,about:u,pricing:v,usageTerms:w,privacyPolicy:x,careers:y,blog:z,help:A,thread:B,networks:D,validateCommunityName:E,groups:F,addColleaguesLightbox:I,indexForModel:ha,groupsMine:G,groupsSuggested:H,groupIndex:N,groupUnviewed:O,groupInfo:Q,groupName:P,groupMembers:R,groupFiles:S,groupNotes:T,groupSettings:U,groupDelete:V,groupMugshot:W,groupMugshotFullsize:X,noteIndex:Y,noteFollowers:Z,noteCompare:$,noteEdit:_,fileIndex:aa,fileFollowers:ca,fileCompare:da,fileEdit:ba,fileDownload:ea,filePreview:fa,userIndex:J,topicIndex:K,ogoIndex:L,ogoFollowers:M,networkIndex:ga,message:C}}),/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
function(a,b){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?b(exports):"function"==typeof define&&define.amd?define("mustache",["exports"],b):(a.Mustache={},b(Mustache))}(this,function(a){function b(a){return"function"==typeof a}function c(a){return p(a)?"array":typeof a}function d(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function e(a,b){return null!=a&&"object"==typeof a&&b in a}function f(a,b){return q.call(a,b)}function g(a){return!f(r,a)}function h(a){return String(a).replace(/[&<>"'\/]/g,function(a){return s[a]})}function i(b,c){function e(){if(r&&!s)for(;q.length;)delete o[q.pop()];else q=[];r=!1,s=!1}function f(a){if("string"==typeof a&&(a=a.split(u,2)),!p(a)||2!==a.length)throw new Error("Invalid tags: "+a);h=new RegExp(d(a[0])+"\\s*"),i=new RegExp("\\s*"+d(a[1])),m=new RegExp("\\s*"+d("}"+a[1]))}if(!b)return[];var h,i,m,n=[],o=[],q=[],r=!1,s=!1;f(c||a.tags);for(var y,z,A,B,C,D,E=new l(b);!E.eos();){if(y=E.pos,A=E.scanUntil(h))for(var F=0,G=A.length;G>F;++F)B=A.charAt(F),g(B)?q.push(o.length):s=!0,o.push(["text",B,y,y+1]),y+=1,"\n"===B&&e();if(!E.scan(h))break;if(r=!0,z=E.scan(x)||"name",E.scan(t),"="===z?(A=E.scanUntil(v),E.scan(v),E.scanUntil(i)):"{"===z?(A=E.scanUntil(m),E.scan(w),E.scanUntil(i),z="&"):A=E.scanUntil(i),!E.scan(i))throw new Error("Unclosed tag at "+E.pos);if(C=[z,A,y,E.pos],o.push(C),"#"===z||"^"===z)n.push(C);else if("/"===z){if(D=n.pop(),!D)throw new Error('Unopened section "'+A+'" at '+y);if(D[1]!==A)throw new Error('Unclosed section "'+D[1]+'" at '+y)}else"name"===z||"{"===z||"&"===z?s=!0:"="===z&&f(A)}if(D=n.pop())throw new Error('Unclosed section "'+D[1]+'" at '+E.pos);return k(j(o))}function j(a){for(var b,c,d=[],e=0,f=a.length;f>e;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function k(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;h>g;++g)switch(b=a[g],b[0]){case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function l(a){this.string=a,this.tail=a,this.pos=0}function m(a,b){this.view=a,this.cache={".":this.view},this.parent=b}function n(){this.cache={}}var o=Object.prototype.toString,p=Array.isArray||function(a){return"[object Array]"===o.call(a)},q=RegExp.prototype.test,r=/\S/,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},t=/\s*/,u=/\s+/,v=/\s*=/,w=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!/;l.prototype.eos=function(){return""===this.tail},l.prototype.scan=function(a){var b=this.tail.match(a);if(!b||0!==b.index)return"";var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c},l.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},m.prototype.push=function(a){return new m(a,this)},m.prototype.lookup=function(a){var c,d=this.cache;if(d.hasOwnProperty(a))c=d[a];else{for(var f,g,h=this,i=!1;h;){if(a.indexOf(".")>0)for(c=h.view,f=a.split("."),g=0;null!=c&&g<f.length;)g===f.length-1&&(i=e(c,f[g])),c=c[f[g++]];else c=h.view[a],i=e(h.view,a);if(i)break;h=h.parent}d[a]=c}return b(c)&&(c=c.call(this.view)),c},n.prototype.clearCache=function(){this.cache={}},n.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=i(a,b)),d},n.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof m?b:new m(b);return this.renderTokens(d,e,c,a)},n.prototype.renderTokens=function(a,b,c,d){for(var e,f,g,h="",i=0,j=a.length;j>i;++i)g=void 0,e=a[i],f=e[0],"#"===f?g=this.renderSection(e,b,c,d):"^"===f?g=this.renderInverted(e,b,c,d):">"===f?g=this.renderPartial(e,b,c,d):"&"===f?g=this.unescapedValue(e,b):"name"===f?g=this.escapedValue(e,b):"text"===f&&(g=this.rawValue(e)),void 0!==g&&(h+=g);return h},n.prototype.renderSection=function(a,c,d,e){function f(a){return g.render(a,c,d)}var g=this,h="",i=c.lookup(a[1]);if(i){if(p(i))for(var j=0,k=i.length;k>j;++j)h+=this.renderTokens(a[4],c.push(i[j]),d,e);else if("object"==typeof i||"string"==typeof i||"number"==typeof i)h+=this.renderTokens(a[4],c.push(i),d,e);else if(b(i)){if("string"!=typeof e)throw new Error("Cannot use higher-order sections without the original template");i=i.call(c.view,e.slice(a[3],a[5]),f),null!=i&&(h+=i)}else h+=this.renderTokens(a[4],c,d,e);return h}},n.prototype.renderInverted=function(a,b,c,d){var e=b.lookup(a[1]);return!e||p(e)&&0===e.length?this.renderTokens(a[4],b,c,d):void 0},n.prototype.renderPartial=function(a,c,d){if(d){var e=b(d)?d(a[1]):d[a[1]];return null!=e?this.renderTokens(this.parse(e),c,d,e):void 0}},n.prototype.unescapedValue=function(a,b){var c=b.lookup(a[1]);return null!=c?c:void 0},n.prototype.escapedValue=function(b,c){var d=c.lookup(b[1]);return null!=d?a.escape(d):void 0},n.prototype.rawValue=function(a){return a[1]},a.name="mustache.js",a.version="2.1.3",a.tags=["{{","}}"];var y=new n;a.clearCache=function(){return y.clearCache()},a.parse=function(a,b){return y.parse(a,b)},a.render=function(a,b,d){if("string"!=typeof a)throw new TypeError('Invalid template! Template should be a "string" but "'+c(a)+'" was given as the first argument for mustache#render(template, view, partials)');return y.render(a,b,d)},a.to_html=function(c,d,e,f){var g=a.render(c,d,e);return b(f)?void f(g):g},a.escape=h,a.Scanner=l,a.Context=m,a.Writer=n}),
// Released under the MIT license
define("stache",["text","mustache"],function(a,b){"use strict";var c={},d={},e="define('{pluginName}!{moduleName}', ['mustache'], function (Mustache) { var template = '{content}'; Mustache.parse( template ); return function( view ) { return Mustache.render( template, view ); } });\n";return{version:"0.0.3",load:function(e,f,g,h){if(d[e])g(d[e]);else{var i=h.stache&&h.stache.extension||".html",j=h.stache&&h.stache.path||"";a.load(j+e+i,f,function(a){h.isBuild?(c[e]=a,g()):(b.parse(a),d[e]=function(c){return b.render(a,c)},g(d[e]))},h)}},write:function(b,d,f,g){var h=c[d],i=h&&a.jsEscape(h);i&&f.asModule(b+"!"+d,e.replace("{pluginName}",b).replace("{moduleName}",d).replace("{content}",i))}}}),define("stache!components/hovercard_link/src/link",["mustache"],function(a){var b='{{#plain}}{{name}}{{/plain}}{{^plain}}<a href="{{{web_url}}}" class="yammer-object" data-yammer-object="{{type}}:{{id}}" data-resource-id="{{id}}" data-resource-model="{{type}}">{{name}}</a>{{/plain}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/hovercard_link/src/link",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","models/helpers/models","core/lib/urls","html!./link"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("models/helpers/models"),f=a("core/lib/urls");return b.extend({mixins:[c,d],template:a("html!./link"),initialize:function(){if(!this.model)throw"Link requires a model"},getTemplateData:function(){var a=e.getHelperForModel(this.model),b=this.model.get("type");return{id:this.model.get("id"),type:b,web_url:f.indexForModel(this.model),name:a.getPlainBody(this.model),plain:this.options.plain}}})}),/*
 * Copyright (c) 2008-2014 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
this.org=this.org||{},org.cometd={},org.cometd.JSON={},org.cometd.JSON.toJSON=org.cometd.JSON.fromJSON=function(a){throw"Abstract"},org.cometd.Utils={},org.cometd.Utils.isString=function(a){return void 0===a||null===a?!1:"string"==typeof a||a instanceof String},org.cometd.Utils.isArray=function(a){return void 0===a||null===a?!1:a instanceof Array},org.cometd.Utils.inArray=function(a,b){for(var c=0;c<b.length;++c)if(a===b[c])return c;return-1},org.cometd.Utils.setTimeout=function(a,b,c){return window.setTimeout(function(){try{a._debug("Invoking timed function",b),b()}catch(c){a._debug("Exception invoking timed function",b,c)}},c)},org.cometd.Utils.clearTimeout=function(a){window.clearTimeout(a)},org.cometd.TransportRegistry=function(){var a=[],b={};this.getTransportTypes=function(){return a.slice(0)},this.findTransportTypes=function(c,d,e){for(var f=[],g=0;g<a.length;++g){var h=a[g];b[h].accept(c,d,e)===!0&&f.push(h)}return f},this.negotiateTransport=function(c,d,e,f){for(var g=0;g<a.length;++g)for(var h=a[g],i=0;i<c.length;++i)if(h===c[i]){var j=b[h];if(j.accept(d,e,f)===!0)return j}return null},this.add=function(c,d,e){for(var f=!1,g=0;g<a.length;++g)if(a[g]===c){f=!0;break}return f||("number"!=typeof e?a.push(c):a.splice(e,0,c),b[c]=d),!f},this.find=function(c){for(var d=0;d<a.length;++d)if(a[d]===c)return b[c];return null},this.remove=function(c){for(var d=0;d<a.length;++d)if(a[d]===c){a.splice(d,1);var e=b[c];return delete b[c],e}return null},this.clear=function(){a=[],b={}},this.reset=function(){for(var c=0;c<a.length;++c)b[a[c]].reset()}},org.cometd.Transport=function(){var a,b;this.registered=function(c,d){a=c,b=d},this.unregistered=function(){a=null,b=null},this._debug=function(){b._debug.apply(b,arguments)},this._mixin=function(){return b._mixin.apply(b,arguments)},this.getConfiguration=function(){return b.getConfiguration()},this.getAdvice=function(){return b.getAdvice()},this.setTimeout=function(a,c){return org.cometd.Utils.setTimeout(b,a,c)},this.clearTimeout=function(a){org.cometd.Utils.clearTimeout(a)},this.convertToMessages=function(a){if(org.cometd.Utils.isString(a))try{return org.cometd.JSON.fromJSON(a)}catch(b){throw this._debug("Could not convert to JSON the following string",'"'+a+'"'),b}if(org.cometd.Utils.isArray(a))return a;if(void 0===a||null===a)return[];if(a instanceof Object)return[a];throw"Conversion Error "+a+", typeof "+typeof a},this.accept=function(a,b,c){throw"Abstract"},this.getType=function(){return a},this.send=function(a,b){throw"Abstract"},this.reset=function(){this._debug("Transport",a,"reset")},this.abort=function(){this._debug("Transport",a,"aborted")},this.toString=function(){return this.getType()}},org.cometd.Transport.derive=function(a){function b(){}return b.prototype=a,new b},org.cometd.RequestTransport=function(){function a(a){for(;l.length>0;){var b=l[0],c=b[0],d=b[1];if(c.url!==a.url||c.sync!==a.sync)break;l.shift(),a.messages=a.messages.concat(c.messages),this._debug("Coalesced",c.messages.length,"messages from request",d.id)}}function b(a,b){if(this.transportSend(a,b),b.expired=!1,!a.sync){var c=this.getConfiguration().maxNetworkDelay,d=c;b.metaConnect===!0&&(d+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"waiting at most",d,"ms for the response, maxNetworkDelay",c);var e=this;b.timeout=this.setTimeout(function(){b.expired=!0;var c="Request "+b.id+" of transport "+e.getType()+" exceeded "+d+" ms max network delay",f={reason:c},g=b.xhr;f.httpCode=e.xhrStatus(g),e.abortXHR(g),e._debug(c),e.complete(b,!1,b.metaConnect),a.onFailure(g,a.messages,f)},d)}}function c(a){var c=++i,d={id:c,metaConnect:!1};k.length<this.getConfiguration().maxConnections-1?(k.push(d),b.call(this,a,d)):(this._debug("Transport",this.getType(),"queueing request",c,"envelope",a),l.push([a,d]))}function d(a){var b=a.id;if(this._debug("Transport",this.getType(),"metaConnect complete, request",b),null!==j&&j.id!==b)throw"Longpoll request mismatch, completing request "+b;j=null}function e(b,d){var e=org.cometd.Utils.inArray(b,k);if(e>=0&&k.splice(e,1),l.length>0){var f=l.shift(),g=f[0],h=f[1];if(this._debug("Transport dequeued request",h.id),d)this.getConfiguration().autoBatch&&a.call(this,g),c.call(this,g),this._debug("Transport completed request",b.id,g);else{var i=this;this.setTimeout(function(){i.complete(h,!1,h.metaConnect);var a={reason:"Previous request failed"},b=h.xhr;a.httpCode=i.xhrStatus(b),g.onFailure(b,g.messages,a)},0)}}}function f(a){if(null!==j)throw"Concurrent metaConnect requests not allowed, request id="+j.id+" not yet completed";var c=++i;this._debug("Transport",this.getType(),"metaConnect send, request",c,"envelope",a);var d={id:c,metaConnect:!0};b.call(this,a,d),j=d}var g=new org.cometd.Transport,h=org.cometd.Transport.derive(g),i=0,j=null,k=[],l=[];return h.complete=function(a,b,c){c?d.call(this,a):e.call(this,a,b)},h.transportSend=function(a,b){throw"Abstract"},h.transportSuccess=function(a,b,c){b.expired||(this.clearTimeout(b.timeout),this.complete(b,!0,b.metaConnect),c&&c.length>0?a.onSuccess(c):a.onFailure(b.xhr,a.messages,{httpCode:204}))},h.transportFailure=function(a,b,c){b.expired||(this.clearTimeout(b.timeout),this.complete(b,!1,b.metaConnect),a.onFailure(b.xhr,a.messages,c))},h.send=function(a,b){b?f.call(this,a):c.call(this,a)},h.abort=function(){g.abort();for(var a=0;a<k.length;++a){var b=k[a];this._debug("Aborting request",b),this.abortXHR(b.xhr)}j&&(this._debug("Aborting metaConnect request",j),this.abortXHR(j.xhr)),this.reset()},h.reset=function(){g.reset(),j=null,k=[],l=[]},h.abortXHR=function(a){if(a)try{a.abort()}catch(a){this._debug(a)}},h.xhrStatus=function(a){if(a)try{return a.status}catch(a){this._debug(a)}return-1},h},org.cometd.LongPollingTransport=function(){var a=new org.cometd.RequestTransport,b=org.cometd.Transport.derive(a),c=!0;return b.accept=function(a,b,d){return c||!b},b.xhrSend=function(a){throw"Abstract"},b.transportSend=function(a,b){this._debug("Transport",this.getType(),"sending request",b.id,"envelope",a);var d=this;try{var e=!0;b.xhr=this.xhrSend({transport:this,url:a.url,sync:a.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(a.messages),onSuccess:function(e){d._debug("Transport",d.getType(),"received response",e);var f=!1;try{var g=d.convertToMessages(e);0===g.length?(c=!1,d.transportFailure(a,b,{httpCode:204})):(f=!0,d.transportSuccess(a,b,g))}catch(e){if(d._debug(e),!f){c=!1;var h={exception:e};h.httpCode=d.xhrStatus(b.xhr),d.transportFailure(a,b,h)}}},onError:function(f,g){c=!1;var h={reason:f,exception:g};h.httpCode=d.xhrStatus(b.xhr),e?d.setTimeout(function(){d.transportFailure(a,b,h)},0):d.transportFailure(a,b,h)}}),e=!1}catch(e){c=!1,this.setTimeout(function(){d.transportFailure(a,b,{exception:e})},0)}},b.reset=function(){a.reset(),c=!0},b},org.cometd.CallbackPollingTransport=function(){function a(a,b,c){var d=this;return function(){d.transportFailure(a,b,"error",c)}}var b=new org.cometd.RequestTransport,c=org.cometd.Transport.derive(b),d=2e3;return c.accept=function(a,b,c){return!0},c.jsonpSend=function(a){throw"Abstract"},c.transportSend=function(b,c){for(var e=this,f=0,g=b.messages.length,h=[];g>0;){var i=org.cometd.JSON.toJSON(b.messages.slice(f,f+g)),j=b.url.length+encodeURI(i).length;if(j>d){if(1===g){var k="Bayeux message too big ("+j+" bytes, max is "+d+") for transport "+this.getType();return void this.setTimeout(a.call(this,b,c,k),0)}--g}else h.push(g),f+=g,g=b.messages.length-f}var l=b;if(h.length>1){var m=0,n=h[0];this._debug("Transport",this.getType(),"split",b.messages.length,"messages into",h.join(" + ")),l=this._mixin(!1,{},b),l.messages=b.messages.slice(m,n),l.onSuccess=b.onSuccess,l.onFailure=b.onFailure;for(var o=1;o<h.length;++o){var p=this._mixin(!1,{},b);m=n,n+=h[o],p.messages=b.messages.slice(m,n),p.onSuccess=b.onSuccess,p.onFailure=b.onFailure,this.send(p,c.metaConnect)}}this._debug("Transport",this.getType(),"sending request",c.id,"envelope",l);try{var q=!0;this.jsonpSend({transport:this,url:l.url,sync:l.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(l.messages),onSuccess:function(a){var b=!1;try{var d=e.convertToMessages(a);0===d.length?e.transportFailure(l,c,{httpCode:204}):(b=!0,e.transportSuccess(l,c,d))}catch(a){e._debug(a),b||e.transportFailure(l,c,{exception:a})}},onError:function(a,b){var d={reason:a,exception:b};q?e.setTimeout(function(){e.transportFailure(l,c,d)},0):e.transportFailure(l,c,d)}}),q=!1}catch(a){this.setTimeout(function(){e.transportFailure(l,c,{exception:a})},0)}},c},org.cometd.WebSocketTransport=function(){function a(){if(!l){l=!0;var a=d.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",a);try{var b=d.getConfiguration().protocol,c=b?new org.cometd.WebSocket(a,b):new org.cometd.WebSocket(a)}catch(a){throw g=!1,this._debug("Exception while creating WebSocket object",a),a}i=d.getConfiguration().stickyReconnect!==!1;var e=this,f=null,h=d.getConfiguration().connectTimeout;h>0&&(f=this.setTimeout(function(){f=null,e._debug("Transport",e.getType(),"timed out while connecting to URL",a,":",h,"ms");var b={code:1e3,reason:"Connect Timeout"};e.webSocketClose(c,b.code,b.reason),e.onClose(c,b)},h));var j=function(){e._debug("WebSocket opened",c),l=!1,f&&(e.clearTimeout(f),f=null),m?(d._warn("Closing Extra WebSocket Connections",c,m),e.webSocketClose(c,1e3,"Extra Connection")):e.onOpen(c)},k=function(a){a=a||{code:1e3},e._debug("WebSocket closing",c,a),l=!1,f&&(e.clearTimeout(f),f=null),null!==m&&c!==m?e._debug("Closed Extra WebSocket Connection",c):e.onClose(c,a)},n=function(a){e._debug("WebSocket message",a,c),c!==m&&d._warn("Extra WebSocket Connections",c,m),e.onMessage(c,a)};c.onopen=j,c.onclose=k,c.onerror=function(){k({code:1002,reason:"Error"})},c.onmessage=n,this._debug("Transport",this.getType(),"configured callbacks on",c)}}function b(a,b,c){var d=org.cometd.JSON.toJSON(b.messages);a.send(d),this._debug("Transport",this.getType(),"sent",b,"metaConnect =",c);var e=this.getConfiguration().maxNetworkDelay,f=e;c&&(f+=this.getAdvice().timeout,n=!0);for(var g=this,h=[],i=0;i<b.messages.length;++i)!function(){var c=b.messages[i];c.id&&(h.push(c.id),k[c.id]=this.setTimeout(function(){g._debug("Transport",g.getType(),"timing out message",c.id,"after",f,"on",a);var b={code:1e3,reason:"Message Timeout"};g.webSocketClose(a,b.code,b.reason),g.onClose(a,b)},f))}();this._debug("Transport",this.getType(),"waiting at most",f,"ms for messages",h,"maxNetworkDelay",e,", timeouts:",k)}function c(c,d,e){try{null===c?a.call(this):b.call(this,c,d,e)}catch(a){this.setTimeout(function(){d.onFailure(c,d.messages,{exception:a})},0)}}var d,e=new org.cometd.Transport,f=org.cometd.Transport.derive(e),g=!0,h=!1,i=!0,j={},k={},l=!1,m=null,n=!1,o=null;return f.reset=function(){e.reset(),g=!0,h=!1,i=!0,j={},k={},l=!1,m=null,n=!1,o=null},f.onOpen=function(a){this._debug("Transport",this.getType(),"opened",a),m=a,h=!0,this._debug("Sending pending messages",j);for(var c in j){var d=j[c],e=d[0],f=d[1];o=e.onSuccess,b.call(this,a,e,f)}},f.onMessage=function(a,b){this._debug("Transport",this.getType(),"received websocket message",b,a);for(var c=!1,d=this.convertToMessages(b.data),e=[],f=0;f<d.length;++f){var g=d[f];if((/^\/meta\//.test(g.channel)||void 0!==g.successful)&&g.id){e.push(g.id);var h=k[g.id];h&&(this.clearTimeout(h),delete k[g.id],this._debug("Transport",this.getType(),"removed timeout for message",g.id,", timeouts",k))}"/meta/connect"===g.channel&&(n=!1),"/meta/disconnect"!==g.channel||n||(c=!0)}for(var i=!1,l=0;l<e.length;++l){var m=e[l];for(var p in j){var q=p.split(","),r=org.cometd.Utils.inArray(m,q);if(r>=0){i=!0,q.splice(r,1);var s=j[p][0],t=j[p][1];delete j[p],q.length>0&&(j[q.join(",")]=[s,t]);break}}}i&&this._debug("Transport",this.getType(),"removed envelope, envelopes",j),o.call(this,d),c&&this.webSocketClose(a,1e3,"Disconnect")},f.onClose=function(a,b){this._debug("Transport",this.getType(),"closed",a,b),g=i&&h;var c=k;k={};for(var d in c)this.clearTimeout(c[d]);var e=j;j={};for(var f in e){var l=e[f][0],o=e[f][1];o&&(n=!1),l.onFailure(a,l.messages,{websocketCode:b.code,reason:b.reason})}m=null},f.registered=function(a,b){e.registered(a,b),d=b},f.accept=function(a,b,c){return g&&!!org.cometd.WebSocket&&d.websocketEnabled!==!1},f.send=function(a,b){this._debug("Transport",this.getType(),"sending",a,"metaConnect =",b);for(var d=[],e=0;e<a.messages.length;++e){var f=a.messages[e];f.id&&d.push(f.id)}j[d.join(",")]=[a,b],this._debug("Transport",this.getType(),"stored envelope, envelopes",j),c.call(this,m,a,b)},f.webSocketClose=function(a,b,c){try{a.close(b,c)}catch(a){this._debug(a)}},f.abort=function(){if(e.abort(),m){var a={code:1001,reason:"Abort"};this.webSocketClose(m,a.code,a.reason),this.onClose(m,a)}this.reset()},f},org.cometd.CometD=function(a){function b(a,b){try{return a[b]}catch(a){return}}function c(a){return org.cometd.Utils.isString(a)}function d(a){return void 0===a||null===a?!1:"function"==typeof a}function e(a,b){if(window.console){var c=window.console[a];d(c)&&c.apply(window.console,b)}}function f(a){fa._debug("Configuring cometd object with",a),c(a)&&(a={url:a}),a||(a={}),xa=fa._mixin(!1,xa,a);var b=fa.getURL();if(!b)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var d=/(^https?:\/\/)?(((\[[^\]]+\])|([^:\/\?#]+))(:(\d+))?)?([^\?#]*)(.*)?/.exec(b),e=d[2],f=d[8],g=d[9];if(ha=fa._isCrossDomain(e),xa.appendMessageTypeToURL)if(void 0!==g&&g.length>0)fa._info("Appending message type to URI "+f+g+" is not supported, disabling 'appendMessageTypeToURL' configuration"),xa.appendMessageTypeToURL=!1;else{var h=f.split("/"),i=h.length-1;f.match(/\/$/)&&(i-=1),h[i].indexOf(".")>=0&&(fa._info("Appending message type to URI "+f+" is not supported, disabling 'appendMessageTypeToURL' configuration"),xa.appendMessageTypeToURL=!1)}}function g(a){if(a){var b=pa[a.channel];b&&b[a.id]&&(delete b[a.id],fa._debug("Removed",a.listener?"listener":"subscription",a))}}function h(a){a&&!a.listener&&g(a)}function i(){for(var a in pa){var b=pa[a];if(b)for(var c=0;c<b.length;++c)h(b[c])}}function j(a){ja!==a&&(fa._debug("Status",ja,"->",a),ja=a)}function k(){return"disconnecting"===ja||"disconnected"===ja}function l(){return++ka}function m(a,b,c,e,f){try{return b.call(a,e)}catch(a){fa._debug("Exception during execution of extension",c,a);var g=fa.onExtensionException;if(d(g)){fa._debug("Invoking extension exception callback",c,a);try{g.call(fa,a,c,f,e)}catch(a){fa._info("Exception during execution of exception callback in extension",c,a)}}return e}}function n(a){for(var b=0;b<sa.length&&(void 0!==a&&null!==a);++b){var c=xa.reverseIncomingExtensions?sa.length-1-b:b,e=sa[c],f=e.extension.incoming;if(d(f)){var g=m(e.extension,f,e.name,a,!1);a=void 0===g?a:g}}return a}function o(a){for(var b=0;b<sa.length&&(void 0!==a&&null!==a);++b){var c=sa[b],e=c.extension.outgoing;if(d(e)){var f=m(c.extension,e,c.name,a,!0);a=void 0===f?a:f}}return a}function p(a,b){var c=pa[a];if(c&&c.length>0)for(var e=0;e<c.length;++e){var f=c[e];if(f)try{f.callback.call(f.scope,b)}catch(a){fa._debug("Exception during notification",f,b,a);var g=fa.onListenerException;if(d(g)){fa._debug("Invoking listener exception callback",f,a);try{g.call(fa,a,f,f.listener,b)}catch(a){fa._info("Exception during execution of listener callback",f,a)}}}}}function q(a,b){p(a,b);for(var c=a.split("/"),d=c.length-1,e=d;e>0;--e){var f=c.slice(0,e).join("/")+"/*";e===d&&p(f,b),f+="*",p(f,b)}}function r(){null!==ra&&org.cometd.Utils.clearTimeout(ra),ra=null}function s(a){r();var b=ta.interval+qa;fa._debug("Function scheduled in",b,"ms, interval =",ta.interval,"backoff =",qa,a),ra=org.cometd.Utils.setTimeout(fa,a,b)}function t(a,b,c,e){for(var f=0;f<b.length;++f){var g=b[f],h=""+l();g.id=h,la&&(g.clientId=la);var i=void 0;d(g._callback)&&(i=g._callback,delete g._callback),g=o(g),void 0!==g&&null!==g?(g.id=h,b[f]=g,i&&(ua[h]=i)):b.splice(f--,1)}if(0!==b.length){var j=fa.getURL();xa.appendMessageTypeToURL&&(j.match(/\/$/)||(j+="/"),e&&(j+=e));var k={url:j,sync:a,messages:b,onSuccess:function(a){try{ya.call(fa,a)}catch(a){fa._debug("Exception during handling of messages",a)}},onFailure:function(a,b,c){try{var d=fa.getTransport();c.connectionType=d?d.getType():"unknown",za.call(fa,a,b,c)}catch(a){fa._debug("Exception during handling of failure",a)}}};fa._debug("Send",k),ca.send(k,c)}}function u(a){ma>0||oa===!0?na.push(a):t(!1,[a],!1)}function v(){qa=0}function w(){qa<xa.maxBackoff&&(qa+=xa.backoffIncrement)}function x(){++ma}function y(){var a=na;na=[],a.length>0&&t(!1,a,!1)}function z(){if(--ma,0>ma)throw"Calls to startBatch() and endBatch() are not paired";0!==ma||k()||oa||y()}function A(){if(!k()){var a={channel:"/meta/connect",connectionType:ca.getType()};wa||(a.advice={timeout:0}),j("connecting"),fa._debug("Connect sent",a),t(!1,[a],!0,"connect"),j("connected")}}function B(){j("connecting"),s(function(){A()})}function C(a){a&&(ta=fa._mixin(!1,{},xa.advice,a),fa._debug("New advice",ta))}function D(a){if(r(),a&&ca&&ca.abort(),la=null,j("disconnected"),ma=0,v(),ca=null,na.length>0){var b=na;na=[],za.call(fa,void 0,b,{reason:"Disconnected"})}}function E(a,b,c){var e=fa.onTransportFailure;if(d(e)){fa._debug("Invoking transport failure callback",a,b,c);try{e.call(fa,a,b,c)}catch(a){fa._info("Exception during execution of transport failure callback",a)}}}function F(a,b){d(a)&&(b=a,a=void 0),la=null,i(),k()?(ia.reset(),C(xa.advice)):C(fa._mixin(!1,ta,{reconnect:"retry"})),ma=0,oa=!0,da=a,ea=b;var c="1.0",e=fa.getURL(),f=ia.findTransportTypes(c,ha,e),g={version:c,minimumVersion:c,channel:"/meta/handshake",supportedConnectionTypes:f,_callback:b,advice:{timeout:ta.timeout,interval:ta.interval}},h=fa._mixin(!1,{},da,g);if(!ca&&(ca=ia.negotiateTransport(f,c,ha,e),!ca)){var l="Could not find initial transport among: "+ia.getTransportTypes();throw fa._warn(l),l}fa._debug("Initial transport is",ca.getType()),j("handshaking"),fa._debug("Handshake sent",h),t(!1,[h],!1,"handshake")}function G(){j("handshaking"),oa=!0,s(function(){F(da,ea)})}function H(a){var b=ua[a.id];d(b)&&(delete ua[a.id],b.call(fa,a))}function I(a){H(a),q("/meta/handshake",a),q("/meta/unsuccessful",a);var b=!k()&&"none"!==ta.reconnect;b?(w(),G()):D(!1)}function J(a){if(a.successful){la=a.clientId;var b=fa.getURL(),c=ia.negotiateTransport(a.supportedConnectionTypes,a.version,ha,b);if(null===c){var d="Could not negotiate transport with server; client=["+ia.findTransportTypes(a.version,ha,b)+"], server=["+a.supportedConnectionTypes+"]",e=fa.getTransport();return E(e.getType(),null,{reason:d,connectionType:e.getType(),transport:e}),fa._warn(d),void D(!0)}ca!==c&&(fa._debug("Transport",ca.getType(),"->",c.getType()),ca=c),oa=!1,y(),a.reestablish=va,va=!0,H(a),q("/meta/handshake",a);var f=k()?"none":ta.reconnect;switch(f){case"retry":v(),B();break;case"none":D(!1);break;default:throw"Unrecognized advice action "+f}}else I(a)}function K(a){var b="1.0",c=fa.getURL(),d=fa.getTransport(),e=ia.findTransportTypes(b,ha,c),f=ia.negotiateTransport(e,b,ha,c);f?(fa._debug("Transport",d.getType(),"->",f.getType()),E(d.getType(),f.getType(),a.failure),I(a),ca=f):(E(d.getType(),null,a.failure),fa._warn("Could not negotiate transport; client=["+e+"]"),D(!0),I(a))}function L(a){q("/meta/connect",a),q("/meta/unsuccessful",a);var b=k()?"none":ta.reconnect;switch(b){case"retry":B(),w();break;case"handshake":ia.reset(),v(),G();break;case"none":D(!1);break;default:throw"Unrecognized advice action"+b}}function M(a){if(wa=a.successful){q("/meta/connect",a);var b=k()?"none":ta.reconnect;switch(b){case"retry":v(),B();break;case"none":D(!1);break;default:throw"Unrecognized advice action "+b}}else L(a)}function N(a){wa=!1,L(a)}function O(a){D(!0),H(a),q("/meta/disconnect",a),q("/meta/unsuccessful",a)}function P(a){a.successful?(D(!1),H(a),q("/meta/disconnect",a)):O(a)}function Q(a){O(a)}function R(a){var b=pa[a.subscription];if(b)for(var c=b.length-1;c>=0;--c){var d=b[c];if(d&&!d.listener){delete b[c],fa._debug("Removed failed subscription",d);break}}H(a),q("/meta/subscribe",a),q("/meta/unsuccessful",a)}function S(a){a.successful?(H(a),q("/meta/subscribe",a)):R(a)}function T(a){R(a)}function U(a){H(a),q("/meta/unsubscribe",a),q("/meta/unsuccessful",a)}function V(a){a.successful?(H(a),q("/meta/unsubscribe",a)):U(a)}function W(a){U(a)}function X(a){H(a),q("/meta/publish",a),q("/meta/unsuccessful",a)}function Y(a){void 0===a.successful?void 0!==a.data?q(a.channel,a):fa._warn("Unknown Bayeux Message",a):a.successful?(H(a),q("/meta/publish",a)):X(a)}function Z(a){X(a)}function $(a){if(a=n(a),void 0!==a&&null!==a){C(a.advice);var b=a.channel;switch(b){case"/meta/handshake":J(a);break;case"/meta/connect":M(a);break;case"/meta/disconnect":P(a);break;case"/meta/subscribe":S(a);break;case"/meta/unsubscribe":V(a);break;default:Y(a)}}}function _(a){var b=pa[a];if(b)for(var c=0;c<b.length;++c)if(b[c])return!0;return!1}function aa(a,b){var e={scope:a,method:b};if(d(a))e.scope=void 0,e.method=a;else if(c(b)){if(!a)throw"Invalid scope "+a;if(e.method=a[b],!d(e.method))throw"Invalid callback "+b+" for scope "+a}else if(!d(b))throw"Invalid callback "+b;return e}function ba(a,b,c,d){var e=aa(b,c);fa._debug("Adding",d?"listener":"subscription","on",a,"with scope",e.scope,"and callback",e.method);var f={channel:a,scope:e.scope,callback:e.method,listener:d},g=pa[a];return g||(g=[],pa[a]=g),f.id=g.push(f)-1,fa._debug("Added",d?"listener":"subscription",f),f[0]=a,f[1]=f.id,f}var ca,da,ea,fa=this,ga=a||"default",ha=!1,ia=new org.cometd.TransportRegistry,ja="disconnected",ka=0,la=null,ma=0,na=[],oa=!1,pa={},qa=0,ra=null,sa=[],ta={},ua={},va=!1,wa=!1,xa={protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",reverseIncomingExtensions:!0,maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,advice:{timeout:6e4,interval:0,reconnect:"retry"}};this._mixin=function(a,c,d){for(var e=c||{},f=2;f<arguments.length;++f){var g=arguments[f];if(void 0!==g&&null!==g)for(var h in g){var i=b(g,h),j=b(e,h);if(i!==c&&void 0!==i)if(a&&"object"==typeof i&&null!==i)if(i instanceof Array)e[h]=this._mixin(a,j instanceof Array?j:[],i);else{var k="object"!=typeof j||j instanceof Array?{}:j;e[h]=this._mixin(a,k,i)}else e[h]=i}}return e},this._warn=function(){e("warn",arguments)},this._info=function(){"warn"!==xa.logLevel&&e("info",arguments)},this._debug=function(){"debug"===xa.logLevel&&e("debug",arguments)},this._isCrossDomain=function(a){return a&&a!==window.location.host};var ya,za;this.send=u,this.receive=$,ya=function(a){fa._debug("Received",a);for(var b=0;b<a.length;++b){var c=a[b];$(c)}},za=function(a,b,c){fa._debug("handleFailure",a,b,c),c.transport=a;for(var d=0;d<b.length;++d){var e=b[d],f={id:e.id,successful:!1,channel:e.channel,failure:c};switch(c.message=e,e.channel){case"/meta/handshake":K(f);break;case"/meta/connect":N(f);break;case"/meta/disconnect":Q(f);break;case"/meta/subscribe":f.subscription=e.subscription,T(f);break;case"/meta/unsubscribe":f.subscription=e.subscription,W(f);break;default:Z(f)}}},this.registerTransport=function(a,b,c){var e=ia.add(a,b,c);return e&&(this._debug("Registered transport",a),d(b.registered)&&b.registered(a,this)),e},this.getTransportTypes=function(){return ia.getTransportTypes()},this.unregisterTransport=function(a){var b=ia.remove(a);return null!==b&&(this._debug("Unregistered transport",a),d(b.unregistered)&&b.unregistered()),b},this.unregisterTransports=function(){ia.clear()},this.findTransport=function(a){return ia.find(a)},this.configure=function(a){f.call(this,a)},this.init=function(a,b){this.configure(a),this.handshake(b)},this.handshake=function(a,b){j("disconnected"),va=!1,F(a,b)},this.disconnect=function(a,b,c){if(!k()){"boolean"!=typeof a&&(c=b,b=a,a=!1),d(b)&&(c=b,b=void 0);var e={channel:"/meta/disconnect",_callback:c},f=this._mixin(!1,{},b,e);j("disconnecting"),t(a===!0,[f],!1,"disconnect")}},this.startBatch=function(){x()},this.endBatch=function(){z()},this.batch=function(a,b){var c=aa(a,b);this.startBatch();try{c.method.call(c.scope),this.endBatch()}catch(a){throw this._info("Exception during execution of batch",a),this.endBatch(),a}},this.addListener=function(a,b,d){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!c(a))throw"Illegal argument type: channel must be a string";return ba(a,b,d,!0)},this.removeListener=function(a){if(!(a&&a.channel&&"id"in a))throw"Invalid argument: expected subscription, not "+a;g(a)},this.clearListeners=function(){pa={}},this.subscribe=function(a,b,e,f,g){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!c(a))throw"Illegal argument type: channel must be a string";if(k())throw"Illegal state: already disconnected";d(b)&&(g=f,f=e,e=b,b=void 0),d(f)&&(g=f,f=void 0);var h=!_(a),i=ba(a,b,e,!1);if(h){var j={channel:"/meta/subscribe",subscription:a,_callback:g},l=this._mixin(!1,{},f,j);u(l)}return i},this.unsubscribe=function(a,b,c){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(k())throw"Illegal state: already disconnected";d(b)&&(c=b,b=void 0),this.removeListener(a);var e=a.channel;if(!_(e)){var f={channel:"/meta/unsubscribe",subscription:e,_callback:c},g=this._mixin(!1,{},b,f);u(g)}},this.resubscribe=function(a,b){return h(a),a?this.subscribe(a.channel,a.scope,a.callback,b):void 0},this.clearSubscriptions=function(){i()},this.publish=function(a,b,e,f){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!c(a))throw"Illegal argument type: channel must be a string";if(/^\/meta\//.test(a))throw"Illegal argument: cannot publish to meta channels";if(k())throw"Illegal state: already disconnected";d(b)?(f=b,b=e={}):d(e)&&(f=e,e={});var g={channel:a,data:b,_callback:f},h=this._mixin(!1,{},e,g);u(h)},this.getStatus=function(){return ja},this.isDisconnected=k,this.setBackoffIncrement=function(a){xa.backoffIncrement=a},this.getBackoffIncrement=function(){return xa.backoffIncrement},this.getBackoffPeriod=function(){return qa},this.setLogLevel=function(a){xa.logLevel=a},this.registerExtension=function(a,b){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!c(a))throw"Illegal argument type: extension name must be a string";for(var e=!1,f=0;f<sa.length;++f){var g=sa[f];if(g.name===a){e=!0;break}}return e?(this._info("Could not register extension with name",a,"since another extension with the same name already exists"),!1):(sa.push({name:a,extension:b}),this._debug("Registered extension",a),d(b.registered)&&b.registered(a,this),!0)},this.unregisterExtension=function(a){if(!c(a))throw"Illegal argument type: extension name must be a string";for(var b=!1,e=0;e<sa.length;++e){var f=sa[e];if(f.name===a){sa.splice(e,1),b=!0,this._debug("Unregistered extension",a);var g=f.extension;d(g.unregistered)&&g.unregistered();break}}return b},this.getExtension=function(a){for(var b=0;b<sa.length;++b){var c=sa[b];if(c.name===a)return c.extension}return null},this.getName=function(){return ga},this.getClientId=function(){return la},this.getURL=function(){if(ca&&"object"==typeof xa.urls){var a=xa.urls[ca.getType()];if(a)return a}return xa.url},this.getTransport=function(){return ca},this.getConfiguration=function(){return this._mixin(!0,{},xa)},this.getAdvice=function(){return this._mixin(!0,{},ta)},org.cometd.WebSocket=window.WebSocket},"function"==typeof define&&define.amd&&define("org/cometd",[],function(){return org.cometd}),/*
 * Copyright (c) 2008-2014 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){function a(a,b){function c(a,b){if(b)for(var c in b)"content-type"!==c.toLowerCase()&&a.setRequestHeader(c,b[c])}function d(){var d=new b.LongPollingTransport,e=b.Transport.derive(d);return e.xhrSend=function(b){return a.ajax({url:b.url,async:b.sync!==!0,type:"POST",contentType:"application/json;charset=UTF-8",data:b.body,beforeSend:function(a){return a.withCredentials=!0,c(a,b.headers),!0},success:b.onSuccess,error:function(a,c,d){b.onError(c,d)}})},e}function e(){var d=new b.CallbackPollingTransport,e=b.Transport.derive(d);return e.jsonpSend=function(b){a.ajax({url:b.url,async:b.sync!==!0,type:"GET",dataType:"jsonp",jsonp:"jsonp",data:{message:b.body},beforeSend:function(a){return c(a,b.headers),!0},success:b.onSuccess,error:function(a,c,d){b.onError(c,d)}})},e}return b.JSON.toJSON=JSON.stringify,b.JSON.fromJSON=JSON.parse,a.CometD=function(a){var c=new b.CometD(a);return b.WebSocket&&c.registerTransport("websocket",new b.WebSocketTransport),c.registerTransport("long-polling",new d),c.registerTransport("callback-polling",new e),c},a.cometd=new a.CometD,a.cometd}"function"==typeof define&&define.amd?define("jquery-cometd",["jquery","org/cometd"],a):a(jQuery,org.cometd)}(),define("core/lib/client/bayeux_monitor",["require","underscore","jquery-cometd","core/lib/ctor","core/lib/log","backbone"],function(a){var b=a("underscore"),c=a("jquery-cometd"),d=a("core/lib/ctor"),e=a("core/lib/log"),f=a("backbone");return d(null,{CONNECTED:"/realtime/connection/connected",RECONNECTED:"/realtime/connection/reconnected",INTERRUPTED:"/realtime/connection/interrupted",REESTABLISHING:"/realtime/connection/reestablishing",DISCONNECTED:"/realtime/connection/close",FAILURE:"/realtime/connection/failure",FAILURE_THRESHOLD:40,RECONNECT_PERIOD:3e5,SUBSCRIPTION_LIMIT:15,init:function(a){this._subscriptions=a,this._cometdListener=null,this._isConnected=!1,this._hasConnected=!1,this._wasConnected=!1,this._hasFailed=!1,this._handshakeRetries=0,this._lastReconnectTime=0,this._sessionTimedOut=!1,this._throttledPublish=b.throttle(this._publish.bind(this),this.RECONNECT_PERIOD)},start:function(){this._cometdListener=c.addListener("/meta/**",this._onMessage.bind(this))},stop:function(){c.removeListener(this._cometdListener),this._cometdListener=null},_onMessage:function(a){switch(a.channel){case"/meta/handshake":!a.successful&&!this._hasConnected&&!this._hasFailed&&++this._handshakeRetries>=this.FAILURE_THRESHOLD&&(this._hasFailed=!0,this._publish(this.FAILURE));break;case"/meta/connect":this._wasConnected=this._isConnected,this._isConnected=a.successful===!0,!this._isConnected||this._hasConnected||this._wasConnected?this._isConnected||!this._hasConnected||this._wasConnected?this._isConnected&&this._hasConnected&&!this._wasConnected?this._publishReconnect():!this._isConnected&&this._wasConnected&&(this._publish(this.INTERRUPTED),this._sessionTimedOut=a.error&&-1!=a.error.indexOf("402::Unknown client")):this._publish(this.REESTABLISHING):this._publish(this.CONNECTED),this._hasConnected=this._hasConnected||this._isConnected;break;case"/meta/disconnect":this._isConnected=this._wasConnected=this._hasConnected=!1,this._publish(this.DISCONNECTED);break;case"/meta/subscribe":this._limitSubscriptions()}},_limitSubscriptions:function(){var a=this._subscriptions,c=b.size(a)-this.SUBSCRIPTION_LIMIT;c>0&&b.chain(a).sortBy(function(a){return a._timestamp}).each(function(a){c>0&&/(?:in_group|from_user|about_topic|in_thread)/.test(a.id)&&(c--,this._publish("/realtime/client/stop",a.id))},this)},_publishReconnect:function(){var a=Date.now();if(this._sessionTimedOut){var c=Math.max(3e4,Math.floor(18e4*Math.random()));b.delay(this._publish.bind(this),c,this.RECONNECTED),this._sessionTimedOut=!1}else a-this._lastReconnectTime<this.RECONNECT_PERIOD?this._throttledPublish(this.RECONNECTED):this._publish(this.RECONNECTED);this._lastReconnectTime=a},_publish:function(){this._ylog("publishing connection event: ",arguments[0]),f.trigger.apply(f,arguments)},_ylog:function(){var a=b.toArray(arguments);a.unshift("--> yam.client.bayeux: "),e.log.apply(e,a)}})}),define("core/lib/promise",["require","core/lib/ctor"],function(a){var b=a("core/lib/ctor"),c={when:function(){return new c.Context(new c.Promise(arguments))}};return c.Context=b(null,{init:function(a){this._promise=a},when:function(){return this._promise.addConditions(arguments),this},within:function(a){return this._promise.setPeriod(a),this},then:function(){var a=2===arguments.length?arguments[1].bind(arguments[0]):arguments[0];return this._promise.addSuccessCallback(a),this._promise.execute(),this},otherwise:function(){var a=2===arguments.length?arguments[1].bind(arguments[0]):arguments[0];return this._promise.addFailureCallback(a),this._promise.execute(),this},satisfy:function(a,b){return this._promise.satisfy(a,b),this},cancel:function(a,b){return this._promise.cancel(a,b),this},fail:function(a,b){return this._promise.fail(a,b),this},getPromise:function(){return this._promise},isSatisfied:function(){return this._promise.isSatisfied()}}),c.Promise=b(null,{init:function(a){this._conditions={},this._period=0,this._executed=!1,this._successCallbacks=[],this._failureCallbacks=[],this._timeout=void 0,this.addConditions(a)},execute:function(){this.isSatisfied()?this._executeSuccess():this.isBroken()?this._executeFailure():this.hasExecuted()||this._execute(),this._executed=!0},addSuccessCallback:function(a){this._successCallbacks.push(a)},addFailureCallback:function(a){this._failureCallbacks.push(a)},addConditions:function(a){for(var b=0,c=a.length;c>b;++b)this.addCondition(a[b])},addCondition:function(a){this._conditions[a]=new c.Condition(a)},getConditions:function(){return this._conditions},isSatisfied:function(){return!c.util.detect(this._conditions,function(a){return!this[a].isSatisfied()})},isBroken:function(){return!!c.util.detect(this._conditions,function(a){return this[a].isBroken()})},hasExecuted:function(){return this._executed},cancel:function(a,b){this._conditions[a].cancel(b),this.execute()},satisfy:function(a,b){this._conditions[a].satisfy(b),this.execute()},fail:function(a,b){this._conditions[a].fail(b),this.execute()},_execute:function(){c.util.forEach(this._conditions,function(a){this[a].execute()}),this._period&&(this._timeout=window.setTimeout(this._onTimeout.bind(this)))},_onTimeout:function(){this.isBroken()||this.isSatisfied()||(c.util.forEach(this._conditions,function(a){this[a].fail("timeout")}),this._executeFailure())},_executeSuccess:function(){window.clearTimeout(this._timeout),this._executeCallbacks(this._successCallbacks)},_executeFailure:function(){window.clearTimeout(this._timeout),this._executeCallbacks(this._failureCallbacks)},_executeCallbacks:function(a){for(;a.length;){var b=a.shift();b(this._conditions)}},setPeriod:function(a){this._period=a},getPeriod:function(){return this._period},getSuccessCallbacks:function(){return this._successCallbacks},getFailureCallbacks:function(){return this._failureCallbacks}}),c.Condition=b(null,{init:function(a){this._name=a,this._data=void 0,this._satisfied=!1,this._failed=!1,this._cancelled=!1},getName:function(){return this._name},satisfy:function(a){this._setState("satisfied",!0,a)},fail:function(a){this._setState("failed",!0,a)},cancel:function(a){this._setState("cancelled",!0,a)},getData:function(){return this._data},isBroken:function(){return this.isCancelled()||this.isFailed()},isFailed:function(){return this._failed},isCancelled:function(){return this._cancelled},isSatisfied:function(){return this._satisfied},execute:function(){},_setState:function(a,b,c){this.isBroken()||this.isSatisfied()||(this["_"+a]=b,this._data=c)}}),c.util={detect:function(a,b){var d;return c.util.forEach(a,function(c){return!(d=c&&b.call(a,c))}),d},forEach:function(a,b){for(var c in a)if(a.hasOwnProperty(c)&&b.call(a,c)===!1)return}},c}),define("common-ui/lib/helper/environment",[],function(){var a=navigator.userAgent,b=function(){var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");do b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->";while(c[0]);return a>4?a:document.documentMode}(),c=function(){return b?{version:b}:!1},d=function(){return b&&11>b},e=function(){return/iphone|ipad|ipod/i.test(a)},f=function(){return/android/i.test(a)},g=function(){return/windows\sphone|wpdesktop/i.test(a)},h=function(){return e()?"ios":f()?"android":g()?"windows":null},i=function(){return e()||f()||g()},j=function(){return navigator.standalone||a.match(/iphone|ipod|ipad/i)&&!a.match(/safari/i)},k=function(){return a.match(/iphone|ipad|ipod/i)&&a.match(/safari/i)&&!a.match(/crios/i)&&Number(a.substr(a.indexOf("OS ")+3,3).replace("_","."))>=6},l=function(){var a=!1,b="animation",c="",d="Webkit Moz O ms Khtml".split(" "),e="",f=document.createElement("div");if(void 0!==f.style.animationName&&(a=!0),a===!1)for(var g=0;g<d.length;g++)if(void 0!==f.style[d[g]+"AnimationName"]){e=d[g],b=e+"Animation",c="-"+e.toLowerCase()+"-",a=!0;break}return a}(),m=function(){return l},n=function(){return a};return{isIE:c,isOlderIE:d,isIOS:e,isAndroid:f,isWindowsPhone:g,detectMobileOS:h,isMobile:i,isNative:j,hasNativeSmartBannerSupport:k,hasAnimationSupport:m,getUserAgent:n}}),define("core/lib/client/bayeux",["require","underscore","core/lib/client/bayeux_monitor","jquery-cometd","core/lib/log","core/lib/promise","backbone","core/lib/treatment","common-ui/lib/helper/environment"],function(a){var b=a("underscore"),c=a("core/lib/client/bayeux_monitor"),d=a("jquery-cometd"),e=a("core/lib/log"),f=a("core/lib/promise"),g=a("backbone"),h=a("core/lib/treatment"),i=a("common-ui/lib/helper/environment"),j={},k=function(){},l=function(a){this.id=a,this._subs={},this._timestamp=Date.now()};l.prototype={get:function(a){return this.has(a)?this._subs[a]:null},add:function(a,b){this._subs[a]||(this._subs[a]=[]),this._subs[a].push(b)},has:function(a){return!(!this._subs[a]||!this._subs[a].length)},remove:function(a){delete this._subs[a]},isEmpty:function(){return b.isEmpty(this._subs)},clear:function(){this._subs={}}},j.SubscriptionHolder=l;var m,n,o,p={},q=null,r=function(a,b){if("disconnected"!=d.getStatus()&&"disconnecting"!=d.getStatus())return q;g.once("/realtime/connection/close",w),m=b||m,n=a||n,q=f.when("connected").otherwise(function(){e.log("Could not connect to realtime. Handshake failed.")});var j=function(a){a.successful&&(q.satisfy("connected"),d.removeListener(k),d.removeListener(l))},k=d.addListener("/meta/handshake",j),l=d.addListener("/meta/connect",j);return d.onListenerException=function(a){console.error("cometd Listener Exception: ",a)},o=new c(p),o.start(),d.websocketEnabled=!!h.treatment("artie_enable_websockets"),i.isIE()&&i.isIE().version<10&&(d.websocketEnabled=!1),d.ackEnabled=!1,d.unregisterTransport("callback-polling"),d.configure({url:a,logLevel:"none",backoffIncrement:45e3,maxBackoff:36e4}),d.handshake({ext:{token:b,auth:"oauth",push_message_bodies:!1}}),q},s=function(a){return p[a]||(p[a]=new l(a)),p[a]},t=function(a){return b.any(p,function(b){return b.has(a)})},u=function(){return b.any(p,function(a){return!a.isEmpty()})},v=function(){b.each(p,function(a){a.clear()})},w=function(){v()},x=function(a,c){c.onData=c.onData||k,c.onSuccess=c.onSuccess||k,c.onError=c.onError||k;var g=s(c.id||"default"),h=[],i=f.when.apply(f,a).then(c.onSuccess.bind(null,h));d.batch(function(){b.each(a,function(a,e){var f;t(a)?b.defer(function(){i.satisfy(a)}):(f=d.addListener("/meta/subscribe",function(b){b.subscription==a&&b.successful&&i.satisfy(a)}),i.then(d.removeListener.bind(d,f)),i.otherwise(d.removeListener.bind(d,f)));var j=g.get(a);j&&(b.each(j,function(a){d.removeListener(a)}),g.remove(a));var k=d.subscribe(a,c.onData);g.add(a,k),h[e]=k})}),i.otherwise(function(){e.log("subscription failure: "+a.join(", "),c.onError),c.onError()})};return j.subscribe=function(a){a=a||{};var b=r(a.url,a.token);b.then(function(){x(a.channels||[],a)}).otherwise(a.onError)},j.unsubscribe=function(a){a.onSuccess=a.onSuccess||k,a.onError=a.onError||k;var c,e=s(a.id||"default"),g=f.when.apply(f,a.channels);g.then(a.onSuccess.bind(a)).otherwise(a.onError.bind(a,c)),d.batch(function(){b.each(a.channels,function(a){var f;if(t(a)){f=d.addListener("/meta/unsubscribe",function(b){b.subscription==a&&(b.successful?(g.satisfy(a),e.remove(a),e.isEmpty()&&delete j._subscriptions[e.id]):c=new Error(b.error))}),g.then(d.removeListener.bind(d,f)),g.otherwise(d.removeListener.bind(d,f));var h=e.get(a);h&&b.each(h,function(a){d.unsubscribe(a)})}else b.defer(function(){g.satisfy(a),e.isEmpty()&&delete j._subscriptions[e.id]})}),u()||d.disconnect()})},j.disconnect=function(){d.disconnect()},j.publish=function(a,b){d.publish(a,b)},j.hasSubscription=function(a){var b=s(a);return b&&!b.isEmpty()},j.getStatus=d.getStatus,j._subscriptions=p,j}),define("models/lib/client/base_realtime_client",["require","underscore","backbone","core/lib/client/base_client","core/lib/client/payload","core/lib/client/bayeux","core/lib/ctor","core/lib/namespace","core/lib/session","core/lib/yammer_api","core/lib/yammer_config","core/lib/yammer_request"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/client/base_client"),e=a("core/lib/client/payload"),f=a("core/lib/client/bayeux"),g=a("core/lib/ctor"),h=a("core/lib/namespace"),i=a("core/lib/session"),j=a("core/lib/yammer_api"),k=a("core/lib/yammer_config"),l=a("core/lib/yammer_request"),m=g(null,d,{init:function(a){d.prototype.init.call(this,a),b.extend(this,c.Events),this.requestFunction=l.send,this._id=b.uniqueId()},getId:function(){return this._id},start:function(){this.isStarted()||this.isStarting()||(this.setStarting(),this.requestFunction?this._startRequests():this.onFirstRestData({}))},_startRequests:function(){this.sendRequest({success:this.onFirstRestData.bind(this),error:this.onFirstRestError.bind(this)})},stop:function(){this.isStopping()||this.isStopped()||(f.unsubscribe({channels:this.getChannels(),id:this.getId(),onSuccess:this.setStopped.bind(this)}),this.setStopped(),this.stopListening())},sendRequest:function(a){var c=this.getParams(a);c.success=b.wrap(c.success,function(a,b){this.onRestData(b,c),a(b),c.success=a}.bind(this)),c.error=b.wrap(c.error,function(a,b){this.onRestError(b),a(b),c.error=a}.bind(this)),this.requestFunction.call(null,c)},getParams:function(a){a=a||{};var c=b.extend({type:"GET",auth:"oauth2",url:this.getUrl(),success:function(){},error:function(){}},a,!0);return c},onFirstRestData:function(a){a&&(a.val?this.setMeta(a.val("meta.realtime")):this.setMeta(h.val(a,"meta.realtime"))),this.onProcessFirstRestData(a),this.shouldConnectToRealtime()?(this.listenToOnce(this,"onStarted",this.onConnectionOpened.bind(this)),this.listenTo(c,"/realtime/connection/reconnected",this.onConnectionReopened),this.listenTo(c,"/realtime/connection/broken",this.onConnectionBroken),this.listenTo(c,"/realtime/connection/close",this.onConnectionClosed),this.listenTo(c,"/realtime/connection/denied",this.onConnectionDenied),this.listenTo(c,"/realtime/connection/failure",b.partial(this.onConnectionFailure,"realtime_failure")),this.listenTo(c,"/realtime/client/stop",this.onStopClient),this.connectToRealtime({onSuccess:this.setStarted.bind(this)})):this.setStarted()},onProcessFirstRestData:function(){},onFirstRestError:function(a){var b=this._getErrorReason(a);return this.setStopped(),this.onConnectionFailure(b)},_getErrorReason:function(a){var b="unknown";if(a.status)switch(a.status){case 403:b="forbidden";break;case 404:b="not-found"}return b},onRestData:function(a){this.onData(this.createPayload(a))},onRestError:function(a){c.trigger("/message/error",a),this.onDataError(a)},connectToRealtime:function(a){m.fetchUri().then(b.bind(function(b){f.subscribe({url:b.realtimeURI,channels:this.getChannels(),token:this.getToken(),id:this.getId(),onSuccess:a&&a.onSuccess||function(){},onData:this.onRealtimeData.bind(this)})},this))},onRealtimeData:function(a){this.onData(this.createPayload(a))},onConnectionOpened:function(){},onConnectionReopened:function(){this.connectToRealtime(),this.onConnectionOpened()},onConnectionFailure:function(a){a=a||"unknown","realtime_failure"===a&&("disconnected"!==f.getStatus()&&f.disconnect(),this.setStopped())},onConnectionClosed:function(){this.setStopped()},onStopClient:function(a){a==this.getUrl()&&this.stop()},createPayload:function(a){return new e(a)},getChannels:function(){return[]},getMeta:function(){return this._meta},setMeta:function(a){this._meta=a},getToken:function(){return k.config().autocomplete_token||i.getCurrentUser().web_oauth_access_token},shouldConnectToRealtime:function(){return!0}});return m.fetchUri=function(){var a=this._uriPromise;return a||(a=j.getRealtime(),this._uriPromise=a),a},m.reset=function(){this._uriPromise=void 0},m._uriPromise=void 0,m}),define("models/group_rank",["require","models/yammer_model"],function(a){"use strict";var b=a("models/yammer_model"),c=b.extend({defaults:{type:"groupRank"}});return c}),define("collections/group_ranks",["require","collections/yammer_collection","models/group_rank"],function(a){"use strict";var b=a("collections/yammer_collection"),c=a("models/group_rank"),d=b.extend({model:c,comparator:"rank"});return new d}),define("models/lib/model/helper/top_groups",["require","underscore","models/group","collections/group_ranks","collections/groups","models/lib/helper/feed_factory","core/lib/treatment"],function(a){"use strict";function b(){return n.ALL_COMPANY().get("id")}function c(a){return a===b()}function d(a){return c(a)?b():Number(a)}function e(a){return c(a)?n.ALL_COMPANY():p.get(d(a))}function f(a){return c(a)?q.find("general"):q.find("group",a)}function g(a){var b=o.filter(a);return m.map(b,function(a){return a.get("group_id")})}function h(){return g(function(a){return!a.get("external")})}function i(){return g(function(a){return a.get("external")===!0})}function j(){return m.union(h(),[b()],i())}function k(a){return s.getUnviewedCountForGroup(a)>0}function l(){return m.filter(j(),k)}var m=a("underscore"),n=a("models/group"),o=a("collections/group_ranks"),p=a("collections/groups"),q=a("models/lib/helper/feed_factory"),r=a("core/lib/treatment"),s={getTopGroups:function(){return m.map(j(),function(a){return e(a)})},getTopUnviewedGroups:function(){return m.map(l(),function(a){return e(a)})},getIndexForGroup:function(a){return m(j()).indexOf(d(a))},getUnviewedIndexForGroup:function(a){return m(l()).indexOf(d(a))},getUnviewedCountForGroup:function(a){var b=f(d(a));return b?b.getUnseenCount():null},getNextGroupFromGroup:function(a){var b=s.getIndexForGroup(a),d=j(),f=m.rest(d,b+1),g=m.first(d,b),i=m.union(f,g),l=m.find(i,k);if(r.treatment("tow_g2g_v2")&&c(l)){var n=m.without(h(),a),o=m.find(n,k);o&&(l=o)}return l?e(l):null},getNextGroupFromInbox:function(){var a=l();return a.length>0?e(a[0]):null},getNextGroupFromHome:function(){var a=m.without(l(),b());return a.length>0?e(a[0]):null},getNextGroupFromAllCompany:function(){var a=m.without(l(),b());return a.length>0?e(a[0]):null}};return s}),define("models/lib/client/realtime_network_client",["require","underscore","models/lib/client/base_realtime_client","core/lib/ctor","models/lib/helper/feed_factory","collections/group_ranks","core/lib/session","core/lib/yammer_uri","models/lib/model/helper/top_groups","models/helpers/group"],function(a){var b=a("underscore"),c=a("models/lib/client/base_realtime_client"),d=a("core/lib/ctor"),e=a("models/lib/helper/feed_factory"),f=a("collections/group_ranks"),g=a("core/lib/session"),h=a("core/lib/yammer_uri"),i=a("models/lib/model/helper/top_groups"),j=a("models/helpers/group");return d(null,c,{THROTTLE_PERIOD:3e4,JITTER_PERIOD:1e4,DELAY_INTERVAL:9e5,UNSEEN_COUNTS_EVERY_N:10,init:function(a){c.prototype.init.call(this,a),this._callCount=0,this._channels=[],this._jitterPeriod=void 0===a.jitterPeriod?this.JITTER_PERIOD:a.jitterPeriod,this.sendRequest=b.throttle(this._jitterSendRequest,this.THROTTLE_PERIOD)},onProcessFirstRestData:function(){var a=g.getCurrentNetwork();a&&this._channels.push(this._networksCurrentChannelName(a)),this._getCountsForENs()},onRealtimeData:function(a){var b=!0;a&&this._isNetworksCurrentChannel(a)&&a.data.group_ids&&(b=this._networksEventInTopGroups(a.data.group_ids)),b&&this.sendRequest()},_jitterSendRequest:function(a){b.delay(this._sendRequest.bind(this),Math.round(Math.random()*this._jitterPeriod),a)},_networksCurrentChannelName:function(a){return"/networks/"+a.id+"/current"},_isNetworksCurrentChannel:function(a){return this._networksCurrentChannelName(g.getCurrentNetwork())===a.channel},_networksEventInTopGroups:function(a){if(b.isEmpty(a))return!1;var c=this._getTopGroupsWithoutRealtime();return b.some(c,function(b){var c=j.isAllCompany(b)?0:b.id;return a.indexOf(c)>-1})},_getCountsForENs:function(){this.isStopping()||this.isStopped()||(this.onRealtimeData(),b.delay(this._getCountsForENs.bind(this),this.DELAY_INTERVAL))},_sendRequest:function(a){c.prototype.sendRequest.call(this,a),this._callCount+=1},getUrl:function(){var a={exclude_own_messages_from_unseen:!0,include_group_counts:!0,inbox_supported_client:!0,exclude_private_unread_thread_count:!0,use_unviewed:!0};this._shouldExcludeUnseenMessageCount()&&(a.exclude_unseen_message_count=!0),this._shouldExcludeAllCompanyCount()&&(a.exclude_general_count=!0);var b=this._getGroupsToExcludeFromCounts();return b.length&&(a.exclude_group_counts=b.join(",")),h.api("networks/current",a)},getChannels:function(){return this._channels},_shouldExcludeUnseenMessageCount:function(){return 0!==(this._callCount%=this.UNSEEN_COUNTS_EVERY_N)},_shouldExcludeAllCompanyCount:function(){var a=e.find("general");return a&&a.isRealtimeConnected()},_getGroupsToExcludeFromCounts:function(){return f.pluck("group_id").slice(0,20).filter(function(a){return this._isGroupFeedRealtimeConnected(a)},this)},_isGroupFeedRealtimeConnected:function(a){var b=e.find("group",a);return b&&b.isRealtimeConnected()},_getTopGroupsWithoutRealtime:function(){return b.filter(i.getTopGroups(),function(a){return j.isAllCompany(a)?!this._shouldExcludeAllCompanyCount():!this._isGroupFeedRealtimeConnected(a.id)},this)}})}),define("models/network",["require","underscore","models/lib/client/realtime_network_client","models/lib/helper/feed_factory","core/lib/model_helper","core/lib/namespace","core/lib/session","models/lib/orm-models","models/helpers/network","models/lib/events"],function(a){var b=a("underscore"),c=a("models/lib/client/realtime_network_client"),d=a("models/lib/helper/feed_factory"),e=a("core/lib/model_helper"),f=a("core/lib/namespace"),g=a("core/lib/session"),h=a("models/lib/orm-models"),i=a("models/helpers/network"),j=a("models/lib/events"),k=e.define("yam.model.Network",function(){this.clientize(c,"Network"),this.prototype.type="network",this.prototype.getFeeds=function(){var a=h.Feed();return a.find({network_id:this.id})},this.prototype.getPlainBody=function(){return this.full_name||this.name},this.prototype.process=function(a){b.each(a.getRaw()||[],k.processNetwork.bind(k))},this.processNetwork=function(a){var b=k.save(a);i.isCurrent(b,g)&&(k.processGroupCounts(a),k.processFollowingFeedCount(a))},this.processFollowingFeedCount=function(a){var b=f.val(a,"unseen_message_count"),c=d.findOrCreate("following");b>=0&&c.updateCountFromNetwork(b)},this.groupCountProcessing=new $.Deferred,this.processGroupCounts=function(a){var b=!!f.val(a,"group_counts");if(b){var c,e=f.val(a,"group_counts.unseen_group_thread_counts")||{};for(c in e)d.findOrCreate("group",c).updateCountFromNetwork(e[c]);d.findOrCreate("general").updateCountFromNetwork(f.val(a,"group_counts.unseen_general_thread_count")||0)}k.groupCountProcessing.resolve(a)}});return k.setupGlobalListeners=function(){j.on("Network/save",function(a){i.isCurrent(a,g)&&b.each(a.getFeeds(),function(b){var c;b.isInbox()&&(c=i.getInboxUnseenThreadCount(a)),void 0!==c&&c>b.getUnseenThreadCount()&&b.updateCountFromNetwork(c)})})},k}),define("css",[],function(){var a={};return a.normalize=function(a,b){return".css"==a.substr(a.length-4,4)&&(a=a.substr(0,a.length-4)),b(a)},a}),define("css!components/network_label/src/network_label",[],function(){}),define("stache!components/network_label/src/network_label",["mustache"],function(a){var b='{{#visible}}<span class="yj-network-label--spacer">&nbsp;</span><sup class="yj-network-label--container"><span class="yj-network-label--label">{{ network }}</span></span>{{/visible}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/network_label/src/network_label",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","models/network","core/lib/session","css!./network_label","html!./network_label"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("models/network"),e=a("core/lib/session");return a("css!./network_label"),b.extend({mixins:[c],template:a("html!./network_label"),tagName:"span",className:"yj-network-label",getTemplateData:function(){var a,b=yam.helper.user,c=yam.helper.group;return a=b.isUser(this.model)?b.getNetworkName(this.model,d):c.isGroup(this.model)?c.getNetworkName(this.model,d):this.model.getNetworkName&&this.model.getNetworkName(),{network:a,visible:this.isVisible()}},isVisible:function(){var a=yam.helper.user,b=yam.helper.group;return"domain"===this.model.get("type")?!1:a.isUser(this.model)?a.isForeign(this.model,e):b.isGroup(this.model)?b.isForeign(this.model,e):this.model.isForeign&&this.model.isForeign()}})}),define("components/network_label/index",["require","./src/network_label"],function(a){"use strict";return a("./src/network_label")}),function(a){a.emojioneList={":kiss_ww:":["1f469-200d-2764-fe0f-200d-1f48b-200d-1f469","1f469-2764-1f48b-1f469"],":couplekiss_ww:":["1f469-200d-2764-fe0f-200d-1f48b-200d-1f469","1f469-2764-1f48b-1f469"],":kiss_mm:":["1f468-200d-2764-fe0f-200d-1f48b-200d-1f468","1f468-2764-1f48b-1f468"],":couplekiss_mm:":["1f468-200d-2764-fe0f-200d-1f48b-200d-1f468","1f468-2764-1f48b-1f468"],":family_mmbb:":["1f468-200d-1f468-200d-1f466-200d-1f466","1f468-1f468-1f466-1f466"],":family_mmgb:":["1f468-200d-1f468-200d-1f467-200d-1f466","1f468-1f468-1f467-1f466"],":family_mmgg:":["1f468-200d-1f468-200d-1f467-200d-1f467","1f468-1f468-1f467-1f467"],":family_mwbb:":["1f468-200d-1f469-200d-1f466-200d-1f466","1f468-1f469-1f466-1f466"],":family_mwgb:":["1f468-200d-1f469-200d-1f467-200d-1f466","1f468-1f469-1f467-1f466"],":family_mwgg:":["1f468-200d-1f469-200d-1f467-200d-1f467","1f468-1f469-1f467-1f467"],":family_wwbb:":["1f469-200d-1f469-200d-1f466-200d-1f466","1f469-1f469-1f466-1f466"],":family_wwgb:":["1f469-200d-1f469-200d-1f467-200d-1f466","1f469-1f469-1f467-1f466"],":family_wwgg:":["1f469-200d-1f469-200d-1f467-200d-1f467","1f469-1f469-1f467-1f467"],":couple_ww:":["1f469-200d-2764-fe0f-200d-1f469","1f469-2764-1f469"],":couple_with_heart_ww:":["1f469-200d-2764-fe0f-200d-1f469","1f469-2764-1f469"],":couple_mm:":["1f468-200d-2764-fe0f-200d-1f468","1f468-2764-1f468"],":couple_with_heart_mm:":["1f468-200d-2764-fe0f-200d-1f468","1f468-2764-1f468"],":family_mmb:":["1f468-200d-1f468-200d-1f466","1f468-1f468-1f466"],":family_mmg:":["1f468-200d-1f468-200d-1f467","1f468-1f468-1f467"],":family_mwg:":["1f468-200d-1f469-200d-1f467","1f468-1f469-1f467"],":family_wwb:":["1f469-200d-1f469-200d-1f466","1f469-1f469-1f466"],":family_wwg:":["1f469-200d-1f469-200d-1f467","1f469-1f469-1f467"],":eye_in_speech_bubble:":["1f441-200d-1f5e8","1f441-1f5e8"],":hash:":["0023-fe0f-20e3","0023-20e3"],":zero:":["0030-fe0f-20e3","0030-20e3"],":one:":["0031-fe0f-20e3","0031-20e3"],":two:":["0032-fe0f-20e3","0032-20e3"],":three:":["0033-fe0f-20e3","0033-20e3"],":four:":["0034-fe0f-20e3","0034-20e3"],":five:":["0035-fe0f-20e3","0035-20e3"],":six:":["0036-fe0f-20e3","0036-20e3"],":seven:":["0037-fe0f-20e3","0037-20e3"],":eight:":["0038-fe0f-20e3","0038-20e3"],":nine:":["0039-fe0f-20e3","0039-20e3"],":asterisk:":["002a-fe0f-20e3","002a-20e3"],":keycap_asterisk:":["002a-fe0f-20e3","002a-20e3"],":metal_tone5:":["1f918-1f3ff"],":sign_of_the_horns_tone5:":["1f918-1f3ff"],":metal_tone4:":["1f918-1f3fe"],":sign_of_the_horns_tone4:":["1f918-1f3fe"],":metal_tone3:":["1f918-1f3fd"],":sign_of_the_horns_tone3:":["1f918-1f3fd"],":metal_tone2:":["1f918-1f3fc"],":sign_of_the_horns_tone2:":["1f918-1f3fc"],":metal_tone1:":["1f918-1f3fb"],":sign_of_the_horns_tone1:":["1f918-1f3fb"],":bath_tone5:":["1f6c0-1f3ff"],":bath_tone4:":["1f6c0-1f3fe"],":bath_tone3:":["1f6c0-1f3fd"],":bath_tone2:":["1f6c0-1f3fc"],":bath_tone1:":["1f6c0-1f3fb"],":walking_tone5:":["1f6b6-1f3ff"],":walking_tone4:":["1f6b6-1f3fe"],":walking_tone3:":["1f6b6-1f3fd"],":walking_tone2:":["1f6b6-1f3fc"],":walking_tone1:":["1f6b6-1f3fb"],":mountain_bicyclist_tone5:":["1f6b5-1f3ff"],":mountain_bicyclist_tone4:":["1f6b5-1f3fe"],":mountain_bicyclist_tone3:":["1f6b5-1f3fd"],":mountain_bicyclist_tone2:":["1f6b5-1f3fc"],":mountain_bicyclist_tone1:":["1f6b5-1f3fb"],":bicyclist_tone5:":["1f6b4-1f3ff"],":bicyclist_tone4:":["1f6b4-1f3fe"],":bicyclist_tone3:":["1f6b4-1f3fd"],":bicyclist_tone2:":["1f6b4-1f3fc"],":bicyclist_tone1:":["1f6b4-1f3fb"],":rowboat_tone5:":["1f6a3-1f3ff"],":rowboat_tone4:":["1f6a3-1f3fe"],":rowboat_tone3:":["1f6a3-1f3fd"],":rowboat_tone2:":["1f6a3-1f3fc"],":rowboat_tone1:":["1f6a3-1f3fb"],":pray_tone5:":["1f64f-1f3ff"],":pray_tone4:":["1f64f-1f3fe"],":pray_tone3:":["1f64f-1f3fd"],":pray_tone2:":["1f64f-1f3fc"],":pray_tone1:":["1f64f-1f3fb"],":person_with_pouting_face_tone5:":["1f64e-1f3ff"],":person_with_pouting_face_tone4:":["1f64e-1f3fe"],":person_with_pouting_face_tone3:":["1f64e-1f3fd"],":person_with_pouting_face_tone2:":["1f64e-1f3fc"],":person_with_pouting_face_tone1:":["1f64e-1f3fb"],":person_frowning_tone5:":["1f64d-1f3ff"],":person_frowning_tone4:":["1f64d-1f3fe"],":person_frowning_tone3:":["1f64d-1f3fd"],":person_frowning_tone2:":["1f64d-1f3fc"],":person_frowning_tone1:":["1f64d-1f3fb"],":raised_hands_tone5:":["1f64c-1f3ff"],":raised_hands_tone4:":["1f64c-1f3fe"],":raised_hands_tone3:":["1f64c-1f3fd"],":raised_hands_tone2:":["1f64c-1f3fc"],":raised_hands_tone1:":["1f64c-1f3fb"],":raising_hand_tone5:":["1f64b-1f3ff"],":raising_hand_tone4:":["1f64b-1f3fe"],":raising_hand_tone3:":["1f64b-1f3fd"],":raising_hand_tone2:":["1f64b-1f3fc"],":raising_hand_tone1:":["1f64b-1f3fb"],":bow_tone5:":["1f647-1f3ff"],":bow_tone4:":["1f647-1f3fe"],":bow_tone3:":["1f647-1f3fd"],":bow_tone2:":["1f647-1f3fc"],":bow_tone1:":["1f647-1f3fb"],":ok_woman_tone5:":["1f646-1f3ff"],":ok_woman_tone4:":["1f646-1f3fe"],":ok_woman_tone3:":["1f646-1f3fd"],":ok_woman_tone2:":["1f646-1f3fc"],":ok_woman_tone1:":["1f646-1f3fb"],":no_good_tone5:":["1f645-1f3ff"],":no_good_tone4:":["1f645-1f3fe"],":no_good_tone3:":["1f645-1f3fd"],":no_good_tone2:":["1f645-1f3fc"],":no_good_tone1:":["1f645-1f3fb"],":vulcan_tone5:":["1f596-1f3ff"],":raised_hand_with_part_between_middle_and_ring_fingers_tone5:":["1f596-1f3ff"],":vulcan_tone4:":["1f596-1f3fe"],":raised_hand_with_part_between_middle_and_ring_fingers_tone4:":["1f596-1f3fe"],":vulcan_tone3:":["1f596-1f3fd"],":raised_hand_with_part_between_middle_and_ring_fingers_tone3:":["1f596-1f3fd"],":vulcan_tone2:":["1f596-1f3fc"],":raised_hand_with_part_between_middle_and_ring_fingers_tone2:":["1f596-1f3fc"],":vulcan_tone1:":["1f596-1f3fb"],":raised_hand_with_part_between_middle_and_ring_fingers_tone1:":["1f596-1f3fb"],":middle_finger_tone5:":["1f595-1f3ff"],":reversed_hand_with_middle_finger_extended_tone5:":["1f595-1f3ff"],":middle_finger_tone4:":["1f595-1f3fe"],":reversed_hand_with_middle_finger_extended_tone4:":["1f595-1f3fe"],":middle_finger_tone3:":["1f595-1f3fd"],":reversed_hand_with_middle_finger_extended_tone3:":["1f595-1f3fd"],":middle_finger_tone2:":["1f595-1f3fc"],":reversed_hand_with_middle_finger_extended_tone2:":["1f595-1f3fc"],":middle_finger_tone1:":["1f595-1f3fb"],":reversed_hand_with_middle_finger_extended_tone1:":["1f595-1f3fb"],":hand_splayed_tone5:":["1f590-1f3ff"],":raised_hand_with_fingers_splayed_tone5:":["1f590-1f3ff"],":hand_splayed_tone4:":["1f590-1f3fe"],":raised_hand_with_fingers_splayed_tone4:":["1f590-1f3fe"],
":hand_splayed_tone3:":["1f590-1f3fd"],":raised_hand_with_fingers_splayed_tone3:":["1f590-1f3fd"],":hand_splayed_tone2:":["1f590-1f3fc"],":raised_hand_with_fingers_splayed_tone2:":["1f590-1f3fc"],":hand_splayed_tone1:":["1f590-1f3fb"],":raised_hand_with_fingers_splayed_tone1:":["1f590-1f3fb"],":spy_tone5:":["1f575-1f3ff"],":sleuth_or_spy_tone5:":["1f575-1f3ff"],":spy_tone4:":["1f575-1f3fe"],":sleuth_or_spy_tone4:":["1f575-1f3fe"],":spy_tone3:":["1f575-1f3fd"],":sleuth_or_spy_tone3:":["1f575-1f3fd"],":spy_tone2:":["1f575-1f3fc"],":sleuth_or_spy_tone2:":["1f575-1f3fc"],":spy_tone1:":["1f575-1f3fb"],":sleuth_or_spy_tone1:":["1f575-1f3fb"],":muscle_tone5:":["1f4aa-1f3ff"],":muscle_tone4:":["1f4aa-1f3fe"],":muscle_tone3:":["1f4aa-1f3fd"],":muscle_tone2:":["1f4aa-1f3fc"],":muscle_tone1:":["1f4aa-1f3fb"],":haircut_tone5:":["1f487-1f3ff"],":haircut_tone4:":["1f487-1f3fe"],":haircut_tone3:":["1f487-1f3fd"],":haircut_tone2:":["1f487-1f3fc"],":haircut_tone1:":["1f487-1f3fb"],":massage_tone5:":["1f486-1f3ff"],":massage_tone4:":["1f486-1f3fe"],":massage_tone3:":["1f486-1f3fd"],":massage_tone2:":["1f486-1f3fc"],":massage_tone1:":["1f486-1f3fb"],":nail_care_tone5:":["1f485-1f3ff"],":nail_care_tone4:":["1f485-1f3fe"],":nail_care_tone3:":["1f485-1f3fd"],":nail_care_tone2:":["1f485-1f3fc"],":nail_care_tone1:":["1f485-1f3fb"],":dancer_tone5:":["1f483-1f3ff"],":dancer_tone4:":["1f483-1f3fe"],":dancer_tone3:":["1f483-1f3fd"],":dancer_tone2:":["1f483-1f3fc"],":dancer_tone1:":["1f483-1f3fb"],":guardsman_tone5:":["1f482-1f3ff"],":guardsman_tone4:":["1f482-1f3fe"],":guardsman_tone3:":["1f482-1f3fd"],":guardsman_tone2:":["1f482-1f3fc"],":guardsman_tone1:":["1f482-1f3fb"],":information_desk_person_tone5:":["1f481-1f3ff"],":information_desk_person_tone4:":["1f481-1f3fe"],":information_desk_person_tone3:":["1f481-1f3fd"],":information_desk_person_tone2:":["1f481-1f3fc"],":information_desk_person_tone1:":["1f481-1f3fb"],":angel_tone5:":["1f47c-1f3ff"],":angel_tone4:":["1f47c-1f3fe"],":angel_tone3:":["1f47c-1f3fd"],":angel_tone2:":["1f47c-1f3fc"],":angel_tone1:":["1f47c-1f3fb"],":princess_tone5:":["1f478-1f3ff"],":princess_tone4:":["1f478-1f3fe"],":princess_tone3:":["1f478-1f3fd"],":princess_tone2:":["1f478-1f3fc"],":princess_tone1:":["1f478-1f3fb"],":construction_worker_tone5:":["1f477-1f3ff"],":construction_worker_tone4:":["1f477-1f3fe"],":construction_worker_tone3:":["1f477-1f3fd"],":construction_worker_tone2:":["1f477-1f3fc"],":construction_worker_tone1:":["1f477-1f3fb"],":baby_tone5:":["1f476-1f3ff"],":baby_tone4:":["1f476-1f3fe"],":baby_tone3:":["1f476-1f3fd"],":baby_tone2:":["1f476-1f3fc"],":baby_tone1:":["1f476-1f3fb"],":older_woman_tone5:":["1f475-1f3ff"],":grandma_tone5:":["1f475-1f3ff"],":older_woman_tone4:":["1f475-1f3fe"],":grandma_tone4:":["1f475-1f3fe"],":older_woman_tone3:":["1f475-1f3fd"],":grandma_tone3:":["1f475-1f3fd"],":older_woman_tone2:":["1f475-1f3fc"],":grandma_tone2:":["1f475-1f3fc"],":older_woman_tone1:":["1f475-1f3fb"],":grandma_tone1:":["1f475-1f3fb"],":older_man_tone5:":["1f474-1f3ff"],":older_man_tone4:":["1f474-1f3fe"],":older_man_tone3:":["1f474-1f3fd"],":older_man_tone2:":["1f474-1f3fc"],":older_man_tone1:":["1f474-1f3fb"],":man_with_turban_tone5:":["1f473-1f3ff"],":man_with_turban_tone4:":["1f473-1f3fe"],":man_with_turban_tone3:":["1f473-1f3fd"],":man_with_turban_tone2:":["1f473-1f3fc"],":man_with_turban_tone1:":["1f473-1f3fb"],":man_with_gua_pi_mao_tone5:":["1f472-1f3ff"],":man_with_gua_pi_mao_tone4:":["1f472-1f3fe"],":man_with_gua_pi_mao_tone3:":["1f472-1f3fd"],":man_with_gua_pi_mao_tone2:":["1f472-1f3fc"],":man_with_gua_pi_mao_tone1:":["1f472-1f3fb"],":person_with_blond_hair_tone5:":["1f471-1f3ff"],":person_with_blond_hair_tone4:":["1f471-1f3fe"],":person_with_blond_hair_tone3:":["1f471-1f3fd"],":person_with_blond_hair_tone2:":["1f471-1f3fc"],":person_with_blond_hair_tone1:":["1f471-1f3fb"],":bride_with_veil_tone5:":["1f470-1f3ff"],":bride_with_veil_tone4:":["1f470-1f3fe"],":bride_with_veil_tone3:":["1f470-1f3fd"],":bride_with_veil_tone2:":["1f470-1f3fc"],":bride_with_veil_tone1:":["1f470-1f3fb"],":cop_tone5:":["1f46e-1f3ff"],":cop_tone4:":["1f46e-1f3fe"],":cop_tone3:":["1f46e-1f3fd"],":cop_tone2:":["1f46e-1f3fc"],":cop_tone1:":["1f46e-1f3fb"],":woman_tone5:":["1f469-1f3ff"],":woman_tone4:":["1f469-1f3fe"],":woman_tone3:":["1f469-1f3fd"],":woman_tone2:":["1f469-1f3fc"],":woman_tone1:":["1f469-1f3fb"],":man_tone5:":["1f468-1f3ff"],":man_tone4:":["1f468-1f3fe"],":man_tone3:":["1f468-1f3fd"],":man_tone2:":["1f468-1f3fc"],":man_tone1:":["1f468-1f3fb"],":girl_tone5:":["1f467-1f3ff"],":girl_tone4:":["1f467-1f3fe"],":girl_tone3:":["1f467-1f3fd"],":girl_tone2:":["1f467-1f3fc"],":girl_tone1:":["1f467-1f3fb"],":boy_tone5:":["1f466-1f3ff"],":boy_tone4:":["1f466-1f3fe"],":boy_tone3:":["1f466-1f3fd"],":boy_tone2:":["1f466-1f3fc"],":boy_tone1:":["1f466-1f3fb"],":open_hands_tone5:":["1f450-1f3ff"],":open_hands_tone4:":["1f450-1f3fe"],":open_hands_tone3:":["1f450-1f3fd"],":open_hands_tone2:":["1f450-1f3fc"],":open_hands_tone1:":["1f450-1f3fb"],":clap_tone5:":["1f44f-1f3ff"],":clap_tone4:":["1f44f-1f3fe"],":clap_tone3:":["1f44f-1f3fd"],":clap_tone2:":["1f44f-1f3fc"],":clap_tone1:":["1f44f-1f3fb"],":thumbsdown_tone5:":["1f44e-1f3ff"],":-1_tone5:":["1f44e-1f3ff"],":thumbsdown_tone4:":["1f44e-1f3fe"],":-1_tone4:":["1f44e-1f3fe"],":thumbsdown_tone3:":["1f44e-1f3fd"],":-1_tone3:":["1f44e-1f3fd"],":thumbsdown_tone2:":["1f44e-1f3fc"],":-1_tone2:":["1f44e-1f3fc"],":thumbsdown_tone1:":["1f44e-1f3fb"],":-1_tone1:":["1f44e-1f3fb"],":thumbsup_tone5:":["1f44d-1f3ff"],":+1_tone5:":["1f44d-1f3ff"],":thumbsup_tone4:":["1f44d-1f3fe"],":+1_tone4:":["1f44d-1f3fe"],":thumbsup_tone3:":["1f44d-1f3fd"],":+1_tone3:":["1f44d-1f3fd"],":thumbsup_tone2:":["1f44d-1f3fc"],":+1_tone2:":["1f44d-1f3fc"],":thumbsup_tone1:":["1f44d-1f3fb"],":+1_tone1:":["1f44d-1f3fb"],":ok_hand_tone5:":["1f44c-1f3ff"],":ok_hand_tone4:":["1f44c-1f3fe"],":ok_hand_tone3:":["1f44c-1f3fd"],":ok_hand_tone2:":["1f44c-1f3fc"],":ok_hand_tone1:":["1f44c-1f3fb"],":wave_tone5:":["1f44b-1f3ff"],":wave_tone4:":["1f44b-1f3fe"],":wave_tone3:":["1f44b-1f3fd"],":wave_tone2:":["1f44b-1f3fc"],":wave_tone1:":["1f44b-1f3fb"],":punch_tone5:":["1f44a-1f3ff"],":punch_tone4:":["1f44a-1f3fe"],":punch_tone3:":["1f44a-1f3fd"],":punch_tone2:":["1f44a-1f3fc"],":punch_tone1:":["1f44a-1f3fb"],":point_right_tone5:":["1f449-1f3ff"],":point_right_tone4:":["1f449-1f3fe"],":point_right_tone3:":["1f449-1f3fd"],":point_right_tone2:":["1f449-1f3fc"],":point_right_tone1:":["1f449-1f3fb"],":point_left_tone5:":["1f448-1f3ff"],":point_left_tone4:":["1f448-1f3fe"],":point_left_tone3:":["1f448-1f3fd"],":point_left_tone2:":["1f448-1f3fc"],":point_left_tone1:":["1f448-1f3fb"],":point_down_tone5:":["1f447-1f3ff"],":point_down_tone4:":["1f447-1f3fe"],":point_down_tone3:":["1f447-1f3fd"],":point_down_tone2:":["1f447-1f3fc"],":point_down_tone1:":["1f447-1f3fb"],":point_up_2_tone5:":["1f446-1f3ff"],":point_up_2_tone4:":["1f446-1f3fe"],":point_up_2_tone3:":["1f446-1f3fd"],":point_up_2_tone2:":["1f446-1f3fc"],":point_up_2_tone1:":["1f446-1f3fb"],":nose_tone5:":["1f443-1f3ff"],":nose_tone4:":["1f443-1f3fe"],":nose_tone3:":["1f443-1f3fd"],":nose_tone2:":["1f443-1f3fc"],":nose_tone1:":["1f443-1f3fb"],":ear_tone5:":["1f442-1f3ff"],":ear_tone4:":["1f442-1f3fe"],":ear_tone3:":["1f442-1f3fd"],":ear_tone2:":["1f442-1f3fc"],":ear_tone1:":["1f442-1f3fb"],":lifter_tone5:":["1f3cb-1f3ff"],":weight_lifter_tone5:":["1f3cb-1f3ff"],":lifter_tone4:":["1f3cb-1f3fe"],":weight_lifter_tone4:":["1f3cb-1f3fe"],":lifter_tone3:":["1f3cb-1f3fd"],":weight_lifter_tone3:":["1f3cb-1f3fd"],":lifter_tone2:":["1f3cb-1f3fc"],":weight_lifter_tone2:":["1f3cb-1f3fc"],":lifter_tone1:":["1f3cb-1f3fb"],":weight_lifter_tone1:":["1f3cb-1f3fb"],":swimmer_tone5:":["1f3ca-1f3ff"],":swimmer_tone4:":["1f3ca-1f3fe"],":swimmer_tone3:":["1f3ca-1f3fd"],":swimmer_tone2:":["1f3ca-1f3fc"],":swimmer_tone1:":["1f3ca-1f3fb"],":horse_racing_tone5:":["1f3c7-1f3ff"],":horse_racing_tone4:":["1f3c7-1f3fe"],":horse_racing_tone3:":["1f3c7-1f3fd"],":horse_racing_tone2:":["1f3c7-1f3fc"],":horse_racing_tone1:":["1f3c7-1f3fb"],":surfer_tone5:":["1f3c4-1f3ff"],":surfer_tone4:":["1f3c4-1f3fe"],":surfer_tone3:":["1f3c4-1f3fd"],":surfer_tone2:":["1f3c4-1f3fc"],":surfer_tone1:":["1f3c4-1f3fb"],":runner_tone5:":["1f3c3-1f3ff"],":runner_tone4:":["1f3c3-1f3fe"],":runner_tone3:":["1f3c3-1f3fd"],":runner_tone2:":["1f3c3-1f3fc"],":runner_tone1:":["1f3c3-1f3fb"],":santa_tone5:":["1f385-1f3ff"],":santa_tone4:":["1f385-1f3fe"],":santa_tone3:":["1f385-1f3fd"],":santa_tone2:":["1f385-1f3fc"],":santa_tone1:":["1f385-1f3fb"],":flag_zw:":["1f1ff-1f1fc"],":zw:":["1f1ff-1f1fc"],":flag_zm:":["1f1ff-1f1f2"],":zm:":["1f1ff-1f1f2"],":flag_za:":["1f1ff-1f1e6"],":za:":["1f1ff-1f1e6"],":flag_yt:":["1f1fe-1f1f9"],":yt:":["1f1fe-1f1f9"],":flag_ye:":["1f1fe-1f1ea"],":ye:":["1f1fe-1f1ea"],":flag_xk:":["1f1fd-1f1f0"],":xk:":["1f1fd-1f1f0"],":flag_ws:":["1f1fc-1f1f8"],":ws:":["1f1fc-1f1f8"],":flag_wf:":["1f1fc-1f1eb"],":wf:":["1f1fc-1f1eb"],":flag_vu:":["1f1fb-1f1fa"],":vu:":["1f1fb-1f1fa"],":flag_vn:":["1f1fb-1f1f3"],":vn:":["1f1fb-1f1f3"],":flag_vi:":["1f1fb-1f1ee"],":vi:":["1f1fb-1f1ee"],":flag_vg:":["1f1fb-1f1ec"],":vg:":["1f1fb-1f1ec"],":flag_ve:":["1f1fb-1f1ea"],":ve:":["1f1fb-1f1ea"],":flag_vc:":["1f1fb-1f1e8"],":vc:":["1f1fb-1f1e8"],":flag_va:":["1f1fb-1f1e6"],":va:":["1f1fb-1f1e6"],":flag_uz:":["1f1fa-1f1ff"],":uz:":["1f1fa-1f1ff"],":flag_uy:":["1f1fa-1f1fe"],":uy:":["1f1fa-1f1fe"],":flag_us:":["1f1fa-1f1f8"],":us:":["1f1fa-1f1f8"],":flag_um:":["1f1fa-1f1f2"],":um:":["1f1fa-1f1f2"],":flag_ug:":["1f1fa-1f1ec"],":ug:":["1f1fa-1f1ec"],":flag_ua:":["1f1fa-1f1e6"],":ua:":["1f1fa-1f1e6"],":flag_tz:":["1f1f9-1f1ff"],":tz:":["1f1f9-1f1ff"],":flag_tw:":["1f1f9-1f1fc"],":tw:":["1f1f9-1f1fc"],":flag_tv:":["1f1f9-1f1fb"],":tuvalu:":["1f1f9-1f1fb"],":flag_tt:":["1f1f9-1f1f9"],":tt:":["1f1f9-1f1f9"],":flag_tr:":["1f1f9-1f1f7"],":tr:":["1f1f9-1f1f7"],":flag_to:":["1f1f9-1f1f4"],":to:":["1f1f9-1f1f4"],":flag_tn:":["1f1f9-1f1f3"],":tn:":["1f1f9-1f1f3"],":flag_tm:":["1f1f9-1f1f2"],":turkmenistan:":["1f1f9-1f1f2"],":flag_tl:":["1f1f9-1f1f1"],":tl:":["1f1f9-1f1f1"],":flag_tk:":["1f1f9-1f1f0"],":tk:":["1f1f9-1f1f0"],":flag_tj:":["1f1f9-1f1ef"],":tj:":["1f1f9-1f1ef"],":flag_th:":["1f1f9-1f1ed"],":th:":["1f1f9-1f1ed"],":flag_tg:":["1f1f9-1f1ec"],":tg:":["1f1f9-1f1ec"],":flag_tf:":["1f1f9-1f1eb"],":tf:":["1f1f9-1f1eb"],":flag_td:":["1f1f9-1f1e9"],":td:":["1f1f9-1f1e9"],":flag_tc:":["1f1f9-1f1e8"],":tc:":["1f1f9-1f1e8"],":flag_ta:":["1f1f9-1f1e6"],":ta:":["1f1f9-1f1e6"],":flag_sz:":["1f1f8-1f1ff"],":sz:":["1f1f8-1f1ff"],":flag_sy:":["1f1f8-1f1fe"],":sy:":["1f1f8-1f1fe"],":flag_sx:":["1f1f8-1f1fd"],":sx:":["1f1f8-1f1fd"],":flag_sv:":["1f1f8-1f1fb"],":sv:":["1f1f8-1f1fb"],":flag_st:":["1f1f8-1f1f9"],":st:":["1f1f8-1f1f9"],":flag_ss:":["1f1f8-1f1f8"],":ss:":["1f1f8-1f1f8"],":flag_sr:":["1f1f8-1f1f7"],":sr:":["1f1f8-1f1f7"],":flag_so:":["1f1f8-1f1f4"],":so:":["1f1f8-1f1f4"],":flag_sn:":["1f1f8-1f1f3"],":sn:":["1f1f8-1f1f3"],":flag_sm:":["1f1f8-1f1f2"],":sm:":["1f1f8-1f1f2"],":flag_sl:":["1f1f8-1f1f1"],":sl:":["1f1f8-1f1f1"],":flag_sk:":["1f1f8-1f1f0"],":sk:":["1f1f8-1f1f0"],":flag_sj:":["1f1f8-1f1ef"],":sj:":["1f1f8-1f1ef"],":flag_si:":["1f1f8-1f1ee"],":si:":["1f1f8-1f1ee"],":flag_sh:":["1f1f8-1f1ed"],":sh:":["1f1f8-1f1ed"],":flag_sg:":["1f1f8-1f1ec"],":sg:":["1f1f8-1f1ec"],":flag_se:":["1f1f8-1f1ea"],":se:":["1f1f8-1f1ea"],":flag_sd:":["1f1f8-1f1e9"],":sd:":["1f1f8-1f1e9"],":flag_sc:":["1f1f8-1f1e8"],":sc:":["1f1f8-1f1e8"],":flag_sb:":["1f1f8-1f1e7"],":sb:":["1f1f8-1f1e7"],":flag_sa:":["1f1f8-1f1e6"],":saudiarabia:":["1f1f8-1f1e6"],":saudi:":["1f1f8-1f1e6"],":flag_rw:":["1f1f7-1f1fc"],":rw:":["1f1f7-1f1fc"],":flag_ru:":["1f1f7-1f1fa"],":ru:":["1f1f7-1f1fa"],":flag_rs:":["1f1f7-1f1f8"],":rs:":["1f1f7-1f1f8"],":flag_ro:":["1f1f7-1f1f4"],":ro:":["1f1f7-1f1f4"],":flag_re:":["1f1f7-1f1ea"],":re:":["1f1f7-1f1ea"],":flag_qa:":["1f1f6-1f1e6"],":qa:":["1f1f6-1f1e6"],":flag_py:":["1f1f5-1f1fe"],":py:":["1f1f5-1f1fe"],":flag_pw:":["1f1f5-1f1fc"],":pw:":["1f1f5-1f1fc"],":flag_pt:":["1f1f5-1f1f9"],":pt:":["1f1f5-1f1f9"],":flag_ps:":["1f1f5-1f1f8"],":ps:":["1f1f5-1f1f8"],":flag_pr:":["1f1f5-1f1f7"],":pr:":["1f1f5-1f1f7"],":flag_pn:":["1f1f5-1f1f3"],":pn:":["1f1f5-1f1f3"],":flag_pm:":["1f1f5-1f1f2"],":pm:":["1f1f5-1f1f2"],":flag_pl:":["1f1f5-1f1f1"],":pl:":["1f1f5-1f1f1"],":flag_pk:":["1f1f5-1f1f0"],":pk:":["1f1f5-1f1f0"],":flag_ph:":["1f1f5-1f1ed"],":ph:":["1f1f5-1f1ed"],":flag_pg:":["1f1f5-1f1ec"],":pg:":["1f1f5-1f1ec"],":flag_pf:":["1f1f5-1f1eb"],":pf:":["1f1f5-1f1eb"],":flag_pe:":["1f1f5-1f1ea"],":pe:":["1f1f5-1f1ea"],":flag_pa:":["1f1f5-1f1e6"],":pa:":["1f1f5-1f1e6"],":flag_om:":["1f1f4-1f1f2"],":om:":["1f1f4-1f1f2"],":flag_nz:":["1f1f3-1f1ff"],":nz:":["1f1f3-1f1ff"],":flag_nu:":["1f1f3-1f1fa"],":nu:":["1f1f3-1f1fa"],":flag_nr:":["1f1f3-1f1f7"],":nr:":["1f1f3-1f1f7"],":flag_np:":["1f1f3-1f1f5"],":np:":["1f1f3-1f1f5"],":flag_no:":["1f1f3-1f1f4"],":no:":["1f1f3-1f1f4"],":flag_nl:":["1f1f3-1f1f1"],":nl:":["1f1f3-1f1f1"],":flag_ni:":["1f1f3-1f1ee"],":ni:":["1f1f3-1f1ee"],":flag_ng:":["1f1f3-1f1ec"],":nigeria:":["1f1f3-1f1ec"],":flag_nf:":["1f1f3-1f1eb"],":nf:":["1f1f3-1f1eb"],":flag_ne:":["1f1f3-1f1ea"],":ne:":["1f1f3-1f1ea"],":flag_nc:":["1f1f3-1f1e8"],":nc:":["1f1f3-1f1e8"],":flag_na:":["1f1f3-1f1e6"],":na:":["1f1f3-1f1e6"],":flag_mz:":["1f1f2-1f1ff"],":mz:":["1f1f2-1f1ff"],":flag_my:":["1f1f2-1f1fe"],":my:":["1f1f2-1f1fe"],":flag_mx:":["1f1f2-1f1fd"],":mx:":["1f1f2-1f1fd"],":flag_mw:":["1f1f2-1f1fc"],":mw:":["1f1f2-1f1fc"],":flag_mv:":["1f1f2-1f1fb"],":mv:":["1f1f2-1f1fb"],":flag_mu:":["1f1f2-1f1fa"],":mu:":["1f1f2-1f1fa"],":flag_mt:":["1f1f2-1f1f9"],":mt:":["1f1f2-1f1f9"],":flag_ms:":["1f1f2-1f1f8"],":ms:":["1f1f2-1f1f8"],":flag_mr:":["1f1f2-1f1f7"],":mr:":["1f1f2-1f1f7"],":flag_mq:":["1f1f2-1f1f6"],":mq:":["1f1f2-1f1f6"],":flag_mp:":["1f1f2-1f1f5"],":mp:":["1f1f2-1f1f5"],":flag_mo:":["1f1f2-1f1f4"],":mo:":["1f1f2-1f1f4"],":flag_mn:":["1f1f2-1f1f3"],":mn:":["1f1f2-1f1f3"],":flag_mm:":["1f1f2-1f1f2"],":mm:":["1f1f2-1f1f2"],":flag_ml:":["1f1f2-1f1f1"],":ml:":["1f1f2-1f1f1"],":flag_mk:":["1f1f2-1f1f0"],":mk:":["1f1f2-1f1f0"],":flag_mh:":["1f1f2-1f1ed"],":mh:":["1f1f2-1f1ed"],":flag_mg:":["1f1f2-1f1ec"],":mg:":["1f1f2-1f1ec"],":flag_mf:":["1f1f2-1f1eb"],":mf:":["1f1f2-1f1eb"],":flag_me:":["1f1f2-1f1ea"],":me:":["1f1f2-1f1ea"],":flag_md:":["1f1f2-1f1e9"],":md:":["1f1f2-1f1e9"],":flag_mc:":["1f1f2-1f1e8"],":mc:":["1f1f2-1f1e8"],":flag_ma:":["1f1f2-1f1e6"],":ma:":["1f1f2-1f1e6"],":flag_ly:":["1f1f1-1f1fe"],":ly:":["1f1f1-1f1fe"],":flag_lv:":["1f1f1-1f1fb"],":lv:":["1f1f1-1f1fb"],":flag_lu:":["1f1f1-1f1fa"],":lu:":["1f1f1-1f1fa"],":flag_lt:":["1f1f1-1f1f9"],":lt:":["1f1f1-1f1f9"],":flag_ls:":["1f1f1-1f1f8"],":ls:":["1f1f1-1f1f8"],":flag_lr:":["1f1f1-1f1f7"],":lr:":["1f1f1-1f1f7"],":flag_lk:":["1f1f1-1f1f0"],":lk:":["1f1f1-1f1f0"],":flag_li:":["1f1f1-1f1ee"],":li:":["1f1f1-1f1ee"],":flag_lc:":["1f1f1-1f1e8"],":lc:":["1f1f1-1f1e8"],":flag_lb:":["1f1f1-1f1e7"],":lb:":["1f1f1-1f1e7"],":flag_la:":["1f1f1-1f1e6"],":la:":["1f1f1-1f1e6"],":flag_kz:":["1f1f0-1f1ff"],":kz:":["1f1f0-1f1ff"],":flag_ky:":["1f1f0-1f1fe"],":ky:":["1f1f0-1f1fe"],":flag_kw:":["1f1f0-1f1fc"],":kw:":["1f1f0-1f1fc"],":flag_kr:":["1f1f0-1f1f7"],":kr:":["1f1f0-1f1f7"],":flag_kp:":["1f1f0-1f1f5"],":kp:":["1f1f0-1f1f5"],":flag_kn:":["1f1f0-1f1f3"],":kn:":["1f1f0-1f1f3"],":flag_km:":["1f1f0-1f1f2"],":km:":["1f1f0-1f1f2"],":flag_ki:":["1f1f0-1f1ee"],":ki:":["1f1f0-1f1ee"],":flag_kh:":["1f1f0-1f1ed"],":kh:":["1f1f0-1f1ed"],":flag_kg:":["1f1f0-1f1ec"],":kg:":["1f1f0-1f1ec"],":flag_ke:":["1f1f0-1f1ea"],":ke:":["1f1f0-1f1ea"],":flag_jp:":["1f1ef-1f1f5"],":jp:":["1f1ef-1f1f5"],":flag_jo:":["1f1ef-1f1f4"],":jo:":["1f1ef-1f1f4"],":flag_jm:":["1f1ef-1f1f2"],":jm:":["1f1ef-1f1f2"],":flag_je:":["1f1ef-1f1ea"],":je:":["1f1ef-1f1ea"],":flag_it:":["1f1ee-1f1f9"],":it:":["1f1ee-1f1f9"],":flag_is:":["1f1ee-1f1f8"],":is:":["1f1ee-1f1f8"],":flag_ir:":["1f1ee-1f1f7"],":ir:":["1f1ee-1f1f7"],":flag_iq:":["1f1ee-1f1f6"],":iq:":["1f1ee-1f1f6"],":flag_io:":["1f1ee-1f1f4"],":io:":["1f1ee-1f1f4"],":flag_in:":["1f1ee-1f1f3"],":in:":["1f1ee-1f1f3"],":flag_im:":["1f1ee-1f1f2"],":im:":["1f1ee-1f1f2"],":flag_il:":["1f1ee-1f1f1"],":il:":["1f1ee-1f1f1"],":flag_ie:":["1f1ee-1f1ea"],":ie:":["1f1ee-1f1ea"],":flag_id:":["1f1ee-1f1e9"],":indonesia:":["1f1ee-1f1e9"],":flag_ic:":["1f1ee-1f1e8"],":ic:":["1f1ee-1f1e8"],":flag_hu:":["1f1ed-1f1fa"],":hu:":["1f1ed-1f1fa"],":flag_ht:":["1f1ed-1f1f9"],":ht:":["1f1ed-1f1f9"],":flag_hr:":["1f1ed-1f1f7"],":hr:":["1f1ed-1f1f7"],":flag_hn:":["1f1ed-1f1f3"],":hn:":["1f1ed-1f1f3"],":flag_hm:":["1f1ed-1f1f2"],":hm:":["1f1ed-1f1f2"],":flag_hk:":["1f1ed-1f1f0"],":hk:":["1f1ed-1f1f0"],":flag_gy:":["1f1ec-1f1fe"],":gy:":["1f1ec-1f1fe"],":flag_gw:":["1f1ec-1f1fc"],":gw:":["1f1ec-1f1fc"],":flag_gu:":["1f1ec-1f1fa"],":gu:":["1f1ec-1f1fa"],":flag_gt:":["1f1ec-1f1f9"],":gt:":["1f1ec-1f1f9"],":flag_gs:":["1f1ec-1f1f8"],":gs:":["1f1ec-1f1f8"],":flag_gr:":["1f1ec-1f1f7"],":gr:":["1f1ec-1f1f7"],":flag_gq:":["1f1ec-1f1f6"],":gq:":["1f1ec-1f1f6"],":flag_gp:":["1f1ec-1f1f5"],":gp:":["1f1ec-1f1f5"],":flag_gn:":["1f1ec-1f1f3"],":gn:":["1f1ec-1f1f3"],":flag_gm:":["1f1ec-1f1f2"],":gm:":["1f1ec-1f1f2"],":flag_gl:":["1f1ec-1f1f1"],":gl:":["1f1ec-1f1f1"],":flag_gi:":["1f1ec-1f1ee"],":gi:":["1f1ec-1f1ee"],":flag_gh:":["1f1ec-1f1ed"],":gh:":["1f1ec-1f1ed"],":flag_gg:":["1f1ec-1f1ec"],":gg:":["1f1ec-1f1ec"],":flag_gf:":["1f1ec-1f1eb"],":gf:":["1f1ec-1f1eb"],":flag_ge:":["1f1ec-1f1ea"],":ge:":["1f1ec-1f1ea"],":flag_gd:":["1f1ec-1f1e9"],":gd:":["1f1ec-1f1e9"],":flag_gb:":["1f1ec-1f1e7"],":gb:":["1f1ec-1f1e7"],":flag_ga:":["1f1ec-1f1e6"],":ga:":["1f1ec-1f1e6"],":flag_fr:":["1f1eb-1f1f7"],":fr:":["1f1eb-1f1f7"],":flag_fo:":["1f1eb-1f1f4"],":fo:":["1f1eb-1f1f4"],":flag_fm:":["1f1eb-1f1f2"],":fm:":["1f1eb-1f1f2"],":flag_fk:":["1f1eb-1f1f0"],":fk:":["1f1eb-1f1f0"],":flag_fj:":["1f1eb-1f1ef"],":fj:":["1f1eb-1f1ef"],":flag_fi:":["1f1eb-1f1ee"],":fi:":["1f1eb-1f1ee"],":flag_eu:":["1f1ea-1f1fa"],":eu:":["1f1ea-1f1fa"],":flag_et:":["1f1ea-1f1f9"],":et:":["1f1ea-1f1f9"],":flag_es:":["1f1ea-1f1f8"],":es:":["1f1ea-1f1f8"],":flag_er:":["1f1ea-1f1f7"],":er:":["1f1ea-1f1f7"],":flag_eh:":["1f1ea-1f1ed"],":eh:":["1f1ea-1f1ed"],":flag_eg:":["1f1ea-1f1ec"],":eg:":["1f1ea-1f1ec"],":flag_ee:":["1f1ea-1f1ea"],":ee:":["1f1ea-1f1ea"],":flag_ec:":["1f1ea-1f1e8"],":ec:":["1f1ea-1f1e8"],":flag_ea:":["1f1ea-1f1e6"],":ea:":["1f1ea-1f1e6"],":flag_dz:":["1f1e9-1f1ff"],":dz:":["1f1e9-1f1ff"],":flag_do:":["1f1e9-1f1f4"],":do:":["1f1e9-1f1f4"],":flag_dm:":["1f1e9-1f1f2"],":dm:":["1f1e9-1f1f2"],":flag_dk:":["1f1e9-1f1f0"],":dk:":["1f1e9-1f1f0"],":flag_dj:":["1f1e9-1f1ef"],":dj:":["1f1e9-1f1ef"],":flag_dg:":["1f1e9-1f1ec"],":dg:":["1f1e9-1f1ec"],":flag_de:":["1f1e9-1f1ea"],":de:":["1f1e9-1f1ea"],":flag_cz:":["1f1e8-1f1ff"],":cz:":["1f1e8-1f1ff"],":flag_cy:":["1f1e8-1f1fe"],":cy:":["1f1e8-1f1fe"],":flag_cx:":["1f1e8-1f1fd"],":cx:":["1f1e8-1f1fd"],":flag_cw:":["1f1e8-1f1fc"],":cw:":["1f1e8-1f1fc"],":flag_cv:":["1f1e8-1f1fb"],":cv:":["1f1e8-1f1fb"],":flag_cu:":["1f1e8-1f1fa"],":cu:":["1f1e8-1f1fa"],":flag_cr:":["1f1e8-1f1f7"],":cr:":["1f1e8-1f1f7"],":flag_cp:":["1f1e8-1f1f5"],":cp:":["1f1e8-1f1f5"],":flag_co:":["1f1e8-1f1f4"],":co:":["1f1e8-1f1f4"],":flag_cn:":["1f1e8-1f1f3"],":cn:":["1f1e8-1f1f3"],":flag_cm:":["1f1e8-1f1f2"],":cm:":["1f1e8-1f1f2"],":flag_cl:":["1f1e8-1f1f1"],":chile:":["1f1e8-1f1f1"],":flag_ck:":["1f1e8-1f1f0"],":ck:":["1f1e8-1f1f0"],":flag_ci:":["1f1e8-1f1ee"],":ci:":["1f1e8-1f1ee"],":flag_ch:":["1f1e8-1f1ed"],":ch:":["1f1e8-1f1ed"],":flag_cg:":["1f1e8-1f1ec"],":cg:":["1f1e8-1f1ec"],":flag_cf:":["1f1e8-1f1eb"],":cf:":["1f1e8-1f1eb"],":flag_cd:":["1f1e8-1f1e9"],":congo:":["1f1e8-1f1e9"],":flag_cc:":["1f1e8-1f1e8"],":cc:":["1f1e8-1f1e8"],":flag_ca:":["1f1e8-1f1e6"],":ca:":["1f1e8-1f1e6"],":flag_bz:":["1f1e7-1f1ff"],":bz:":["1f1e7-1f1ff"],":flag_by:":["1f1e7-1f1fe"],":by:":["1f1e7-1f1fe"],":flag_bw:":["1f1e7-1f1fc"],":bw:":["1f1e7-1f1fc"],":flag_bv:":["1f1e7-1f1fb"],":bv:":["1f1e7-1f1fb"],":flag_bt:":["1f1e7-1f1f9"],":bt:":["1f1e7-1f1f9"],":flag_bs:":["1f1e7-1f1f8"],":bs:":["1f1e7-1f1f8"],":flag_br:":["1f1e7-1f1f7"],":br:":["1f1e7-1f1f7"],":flag_bq:":["1f1e7-1f1f6"],":bq:":["1f1e7-1f1f6"],":flag_bo:":["1f1e7-1f1f4"],":bo:":["1f1e7-1f1f4"],":flag_bn:":["1f1e7-1f1f3"],":bn:":["1f1e7-1f1f3"],":flag_bm:":["1f1e7-1f1f2"],":bm:":["1f1e7-1f1f2"],":flag_bl:":["1f1e7-1f1f1"],":bl:":["1f1e7-1f1f1"],":flag_bj:":["1f1e7-1f1ef"],":bj:":["1f1e7-1f1ef"],":flag_bi:":["1f1e7-1f1ee"],":bi:":["1f1e7-1f1ee"],":flag_bh:":["1f1e7-1f1ed"],":bh:":["1f1e7-1f1ed"],":flag_bg:":["1f1e7-1f1ec"],":bg:":["1f1e7-1f1ec"],":flag_bf:":["1f1e7-1f1eb"],":bf:":["1f1e7-1f1eb"],":flag_be:":["1f1e7-1f1ea"],":be:":["1f1e7-1f1ea"],":flag_bd:":["1f1e7-1f1e9"],":bd:":["1f1e7-1f1e9"],":flag_bb:":["1f1e7-1f1e7"],":bb:":["1f1e7-1f1e7"],":flag_ba:":["1f1e7-1f1e6"],":ba:":["1f1e7-1f1e6"],":flag_az:":["1f1e6-1f1ff"],":az:":["1f1e6-1f1ff"],":flag_ax:":["1f1e6-1f1fd"],":ax:":["1f1e6-1f1fd"],":flag_aw:":["1f1e6-1f1fc"],":aw:":["1f1e6-1f1fc"],":flag_au:":["1f1e6-1f1fa"],":au:":["1f1e6-1f1fa"],":flag_at:":["1f1e6-1f1f9"],":at:":["1f1e6-1f1f9"],":flag_as:":["1f1e6-1f1f8"],":as:":["1f1e6-1f1f8"],":flag_ar:":["1f1e6-1f1f7"],":ar:":["1f1e6-1f1f7"],":flag_aq:":["1f1e6-1f1f6"],":aq:":["1f1e6-1f1f6"],":flag_ao:":["1f1e6-1f1f4"],":ao:":["1f1e6-1f1f4"],":flag_am:":["1f1e6-1f1f2"],":am:":["1f1e6-1f1f2"],":flag_al:":["1f1e6-1f1f1"],":al:":["1f1e6-1f1f1"],":flag_ai:":["1f1e6-1f1ee"],":ai:":["1f1e6-1f1ee"],":flag_ag:":["1f1e6-1f1ec"],":ag:":["1f1e6-1f1ec"],":flag_af:":["1f1e6-1f1eb"],":af:":["1f1e6-1f1eb"],":flag_ae:":["1f1e6-1f1ea"],":ae:":["1f1e6-1f1ea"],":flag_ad:":["1f1e6-1f1e9"],":ad:":["1f1e6-1f1e9"],":flag_ac:":["1f1e6-1f1e8"],":ac:":["1f1e6-1f1e8"],":mahjong:":["1f004-fe0f","1f004"],":parking:":["1f17f-fe0f","1f17f"],":sa:":["1f202-fe0f","1f202"],":u7121:":["1f21a-fe0f","1f21a"],":u6307:":["1f22f-fe0f","1f22f"],":u6708:":["1f237-fe0f","1f237"],":film_frames:":["1f39e-fe0f","1f39e"],":tickets:":["1f39f-fe0f","1f39f"],":admission_tickets:":["1f39f-fe0f","1f39f"],":lifter:":["1f3cb-fe0f","1f3cb"],":weight_lifter:":["1f3cb-fe0f","1f3cb"],":golfer:":["1f3cc-fe0f","1f3cc"],":motorcycle:":["1f3cd-fe0f","1f3cd"],":racing_motorcycle:":["1f3cd-fe0f","1f3cd"],":race_car:":["1f3ce-fe0f","1f3ce"],":racing_car:":["1f3ce-fe0f","1f3ce"],":military_medal:":["1f396-fe0f","1f396"],":reminder_ribbon:":["1f397-fe0f","1f397"],":hot_pepper:":["1f336-fe0f","1f336"],":cloud_rain:":["1f327-fe0f","1f327"],":cloud_with_rain:":["1f327-fe0f","1f327"],":cloud_snow:":["1f328-fe0f","1f328"],":cloud_with_snow:":["1f328-fe0f","1f328"],":cloud_lightning:":["1f329-fe0f","1f329"],":cloud_with_lightning:":["1f329-fe0f","1f329"],":cloud_tornado:":["1f32a-fe0f","1f32a"],":cloud_with_tornado:":["1f32a-fe0f","1f32a"],":fog:":["1f32b-fe0f","1f32b"],":wind_blowing_face:":["1f32c-fe0f","1f32c"],":chipmunk:":["1f43f-fe0f","1f43f"],":spider:":["1f577-fe0f","1f577"],":spider_web:":["1f578-fe0f","1f578"],":thermometer:":["1f321-fe0f","1f321"],":microphone2:":["1f399-fe0f","1f399"],":studio_microphone:":["1f399-fe0f","1f399"],":level_slider:":["1f39a-fe0f","1f39a"],":control_knobs:":["1f39b-fe0f","1f39b"],":flag_white:":["1f3f3-fe0f","1f3f3"],":waving_white_flag:":["1f3f3-fe0f","1f3f3"],":rosette:":["1f3f5-fe0f","1f3f5"],":label:":["1f3f7-fe0f","1f3f7"],":projector:":["1f4fd-fe0f","1f4fd"],":film_projector:":["1f4fd-fe0f","1f4fd"],":om_symbol:":["1f549-fe0f","1f549"],":dove:":["1f54a-fe0f","1f54a"],":dove_of_peace:":["1f54a-fe0f","1f54a"],":candle:":["1f56f-fe0f","1f56f"],":clock:":["1f570-fe0f","1f570"],":mantlepiece_clock:":["1f570-fe0f","1f570"],":hole:":["1f573-fe0f","1f573"],":dark_sunglasses:":["1f576-fe0f","1f576"],":joystick:":["1f579-fe0f","1f579"],":paperclips:":["1f587-fe0f","1f587"],":linked_paperclips:":["1f587-fe0f","1f587"],":pen_ballpoint:":["1f58a-fe0f","1f58a"],":lower_left_ballpoint_pen:":["1f58a-fe0f","1f58a"],":pen_fountain:":["1f58b-fe0f","1f58b"],":lower_left_fountain_pen:":["1f58b-fe0f","1f58b"],":paintbrush:":["1f58c-fe0f","1f58c"],":lower_left_paintbrush:":["1f58c-fe0f","1f58c"],":crayon:":["1f58d-fe0f","1f58d"],":lower_left_crayon:":["1f58d-fe0f","1f58d"],":desktop:":["1f5a5-fe0f","1f5a5"],":desktop_computer:":["1f5a5-fe0f","1f5a5"],":printer:":["1f5a8-fe0f","1f5a8"],":trackball:":["1f5b2-fe0f","1f5b2"],":frame_photo:":["1f5bc-fe0f","1f5bc"],":frame_with_picture:":["1f5bc-fe0f","1f5bc"],":dividers:":["1f5c2-fe0f","1f5c2"],":card_index_dividers:":["1f5c2-fe0f","1f5c2"],":card_box:":["1f5c3-fe0f","1f5c3"],":card_file_box:":["1f5c3-fe0f","1f5c3"],":file_cabinet:":["1f5c4-fe0f","1f5c4"],":wastebasket:":["1f5d1-fe0f","1f5d1"],":notepad_spiral:":["1f5d2-fe0f","1f5d2"],":spiral_note_pad:":["1f5d2-fe0f","1f5d2"],":calendar_spiral:":["1f5d3-fe0f","1f5d3"],":spiral_calendar_pad:":["1f5d3-fe0f","1f5d3"],":compression:":["1f5dc-fe0f","1f5dc"],":key2:":["1f5dd-fe0f","1f5dd"],":old_key:":["1f5dd-fe0f","1f5dd"],":newspaper2:":["1f5de-fe0f","1f5de"],":rolled_up_newspaper:":["1f5de-fe0f","1f5de"],":dagger:":["1f5e1-fe0f","1f5e1"],":dagger_knife:":["1f5e1-fe0f","1f5e1"],":speaking_head:":["1f5e3-fe0f","1f5e3"],":speaking_head_in_silhouette:":["1f5e3-fe0f","1f5e3"],":anger_right:":["1f5ef-fe0f","1f5ef"],":right_anger_bubble:":["1f5ef-fe0f","1f5ef"],":ballot_box:":["1f5f3-fe0f","1f5f3"],":ballot_box_with_ballot:":["1f5f3-fe0f","1f5f3"],":map:":["1f5fa-fe0f","1f5fa"],":world_map:":["1f5fa-fe0f","1f5fa"],":tools:":["1f6e0-fe0f","1f6e0"],":hammer_and_wrench:":["1f6e0-fe0f","1f6e0"],":shield:":["1f6e1-fe0f","1f6e1"],":oil:":["1f6e2-fe0f","1f6e2"],":oil_drum:":["1f6e2-fe0f","1f6e2"],":satellite_orbital:":["1f6f0-fe0f","1f6f0"],":fork_knife_plate:":["1f37d-fe0f","1f37d"],":fork_and_knife_with_plate:":["1f37d-fe0f","1f37d"],":eye:":["1f441-fe0f","1f441"],":levitate:":["1f574-fe0f","1f574"],":man_in_business_suit_levitating:":["1f574-fe0f","1f574"],":spy:":["1f575-fe0f","1f575"],":sleuth_or_spy:":["1f575-fe0f","1f575"],":hand_splayed:":["1f590-fe0f","1f590"],":raised_hand_with_fingers_splayed:":["1f590-fe0f","1f590"],":mountain_snow:":["1f3d4-fe0f","1f3d4"],":snow_capped_mountain:":["1f3d4-fe0f","1f3d4"],":camping:":["1f3d5-fe0f","1f3d5"],":beach:":["1f3d6-fe0f","1f3d6"],":beach_with_umbrella:":["1f3d6-fe0f","1f3d6"],":construction_site:":["1f3d7-fe0f","1f3d7"],":building_construction:":["1f3d7-fe0f","1f3d7"],":homes:":["1f3d8-fe0f","1f3d8"],":house_buildings:":["1f3d8-fe0f","1f3d8"],":cityscape:":["1f3d9-fe0f","1f3d9"],":house_abandoned:":["1f3da-fe0f","1f3da"],":derelict_house_building:":["1f3da-fe0f","1f3da"],":classical_building:":["1f3db-fe0f","1f3db"],":desert:":["1f3dc-fe0f","1f3dc"],":island:":["1f3dd-fe0f","1f3dd"],":desert_island:":["1f3dd-fe0f","1f3dd"],":park:":["1f3de-fe0f","1f3de"],":national_park:":["1f3de-fe0f","1f3de"],":stadium:":["1f3df-fe0f","1f3df"],":couch:":["1f6cb-fe0f","1f6cb"],":couch_and_lamp:":["1f6cb-fe0f","1f6cb"],":shopping_bags:":["1f6cd-fe0f","1f6cd"],":bellhop:":["1f6ce-fe0f","1f6ce"],":bellhop_bell:":["1f6ce-fe0f","1f6ce"],":bed:":["1f6cf-fe0f","1f6cf"],":motorway:":["1f6e3-fe0f","1f6e3"],":railway_track:":["1f6e4-fe0f","1f6e4"],":railroad_track:":["1f6e4-fe0f","1f6e4"],":motorboat:":["1f6e5-fe0f","1f6e5"],":airplane_small:":["1f6e9-fe0f","1f6e9"],":small_airplane:":["1f6e9-fe0f","1f6e9"],":cruise_ship:":["1f6f3-fe0f","1f6f3"],":passenger_ship:":["1f6f3-fe0f","1f6f3"],":white_sun_small_cloud:":["1f324-fe0f","1f324"],":white_sun_with_small_cloud:":["1f324-fe0f","1f324"],":white_sun_cloud:":["1f325-fe0f","1f325"],":white_sun_behind_cloud:":["1f325-fe0f","1f325"],":white_sun_rain_cloud:":["1f326-fe0f","1f326"],":white_sun_behind_cloud_with_rain:":["1f326-fe0f","1f326"],":mouse_three_button:":["1f5b1-fe0f","1f5b1"],":three_button_mouse:":["1f5b1-fe0f","1f5b1"],":point_up_tone1:":["261d-1f3fb"],":point_up_tone2:":["261d-1f3fc"],":point_up_tone3:":["261d-1f3fd"],":point_up_tone4:":["261d-1f3fe"],":copyright:":["00a9-fe0f","00a9"],":registered:":["00ae-fe0f","00ae"],":bangbang:":["203c-fe0f","203c"],":interrobang:":["2049-fe0f","2049"],":tm:":["2122-fe0f","2122"],":information_source:":["2139-fe0f","2139"],":left_right_arrow:":["2194-fe0f","2194"],":arrow_up_down:":["2195-fe0f","2195"],":arrow_upper_left:":["2196-fe0f","2196"],":arrow_upper_right:":["2197-fe0f","2197"],":arrow_lower_right:":["2198-fe0f","2198"],":arrow_lower_left:":["2199-fe0f","2199"],":leftwards_arrow_with_hook:":["21a9-fe0f","21a9"],":arrow_right_hook:":["21aa-fe0f","21aa"],":watch:":["231a-fe0f","231a"],":hourglass:":["231b-fe0f","231b"],":m:":["24c2-fe0f","24c2"],":black_small_square:":["25aa-fe0f","25aa"],":white_small_square:":["25ab-fe0f","25ab"],":arrow_forward:":["25b6-fe0f","25b6"],":arrow_backward:":["25c0-fe0f","25c0"],":white_medium_square:":["25fb-fe0f","25fb"],":black_medium_square:":["25fc-fe0f","25fc"],":white_medium_small_square:":["25fd-fe0f","25fd"],":black_medium_small_square:":["25fe-fe0f","25fe"],":sunny:":["2600-fe0f","2600"],":cloud:":["2601-fe0f","2601"],":telephone:":["260e-fe0f","260e"],":ballot_box_with_check:":["2611-fe0f","2611"],":umbrella:":["2614-fe0f","2614"],":coffee:":["2615-fe0f","2615"],":point_up:":["261d-fe0f","261d"],":relaxed:":["263a-fe0f","263a"],":aries:":["2648-fe0f","2648"],":taurus:":["2649-fe0f","2649"],":gemini:":["264a-fe0f","264a"],":cancer:":["264b-fe0f","264b"],":leo:":["264c-fe0f","264c"],":virgo:":["264d-fe0f","264d"],":libra:":["264e-fe0f","264e"],":scorpius:":["264f-fe0f","264f"],":sagittarius:":["2650-fe0f","2650"],":capricorn:":["2651-fe0f","2651"],":aquarius:":["2652-fe0f","2652"],":pisces:":["2653-fe0f","2653"],":spades:":["2660-fe0f","2660"],":clubs:":["2663-fe0f","2663"],":hearts:":["2665-fe0f","2665"],":diamonds:":["2666-fe0f","2666"],":hotsprings:":["2668-fe0f","2668"],":recycle:":["267b-fe0f","267b"],":wheelchair:":["267f-fe0f","267f"],":anchor:":["2693-fe0f","2693"],":warning:":["26a0-fe0f","26a0"],":zap:":["26a1-fe0f","26a1"],":white_circle:":["26aa-fe0f","26aa"],":black_circle:":["26ab-fe0f","26ab"],":soccer:":["26bd-fe0f","26bd"],":baseball:":["26be-fe0f","26be"],":snowman:":["26c4-fe0f","26c4"],":partly_sunny:":["26c5-fe0f","26c5"],":no_entry:":["26d4-fe0f","26d4"],":church:":["26ea-fe0f","26ea"],":fountain:":["26f2-fe0f","26f2"],":golf:":["26f3-fe0f","26f3"],":sailboat:":["26f5-fe0f","26f5"],":tent:":["26fa-fe0f","26fa"],":fuelpump:":["26fd-fe0f","26fd"],":scissors:":["2702-fe0f","2702"],":airplane:":["2708-fe0f","2708"],":envelope:":["2709-fe0f","2709"],":v:":["270c-fe0f","270c"],":pencil2:":["270f-fe0f","270f"],":black_nib:":["2712-fe0f","2712"],":heavy_check_mark:":["2714-fe0f","2714"],":heavy_multiplication_x:":["2716-fe0f","2716"],":eight_spoked_asterisk:":["2733-fe0f","2733"],":eight_pointed_black_star:":["2734-fe0f","2734"],":snowflake:":["2744-fe0f","2744"],":sparkle:":["2747-fe0f","2747"],":exclamation:":["2757-fe0f","2757"],":heart:":["2764-fe0f","2764"],":arrow_right:":["27a1-fe0f","27a1"],":arrow_heading_up:":["2934-fe0f","2934"],":arrow_heading_down:":["2935-fe0f","2935"],":arrow_left:":["2b05-fe0f","2b05"],":arrow_up:":["2b06-fe0f","2b06"],":arrow_down:":["2b07-fe0f","2b07"],":black_large_square:":["2b1b-fe0f","2b1b"],":white_large_square:":["2b1c-fe0f","2b1c"],":star:":["2b50-fe0f","2b50"],":o:":["2b55-fe0f","2b55"],":wavy_dash:":["3030-fe0f","3030"],":part_alternation_mark:":["303d-fe0f","303d"],":congratulations:":["3297-fe0f","3297"],":secret:":["3299-fe0f","3299"],":cross:":["271d-fe0f","271d"],":latin_cross:":["271d-fe0f","271d"],":keyboard:":["2328-fe0f","2328"],":writing_hand:":["270d-fe0f","270d"],":track_next:":["23ed-fe0f","23ed"],":next_track:":["23ed-fe0f","23ed"],":track_previous:":["23ee-fe0f","23ee"],":previous_track:":["23ee-fe0f","23ee"],":play_pause:":["23ef-fe0f","23ef"],":stopwatch:":["23f1-fe0f","23f1"],":timer:":["23f2-fe0f","23f2"],":timer_clock:":["23f2-fe0f","23f2"],":pause_button:":["23f8-fe0f","23f8"],":double_vertical_bar:":["23f8-fe0f","23f8"],":stop_button:":["23f9-fe0f","23f9"],":record_button:":["23fa-fe0f","23fa"],":umbrella2:":["2602-fe0f","2602"],
":snowman2:":["2603-fe0f","2603"],":comet:":["2604-fe0f","2604"],":shamrock:":["2618-fe0f","2618"],":skull_crossbones:":["2620-fe0f","2620"],":skull_and_crossbones:":["2620-fe0f","2620"],":radioactive:":["2622-fe0f","2622"],":radioactive_sign:":["2622-fe0f","2622"],":biohazard:":["2623-fe0f","2623"],":biohazard_sign:":["2623-fe0f","2623"],":orthodox_cross:":["2626-fe0f","2626"],":star_and_crescent:":["262a-fe0f","262a"],":peace:":["262e-fe0f","262e"],":peace_symbol:":["262e-fe0f","262e"],":yin_yang:":["262f-fe0f","262f"],":wheel_of_dharma:":["2638-fe0f","2638"],":frowning2:":["2639-fe0f","2639"],":white_frowning_face:":["2639-fe0f","2639"],":hammer_pick:":["2692-fe0f","2692"],":hammer_and_pick:":["2692-fe0f","2692"],":crossed_swords:":["2694-fe0f","2694"],":scales:":["2696-fe0f","2696"],":alembic:":["2697-fe0f","2697"],":gear:":["2699-fe0f","2699"],":atom:":["269b-fe0f","269b"],":atom_symbol:":["269b-fe0f","269b"],":fleur-de-lis:":["269c-fe0f","269c"],":coffin:":["26b0-fe0f","26b0"],":urn:":["26b1-fe0f","26b1"],":funeral_urn:":["26b1-fe0f","26b1"],":thunder_cloud_rain:":["26c8-fe0f","26c8"],":thunder_cloud_and_rain:":["26c8-fe0f","26c8"],":pick:":["26cf-fe0f","26cf"],":helmet_with_cross:":["26d1-fe0f","26d1"],":helmet_with_white_cross:":["26d1-fe0f","26d1"],":chains:":["26d3-fe0f","26d3"],":shinto_shrine:":["26e9-fe0f","26e9"],":mountain:":["26f0-fe0f","26f0"],":beach_umbrella:":["26f1-fe0f","26f1"],":umbrella_on_ground:":["26f1-fe0f","26f1"],":ferry:":["26f4-fe0f","26f4"],":skier:":["26f7-fe0f","26f7"],":ice_skate:":["26f8-fe0f","26f8"],":basketball_player:":["26f9-fe0f","26f9"],":person_with_ball:":["26f9-fe0f","26f9"],":star_of_david:":["2721-fe0f","2721"],":heart_exclamation:":["2763-fe0f","2763"],":heavy_heart_exclamation_mark_ornament:":["2763-fe0f","2763"],":black_joker:":["1f0cf"],":a:":["1f170"],":b:":["1f171"],":o2:":["1f17e"],":ab:":["1f18e"],":cl:":["1f191"],":cool:":["1f192"],":free:":["1f193"],":id:":["1f194"],":new:":["1f195"],":ng:":["1f196"],":ok:":["1f197"],":sos:":["1f198"],":up:":["1f199"],":vs:":["1f19a"],":koko:":["1f201"],":u7981:":["1f232"],":u7a7a:":["1f233"],":u5408:":["1f234"],":u6e80:":["1f235"],":u6709:":["1f236"],":u7533:":["1f238"],":u5272:":["1f239"],":u55b6:":["1f23a"],":ideograph_advantage:":["1f250"],":accept:":["1f251"],":cyclone:":["1f300"],":foggy:":["1f301"],":closed_umbrella:":["1f302"],":night_with_stars:":["1f303"],":sunrise_over_mountains:":["1f304"],":sunrise:":["1f305"],":city_dusk:":["1f306"],":city_sunset:":["1f307"],":city_sunrise:":["1f307"],":rainbow:":["1f308"],":bridge_at_night:":["1f309"],":ocean:":["1f30a"],":volcano:":["1f30b"],":milky_way:":["1f30c"],":earth_asia:":["1f30f"],":new_moon:":["1f311"],":first_quarter_moon:":["1f313"],":waxing_gibbous_moon:":["1f314"],":full_moon:":["1f315"],":crescent_moon:":["1f319"],":first_quarter_moon_with_face:":["1f31b"],":star2:":["1f31f"],":stars:":["1f320"],":chestnut:":["1f330"],":seedling:":["1f331"],":palm_tree:":["1f334"],":cactus:":["1f335"],":tulip:":["1f337"],":cherry_blossom:":["1f338"],":rose:":["1f339"],":hibiscus:":["1f33a"],":sunflower:":["1f33b"],":blossom:":["1f33c"],":corn:":["1f33d"],":ear_of_rice:":["1f33e"],":herb:":["1f33f"],":four_leaf_clover:":["1f340"],":maple_leaf:":["1f341"],":fallen_leaf:":["1f342"],":leaves:":["1f343"],":mushroom:":["1f344"],":tomato:":["1f345"],":eggplant:":["1f346"],":grapes:":["1f347"],":melon:":["1f348"],":watermelon:":["1f349"],":tangerine:":["1f34a"],":banana:":["1f34c"],":pineapple:":["1f34d"],":apple:":["1f34e"],":green_apple:":["1f34f"],":peach:":["1f351"],":cherries:":["1f352"],":strawberry:":["1f353"],":hamburger:":["1f354"],":pizza:":["1f355"],":meat_on_bone:":["1f356"],":poultry_leg:":["1f357"],":rice_cracker:":["1f358"],":rice_ball:":["1f359"],":rice:":["1f35a"],":curry:":["1f35b"],":ramen:":["1f35c"],":spaghetti:":["1f35d"],":bread:":["1f35e"],":fries:":["1f35f"],":sweet_potato:":["1f360"],":dango:":["1f361"],":oden:":["1f362"],":sushi:":["1f363"],":fried_shrimp:":["1f364"],":fish_cake:":["1f365"],":icecream:":["1f366"],":shaved_ice:":["1f367"],":ice_cream:":["1f368"],":doughnut:":["1f369"],":cookie:":["1f36a"],":chocolate_bar:":["1f36b"],":candy:":["1f36c"],":lollipop:":["1f36d"],":custard:":["1f36e"],":honey_pot:":["1f36f"],":cake:":["1f370"],":bento:":["1f371"],":stew:":["1f372"],":egg:":["1f373"],":fork_and_knife:":["1f374"],":tea:":["1f375"],":sake:":["1f376"],":wine_glass:":["1f377"],":cocktail:":["1f378"],":tropical_drink:":["1f379"],":beer:":["1f37a"],":beers:":["1f37b"],":ribbon:":["1f380"],":gift:":["1f381"],":birthday:":["1f382"],":jack_o_lantern:":["1f383"],":christmas_tree:":["1f384"],":santa:":["1f385"],":fireworks:":["1f386"],":sparkler:":["1f387"],":balloon:":["1f388"],":tada:":["1f389"],":confetti_ball:":["1f38a"],":tanabata_tree:":["1f38b"],":crossed_flags:":["1f38c"],":bamboo:":["1f38d"],":dolls:":["1f38e"],":flags:":["1f38f"],":wind_chime:":["1f390"],":rice_scene:":["1f391"],":school_satchel:":["1f392"],":mortar_board:":["1f393"],":carousel_horse:":["1f3a0"],":ferris_wheel:":["1f3a1"],":roller_coaster:":["1f3a2"],":fishing_pole_and_fish:":["1f3a3"],":microphone:":["1f3a4"],":movie_camera:":["1f3a5"],":cinema:":["1f3a6"],":headphones:":["1f3a7"],":art:":["1f3a8"],":tophat:":["1f3a9"],":circus_tent:":["1f3aa"],":ticket:":["1f3ab"],":clapper:":["1f3ac"],":performing_arts:":["1f3ad"],":video_game:":["1f3ae"],":dart:":["1f3af"],":slot_machine:":["1f3b0"],":8ball:":["1f3b1"],":game_die:":["1f3b2"],":bowling:":["1f3b3"],":flower_playing_cards:":["1f3b4"],":musical_note:":["1f3b5"],":notes:":["1f3b6"],":saxophone:":["1f3b7"],":guitar:":["1f3b8"],":musical_keyboard:":["1f3b9"],":trumpet:":["1f3ba"],":violin:":["1f3bb"],":musical_score:":["1f3bc"],":running_shirt_with_sash:":["1f3bd"],":tennis:":["1f3be"],":ski:":["1f3bf"],":basketball:":["1f3c0"],":checkered_flag:":["1f3c1"],":snowboarder:":["1f3c2"],":runner:":["1f3c3"],":surfer:":["1f3c4"],":trophy:":["1f3c6"],":football:":["1f3c8"],":swimmer:":["1f3ca"],":house:":["1f3e0"],":house_with_garden:":["1f3e1"],":office:":["1f3e2"],":post_office:":["1f3e3"],":hospital:":["1f3e5"],":bank:":["1f3e6"],":atm:":["1f3e7"],":hotel:":["1f3e8"],":love_hotel:":["1f3e9"],":convenience_store:":["1f3ea"],":school:":["1f3eb"],":department_store:":["1f3ec"],":factory:":["1f3ed"],":izakaya_lantern:":["1f3ee"],":japanese_castle:":["1f3ef"],":european_castle:":["1f3f0"],":snail:":["1f40c"],":snake:":["1f40d"],":racehorse:":["1f40e"],":sheep:":["1f411"],":monkey:":["1f412"],":chicken:":["1f414"],":boar:":["1f417"],":elephant:":["1f418"],":octopus:":["1f419"],":shell:":["1f41a"],":bug:":["1f41b"],":ant:":["1f41c"],":bee:":["1f41d"],":beetle:":["1f41e"],":fish:":["1f41f"],":tropical_fish:":["1f420"],":blowfish:":["1f421"],":turtle:":["1f422"],":hatching_chick:":["1f423"],":baby_chick:":["1f424"],":hatched_chick:":["1f425"],":bird:":["1f426"],":penguin:":["1f427"],":koala:":["1f428"],":poodle:":["1f429"],":camel:":["1f42b"],":dolphin:":["1f42c"],":mouse:":["1f42d"],":cow:":["1f42e"],":tiger:":["1f42f"],":rabbit:":["1f430"],":cat:":["1f431"],":dragon_face:":["1f432"],":whale:":["1f433"],":horse:":["1f434"],":monkey_face:":["1f435"],":dog:":["1f436"],":pig:":["1f437"],":frog:":["1f438"],":hamster:":["1f439"],":wolf:":["1f43a"],":bear:":["1f43b"],":panda_face:":["1f43c"],":pig_nose:":["1f43d"],":feet:":["1f43e"],":paw_prints:":["1f43e"],":eyes:":["1f440"],":ear:":["1f442"],":nose:":["1f443"],":lips:":["1f444"],":tongue:":["1f445"],":point_up_2:":["1f446"],":point_down:":["1f447"],":point_left:":["1f448"],":point_right:":["1f449"],":punch:":["1f44a"],":wave:":["1f44b"],":ok_hand:":["1f44c"],":thumbsup:":["1f44d"],":+1:":["1f44d"],":thumbsdown:":["1f44e"],":-1:":["1f44e"],":clap:":["1f44f"],":open_hands:":["1f450"],":crown:":["1f451"],":womans_hat:":["1f452"],":eyeglasses:":["1f453"],":necktie:":["1f454"],":shirt:":["1f455"],":jeans:":["1f456"],":dress:":["1f457"],":kimono:":["1f458"],":bikini:":["1f459"],":womans_clothes:":["1f45a"],":purse:":["1f45b"],":handbag:":["1f45c"],":pouch:":["1f45d"],":mans_shoe:":["1f45e"],":athletic_shoe:":["1f45f"],":high_heel:":["1f460"],":sandal:":["1f461"],":boot:":["1f462"],":footprints:":["1f463"],":bust_in_silhouette:":["1f464"],":boy:":["1f466"],":girl:":["1f467"],":man:":["1f468"],":woman:":["1f469"],":family:":["1f46a"],":couple:":["1f46b"],":cop:":["1f46e"],":dancers:":["1f46f"],":bride_with_veil:":["1f470"],":person_with_blond_hair:":["1f471"],":man_with_gua_pi_mao:":["1f472"],":man_with_turban:":["1f473"],":older_man:":["1f474"],":older_woman:":["1f475"],":grandma:":["1f475"],":baby:":["1f476"],":construction_worker:":["1f477"],":princess:":["1f478"],":japanese_ogre:":["1f479"],":japanese_goblin:":["1f47a"],":ghost:":["1f47b"],":angel:":["1f47c"],":alien:":["1f47d"],":space_invader:":["1f47e"],":imp:":["1f47f"],":skull:":["1f480"],":skeleton:":["1f480"],":card_index:":["1f4c7"],":information_desk_person:":["1f481"],":guardsman:":["1f482"],":dancer:":["1f483"],":lipstick:":["1f484"],":nail_care:":["1f485"],":ledger:":["1f4d2"],":massage:":["1f486"],":notebook:":["1f4d3"],":haircut:":["1f487"],":notebook_with_decorative_cover:":["1f4d4"],":barber:":["1f488"],":closed_book:":["1f4d5"],":syringe:":["1f489"],":book:":["1f4d6"],":pill:":["1f48a"],":green_book:":["1f4d7"],":kiss:":["1f48b"],":blue_book:":["1f4d8"],":love_letter:":["1f48c"],":orange_book:":["1f4d9"],":ring:":["1f48d"],":books:":["1f4da"],":gem:":["1f48e"],":name_badge:":["1f4db"],":couplekiss:":["1f48f"],":scroll:":["1f4dc"],":bouquet:":["1f490"],":pencil:":["1f4dd"],":couple_with_heart:":["1f491"],":telephone_receiver:":["1f4de"],":wedding:":["1f492"],":pager:":["1f4df"],":fax:":["1f4e0"],":heartbeat:":["1f493"],":satellite:":["1f4e1"],":loudspeaker:":["1f4e2"],":broken_heart:":["1f494"],":mega:":["1f4e3"],":outbox_tray:":["1f4e4"],":two_hearts:":["1f495"],":inbox_tray:":["1f4e5"],":package:":["1f4e6"],":sparkling_heart:":["1f496"],":e-mail:":["1f4e7"],":email:":["1f4e7"],":incoming_envelope:":["1f4e8"],":heartpulse:":["1f497"],":envelope_with_arrow:":["1f4e9"],":mailbox_closed:":["1f4ea"],":cupid:":["1f498"],":mailbox:":["1f4eb"],":postbox:":["1f4ee"],":blue_heart:":["1f499"],":newspaper:":["1f4f0"],":iphone:":["1f4f1"],":green_heart:":["1f49a"],":calling:":["1f4f2"],":vibration_mode:":["1f4f3"],":yellow_heart:":["1f49b"],":mobile_phone_off:":["1f4f4"],":signal_strength:":["1f4f6"],":purple_heart:":["1f49c"],":camera:":["1f4f7"],":video_camera:":["1f4f9"],":gift_heart:":["1f49d"],":tv:":["1f4fa"],":radio:":["1f4fb"],":revolving_hearts:":["1f49e"],":vhs:":["1f4fc"],":arrows_clockwise:":["1f503"],":heart_decoration:":["1f49f"],":loud_sound:":["1f50a"],":battery:":["1f50b"],":diamond_shape_with_a_dot_inside:":["1f4a0"],":electric_plug:":["1f50c"],":mag:":["1f50d"],":bulb:":["1f4a1"],":mag_right:":["1f50e"],":lock_with_ink_pen:":["1f50f"],":anger:":["1f4a2"],":closed_lock_with_key:":["1f510"],":key:":["1f511"],":bomb:":["1f4a3"],":lock:":["1f512"],":unlock:":["1f513"],":zzz:":["1f4a4"],":bell:":["1f514"],":bookmark:":["1f516"],":boom:":["1f4a5"],":link:":["1f517"],":radio_button:":["1f518"],":sweat_drops:":["1f4a6"],":back:":["1f519"],":end:":["1f51a"],":droplet:":["1f4a7"],":on:":["1f51b"],":soon:":["1f51c"],":dash:":["1f4a8"],":top:":["1f51d"],":underage:":["1f51e"],":poop:":["1f4a9"],":shit:":["1f4a9"],":hankey:":["1f4a9"],":poo:":["1f4a9"],":ten:":["1f51f"],":muscle:":["1f4aa"],":capital_abcd:":["1f520"],":abcd:":["1f521"],":dizzy:":["1f4ab"],":1234:":["1f522"],":symbols:":["1f523"],":speech_balloon:":["1f4ac"],":abc:":["1f524"],":fire:":["1f525"],":flame:":["1f525"],":white_flower:":["1f4ae"],":flashlight:":["1f526"],":wrench:":["1f527"],":100:":["1f4af"],":hammer:":["1f528"],":nut_and_bolt:":["1f529"],":moneybag:":["1f4b0"],":knife:":["1f52a"],":gun:":["1f52b"],":currency_exchange:":["1f4b1"],":crystal_ball:":["1f52e"],":heavy_dollar_sign:":["1f4b2"],":six_pointed_star:":["1f52f"],":credit_card:":["1f4b3"],":beginner:":["1f530"],":trident:":["1f531"],":yen:":["1f4b4"],":black_square_button:":["1f532"],":white_square_button:":["1f533"],":dollar:":["1f4b5"],":red_circle:":["1f534"],":large_blue_circle:":["1f535"],":money_with_wings:":["1f4b8"],":large_orange_diamond:":["1f536"],":large_blue_diamond:":["1f537"],":chart:":["1f4b9"],":small_orange_diamond:":["1f538"],":small_blue_diamond:":["1f539"],":seat:":["1f4ba"],":small_red_triangle:":["1f53a"],":small_red_triangle_down:":["1f53b"],":computer:":["1f4bb"],":arrow_up_small:":["1f53c"],":briefcase:":["1f4bc"],":arrow_down_small:":["1f53d"],":clock1:":["1f550"],":minidisc:":["1f4bd"],":clock2:":["1f551"],":floppy_disk:":["1f4be"],":clock3:":["1f552"],":cd:":["1f4bf"],":clock4:":["1f553"],":dvd:":["1f4c0"],":clock5:":["1f554"],":clock6:":["1f555"],":file_folder:":["1f4c1"],":clock7:":["1f556"],":clock8:":["1f557"],":open_file_folder:":["1f4c2"],":clock9:":["1f558"],":clock10:":["1f559"],":page_with_curl:":["1f4c3"],":clock11:":["1f55a"],":clock12:":["1f55b"],":page_facing_up:":["1f4c4"],":mount_fuji:":["1f5fb"],":tokyo_tower:":["1f5fc"],":date:":["1f4c5"],":statue_of_liberty:":["1f5fd"],":japan:":["1f5fe"],":calendar:":["1f4c6"],":moyai:":["1f5ff"],":grin:":["1f601"],":joy:":["1f602"],":smiley:":["1f603"],":chart_with_upwards_trend:":["1f4c8"],":smile:":["1f604"],":sweat_smile:":["1f605"],":chart_with_downwards_trend:":["1f4c9"],":laughing:":["1f606"],":satisfied:":["1f606"],":wink:":["1f609"],":bar_chart:":["1f4ca"],":blush:":["1f60a"],":yum:":["1f60b"],":clipboard:":["1f4cb"],":relieved:":["1f60c"],":heart_eyes:":["1f60d"],":pushpin:":["1f4cc"],":smirk:":["1f60f"],":unamused:":["1f612"],":round_pushpin:":["1f4cd"],":sweat:":["1f613"],":pensive:":["1f614"],":paperclip:":["1f4ce"],":confounded:":["1f616"],":kissing_heart:":["1f618"],":straight_ruler:":["1f4cf"],":kissing_closed_eyes:":["1f61a"],":stuck_out_tongue_winking_eye:":["1f61c"],":triangular_ruler:":["1f4d0"],":stuck_out_tongue_closed_eyes:":["1f61d"],":disappointed:":["1f61e"],":bookmark_tabs:":["1f4d1"],":angry:":["1f620"],":rage:":["1f621"],":cry:":["1f622"],":persevere:":["1f623"],":triumph:":["1f624"],":disappointed_relieved:":["1f625"],":fearful:":["1f628"],":weary:":["1f629"],":sleepy:":["1f62a"],":tired_face:":["1f62b"],":sob:":["1f62d"],":cold_sweat:":["1f630"],":scream:":["1f631"],":astonished:":["1f632"],":flushed:":["1f633"],":dizzy_face:":["1f635"],":mask:":["1f637"],":smile_cat:":["1f638"],":joy_cat:":["1f639"],":smiley_cat:":["1f63a"],":heart_eyes_cat:":["1f63b"],":smirk_cat:":["1f63c"],":kissing_cat:":["1f63d"],":pouting_cat:":["1f63e"],":crying_cat_face:":["1f63f"],":scream_cat:":["1f640"],":no_good:":["1f645"],":ok_woman:":["1f646"],":bow:":["1f647"],":see_no_evil:":["1f648"],":hear_no_evil:":["1f649"],":speak_no_evil:":["1f64a"],":raising_hand:":["1f64b"],":raised_hands:":["1f64c"],":person_frowning:":["1f64d"],":person_with_pouting_face:":["1f64e"],":pray:":["1f64f"],":rocket:":["1f680"],":railway_car:":["1f683"],":bullettrain_side:":["1f684"],":bullettrain_front:":["1f685"],":metro:":["1f687"],":station:":["1f689"],":bus:":["1f68c"],":busstop:":["1f68f"],":ambulance:":["1f691"],":fire_engine:":["1f692"],":police_car:":["1f693"],":taxi:":["1f695"],":red_car:":["1f697"],":blue_car:":["1f699"],":truck:":["1f69a"],":ship:":["1f6a2"],":speedboat:":["1f6a4"],":traffic_light:":["1f6a5"],":construction:":["1f6a7"],":rotating_light:":["1f6a8"],":triangular_flag_on_post:":["1f6a9"],":door:":["1f6aa"],":no_entry_sign:":["1f6ab"],":smoking:":["1f6ac"],":no_smoking:":["1f6ad"],":bike:":["1f6b2"],":walking:":["1f6b6"],":mens:":["1f6b9"],":womens:":["1f6ba"],":restroom:":["1f6bb"],":baby_symbol:":["1f6bc"],":toilet:":["1f6bd"],":wc:":["1f6be"],":bath:":["1f6c0"],":metal:":["1f918"],":sign_of_the_horns:":["1f918"],":grinning:":["1f600"],":innocent:":["1f607"],":smiling_imp:":["1f608"],":sunglasses:":["1f60e"],":neutral_face:":["1f610"],":expressionless:":["1f611"],":confused:":["1f615"],":kissing:":["1f617"],":kissing_smiling_eyes:":["1f619"],":stuck_out_tongue:":["1f61b"],":worried:":["1f61f"],":frowning:":["1f626"],":anguished:":["1f627"],":grimacing:":["1f62c"],":open_mouth:":["1f62e"],":hushed:":["1f62f"],":sleeping:":["1f634"],":no_mouth:":["1f636"],":helicopter:":["1f681"],":steam_locomotive:":["1f682"],":train2:":["1f686"],":light_rail:":["1f688"],":tram:":["1f68a"],":oncoming_bus:":["1f68d"],":trolleybus:":["1f68e"],":minibus:":["1f690"],":oncoming_police_car:":["1f694"],":oncoming_taxi:":["1f696"],":oncoming_automobile:":["1f698"],":articulated_lorry:":["1f69b"],":tractor:":["1f69c"],":monorail:":["1f69d"],":mountain_railway:":["1f69e"],":suspension_railway:":["1f69f"],":mountain_cableway:":["1f6a0"],":aerial_tramway:":["1f6a1"],":rowboat:":["1f6a3"],":vertical_traffic_light:":["1f6a6"],":put_litter_in_its_place:":["1f6ae"],":do_not_litter:":["1f6af"],":potable_water:":["1f6b0"],":non-potable_water:":["1f6b1"],":no_bicycles:":["1f6b3"],":bicyclist:":["1f6b4"],":mountain_bicyclist:":["1f6b5"],":no_pedestrians:":["1f6b7"],":children_crossing:":["1f6b8"],":shower:":["1f6bf"],":bathtub:":["1f6c1"],":passport_control:":["1f6c2"],":customs:":["1f6c3"],":baggage_claim:":["1f6c4"],":left_luggage:":["1f6c5"],":earth_africa:":["1f30d"],":earth_americas:":["1f30e"],":globe_with_meridians:":["1f310"],":waxing_crescent_moon:":["1f312"],":waning_gibbous_moon:":["1f316"],":last_quarter_moon:":["1f317"],":waning_crescent_moon:":["1f318"],":new_moon_with_face:":["1f31a"],":last_quarter_moon_with_face:":["1f31c"],":full_moon_with_face:":["1f31d"],":sun_with_face:":["1f31e"],":evergreen_tree:":["1f332"],":deciduous_tree:":["1f333"],":lemon:":["1f34b"],":pear:":["1f350"],":baby_bottle:":["1f37c"],":horse_racing:":["1f3c7"],":rugby_football:":["1f3c9"],":european_post_office:":["1f3e4"],":rat:":["1f400"],":mouse2:":["1f401"],":ox:":["1f402"],":water_buffalo:":["1f403"],":cow2:":["1f404"],":tiger2:":["1f405"],":leopard:":["1f406"],":rabbit2:":["1f407"],":cat2:":["1f408"],":dragon:":["1f409"],":crocodile:":["1f40a"],":whale2:":["1f40b"],":ram:":["1f40f"],":goat:":["1f410"],":rooster:":["1f413"],":dog2:":["1f415"],":pig2:":["1f416"],":dromedary_camel:":["1f42a"],":busts_in_silhouette:":["1f465"],":two_men_holding_hands:":["1f46c"],":two_women_holding_hands:":["1f46d"],":thought_balloon:":["1f4ad"],":euro:":["1f4b6"],":pound:":["1f4b7"],":mailbox_with_mail:":["1f4ec"],":mailbox_with_no_mail:":["1f4ed"],":postal_horn:":["1f4ef"],":no_mobile_phones:":["1f4f5"],":twisted_rightwards_arrows:":["1f500"],":repeat:":["1f501"],":repeat_one:":["1f502"],":arrows_counterclockwise:":["1f504"],":low_brightness:":["1f505"],":high_brightness:":["1f506"],":mute:":["1f507"],":sound:":["1f509"],":no_bell:":["1f515"],":microscope:":["1f52c"],":telescope:":["1f52d"],":clock130:":["1f55c"],":clock230:":["1f55d"],":clock330:":["1f55e"],":clock430:":["1f55f"],":clock530:":["1f560"],":clock630:":["1f561"],":clock730:":["1f562"],":clock830:":["1f563"],":clock930:":["1f564"],":clock1030:":["1f565"],":clock1130:":["1f566"],":clock1230:":["1f567"],":speaker:":["1f508"],":train:":["1f68b"],":medal:":["1f3c5"],":sports_medal:":["1f3c5"],":flag_black:":["1f3f4"],":waving_black_flag:":["1f3f4"],":camera_with_flash:":["1f4f8"],":sleeping_accommodation:":["1f6cc"],":middle_finger:":["1f595"],":reversed_hand_with_middle_finger_extended:":["1f595"],":vulcan:":["1f596"],":raised_hand_with_part_between_middle_and_ring_fingers:":["1f596"],":slight_frown:":["1f641"],":slightly_frowning_face:":["1f641"],":slight_smile:":["1f642"],":slightly_smiling_face:":["1f642"],":airplane_departure:":["1f6eb"],":airplane_arriving:":["1f6ec"],":tone1:":["1f3fb"],":tone2:":["1f3fc"],":tone3:":["1f3fd"],":tone4:":["1f3fe"],":tone5:":["1f3ff"],":upside_down:":["1f643"],":upside_down_face:":["1f643"],":money_mouth:":["1f911"],":money_mouth_face:":["1f911"],":nerd:":["1f913"],":nerd_face:":["1f913"],":hugging:":["1f917"],":hugging_face:":["1f917"],":rolling_eyes:":["1f644"],":face_with_rolling_eyes:":["1f644"],":thinking:":["1f914"],":thinking_face:":["1f914"],":zipper_mouth:":["1f910"],":zipper_mouth_face:":["1f910"],":thermometer_face:":["1f912"],":face_with_thermometer:":["1f912"],":head_bandage:":["1f915"],":face_with_head_bandage:":["1f915"],":robot:":["1f916"],":robot_face:":["1f916"],":lion_face:":["1f981"],":lion:":["1f981"],":unicorn:":["1f984"],":unicorn_face:":["1f984"],":scorpion:":["1f982"],":crab:":["1f980"],":turkey:":["1f983"],":cheese:":["1f9c0"],":cheese_wedge:":["1f9c0"],":hotdog:":["1f32d"],":hot_dog:":["1f32d"],":taco:":["1f32e"],":burrito:":["1f32f"],":popcorn:":["1f37f"],":champagne:":["1f37e"],":bottle_with_popping_cork:":["1f37e"],":bow_and_arrow:":["1f3f9"],":archery:":["1f3f9"],":amphora:":["1f3fa"],":place_of_worship:":["1f6d0"],":worship_symbol:":["1f6d0"],":kaaba:":["1f54b"],":mosque:":["1f54c"],":synagogue:":["1f54d"],":menorah:":["1f54e"],":prayer_beads:":["1f4ff"],":cricket:":["1f3cf"],":cricket_bat_ball:":["1f3cf"],":volleyball:":["1f3d0"],":field_hockey:":["1f3d1"],":hockey:":["1f3d2"],":ping_pong:":["1f3d3"],":table_tennis:":["1f3d3"],":badminton:":["1f3f8"],":fast_forward:":["23e9"],":rewind:":["23ea"],":arrow_double_up:":["23eb"],":arrow_double_down:":["23ec"],":alarm_clock:":["23f0"],":hourglass_flowing_sand:":["23f3"],":ophiuchus:":["26ce"],":white_check_mark:":["2705"],":fist:":["270a"],":raised_hand:":["270b"],":sparkles:":["2728"],":x:":["274c"],":negative_squared_cross_mark:":["274e"],":question:":["2753"],":grey_question:":["2754"],":grey_exclamation:":["2755"],":heavy_plus_sign:":["2795"],":heavy_minus_sign:":["2796"],":heavy_division_sign:":["2797"],":curly_loop:":["27b0"],":loop:":["27bf"]};var b,c=[];for(b in a.emojioneList)a.emojioneList.hasOwnProperty(b)&&c.push(b.replace(/[+]/g,"\\$&"));a.shortnames=c.join("|"),a.asciiList={"<3":"2764","</3":"1f494",":')":"1f602",":'-)":"1f602",":D":"1f603",":-D":"1f603","=D":"1f603",":)":"1f604",":-)":"1f604","=]":"1f604","=)":"1f604",":]":"1f604","':)":"1f605","':-)":"1f605","'=)":"1f605","':D":"1f605","':-D":"1f605","'=D":"1f605",">:)":"1f606",">;)":"1f606",">:-)":"1f606",">=)":"1f606",";)":"1f609",";-)":"1f609","*-)":"1f609","*)":"1f609",";-]":"1f609",";]":"1f609",";D":"1f609",";^)":"1f609","':(":"1f613","':-(":"1f613","'=(":"1f613",":*":"1f618",":-*":"1f618","=*":"1f618",":^*":"1f618",">:P":"1f61c","X-P":"1f61c","x-p":"1f61c",">:[":"1f61e",":-(":"1f61e",":(":"1f61e",":-[":"1f61e",":[":"1f61e","=(":"1f61e",">:(":"1f620",">:-(":"1f620",":@":"1f620",":'(":"1f622",":'-(":"1f622",";(":"1f622",";-(":"1f622",">.<":"1f623","D:":"1f628",":$":"1f633","=$":"1f633","#-)":"1f635","#)":"1f635","%-)":"1f635","%)":"1f635","X)":"1f635","X-)":"1f635","*\\0/*":"1f646","\\0/":"1f646","*\\O/*":"1f646","\\O/":"1f646","O:-)":"1f607","0:-3":"1f607","0:3":"1f607","0:-)":"1f607","0:)":"1f607","0;^)":"1f607","O:)":"1f607","O;-)":"1f607","O=)":"1f607","0;-)":"1f607","O:-3":"1f607","O:3":"1f607","B-)":"1f60e","B)":"1f60e","8)":"1f60e","8-)":"1f60e","B-D":"1f60e","8-D":"1f60e","-_-":"1f611","-__-":"1f611","-___-":"1f611",">:\\":"1f615",">:/":"1f615",":-/":"1f615",":-.":"1f615",":/":"1f615",":\\":"1f615","=/":"1f615","=\\":"1f615",":L":"1f615","=L":"1f615",":P":"1f61b",":-P":"1f61b","=P":"1f61b",":-p":"1f61b",":p":"1f61b","=p":"1f61b",":-Þ":"1f61b",":Þ":"1f61b",":þ":"1f61b",":-þ":"1f61b",":-b":"1f61b",":b":"1f61b","d:":"1f61b",":-O":"1f62e",":O":"1f62e",":-o":"1f62e",":o":"1f62e",O_O:"1f62e",">:O":"1f62e",":-X":"1f636",":X":"1f636",":-#":"1f636",":#":"1f636","=X":"1f636","=x":"1f636",":x":"1f636",":-x":"1f636","=#":"1f636"},a.asciiRegexp="(\\<3|&lt;3|\\<\\/3|&lt;\\/3|\\:'\\)|\\:'\\-\\)|\\:D|\\:\\-D|\\=D|\\:\\)|\\:\\-\\)|\\=\\]|\\=\\)|\\:\\]|'\\:\\)|'\\:\\-\\)|'\\=\\)|'\\:D|'\\:\\-D|'\\=D|\\>\\:\\)|&gt;\\:\\)|\\>;\\)|&gt;;\\)|\\>\\:\\-\\)|&gt;\\:\\-\\)|\\>\\=\\)|&gt;\\=\\)|;\\)|;\\-\\)|\\*\\-\\)|\\*\\)|;\\-\\]|;\\]|;D|;\\^\\)|'\\:\\(|'\\:\\-\\(|'\\=\\(|\\:\\*|\\:\\-\\*|\\=\\*|\\:\\^\\*|\\>\\:P|&gt;\\:P|X\\-P|x\\-p|\\>\\:\\[|&gt;\\:\\[|\\:\\-\\(|\\:\\(|\\:\\-\\[|\\:\\[|\\=\\(|\\>\\:\\(|&gt;\\:\\(|\\>\\:\\-\\(|&gt;\\:\\-\\(|\\:@|\\:'\\(|\\:'\\-\\(|;\\(|;\\-\\(|\\>\\.\\<|&gt;\\.&lt;|D\\:|\\:\\$|\\=\\$|#\\-\\)|#\\)|%\\-\\)|%\\)|X\\)|X\\-\\)|\\*\\\\0\\/\\*|\\\\0\\/|\\*\\\\O\\/\\*|\\\\O\\/|O\\:\\-\\)|0\\:\\-3|0\\:3|0\\:\\-\\)|0\\:\\)|0;\\^\\)|O\\:\\-\\)|O\\:\\)|O;\\-\\)|O\\=\\)|0;\\-\\)|O\\:\\-3|O\\:3|B\\-\\)|B\\)|8\\)|8\\-\\)|B\\-D|8\\-D|\\-_\\-|\\-__\\-|\\-___\\-|\\>\\:\\\\|&gt;\\:\\\\|\\>\\:\\/|&gt;\\:\\/|\\:\\-\\/|\\:\\-\\.|\\:\\/|\\:\\\\|\\=\\/|\\=\\\\|\\:L|\\=L|\\:P|\\:\\-P|\\=P|\\:\\-p|\\:p|\\=p|\\:\\-Þ|\\:\\-&THORN;|\\:Þ|\\:&THORN;|\\:þ|\\:&thorn;|\\:\\-þ|\\:\\-&thorn;|\\:\\-b|\\:b|d\\:|\\:\\-O|\\:O|\\:\\-o|\\:o|O_O|\\>\\:O|&gt;\\:O|\\:\\-X|\\:X|\\:\\-#|\\:#|\\=X|\\=x|\\:x|\\:\\-x|\\=#)",a.unicodeRegexp="(\\uD83D\\uDC69\\u200D\\u2764\\uFE0F\\u200D\\uD83D\\uDC8B\\u200D\\uD83D\\uDC69|\\uD83D\\uDC68\\u200D\\u2764\\uFE0F\\u200D\\uD83D\\uDC8B\\u200D\\uD83D\\uDC68|\\uD83D\\uDC68\\u200D\\uD83D\\uDC68\\u200D\\uD83D\\uDC67\\u200D\\uD83D\\uDC66|\\uD83D\\uDC68\\u200D\\uD83D\\uDC68\\u200D\\uD83D\\uDC67\\u200D\\uD83D\\uDC67|\\uD83D\\uDC68\\u200D\\uD83D\\uDC69\\u200D\\uD83D\\uDC66\\u200D\\uD83D\\uDC66|\\uD83D\\uDC68\\u200D\\uD83D\\uDC69\\u200D\\uD83D\\uDC67\\u200D\\uD83D\\uDC66|\\uD83D\\uDC68\\u200D\\uD83D\\uDC69\\u200D\\uD83D\\uDC67\\u200D\\uD83D\\uDC67|\\uD83D\\uDC69\\u200D\\uD83D\\uDC69\\u200D\\uD83D\\uDC66\\u200D\\uD83D\\uDC66|\\uD83D\\uDC69\\u200D\\uD83D\\uDC69\\u200D\\uD83D\\uDC67\\u200D\\uD83D\\uDC66|\\uD83D\\uDC69\\u200D\\uD83D\\uDC69\\u200D\\uD83D\\uDC67\\u200D\\uD83D\\uDC67|\\uD83D\\uDC68\\u200D\\uD83D\\uDC68\\u200D\\uD83D\\uDC66\\u200D\\uD83D\\uDC66|\\uD83D\\uDC68\\u200D\\u2764\\uFE0F\\u200D\\uD83D\\uDC68|\\uD83D\\uDC68\\u200D\\uD83D\\uDC68\\u200D\\uD83D\\uDC67|\\uD83D\\uDC68\\u200D\\uD83D\\uDC69\\u200D\\uD83D\\uDC67|\\uD83D\\uDC69\\u200D\\uD83D\\uDC69\\u200D\\uD83D\\uDC66|\\uD83D\\uDC69\\u200D\\uD83D\\uDC69\\u200D\\uD83D\\uDC67|\\uD83D\\uDC69\\u200D\\u2764\\uFE0F\\u200D\\uD83D\\uDC69|\\uD83D\\uDC68\\u200D\\uD83D\\uDC68\\u200D\\uD83D\\uDC66|\\uD83D\\uDC41\\u200D\\uD83D\\uDDE8|\\uD83C\\uDDE6\\uD83C\\uDDE9|\\uD83C\\uDDE6\\uD83C\\uDDEA|\\uD83C\\uDDE6\\uD83C\\uDDEB|\\uD83C\\uDDE6\\uD83C\\uDDEC|\\uD83C\\uDDE6\\uD83C\\uDDEE|\\uD83C\\uDDE6\\uD83C\\uDDF1|\\uD83C\\uDDE6\\uD83C\\uDDF2|\\uD83C\\uDDE6\\uD83C\\uDDF4|\\uD83C\\uDDE6\\uD83C\\uDDF6|\\uD83C\\uDDE6\\uD83C\\uDDF7|\\uD83C\\uDDE6\\uD83C\\uDDF8|\\uD83E\\uDD18\\uD83C\\uDFFF|\\uD83E\\uDD18\\uD83C\\uDFFE|\\uD83E\\uDD18\\uD83C\\uDFFD|\\uD83E\\uDD18\\uD83C\\uDFFC|\\uD83E\\uDD18\\uD83C\\uDFFB|\\uD83D\\uDEC0\\uD83C\\uDFFF|\\uD83D\\uDEC0\\uD83C\\uDFFE|\\uD83D\\uDEC0\\uD83C\\uDFFD|\\uD83D\\uDEC0\\uD83C\\uDFFC|\\uD83D\\uDEC0\\uD83C\\uDFFB|\\uD83D\\uDEB6\\uD83C\\uDFFF|\\uD83D\\uDEB6\\uD83C\\uDFFE|\\uD83D\\uDEB6\\uD83C\\uDFFD|\\uD83D\\uDEB6\\uD83C\\uDFFC|\\uD83D\\uDEB6\\uD83C\\uDFFB|\\uD83D\\uDEB5\\uD83C\\uDFFF|\\uD83D\\uDEB5\\uD83C\\uDFFE|\\uD83D\\uDEB5\\uD83C\\uDFFD|\\uD83D\\uDEB5\\uD83C\\uDFFC|\\uD83D\\uDEB5\\uD83C\\uDFFB|\\uD83D\\uDEB4\\uD83C\\uDFFF|\\uD83D\\uDEB4\\uD83C\\uDFFE|\\uD83D\\uDEB4\\uD83C\\uDFFD|\\uD83D\\uDEB4\\uD83C\\uDFFC|\\uD83D\\uDEB4\\uD83C\\uDFFB|\\uD83D\\uDEA3\\uD83C\\uDFFF|\\uD83D\\uDEA3\\uD83C\\uDFFE|\\uD83D\\uDEA3\\uD83C\\uDFFD|\\uD83D\\uDEA3\\uD83C\\uDFFC|\\uD83D\\uDEA3\\uD83C\\uDFFB|\\uD83D\\uDE4F\\uD83C\\uDFFF|\\uD83D\\uDE4F\\uD83C\\uDFFE|\\uD83D\\uDE4F\\uD83C\\uDFFD|\\uD83D\\uDE4F\\uD83C\\uDFFC|\\uD83D\\uDE4F\\uD83C\\uDFFB|\\uD83D\\uDE4E\\uD83C\\uDFFF|\\uD83D\\uDE4E\\uD83C\\uDFFE|\\uD83D\\uDE4E\\uD83C\\uDFFD|\\uD83D\\uDE4E\\uD83C\\uDFFC|\\uD83D\\uDE4E\\uD83C\\uDFFB|\\uD83D\\uDE4D\\uD83C\\uDFFF|\\uD83D\\uDE4D\\uD83C\\uDFFE|\\uD83D\\uDE4D\\uD83C\\uDFFD|\\uD83D\\uDE4D\\uD83C\\uDFFC|\\uD83D\\uDE4D\\uD83C\\uDFFB|\\uD83D\\uDE4C\\uD83C\\uDFFF|\\uD83D\\uDE4C\\uD83C\\uDFFE|\\uD83D\\uDE4C\\uD83C\\uDFFD|\\uD83D\\uDE4C\\uD83C\\uDFFC|\\uD83D\\uDE4C\\uD83C\\uDFFB|\\uD83D\\uDE4B\\uD83C\\uDFFF|\\uD83D\\uDE4B\\uD83C\\uDFFE|\\uD83D\\uDE4B\\uD83C\\uDFFD|\\uD83D\\uDE4B\\uD83C\\uDFFC|\\uD83D\\uDE4B\\uD83C\\uDFFB|\\uD83D\\uDE47\\uD83C\\uDFFF|\\uD83D\\uDE47\\uD83C\\uDFFE|\\uD83D\\uDE47\\uD83C\\uDFFD|\\uD83D\\uDE47\\uD83C\\uDFFC|\\uD83D\\uDE47\\uD83C\\uDFFB|\\uD83D\\uDE46\\uD83C\\uDFFF|\\uD83D\\uDE46\\uD83C\\uDFFE|\\uD83D\\uDE46\\uD83C\\uDFFD|\\uD83D\\uDE46\\uD83C\\uDFFC|\\uD83D\\uDE46\\uD83C\\uDFFB|\\uD83D\\uDE45\\uD83C\\uDFFF|\\uD83D\\uDE45\\uD83C\\uDFFE|\\uD83D\\uDE45\\uD83C\\uDFFD|\\uD83D\\uDE45\\uD83C\\uDFFC|\\uD83D\\uDE45\\uD83C\\uDFFB|\\uD83D\\uDD96\\uD83C\\uDFFF|\\uD83D\\uDD96\\uD83C\\uDFFE|\\uD83D\\uDD96\\uD83C\\uDFFD|\\uD83D\\uDD96\\uD83C\\uDFFC|\\uD83D\\uDD96\\uD83C\\uDFFB|\\uD83D\\uDD95\\uD83C\\uDFFF|\\uD83D\\uDD95\\uD83C\\uDFFE|\\uD83D\\uDD95\\uD83C\\uDFFD|\\uD83D\\uDD95\\uD83C\\uDFFC|\\uD83D\\uDD95\\uD83C\\uDFFB|\\uD83D\\uDD90\\uD83C\\uDFFF|\\uD83D\\uDD90\\uD83C\\uDFFE|\\uD83D\\uDD90\\uD83C\\uDFFD|\\uD83D\\uDD90\\uD83C\\uDFFC|\\uD83D\\uDD90\\uD83C\\uDFFB|\\uD83D\\uDD75\\uD83C\\uDFFF|\\uD83D\\uDD75\\uD83C\\uDFFE|\\uD83D\\uDD75\\uD83C\\uDFFD|\\uD83D\\uDD75\\uD83C\\uDFFC|\\uD83D\\uDD75\\uD83C\\uDFFB|\\uD83D\\uDCAA\\uD83C\\uDFFF|\\uD83D\\uDCAA\\uD83C\\uDFFE|\\uD83D\\uDCAA\\uD83C\\uDFFD|\\uD83D\\uDCAA\\uD83C\\uDFFC|\\uD83D\\uDCAA\\uD83C\\uDFFB|\\uD83D\\uDC87\\uD83C\\uDFFF|\\uD83D\\uDC87\\uD83C\\uDFFE|\\uD83D\\uDC87\\uD83C\\uDFFD|\\uD83D\\uDC87\\uD83C\\uDFFC|\\uD83D\\uDC87\\uD83C\\uDFFB|\\uD83D\\uDC86\\uD83C\\uDFFF|\\uD83D\\uDC86\\uD83C\\uDFFE|\\uD83D\\uDC86\\uD83C\\uDFFD|\\uD83D\\uDC86\\uD83C\\uDFFC|\\uD83D\\uDC86\\uD83C\\uDFFB|\\uD83D\\uDC85\\uD83C\\uDFFF|\\uD83D\\uDC85\\uD83C\\uDFFE|\\uD83D\\uDC85\\uD83C\\uDFFD|\\uD83D\\uDC85\\uD83C\\uDFFC|\\uD83D\\uDC85\\uD83C\\uDFFB|\\uD83D\\uDC83\\uD83C\\uDFFF|\\uD83D\\uDC83\\uD83C\\uDFFE|\\uD83D\\uDC83\\uD83C\\uDFFD|\\uD83D\\uDC83\\uD83C\\uDFFC|\\uD83D\\uDC83\\uD83C\\uDFFB|\\uD83D\\uDC82\\uD83C\\uDFFF|\\uD83D\\uDC82\\uD83C\\uDFFE|\\uD83D\\uDC82\\uD83C\\uDFFD|\\uD83D\\uDC82\\uD83C\\uDFFC|\\uD83D\\uDC82\\uD83C\\uDFFB|\\uD83D\\uDC81\\uD83C\\uDFFF|\\uD83D\\uDC81\\uD83C\\uDFFE|\\uD83D\\uDC81\\uD83C\\uDFFD|\\uD83D\\uDC81\\uD83C\\uDFFC|\\uD83D\\uDC81\\uD83C\\uDFFB|\\uD83D\\uDC7C\\uD83C\\uDFFF|\\uD83D\\uDC7C\\uD83C\\uDFFE|\\uD83D\\uDC7C\\uD83C\\uDFFD|\\uD83D\\uDC7C\\uD83C\\uDFFC|\\uD83D\\uDC7C\\uD83C\\uDFFB|\\uD83D\\uDC78\\uD83C\\uDFFF|\\uD83D\\uDC78\\uD83C\\uDFFE|\\uD83D\\uDC78\\uD83C\\uDFFD|\\uD83D\\uDC78\\uD83C\\uDFFC|\\uD83D\\uDC78\\uD83C\\uDFFB|\\uD83D\\uDC77\\uD83C\\uDFFF|\\uD83D\\uDC77\\uD83C\\uDFFE|\\uD83D\\uDC77\\uD83C\\uDFFD|\\uD83D\\uDC77\\uD83C\\uDFFC|\\uD83D\\uDC77\\uD83C\\uDFFB|\\uD83D\\uDC76\\uD83C\\uDFFF|\\uD83D\\uDC76\\uD83C\\uDFFE|\\uD83D\\uDC76\\uD83C\\uDFFD|\\uD83D\\uDC76\\uD83C\\uDFFC|\\uD83D\\uDC76\\uD83C\\uDFFB|\\uD83D\\uDC75\\uD83C\\uDFFF|\\uD83D\\uDC75\\uD83C\\uDFFE|\\uD83D\\uDC75\\uD83C\\uDFFD|\\uD83D\\uDC75\\uD83C\\uDFFC|\\uD83D\\uDC75\\uD83C\\uDFFB|\\uD83D\\uDC74\\uD83C\\uDFFF|\\uD83D\\uDC74\\uD83C\\uDFFE|\\uD83D\\uDC74\\uD83C\\uDFFD|\\uD83D\\uDC74\\uD83C\\uDFFC|\\uD83D\\uDC74\\uD83C\\uDFFB|\\uD83D\\uDC73\\uD83C\\uDFFF|\\uD83D\\uDC73\\uD83C\\uDFFE|\\uD83D\\uDC73\\uD83C\\uDFFD|\\uD83D\\uDC73\\uD83C\\uDFFC|\\uD83D\\uDC73\\uD83C\\uDFFB|\\uD83D\\uDC72\\uD83C\\uDFFF|\\uD83D\\uDC72\\uD83C\\uDFFE|\\uD83D\\uDC72\\uD83C\\uDFFD|\\uD83D\\uDC72\\uD83C\\uDFFC|\\uD83D\\uDC72\\uD83C\\uDFFB|\\uD83D\\uDC71\\uD83C\\uDFFF|\\uD83D\\uDC71\\uD83C\\uDFFE|\\uD83D\\uDC71\\uD83C\\uDFFD|\\uD83D\\uDC71\\uD83C\\uDFFC|\\uD83D\\uDC71\\uD83C\\uDFFB|\\uD83D\\uDC70\\uD83C\\uDFFF|\\uD83D\\uDC70\\uD83C\\uDFFE|\\uD83D\\uDC70\\uD83C\\uDFFD|\\uD83D\\uDC70\\uD83C\\uDFFC|\\uD83D\\uDC70\\uD83C\\uDFFB|\\uD83D\\uDC6E\\uD83C\\uDFFF|\\uD83D\\uDC6E\\uD83C\\uDFFE|\\uD83D\\uDC6E\\uD83C\\uDFFD|\\uD83D\\uDC6E\\uD83C\\uDFFC|\\uD83D\\uDC6E\\uD83C\\uDFFB|\\uD83D\\uDC69\\uD83C\\uDFFF|\\uD83D\\uDC69\\uD83C\\uDFFE|\\uD83D\\uDC69\\uD83C\\uDFFD|\\uD83D\\uDC69\\uD83C\\uDFFC|\\uD83D\\uDC69\\uD83C\\uDFFB|\\uD83D\\uDC68\\uD83C\\uDFFF|\\uD83D\\uDC68\\uD83C\\uDFFE|\\uD83D\\uDC68\\uD83C\\uDFFD|\\uD83D\\uDC68\\uD83C\\uDFFC|\\uD83D\\uDC68\\uD83C\\uDFFB|\\uD83D\\uDC67\\uD83C\\uDFFF|\\uD83D\\uDC67\\uD83C\\uDFFE|\\uD83D\\uDC67\\uD83C\\uDFFD|\\uD83D\\uDC67\\uD83C\\uDFFC|\\uD83D\\uDC67\\uD83C\\uDFFB|\\uD83D\\uDC66\\uD83C\\uDFFF|\\uD83D\\uDC66\\uD83C\\uDFFE|\\uD83D\\uDC66\\uD83C\\uDFFD|\\uD83D\\uDC66\\uD83C\\uDFFC|\\uD83D\\uDC66\\uD83C\\uDFFB|\\uD83D\\uDC50\\uD83C\\uDFFF|\\uD83D\\uDC50\\uD83C\\uDFFE|\\uD83D\\uDC50\\uD83C\\uDFFD|\\uD83D\\uDC50\\uD83C\\uDFFC|\\uD83D\\uDC50\\uD83C\\uDFFB|\\uD83D\\uDC4F\\uD83C\\uDFFF|\\uD83D\\uDC4F\\uD83C\\uDFFE|\\uD83D\\uDC4F\\uD83C\\uDFFD|\\uD83D\\uDC4F\\uD83C\\uDFFC|\\uD83D\\uDC4F\\uD83C\\uDFFB|\\uD83D\\uDC4E\\uD83C\\uDFFF|\\uD83D\\uDC4E\\uD83C\\uDFFE|\\uD83D\\uDC4E\\uD83C\\uDFFD|\\uD83D\\uDC4E\\uD83C\\uDFFC|\\uD83D\\uDC4E\\uD83C\\uDFFB|\\uD83D\\uDC4D\\uD83C\\uDFFF|\\uD83D\\uDC4D\\uD83C\\uDFFE|\\uD83D\\uDC4D\\uD83C\\uDFFD|\\uD83D\\uDC4D\\uD83C\\uDFFC|\\uD83D\\uDC4D\\uD83C\\uDFFB|\\uD83D\\uDC4C\\uD83C\\uDFFF|\\uD83D\\uDC4C\\uD83C\\uDFFE|\\uD83D\\uDC4C\\uD83C\\uDFFD|\\uD83D\\uDC4C\\uD83C\\uDFFC|\\uD83D\\uDC4C\\uD83C\\uDFFB|\\uD83D\\uDC4B\\uD83C\\uDFFF|\\uD83D\\uDC4B\\uD83C\\uDFFE|\\uD83D\\uDC4B\\uD83C\\uDFFD|\\uD83D\\uDC4B\\uD83C\\uDFFC|\\uD83D\\uDC4B\\uD83C\\uDFFB|\\uD83D\\uDC4A\\uD83C\\uDFFF|\\uD83D\\uDC4A\\uD83C\\uDFFE|\\uD83D\\uDC4A\\uD83C\\uDFFD|\\uD83D\\uDC4A\\uD83C\\uDFFC|\\uD83D\\uDC4A\\uD83C\\uDFFB|\\uD83D\\uDC49\\uD83C\\uDFFF|\\uD83D\\uDC49\\uD83C\\uDFFE|\\uD83D\\uDC49\\uD83C\\uDFFD|\\uD83D\\uDC49\\uD83C\\uDFFC|\\uD83D\\uDC49\\uD83C\\uDFFB|\\uD83D\\uDC48\\uD83C\\uDFFF|\\uD83D\\uDC48\\uD83C\\uDFFE|\\uD83D\\uDC48\\uD83C\\uDFFD|\\uD83D\\uDC48\\uD83C\\uDFFC|\\uD83D\\uDC48\\uD83C\\uDFFB|\\uD83D\\uDC47\\uD83C\\uDFFF|\\uD83D\\uDC47\\uD83C\\uDFFE|\\uD83D\\uDC47\\uD83C\\uDFFD|\\uD83D\\uDC47\\uD83C\\uDFFC|\\uD83D\\uDC47\\uD83C\\uDFFB|\\uD83D\\uDC46\\uD83C\\uDFFF|\\uD83D\\uDC46\\uD83C\\uDFFE|\\uD83D\\uDC46\\uD83C\\uDFFD|\\uD83D\\uDC46\\uD83C\\uDFFC|\\uD83D\\uDC46\\uD83C\\uDFFB|\\uD83D\\uDC43\\uD83C\\uDFFF|\\uD83D\\uDC43\\uD83C\\uDFFE|\\uD83D\\uDC43\\uD83C\\uDFFD|\\uD83D\\uDC43\\uD83C\\uDFFC|\\uD83D\\uDC43\\uD83C\\uDFFB|\\uD83D\\uDC42\\uD83C\\uDFFF|\\uD83D\\uDC42\\uD83C\\uDFFE|\\uD83D\\uDC42\\uD83C\\uDFFD|\\uD83D\\uDC42\\uD83C\\uDFFC|\\uD83D\\uDC42\\uD83C\\uDFFB|\\uD83C\\uDFCB\\uD83C\\uDFFF|\\uD83C\\uDFCB\\uD83C\\uDFFE|\\uD83C\\uDFCB\\uD83C\\uDFFD|\\uD83C\\uDFCB\\uD83C\\uDFFC|\\uD83C\\uDFCB\\uD83C\\uDFFB|\\uD83C\\uDFCA\\uD83C\\uDFFF|\\uD83C\\uDFCA\\uD83C\\uDFFE|\\uD83C\\uDFCA\\uD83C\\uDFFD|\\uD83C\\uDFCA\\uD83C\\uDFFC|\\uD83C\\uDFCA\\uD83C\\uDFFB|\\uD83C\\uDFC7\\uD83C\\uDFFF|\\uD83C\\uDFC7\\uD83C\\uDFFE|\\uD83C\\uDFC7\\uD83C\\uDFFD|\\uD83C\\uDFC7\\uD83C\\uDFFC|\\uD83C\\uDFC7\\uD83C\\uDFFB|\\uD83C\\uDFC4\\uD83C\\uDFFF|\\uD83C\\uDFC4\\uD83C\\uDFFE|\\uD83C\\uDFC4\\uD83C\\uDFFD|\\uD83C\\uDFC4\\uD83C\\uDFFC|\\uD83C\\uDFC4\\uD83C\\uDFFB|\\uD83C\\uDFC3\\uD83C\\uDFFF|\\uD83C\\uDFC3\\uD83C\\uDFFE|\\uD83C\\uDFC3\\uD83C\\uDFFD|\\uD83C\\uDFC3\\uD83C\\uDFFC|\\uD83C\\uDFC3\\uD83C\\uDFFB|\\uD83C\\uDF85\\uD83C\\uDFFF|\\uD83C\\uDF85\\uD83C\\uDFFE|\\uD83C\\uDF85\\uD83C\\uDFFD|\\uD83C\\uDF85\\uD83C\\uDFFC|\\uD83C\\uDF85\\uD83C\\uDFFB|\\uD83C\\uDDFF\\uD83C\\uDDFC|\\uD83C\\uDDFF\\uD83C\\uDDF2|\\uD83C\\uDDFF\\uD83C\\uDDE6|\\uD83C\\uDDFE\\uD83C\\uDDF9|\\uD83C\\uDDFE\\uD83C\\uDDEA|\\uD83C\\uDDFD\\uD83C\\uDDF0|\\uD83C\\uDDFC\\uD83C\\uDDF8|\\uD83C\\uDDFC\\uD83C\\uDDEB|\\uD83C\\uDDFB\\uD83C\\uDDFA|\\uD83C\\uDDFB\\uD83C\\uDDF3|\\uD83C\\uDDFB\\uD83C\\uDDEE|\\uD83C\\uDDFB\\uD83C\\uDDEC|\\uD83C\\uDDFB\\uD83C\\uDDEA|\\uD83C\\uDDFB\\uD83C\\uDDE8|\\uD83C\\uDDFB\\uD83C\\uDDE6|\\uD83C\\uDDFA\\uD83C\\uDDFF|\\uD83C\\uDDFA\\uD83C\\uDDFE|\\uD83C\\uDDFA\\uD83C\\uDDF8|\\uD83C\\uDDFA\\uD83C\\uDDF2|\\uD83C\\uDDFA\\uD83C\\uDDEC|\\uD83C\\uDDFA\\uD83C\\uDDE6|\\uD83C\\uDDF9\\uD83C\\uDDFF|\\uD83C\\uDDE6\\uD83C\\uDDE8|\\uD83C\\uDDF9\\uD83C\\uDDFB|\\uD83C\\uDDF9\\uD83C\\uDDF9|\\uD83C\\uDDF9\\uD83C\\uDDF7|\\uD83C\\uDDF9\\uD83C\\uDDF4|\\uD83C\\uDDF9\\uD83C\\uDDF3|\\uD83C\\uDDF9\\uD83C\\uDDF2|\\uD83C\\uDDF9\\uD83C\\uDDF1|\\uD83C\\uDDF9\\uD83C\\uDDF0|\\uD83C\\uDDF9\\uD83C\\uDDEF|\\uD83C\\uDDF9\\uD83C\\uDDED|\\uD83C\\uDDF9\\uD83C\\uDDEC|\\uD83C\\uDDF9\\uD83C\\uDDEB|\\uD83C\\uDDF9\\uD83C\\uDDE9|\\uD83C\\uDDF9\\uD83C\\uDDE8|\\uD83C\\uDDF9\\uD83C\\uDDE6|\\uD83C\\uDDF8\\uD83C\\uDDFF|\\uD83C\\uDDF8\\uD83C\\uDDFE|\\uD83C\\uDDF8\\uD83C\\uDDFD|\\uD83C\\uDDF8\\uD83C\\uDDFB|\\uD83C\\uDDF8\\uD83C\\uDDF9|\\uD83C\\uDDF8\\uD83C\\uDDF8|\\uD83C\\uDDF8\\uD83C\\uDDF7|\\uD83C\\uDDF8\\uD83C\\uDDF4|\\uD83C\\uDDF8\\uD83C\\uDDF3|\\uD83C\\uDDF8\\uD83C\\uDDF2|\\uD83C\\uDDF8\\uD83C\\uDDF1|\\uD83C\\uDDF8\\uD83C\\uDDF0|\\uD83C\\uDDF8\\uD83C\\uDDEF|\\uD83C\\uDDF8\\uD83C\\uDDEE|\\uD83C\\uDDF8\\uD83C\\uDDED|\\uD83C\\uDDF8\\uD83C\\uDDEC|\\uD83C\\uDDF8\\uD83C\\uDDEA|\\uD83C\\uDDF8\\uD83C\\uDDE9|\\uD83C\\uDDF8\\uD83C\\uDDE8|\\uD83C\\uDDF8\\uD83C\\uDDE7|\\uD83C\\uDDF8\\uD83C\\uDDE6|\\uD83C\\uDDF7\\uD83C\\uDDFC|\\uD83C\\uDDF7\\uD83C\\uDDFA|\\uD83C\\uDDF7\\uD83C\\uDDF8|\\uD83C\\uDDF7\\uD83C\\uDDF4|\\uD83C\\uDDF7\\uD83C\\uDDEA|\\uD83C\\uDDF6\\uD83C\\uDDE6|\\uD83C\\uDDF5\\uD83C\\uDDFE|\\uD83C\\uDDF5\\uD83C\\uDDFC|\\uD83C\\uDDF5\\uD83C\\uDDF9|\\uD83C\\uDDF5\\uD83C\\uDDF8|\\uD83C\\uDDF5\\uD83C\\uDDF7|\\uD83C\\uDDF5\\uD83C\\uDDF3|\\uD83C\\uDDF5\\uD83C\\uDDF2|\\uD83C\\uDDF5\\uD83C\\uDDF1|\\uD83C\\uDDF5\\uD83C\\uDDF0|\\uD83C\\uDDF5\\uD83C\\uDDED|\\uD83C\\uDDF5\\uD83C\\uDDEC|\\uD83C\\uDDF5\\uD83C\\uDDEB|\\uD83C\\uDDF5\\uD83C\\uDDEA|\\uD83C\\uDDF5\\uD83C\\uDDE6|\\uD83C\\uDDF4\\uD83C\\uDDF2|\\uD83C\\uDDF3\\uD83C\\uDDFF|\\uD83C\\uDDF3\\uD83C\\uDDFA|\\uD83C\\uDDF3\\uD83C\\uDDF7|\\uD83C\\uDDF3\\uD83C\\uDDF5|\\uD83C\\uDDF3\\uD83C\\uDDF4|\\uD83C\\uDDF3\\uD83C\\uDDF1|\\uD83C\\uDDF3\\uD83C\\uDDEE|\\uD83C\\uDDF3\\uD83C\\uDDEC|\\uD83C\\uDDF3\\uD83C\\uDDEB|\\uD83C\\uDDF3\\uD83C\\uDDEA|\\uD83C\\uDDF3\\uD83C\\uDDE8|\\uD83C\\uDDF3\\uD83C\\uDDE6|\\uD83C\\uDDF2\\uD83C\\uDDFF|\\uD83C\\uDDF2\\uD83C\\uDDFE|\\uD83C\\uDDF2\\uD83C\\uDDFD|\\uD83C\\uDDF2\\uD83C\\uDDFC|\\uD83C\\uDDF2\\uD83C\\uDDFB|\\uD83C\\uDDF2\\uD83C\\uDDFA|\\uD83C\\uDDF2\\uD83C\\uDDF9|\\uD83C\\uDDF2\\uD83C\\uDDF8|\\uD83C\\uDDF2\\uD83C\\uDDF7|\\uD83C\\uDDF2\\uD83C\\uDDF6|\\uD83C\\uDDF2\\uD83C\\uDDF5|\\uD83C\\uDDF2\\uD83C\\uDDF4|\\uD83C\\uDDF2\\uD83C\\uDDF3|\\uD83C\\uDDF2\\uD83C\\uDDF2|\\uD83C\\uDDF2\\uD83C\\uDDF1|\\uD83C\\uDDF2\\uD83C\\uDDF0|\\uD83C\\uDDF2\\uD83C\\uDDED|\\uD83C\\uDDF2\\uD83C\\uDDEC|\\uD83C\\uDDF2\\uD83C\\uDDEB|\\uD83C\\uDDF2\\uD83C\\uDDEA|\\uD83C\\uDDF2\\uD83C\\uDDE9|\\uD83C\\uDDF2\\uD83C\\uDDE8|\\uD83C\\uDDF2\\uD83C\\uDDE6|\\uD83C\\uDDF1\\uD83C\\uDDFE|\\uD83C\\uDDF1\\uD83C\\uDDFB|\\uD83C\\uDDF1\\uD83C\\uDDFA|\\uD83C\\uDDF1\\uD83C\\uDDF9|\\uD83C\\uDDF1\\uD83C\\uDDF8|\\uD83C\\uDDF1\\uD83C\\uDDF7|\\uD83C\\uDDF1\\uD83C\\uDDF0|\\uD83C\\uDDF1\\uD83C\\uDDEE|\\uD83C\\uDDF1\\uD83C\\uDDE8|\\uD83C\\uDDF1\\uD83C\\uDDE7|\\uD83C\\uDDF1\\uD83C\\uDDE6|\\uD83C\\uDDF0\\uD83C\\uDDFF|\\uD83C\\uDDF0\\uD83C\\uDDFE|\\uD83C\\uDDF0\\uD83C\\uDDFC|\\uD83C\\uDDF0\\uD83C\\uDDF7|\\uD83C\\uDDF0\\uD83C\\uDDF5|\\uD83C\\uDDF0\\uD83C\\uDDF3|\\uD83C\\uDDF0\\uD83C\\uDDF2|\\uD83C\\uDDF0\\uD83C\\uDDEE|\\uD83C\\uDDF0\\uD83C\\uDDED|\\uD83C\\uDDF0\\uD83C\\uDDEC|\\uD83C\\uDDF0\\uD83C\\uDDEA|\\uD83C\\uDDEF\\uD83C\\uDDF5|\\uD83C\\uDDEF\\uD83C\\uDDF4|\\uD83C\\uDDEF\\uD83C\\uDDF2|\\uD83C\\uDDEF\\uD83C\\uDDEA|\\uD83C\\uDDEE\\uD83C\\uDDF9|\\uD83C\\uDDEE\\uD83C\\uDDF8|\\uD83C\\uDDEE\\uD83C\\uDDF7|\\uD83C\\uDDEE\\uD83C\\uDDF6|\\uD83C\\uDDEE\\uD83C\\uDDF4|\\uD83C\\uDDEE\\uD83C\\uDDF3|\\uD83C\\uDDEE\\uD83C\\uDDF2|\\uD83C\\uDDEE\\uD83C\\uDDF1|\\uD83C\\uDDEE\\uD83C\\uDDEA|\\uD83C\\uDDEE\\uD83C\\uDDE9|\\uD83C\\uDDEE\\uD83C\\uDDE8|\\uD83C\\uDDED\\uD83C\\uDDFA|\\uD83C\\uDDED\\uD83C\\uDDF9|\\uD83C\\uDDED\\uD83C\\uDDF7|\\uD83C\\uDDED\\uD83C\\uDDF3|\\uD83C\\uDDED\\uD83C\\uDDF2|\\uD83C\\uDDED\\uD83C\\uDDF0|\\uD83C\\uDDEC\\uD83C\\uDDFE|\\uD83C\\uDDEC\\uD83C\\uDDFC|\\uD83C\\uDDEC\\uD83C\\uDDFA|\\uD83C\\uDDEC\\uD83C\\uDDF9|\\uD83C\\uDDEC\\uD83C\\uDDF8|\\uD83C\\uDDEC\\uD83C\\uDDF7|\\uD83C\\uDDEC\\uD83C\\uDDF6|\\uD83C\\uDDEC\\uD83C\\uDDF5|\\uD83C\\uDDEC\\uD83C\\uDDF3|\\uD83C\\uDDEC\\uD83C\\uDDF2|\\uD83C\\uDDEC\\uD83C\\uDDF1|\\uD83C\\uDDEC\\uD83C\\uDDEE|\\uD83C\\uDDEC\\uD83C\\uDDED|\\uD83C\\uDDEC\\uD83C\\uDDEC|\\uD83C\\uDDEC\\uD83C\\uDDEB|\\uD83C\\uDDEC\\uD83C\\uDDEA|\\uD83C\\uDDEC\\uD83C\\uDDE9|\\uD83C\\uDDEC\\uD83C\\uDDE7|\\uD83C\\uDDEC\\uD83C\\uDDE6|\\uD83C\\uDDEB\\uD83C\\uDDF7|\\uD83C\\uDDEB\\uD83C\\uDDF4|\\uD83C\\uDDEB\\uD83C\\uDDF2|\\uD83C\\uDDEB\\uD83C\\uDDF0|\\uD83C\\uDDEB\\uD83C\\uDDEF|\\uD83C\\uDDEB\\uD83C\\uDDEE|\\uD83C\\uDDEA\\uD83C\\uDDFA|\\uD83C\\uDDEA\\uD83C\\uDDF9|\\uD83C\\uDDEA\\uD83C\\uDDF8|\\uD83C\\uDDEA\\uD83C\\uDDF7|\\uD83C\\uDDEA\\uD83C\\uDDED|\\uD83C\\uDDEA\\uD83C\\uDDEC|\\uD83C\\uDDEA\\uD83C\\uDDEA|\\uD83C\\uDDEA\\uD83C\\uDDE8|\\uD83C\\uDDEA\\uD83C\\uDDE6|\\uD83C\\uDDE9\\uD83C\\uDDFF|\\uD83C\\uDDE9\\uD83C\\uDDF4|\\uD83C\\uDDE9\\uD83C\\uDDF2|\\uD83C\\uDDE9\\uD83C\\uDDF0|\\uD83C\\uDDE9\\uD83C\\uDDEF|\\uD83C\\uDDE9\\uD83C\\uDDEC|\\uD83C\\uDDE9\\uD83C\\uDDEA|\\uD83C\\uDDE8\\uD83C\\uDDFF|\\uD83C\\uDDE8\\uD83C\\uDDFE|\\uD83C\\uDDE8\\uD83C\\uDDFD|\\uD83C\\uDDE8\\uD83C\\uDDFC|\\uD83C\\uDDE8\\uD83C\\uDDFB|\\uD83C\\uDDE8\\uD83C\\uDDFA|\\uD83C\\uDDE8\\uD83C\\uDDF7|\\uD83C\\uDDE8\\uD83C\\uDDF5|\\uD83C\\uDDE8\\uD83C\\uDDF4|\\uD83C\\uDDE8\\uD83C\\uDDF3|\\uD83C\\uDDE8\\uD83C\\uDDF2|\\uD83C\\uDDE8\\uD83C\\uDDF1|\\uD83C\\uDDE8\\uD83C\\uDDF0|\\uD83C\\uDDE8\\uD83C\\uDDEE|\\uD83C\\uDDE8\\uD83C\\uDDED|\\uD83C\\uDDE8\\uD83C\\uDDEC|\\uD83C\\uDDE8\\uD83C\\uDDEB|\\uD83C\\uDDE8\\uD83C\\uDDE9|\\uD83C\\uDDE8\\uD83C\\uDDE8|\\uD83C\\uDDE8\\uD83C\\uDDE6|\\uD83C\\uDDE7\\uD83C\\uDDFF|\\uD83C\\uDDE7\\uD83C\\uDDFE|\\uD83C\\uDDE7\\uD83C\\uDDFC|\\uD83C\\uDDE7\\uD83C\\uDDFB|\\uD83C\\uDDE7\\uD83C\\uDDF9|\\uD83C\\uDDE7\\uD83C\\uDDF8|\\uD83C\\uDDE7\\uD83C\\uDDF7|\\uD83C\\uDDE7\\uD83C\\uDDF6|\\uD83C\\uDDE7\\uD83C\\uDDF4|\\uD83C\\uDDE7\\uD83C\\uDDF3|\\uD83C\\uDDE7\\uD83C\\uDDF2|\\uD83C\\uDDE7\\uD83C\\uDDF1|\\uD83C\\uDDE7\\uD83C\\uDDEF|\\uD83C\\uDDE7\\uD83C\\uDDEE|\\uD83C\\uDDE7\\uD83C\\uDDED|\\uD83C\\uDDE7\\uD83C\\uDDEC|\\uD83C\\uDDE7\\uD83C\\uDDEB|\\uD83C\\uDDE7\\uD83C\\uDDEA|\\uD83C\\uDDE7\\uD83C\\uDDE9|\\uD83C\\uDDE7\\uD83C\\uDDE7|\\uD83C\\uDDE7\\uD83C\\uDDE6|\\uD83C\\uDDE6\\uD83C\\uDDFF|\\uD83C\\uDDE6\\uD83C\\uDDFD|\\uD83C\\uDDE6\\uD83C\\uDDFC|\\uD83C\\uDDE6\\uD83C\\uDDFA|\\uD83C\\uDDE6\\uD83C\\uDDF9|\\uD83C\\uDDF9\\uD83C\\uDDFC|\\uD83D\\uDDA5\\uFE0F|\\u261D\\uD83C\\uDFFE|\\u261D\\uD83C\\uDFFD|\\u261D\\uD83C\\uDFFC|\\u261D\\uD83C\\uDFFB|\\uD83D\\uDDB1\\uFE0F|\\uD83C\\uDF26\\uFE0F|\\uD83C\\uDF25\\uFE0F|\\uD83C\\uDF24\\uFE0F|\\uD83D\\uDEF3\\uFE0F|\\uD83D\\uDEE9\\uFE0F|\\uD83C\\uDC04\\uFE0F|\\uD83C\\uDD7F\\uFE0F|\\uD83C\\uDE02\\uFE0F|\\uD83C\\uDE1A\\uFE0F|\\uD83C\\uDE2F\\uFE0F|\\uD83C\\uDE37\\uFE0F|\\uD83C\\uDF9E\\uFE0F|\\uD83C\\uDF9F\\uFE0F|\\uD83C\\uDFCB\\uFE0F|\\uD83C\\uDFCC\\uFE0F|\\uD83C\\uDFCD\\uFE0F|\\uD83C\\uDFCE\\uFE0F|\\uD83C\\uDF96\\uFE0F|\\uD83C\\uDF97\\uFE0F|\\uD83C\\uDF36\\uFE0F|\\uD83C\\uDF27\\uFE0F|\\uD83C\\uDF28\\uFE0F|\\uD83C\\uDF29\\uFE0F|\\uD83C\\uDF2A\\uFE0F|\\uD83C\\uDF2B\\uFE0F|\\uD83C\\uDF2C\\uFE0F|\\uD83D\\uDC3F\\uFE0F|\\uD83D\\uDD77\\uFE0F|\\uD83D\\uDD78\\uFE0F|\\uD83C\\uDF21\\uFE0F|\\uD83C\\uDF99\\uFE0F|\\uD83C\\uDF9A\\uFE0F|\\uD83C\\uDF9B\\uFE0F|\\uD83C\\uDFF3\\uFE0F|\\uD83C\\uDFF5\\uFE0F|\\uD83C\\uDFF7\\uFE0F|\\uD83D\\uDCFD\\uFE0F|\\uD83D\\uDD49\\uFE0F|\\uD83D\\uDD4A\\uFE0F|\\uD83D\\uDD6F\\uFE0F|\\uD83D\\uDD70\\uFE0F|\\uD83D\\uDD73\\uFE0F|\\uD83D\\uDD76\\uFE0F|\\uD83D\\uDD79\\uFE0F|\\uD83D\\uDD87\\uFE0F|\\uD83D\\uDD8A\\uFE0F|\\uD83D\\uDD8B\\uFE0F|\\uD83D\\uDD8C\\uFE0F|\\uD83D\\uDD8D\\uFE0F|\\uD83D\\uDEE5\\uFE0F|\\uD83D\\uDDA8\\uFE0F|\\uD83D\\uDDB2\\uFE0F|\\uD83D\\uDDBC\\uFE0F|\\uD83D\\uDDC2\\uFE0F|\\uD83D\\uDDC3\\uFE0F|\\uD83D\\uDDC4\\uFE0F|\\uD83D\\uDDD1\\uFE0F|\\uD83D\\uDDD2\\uFE0F|\\uD83D\\uDDD3\\uFE0F|\\uD83D\\uDDDC\\uFE0F|\\uD83D\\uDDDD\\uFE0F|\\uD83D\\uDDDE\\uFE0F|\\uD83D\\uDDE1\\uFE0F|\\uD83D\\uDDE3\\uFE0F|\\uD83D\\uDDEF\\uFE0F|\\uD83D\\uDDF3\\uFE0F|\\uD83D\\uDDFA\\uFE0F|\\uD83D\\uDEE0\\uFE0F|\\uD83D\\uDEE1\\uFE0F|\\uD83D\\uDEE2\\uFE0F|\\uD83D\\uDEF0\\uFE0F|\\uD83C\\uDF7D\\uFE0F|\\uD83D\\uDC41\\uFE0F|\\uD83D\\uDD74\\uFE0F|\\uD83D\\uDD75\\uFE0F|\\uD83D\\uDD90\\uFE0F|\\uD83C\\uDFD4\\uFE0F|\\uD83C\\uDFD5\\uFE0F|\\uD83C\\uDFD6\\uFE0F|\\uD83C\\uDFD7\\uFE0F|\\uD83C\\uDFD8\\uFE0F|\\uD83C\\uDFD9\\uFE0F|\\uD83C\\uDFDA\\uFE0F|\\uD83C\\uDFDB\\uFE0F|\\uD83C\\uDFDC\\uFE0F|\\uD83C\\uDFDD\\uFE0F|\\uD83C\\uDFDE\\uFE0F|\\uD83C\\uDFDF\\uFE0F|\\uD83D\\uDECB\\uFE0F|\\uD83D\\uDECD\\uFE0F|\\uD83D\\uDECE\\uFE0F|\\uD83D\\uDECF\\uFE0F|\\uD83D\\uDEE3\\uFE0F|\\uD83D\\uDEE4\\uFE0F|4\\uFE0F\\u20E3|9\\uFE0F\\u20E3|0\\uFE0F\\u20E3|1\\uFE0F\\u20E3|2\\uFE0F\\u20E3|3\\uFE0F\\u20E3|#\\uFE0F\\u20E3|5\\uFE0F\\u20E3|6\\uFE0F\\u20E3|7\\uFE0F\\u20E3|8\\uFE0F\\u20E3|\\*\\uFE0F\\u20E3|\\u00A9\\uFE0F|\\u00AE\\uFE0F|\\u203C\\uFE0F|\\u2049\\uFE0F|\\u2122\\uFE0F|\\u2139\\uFE0F|\\u2194\\uFE0F|\\u2195\\uFE0F|\\u2196\\uFE0F|\\u2197\\uFE0F|\\u2198\\uFE0F|\\u2199\\uFE0F|\\u21A9\\uFE0F|\\u21AA\\uFE0F|\\u231A\\uFE0F|\\u231B\\uFE0F|\\u24C2\\uFE0F|\\u25AA\\uFE0F|\\u25AB\\uFE0F|\\u25B6\\uFE0F|\\u25C0\\uFE0F|\\u25FB\\uFE0F|\\u25FC\\uFE0F|\\u25FD\\uFE0F|\\u25FE\\uFE0F|\\u2600\\uFE0F|\\u2601\\uFE0F|\\u260E\\uFE0F|\\u2611\\uFE0F|\\u2614\\uFE0F|\\u2615\\uFE0F|\\u261D\\uFE0F|\\u263A\\uFE0F|\\u2648\\uFE0F|\\u2649\\uFE0F|\\u264A\\uFE0F|\\u264B\\uFE0F|\\u264C\\uFE0F|\\u264D\\uFE0F|\\u264E\\uFE0F|\\u264F\\uFE0F|\\u2650\\uFE0F|\\u2651\\uFE0F|\\u2652\\uFE0F|\\u2653\\uFE0F|\\u2660\\uFE0F|\\u2663\\uFE0F|\\u2665\\uFE0F|\\u2666\\uFE0F|\\u2668\\uFE0F|\\u267B\\uFE0F|\\u267F\\uFE0F|\\u2693\\uFE0F|\\u26A0\\uFE0F|\\u26A1\\uFE0F|\\u26AA\\uFE0F|\\u26AB\\uFE0F|\\u26BD\\uFE0F|\\u26BE\\uFE0F|\\u26C4\\uFE0F|\\u26C5\\uFE0F|\\u26D4\\uFE0F|\\u26EA\\uFE0F|\\u26F2\\uFE0F|\\u26F3\\uFE0F|\\u26F5\\uFE0F|\\u26FA\\uFE0F|\\u26FD\\uFE0F|\\u2702\\uFE0F|\\u2708\\uFE0F|\\u2709\\uFE0F|\\u270C\\uFE0F|\\u270F\\uFE0F|\\u2712\\uFE0F|\\u2714\\uFE0F|\\u2716\\uFE0F|\\u2733\\uFE0F|\\u2734\\uFE0F|\\u2744\\uFE0F|\\u2747\\uFE0F|\\u2757\\uFE0F|\\u2764\\uFE0F|\\u27A1\\uFE0F|\\u2934\\uFE0F|\\u2935\\uFE0F|\\u2B05\\uFE0F|\\u2B06\\uFE0F|\\u2B07\\uFE0F|\\u2B1B\\uFE0F|\\u2B1C\\uFE0F|\\u2B50\\uFE0F|\\u2B55\\uFE0F|\\u3030\\uFE0F|\\u303D\\uFE0F|\\u3297\\uFE0F|\\u3299\\uFE0F|\\u271D\\uFE0F|\\u2328\\uFE0F|\\u270D\\uFE0F|\\u23ED\\uFE0F|\\u23EE\\uFE0F|\\u23EF\\uFE0F|\\u23F1\\uFE0F|\\u23F2\\uFE0F|\\u23F8\\uFE0F|\\u23F9\\uFE0F|\\u23FA\\uFE0F|\\u2602\\uFE0F|\\u2603\\uFE0F|\\u2604\\uFE0F|\\u2618\\uFE0F|\\u2620\\uFE0F|\\u2622\\uFE0F|\\u2623\\uFE0F|\\u2626\\uFE0F|\\u262A\\uFE0F|\\u262E\\uFE0F|\\u262F\\uFE0F|\\u2638\\uFE0F|\\u2639\\uFE0F|\\u2692\\uFE0F|\\u2694\\uFE0F|\\u2696\\uFE0F|\\u2697\\uFE0F|\\u2699\\uFE0F|\\u269B\\uFE0F|\\u269C\\uFE0F|\\u26B0\\uFE0F|\\u26B1\\uFE0F|\\u26C8\\uFE0F|\\u26CF\\uFE0F|\\u26D1\\uFE0F|\\u26D3\\uFE0F|\\u26E9\\uFE0F|\\u26F0\\uFE0F|\\u26F1\\uFE0F|\\u26F4\\uFE0F|\\u26F7\\uFE0F|\\u26F8\\uFE0F|\\u26F9\\uFE0F|\\u2721\\uFE0F|\\u2763\\uFE0F|\\uD83C\\uDCCF|\\uD83C\\uDD70|\\uD83C\\uDD71|\\uD83C\\uDD7E|\\uD83C\\uDD8E|\\uD83C\\uDD91|\\uD83C\\uDD92|\\uD83C\\uDD93|\\uD83C\\uDD94|\\uD83C\\uDD95|\\uD83C\\uDD96|\\uD83C\\uDD97|\\uD83C\\uDD98|\\uD83C\\uDD99|\\uD83C\\uDD9A|\\uD83C\\uDE01|\\uD83C\\uDE32|\\uD83C\\uDE33|\\uD83C\\uDE34|\\uD83C\\uDE35|\\uD83C\\uDE36|\\uD83C\\uDE38|\\uD83C\\uDE39|\\uD83C\\uDE3A|\\uD83D\\uDDB1|\\uD83C\\uDE51|\\uD83C\\uDF00|\\uD83C\\uDF01|\\uD83C\\uDF02|\\uD83C\\uDF03|\\uD83C\\uDF04|\\uD83C\\uDF05|\\uD83C\\uDF06|\\uD83C\\uDF07|\\uD83C\\uDF08|\\uD83C\\uDF09|\\uD83C\\uDF0A|\\uD83C\\uDF0B|\\uD83C\\uDF0C|\\uD83C\\uDF0F|\\uD83C\\uDF11|\\uD83C\\uDF13|\\uD83C\\uDF14|\\uD83C\\uDF15|\\uD83C\\uDF19|\\uD83C\\uDF1B|\\uD83C\\uDF1F|\\uD83C\\uDF20|\\uD83C\\uDF30|\\uD83C\\uDF31|\\uD83C\\uDF34|\\uD83C\\uDF35|\\uD83C\\uDF37|\\uD83C\\uDF38|\\uD83C\\uDF39|\\uD83C\\uDF3A|\\uD83C\\uDF3B|\\uD83C\\uDF3C|\\uD83C\\uDF3D|\\uD83C\\uDF3E|\\uD83C\\uDF3F|\\uD83C\\uDF40|\\uD83C\\uDF41|\\uD83C\\uDF42|\\uD83C\\uDF43|\\uD83C\\uDF44|\\uD83C\\uDF45|\\uD83C\\uDF46|\\uD83C\\uDF47|\\uD83C\\uDF48|\\uD83C\\uDF49|\\uD83C\\uDF4A|\\uD83C\\uDF4C|\\uD83C\\uDF4D|\\uD83C\\uDF4E|\\uD83C\\uDF4F|\\uD83C\\uDF51|\\uD83C\\uDF52|\\uD83C\\uDF53|\\uD83C\\uDF54|\\uD83C\\uDF55|\\uD83C\\uDF56|\\uD83C\\uDF57|\\uD83C\\uDF58|\\uD83C\\uDF59|\\uD83C\\uDF5A|\\uD83C\\uDF5B|\\uD83C\\uDF5C|\\uD83C\\uDF5D|\\uD83C\\uDF5E|\\uD83C\\uDF5F|\\uD83C\\uDF60|\\uD83C\\uDF61|\\uD83C\\uDF62|\\uD83C\\uDF63|\\uD83C\\uDF64|\\uD83C\\uDF65|\\uD83C\\uDF66|\\uD83C\\uDF67|\\uD83C\\uDF68|\\uD83C\\uDF69|\\uD83C\\uDF6A|\\uD83C\\uDF6B|\\uD83C\\uDF6C|\\uD83C\\uDF6D|\\uD83C\\uDF6E|\\uD83C\\uDF6F|\\uD83C\\uDF70|\\uD83C\\uDF71|\\uD83C\\uDF72|\\uD83C\\uDF73|\\uD83C\\uDF74|\\uD83C\\uDF75|\\uD83C\\uDF76|\\uD83C\\uDF77|\\uD83C\\uDF78|\\uD83C\\uDF79|\\uD83C\\uDF7A|\\uD83C\\uDF7B|\\uD83C\\uDF80|\\uD83C\\uDF81|\\uD83C\\uDF82|\\uD83C\\uDF83|\\uD83C\\uDF84|\\uD83C\\uDF85|\\uD83C\\uDF86|\\uD83C\\uDF87|\\uD83C\\uDF88|\\uD83C\\uDF89|\\uD83C\\uDF8A|\\uD83C\\uDF8B|\\uD83C\\uDF8C|\\uD83C\\uDF8D|\\uD83C\\uDF8E|\\uD83C\\uDF8F|\\uD83C\\uDF90|\\uD83C\\uDF91|\\uD83C\\uDF92|\\uD83C\\uDF93|\\uD83C\\uDFA0|\\uD83C\\uDFA1|\\uD83C\\uDFA2|\\uD83C\\uDFA3|\\uD83C\\uDFA4|\\uD83C\\uDFA5|\\uD83C\\uDFA6|\\uD83C\\uDFA7|\\uD83C\\uDFA8|\\uD83C\\uDFA9|\\uD83C\\uDFAA|\\uD83C\\uDFAB|\\uD83C\\uDFAC|\\uD83C\\uDFAD|\\uD83C\\uDFAE|\\uD83C\\uDFAF|\\uD83C\\uDFB0|\\uD83C\\uDFB1|\\uD83C\\uDFB2|\\uD83C\\uDFB3|\\uD83C\\uDFB4|\\uD83C\\uDFB5|\\uD83C\\uDFB6|\\uD83C\\uDFB7|\\uD83C\\uDFB8|\\uD83C\\uDFB9|\\uD83C\\uDFBA|\\uD83C\\uDFBB|\\uD83C\\uDFBC|\\uD83C\\uDFBD|\\uD83C\\uDFBE|\\uD83C\\uDFBF|\\uD83C\\uDFC0|\\uD83C\\uDFC1|\\uD83C\\uDFC2|\\uD83C\\uDFC3|\\uD83C\\uDFC4|\\uD83C\\uDFC6|\\uD83C\\uDFC8|\\uD83C\\uDFCA|\\uD83C\\uDFE0|\\uD83C\\uDFE1|\\uD83C\\uDFE2|\\uD83C\\uDFE3|\\uD83C\\uDFE5|\\uD83C\\uDFE6|\\uD83C\\uDFE7|\\uD83C\\uDFE8|\\uD83C\\uDFE9|\\uD83C\\uDFEA|\\uD83C\\uDFEB|\\uD83C\\uDFEC|\\uD83C\\uDFED|\\uD83C\\uDFEE|\\uD83C\\uDFEF|\\uD83C\\uDFF0|\\uD83D\\uDC0C|\\uD83D\\uDC0D|\\uD83D\\uDC0E|\\uD83D\\uDC11|\\uD83D\\uDC12|\\uD83D\\uDC14|\\uD83D\\uDC17|\\uD83D\\uDC18|\\uD83D\\uDC19|\\uD83D\\uDC1A|\\uD83D\\uDC1B|\\uD83D\\uDC1C|\\uD83D\\uDC1D|\\uD83D\\uDC1E|\\uD83D\\uDC1F|\\uD83D\\uDC20|\\uD83D\\uDC21|\\uD83D\\uDC22|\\uD83D\\uDC23|\\uD83D\\uDC24|\\uD83D\\uDC25|\\uD83D\\uDC26|\\uD83D\\uDC27|\\uD83D\\uDC28|\\uD83D\\uDC29|\\uD83D\\uDC2B|\\uD83D\\uDC2C|\\uD83D\\uDC2D|\\uD83D\\uDC2E|\\uD83D\\uDC2F|\\uD83D\\uDC30|\\uD83D\\uDC31|\\uD83D\\uDC32|\\uD83D\\uDC33|\\uD83D\\uDC34|\\uD83D\\uDC35|\\uD83D\\uDC36|\\uD83D\\uDC37|\\uD83D\\uDC38|\\uD83D\\uDC39|\\uD83D\\uDC3A|\\uD83D\\uDC3B|\\uD83D\\uDC3C|\\uD83D\\uDC3D|\\uD83D\\uDC3E|\\uD83D\\uDC40|\\uD83D\\uDC42|\\uD83D\\uDC43|\\uD83D\\uDC44|\\uD83D\\uDC45|\\uD83D\\uDC46|\\uD83D\\uDC47|\\uD83D\\uDC48|\\uD83D\\uDC49|\\uD83D\\uDC4A|\\uD83D\\uDC4B|\\uD83D\\uDC4C|\\uD83D\\uDC4D|\\uD83D\\uDC4E|\\uD83D\\uDC4F|\\uD83D\\uDC50|\\uD83D\\uDC51|\\uD83D\\uDC52|\\uD83D\\uDC53|\\uD83D\\uDC54|\\uD83D\\uDC55|\\uD83D\\uDC56|\\uD83D\\uDC57|\\uD83D\\uDC58|\\uD83D\\uDC59|\\uD83D\\uDC5A|\\uD83D\\uDC5B|\\uD83D\\uDC5C|\\uD83D\\uDC5D|\\uD83D\\uDC5E|\\uD83D\\uDC5F|\\uD83D\\uDC60|\\uD83D\\uDC61|\\uD83D\\uDC62|\\uD83D\\uDC63|\\uD83D\\uDC64|\\uD83D\\uDC66|\\uD83D\\uDC67|\\uD83D\\uDC68|\\uD83D\\uDC69|\\uD83D\\uDC6A|\\uD83D\\uDC6B|\\uD83D\\uDC6E|\\uD83D\\uDC6F|\\uD83D\\uDC70|\\uD83D\\uDC71|\\uD83D\\uDC72|\\uD83D\\uDC73|\\uD83D\\uDC74|\\uD83D\\uDC75|\\uD83D\\uDC76|\\uD83D\\uDC77|\\uD83D\\uDC78|\\uD83D\\uDC79|\\uD83D\\uDC7A|\\uD83D\\uDC7B|\\uD83D\\uDC7C|\\uD83D\\uDC7D|\\uD83D\\uDC7E|\\uD83D\\uDC7F|\\uD83D\\uDC80|\\uD83D\\uDCC7|\\uD83D\\uDC81|\\uD83D\\uDC82|\\uD83D\\uDC83|\\uD83D\\uDC84|\\uD83D\\uDC85|\\uD83D\\uDCD2|\\uD83D\\uDC86|\\uD83D\\uDCD3|\\uD83D\\uDC87|\\uD83D\\uDCD4|\\uD83D\\uDC88|\\uD83D\\uDCD5|\\uD83D\\uDC89|\\uD83D\\uDCD6|\\uD83D\\uDC8A|\\uD83D\\uDCD7|\\uD83D\\uDC8B|\\uD83D\\uDCD8|\\uD83D\\uDC8C|\\uD83D\\uDCD9|\\uD83D\\uDC8D|\\uD83D\\uDCDA|\\uD83D\\uDC8E|\\uD83D\\uDCDB|\\uD83D\\uDC8F|\\uD83D\\uDCDC|\\uD83D\\uDC90|\\uD83D\\uDCDD|\\uD83D\\uDC91|\\uD83D\\uDCDE|\\uD83D\\uDC92|\\uD83D\\uDCDF|\\uD83D\\uDCE0|\\uD83D\\uDC93|\\uD83D\\uDCE1|\\uD83D\\uDCE2|\\uD83D\\uDC94|\\uD83D\\uDCE3|\\uD83D\\uDCE4|\\uD83D\\uDC95|\\uD83D\\uDCE5|\\uD83D\\uDCE6|\\uD83D\\uDC96|\\uD83D\\uDCE7|\\uD83D\\uDCE8|\\uD83D\\uDC97|\\uD83D\\uDCE9|\\uD83D\\uDCEA|\\uD83D\\uDC98|\\uD83D\\uDCEB|\\uD83D\\uDCEE|\\uD83D\\uDC99|\\uD83D\\uDCF0|\\uD83D\\uDCF1|\\uD83D\\uDC9A|\\uD83D\\uDCF2|\\uD83D\\uDCF3|\\uD83D\\uDC9B|\\uD83D\\uDCF4|\\uD83D\\uDCF6|\\uD83D\\uDC9C|\\uD83D\\uDCF7|\\uD83D\\uDCF9|\\uD83D\\uDC9D|\\uD83D\\uDCFA|\\uD83D\\uDCFB|\\uD83D\\uDC9E|\\uD83D\\uDCFC|\\uD83D\\uDD03|\\uD83D\\uDC9F|\\uD83D\\uDD0A|\\uD83D\\uDD0B|\\uD83D\\uDCA0|\\uD83D\\uDD0C|\\uD83D\\uDD0D|\\uD83D\\uDCA1|\\uD83D\\uDD0E|\\uD83D\\uDD0F|\\uD83D\\uDCA2|\\uD83D\\uDD10|\\uD83D\\uDD11|\\uD83D\\uDCA3|\\uD83D\\uDD12|\\uD83D\\uDD13|\\uD83D\\uDCA4|\\uD83D\\uDD14|\\uD83D\\uDD16|\\uD83D\\uDCA5|\\uD83D\\uDD17|\\uD83D\\uDD18|\\uD83D\\uDCA6|\\uD83D\\uDD19|\\uD83D\\uDD1A|\\uD83D\\uDCA7|\\uD83D\\uDD1B|\\uD83D\\uDD1C|\\uD83D\\uDCA8|\\uD83D\\uDD1D|\\uD83D\\uDD1E|\\uD83D\\uDCA9|\\uD83D\\uDD1F|\\uD83D\\uDCAA|\\uD83D\\uDD20|\\uD83D\\uDD21|\\uD83D\\uDCAB|\\uD83D\\uDD22|\\uD83D\\uDD23|\\uD83D\\uDCAC|\\uD83D\\uDD24|\\uD83D\\uDD25|\\uD83D\\uDCAE|\\uD83D\\uDD26|\\uD83D\\uDD27|\\uD83D\\uDCAF|\\uD83D\\uDD28|\\uD83D\\uDD29|\\uD83D\\uDCB0|\\uD83D\\uDD2A|\\uD83D\\uDD2B|\\uD83D\\uDCB1|\\uD83D\\uDD2E|\\uD83D\\uDCB2|\\uD83D\\uDD2F|\\uD83D\\uDCB3|\\uD83D\\uDD30|\\uD83D\\uDD31|\\uD83D\\uDCB4|\\uD83D\\uDD32|\\uD83D\\uDD33|\\uD83D\\uDCB5|\\uD83D\\uDD34|\\uD83D\\uDD35|\\uD83D\\uDCB8|\\uD83D\\uDD36|\\uD83D\\uDD37|\\uD83D\\uDCB9|\\uD83D\\uDD38|\\uD83D\\uDD39|\\uD83D\\uDCBA|\\uD83D\\uDD3A|\\uD83D\\uDD3B|\\uD83D\\uDCBB|\\uD83D\\uDD3C|\\uD83D\\uDCBC|\\uD83D\\uDD3D|\\uD83D\\uDD50|\\uD83D\\uDCBD|\\uD83D\\uDD51|\\uD83D\\uDCBE|\\uD83D\\uDD52|\\uD83D\\uDCBF|\\uD83D\\uDD53|\\uD83D\\uDCC0|\\uD83D\\uDD54|\\uD83D\\uDD55|\\uD83D\\uDCC1|\\uD83D\\uDD56|\\uD83D\\uDD57|\\uD83D\\uDCC2|\\uD83D\\uDD58|\\uD83D\\uDD59|\\uD83D\\uDCC3|\\uD83D\\uDD5A|\\uD83D\\uDD5B|\\uD83D\\uDCC4|\\uD83D\\uDDFB|\\uD83D\\uDDFC|\\uD83D\\uDCC5|\\uD83D\\uDDFD|\\uD83D\\uDDFE|\\uD83D\\uDCC6|\\uD83D\\uDDFF|\\uD83D\\uDE01|\\uD83D\\uDE02|\\uD83D\\uDE03|\\uD83D\\uDCC8|\\uD83D\\uDE04|\\uD83D\\uDE05|\\uD83D\\uDCC9|\\uD83D\\uDE06|\\uD83D\\uDE09|\\uD83D\\uDCCA|\\uD83D\\uDE0A|\\uD83D\\uDE0B|\\uD83D\\uDCCB|\\uD83D\\uDE0C|\\uD83D\\uDE0D|\\uD83D\\uDCCC|\\uD83D\\uDE0F|\\uD83D\\uDE12|\\uD83D\\uDCCD|\\uD83D\\uDE13|\\uD83D\\uDE14|\\uD83D\\uDCCE|\\uD83D\\uDE16|\\uD83D\\uDE18|\\uD83D\\uDCCF|\\uD83D\\uDE1A|\\uD83D\\uDE1C|\\uD83D\\uDCD0|\\uD83D\\uDE1D|\\uD83D\\uDE1E|\\uD83D\\uDCD1|\\uD83D\\uDE20|\\uD83D\\uDE21|\\uD83D\\uDE22|\\uD83D\\uDE23|\\uD83D\\uDE24|\\uD83D\\uDE25|\\uD83D\\uDE28|\\uD83D\\uDE29|\\uD83D\\uDE2A|\\uD83D\\uDE2B|\\uD83D\\uDE2D|\\uD83D\\uDE30|\\uD83D\\uDE31|\\uD83D\\uDE32|\\uD83D\\uDE33|\\uD83D\\uDE35|\\uD83D\\uDE37|\\uD83D\\uDE38|\\uD83D\\uDE39|\\uD83D\\uDE3A|\\uD83D\\uDE3B|\\uD83D\\uDE3C|\\uD83D\\uDE3D|\\uD83D\\uDE3E|\\uD83D\\uDE3F|\\uD83D\\uDE40|\\uD83D\\uDE45|\\uD83D\\uDE46|\\uD83D\\uDE47|\\uD83D\\uDE48|\\uD83D\\uDE49|\\uD83D\\uDE4A|\\uD83D\\uDE4B|\\uD83D\\uDE4C|\\uD83D\\uDE4D|\\uD83D\\uDE4E|\\uD83D\\uDE4F|\\uD83D\\uDE80|\\uD83D\\uDE83|\\uD83D\\uDE84|\\uD83D\\uDE85|\\uD83D\\uDE87|\\uD83D\\uDE89|\\uD83D\\uDE8C|\\uD83D\\uDE8F|\\uD83D\\uDE91|\\uD83D\\uDE92|\\uD83D\\uDE93|\\uD83D\\uDE95|\\uD83D\\uDE97|\\uD83D\\uDE99|\\uD83D\\uDE9A|\\uD83D\\uDEA2|\\uD83D\\uDEA4|\\uD83D\\uDEA5|\\uD83D\\uDEA7|\\uD83D\\uDEA8|\\uD83D\\uDEA9|\\uD83D\\uDEAA|\\uD83D\\uDEAB|\\uD83D\\uDEAC|\\uD83D\\uDEAD|\\uD83D\\uDEB2|\\uD83D\\uDEB6|\\uD83D\\uDEB9|\\uD83D\\uDEBA|\\uD83D\\uDEBB|\\uD83D\\uDEBC|\\uD83D\\uDEBD|\\uD83D\\uDEBE|\\uD83D\\uDEC0|\\uD83E\\uDD18|\\uD83D\\uDE00|\\uD83D\\uDE07|\\uD83D\\uDE08|\\uD83D\\uDE0E|\\uD83D\\uDE10|\\uD83D\\uDE11|\\uD83D\\uDE15|\\uD83D\\uDE17|\\uD83D\\uDE19|\\uD83D\\uDE1B|\\uD83D\\uDE1F|\\uD83D\\uDE26|\\uD83D\\uDE27|\\uD83D\\uDE2C|\\uD83D\\uDE2E|\\uD83D\\uDE2F|\\uD83D\\uDE34|\\uD83D\\uDE36|\\uD83D\\uDE81|\\uD83D\\uDE82|\\uD83D\\uDE86|\\uD83D\\uDE88|\\uD83D\\uDE8A|\\uD83D\\uDE8D|\\uD83D\\uDE8E|\\uD83D\\uDE90|\\uD83D\\uDE94|\\uD83D\\uDE96|\\uD83D\\uDE98|\\uD83D\\uDE9B|\\uD83D\\uDE9C|\\uD83D\\uDE9D|\\uD83D\\uDE9E|\\uD83D\\uDE9F|\\uD83D\\uDEA0|\\uD83D\\uDEA1|\\uD83D\\uDEA3|\\uD83D\\uDEA6|\\uD83D\\uDEAE|\\uD83D\\uDEAF|\\uD83D\\uDEB0|\\uD83D\\uDEB1|\\uD83D\\uDEB3|\\uD83D\\uDEB4|\\uD83D\\uDEB5|\\uD83D\\uDEB7|\\uD83D\\uDEB8|\\uD83D\\uDEBF|\\uD83D\\uDEC1|\\uD83D\\uDEC2|\\uD83D\\uDEC3|\\uD83D\\uDEC4|\\uD83D\\uDEC5|\\uD83C\\uDF0D|\\uD83C\\uDF0E|\\uD83C\\uDF10|\\uD83C\\uDF12|\\uD83C\\uDF16|\\uD83C\\uDF17|\\uD83C\\uDF18|\\uD83C\\uDF1A|\\uD83C\\uDF1C|\\uD83C\\uDF1D|\\uD83C\\uDF1E|\\uD83C\\uDF32|\\uD83C\\uDF33|\\uD83C\\uDF4B|\\uD83C\\uDF50|\\uD83C\\uDF7C|\\uD83C\\uDFC7|\\uD83C\\uDFC9|\\uD83C\\uDFE4|\\uD83D\\uDC00|\\uD83D\\uDC01|\\uD83D\\uDC02|\\uD83D\\uDC03|\\uD83D\\uDC04|\\uD83D\\uDC05|\\uD83D\\uDC06|\\uD83D\\uDC07|\\uD83D\\uDC08|\\uD83D\\uDC09|\\uD83D\\uDC0A|\\uD83D\\uDC0B|\\uD83D\\uDC0F|\\uD83D\\uDC10|\\uD83D\\uDC13|\\uD83D\\uDC15|\\uD83D\\uDC16|\\uD83D\\uDC2A|\\uD83D\\uDC65|\\uD83D\\uDC6C|\\uD83D\\uDC6D|\\uD83D\\uDCAD|\\uD83D\\uDCB6|\\uD83D\\uDCB7|\\uD83D\\uDCEC|\\uD83D\\uDCED|\\uD83D\\uDCEF|\\uD83D\\uDCF5|\\uD83D\\uDD00|\\uD83D\\uDD01|\\uD83D\\uDD02|\\uD83D\\uDD04|\\uD83D\\uDD05|\\uD83D\\uDD06|\\uD83D\\uDD07|\\uD83D\\uDD09|\\uD83D\\uDD15|\\uD83D\\uDD2C|\\uD83D\\uDD2D|\\uD83D\\uDD5C|\\uD83D\\uDD5D|\\uD83D\\uDD5E|\\uD83D\\uDD5F|\\uD83D\\uDD60|\\uD83D\\uDD61|\\uD83D\\uDD62|\\uD83D\\uDD63|\\uD83D\\uDD64|\\uD83D\\uDD65|\\uD83D\\uDD66|\\uD83D\\uDD67|\\uD83D\\uDD08|\\uD83D\\uDE8B|\\uD83C\\uDFC5|\\uD83C\\uDFF4|\\uD83D\\uDCF8|\\uD83D\\uDECC|\\uD83D\\uDD95|\\uD83D\\uDD96|\\uD83D\\uDE41|\\uD83D\\uDE42|\\uD83D\\uDEEB|\\uD83D\\uDEEC|\\uD83C\\uDFFB|\\uD83C\\uDFFC|\\uD83C\\uDFFD|\\uD83C\\uDFFE|\\uD83C\\uDFFF|\\uD83D\\uDE43|\\uD83E\\uDD11|\\uD83E\\uDD13|\\uD83E\\uDD17|\\uD83D\\uDE44|\\uD83E\\uDD14|\\uD83E\\uDD10|\\uD83E\\uDD12|\\uD83E\\uDD15|\\uD83E\\uDD16|\\uD83E\\uDD81|\\uD83E\\uDD84|\\uD83E\\uDD82|\\uD83E\\uDD80|\\uD83E\\uDD83|\\uD83E\\uDDC0|\\uD83C\\uDF2D|\\uD83C\\uDF2E|\\uD83C\\uDF2F|\\uD83C\\uDF7F|\\uD83C\\uDF7E|\\uD83C\\uDFF9|\\uD83C\\uDFFA|\\uD83D\\uDED0|\\uD83D\\uDD4B|\\uD83D\\uDD4C|\\uD83D\\uDD4D|\\uD83D\\uDD4E|\\uD83D\\uDCFF|\\uD83C\\uDFCF|\\uD83C\\uDFD0|\\uD83C\\uDFD1|\\uD83C\\uDFD2|\\uD83C\\uDFD3|\\uD83C\\uDFF8|\\uD83C\\uDF26|\\uD83C\\uDF25|\\uD83C\\uDF24|\\uD83D\\uDEF3|\\uD83D\\uDEE9|\\uD83D\\uDEE5|\\uD83D\\uDEE4|\\uD83D\\uDEE3|\\uD83D\\uDECF|\\uD83D\\uDECE|\\uD83D\\uDECD|\\uD83D\\uDECB|\\uD83C\\uDFDF|\\uD83C\\uDFDE|\\uD83C\\uDFDD|\\uD83C\\uDFDC|\\uD83C\\uDFDB|\\uD83C\\uDFDA|\\uD83C\\uDFD9|\\uD83C\\uDFD8|\\uD83C\\uDFD7|\\uD83C\\uDFD6|\\uD83C\\uDFD5|\\uD83C\\uDFD4|\\uD83D\\uDD90|\\uD83D\\uDD75|\\uD83D\\uDD74|\\uD83D\\uDC41|\\uD83C\\uDF7D|\\uD83D\\uDEF0|\\uD83D\\uDEE2|\\uD83D\\uDEE1|\\uD83D\\uDEE0|\\uD83D\\uDDFA|\\uD83D\\uDDF3|\\uD83D\\uDDEF|\\uD83D\\uDDE3|\\uD83D\\uDDE1|\\uD83D\\uDDDE|\\uD83D\\uDDDD|\\uD83D\\uDDDC|\\uD83D\\uDDD3|\\uD83D\\uDDD2|\\uD83D\\uDDD1|\\uD83D\\uDDC4|\\uD83D\\uDDC3|\\uD83D\\uDDC2|\\uD83D\\uDDBC|\\uD83D\\uDDB2|\\uD83D\\uDDA8|\\uD83D\\uDDA5|\\uD83D\\uDD8D|\\uD83D\\uDD8C|\\uD83D\\uDD8B|\\uD83D\\uDD8A|\\uD83D\\uDD87|\\uD83D\\uDD79|\\uD83D\\uDD76|\\uD83D\\uDD73|\\uD83D\\uDD70|\\uD83D\\uDD6F|\\uD83D\\uDD4A|\\uD83D\\uDD49|\\uD83D\\uDCFD|\\uD83C\\uDFF7|\\uD83C\\uDFF5|\\uD83C\\uDFF3|\\uD83C\\uDF9B|\\uD83C\\uDF9A|\\uD83C\\uDF99|\\uD83C\\uDF21|\\uD83D\\uDD78|\\uD83D\\uDD77|\\uD83D\\uDC3F|\\uD83C\\uDF2C|\\uD83C\\uDF2B|\\uD83C\\uDF2A|\\uD83C\\uDF29|\\uD83C\\uDF28|\\uD83C\\uDF27|\\uD83C\\uDF36|\\uD83C\\uDF97|\\uD83C\\uDF96|\\uD83C\\uDFCE|\\uD83C\\uDFCD|\\uD83C\\uDFCC|\\uD83C\\uDFCB|\\uD83C\\uDF9F|\\uD83C\\uDF9E|\\uD83C\\uDE37|\\uD83C\\uDE2F|\\uD83C\\uDE1A|\\uD83C\\uDE02|\\uD83C\\uDD7F|\\uD83C\\uDC04|\\uD83C\\uDE50|\\u2714|\\u2733|\\u2734|\\u2744|\\u2747|\\u2757|\\u2764|\\u27A1|\\u2934|\\u2935|\\u2B05|\\u2B06|\\u2B07|\\u2B1B|\\u2B1C|\\u2B50|\\u2B55|\\u3030|\\u303D|\\u3297|\\u3299|\\u2712|\\u270F|\\u270C|\\u2709|\\u2708|\\u2702|\\u26FD|\\u26FA|\\u26F5|\\u26F3|\\u26F2|\\u26EA|\\u26D4|\\u26C5|\\u26C4|\\u26BE|\\u26BD|\\u26AB|\\u26AA|\\u26A1|\\u26A0|\\u2693|\\u267F|\\u267B|\\u2668|\\u2666|\\u2665|\\u2663|\\u2660|\\u2653|\\u2652|\\u2651|\\u271D|\\u2650|\\u264F|\\u264E|\\u264D|\\u264C|\\u264B|\\u264A|\\u2649|\\u2648|\\u263A|\\u261D|\\u2615|\\u2614|\\u2611|\\u2328|\\u260E|\\u2601|\\u2600|\\u25FE|\\u25FD|\\u25FC|\\u25FB|\\u25C0|\\u25B6|\\u25AB|\\u25AA|\\u24C2|\\u2716|\\u231A|\\u21AA|\\u21A9|\\u2199|\\u2198|\\u2197|\\u2196|\\u2195|\\u2194|\\u2139|\\u2122|\\u270D|\\u2049|\\u203C|\\u00AE|\\u00A9|\\u27BF|\\u27B0|\\u2797|\\u2796|\\u2795|\\u2755|\\u2754|\\u2753|\\u274E|\\u274C|\\u2728|\\u270B|\\u270A|\\u2705|\\u26CE|\\u23F3|\\u23F0|\\u23EC|\\u23ED|\\u23EE|\\u23EF|\\u23F1|\\u23F2|\\u23F8|\\u23F9|\\u23FA|\\u2602|\\u2603|\\u2604|\\u2618|\\u2620|\\u2622|\\u2623|\\u2626|\\u262A|\\u262E|\\u262F|\\u2638|\\u2639|\\u2692|\\u2694|\\u2696|\\u2697|\\u2699|\\u269B|\\u269C|\\u26B0|\\u26B1|\\u26C8|\\u26CF|\\u26D1|\\u26D3|\\u26E9|\\u26F0|\\u26F1|\\u26F4|\\u26F7|\\u26F8|\\u26F9|\\u2721|\\u2763|\\u23EB|\\u23EA|\\u23E9|\\u231B)",
a.jsEscapeMap={"👩‍❤️‍💋‍👩":"1f469-2764-1f48b-1f469","👨‍❤️‍💋‍👨":"1f468-2764-1f48b-1f468","👨‍👨‍👦‍👦":"1f468-1f468-1f466-1f466","👨‍👨‍👧‍👦":"1f468-1f468-1f467-1f466","👨‍👨‍👧‍👧":"1f468-1f468-1f467-1f467","👨‍👩‍👦‍👦":"1f468-1f469-1f466-1f466","👨‍👩‍👧‍👦":"1f468-1f469-1f467-1f466","👨‍👩‍👧‍👧":"1f468-1f469-1f467-1f467","👩‍👩‍👦‍👦":"1f469-1f469-1f466-1f466","👩‍👩‍👧‍👦":"1f469-1f469-1f467-1f466","👩‍👩‍👧‍👧":"1f469-1f469-1f467-1f467","👩‍❤️‍👩":"1f469-2764-1f469","👨‍❤️‍👨":"1f468-2764-1f468","👨‍👨‍👦":"1f468-1f468-1f466","👨‍👨‍👧":"1f468-1f468-1f467","👨‍👩‍👧":"1f468-1f469-1f467","👩‍👩‍👦":"1f469-1f469-1f466","👩‍👩‍👧":"1f469-1f469-1f467","👁‍🗨":"1f441-1f5e8","#️⃣":"0023-20e3","0️⃣":"0030-20e3","1️⃣":"0031-20e3","2️⃣":"0032-20e3","3️⃣":"0033-20e3","4️⃣":"0034-20e3","5️⃣":"0035-20e3","6️⃣":"0036-20e3","7️⃣":"0037-20e3","8️⃣":"0038-20e3","9️⃣":"0039-20e3","*️⃣":"002a-20e3","🤘🏿":"1f918-1f3ff","🤘🏾":"1f918-1f3fe","🤘🏽":"1f918-1f3fd","🤘🏼":"1f918-1f3fc","🤘🏻":"1f918-1f3fb","🛀🏿":"1f6c0-1f3ff","🛀🏾":"1f6c0-1f3fe","🛀🏽":"1f6c0-1f3fd","🛀🏼":"1f6c0-1f3fc","🛀🏻":"1f6c0-1f3fb","🚶🏿":"1f6b6-1f3ff","🚶🏾":"1f6b6-1f3fe","🚶🏽":"1f6b6-1f3fd","🚶🏼":"1f6b6-1f3fc","🚶🏻":"1f6b6-1f3fb","🚵🏿":"1f6b5-1f3ff","🚵🏾":"1f6b5-1f3fe","🚵🏽":"1f6b5-1f3fd","🚵🏼":"1f6b5-1f3fc","🚵🏻":"1f6b5-1f3fb","🚴🏿":"1f6b4-1f3ff","🚴🏾":"1f6b4-1f3fe","🚴🏽":"1f6b4-1f3fd","🚴🏼":"1f6b4-1f3fc","🚴🏻":"1f6b4-1f3fb","🚣🏿":"1f6a3-1f3ff","🚣🏾":"1f6a3-1f3fe","🚣🏽":"1f6a3-1f3fd","🚣🏼":"1f6a3-1f3fc","🚣🏻":"1f6a3-1f3fb","🙏🏿":"1f64f-1f3ff","🙏🏾":"1f64f-1f3fe","🙏🏽":"1f64f-1f3fd","🙏🏼":"1f64f-1f3fc","🙏🏻":"1f64f-1f3fb","🙎🏿":"1f64e-1f3ff","🙎🏾":"1f64e-1f3fe","🙎🏽":"1f64e-1f3fd","🙎🏼":"1f64e-1f3fc","🙎🏻":"1f64e-1f3fb","🙍🏿":"1f64d-1f3ff","🙍🏾":"1f64d-1f3fe","🙍🏽":"1f64d-1f3fd","🙍🏼":"1f64d-1f3fc","🙍🏻":"1f64d-1f3fb","🙌🏿":"1f64c-1f3ff","🙌🏾":"1f64c-1f3fe","🙌🏽":"1f64c-1f3fd","🙌🏼":"1f64c-1f3fc","🙌🏻":"1f64c-1f3fb","🙋🏿":"1f64b-1f3ff","🙋🏾":"1f64b-1f3fe","🙋🏽":"1f64b-1f3fd","🙋🏼":"1f64b-1f3fc","🙋🏻":"1f64b-1f3fb","🙇🏿":"1f647-1f3ff","🙇🏾":"1f647-1f3fe","🙇🏽":"1f647-1f3fd","🙇🏼":"1f647-1f3fc","🙇🏻":"1f647-1f3fb","🙆🏿":"1f646-1f3ff","🙆🏾":"1f646-1f3fe","🙆🏽":"1f646-1f3fd","🙆🏼":"1f646-1f3fc","🙆🏻":"1f646-1f3fb","🙅🏿":"1f645-1f3ff","🙅🏾":"1f645-1f3fe","🙅🏽":"1f645-1f3fd","🙅🏼":"1f645-1f3fc","🙅🏻":"1f645-1f3fb","🖖🏿":"1f596-1f3ff","🖖🏾":"1f596-1f3fe","🖖🏽":"1f596-1f3fd","🖖🏼":"1f596-1f3fc","🖖🏻":"1f596-1f3fb","🖕🏿":"1f595-1f3ff","🖕🏾":"1f595-1f3fe","🖕🏽":"1f595-1f3fd","🖕🏼":"1f595-1f3fc","🖕🏻":"1f595-1f3fb","🖐🏿":"1f590-1f3ff","🖐🏾":"1f590-1f3fe","🖐🏽":"1f590-1f3fd","🖐🏼":"1f590-1f3fc","🖐🏻":"1f590-1f3fb","🕵🏿":"1f575-1f3ff","🕵🏾":"1f575-1f3fe","🕵🏽":"1f575-1f3fd","🕵🏼":"1f575-1f3fc","🕵🏻":"1f575-1f3fb","💪🏿":"1f4aa-1f3ff","💪🏾":"1f4aa-1f3fe","💪🏽":"1f4aa-1f3fd","💪🏼":"1f4aa-1f3fc","💪🏻":"1f4aa-1f3fb","💇🏿":"1f487-1f3ff","💇🏾":"1f487-1f3fe","💇🏽":"1f487-1f3fd","💇🏼":"1f487-1f3fc","💇🏻":"1f487-1f3fb","💆🏿":"1f486-1f3ff","💆🏾":"1f486-1f3fe","💆🏽":"1f486-1f3fd","💆🏼":"1f486-1f3fc","💆🏻":"1f486-1f3fb","💅🏿":"1f485-1f3ff","💅🏾":"1f485-1f3fe","💅🏽":"1f485-1f3fd","💅🏼":"1f485-1f3fc","💅🏻":"1f485-1f3fb","💃🏿":"1f483-1f3ff","💃🏾":"1f483-1f3fe","💃🏽":"1f483-1f3fd","💃🏼":"1f483-1f3fc","💃🏻":"1f483-1f3fb","💂🏿":"1f482-1f3ff","💂🏾":"1f482-1f3fe","💂🏽":"1f482-1f3fd","💂🏼":"1f482-1f3fc","💂🏻":"1f482-1f3fb","💁🏿":"1f481-1f3ff","💁🏾":"1f481-1f3fe","💁🏽":"1f481-1f3fd","💁🏼":"1f481-1f3fc","💁🏻":"1f481-1f3fb","👼🏿":"1f47c-1f3ff","👼🏾":"1f47c-1f3fe","👼🏽":"1f47c-1f3fd","👼🏼":"1f47c-1f3fc","👼🏻":"1f47c-1f3fb","👸🏿":"1f478-1f3ff","👸🏾":"1f478-1f3fe","👸🏽":"1f478-1f3fd","👸🏼":"1f478-1f3fc","👸🏻":"1f478-1f3fb","👷🏿":"1f477-1f3ff","👷🏾":"1f477-1f3fe","👷🏽":"1f477-1f3fd","👷🏼":"1f477-1f3fc","👷🏻":"1f477-1f3fb","👶🏿":"1f476-1f3ff","👶🏾":"1f476-1f3fe","👶🏽":"1f476-1f3fd","👶🏼":"1f476-1f3fc","👶🏻":"1f476-1f3fb","👵🏿":"1f475-1f3ff","👵🏾":"1f475-1f3fe","👵🏽":"1f475-1f3fd","👵🏼":"1f475-1f3fc","👵🏻":"1f475-1f3fb","👴🏿":"1f474-1f3ff","👴🏾":"1f474-1f3fe","👴🏽":"1f474-1f3fd","👴🏼":"1f474-1f3fc","👴🏻":"1f474-1f3fb","👳🏿":"1f473-1f3ff","👳🏾":"1f473-1f3fe","👳🏽":"1f473-1f3fd","👳🏼":"1f473-1f3fc","👳🏻":"1f473-1f3fb","👲🏿":"1f472-1f3ff","👲🏾":"1f472-1f3fe","👲🏽":"1f472-1f3fd","👲🏼":"1f472-1f3fc","👲🏻":"1f472-1f3fb","👱🏿":"1f471-1f3ff","👱🏾":"1f471-1f3fe","👱🏽":"1f471-1f3fd","👱🏼":"1f471-1f3fc","👱🏻":"1f471-1f3fb","👰🏿":"1f470-1f3ff","👰🏾":"1f470-1f3fe","👰🏽":"1f470-1f3fd","👰🏼":"1f470-1f3fc","👰🏻":"1f470-1f3fb","👮🏿":"1f46e-1f3ff","👮🏾":"1f46e-1f3fe","👮🏽":"1f46e-1f3fd","👮🏼":"1f46e-1f3fc","👮🏻":"1f46e-1f3fb","👩🏿":"1f469-1f3ff","👩🏾":"1f469-1f3fe","👩🏽":"1f469-1f3fd","👩🏼":"1f469-1f3fc","👩🏻":"1f469-1f3fb","👨🏿":"1f468-1f3ff","👨🏾":"1f468-1f3fe","👨🏽":"1f468-1f3fd","👨🏼":"1f468-1f3fc","👨🏻":"1f468-1f3fb","👧🏿":"1f467-1f3ff","👧🏾":"1f467-1f3fe","👧🏽":"1f467-1f3fd","👧🏼":"1f467-1f3fc","👧🏻":"1f467-1f3fb","👦🏿":"1f466-1f3ff","👦🏾":"1f466-1f3fe","👦🏽":"1f466-1f3fd","👦🏼":"1f466-1f3fc","👦🏻":"1f466-1f3fb","👐🏿":"1f450-1f3ff","👐🏾":"1f450-1f3fe","👐🏽":"1f450-1f3fd","👐🏼":"1f450-1f3fc","👐🏻":"1f450-1f3fb","👏🏿":"1f44f-1f3ff","👏🏾":"1f44f-1f3fe","👏🏽":"1f44f-1f3fd","👏🏼":"1f44f-1f3fc","👏🏻":"1f44f-1f3fb","👎🏿":"1f44e-1f3ff","👎🏾":"1f44e-1f3fe","👎🏽":"1f44e-1f3fd","👎🏼":"1f44e-1f3fc","👎🏻":"1f44e-1f3fb","👍🏿":"1f44d-1f3ff","👍🏾":"1f44d-1f3fe","👍🏽":"1f44d-1f3fd","👍🏼":"1f44d-1f3fc","👍🏻":"1f44d-1f3fb","👌🏿":"1f44c-1f3ff","👌🏾":"1f44c-1f3fe","👌🏽":"1f44c-1f3fd","👌🏼":"1f44c-1f3fc","👌🏻":"1f44c-1f3fb","👋🏿":"1f44b-1f3ff","👋🏾":"1f44b-1f3fe","👋🏽":"1f44b-1f3fd","👋🏼":"1f44b-1f3fc","👋🏻":"1f44b-1f3fb","👊🏿":"1f44a-1f3ff","👊🏾":"1f44a-1f3fe","👊🏽":"1f44a-1f3fd","👊🏼":"1f44a-1f3fc","👊🏻":"1f44a-1f3fb","👉🏿":"1f449-1f3ff","👉🏾":"1f449-1f3fe","👉🏽":"1f449-1f3fd","👉🏼":"1f449-1f3fc","👉🏻":"1f449-1f3fb","👈🏿":"1f448-1f3ff","👈🏾":"1f448-1f3fe","👈🏽":"1f448-1f3fd","👈🏼":"1f448-1f3fc","👈🏻":"1f448-1f3fb","👇🏿":"1f447-1f3ff","👇🏾":"1f447-1f3fe","👇🏽":"1f447-1f3fd","👇🏼":"1f447-1f3fc","👇🏻":"1f447-1f3fb","👆🏿":"1f446-1f3ff","👆🏾":"1f446-1f3fe","👆🏽":"1f446-1f3fd","👆🏼":"1f446-1f3fc","👆🏻":"1f446-1f3fb","👃🏿":"1f443-1f3ff","👃🏾":"1f443-1f3fe","👃🏽":"1f443-1f3fd","👃🏼":"1f443-1f3fc","👃🏻":"1f443-1f3fb","👂🏿":"1f442-1f3ff","👂🏾":"1f442-1f3fe","👂🏽":"1f442-1f3fd","👂🏼":"1f442-1f3fc","👂🏻":"1f442-1f3fb","🏋🏿":"1f3cb-1f3ff","🏋🏾":"1f3cb-1f3fe","🏋🏽":"1f3cb-1f3fd","🏋🏼":"1f3cb-1f3fc","🏋🏻":"1f3cb-1f3fb","🏊🏿":"1f3ca-1f3ff","🏊🏾":"1f3ca-1f3fe","🏊🏽":"1f3ca-1f3fd","🏊🏼":"1f3ca-1f3fc","🏊🏻":"1f3ca-1f3fb","🏇🏿":"1f3c7-1f3ff","🏇🏾":"1f3c7-1f3fe","🏇🏽":"1f3c7-1f3fd","🏇🏼":"1f3c7-1f3fc","🏇🏻":"1f3c7-1f3fb","🏄🏿":"1f3c4-1f3ff","🏄🏾":"1f3c4-1f3fe","🏄🏽":"1f3c4-1f3fd","🏄🏼":"1f3c4-1f3fc","🏄🏻":"1f3c4-1f3fb","🏃🏿":"1f3c3-1f3ff","🏃🏾":"1f3c3-1f3fe","🏃🏽":"1f3c3-1f3fd","🏃🏼":"1f3c3-1f3fc","🏃🏻":"1f3c3-1f3fb","🎅🏿":"1f385-1f3ff","🎅🏾":"1f385-1f3fe","🎅🏽":"1f385-1f3fd","🎅🏼":"1f385-1f3fc","🎅🏻":"1f385-1f3fb","🇿🇼":"1f1ff-1f1fc","🇿🇲":"1f1ff-1f1f2","🇿🇦":"1f1ff-1f1e6","🇾🇹":"1f1fe-1f1f9","🇾🇪":"1f1fe-1f1ea","🇽🇰":"1f1fd-1f1f0","🇼🇸":"1f1fc-1f1f8","🇼🇫":"1f1fc-1f1eb","🇻🇺":"1f1fb-1f1fa","🇻🇳":"1f1fb-1f1f3","🇻🇮":"1f1fb-1f1ee","🇻🇬":"1f1fb-1f1ec","🇻🇪":"1f1fb-1f1ea","🇻🇨":"1f1fb-1f1e8","🇻🇦":"1f1fb-1f1e6","🇺🇿":"1f1fa-1f1ff","🇺🇾":"1f1fa-1f1fe","🇺🇸":"1f1fa-1f1f8","🇺🇲":"1f1fa-1f1f2","🇺🇬":"1f1fa-1f1ec","🇺🇦":"1f1fa-1f1e6","🇹🇿":"1f1f9-1f1ff","🇹🇼":"1f1f9-1f1fc","🇹🇻":"1f1f9-1f1fb","🇹🇹":"1f1f9-1f1f9","🇹🇷":"1f1f9-1f1f7","🇹🇴":"1f1f9-1f1f4","🇹🇳":"1f1f9-1f1f3","🇹🇲":"1f1f9-1f1f2","🇹🇱":"1f1f9-1f1f1","🇹🇰":"1f1f9-1f1f0","🇹🇯":"1f1f9-1f1ef","🇹🇭":"1f1f9-1f1ed","🇹🇬":"1f1f9-1f1ec","🇹🇫":"1f1f9-1f1eb","🇹🇩":"1f1f9-1f1e9","🇹🇨":"1f1f9-1f1e8","🇹🇦":"1f1f9-1f1e6","🇸🇿":"1f1f8-1f1ff","🇸🇾":"1f1f8-1f1fe","🇸🇽":"1f1f8-1f1fd","🇸🇻":"1f1f8-1f1fb","🇸🇹":"1f1f8-1f1f9","🇸🇸":"1f1f8-1f1f8","🇸🇷":"1f1f8-1f1f7","🇸🇴":"1f1f8-1f1f4","🇸🇳":"1f1f8-1f1f3","🇸🇲":"1f1f8-1f1f2","🇸🇱":"1f1f8-1f1f1","🇸🇰":"1f1f8-1f1f0","🇸🇯":"1f1f8-1f1ef","🇸🇮":"1f1f8-1f1ee","🇸🇭":"1f1f8-1f1ed","🇸🇬":"1f1f8-1f1ec","🇸🇪":"1f1f8-1f1ea","🇸🇩":"1f1f8-1f1e9","🇸🇨":"1f1f8-1f1e8","🇸🇧":"1f1f8-1f1e7","🇸🇦":"1f1f8-1f1e6","🇷🇼":"1f1f7-1f1fc","🇷🇺":"1f1f7-1f1fa","🇷🇸":"1f1f7-1f1f8","🇷🇴":"1f1f7-1f1f4","🇷🇪":"1f1f7-1f1ea","🇶🇦":"1f1f6-1f1e6","🇵🇾":"1f1f5-1f1fe","🇵🇼":"1f1f5-1f1fc","🇵🇹":"1f1f5-1f1f9","🇵🇸":"1f1f5-1f1f8","🇵🇷":"1f1f5-1f1f7","🇵🇳":"1f1f5-1f1f3","🇵🇲":"1f1f5-1f1f2","🇵🇱":"1f1f5-1f1f1","🇵🇰":"1f1f5-1f1f0","🇵🇭":"1f1f5-1f1ed","🇵🇬":"1f1f5-1f1ec","🇵🇫":"1f1f5-1f1eb","🇵🇪":"1f1f5-1f1ea","🇵🇦":"1f1f5-1f1e6","🇴🇲":"1f1f4-1f1f2","🇳🇿":"1f1f3-1f1ff","🇳🇺":"1f1f3-1f1fa","🇳🇷":"1f1f3-1f1f7","🇳🇵":"1f1f3-1f1f5","🇳🇴":"1f1f3-1f1f4","🇳🇱":"1f1f3-1f1f1","🇳🇮":"1f1f3-1f1ee","🇳🇬":"1f1f3-1f1ec","🇳🇫":"1f1f3-1f1eb","🇳🇪":"1f1f3-1f1ea","🇳🇨":"1f1f3-1f1e8","🇳🇦":"1f1f3-1f1e6","🇲🇿":"1f1f2-1f1ff","🇲🇾":"1f1f2-1f1fe","🇲🇽":"1f1f2-1f1fd","🇲🇼":"1f1f2-1f1fc","🇲🇻":"1f1f2-1f1fb","🇲🇺":"1f1f2-1f1fa","🇲🇹":"1f1f2-1f1f9","🇲🇸":"1f1f2-1f1f8","🇲🇷":"1f1f2-1f1f7","🇲🇶":"1f1f2-1f1f6","🇲🇵":"1f1f2-1f1f5","🇲🇴":"1f1f2-1f1f4","🇲🇳":"1f1f2-1f1f3","🇲🇲":"1f1f2-1f1f2","🇲🇱":"1f1f2-1f1f1","🇲🇰":"1f1f2-1f1f0","🇲🇭":"1f1f2-1f1ed","🇲🇬":"1f1f2-1f1ec","🇲🇫":"1f1f2-1f1eb","🇲🇪":"1f1f2-1f1ea","🇲🇩":"1f1f2-1f1e9","🇲🇨":"1f1f2-1f1e8","🇲🇦":"1f1f2-1f1e6","🇱🇾":"1f1f1-1f1fe","🇱🇻":"1f1f1-1f1fb","🇱🇺":"1f1f1-1f1fa","🇱🇹":"1f1f1-1f1f9","🇱🇸":"1f1f1-1f1f8","🇱🇷":"1f1f1-1f1f7","🇱🇰":"1f1f1-1f1f0","🇱🇮":"1f1f1-1f1ee","🇱🇨":"1f1f1-1f1e8","🇱🇧":"1f1f1-1f1e7","🇱🇦":"1f1f1-1f1e6","🇰🇿":"1f1f0-1f1ff","🇰🇾":"1f1f0-1f1fe","🇰🇼":"1f1f0-1f1fc","🇰🇷":"1f1f0-1f1f7","🇰🇵":"1f1f0-1f1f5","🇰🇳":"1f1f0-1f1f3","🇰🇲":"1f1f0-1f1f2","🇰🇮":"1f1f0-1f1ee","🇰🇭":"1f1f0-1f1ed","🇰🇬":"1f1f0-1f1ec","🇰🇪":"1f1f0-1f1ea","🇯🇵":"1f1ef-1f1f5","🇯🇴":"1f1ef-1f1f4","🇯🇲":"1f1ef-1f1f2","🇯🇪":"1f1ef-1f1ea","🇮🇹":"1f1ee-1f1f9","🇮🇸":"1f1ee-1f1f8","🇮🇷":"1f1ee-1f1f7","🇮🇶":"1f1ee-1f1f6","🇮🇴":"1f1ee-1f1f4","🇮🇳":"1f1ee-1f1f3","🇮🇲":"1f1ee-1f1f2","🇮🇱":"1f1ee-1f1f1","🇮🇪":"1f1ee-1f1ea","🇮🇩":"1f1ee-1f1e9","🇮🇨":"1f1ee-1f1e8","🇭🇺":"1f1ed-1f1fa","🇭🇹":"1f1ed-1f1f9","🇭🇷":"1f1ed-1f1f7","🇭🇳":"1f1ed-1f1f3","🇭🇲":"1f1ed-1f1f2","🇭🇰":"1f1ed-1f1f0","🇬🇾":"1f1ec-1f1fe","🇬🇼":"1f1ec-1f1fc","🇬🇺":"1f1ec-1f1fa","🇬🇹":"1f1ec-1f1f9","🇬🇸":"1f1ec-1f1f8","🇬🇷":"1f1ec-1f1f7","🇬🇶":"1f1ec-1f1f6","🇬🇵":"1f1ec-1f1f5","🇬🇳":"1f1ec-1f1f3","🇬🇲":"1f1ec-1f1f2","🇬🇱":"1f1ec-1f1f1","🇬🇮":"1f1ec-1f1ee","🇬🇭":"1f1ec-1f1ed","🇬🇬":"1f1ec-1f1ec","🇬🇫":"1f1ec-1f1eb","🇬🇪":"1f1ec-1f1ea","🇬🇩":"1f1ec-1f1e9","🇬🇧":"1f1ec-1f1e7","🇬🇦":"1f1ec-1f1e6","🇫🇷":"1f1eb-1f1f7","🇫🇴":"1f1eb-1f1f4","🇫🇲":"1f1eb-1f1f2","🇫🇰":"1f1eb-1f1f0","🇫🇯":"1f1eb-1f1ef","🇫🇮":"1f1eb-1f1ee","🇪🇺":"1f1ea-1f1fa","🇪🇹":"1f1ea-1f1f9","🇪🇸":"1f1ea-1f1f8","🇪🇷":"1f1ea-1f1f7","🇪🇭":"1f1ea-1f1ed","🇪🇬":"1f1ea-1f1ec","🇪🇪":"1f1ea-1f1ea","🇪🇨":"1f1ea-1f1e8","🇪🇦":"1f1ea-1f1e6","🇩🇿":"1f1e9-1f1ff","🇩🇴":"1f1e9-1f1f4","🇩🇲":"1f1e9-1f1f2","🇩🇰":"1f1e9-1f1f0","🇩🇯":"1f1e9-1f1ef","🇩🇬":"1f1e9-1f1ec","🇩🇪":"1f1e9-1f1ea","🇨🇿":"1f1e8-1f1ff","🇨🇾":"1f1e8-1f1fe","🇨🇽":"1f1e8-1f1fd","🇨🇼":"1f1e8-1f1fc","🇨🇻":"1f1e8-1f1fb","🇨🇺":"1f1e8-1f1fa","🇨🇷":"1f1e8-1f1f7","🇨🇵":"1f1e8-1f1f5","🇨🇴":"1f1e8-1f1f4","🇨🇳":"1f1e8-1f1f3","🇨🇲":"1f1e8-1f1f2","🇨🇱":"1f1e8-1f1f1","🇨🇰":"1f1e8-1f1f0","🇨🇮":"1f1e8-1f1ee","🇨🇭":"1f1e8-1f1ed","🇨🇬":"1f1e8-1f1ec","🇨🇫":"1f1e8-1f1eb","🇨🇩":"1f1e8-1f1e9","🇨🇨":"1f1e8-1f1e8","🇨🇦":"1f1e8-1f1e6","🇧🇿":"1f1e7-1f1ff","🇧🇾":"1f1e7-1f1fe","🇧🇼":"1f1e7-1f1fc","🇧🇻":"1f1e7-1f1fb","🇧🇹":"1f1e7-1f1f9","🇧🇸":"1f1e7-1f1f8","🇧🇷":"1f1e7-1f1f7","🇧🇶":"1f1e7-1f1f6","🇧🇴":"1f1e7-1f1f4","🇧🇳":"1f1e7-1f1f3","🇧🇲":"1f1e7-1f1f2","🇧🇱":"1f1e7-1f1f1","🇧🇯":"1f1e7-1f1ef","🇧🇮":"1f1e7-1f1ee","🇧🇭":"1f1e7-1f1ed","🇧🇬":"1f1e7-1f1ec","🇧🇫":"1f1e7-1f1eb","🇧🇪":"1f1e7-1f1ea","🇧🇩":"1f1e7-1f1e9","🇧🇧":"1f1e7-1f1e7","🇧🇦":"1f1e7-1f1e6","🇦🇿":"1f1e6-1f1ff","🇦🇽":"1f1e6-1f1fd","🇦🇼":"1f1e6-1f1fc","🇦🇺":"1f1e6-1f1fa","🇦🇹":"1f1e6-1f1f9","🇦🇸":"1f1e6-1f1f8","🇦🇷":"1f1e6-1f1f7","🇦🇶":"1f1e6-1f1f6","🇦🇴":"1f1e6-1f1f4","🇦🇲":"1f1e6-1f1f2","🇦🇱":"1f1e6-1f1f1","🇦🇮":"1f1e6-1f1ee","🇦🇬":"1f1e6-1f1ec","🇦🇫":"1f1e6-1f1eb","🇦🇪":"1f1e6-1f1ea","🇦🇩":"1f1e6-1f1e9","🇦🇨":"1f1e6-1f1e8","🀄️":"1f004","🅿️":"1f17f","🈂️":"1f202","🈚️":"1f21a","🈯️":"1f22f","🈷️":"1f237","🎞️":"1f39e","🎟️":"1f39f","🏋️":"1f3cb","🏌️":"1f3cc","🏍️":"1f3cd","🏎️":"1f3ce","🎖️":"1f396","🎗️":"1f397","🌶️":"1f336","🌧️":"1f327","🌨️":"1f328","🌩️":"1f329","🌪️":"1f32a","🌫️":"1f32b","🌬️":"1f32c","🐿️":"1f43f","🕷️":"1f577","🕸️":"1f578","🌡️":"1f321","🎙️":"1f399","🎚️":"1f39a","🎛️":"1f39b","🏳️":"1f3f3","🏵️":"1f3f5","🏷️":"1f3f7","📽️":"1f4fd","🕉️":"1f549","🕊️":"1f54a","🕯️":"1f56f","🕰️":"1f570","🕳️":"1f573","🕶️":"1f576","🕹️":"1f579","🖇️":"1f587","🖊️":"1f58a","🖋️":"1f58b","🖌️":"1f58c","🖍️":"1f58d","🖥️":"1f5a5","🖨️":"1f5a8","🖲️":"1f5b2","🖼️":"1f5bc","🗂️":"1f5c2","🗃️":"1f5c3","🗄️":"1f5c4","🗑️":"1f5d1","🗒️":"1f5d2","🗓️":"1f5d3","🗜️":"1f5dc","🗝️":"1f5dd","🗞️":"1f5de","🗡️":"1f5e1","🗣️":"1f5e3","🗯️":"1f5ef","🗳️":"1f5f3","🗺️":"1f5fa","🛠️":"1f6e0","🛡️":"1f6e1","🛢️":"1f6e2","🛰️":"1f6f0","🍽️":"1f37d","👁️":"1f441","🕴️":"1f574","🕵️":"1f575","🖐️":"1f590","🏔️":"1f3d4","🏕️":"1f3d5","🏖️":"1f3d6","🏗️":"1f3d7","🏘️":"1f3d8","🏙️":"1f3d9","🏚️":"1f3da","🏛️":"1f3db","🏜️":"1f3dc","🏝️":"1f3dd","🏞️":"1f3de","🏟️":"1f3df","🛋️":"1f6cb","🛍️":"1f6cd","🛎️":"1f6ce","🛏️":"1f6cf","🛣️":"1f6e3","🛤️":"1f6e4","🛥️":"1f6e5","🛩️":"1f6e9","🛳️":"1f6f3","🌤️":"1f324","🌥️":"1f325","🌦️":"1f326","🖱️":"1f5b1","☝🏻":"261d-1f3fb","☝🏼":"261d-1f3fc","☝🏽":"261d-1f3fd","☝🏾":"261d-1f3fe","©️":"00a9","®️":"00ae","‼️":"203c","⁉️":"2049","™️":"2122","ℹ️":"2139","↔️":"2194","↕️":"2195","↖️":"2196","↗️":"2197","↘️":"2198","↙️":"2199","↩️":"21a9","↪️":"21aa","⌚️":"231a","⌛️":"231b","Ⓜ️":"24c2","▪️":"25aa","▫️":"25ab","▶️":"25b6","◀️":"25c0","◻️":"25fb","◼️":"25fc","◽️":"25fd","◾️":"25fe","☀️":"2600","☁️":"2601","☎️":"260e","☑️":"2611","☔️":"2614","☕️":"2615","☝️":"261d","☺️":"263a","♈️":"2648","♉️":"2649","♊️":"264a","♋️":"264b","♌️":"264c","♍️":"264d","♎️":"264e","♏️":"264f","♐️":"2650","♑️":"2651","♒️":"2652","♓️":"2653","♠️":"2660","♣️":"2663","♥️":"2665","♦️":"2666","♨️":"2668","♻️":"267b","♿️":"267f","⚓️":"2693","⚠️":"26a0","⚡️":"26a1","⚪️":"26aa","⚫️":"26ab","⚽️":"26bd","⚾️":"26be","⛄️":"26c4","⛅️":"26c5","⛔️":"26d4","⛪️":"26ea","⛲️":"26f2","⛳️":"26f3","⛵️":"26f5","⛺️":"26fa","⛽️":"26fd","✂️":"2702","✈️":"2708","✉️":"2709","✌️":"270c","✏️":"270f","✒️":"2712","✔️":"2714","✖️":"2716","✳️":"2733","✴️":"2734","❄️":"2744","❇️":"2747","❗️":"2757","❤️":"2764","➡️":"27a1","⤴️":"2934","⤵️":"2935","⬅️":"2b05","⬆️":"2b06","⬇️":"2b07","⬛️":"2b1b","⬜️":"2b1c","⭐️":"2b50","⭕️":"2b55","〰️":"3030","〽️":"303d","㊗️":"3297","㊙️":"3299","✝️":"271d","⌨️":"2328","✍️":"270d","⏭️":"23ed","⏮️":"23ee","⏯️":"23ef","⏱️":"23f1","⏲️":"23f2","⏸️":"23f8","⏹️":"23f9","⏺️":"23fa","☂️":"2602","☃️":"2603","☄️":"2604","☘️":"2618","☠️":"2620","☢️":"2622","☣️":"2623","☦️":"2626","☪️":"262a","☮️":"262e","☯️":"262f","☸️":"2638","☹️":"2639","⚒️":"2692","⚔️":"2694","⚖️":"2696","⚗️":"2697","⚙️":"2699","⚛️":"269b","⚜️":"269c","⚰️":"26b0","⚱️":"26b1","⛈️":"26c8","⛏️":"26cf","⛑️":"26d1","⛓️":"26d3","⛩️":"26e9","⛰️":"26f0","⛱️":"26f1","⛴️":"26f4","⛷️":"26f7","⛸️":"26f8","⛹️":"26f9","✡️":"2721","❣️":"2763","🃏":"1f0cf","🅰":"1f170","🅱":"1f171","🅾":"1f17e","🆎":"1f18e","🆑":"1f191","🆒":"1f192","🆓":"1f193","🆔":"1f194","🆕":"1f195","🆖":"1f196","🆗":"1f197","🆘":"1f198","🆙":"1f199","🆚":"1f19a","🈁":"1f201","🈲":"1f232","🈳":"1f233","🈴":"1f234","🈵":"1f235","🈶":"1f236","🈸":"1f238","🈹":"1f239","🈺":"1f23a","🉐":"1f250","🉑":"1f251","🌀":"1f300","🌁":"1f301","🌂":"1f302","🌃":"1f303","🌄":"1f304","🌅":"1f305","🌆":"1f306","🌇":"1f307","🌈":"1f308","🌉":"1f309","🌊":"1f30a","🌋":"1f30b","🌌":"1f30c","🌏":"1f30f","🌑":"1f311","🌓":"1f313","🌔":"1f314","🌕":"1f315","🌙":"1f319","🌛":"1f31b","🌟":"1f31f","🌠":"1f320","🌰":"1f330","🌱":"1f331","🌴":"1f334","🌵":"1f335","🌷":"1f337","🌸":"1f338","🌹":"1f339","🌺":"1f33a","🌻":"1f33b","🌼":"1f33c","🌽":"1f33d","🌾":"1f33e","🌿":"1f33f","🍀":"1f340","🍁":"1f341","🍂":"1f342","🍃":"1f343","🍄":"1f344","🍅":"1f345","🍆":"1f346","🍇":"1f347","🍈":"1f348","🍉":"1f349","🍊":"1f34a","🍌":"1f34c","🍍":"1f34d","🍎":"1f34e","🍏":"1f34f","🍑":"1f351","🍒":"1f352","🍓":"1f353","🍔":"1f354","🍕":"1f355","🍖":"1f356","🍗":"1f357","🍘":"1f358","🍙":"1f359","🍚":"1f35a","🍛":"1f35b","🍜":"1f35c","🍝":"1f35d","🍞":"1f35e","🍟":"1f35f","🍠":"1f360","🍡":"1f361","🍢":"1f362","🍣":"1f363","🍤":"1f364","🍥":"1f365","🍦":"1f366","🍧":"1f367","🍨":"1f368","🍩":"1f369","🍪":"1f36a","🍫":"1f36b","🍬":"1f36c","🍭":"1f36d","🍮":"1f36e","🍯":"1f36f","🍰":"1f370","🍱":"1f371","🍲":"1f372","🍳":"1f373","🍴":"1f374","🍵":"1f375","🍶":"1f376","🍷":"1f377","🍸":"1f378","🍹":"1f379","🍺":"1f37a","🍻":"1f37b","🎀":"1f380","🎁":"1f381","🎂":"1f382","🎃":"1f383","🎄":"1f384","🎅":"1f385","🎆":"1f386","🎇":"1f387","🎈":"1f388","🎉":"1f389","🎊":"1f38a","🎋":"1f38b","🎌":"1f38c","🎍":"1f38d","🎎":"1f38e","🎏":"1f38f","🎐":"1f390","🎑":"1f391","🎒":"1f392","🎓":"1f393","🎠":"1f3a0","🎡":"1f3a1","🎢":"1f3a2","🎣":"1f3a3","🎤":"1f3a4","🎥":"1f3a5","🎦":"1f3a6","🎧":"1f3a7","🎨":"1f3a8","🎩":"1f3a9","🎪":"1f3aa","🎫":"1f3ab","🎬":"1f3ac","🎭":"1f3ad","🎮":"1f3ae","🎯":"1f3af","🎰":"1f3b0","🎱":"1f3b1","🎲":"1f3b2","🎳":"1f3b3","🎴":"1f3b4","🎵":"1f3b5","🎶":"1f3b6","🎷":"1f3b7","🎸":"1f3b8","🎹":"1f3b9","🎺":"1f3ba","🎻":"1f3bb","🎼":"1f3bc","🎽":"1f3bd","🎾":"1f3be","🎿":"1f3bf","🏀":"1f3c0","🏁":"1f3c1","🏂":"1f3c2","🏃":"1f3c3","🏄":"1f3c4","🏆":"1f3c6","🏈":"1f3c8","🏊":"1f3ca","🏠":"1f3e0","🏡":"1f3e1","🏢":"1f3e2","🏣":"1f3e3","🏥":"1f3e5","🏦":"1f3e6","🏧":"1f3e7","🏨":"1f3e8","🏩":"1f3e9","🏪":"1f3ea","🏫":"1f3eb","🏬":"1f3ec","🏭":"1f3ed","🏮":"1f3ee","🏯":"1f3ef","🏰":"1f3f0","🐌":"1f40c","🐍":"1f40d","🐎":"1f40e","🐑":"1f411","🐒":"1f412","🐔":"1f414","🐗":"1f417","🐘":"1f418","🐙":"1f419","🐚":"1f41a","🐛":"1f41b","🐜":"1f41c","🐝":"1f41d","🐞":"1f41e","🐟":"1f41f","🐠":"1f420","🐡":"1f421","🐢":"1f422","🐣":"1f423","🐤":"1f424","🐥":"1f425","🐦":"1f426","🐧":"1f427","🐨":"1f428","🐩":"1f429","🐫":"1f42b","🐬":"1f42c","🐭":"1f42d","🐮":"1f42e","🐯":"1f42f","🐰":"1f430","🐱":"1f431","🐲":"1f432","🐳":"1f433","🐴":"1f434","🐵":"1f435","🐶":"1f436","🐷":"1f437","🐸":"1f438","🐹":"1f439","🐺":"1f43a","🐻":"1f43b","🐼":"1f43c","🐽":"1f43d","🐾":"1f43e","👀":"1f440","👂":"1f442","👃":"1f443","👄":"1f444","👅":"1f445","👆":"1f446","👇":"1f447","👈":"1f448","👉":"1f449","👊":"1f44a","👋":"1f44b","👌":"1f44c","👍":"1f44d","👎":"1f44e","👏":"1f44f","👐":"1f450","👑":"1f451","👒":"1f452","👓":"1f453","👔":"1f454","👕":"1f455","👖":"1f456","👗":"1f457","👘":"1f458","👙":"1f459","👚":"1f45a","👛":"1f45b","👜":"1f45c","👝":"1f45d","👞":"1f45e","👟":"1f45f","👠":"1f460","👡":"1f461","👢":"1f462","👣":"1f463","👤":"1f464","👦":"1f466","👧":"1f467","👨":"1f468","👩":"1f469","👪":"1f46a","👫":"1f46b","👮":"1f46e","👯":"1f46f","👰":"1f470","👱":"1f471","👲":"1f472","👳":"1f473","👴":"1f474","👵":"1f475","👶":"1f476","👷":"1f477","👸":"1f478","👹":"1f479","👺":"1f47a","👻":"1f47b","👼":"1f47c","👽":"1f47d","👾":"1f47e","👿":"1f47f","💀":"1f480","📇":"1f4c7","💁":"1f481","💂":"1f482","💃":"1f483","💄":"1f484","💅":"1f485","📒":"1f4d2","💆":"1f486","📓":"1f4d3","💇":"1f487","📔":"1f4d4","💈":"1f488","📕":"1f4d5","💉":"1f489","📖":"1f4d6","💊":"1f48a","📗":"1f4d7","💋":"1f48b","📘":"1f4d8","💌":"1f48c","📙":"1f4d9","💍":"1f48d","📚":"1f4da","💎":"1f48e","📛":"1f4db","💏":"1f48f","📜":"1f4dc","💐":"1f490","📝":"1f4dd","💑":"1f491","📞":"1f4de","💒":"1f492","📟":"1f4df","📠":"1f4e0","💓":"1f493","📡":"1f4e1","📢":"1f4e2","💔":"1f494","📣":"1f4e3","📤":"1f4e4","💕":"1f495","📥":"1f4e5","📦":"1f4e6","💖":"1f496","📧":"1f4e7","📨":"1f4e8","💗":"1f497","📩":"1f4e9","📪":"1f4ea","💘":"1f498","📫":"1f4eb","📮":"1f4ee","💙":"1f499","📰":"1f4f0","📱":"1f4f1","💚":"1f49a","📲":"1f4f2","📳":"1f4f3","💛":"1f49b","📴":"1f4f4","📶":"1f4f6","💜":"1f49c","📷":"1f4f7","📹":"1f4f9","💝":"1f49d","📺":"1f4fa","📻":"1f4fb","💞":"1f49e","📼":"1f4fc","🔃":"1f503","💟":"1f49f","🔊":"1f50a","🔋":"1f50b","💠":"1f4a0","🔌":"1f50c","🔍":"1f50d","💡":"1f4a1","🔎":"1f50e","🔏":"1f50f","💢":"1f4a2","🔐":"1f510","🔑":"1f511","💣":"1f4a3","🔒":"1f512","🔓":"1f513","💤":"1f4a4","🔔":"1f514","🔖":"1f516","💥":"1f4a5","🔗":"1f517","🔘":"1f518","💦":"1f4a6","🔙":"1f519","🔚":"1f51a","💧":"1f4a7","🔛":"1f51b","🔜":"1f51c","💨":"1f4a8","🔝":"1f51d","🔞":"1f51e","💩":"1f4a9","🔟":"1f51f","💪":"1f4aa","🔠":"1f520","🔡":"1f521","💫":"1f4ab","🔢":"1f522","🔣":"1f523","💬":"1f4ac","🔤":"1f524","🔥":"1f525","💮":"1f4ae","🔦":"1f526","🔧":"1f527","💯":"1f4af","🔨":"1f528","🔩":"1f529","💰":"1f4b0","🔪":"1f52a","🔫":"1f52b","💱":"1f4b1","🔮":"1f52e","💲":"1f4b2","🔯":"1f52f","💳":"1f4b3","🔰":"1f530","🔱":"1f531","💴":"1f4b4","🔲":"1f532","🔳":"1f533","💵":"1f4b5","🔴":"1f534","🔵":"1f535","💸":"1f4b8","🔶":"1f536","🔷":"1f537","💹":"1f4b9","🔸":"1f538","🔹":"1f539","💺":"1f4ba","🔺":"1f53a","🔻":"1f53b","💻":"1f4bb","🔼":"1f53c","💼":"1f4bc","🔽":"1f53d","🕐":"1f550","💽":"1f4bd","🕑":"1f551","💾":"1f4be","🕒":"1f552","💿":"1f4bf","🕓":"1f553","📀":"1f4c0","🕔":"1f554","🕕":"1f555","📁":"1f4c1","🕖":"1f556","🕗":"1f557","📂":"1f4c2","🕘":"1f558","🕙":"1f559","📃":"1f4c3","🕚":"1f55a","🕛":"1f55b","📄":"1f4c4","🗻":"1f5fb","🗼":"1f5fc","📅":"1f4c5","🗽":"1f5fd","🗾":"1f5fe","📆":"1f4c6","🗿":"1f5ff","😁":"1f601","😂":"1f602","😃":"1f603","📈":"1f4c8","😄":"1f604","😅":"1f605","📉":"1f4c9","😆":"1f606","😉":"1f609","📊":"1f4ca","😊":"1f60a","😋":"1f60b","📋":"1f4cb","😌":"1f60c","😍":"1f60d","📌":"1f4cc","😏":"1f60f","😒":"1f612","📍":"1f4cd","😓":"1f613","😔":"1f614","📎":"1f4ce","😖":"1f616","😘":"1f618","📏":"1f4cf","😚":"1f61a","😜":"1f61c","📐":"1f4d0","😝":"1f61d","😞":"1f61e","📑":"1f4d1","😠":"1f620","😡":"1f621","😢":"1f622","😣":"1f623","😤":"1f624","😥":"1f625","😨":"1f628","😩":"1f629","😪":"1f62a","😫":"1f62b","😭":"1f62d","😰":"1f630","😱":"1f631","😲":"1f632","😳":"1f633","😵":"1f635","😷":"1f637","😸":"1f638","😹":"1f639","😺":"1f63a","😻":"1f63b","😼":"1f63c","😽":"1f63d","😾":"1f63e","😿":"1f63f","🙀":"1f640","🙅":"1f645","🙆":"1f646","🙇":"1f647","🙈":"1f648","🙉":"1f649","🙊":"1f64a","🙋":"1f64b","🙌":"1f64c","🙍":"1f64d","🙎":"1f64e","🙏":"1f64f","🚀":"1f680","🚃":"1f683","🚄":"1f684","🚅":"1f685","🚇":"1f687","🚉":"1f689","🚌":"1f68c","🚏":"1f68f","🚑":"1f691","🚒":"1f692","🚓":"1f693","🚕":"1f695","🚗":"1f697","🚙":"1f699","🚚":"1f69a","🚢":"1f6a2","🚤":"1f6a4","🚥":"1f6a5","🚧":"1f6a7","🚨":"1f6a8","🚩":"1f6a9","🚪":"1f6aa","🚫":"1f6ab","🚬":"1f6ac","🚭":"1f6ad","🚲":"1f6b2","🚶":"1f6b6","🚹":"1f6b9","🚺":"1f6ba","🚻":"1f6bb","🚼":"1f6bc","🚽":"1f6bd","🚾":"1f6be","🛀":"1f6c0","🤘":"1f918","😀":"1f600","😇":"1f607","😈":"1f608","😎":"1f60e","😐":"1f610","😑":"1f611","😕":"1f615","😗":"1f617","😙":"1f619","😛":"1f61b","😟":"1f61f","😦":"1f626","😧":"1f627","😬":"1f62c","😮":"1f62e","😯":"1f62f","😴":"1f634","😶":"1f636","🚁":"1f681","🚂":"1f682","🚆":"1f686","🚈":"1f688","🚊":"1f68a","🚍":"1f68d","🚎":"1f68e","🚐":"1f690","🚔":"1f694","🚖":"1f696","🚘":"1f698","🚛":"1f69b","🚜":"1f69c","🚝":"1f69d","🚞":"1f69e","🚟":"1f69f","🚠":"1f6a0","🚡":"1f6a1","🚣":"1f6a3","🚦":"1f6a6","🚮":"1f6ae","🚯":"1f6af","🚰":"1f6b0","🚱":"1f6b1","🚳":"1f6b3","🚴":"1f6b4","🚵":"1f6b5","🚷":"1f6b7","🚸":"1f6b8","🚿":"1f6bf","🛁":"1f6c1","🛂":"1f6c2","🛃":"1f6c3","🛄":"1f6c4","🛅":"1f6c5","🌍":"1f30d","🌎":"1f30e","🌐":"1f310","🌒":"1f312","🌖":"1f316","🌗":"1f317","🌘":"1f318","🌚":"1f31a","🌜":"1f31c","🌝":"1f31d","🌞":"1f31e","🌲":"1f332","🌳":"1f333","🍋":"1f34b","🍐":"1f350","🍼":"1f37c","🏇":"1f3c7","🏉":"1f3c9","🏤":"1f3e4","🐀":"1f400","🐁":"1f401","🐂":"1f402","🐃":"1f403","🐄":"1f404","🐅":"1f405","🐆":"1f406","🐇":"1f407","🐈":"1f408","🐉":"1f409","🐊":"1f40a","🐋":"1f40b","🐏":"1f40f","🐐":"1f410","🐓":"1f413","🐕":"1f415","🐖":"1f416","🐪":"1f42a","👥":"1f465","👬":"1f46c","👭":"1f46d","💭":"1f4ad","💶":"1f4b6","💷":"1f4b7","📬":"1f4ec","📭":"1f4ed","📯":"1f4ef","📵":"1f4f5","🔀":"1f500","🔁":"1f501","🔂":"1f502","🔄":"1f504","🔅":"1f505","🔆":"1f506","🔇":"1f507","🔉":"1f509","🔕":"1f515","🔬":"1f52c","🔭":"1f52d","🕜":"1f55c","🕝":"1f55d","🕞":"1f55e","🕟":"1f55f","🕠":"1f560","🕡":"1f561","🕢":"1f562","🕣":"1f563","🕤":"1f564","🕥":"1f565","🕦":"1f566","🕧":"1f567","🔈":"1f508","🚋":"1f68b","🏅":"1f3c5","🏴":"1f3f4","📸":"1f4f8","🛌":"1f6cc","🖕":"1f595","🖖":"1f596","🙁":"1f641","🙂":"1f642","🛫":"1f6eb","🛬":"1f6ec","🏻":"1f3fb","🏼":"1f3fc","🏽":"1f3fd","🏾":"1f3fe","🏿":"1f3ff","🙃":"1f643","🤑":"1f911","🤓":"1f913","🤗":"1f917","🙄":"1f644","🤔":"1f914","🤐":"1f910","🤒":"1f912","🤕":"1f915","🤖":"1f916","🦁":"1f981","🦄":"1f984","🦂":"1f982","🦀":"1f980","🦃":"1f983","🧀":"1f9c0","🌭":"1f32d","🌮":"1f32e","🌯":"1f32f","🍿":"1f37f","🍾":"1f37e","🏹":"1f3f9","🏺":"1f3fa","🛐":"1f6d0","🕋":"1f54b","🕌":"1f54c","🕍":"1f54d","🕎":"1f54e","📿":"1f4ff","🏏":"1f3cf","🏐":"1f3d0","🏑":"1f3d1","🏒":"1f3d2","🏓":"1f3d3","🏸":"1f3f8","⏩":"23e9","⏪":"23ea","⏫":"23eb","⏬":"23ec","⏰":"23f0","⏳":"23f3","⛎":"26ce","✅":"2705","✊":"270a","✋":"270b","✨":"2728","❌":"274c","❎":"274e","❓":"2753","❔":"2754","❕":"2755","➕":"2795","➖":"2796","➗":"2797","➰":"27b0","➿":"27bf","©":"00a9","®":"00ae","‼":"203c","⁉":"2049","™":"2122","ℹ":"2139","↔":"2194","↕":"2195","↖":"2196","↗":"2197","↘":"2198","↙":"2199","↩":"21a9","↪":"21aa","⌚":"231a","⌛":"231b","Ⓜ":"24c2","▪":"25aa","▫":"25ab","▶":"25b6","◀":"25c0","◻":"25fb","◼":"25fc","◽":"25fd","◾":"25fe","☀":"2600","☁":"2601","☎":"260e","☑":"2611","☔":"2614","☕":"2615","☝":"261d","☺":"263a","♈":"2648","♉":"2649","♊":"264a","♋":"264b","♌":"264c","♍":"264d","♎":"264e","♏":"264f","♐":"2650","♑":"2651","♒":"2652","♓":"2653","♠":"2660","♣":"2663","♥":"2665","♦":"2666","♨":"2668","♻":"267b","♿":"267f","⚓":"2693","⚠":"26a0","⚡":"26a1","⚪":"26aa","⚫":"26ab","⚽":"26bd","⚾":"26be","⛄":"26c4","⛅":"26c5","⛔":"26d4","⛪":"26ea","⛲":"26f2","⛳":"26f3","⛵":"26f5","⛺":"26fa","⛽":"26fd","✂":"2702","✈":"2708","✉":"2709","✌":"270c","✏":"270f","✒":"2712","✔":"2714","✖":"2716","✳":"2733","✴":"2734","❄":"2744","❇":"2747","❗":"2757","❤":"2764","➡":"27a1","⤴":"2934","⤵":"2935","⬅":"2b05","⬆":"2b06","⬇":"2b07","⬛":"2b1b","⬜":"2b1c","⭐":"2b50","⭕":"2b55","〰":"3030","〽":"303d","㊗":"3297","㊙":"3299","🀄":"1f004","🅿":"1f17f","🈂":"1f202","🈚":"1f21a","🈯":"1f22f","🈷":"1f237","🎞":"1f39e","🎟":"1f39f","🏋":"1f3cb","🏌":"1f3cc","🏍":"1f3cd","🏎":"1f3ce","🎖":"1f396","🎗":"1f397","🌶":"1f336","🌧":"1f327","🌨":"1f328","🌩":"1f329","🌪":"1f32a","🌫":"1f32b","🌬":"1f32c","🐿":"1f43f","🕷":"1f577","🕸":"1f578","🌡":"1f321","🎙":"1f399","🎚":"1f39a","🎛":"1f39b","🏳":"1f3f3","🏵":"1f3f5","🏷":"1f3f7","📽":"1f4fd","✝":"271d","🕉":"1f549","🕊":"1f54a","🕯":"1f56f","🕰":"1f570","🕳":"1f573","🕶":"1f576","🕹":"1f579","🖇":"1f587","🖊":"1f58a","🖋":"1f58b","🖌":"1f58c","🖍":"1f58d","🖥":"1f5a5","🖨":"1f5a8","⌨":"2328","🖲":"1f5b2","🖼":"1f5bc","🗂":"1f5c2","🗃":"1f5c3","🗄":"1f5c4","🗑":"1f5d1","🗒":"1f5d2","🗓":"1f5d3","🗜":"1f5dc","🗝":"1f5dd","🗞":"1f5de","🗡":"1f5e1","🗣":"1f5e3","🗯":"1f5ef","🗳":"1f5f3","🗺":"1f5fa","🛠":"1f6e0","🛡":"1f6e1","🛢":"1f6e2","🛰":"1f6f0","🍽":"1f37d","👁":"1f441","🕴":"1f574","🕵":"1f575","✍":"270d","🖐":"1f590","🏔":"1f3d4","🏕":"1f3d5","🏖":"1f3d6","🏗":"1f3d7","🏘":"1f3d8","🏙":"1f3d9","🏚":"1f3da","🏛":"1f3db","🏜":"1f3dc","🏝":"1f3dd","🏞":"1f3de","🏟":"1f3df","🛋":"1f6cb","🛍":"1f6cd","🛎":"1f6ce","🛏":"1f6cf","🛣":"1f6e3","🛤":"1f6e4","🛥":"1f6e5","🛩":"1f6e9","🛳":"1f6f3","⏭":"23ed","⏮":"23ee","⏯":"23ef","⏱":"23f1","⏲":"23f2","⏸":"23f8","⏹":"23f9","⏺":"23fa","☂":"2602","☃":"2603","☄":"2604","☘":"2618","☠":"2620","☢":"2622","☣":"2623","☦":"2626","☪":"262a","☮":"262e","☯":"262f","☸":"2638","☹":"2639","⚒":"2692","⚔":"2694","⚖":"2696","⚗":"2697","⚙":"2699","⚛":"269b","⚜":"269c","⚰":"26b0","⚱":"26b1","⛈":"26c8","⛏":"26cf","⛑":"26d1","⛓":"26d3","⛩":"26e9","⛰":"26f0","⛱":"26f1","⛴":"26f4","⛷":"26f7","⛸":"26f8","⛹":"26f9","✡":"2721","❣":"2763","🌤":"1f324","🌥":"1f325","🌦":"1f326","🖱":"1f5b1"},a.imagePathPNG="//cdn.jsdelivr.net/emojione/assets/png/",a.imagePathSVG="//cdn.jsdelivr.net/emojione/assets/svg/",a.imagePathSVGSprites="./../assets/sprites/emojione.sprites.svg",a.imageType="png",a.sprites=!1,a.unicodeAlt=!0,a.ascii=!1,a.cacheBustParam="?v=2.1.1",a.regShortNames=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|("+a.shortnames+")","gi"),a.regAscii=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|((\\s|^)"+a.asciiRegexp+"(?=\\s|$|[!,.?]))","g"),a.regUnicode=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|("+a.unicodeRegexp+")","gi"),a.toImage=function(b){return b=a.unicodeToImage(b),b=a.shortnameToImage(b)},a.unifyUnicode=function(b){return b=a.toShort(b),b=a.shortnameToUnicode(b)},a.shortnameToAscii=function(b){var c,d=a.objectFlip(a.asciiList);return b=b.replace(a.regShortNames,function(b){return"undefined"!=typeof b&&""!==b&&b in a.emojioneList?(c=a.emojioneList[b][a.emojioneList[b].length-1],"undefined"!=typeof d[c]?d[c]:b):b})},a.shortnameToUnicode=function(b){var c;return b=b.replace(a.regShortNames,function(b){return"undefined"!=typeof b&&""!==b&&b in a.emojioneList?(c=a.emojioneList[b][0].toUpperCase(),a.convert(c)):b}),a.ascii&&(b=b.replace(a.regAscii,function(b,d,e,f){return"undefined"!=typeof f&&""!==f&&a.unescapeHTML(f)in a.asciiList?(f=a.unescapeHTML(f),c=a.asciiList[f].toUpperCase(),e+a.convert(c)):b})),b},a.shortnameToImage=function(b){var c,d,e;return b=b.replace(a.regShortNames,function(b){return"undefined"!=typeof b&&""!==b&&b in a.emojioneList?(d=a.emojioneList[b][a.emojioneList[b].length-1],e=a.unicodeAlt?a.convert(d.toUpperCase()):b,c="png"===a.imageType?a.sprites?'<span class="emojione-'+d+'" title="'+b+'">'+e+"</span>":'<img class="emojione" alt="'+e+'" src="'+a.imagePathPNG+d+".png"+a.cacheBustParam+'"/>':a.sprites?'<svg class="emojione"><description>'+e+'</description><use xlink:href="'+a.imagePathSVGSprites+"#emoji-"+d+'"></use></svg>':'<object class="emojione" data="'+a.imagePathSVG+d+".svg"+a.cacheBustParam+'" type="image/svg+xml" standby="'+e+'">'+e+"</object>"):b}),a.ascii&&(b=b.replace(a.regAscii,function(b,f,g,h){return"undefined"!=typeof h&&""!==h&&a.unescapeHTML(h)in a.asciiList?(h=a.unescapeHTML(h),d=a.asciiList[h],e=a.unicodeAlt?a.convert(d.toUpperCase()):a.escapeHTML(h),c="png"===a.imageType?a.sprites?g+'<span class="emojione-'+d+'" title="'+a.escapeHTML(h)+'">'+e+"</span>":g+'<img class="emojione" alt="'+e+'" src="'+a.imagePathPNG+d+".png"+a.cacheBustParam+'"/>':a.sprites?'<svg class="emojione"><description>'+e+'</description><use xlink:href="'+a.imagePathSVGSprites+"#emoji-"+d+'"></use></svg>':g+'<object class="emojione" data="'+a.imagePathSVG+d+".svg"+a.cacheBustParam+'" type="image/svg+xml" standby="'+e+'">'+e+"</object>"):b})),b},a.unicodeToImage=function(b){var c,d,e;if(!a.unicodeAlt||a.sprites)var f=a.mapShortToUnicode();return b=b.replace(a.regUnicode,function(b){return"undefined"!=typeof b&&""!==b&&b in a.jsEscapeMap?(d=a.jsEscapeMap[b],e=a.unicodeAlt?a.convert(d.toUpperCase()):f[d],c="png"===a.imageType?a.sprites?'<span class="emojione-'+d+'" title="'+f[d]+'">'+e+"</span>":'<img class="emojione" alt="'+e+'" src="'+a.imagePathPNG+d+".png"+a.cacheBustParam+'"/>':a.sprites?'<svg class="emojione"><description>'+e+'</description><use xlink:href="'+a.imagePathSVGSprites+"#emoji-"+d+'"></use></svg>':'<img class="emojione" alt="'+e+'" src="'+a.imagePathSVG+d+".svg"+a.cacheBustParam+'"/>'):b;
})},a.toShort=function(b){for(var c in a.emojioneList)if(a.emojioneList.hasOwnProperty(c))for(var d=0,e=a.emojioneList[c].length;e>d;d++){var f=a.emojioneList[c][d];b=a.replaceAll(b,a.convert(f.toUpperCase()),c)}return b},a.convert=function(a){if(a.indexOf("-")>-1){for(var b=[],c=a.split("-"),d=0;d<c.length;d++){var e=parseInt(c[d],16);if(e>=65536&&1114111>=e){var f=Math.floor((e-65536)/1024)+55296,g=(e-65536)%1024+56320;e=String.fromCharCode(f)+String.fromCharCode(g)}else e=String.fromCharCode(e);b.push(e)}return b.join("")}var c=parseInt(a,16);if(c>=65536&&1114111>=c){var f=Math.floor((c-65536)/1024)+55296,g=(c-65536)%1024+56320;return String.fromCharCode(f)+String.fromCharCode(g)}return String.fromCharCode(c)},a.escapeHTML=function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return a.replace(/[&<>"']/g,function(a){return b[a]})},a.unescapeHTML=function(a){var b={"&amp;":"&","&#38;":"&","&#x26;":"&","&lt;":"<","&#60;":"<","&#x3C;":"<","&gt;":">","&#62;":">","&#x3E;":">","&quot;":'"',"&#34;":'"',"&#x22;":'"',"&apos;":"'","&#39;":"'","&#x27;":"'"};return a.replace(/&(?:amp|#38|#x26|lt|#60|#x3C|gt|#62|#x3E|apos|#39|#x27|quot|#34|#x22);/gi,function(a){return b[a]})},a.mapShortToUnicode=function(){var b={};for(var c in a.emojioneList)if(a.emojioneList.hasOwnProperty(c))for(var d=0,e=a.emojioneList[c].length;e>d;d++)b[a.emojioneList[c][d]]=c;return b},a.objectFlip=function(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&(c[a[b]]=b);return c},a.escapeRegExp=function(a){return a.replace(/[-[\]{}()*+?.,;:&\\^$|#\s]/g,"\\$&")},a.replaceAll=function(b,c,d){var e=a.escapeRegExp(c),f=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|("+e+")","gi"),g=function(a,b){return"undefined"==typeof b||""===b?a:d};return b.replace(f,g)}}(this.emojione=this.emojione||{}),"object"==typeof module&&(module.exports=this.emojione),define("emojione",function(a){return function(){var b,c;return c=function(){return this.emojione.imagePathPNG="/assets/images/emojione/png/",this.emojione.cacheBustParam="",this.emojione},b=c.apply(a,arguments)}}(this)),define("core/lib/util/emoji_helper",["require","emojione","core/lib/report"],function(a){var b=a("emojione"),c=a("core/lib/report");return{parse:function(a){try{return b.unicodeToImage(a)}catch(b){return c.error({message:b.message},b),a}},convert:b.convert}}),define("css!components/hovercard_link/src/hovercard_link",[],function(){}),define("stache!components/hovercard_link/src/hovercard_link",["mustache"],function(a){var b='{{#plain}}{{name}}{{/plain}}{{^plain}}<a class="yammer-object yj-hovercard-link {{extendedClass}}" href="{{web_url}}" data-resource-model="{{type}}" data-resource-id="{{id}}" data-yammer-object="{{type}}:{{id}}" data-qaid="hovercard_link"><span class="yj-hovercard-link--name">{{{name}}}</span><NetworkLabel/></a>{{/plain}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/hovercard_link/src/hovercard_link",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/network_label/index","models/helpers/models","core/lib/urls","backbone","core/lib/util/emoji_helper","css!./hovercard_link.css","html!./hovercard_link"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/network_label/index"),g=a("models/helpers/models"),h=a("core/lib/urls"),i=a("backbone"),j=a("core/lib/util/emoji_helper");return a("css!./hovercard_link.css"),c.extend({mixins:[d,e],template:a("html!./hovercard_link"),tagName:"span",views:{NetworkLabel:"_getNetworkLabel"},initialize:function(){if(!this.model)throw"Hovercard link requires a user or group model"},getTemplateData:function(){var a=g.getHelperForModel(this.model),c=this.options.plain?a.getFullName(this.model):j.parse(b.escape(a.getFullName(this.model)));return{id:this.model.get("id"),type:this.model.get("type"),web_url:h.indexForModel(this.model),name:c,extendedClass:this.options.extendedClass,plain:this.options.plain}},render:function(){return i.trigger("/ui/hovercard/add",this.$el,{id:this.model.id,type:this.model.get("type")}),this},_getNetworkLabel:function(){return new f(this.options)}})}),define("components/hovercard_link/index",["require","./src/hovercard_link"],function(a){"use strict";return a("./src/hovercard_link")}),define("common-ui/lib/ui/permalinks",["require","components/hovercard_link/src/link","components/hovercard_link/index"],function(a){var b=a("components/hovercard_link/src/link"),c=a("components/hovercard_link/index");return function(a,d){d=d||{};var e,f=a.get("type");switch(f){case"like":case"user":case"group":e=new c({model:a});break;default:e=new b({model:a})}return e.render().el.innerHTML}}),define("models/helpers/message",["require","jquery","underscore","core/lib/model_helper","core/lib/namespace","common-ui/lib/ui/permalinks","backbone","core/lib/string_helper","core/lib/tr","core/lib/uri_helper","mustache","models/helpers/models","models/helpers/group"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/model_helper"),e=a("core/lib/namespace"),f=a("common-ui/lib/ui/permalinks"),g=a("backbone"),h=a("core/lib/string_helper"),i=a("core/lib/tr"),j=a("core/lib/uri_helper"),k=a("mustache"),l=a("models/helpers/models"),m=a("models/helpers/group"),n={user:"user",group:"group",suggestor:"user",inviter:"user",network:"network"},o={accept_external_group_invitation_label:"external_groups_responder_accept_label",reject_external_group_invitation_label:"external_groups_responder_reject_label",accept_external_group_member_suggestion_label:"accept_button_label",reject_external_group_member_suggestion_label:"external_groups_responder_reject_label",accept_external_group_invitation_success:"you_have_joined_the_external_group",accept_external_group_invitation_error:"error_joining_external_group",reject_external_group_invitation_success:"reject_joining_external_group",reject_external_group_invitation_error:"error_rejecting_join_external_group",accept_external_group_member_suggestion_error:"external_group_member_suggestion_accept_failure",accept_external_group_member_suggestion_success:"external_group_member_suggestion_accept_success",reject_external_group_member_suggestion_error:"external_group_member_suggestion_reject_failure",reject_external_group_member_suggestion_success:"external_group_member_suggestion_reject_success",external_groups_access_disabled_for_foreign_network:"external_groups_access_disabled_for_network",external_groups_access_disabled_for_local_network:"external_groups_access_disabled_for_network"};return e.ns("yam.helper.message",{referencesRegex:/\[\[(\w+):(\d+)\]\]/gm,stripAnchorRegex:/<[\/]{0,1}([aAiI]|[bB]^[rR]|li|LI|ul|UL|ol|OL|em|EM|strong|STRONG|span|SPAN|[pP])[^><]*>/gi,httpRegex:/(?:ht|f)tp(?:s?)\:\/\//,linkTemplate:'<a href="{{href}}" title="{{href}}" target="_blank" rel="noreferrer">{{{text}}}</a>',buildUnseenLine:function(){var a='<div class="yj-read-items"><h2 class="yj-read-items--text"><span>{{text}}</span></h2></div>',c=b(k.render(a,{text:i.t("previously_loaded")}));return g.trigger("/ui/tooltip/add",{target:c,text:i.t("new_messages_are_displayed_above_this_line_messages")}),c},truncateLinks:function(a){var b=a||"";return b.replace(j.HREF_PATTERN,this._truncateLink.bind(this))},linkifyFullLinks:function(a){return a.replace(j.HREF_PATTERN,this._linkifyFullLink.bind(this))},linkifyHighlightedLinks:function(a){var b=this._stripHtml(a),c=this.linkifyFullLinks(b.text),d=this._stripHtml(c),e=this._mergeTags(b.tags,d.tags);return this._buildHtml(d.text,e,a.length+c.length,!0)},truncateText:function(a,b){return a.length>b?a.substr(0,b)+"…":a},getFirstUserReference:function(a){var b=/\[\[user:(\d+)\]\]/.exec(a);return b?b[1]:void 0},getNetworkId:function(a){var b=a.get("thread"),c=a.getGroup(),d=null;return c&&m.isExternal(c)?d=c.get("network_id"):b&&(d=b.get("networkId")),d},replaceReferences:function(a,b){var c=this;return a.replace(this.referencesRegex,function(a,d,e){return c._createObjectForReference(d,e,b)})},_createObjectForReference:function(a,b,c){c=c||{};var e=d.objectForReference({type:a,id:b}),g=l.getHelperForModel(e);if(!e)return"";var h;return h=c.nameOnly?g.getFullName?g.getFullName(e):e.getPlainBody():c.plain?e.getPlainBody():f(e)},translateFromKey:function(a,b,d){var e={};c.each(b,function(a,b){var c=this._parseTranslationDataKey(b);e[c.key]=this._createPlaceholderContent(c.type,c.key,a,d)},this);var f=o[a]||a;return i.t(f,e)},_parseTranslationDataKey:function(a){var b=a.split("_"),c=b.length>1?b.pop():"",d=b.join("_");return{key:d,type:c}},_createPlaceholderContent:function(a,b,c,d){return"id"===a?this._buildPlaceholderFromId(b,c,d):"array"===a?this._buildPlaceholderFromArray(c):c},_buildPlaceholderFromId:function(a,b,c){var d=n[a]||a;return this._createObjectForReference(d,b,c)},_buildPlaceholderFromArray:function(a){var b,d=3;if(0===a.length)b="";else if(a.length<=d)b=i.tlist(a);else{var e=c.first(a,d-1),f=a.length-e.length;e.push(i.t("count_others",{count:f})),b=i.tlist(e)}return b},findReferences:function(a){var b=[];return a.replace(this.referencesRegex,function(a,c,d){b.push({id:parseInt(d,10),modelName:h.camelize(c,!0)})}),b},bookmark:function(a){a.bookmarked=!0},unbookmark:function(a){a.bookmarked=!1},isBookmarked:function(a){return!!a.bookmarked},_linkifyFullLink:function(a){return a=b("<div>").html(a).text(),k.render(this.linkTemplate,{href:this.httpRegex.test(a)?a:"http://"+a,text:a})},_truncateLink:function(a){return a=b("<div>").html(a).text(),k.render(this.linkTemplate,{href:this.httpRegex.test(a)?a:"http://"+a,text:this.truncateText(a,this._findLinkClipPoint(a,60))})},_findLinkClipPoint:function(a,b){var c=a.length;if(b>=c)return c;var d=-1,e=20,f=/(\/)[^\/]*$/,g=a.substr(0,b),h=f.exec(g);return d=h&&h.index?h.index+1:d,d=e>d?b:d,d=d>a.length?a.length:d},_mergeTags:function(a,b){var c,d={};if(!a)return b;if(!b)return a;this._pushRealIndex(a,b,!0),this._pushRealIndex(b,a,!1);for(c in a)d[a[c].realIndex]=a[c];for(c in b)d[b[c].realIndex]=b[c];return d},_pushRealIndex:function(a,b,c){var d,e,f,g;for(d in a){f=a[d];for(e in b)g=b[e],f.strippedIndex<g.strippedIndex?g.realIndex+=f.html.length:f.strippedIndex==g.strippedIndex&&(c&&(g.open&&f.open||g.open&&!f.open)||!c&&(!g.open&&!f.open||g.open&&!f.open))&&(g.realIndex+=f.html.length)}},_buildHtml:function(a,b,d,e){var f,g,h,i=e?0:d,j=[],k=-999;b=c(b).sortBy(function(a){return a.realIndex});for(h in b){if(g=b[h],e&&g.strippedIndex>=d){if(g.strippedIndex!==d||!b[h++]||b[h++].strippedIndex!==d||b[h++].strippedIndex===d&&0===k)break}else if(!e&&g.strippedIndex<=d&&(g.strippedIndex!=d||b[h++]&&b[h++].strippedIndex===d&&0!==k)){k=this._incrementIndex(k,g);continue}e&&(k=this._incrementIndex(k,g)),f=g.strippedIndex,j.push(a.substring(i,f)),j.push(g.html),i=f}return e?j.push(a.substring(i,d)):j.push(a.substring(i)),j.join("")},_incrementIndex:function(a,b){return-999==a&&(a=0),b.open?a+1:a-1},_stripHtml:function(a){var b,c,d,e=0;return c=a.replace(this.stripAnchorRegex,function(a,c,f){return d=d||{},b=parseInt(f,10),d[f]={open:0!==a.indexOf("</"),html:a,strippedIndex:b-e,realIndex:b},e+=a.length,""}),{text:c,tags:d}}}),yam.helper.message}),define("models/helpers/conversation",[],function(){var a=function(a){return a.participating_names||a.participants||[]},b=function(b,c){return a(b).filter(function(a){return a.id!==c.id})},c=function(b){return a(b).map(function(a){return a.id})};return{getParticipants:a,getParticipantsExcluding:b,getParticipantIds:c}}),define("models/lib/model/class_events/on_message_create",["require","core/lib/i18n","core/lib/log","core/lib/namespace"],function(a){var b=a("core/lib/i18n"),c=a("core/lib/log"),d=a("core/lib/namespace");return d.ns("yam.model.classEvents.onMessageCreate",{fixThreadCounts:function(a){var b=a.getThread();b&&a.id>b.stats.latest_reply_id&&(c.warn("Fixed thread.stats.latest_reply_id"),b.stats.latest_reply_id=a.id)},setTextDirection:function(a){a.body&&(a.textDirection="string"==typeof a.language?b.getTextDirectionByLanguageCode(a.language):b.getTextDirectionByFirstStrongCharacter(a.getParsedBodyWithoutReferences()))}}),yam.model.classEvents.onMessageCreate}),define("stache!common-ui/lib/helper/html_truncator",["mustache"],function(a){var b='<span class="truncated-body">{{{truncatedHtml}}}</span>\n<span class="truncated-body-nav">\n  <a class="expand-collapse-link expand-body {{expandBtnClass}}" href="javascript://" role="button">{{expandText}}\n  </a>\n</span>\n<span class="remaining-body" style="display:none;">{{{originalMarkup}}}</span>\n<span class="truncated-body-nav">\n  <a class="expand-collapse-link collapse-body {{expandBtnClass}}" style="display:none;" href="javascript://" role="button">\n    {{collapseText}}\n  </a>\n</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),function(a){var b=/(\s*\S+|\s)$/;a.truncate=function(b,c){return a("<div></div>").append(b).truncate(c).html()},a.fn.truncate=function(c){a.isNumeric(c)&&(c={length:c});var d=a.extend({},a.truncate.defaults,c);return this.each(function(){var c=a(this);d.noBreaks&&c.find("br").replaceWith(" ");var e=c.text(),f=e.length-d.length;d.stripTags&&c.text(e),d.words&&f>0&&(f=e.length-e.slice(0,d.length).replace(b,"").length-1),0>f||!f&&!d.truncated||a.each(c.contents().get().reverse(),function(b,c){var e=a(c),g=e.text(),h=g.length;return f>=h?(d.truncated=!0,f-=h,void e.remove()):3===c.nodeType?(a(c.splitText(h-f-1)).replaceWith(d.ellipsis),!1):(e.truncate(a.extend(d,{length:h-f})),!1)})})},a.truncate.defaults={stripTags:!1,words:!1,noBreaks:!1,length:1/0,ellipsis:"…"}}(jQuery),define("jquery-truncate",function(){}),define("common-ui/lib/helper/html_truncator",["require","jquery","underscore","core/lib/tr","html!./html_truncator","jquery-truncate"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/tr"),e=a("html!./html_truncator");a("jquery-truncate");var f={length:500,buffer:250,words:!0},g=function(a){return b("<div/>").html(a).text().length},h=function(a,d){d=c.extend({},f,d);var e=b.truncate(a,d);return g(a)<=g(e)+d.buffer?a:e},i=function(a,h){h=c.extend({},f,{ellipsis:""},h);var i=b.truncate(a,h);return g(a)<=g(i)+h.buffer?a:e({truncatedHtml:i,originalMarkup:a,expandBtnClass:"yj-small",expandText:h.expandText?h.expandText:d.t("expand"),collapseText:d.t("collapse")})};return{truncate:h,truncateWithLink:i}}),define("models/lib/helper/message/parsed_body_formatter_mixin",["require","underscore","core/lib/backbone_base_class","mustache","models/helpers/message","core/lib/model_helper","core/lib/report","core/lib/uri_helper","core/lib/treatment","core/lib/util/emoji_helper","core/lib/yammer_uri","common-ui/lib/helper/html_truncator","components/hovercard_link/src/link","components/hovercard_link/index"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_class"),d=a("mustache"),e=a("models/helpers/message"),f=a("core/lib/model_helper"),g=a("core/lib/report"),h=a("core/lib/uri_helper"),i=a("core/lib/treatment"),j=a("core/lib/util/emoji_helper"),k=a("core/lib/yammer_uri"),l=a("common-ui/lib/helper/html_truncator"),m=a("components/hovercard_link/src/link"),n=a("components/hovercard_link/index"),o=/\[\[?(\w+):(\d+)\]?(:[^\s\]]+)?\]/gm,p=/(<br[\s\/]*>\s*)*cc:\s*(<a[^]*)?/i,q=/[\r\n]+\s*cc:[^]*/,r=/(^|\n{2})cc: \[\[[^\n]+\]\]$/,s="{{{url}}}",t='<a class="linkified" href="{{url}}" rel="nofollow noreferrer"{{#newTab}} target="_blank"{{/newTab}}>{{linkText}}</a>',u=function(a,c){if(void 0!==a){var d=b.extend({parseType:null,truncate:!0},c);switch(d.parseType){case"plain":a=e.truncateLinks(a),d.plain=!0;break;case"highlighted":a=e.linkifyHighlightedLinks(a)}return a=e.replaceReferences(a,d),a=a.replace(/\n/g,"<br> "),a=j.parse(a),d.truncate&&(a=l.truncateWithLink(a)),a}},v=function(a){return a.replace(o,"")},w=function(a){return a=a.replace(/\n/g,"<br>"),a.replace(/<br>/g,"<br> ")},x=function(a,b){return a.replace(h.HREF_PATTERN,function(a){var c=a;return y(a)&&(a="http://"+a),d.render(b,{url:a,linkText:c,newTab:z(a)})})},y=function(a){return""===h.parse(a).protocol},z=function(a){return 0!==a.indexOf(k.base())},A=function(a,b,c){var d,e=a&&a.get("type")||"unknown";switch(e.toLowerCase()){case"user":case"group":d=new n({model:a,plain:b});break;case"unknown":if(!a)return c;d=new m({model:a,plain:b}),g.event("parsing_unknown_reference",{id:a.id,type:a.type,url:a.url,web_url:a.web_url});break;case"tag":case"topic":d=new m({model:a,plain:b});break;default:d=new m({model:a,plain:b})}return d.render().el.innerHTML},B=function(a,b){return void 0===a?"":a.replace(o,function(a,c,d){var e=f.objectForReference({type:c,id:d});return A(e,b,a)})},C=function(a){var c=a.split(h.HREF_PATTERN),d=c.filter(function(a,b){return b%2===0}),e=c.filter(function(a,b){return b%2!==0});d.forEach(function(a,b){d[b]=E(a)}),e.forEach(function(a,b){e[b]=x(a,t)});var f=b.flatten(b.zip(d,e)).join("");return f=B(f),w(f)},D=function(a){var b=x(a,s);return B(b,!0)},E=function(a){return null==a?null:b.escape(a)},F=function(a){return"announcement"===this.message_type&&a?a.replace(p,""):a},G=function(a){return a?a.replace(q,""):a},H=function(a){return a.replace(r,"")},I=c.extend({getEscapedBody:function(){return this.getRichBody()},getHtmlBody:function(a){return u(this.getRichBody(),a)},getHtmlBodyWithoutCCs:function(a){var b=u(this.getRichBody({stripCCs:!0}),a);return F(b)},getHtmlBodyExpandedWithoutCCs:function(){var a=j.parse(this.getRichBody({stripCCs:!0}));return F(a)},getHighlightedBody:function(){return this.body.highlighted?u(this.body.highlighted,{parseType:"highlighted"}):u(this.getEscapedBody())},getHighlightedPlainBody:function(){var a;return this.body&&(a=this.body.highlighted||D(this.body.parsed||"")),i.treatment("make_search_fast_ab")?B(a,!0):a},getHighlightedPlainBodyWithoutCCs:function(){return G(this.getHighlightedPlainBody())},getParsedBody:function(){return this.body?this.body.parsed:null},getParsedBodyWithoutReferences:function(){return this.body&&this.body.parsed?v(this.body.parsed):null},getPlainBody:function(){return this.translatedPlainBody?this.translatedPlainBody:null==this.body||null==this.body.parsed?null:D(this.body.parsed)},getPlainBodyWithoutCCs:function(){return G(this.getPlainBody())},getRichBody:function(a){return this.translatedRichBody?this.translatedRichBody:"announcement"===this.message_type?B(this.body.rich):null==this.body||null==this.body.parsed?null:C(a&&a.stripCCs?H(this.body.parsed):this.body.parsed)},getLanguage:function(){return this.translatedLanguage||this.language}});return new I}),define("models/like_backbone",["require","models/yammer_model","core/lib/namespace"],function(a){"use strict";var b=a("models/yammer_model"),c=a("core/lib/namespace"),d=b.extend({defaults:{type:"like"}});return c.ns("yam.backbone.model"),yam.backbone.model.Like=d,d}),define("collections/likes",["require","collections/yammer_collection","models/like_backbone","core/lib/namespace"],function(a){"use strict";var b=a("collections/yammer_collection"),c=a("models/like_backbone"),d=a("core/lib/namespace"),e=b.extend({model:c,add:function(a,c){return c=c||{},c.compositeKey=["message_id","user_id"],b.prototype.addWithCompositeKey.call(this,a,c)}});return d.ns("yam.backbone.collection"),yam.backbone.collection.Likes=new e,yam.backbone.collection.Likes}),define("models/message",["require","jquery","underscore","core/lib/log","core/lib/model_helper","models/lib/orm-models","core/lib/yammer_api","core/lib/i18n","core/lib/session","core/lib/string_helper","core/lib/tr","models/helpers/user","models/helpers/conversation","models/lib/model/class_events/on_message_create","models/lib/helper/message/parsed_body_formatter_mixin","models/group","collections/groups","collections/likes"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/log"),e=a("core/lib/model_helper"),f=a("models/lib/orm-models"),g=a("core/lib/yammer_api"),h=a("core/lib/i18n"),i=a("core/lib/session"),j=a("core/lib/string_helper"),k=a("core/lib/tr"),l=a("models/helpers/user"),m=a("models/helpers/conversation"),n=a("models/lib/model/class_events/on_message_create"),o=a("models/lib/helper/message/parsed_body_formatter_mixin"),p=a("models/group"),q=a("collections/groups"),r=a("collections/likes");return e.define("yam.model.Message",function(){c.extend(this.prototype,c.omit(o,"constructor"));var a=this.prototype.create;this.prototype.create=function(){var b=a.apply(this,arguments);return n.fixThreadCounts(b),b.isSystemMessage()||n.setTextDirection(b),b},this.prototype.getThread=function(){var a=f.Thread();return a.findById(this.thread_id)},this.prototype.getConversation=function(){var a=f.Conversation();return a.findById(this.conversation_id)},this.prototype.getAttachmentsByType=function(a){return this.getAttachments().filter(function(b){return b.type===a})},this.prototype.getPraise=function(){var a=this.getAttachmentsByType("praise");return a&&a.length>0?a[0]:null},this.prototype.getSticker=function(){var a=this.getAttachmentsByType("sticker");return a&&a.length>0?a[0]:null},this.prototype.getLikes=function(){return r.where({message_id:this.id})},this.prototype.getSender=function(){var a=f.Sender();return a.findFirst({message_id:this.id})},this.prototype.getGroup=function(){if(!this.isDirectMessage()){var a=q.get(this.group_id);return a?a:this.get("group_id")?new p({id:this.get("group_id"),full_name:k.t("a_private_group"),privacy:"private"}):p.ALL_COMPANY().set("network_id",this.get("network_id"))}},this.prototype.isSenderFollowable=function(a){return!l.isFollowing(a,this.findSender().id)&&"suspended"!==this.findSender().state&&"deleted"!==this.findSender().state},this.prototype.isSystemMessage=function(){return this.system_message===!0},this.prototype.isGuideMessage=function(){return"guide"===this.sender_type},this.prototype.getSystemMessageType=function(){var a=this.system_message_properties||{};return a.subtype||null},this.prototype.isReplyToThreadStarter=function(){var a=this.getThread();return a&&this.replied_to_id==a.thread_starter_id},this.prototype.getRepliedToMessage=function(){return yam.model.Message.findById(this.replied_to_id)},this.prototype.getDirectRecipient=function(){var a=f.User();return a.findById(this.direct_to)},this.prototype.isFromUser=function(a){return"user"===this.sender_type&&this.sender_id==a.id},this.prototype.isPrivate=function(){return"private"===this.privacy},this.prototype.isDirectMessage=function(){return this.direct_message===!0},this.prototype.isSharedMessage=function(){return"shared_message"===this.type},this.prototype.isChat=function(){if("chat"===this.message_type)return!0;var a=this.getThread();if(a){var b=a.getMessages();if(b)return c.any(b,function(a){return"chat"===a.message_type})}return!1},this.prototype.isViewed=function(){var a=this.getThread();return a?this.id<=a.getLastViewedMessageId():!1},this.prototype.isReference=function(){return!!this.is_reference},this.prototype.like=function(a){a=a||{},a.success=a.success||function(){};var b=i.getCurrentUser(),c=this.getThread();b&&!this.isLikedBy(b)&&(c&&c.markAsRead(),g.likeMessage({message_id:this.id}).then(a.success),this.addLike(b))},this.prototype.addLike=function(a){var b={message_id:this.id,name:a.get("full_name"),permalink:a.get("name"),user_id:a.id,network_id:a.get("network_id")};if(!this.isLikedBy(a)){r.add(b);var d=c.clone(this.liked_by||{count:0});d.count++,this.update({liked_by:d})}},this.prototype.unlike=function(a){a=a||{},a.success=a.success||function(){};var b=i.getCurrentUser();b&&this.isLikedBy(b)&&(g.unlikeMessage({message_id:this.id}).then(a.success),this.removeLike(b))},this.prototype.removeLike=function(a){var b={message_id:this.id,name:a.full_name,permalink:a.name,user_id:a.id,network_id:a.network_id},d=r.findWhere(b);if(d){d.destroy();var e=c.clone(this.liked_by||{count:1});e.count--,e.count=e.count<0?0:e.count,this.update({liked_by:e})}},this.prototype.isLikedBy=function(a){return c.some(this.getLikes(),function(b){return b.get("user_id")===a.id})},this.prototype.processLikes=function(){if(this.liked_by&&this.liked_by.names)for(var a=this.liked_by.names,b=0,c=a.length;c>b;++b){var d=a[b].full_name,e=a[b].permalink,f=a[b].user_id,g=a[b].network_id;r.add({message_id:this.id,name:d,permalink:e,user_id:f,network_id:g})}},this.prototype.isFollowedInInbox=function(){return this.getThread().isFollowedInInbox()},this.prototype.findSender=function(){var a=this.getSender();if(a)return a.getUser()||a.getGuide()},this.prototype.hasTrailingGroupLabel=function(){return!!this.getPraise()},this.prototype.getAttachments=function(){return c.chain(this.attachments).filter(function(a){return"deleted_message_attachment"!==a.type||"open_graph_object"!==a.real_type}).value()},this.prototype.hasAttachmentOfType=function(a){return c.find(this.getAttachments(),function(b){return b.type&&b.type===a})},this.prototype.hasAttachmentFromApp=function(a){var b=this.getAttachments();if(!b||!b.length)return!1;for(var c="string"==typeof a?a:a.app_id,d=0,e=b.length;e>d;d++){var f=b[d];if(f.ymodule&&f.ymodule.app_id==c)return!0}return!1},this.prototype.findAttachmentFromApp=function(a){var b=this.getAttachments();if(!b||!b.length||!a)return null;for(var c=0,d=b.length;d>c;c++){var e=b[c];if(e.ymodule&&e.ymodule.app_id==a.app_id)return e}return null},this.prototype.getTime=function(){if(!this._jsTime){var a=this.created_at,b=new Date(a);"Invalid Date"===b&&(a=a.replace("T"," ").replace("Z"," UTC").replace(/-/g,"/"),b=new Date(a)),this._jsTime=b.getTime()}return this._jsTime},this.prototype.isThreadStarter=function(){if(this.is_reference)return!1;var a=this.getThread();return!!a&&a.thread_starter_id==this.id};var e=this.save;this.save=function(a){var b=this.findById(a.id);return(!b||b&&!a.is_reference)&&(b=e.call(this,a)),b},this.prototype.getTextDirection=function(){return this.translatedTextDirection||this.textDirection||null};var s=this.toBingLocale=function(a){return a=a.toLowerCase(),a?"zh-hk"===a?"zh-tw":0===a.indexOf("zh")?a:a.split("-")[0]:""},t={ar:k.t("arabic"),bg:k.t("bulgarian"),cs:k.t("czech"),da:k.t("danish"),de:k.t("german"),el:k.t("greek"),en:k.t("english"),es:k.t("spanish"),et:k.t("estonian"),fa:k.t("persian"),fi:k.t("finnish"),fr:k.t("french"),he:k.t("hebrew"),hi:k.t("hindi"),hu:k.t("hungarian"),id:k.t("indonesian"),it:k.t("italian"),ja:k.t("japanese"),ko:k.t("korean"),lt:k.t("lithuanian"),lv:k.t("latvian"),nl:k.t("dutch"),no:k.t("norwegian"),pl:k.t("polish"),pt:k.t("portugese"),ro:k.t("romanian"),ru:k.t("russian"),sk:k.t("slovak"),sl:k.t("slovene"),sv:k.t("swedish"),th:k.t("thai"),tr:k.t("turkish"),uk:k.t("ukrainian"),ur:k.t("urdu"),vi:k.t("vietnamese"),"zh-cn":k.t("chinese_simplified"),"zh-tw":k.t("chinese_traditional")},u=this._isLanguageSupported=function(a){return!!t[a.toLowerCase()]};this.prototype.getLanguageName=function(){return t[this.language]||""},this.prototype.canBeTranslated=function(){var a=i.getCurrentUser(),b=i.getCurrentNetwork(),c=s(h.getLocale());return!!(b.is_translation_enabled&&this.body&&this.getPlainBody()&&"praise"!==this.type&&this.sender_id!=a.id&&this.language!=c&&this.language&&u(this.language)&&c&&u(c))};var v=this.NOT_TRANSLATED=0,w=this.TRANSLATING=1,x=this.TRANSLATED=2;this.prototype.getTranslationStatus=function(){return this.translationStatus||v},this.prototype.isNotTranslated=function(){return this.getTranslationStatus()===v},this.prototype.isTranslating=function(){return this.getTranslationStatus()===w},this.prototype.isTranslated=function(){return this.getTranslationStatus()===x},this.prototype.setTranslationStatus=function(a){this.translationStatus=a},this._updateTranslationStatus=function(a,b){c(a).each(function(a){a.setTranslationStatus(b),a.update()})},this.translateMessages=function(a){var d,e=this,f=b.Deferred(),i=s(h.getLocale()),k=h.getTextDirectionByLanguageCode(i);a=c.filter(a,function(a){return!a.isTranslated()&&a.canBeTranslated()}),this._updateTranslationStatus(a,w),d=c.map(a,function(a){return{text:a.getRichBody({stripCCs:!0}),contentType:"text/html",to:i}});var l=function(b){for(var c=b.items,d=0;d<c.length;d++)a[d].translatedPlainBody=j.stripHtmlTags(c[d].text),a[d].translatedRichBody=c[d].text,a[d].translatedTextDirection=k,a[d].translatedLanguage=i;e._updateTranslationStatus(a,x),f.resolve()},m=function(){e.untranslateMessages(a,v),f.reject()};return a.length?g.translate({items:d}).then(l,m):f.resolve(),f},this.untranslateMessages=function(a){c(a).each(function(a){delete a.translatedPlainBody,delete a.translatedRichBody,delete a.translatedTextDirection,delete a.translatedLanguage}),this._updateTranslationStatus(a,v)},this.prototype.getNotifiedUsers=function(){var a=this.notified_user_ids||this.ccd_user_ids||[],b=f.User();return c.compact(c.map(a,function(a){var c=b.findById(a);return void 0===c&&d.warn("message.getNotifiedUsers() - could not find user with id "+a+" in ORM."),c}))},this.prototype.isRevokable=function(){var a=this.getThread(),b=a.getParticipantIds();if(this.isDirectMessage()){var d=this.getConversation();b=b.concat(m.getParticipantIds(d))}return!a.isReadOnly()&&!c.isEmpty(c.intersection(this.notified_user_ids,b))},this.prototype.isForeign=function(){return null!=this.network_id&&this.network_id!=i.getCurrentNetwork().id},this.prototype.getNetworkName=function(){var a=f.Network(),b=a.findById(this.network_id);return b&&b.getPlainBody()},this.prototype.isXmess=function(){if(this.isDirectMessage()||!this.isPrivate())return!1;var a=this.group_id||this.group_created_id,b=l.getGroupMemberships(i.getCurrentUser());return!c.some(b,function(b){return b.get("group_id")==a})},this.prototype.isPrivateGroupMessage=function(){return this.isPrivate()&&!this.isDirectMessage()};var y=this.prototype.destroy;this.prototype.destroy=function(){var a=this.getThread();a&&a.server_updates--,y.call(this)}}),yam.model.Message}),define("models/topic",["require","core/lib/model_helper"],function(a){var b=a("core/lib/model_helper");return b.define("yam.model.Topic",function(){})}),define("models/lib/domain_controller",["require","underscore","core/lib/ctor","core/lib/log","models/lib/orm-models","core/lib/string_helper","models/helpers/user","models/helpers/message","models/message","models/topic","backbone","collections/groups","collections/group_memberships","collections/group_ranks","collections/likes","collections/groups"],function(a){var b=a("underscore"),c=a("core/lib/ctor"),d=a("core/lib/log"),e=a("models/lib/orm-models"),f=a("core/lib/string_helper"),g=a("models/helpers/user"),h=a("models/helpers/message"),i=a("models/message"),j=a("models/topic"),k=a("backbone");return c("yam.model.DomainController",{init:function(a){this._currentUser=a,this._isListening=!1},listen:function(){this._isListening=!0,this.setCurrentUser(this._currentUser),k.on("/client/subscriptions",this.onSubscriptions.bind(this)),k.on("/stream/requests",this.onRequests.bind(this))},getCurrentUser:function(){return this._currentUser},setCurrentUser:function(a){this._currentUser=a,this._isListening&&this._initUser(this._currentUser)},onSubscriptions:function(a){var c=a.subscriptions;yam.model.repository.transaction(b.bind(function(){this.initReferences(a.references),a.external_references&&this.initReferences(a.external_references);for(var b=0,d=c.length;d>b;++b){var e=c[b];g.follow(this._currentUser,e.target_type,e.target_id)}},this))},onNetwork:function(a){if(a){var b=e.Network();this._initReferences(b,a)}},onRequests:function(a){yam.model.repository.transaction(b.bind(function(){this.initReferences(a.references),a.external_references&&this.initReferences(a.external_references)},this))},_splitMessageReferences:function(a){var c=b.where(a,{type:"message"}),d=b.difference(a,c);return b.each(c,function(a){a.is_reference=!0}),{messageReferences:c,otherReferences:d}},_stripMessageReferences:function(a){var b=this._splitMessageReferences(a.references),c=b.messageReferences;if(a.references=b.otherReferences,a.external_references){
var d=this._splitMessageReferences(a.external_references);a.external_references=d.otherReferences,c=c.concat(d.messageReferences)}return c},onMessages:function(a,c){if(null==a.messages)throw new Error("Incomplete payload: "+JSON.stringify(a));var d=this._stripMessageReferences(a);this._initMeta(a,c);var e=b.union(a.messages,d);e=this._initListModels(a,e,c);var f=a.references.concat(a.external_references||[]);this._initMessages(e,a.meta,!1,!1,c),this._initThreadedExtended(a.threaded_extended,a.meta,!1),this.initReferences(f,!1,c),this._initSnippets(a.snippets),this._initThreadLastSeenIds(a)},_initListModels:function(a,c,d){var f=e.Activity();if(a.activities&&a.activities.length){var g={payload:a.activities,comparator:d&&d.sort_by,enhance:function(c,d){return b.each(this.payload,function(b){b.list_model=f,b.subject&&d._initListModelAttachments(b,a.references)}),c=c.concat(this.payload),c=b.sortBy(c,b.bind(function(a){return a[this.comparator]},this))}};c=g.enhance(c,this)}return c},_initListModelAttachments:function(a,c){var d=b.where(c,{id:a.subject.id,type:a.subject.type});if(d.length>1)throw new Error("multiple subject references with identical ids and types");if(0===d.length)throw new Error("subject point at non-existent reference");var f=e.Attachment();f.save(d[0])},onStream:function(a,c){a.val&&(a=a.getRaw());var d=b.extend({},this._splitReferences(a.references)),e=b.extend({},this._splitReferences(a.external_references)),f=b.extend({},this._splitReferences(a.objects));this._initMeta(a,c),this._initMessages(f.message,a.meta,!0,!1,c),this._initMessages(d.message,a.meta,!0,!1,c),this._initMessages(e.message,a.meta,!0,!1,c),delete d.message,delete e.message,delete f.message,this.initReferences(d,!1,c),this.initReferences(f,!1,c),this.initReferences(e,!1,c),this._initThreadedExtended(a.threaded_extended,a.meta,!0),this._initThreadReferences(d.thread,!0,c),this._initThreadReferences(e.thread,!1,c),this._initThreadReferences(f.thread,!0,c),this._initThreadLastSeenIds(a),this._initStream(a.items,c)},onActivities:function(a,b,c){var d=e.Activity();this.onStream(a,b,d,"activities",c)},onThreadInfo:function(a){this._initReferencesForThread(a.references),this._initReferencesForThread(a.external_references)},_initReferencesForThread:function(a){if(a){var c=b.groupBy(a,"type");this._initReferencesForModel(c.user,e.User()),this._initReferencesForModel(c.file,e.Attachment()),this._initReferencesForModel(c.image,e.Attachment()),this._initTopicReferences(c.topic)}},_initReferencesForModel:function(a,c){b.each(a,function(a){a.is_reference=!0,c.save(a)})},_initUser:function(c){yam.model.repository.transaction(function(){var d=a("collections/groups"),f=a("collections/group_memberships"),h=a("collections/group_ranks"),i=e.User();c.create();var j,k,l;if(c.group_memberships){var m=c.group_memberships;for(j=0,k=m.length;k>j;++j){var n=m[j];l={user_id:c.id,group_id:n.id},h.add({group_id:n.id,rank:j,external:n.external}),f.add(l),d.add(n)}}if(c.pending_group_memberships){var o=c.pending_group_memberships;for(j=0,k=o.length;k>j;++j){var p=o[j];l={user_id:c.id,group_id:p.id,pending:!0},f.add(l),d.add(o)}}if(c.invited_group_memberships&&b.each(c.invited_group_memberships,function(a,b){h.add({group_id:a.id,rank:b,external:a.external}),f.add({user_id:c.id,group_id:a.id,invited:!0}),d.add(a)}),c.subscriptions){var q=c.subscriptions;for(j=0,k=q.length;k>j;++j){var r=q[j];l={follower_id:c.id,follower_type:"user",followed_id:r.id,followed_type:"user"},g.followUser(c,r.id),r.is_reference=!0,i.save(r)}}})},_initMeta:function(a,c){var d=a.meta;if(d)if(this._initUserSubscriptions(d.followed_user_ids),this._registerSubscriptionsFromCurrentUser(d.followed_references),d.bookmarked_message_ids&&this._initBookmarks(d.bookmarked_message_ids),d.liked_message_ids&&this._initLikes(d.liked_message_ids),d.threads_in_inbox&&d.threads_in_inbox.length)this._initInboxFollows(d.threads_in_inbox);else if(c&&c instanceof e.Feed()&&c.isInbox()){var f=b(a.messages).chain().pluck("thread_id").uniq().value();this._initInboxFollows(f)}},_initThreadLastSeenIds:function(a){var b=a.meta,c=e.Thread();if(b&&b.last_seen_message_ids){var f=b.last_seen_message_ids;for(var g in f){var h=c.findById(g);h?h.setLastSeenId(f[g]):d.warn("thread "+g+" not found updating last seen id")}}},_initUserSubscriptions:function(a){this._registerSubscriptionsFromCurrentUser(b.map(a,function(a){return{type:"user",id:a}}))},_registerSubscriptionsFromCurrentUser:function(a){a=a||[];for(var b=0,c=a.length;c>b;b++){var d=a[b];g.follow(this._currentUser,d.type,d.id)}},_initBookmarks:function(a){for(var b=0,c=a.length;c>b;++b){var d=a[b],e=i.findOrCreate({id:d});h.bookmark(e)}},_initLikes:function(b){for(var c=a("collections/likes"),d=this._currentUser,e=0,f=b.length;f>e;++e){var g=d.full_name,h=d.name,i=d.id,j=d.network_id;c.add({message_id:b[e],permalink:h,name:g,user_id:i,network_id:j})}},_initInboxFollows:function(a){for(var b=e.InboxFollow(),c=this._currentUser.id,d=0,f=a.length;f>d;++d){var g=a[d];b.save({thread_id:g,user_id:c})}},_initSnippets:function(a){if(a)for(var c=e.Snippet(),d=e.Sender(),f=0,g=a.length;g>f;++f){var h=a[f];h.id=h.id||b.uniqueId(),d.save({snippet_id:h.id,type:h.sender_type.toLowerCase(),type_id:h.sender_id}),c.save({id:h.id,snippet_html:h.snippet_html,thread_starter_id:h.thread_starter_id,thread_id:h.thread_starter_id,language:h.language})}},_initMessages:function(a,b,c,d,e){if(a&&a.length)for(var f=0,g=a.length;g>f;++f){var h=a[f];h.list_model?this._saveListItem(h,e):this._saveMessage(a[f],b,c,d)}},_initThreadedExtended:function(a,b,c){var d,e;if(a)for(var f in a){d=a[f];for(var g=0,h=d.length;h>g;++g)e=d[g],this._saveMessage(e,b,c,!1)}},_initStream:function(a,b){for(var c=e.Rollup(),d=0,f=a.length;f>d;d++)c.saveAndDeliver(a[d],b)},_saveMessage:function(a,c,d,f){var g=e.Sender();g.save({message_id:a.id,type:a.sender_type,type_id:a.sender_id});var h=a.attachments,i=c.ymodules,j=e.Attachment(),k=e.Message();a.attachments=a.attachments||[],a.is_reference=f||!!a.is_reference,a.body&&a.body.plain&&!a.body.parsed&&(a.body.parsed=a.body.plain,delete a.body.plain);var l=k.save(a);if(l.processLikes(),h)for(var m=0,n=h.length;n>m;++m){var o=h[m];if(o.messages=o.messages||[],o.messages.push(l),"ymodule"===o.type&&i)for(var p=0,q=i.length;q>p;++p){var r=i[p];r.id==o.id&&b.extend(o,r)}l.attachments[m]=j.save(o)}return l},_saveListItem:function(a,b){var c=a.list_model;delete a.list_model,c.saveAndDeliver(a,b)},_splitReferences:function(a){var c={user:[],guide:[],tag:[],thread:[],message:[],conversation:[],group:[],network:[],page:[],uploaded_file:[],topic:[],shared_thread:[],shared_message:[],unknown:[]};if(!b.isArray(a))return b.each(a,function(b,d){c[d]?c[d]=a[d].concat(b):c.unknown=a[d].concat(b)}),c;if(!a)return c;for(var d=0,e=a.length;e>d;++d){var f=a[d],g=c[f.type]||c.unknown;f.is_reference=!0,g.push(f)}return c},initReferences:function(b,c,d){var e,g,h=a("collections/groups"),i=this._splitReferences(b);for(var j in i)if(e=f.camelize(j,!0),g="_init"+e+"References",i.hasOwnProperty(j)&&"function"==typeof this[g])this[g](i[j],c,d);else if("Group"===e)this._initBackboneReferences(h,i[j]);else{if(!yam.model[e])throw new Error("Cannot find type for yam.model."+e);this._initReferences(yam.model[e],i[j])}},_initTopicReferences:function(a){if(a){for(var c,d=0,e=a.length;e>d;++d)c=a[d],c.name=b.escape(c.name),j.save(c);return a}},_initSharedMessageReferences:function(a){var c=e.SharedMessage();b.each(a,function(a){c.processReference(a)})},_initThreadReferences:function(a,b,c){if(a)for(var d=e.Thread(),f=c?d.saveAndDeliver:d.save,g=0,h=a.length;h>g;++g)f.call(d,a[g],c)},_initUnknownReferences:function(a){for(var b=e.Unknown(),c=0,d=a.length;d>c;++c){var f=a[c];b.save(f)}},_initReferences:function(a,c){c&&b.each(c,function(b){a.save(b)})},_initBackboneReferences:function(a,c){c&&b.each(c,function(b){a.add(b,{merge:!1})})}})}),define("models/message_payload_processor",["require","models/lib/domain_controller","core/lib/ctor"],function(a){var b=a("models/lib/domain_controller"),c=a("core/lib/ctor");return c("yam.model.MessagePayloadProcessor",b,{init:function(a,b){this._currentUser=a,this._feed=b},listen:function(){},process:function(a){this.onMessages(a.getRaw(),this._feed)}})}),define("models/lib/helper/inbox_update_processor",["require","core/lib/backbone_base_class"],function(a){"use strict";var b=a("core/lib/backbone_base_class");return b.extend({process:function(a){var b=this.options.feed,c=this.options.fetchType,d=a.getNewestMessageId("threaded");b.setNewestMessageId(d),b.setLastSeenMessageId(d),b.hasFirstPayload()||(b.setLocalLastSeenMessageId(b.getLastSeenMessageId()),b.setRealtimeInfo(a.val("meta.realtime"))),"initial"!==c&&"olderThan"!==c||b.setOlderAvailable(a.val("meta.older_available")),b.setOldestThreadedId(a.getOldestMessageId("threaded")),b.updateUnseenCounts(a)}})}),define("models/lib/helper/cursor_update_processor",["require","core/lib/backbone_base_class","models/lib/helper/assured_delivery_experiments"],function(a){var b=a("core/lib/backbone_base_class"),c=a("models/lib/helper/assured_delivery_experiments");return b.extend({process:function(a){var b=this.options.feed,d=this.options.fetchType,e=!!c.newerRealtimeTreatment(b),f="realtimeMessageResolve"===d||"post"===d,g=e&&f;if(!g){var h=a.getNewestMessageId("threaded");b.setNewestMessageId(h),b.setLastSeenMessageId(h)}if(!b.hasFirstPayload()){b._setOlderReplyCursor(b.getLastSeenMessageId());var i=a.val("meta.last_seen_message_id");b.setLocalLastSeenMessageId(null!=i?i:b.getLastSeenMessageId()),b.sort_by=a.val("meta.sort_by")||null,b.setLocalOldestMessageId(a.getOldestMessageId("threaded"));var j=a.val("meta.unseen_thread_count")||0;b.setOlderUnseenCount(j,a.getMessages().length),b.setRealtimeInfo(a.val("meta.realtime"))}"initial"!==d&&"olderThan"!==d||b.setOlderAvailable(a.val("meta.older_available")),b.setOldestThreadedId(a.getOldestMessageId("threaded")),b.updateUnseenCounts(a)}})}),define("models/announcement_bubbling_processor",["require","core/lib/namespace","models/lib/orm-models","core/lib/ctor"],function(a){var b=a("core/lib/namespace"),c=a("models/lib/orm-models"),d=a("core/lib/ctor");return d("yam.model.AnnouncementBubblingProcessor",{init:function(a){this._feed=a},process:function(a){var d,e,f=this._feed,g=c.Thread();b.val(a,"is_read")&&(d=a._raw.messages[0],d&&f&&f.setLocalLastSeenMessageId(d.id),e=g.findById(d.thread_id),d&&e&&(e.setLocalLatestReplyId(d.id),e.setLastSeenId(d.id)))}})}),define("models/lib/model/helper/feed_viewed_messages_processor",["require","underscore","core/lib/backbone_base_class","models/lib/helper/assured_delivery_experiments","models/lib/helper/viewed_state_helper"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_class"),d=a("models/lib/helper/assured_delivery_experiments"),e=a("models/lib/helper/viewed_state_helper"),f=c.extend({initialize:function(a){this.feed=a.feed,this.fetchType=a.fetchType},process:function(a){var c=b.map(a.getMessages(),this._processEachPayloadMessageViewedState,this);this.feed.feedCounter.addViewedStates(c,!1,this._getPayloadTracking());var f=a.val("meta.unviewed_threads");if(d.isOcularSupportedFeed(this.feed)&&f){this.feed.feedCounter.useViewedStatesForCounts();var g=b.map(f.threads,this._processEachUnviewedThreadTriplet,this);this.feed.feedCounter.addViewedStates(g,!0,this._getUnviewedThreadsTracking())}else if(d.isOcularSupportedFeed(this.feed)&&"post"===this.fetchType){var h=a.getMessages()[0];h&&h.thread_id!==h.id&&e.updateViewedState({id:h.thread_id,lastViewedMessageId:h.id,lastReplyMessageId:h.id,dataOrigin:this.fetchType})}},_processEachUnviewedThreadTriplet:function(a){return b.extend({id:a.thread_id,lastReplyMessageId:a.last_message_id,lastViewedMessageId:a.last_seen_message_id},this._getUnviewedThreadsTracking())},_processEachPayloadMessageViewedState:function(a){return b.extend({id:a.thread_id||0},this._getPayloadTracking())},_getPayloadTracking:function(){return{loadType:this.fetchType,loadFeed:this._getFeedInfo(),dataOrigin:"loaded_in_payload"}},_getUnviewedThreadsTracking:function(){return{fetchType:this.fetchType,fetchFeed:this._getFeedInfo(),dataOrigin:"unviewed_thread_data"}},_getFeedInfo:function(){return this.feed.keyType+(this.feed.keyId||"")}});return f}),define("models/lib/helper/feed_hydrator",["require","underscore","core/lib/session","core/lib/model_helper","models/message_payload_processor","models/lib/helper/inbox_update_processor","models/lib/helper/cursor_update_processor","models/announcement_bubbling_processor","models/lib/model/helper/feed_viewed_messages_processor"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/model_helper"),e=a("models/message_payload_processor"),f=a("models/lib/helper/inbox_update_processor"),g=a("models/lib/helper/cursor_update_processor"),h=a("models/announcement_bubbling_processor"),i=a("models/lib/model/helper/feed_viewed_messages_processor");return{hydrate:function(a){var c=a.feed,e=a.payload,f=a.fetchType,g=this._getProcessors({feed:c,fetchType:f}),h=function(){b.invoke(g,"process",e)};d.getGlobalModelRepository().transaction(h),c.trigger("onAfterProcess",e),c.hasFirstPayload()||c.onFirstPayload()},_getProcessors:function(a){var b,d=a.feed,j=a.fetchType;return b=d.isInbox()?[new e(c.getCurrentUser(),d),new h(d),new f({feed:d,fetchType:j}),new i({feed:d,fetchType:j})]:d.hasKeyType("search")?[new e(c.getCurrentUser(),d)]:[new e(c.getCurrentUser(),d),new g({feed:d,fetchType:j}),new i({feed:d,fetchType:j})]}}}),define("models/lib/helper/feed_filter_helper",["require","underscore"],function(a){var b=a("underscore"),c=function(a){return!a.isViewed()};return{_contentFilters:{generalUnviewed:c,groupUnviewed:c},getContentFilter:function(a){return this._contentFilters[a]},hasContentFilter:function(a){return a in this._contentFilters},pruneUsingContentFilter:function(a){if(!this.hasContentFilter(a.keyType))return 0;var c=0;return b.chain(a.getDeliverys()).reduce(function(a,b){var c=b.getObject();return"thread"===c.type&&a.push(c),a},[]).filter(b.negate(this.getContentFilter(a.keyType))).tap(function(a){c=a.length}).invoke("undeliver",a),c},_filters:{inboxChat:["PRIVATE","chat"],topicAnnouncements:["announcement"],topicLinks:["link"],topicPolls:["poll"],userAnnouncements:["announcement"],userLinks:["link"],userPolls:["poll"],userPraise:["praise"]},getFilters:function(a){return this._filters[a]||[]}}}),define("models/lib/client/realtime_feed_connection",["require","underscore","core/lib/client/bayeux","core/lib/yammer_config","core/lib/session","backbone","models/helpers/feed","models/lib/client/base_realtime_client"],function(a){var b=a("underscore"),c=a("core/lib/client/bayeux"),d=a("core/lib/yammer_config"),e=a("core/lib/session"),f=a("backbone"),g=a("models/helpers/feed"),h=a("models/lib/client/base_realtime_client");return f.Model.extend({idAttribute:"connectionId",initialize:function(){this._setupListeners()},_setupListeners:function(){this.listenTo(f,"/realtime/connection/reconnected",this._reconnect),this.listenTo(f,"/realtime/connection/failure",this._disconnectBayeux),this.listenTo(f,"/realtime/client/stop",this._severConnection)},registerFeed:function(a){var b=this.get("feeds")||[];b.indexOf[b]>=0||(b.push(a),this.set("feeds",b))},getFeeds:function(){return this.get("feeds")},getPrimaryFeed:function(){return g.getPrimaryFeed(this.get("feeds"))},connect:function(){var a=b.bind(function(a){c.subscribe({id:this._getConnectionId(),url:a.realtimeURI,channels:this._getChannels(),token:this._getToken(),onSuccess:this.trigger.bind(this,"connectionSuccess"),onError:this.trigger.bind(this,"connectionError"),onData:this._onRealtimeData.bind(this)})},this);h.fetchUri().then(a)},_reconnect:function(){this.connect(),this.trigger("connectionReconnected")},disconnect:function(){c.unsubscribe({id:this._getConnectionId(),channels:this._getChannels()}),this.stopListening()},isConnected:function(){return c.hasSubscription(this._getConnectionId())},sync:b.noop,_getConnectionId:function(){return this.get("connectionId")},_getChannels:function(){var a=this.get("realtimeInfo"),b=a.channel_id;return["/feeds/"+b+"/primary","/feeds/"+b+"/secondary"]},_getToken:function(){return d.config().autocomplete_token||e.getCurrentUser().web_oauth_access_token},_onRealtimeData:function(a){this.trigger("realtimeData",a)},_disconnectBayeux:function(){"disconnected"!==c.getStatus()&&c.disconnect()},_severConnection:function(a){a===this._getConnectionId()&&this.disconnect()}})}),define("models/lib/client/realtime_feed_connections",["require","backbone","models/lib/client/realtime_feed_connection"],function(a){var b=a("backbone"),c=a("models/lib/client/realtime_feed_connection"),d=b.Collection.extend({model:c});return new d}),define("models/lib/helper/realtime_fetchnewer_resolver",["require","underscore","models/lib/helper/assured_delivery_experiments","models/lib/helper/feed_fetcher","models/lib/helper/feed_hydrator"],function(a){var b=a("underscore"),c=a("models/lib/helper/assured_delivery_experiments"),d=a("models/lib/helper/feed_fetcher"),e=a("models/lib/helper/feed_hydrator"),f=15e3;return{start:function(a){var d=c.newerRealtimeTreatment(a.getPrimaryFeed());"throttled"===d?this._fetchNewerCallback=b.throttle(this._fetchNewer,f):this._fetchNewerCallback=this._fetchNewer,this._fetchNewer(a,"BackfillV2")},restart:function(a){this._fetchNewerCallback(a,"ReconnectV2")},_fetchNewer:function(a,b){var c=a.getPrimaryFeed(),e="newerThan_"+b;return d.fetchNewer(c).then(this._hydrateFeeds.bind(this,a,e))},_hydrateFeeds:function(a,b,c){return a.getFeeds().forEach(function(a){e.hydrate({feed:a,payload:c,fetchType:b})}),c},onData:function(a){this._fetchNewerCallback(a,"RealtimeV2")}}}),define("core/lib/util/work_queue_task",["require","core/lib/ctor","backbone"],function(a){var b=a("core/lib/ctor"),c=a("backbone");return b(null,[c.Events],{init:function(){},onComplete:function(){this.trigger("onComplete",arguments)},onFailure:function(a){this.trigger("onFailure",a)},onKill:function(){this.trigger("onKill")},execute:function(){},getId:function(){}})}),define("core/lib/util/work_queue",["require","underscore","core/lib/util/work_queue_task","core/lib/ctor","core/lib/log","backbone"],function(a){var b=a("underscore"),c=a("core/lib/util/work_queue_task"),d=a("core/lib/ctor"),e=a("core/lib/log"),f=a("backbone");return d(null,{init:function(a){var c=a||{};this._queue=[],this.id=c.id||void 0,this._currentTask=null,this._processing=!1,this._paused=!1,this._taskTimeout=c.taskTimeout||3e4,this._async=c.async||!1,this._delay=c.delay||0,this._delayBefore=c.delayBefore||!1,this._continueOnFailure=c.continueOnFailure!==!1,this.listener=b.extend({},f.Events)},enqueue:function(){var a;switch(arguments.length){case 1:a="function"==typeof arguments[0]?this._createDefaultTask(this,arguments[0]):arguments[0];break;case 2:a=this._createDefaultTask(arguments[0],arguments[1])}this._queue.push(a),this._processing||this._paused||this._execute()},dequeue:function(){return this._queue.shift()},peek:function(){return this._queue[0]},kill:function(){this._cleanupTask(),this._processing=!1,this._queue=[],this._currentTask&&(this._currentTask.onKill(),this._currentTask=null)},pause:function(){this._paused=!0,this._processing=!1},resume:function(){this._paused=!1,this._processing||this._execute()},size:function(){return this._queue.length},onComplete:function(){},onTaskFailure:function(){},onTaskComplete:function(){},getCurrentTask:function(){return this._currentTask},_createDefaultTask:function(a,b){var d=new c;return d.execute=b.bind(a,d),d},_execute:function(){this._processing=!0;var a=this.dequeue();a?(this.listener.listenToOnce(a,"onComplete",this._onTaskComplete.bind(this,a)),this.listener.listenToOnce(a,"onFailure",this._onTaskFailure.bind(this,a)),this._currentTask=a,this._async&&this._delayBefore?window.setTimeout(b.bind(function(){this._executeTask(a)},this),this._delay):this._executeTask(a)):(this._processing&&this.onComplete(this),this._processing=!1)},_onTaskComplete:function(a){this._cleanupTask(),this.onTaskComplete(this,a),this._paused||this._runNext()},_onTaskFailure:function(a,b){this._cleanupTask(),this.onTaskFailure(a,b),!this._paused&&this._continueOnFailure&&this._runNext()},_cleanupTask:function(){this._clearTaskTimeoutMonitor(),this.listener.stopListening()},_onTaskTimeout:function(a){e.log("task exceeded timeout, killing task",a),a.onKill("timeout"),this._onTaskFailure(a,"timeout")},_startTaskTimeoutMonitor:function(a){this._clearTaskTimeoutMonitor();var b=this._onTaskTimeout.bind(this,a);this._taskTimeoutId=window.setTimeout(b,this._taskTimeout)},_clearTaskTimeoutMonitor:function(){window.clearTimeout(this._taskTimeoutId)},_executeTask:function(a){var b,c,d;try{this._taskTimeout&&this._startTaskTimeoutMonitor(a),a.execute()}catch(a){b=a}if(b)try{this._logError("task failed with additional info",b,a),a.onFailure(b)}catch(a){c=a}if(c)try{this._logError("failure handler failed, killing the queue",c,a),this.kill()}catch(a){d=a}d&&this._logError("kill handler failed giving up",d,a)},_logError:function(a,b,c){e.warn("WorkQueue: "+a+": "+b.message,this,c,b,b.stack)},_runNext:function(){this._async&&!this._delayBefore?window.setTimeout(b.bind(function(){this._execute()},this),this._delay):this._execute()},removeTask:function(a){this._queue=b.reject(this._queue,function(b){return b.getId()===a})}})}),define("models/lib/client/realtime_thread_client",["require","models/lib/client/base_realtime_client","core/lib/ctor","core/lib/log","backbone","core/lib/report"],function(a){var b=a("models/lib/client/base_realtime_client"),c=a("core/lib/ctor"),d=a("core/lib/log"),e=a("backbone"),f=a("core/lib/report");return c(null,b,{threadEvents:{TYPING:"typing",MOVE_TO_GROUP:"move_to_group",LIKES:"likes"},init:function(a){b.prototype.init.call(this,a),this._threadId=a.thread_id,this.requestFunction=null},onRealtimeData:function(a){try{e.trigger(this.getUrl(),a.data)}catch(a){d.warn("Error caught while handling thread event: ",a,a.stack),f.error({message:a.message},a)}},getChannels:function(){var a=this.getUrl()+"/",b=[a+this.threadEvents.TYPING,a+this.threadEvents.MOVE_TO_GROUP,a+this.threadEvents.LIKES];return b},getUrl:function(){return"/threads/"+this._threadId}})}),define("models/lib/model/deliverable",["require","core/lib/model_helper","models/delivery","core/lib/namespace"],function(a){var b=a("core/lib/model_helper"),c=a("models/delivery"),d=a("core/lib/namespace");return d.ns("yam.model._Deliverable",{getDeliverys:function(){return c.find({type:b.toTypeStr(this),type_id:this.id})}}),yam.model._Deliverable}),define("models/lib/model/helper/thread_viewed_state",["require","underscore","core/lib/backbone_base_class","core/lib/namespace","models/lib/helper/viewed_state_helper"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_class"),d=a("core/lib/namespace"),e=a("models/lib/helper/viewed_state_helper"),f=c.extend({initialize:function(a){this.thread=a.thread},getLastViewedMessageId:function(){return this.futureViewedStateModel?this.futureViewedStateModel.get("lastViewedMessageId"):this.last_viewed_message_id},hasLastViewedMessageId:function(){return b.isNumber(this.getLastViewedMessageId())},isViewed:function(){return this.futureViewedStateModel?e.isViewed(this.futureViewedStateModel):this.hasLastViewedMessageId()?this.getLastViewedMessageId()>=this.thread.getLatestReplyId():!0},getState:function(){var a="unknown";return this.hasLastViewedMessageId()&&(a=this.isViewed()?"viewed":"unviewed"),a}});return d.ns("yam.model.helper"),yam.model.helper.ThreadViewedState=f,f}),define("models/lib/model/helper/log_viewed_threads",["require","underscore","core/lib/yammer_request","core/lib/yammer_api"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/yammer_request"),d=a("core/lib/yammer_api"),e={};e.setViewedThreads=function(a,e){if(b.keys(a).length>0){var f={values:a};return e=e||{},e.page_load_id=c.getPageLoadId(),f.log_data=e,e.feed_type&&(f.feed_type=e.feed_type),d.postViewedThreads({data:f})}};var f={},g={};return e.flushPendingViewedThreads=function(){var a=["unviewed","viewed","unknown"];b.each(a,function(a){var c=f[a]||{},d=g[a]||{};d&&"scroll"==d.action_type&&!d.action_info&&c&&(d.action_info=b.keys(c).length),e.setViewedThreads(c,d)}),f={},g={}},e.setViewedThreadsThrottled=function(){var a=3e3,c=b.throttle(e.flushPendingViewedThreads,a,{leading:!1});return function(a,d){d=d||{};var e=d.thread_state||"unviewed",h=f[e]||{};h=b.extend(h,a),f[e]=b.extend(h,a),g[e]=d,c()}}(),e}),define("models/thread",["require","underscore","models/lib/client/realtime_thread_client","core/lib/client/bayeux","models/lib/helper/feed_factory","core/lib/model_helper","models/lib/orm-models","core/lib/yammer_api","models/lib/model/deliverable","models/lib/model/deliverable_static","core/lib/session","models/lib/model/helper/thread_viewed_state","models/lib/helper/viewed_state_helper","core/lib/yammer_uri","models/lib/model/helper/log_viewed_threads","core/lib/treatment","models/topic","backbone","models/lib/events","collections/groups"],function(a){var b=a("underscore"),c=a("models/lib/client/realtime_thread_client"),d=a("core/lib/client/bayeux"),e=a("models/lib/helper/feed_factory"),f=a("core/lib/model_helper"),g=a("models/lib/orm-models"),h=a("core/lib/yammer_api"),i=a("models/lib/model/deliverable"),j=a("models/lib/model/deliverable_static"),k=a("core/lib/session"),l=a("models/lib/model/helper/thread_viewed_state"),m=a("models/lib/helper/viewed_state_helper"),n=a("core/lib/yammer_uri"),o=a("models/lib/model/helper/log_viewed_threads"),p=a("core/lib/treatment"),q=a("models/topic"),r=a("backbone"),s=a("models/lib/events"),t=f.define("yam.model.Thread",[i,r.Events],function(){this.clientize(c,"Thread"),b.extend(this,j);var f=this.prototype.create;this.prototype.create=function(){var a=f.apply(this,arguments),b=g.OnThreadCreate();return b.fixThreadCounts(a),a},this.prototype.getMessages=function(){var a=g.Message();return a.find({thread_id:this.id,is_reference:!1})},this.prototype.getSnippets=function(){var a=g.Snippet();return a.find({thread_id:this.id})},this.prototype.getServerUpdates=function(){return this.server_updates},this.prototype.getAnyFeed=function(){var a=b.detect(this.getDeliverys(),function(a){return"feed"===a.receiver_type&&a.getReceiver()});return a&&a.getReceiver()},this.prototype.getAllFeeds=function(){var a=b.filter(this.getDeliverys(),function(a){return"feed"===a.receiver_type&&a.getReceiver()});return b.map(a,function(a){return a.getReceiver()})},this.prototype.getInboxUnreadFeed=function(){return e.findOrCreate("inboxUnread")},this.prototype.getInboxAllFeed=function(){return e.findOrCreate("inboxAll")},this.prototype.getThreadStarter=function(){var a=g.Message();return a.findById(this.thread_starter_id)},this.prototype.isFromUser=function(a){var b=this.getThreadStarter(),c=b.getSender();return c.getUser()&&c.getUser().id==a.id},this.prototype.getLocalLatestReplyId=function(){return this.local_latest_reply_id||0},this.prototype.setLocalLatestReplyId=function(a){this.local_latest_reply_id=a},this.prototype._create=this.prototype.create,this.prototype.create=function(){return this.local_latest_reply_id=this.stats.latest_reply_id,this.initializeHelperObjects(),this.listenTo(s,"Thread/"+this.id+"/update",function(a){var b=g.OnThreadUpdate();b.fixThreadCounts(a)}),this._create()},this.prototype.initializeHelperObjects=function(){this.viewedState=new l({thread:this}),this.viewedState.futureViewedStateModel=m.updateViewedState({id:this.id,lastReplyMessageId:this.stats?this.stats.latest_reply_id:void 0,feedFetchType:"thread_create",dataOrigin:"stats_at_create"})},this.prototype.process=function(){},this.prototype.getMessageReferences=function(){var a=g.Message();return a.find({thread_id:this.id,is_reference:!0})},this.prototype.getPermalink=function(){return n.app("/#/Threads/show?threadId="+this.getThreadStarter().id)},this.prototype.hasAttachmentFromApp=function(a){var b=!1;return this.getThreadStarter()&&(b=this.getThreadStarter().hasAttachmentFromApp(a)),b},this.prototype.findAttachmentFromApp=function(a){var b=null;return this.getThreadStarter()&&(b=this.getThreadStarter().findAttachmentFromApp(a)),b},this.prototype.getConversation=function(){var a=this.getMessages().length?this.getMessages()[0].getConversation():void 0;return a},this.prototype.getReplies=function(){var a=[],b=this.getMessages(),c=this.getThreadStarter();return c&&b.forEach(function(b){b.id!=c.id&&a.push(b)}),a},this.prototype.getFirstLocalReply=function(){return b(this.getReplies()).chain().sortBy(function(a){return a.id}).first().value()},this.prototype.hasReplies=function(){return this.getReplyCount()>0},this.prototype.getReplyCount=function(){return this.stats.updates-1},this.prototype.hasShares=function(){return this.getShareCount()>0},this.prototype.getShareCount=function(){return this.stats.shares},this.prototype.getLatestReplyTime=function(){var a=this.stats.latest_reply_at,b=new Date(a);return"Invalid Date"===b&&(a=a.replace("T"," ").replace("Z"," UTC").replace(/-/g,"/"),b=new Date(a)),b},this.prototype.getLatestReplyId=function(){return this.stats.latest_reply_id},this.prototype.getReplyCount2=function(){return this.getServerUpdates()-1},this.prototype.gapExistsInReplies=function(){var a=this.getReplyCount2()-this.getReplies().length;return a>this.initial_missing_reply_count},this.prototype.getSnippetCount=function(){return this.stats.snippet_matches_total||0},this.prototype.getUnseenSnippetCount=function(){return this.stats.snippet_matches_remaining||0},this.prototype.getTopics=function(){var a,b=this.topics,c=[];if(!this.topics)return[];for(var d=0,e=b.length;e>d;d++)a=q.findById(b[d].id),a&&c.push(a);return c},this.prototype.addTopic=function(a){this.topics.push(a)},this.prototype.isFullThread=function(){var a=this.getThreadStarter();return!!a&&!a.is_reference},this.prototype.areAllMessagesAvailableLocally=function(){return this.getSortedMessages().length>=this.getServerUpdates()},this.prototype.getLastMessage=function(){return b.last(this.getSortedMessages())},this.prototype.getSortedMessages=function(){return this.getMessages().sort(function(a,b){return a.id-b.id})},this.prototype.mute=function(){var a=this,b=function(){a.muted=!0,yam.model.repository.transaction(function(){a.undeliver()})};return h.muteThread({thread_id:this.id}).then(b)},this.prototype.setUnread=function(){this.redeliver()},this.prototype.deliver=function(a){t.saveAndDeliver(this,a)},this.prototype.redeliver=function(){b.each(this.getDeliverys(),function(a){a.update()})},this.prototype.undeliver=function(a){if(a){var c=a.getDeliveryFor(this);return void(c&&c.destroy())}b.each(this.getDeliverys(),function(a){var b=a.getReceiver();this.undeliver(b)},this)},this.prototype.newestMessage=function(){var a=this.getMessages();return a.sort(function(a,b){return a.id<b.id?1:-1})[0]},this.prototype.oldestReply=function(){var a,b=this.getReplies();return b.length?b.sort(function(a,b){return a.id>b.id?1:-1})[0]:a},this.prototype.repliesMissing=function(){return this.getReplies().length<this.getReplyCount2()},this.prototype.setLastSeenId=function(a){this.update({last_seen_message_id:a})},this.prototype.isFollowedInInbox=function(){var a=g.InboxFollow();return a.find({thread_id:this.id})[0]},this.prototype.addToInboxLocal=function(){if(!this.isFollowedInInbox()){var a=g.InboxFollow();a.create({thread_id:this.id,user_id:k.getCurrentUser().id})}},this.prototype.removeFromInboxLocal=function(){var a=this.isFollowedInInbox();a&&(a.destroy(),this.update(),b.chain(this.getDeliverys()).invoke("getReceiver").each(function(a){a&&a.isInbox&&a.isInbox()&&this.undeliver(a)},this))},this.prototype.followInInbox=function(a){if(this.isFollowedInInbox())return $.Deferred().reject();a=a||{};var b=a.fromRealtime?$.Deferred().resolve():h.followThreadInInbox({threadId:this.id});return b.then(function(){this.addToInboxLocal(),a.success&&a.success(this,a),this.markAsUnread(),
this.deliver(this.getInboxAllFeed()),a.complete&&a.complete()}.bind(this),function(){a.error&&a.error(),a.complete&&a.complete()})},this.prototype.unfollowInInbox=function(a){var b=this;if(!b.isFollowedInInbox())return $.Deferred().reject();a=a||{},this.setPriorityReason(void 0);var c=a.fromRealtime?$.Deferred().resolve():h.unfollowThreadInInbox({threadId:b.id});return c.then(function(){b.removeFromInboxLocal(),a.success&&a.success(b,a),a.complete&&a.complete()},function(){a.error&&a.error(),a.complete&&a.complete()})};var i=function(a,b){return!(!b.getDeliveryFor(a)&&!b.isSeen(a))},r=function(a,b){b&&i(a,b)&&b.markSeen(a)},u=function(a,b){b&&b.trigger("markUnseen",a)};this.prototype.getPriorityReason=function(){return this.priority_reason},this.prototype.setPriorityReason=function(a){this.priority_reason=a},this.prototype.markAsRead=function(a){var b=this.getInboxUnreadFeed();if(!b||!b.isSeen(this))return this.setPriorityReason("mark"),r(this,b),a&&a.fromRealtime?void(a.success&&a.success.call()):(a=a||{},a.data={thread_id:this.id,message_id:this.getLastMessage().id},a.log_data&&(a.data.log_data=a.log_data),h.setThreadLastSeen(a))},this.prototype.markAsUnread=function(a){var b=this.getInboxUnreadFeed();if(!(b&&b.isTracking(this)&&b.isUnseen(this)))return this.setPriorityReason("mark"),u(this,b),a&&a.fromRealtime?void(a.success&&a.success.call()):(a=a||{},a.data={thread_id:this.id,message_id:this.last_seen_message_id||0},a.log_data&&(a.data.log_data=a.log_data),h.setThreadLastSeen(a))},this.prototype.getLastViewedMessageId=function(){return this.viewedState.getLastViewedMessageId()},this.prototype.isViewed=function(){return this.viewedState.isViewed()},this.prototype.isSeen=function(){var a=this.getInboxUnreadFeed();return!(!this.isFollowedInInbox()||!a.isSeen(this))},this.prototype.markAsViewed=function(a){p.treatment("tow_log_viewed_threads_fix")?this._markAsViewedTowLogViewedThreadsFix(a):this._markAsViewedLegacy(a)},this.prototype._markAsViewedTowLogViewedThreadsFix=function(a){a=a||{},b.defaults(a,{immediate:!0,log:{}});var c=b.defaults(a.log,{feed_type:"",feed_id:"",feed_view:"",action_type:"",action_info:"",thread_state:""}),d=this.viewedState,e=d.isViewed(),f=this.id,g=this.getLatestReplyId(),h={},i=a.immediate||!e||this._isNewThreadView(c);h[f]=g;var j=(c.feed_type||"")+(c.feed_id||"");m.updateViewedState({id:this.id,lastViewedMessageId:g,lastReplyMessageId:g,dataOrigin:"markViewed_"+c.action_type+"_"+j}),i&&(a.immediate?o.setViewedThreads(h,c):o.setViewedThreadsThrottled(h,c),this.viewedState.lastLoggedContext=this._getLoggingContext(c))},this.prototype._isNewThreadView=function(a){return!b.isMatch(this.viewedState.lastLoggedContext,this._getLoggingContext(a))},this.prototype._getLoggingContext=function(a){return{feed_view:a.feed_view,feed_id:a.feed_id,action_type:a.action_type,action_info:a.action_info,feed_type:a.feed_type,lastViewedMessageId:this.getLatestReplyId()}},this.prototype._markAsViewedLegacy=function(a){a=a||{},b.defaults(a,{immediate:!0,log:{}});var c=b.defaults(a.log,{feed_type:"",feed_id:"",action_type:"",action_info:"",thread_state:""}),d=this.viewedState,e=d.hasLastViewedMessageId(),f=d.isViewed(),g=this.id,h=this.getLatestReplyId(),i={};i[g]=h;var j=(c.feed_type||"")+(c.feed_id||"");m.updateViewedState({id:this.id,lastViewedMessageId:h,lastReplyMessageId:h,dataOrigin:"markViewed_"+c.action_type+"_"+j});var k=!e||!f,l=this.viewedState.has_logged_state_this_session&&!a.immediate;l||(k=!0,this.viewedState.has_logged_state_this_session=!0),k&&(a.immediate?o.setViewedThreads(i,c):o.setViewedThreadsThrottled(i,c))},this.prototype.updateLastViewedMessageId=function(a){var b=this.viewedState,c=b.getLastViewedMessageId(),d=!1,e=a&&a>0;return e&&(d=!b.hasLastViewedMessageId()||a>c),d&&(b.last_viewed_message_id=a),this.getLastViewedMessageId()},this.prototype.translate=function(){var a=g.Message();this.isTranslated=!0;var c=b(this.getMessages()).filter(function(b){return b.getTranslationStatus()===a.NOT_TRANSLATED&&b.canBeTranslated()});return a.translateMessages(c)},this.prototype.untranslate=function(){var a=g.Message();this.isTranslated=!1,a.untranslateMessages(this.getMessages())},this.prototype.getClientOptions=function(){return{thread_id:this.id}},this.prototype.broadcast=function(a,b){var c=b||{};d.publish("/service/broadcast/thread",{thread_id:this.id,channel:a,data:c})},this.prototype.getInvitedUsers=function(){var a=g.User();return b.chain(this.invited_user_ids).map(a.findById,a).compact().value()},this.prototype.getForeignUsers=function(){var a=g.User();return b.compact(b.map(this.external_references,function(b){return"user"==b.type?a.findById(b.id):void 0}))},this.prototype.getGroup=function(){var b=a("collections/groups");return null!=this.group_id?b.get(this.group_id):null},this.prototype.isForeign=function(){return this.getThreadStarter().isForeign()},this.prototype.isReadOnly=function(){return!!this.read_only},this.prototype.isXmess=function(){return this.getThreadStarter().isXmess()},this.prototype.moveToGroup=function(a){return h.moveToGroup(a.data).then(a.success,a.error)},this.prototype.getParticipantIds=function(){return(this.invited_user_ids||[]).concat(b.pluck(this.participants,"id"))},this.prototype.removeParticipants=function(a,c,d){var e=this.getParticipantIds(),f=b.intersection(a,e),g=this;b.isEmpty(f)?d("users_already_removed"):h.removeThreadParticipants({threadId:this.id,participantIds:f.join(",")}).then(function(){g.invited_user_ids&&(g.invited_user_ids=b.difference(g.invited_user_ids,f)),g.participants&&(g.participants=g.participants.filter(function(a){return!b.contains(f,a.id)}),g.external_references=g.external_references.filter(function(a){return!("user"===a.type&&b.contains(f,a.id))}),g.references=g.references.filter(function(a){return!("user"===a.type&&b.contains(f,a.id))})),c()},d)},this.prototype.deleteMessage=function(a){var c=g.Message(),d=c.findById(a);if(d){d.destroy();var e=this.getSortedMessages();this.thread_starter_id===a?e.length>0?this.thread_starter_id=e[0].id:(this.undeliver(),this.destroy()):b.each(e,function(b){b.replied_to_id===a&&(b.replied_to_id=null)})}}});return t}),define("models/lib/helper/realtime_message_resolver",["require","underscore","core/lib/namespace","core/lib/yammer_api","core/lib/util/work_queue","core/lib/client/payload_helper","core/lib/client/message_payload","models/thread","models/lib/helper/feed_hydrator","models/lib/helper/feed_fetcher"],function(a){var b=a("underscore"),c=a("core/lib/namespace"),d=a("core/lib/yammer_api"),e=a("core/lib/util/work_queue"),f=a("core/lib/client/payload_helper"),g=a("core/lib/client/message_payload"),h=a("models/thread"),i=a("models/lib/helper/feed_hydrator"),j=a("models/lib/helper/feed_fetcher"),k=new e;return{start:function(a){this._performBackfill(a,"Backfill")},restart:function(a){this._performBackfill(a,"Reconnect")},_performBackfill:function(a,b){j.fetchNewer(a.getPrimaryFeed()).then(this._hydrateFeeds.bind(this,a,"newerThan_"+b))},onData:function(a,b){var d=c.val(b,"data.data.message_id");("message"===b.data.type||d)&&(d?this._resolveMessageFeed(a,d,b):this._processMessageFeed(a,b,b.data))},_resolveMessageFeed:function(a,b,c){d.getMessageFeed({id:b}).then(this._processMessageFeed.bind(this,a,c))},_processMessageFeed:function(a,d,e){var f=new g(e.data);if(f.is_read=!!c.val(d,"ext.is_read"),this._filterMatch(a,f,d)){var h=f.getMessages();b.each(h,function(a){a.isFromRealtime=!0}),this._resolveThread(a,f,b.bind(function(){this._hydrateFeeds(a,"realtimeMessageResolve",f)},this))}},_resolveThread:function(a,c,e){var g=b.filter(c.val("messages"),function(a){var b=h.findById(a.thread_id);return b&&!b.isFullThread()&&(b=null),a.replied_to_id&&a.thread_id&&!b||b&&b.direct_message!=a.direct_message});g&&g.length||e(a,c),b.each(g,function(b){k.enqueue(function(g){var h=f.messagePayloadProcessor,i=g.onFailure.bind(g),j=function(b){c.merge(b.getRaw()),g.onComplete(),e(a,c)};d.getThread({threadId:b.thread_id,threaded:"extended"}).then(h(j),i)})},this)},_hydrateFeeds:function(a,b,c){a.getFeeds().forEach(function(a){i.hydrate({feed:a,payload:c,fetchType:b})})},_getThreadFilters:function(a){return c.val(a,"ext.thread_filters")},_filterMatch:function(a,c,d){var e=!0,f=a.getPrimaryFeed().getFilters(),g=this._getThreadFilters(d);return g&&f&&(e=0===b.without.apply(b,[f].concat(g.filters)).length),e}}}),define("models/lib/helper/realtime_connection_factory",["require","underscore","models/lib/client/realtime_feed_connections","models/lib/helper/realtime_fetchnewer_resolver","models/lib/helper/realtime_message_resolver","models/lib/helper/assured_delivery_experiments","models/helpers/feed"],function(a){"use strict";var b=a("underscore"),c=a("models/lib/client/realtime_feed_connections"),d=a("models/lib/helper/realtime_fetchnewer_resolver"),e=a("models/lib/helper/realtime_message_resolver"),f=a("models/lib/helper/assured_delivery_experiments"),g=a("models/helpers/feed");return{openConnectionForFeed:function(a){var c=this._getConnectionForFeed(a);return b.isNull(c)||c.isConnected()||(this._setupListeners(c,a),c.connect()),c},_setupListeners:function(a,c){var d=this._getRealtimeDeliveryResolver(c);a.on("realtimeData",b.partial(d.onData,a),d),a.on("connectionReconnected",b.partial(d.restart,a),d),a.once("connectionSuccess",b.partial(d.start,a),d)},_getConnectionForFeed:function(a){var b=g.shouldConnectFeed(a);if(!b)return null;var d=g.getCommonId(a),e=c.get(d);return e||(e=c.create({realtimeInfo:a.getRealtimeInfo(),connectionId:d})),e.registerFeed(a),e},_getRealtimeDeliveryResolver:function(a){return f.newerRealtimeTreatment(a)?d:e}}}),define("models/feed",["require","jquery","underscore","backbone","models/lib/model/helper/feed_unseen_count_processor","collections/feed_counters","models/receiver","models/lib/helper/feed_fetcher","models/helpers/feed","models/lib/helper/feed_hydrator","models/lib/helper/feed_filter_helper","core/lib/log","core/lib/model_helper","models/lib/orm-models","models/lib/helper/realtime_connection_factory","core/lib/session","core/lib/tr","core/lib/yammer_request","core/lib/yammer_uri","models/lib/helper/assured_delivery_experiments","models/helpers/network","models/lib/events"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("models/lib/model/helper/feed_unseen_count_processor"),f=a("collections/feed_counters"),g=a("models/receiver"),h=a("models/lib/helper/feed_fetcher"),i=a("models/helpers/feed"),j=a("models/lib/helper/feed_hydrator"),k=a("models/lib/helper/feed_filter_helper"),l=a("core/lib/log"),m=a("core/lib/model_helper"),n=a("models/lib/orm-models"),o=a("models/lib/helper/realtime_connection_factory"),p=a("core/lib/session"),q=a("core/lib/tr"),r=a("core/lib/yammer_request"),s=a("core/lib/yammer_uri"),t=a("models/lib/helper/assured_delivery_experiments"),u=a("models/helpers/network"),v=a("models/lib/events"),w=Math.pow(2,53)-1;return m.define("yam.model.Feed",[g,d.Events],function(){this.UNKNOWN_COUNT_VALUE=100,this.prototype._autoKey=1,this.prototype.getNetwork=function(){var a=n.Network();return a.findById(this.network_id)},this.prototype.getUrl=function(){return i.getUrl(this.keyType,this.keyId)},this.prototype.hasKeyType=function(a){return this.keyType===a},this.prototype.getLogSource=function(){return i.getLogSource(this.keyType)},this.prototype.getLogFeedView=function(){return this.isUnviewed()?"unviewed":"default"},this.prototype.getFilters=function(){return k.getFilters(this.keyType)},this.prototype.destroyDeliverys=function(){return c(this.getDeliverys()).each(function(a){a.destroy()})},this.prototype.pruneUsingContentFilter=function(){var a=k.pruneUsingContentFilter(this);return a>0&&this.updateOldestThreadedId(),a},this.prototype.pruneThreads=function(a){var b={},d=n.Thread(),e=this.getDeliverys(),f=function(a){var c=b[a.id]||{};return c.threadId=a.id,c.delivery=c.delivery||null,b[a.id]=c};if(c.each(e,function(a){var b,c="thread"===a.type&&a.getObject();c&&(b=f(c),b.delivery=a)}),a>=c.size(b))return 0;var g=c.map(c.keys(b),function(a){var c=b[a];return c.threadId=a,c});g=g.sort(this.compareItems.bind(this));var h=g[a-1];if(h&&h.delivery){var i=d.findById(h.delivery.type_id);this._oldest_threaded_id=i.stats.latest_reply_id}else this._oldest_threaded_id=w;this.setOlderAvailable(!0);for(var j=0,k=function(a){a&&a.destroy&&(a.destroy({pruned:!0}),j+=1)},l=a;l<g.length;++l){var m=g[l];k(m.delivery)}return j},this.prototype.compareItems=function(a,b){var c=this.getOrder(a),d=this.getOrder(b);return c-d},this.prototype.getOrder=function(a){if(c.find(this.listModels,function(b){return a instanceof b})){var b=a[this.sort_by];if("undefined"!=typeof b)return b;throw new Error("Custom list item needs a sort index")}return this.getThreadOrder(a,a.threadId)},this.prototype.getThreadOrder=function(a,b){var c=n.Thread();a.stats||(a=c.findById(b));var d;return d=this.sort_by?this.sort_by in a?a[this.sort_by]:this.sort_by in a.getThreadStarter()?a.getThreadStarter()[this.sort_by]:-1:-a.stats.latest_reply_id},this.prototype.updateCountFromNetwork=function(a){return this.unseenCountProcessor.updateCountFromNetwork(a)},this.prototype.hasOlderAvailable=function(){return this._olderAvailable},this.prototype.fetchThread=function(a,b){return h.fetchThread(this,a,b).then(this._hydrate.bind(this,"inThread"))},this.prototype.getNewestMessageId=function(){return this.newest_message_id||0},this.prototype.setNewestMessageId=function(a){a>this.getNewestMessageId()&&(this.newest_message_id=a)},this.prototype.getMessages=function(){var a=this.getThreads({sorted:!1});return c.reduce(a,function(a,b){return a=a.concat(b.getMessages())},[])},this.prototype.getThreads=function(a){a=c.defaults(a||{},{sorted:!0});var b=this.getDeliveryObjectsByType("thread");return a.filter_by&&(b=c.filter(b,function(b){return b[a.filter_by]})),a.sorted?b.sort(this.compareItems.bind(this)):b},this.prototype.postMessage=function(a){var e=p.getCurrentUser(),f=n.Message().find({sender_id:e.id,sender_type:"user"});e&&!f.length&&d.trigger("taskListComplete","make_a_post");var g=c.has(a,"direct_to_user_ids")||c.has(a,"direct_to_id");if(g&&a.group_id&&delete a.group_id,this.isGroup()&&!a.replied_to_id&&a.group_id!=this.getGroupId()){var i=q.t("posting_group_message_on_nongroup_feed");return l.warn("yam.model.Feed",i,"param group id: ",a.group_id,"feed group id: ",this.getGroupId()),b.Deferred().reject({responseText:i})}return h.postMessage(this,a).then(this._hydrate.bind(this,"post"))},this.prototype._hydrate=function(a,b){return j.hydrate({feed:this,payload:b,fetchType:a}),b},this.prototype.isInbox=function(){return this.hasKeyType("inboxChat")||this.hasKeyType("inboxRead")||this.hasKeyType("inboxUnread")||this.hasKeyType("inboxAll")},this.prototype.isAllCompany=function(){return this.hasKeyType("general")||this.hasKeyType("generalUnviewed")},this.prototype.isGroup=function(){return this.hasKeyType("group")||this.hasKeyType("groupUnviewed")},this.prototype.isUnviewed=function(){return this.hasKeyType("generalUnviewed")||this.hasKeyType("groupUnviewed")},this.prototype.getGroupId=function(){return this.isGroup()?this.keyId:void 0},this.prototype.isTracking=function(a){return!!this.getDeliveryFor(a)},this.prototype.getUnseenCount=function(){return this.isSyncingCursor()&&(this.unseen_thread_count=0,this.unseen_message_count=0),this.getUnseenThreadCount()},this.prototype.getUnseenThreadCount=function(){return this.unseenCountProcessor.getUnseenThreadCount()},this.prototype.getUnseenMessageCount=function(){return this.unseen_message_count||0},this.prototype.initializeHelperObjects=function(){var a=i.getCommonId(this);this.feedCounter=f.get(a),this.feedCounter||(this.feedCounter=f.create({id:a,feed:this})),this.unseenCountProcessor=new e({feed:this})},this.prototype._create=this.prototype.create,this.prototype.create=function(){return null==this.network_id&&p.getCurrentNetwork()&&(this.network_id=p.getCurrentNetwork().id),this.initializeHelperObjects(),this._clearUnseenCountCache(),this._startListening(),this._create()},this.prototype._startListening=function(){this.listenTo(v,"Message/create",this._onMessageCreate.bind(this)),this.listenTo(v,"Message/update",this._onMessageUpdate.bind(this)),this.on("onFullMessageCreate",this._fullMessageCreate.bind(this)),this.on("markUnseen",this.markUnseen.bind(this))},this.prototype._onMessageCreate=function(a){if(!a.is_reference){var b=this._isMessageInFeed(a);b&&this.trigger("onFullMessageCreate",a)}},this.prototype._onMessageUpdate=function(a,b){if(!a.is_reference&&b.before.is_reference&&!b.after.is_reference){var c=this._isMessageInFeed(a);c&&this.trigger("onFullMessageCreate",a)}},this.prototype._isMessageInFeed=function(a){var b=this.getThreads({sorted:!1});return c.any(b,function(b){return b.id===a.thread_id})},this.prototype._update=this.prototype.update,this.prototype.update=function(a){this.isSyncingCursor()&&(a.unseen_thread_count=0,a.unseen_message_count=0),this._update(a)},this.prototype._fullMessageCreate=function(a){this.getNetwork()&&this.hasFirstPayload()&&this.decrementOlderUnseenCountFor(a)},this.prototype.decrementOlderUnseenCountFor=function(a){var b=a.getThread(),c=b&&b.getLatestReplyId();if(c<this.getLocalOldestMessageId()&&c>this.getLocalLastSeenMessageId()){var d=this.getOlderUnseenCount();0!==d&&d<this.constructor.UNKNOWN_COUNT_VALUE&&this.setOlderUnseenCount(d-1)}else c<=this.getLocalLastSeenMessageId()&&this.setOlderUnseenCount(0)},this.prototype.incrementCountFor=function(a){var b=this.isUnseen(a);if(b&&!this.isOlderReply(a)){var c={};if("yam.model.Message"===a.declaredClass){c={unseen_message_count:this.getUnseenMessageCount()+1};var d=a.getThread(),e=this.getUnseenCountFor(d);this.setUnseenCountFor(d.id,e+1)}}},this.prototype.updateUnseenCounts=function(a){var b=a.val("meta.unseen_message_count_by_thread"),d=a.val("meta.unseen_thread_count"),e=a.val("meta.last_seen_message_id");if(c.isEmpty(b))this.hasFirstPayload()&&this._incrementCountsByMessages(a.getFullMessages());else{var f=e<this.getLocalLastSeenMessageId();this._incrementMessageCountsByThreadInfo(b),f&&!this.isInbox()||this._setUnseenThreadCount(d)}},this.prototype._incrementCountsByMessages=function(a){var b=this,d=0,e=0,f=n.Message(),g=c.inject(a,function(a,c){var d="yam.model.Message"===c.declaredClass?c:f.findById(c.id);return!b.isUnseen(d)||d.isFromUser(p.getCurrentUser())||b.isOlderReply(d)||(a[d.thread_id]=a[d.thread_id]||0,a[d.thread_id]++),a},{});c.each(g,function(a,c){d+=a;var f=b.getUnseenCountFor(c);f||e++,b.setUnseenCountFor(c,f+a)}),(e||d)&&this.update({unseen_message_count:this.getUnseenMessageCount()+d,unseen_thread_count:this.getUnseenThreadCount()+e})},this.prototype._incrementMessageCountsByThreadInfo=function(a){var b=this;c.inject(a,function(a,c,d){return c>b.getUnseenCountFor(d)&&a++,b.setUnseenCountFor(d,c),a},0)},this.prototype._setUnseenThreadCount=function(a){return this.unseenCountProcessor.setUnseenThreadCount(a)},this.prototype.decrementCountFor=function(a,b){b=b||1;var c=this.getUnseenMessageCount(),d=c-b;return d>-1&&this.update({unseen_message_count:d}),d},this.prototype.onThreadUpdate=function(a){this.isInbox()&&this._updateNetworkCountsFor(a)},this.prototype.onThreadDestroy=function(a,b){if(this.isInbox()&&!b.isPruned()){if(this.getUnseenCountFor(a)){var c=this.getUnseenThreadCount();this.update({unseen_thread_count:c>0?c-1:0})}this.setUnseenCountFor(a,0)}},this.prototype.onActivityCreate=function(){},this.prototype.isUnseen=function(a){if("yam.model.Thread"===a.declaredClass)return!this.isSeen(a);if(this.isInbox()){var b=a.getThread().getLocalLatestReplyId();return a.id>b||a.id==b&&a.id>this.getLocalLastSeenMessageId()}return a.id>this.getLocalLastSeenMessageId()},this.prototype.isSeen=function(a){return this.isInbox()?this.getUnseenCountFor(a)<=0:this.isTracking(a)?a.getLatestReplyId()<=this.getLocalLastSeenMessageId():!1},this.prototype.isOlderReply=function(a){return a.id<this._getOlderReplyCursor()},this.prototype._getOlderReplyCursor=function(){return this.older_reply_cursor},this.prototype._setOlderReplyCursor=function(a){this.older_reply_cursor=a},this.prototype.getOlderUnseenCountFor=function(a){if(!this.getUnseenCountFor(a)||!a.hasReplies())return 0;var b=a.getFirstLocalReply(),d=this.getUnseenCountFor(a)-c.inject(a.getReplies(),function(a,c){return b&&c.id>=b.id?a+1:a},0,this);return this.isUnseen(a.getThreadStarter())?d-1:d},this.prototype.getUnseenCountFor=function(a){var b="object"==typeof a?a.id:a;return this._unseenCountCache[b]||0},this.prototype.setUnseenCountFor=function(a,b){var c="object"==typeof a?a.id:a;b?this._unseenCountCache[c]=b:delete this._unseenCountCache[c]},this.prototype._clearUnseenCountCache=function(){this._unseenCountCache={}},this.prototype.setOlderUnseenCount=function(a,b){return"undefined"==typeof b?this.older_unseen_count=a:void(b>a?this.older_unseen_count=0:a>=this.constructor.UNKNOWN_COUNT_VALUE?this.older_unseen_count=this.constructor.UNKNOWN_COUNT_VALUE:this.older_unseen_count=a-b)},this.prototype.setOlderAvailable=function(a){this._olderAvailable=a},this.prototype.setRealtimeInfo=function(a){this._realtimeInfo=a},this.prototype.getRealtimeInfo=function(){return this._realtimeInfo},this.prototype.getLastRenderedInboxId=function(){return this.last_rendered_inbox_message_id||0},this.prototype.setLastRenderedInboxId=function(a){this.last_rendered_inbox_message_id=a},this.prototype.updateLastRenderedInboxId=function(){var a=this.getLocalLastSeenMessageId(),b=this.getLastSeenMessageId();this.last_rendered_inbox_message_id&&a===b||(this.last_rendered_inbox_message_id=a)},this.prototype.getOlderUnseenCount=function(){return this.older_unseen_count},this.prototype.getLastSeenMessageId=function(){return this.last_seen_message_id||0},this.prototype.getLocalLastSeenMessageId=function(){return this.local_last_seen_message_id||0},this.prototype.setLocalLastSeenMessageId=function(a){isNaN(parseInt(a,10))||(a>this.getLocalLastSeenMessageId()?this.local_last_seen_message_id=a:l.warn("Tried to set a lower local last seen message ID [local_last_seen_message_id:"+this.getLocalLastSeenMessageId()+", message_id:"+a+", feed:"+this.id+"]"))},this.prototype.setLocalOldestMessageId=function(a){this.local_oldest_message_id=a},this.prototype.getLocalOldestMessageId=function(){return this.local_oldest_message_id},this.prototype.setLastSeenMessageId=function(a){isNaN(parseInt(a,10))||(a>this.getLastSeenMessageId()?this.last_seen_message_id=a:l.warn("Tried to set a lower last seen message ID [last_seen_message_id:"+this.last_seen_message_id+", message_id:"+a+", feed:"+this.id+"]"))},this.prototype.markSeen=function(a){if(a&&(!this.isTracking(a)||!this.isSeen(a))){var b=this.getUnseenThreadCount();this.update({unseen_thread_count:b>0?b-1:0}),this.setUnseenCountFor(a.id,0),a.deliver(this)}},this.prototype.markUnseen=function(a){if(!this.isTracking(a)||!this.isUnseen(a)){var b=this.getUnseenThreadCount();this.update({unseen_thread_count:b+1});var c=a.getReplyCount2()+1;this.setUnseenCountFor(a.id,c),a.deliver(this)}},this.prototype.isSyncingCursor=function(){return t.isOcularSupportedFeed(this)?!1:!!this.is_syncing_cursor},this.prototype.pushCursor=function(a){var b=null==this.last_seen_message_id||null!=this.previous_last_seen_message_id&&this.previous_last_seen_message_id>=this.last_seen_message_id;if(!b||a){var d=s.api("messages/last_seen"),e={message_id:this.getLastSeenMessageId()},f={is_syncing_cursor:!0,previous_last_seen_message_id:this.getLastSeenMessageId()};if(!a&&t.isOcularSupportedFeed(this)||(f.unseen_message_count=0,f.unseen_thread_count=0,this._clearUnseenCountCache()),this.update(f),this.isAllCompany()?d=s.api("messages/last_seen_in_general"):this.isGroup()&&(e.group_id=this.getGroupId()),this.isAllCompany()||this.isGroup()){var g={url:d,type:"POST",auth:"oauth2",data:e,complete:c.bind(function(){this.is_syncing_cursor=!1},this)};return a&&(g.data.mark_all_as_viewed=!0,g.success=c.bind(function(){this.feedCounter.trigger("markAllAsViewedSuccess",e.message_id)},this),g.error=c.bind(function(){this.feedCounter.trigger("markAllAsViewedError")},this)),r.send(g)}this.is_syncing_cursor=!1}},this.prototype._updateNetworkCountsFor=function(a){this.isInbox()&&!this.hasKeyType("inboxUnread")||(this.isSeen(a)?u.decrementCountFor(this.getNetwork(),this,a):u.incrementCountFor(this.getNetwork(),this,a))},this.prototype.setOldestThreadedId=function(a){a=a||w,this._oldest_threaded_id=this._oldest_threaded_id||w,a<this._oldest_threaded_id&&(this._oldest_threaded_id=a)},this.prototype.getOldestThreadedId=function(){return this._oldest_threaded_id},this.prototype.updateOldestThreadedId=function(a){a=a||this.getThreads();var b=c.last(a);this._oldest_threaded_id=b?b.getLatestReplyId():w},this.prototype.fetch=function(){return h.fetch(this).then(this._hydrate.bind(this,"initial"))},this.prototype.fetchOlder=function(a){return h.fetchOlder(this,a).then(this._hydrate.bind(this,"olderThan"))},this.prototype.fetchNewer=function(a){return h.fetchNewer(this).then(this._hydrate.bind(this,a))},this.prototype.connectToRealtime=function(){this._realtimeConnection||(this._realtimeConnection=o.openConnectionForFeed(this))},this.prototype.isRealtimeConnected=function(){return!!this._realtimeConnection&&!!this._realtimeConnection.isConnected()},this.prototype.hasFirstPayload=function(){return!!this._hasFirstPayload},this.prototype.onFirstPayload=function(){this._hasFirstPayload=!0}}),yam.model.Feed}),define("models/guide",["require","core/lib/model_helper"],function(a){var b=a("core/lib/model_helper");return b.define("yam.model.Guide",function(){this.prototype.type="guide"})}),define("models/inbox_follow",["require","core/lib/model_helper","models/lib/orm-models"],function(a){var b=a("core/lib/model_helper"),c=a("models/lib/orm-models");return b.define("yam.model.InboxFollow",function(){this.prototype._autoKey=1,this.prototype.getUser=function(){var a=c.User();return a.findById(this.user_id)},this.prototype.getMessage=function(){var a=c.Message();return a.findById(this.message_id)}})}),define("models/lib/model/class_events/on_thread_create",["require","core/lib/log","core/lib/namespace"],function(a){var b=a("core/lib/log"),c=a("core/lib/namespace");return c.ns("yam.model.classEvents.onThreadCreate",{fixThreadCounts:function(a){0===a.stats.updates?(a.server_updates=1,b.log("Thread stats updates was 0. Correcting server_updates to 1.")):a.server_updates=a.stats.updates,a.is_tracking_stats_locally=!0,a.initial_missing_reply_count=a.getReplyCount2()-a.getReplies().length}}),yam.model.classEvents.onThreadCreate}),define("models/lib/model/class_events/on_thread_update",["require","core/lib/log","core/lib/namespace"],function(a){var b=a("core/lib/log"),c=a("core/lib/namespace");return c.ns("yam.model.classEvents.onThreadUpdate",{fixThreadCounts:function(a){if(a.is_tracking_stats_locally===!0){a.stats.updates>a.server_updates&&(b.log("Locally tracked thread updates were less than server thread.stats.updates. local: ",a.server_updates," server: ",a.stats.updates),a.server_updates=a.stats.updates);var c=a.getReplies().length+1;c>a.server_updates&&(b.log("Locally tracked thread updates were less than the count of loaded messages present in the repository."),a.server_updates=c)}}}),yam.model.classEvents.onThreadUpdate}),define("models/page",["require","core/lib/model_helper"],function(a){var b=a("core/lib/model_helper");return b.define("yam.model.Page",function(){})}),define("models/rollup",["require","underscore","models/lib/model/deliverable","models/helpers/message","core/lib/model_helper","core/lib/namespace","models/lib/model/deliverable_static"],function(a){var b=a("underscore"),c=a("models/lib/model/deliverable"),d=a("models/helpers/message"),e=a("core/lib/model_helper"),f=a("core/lib/namespace");return e.define("yam.model.Rollup",[c],function(){var c=a("models/lib/model/deliverable_static");b.extend(this,c),this.prototype.getMessage=function(){return this.message},this.prototype.getHtmlBody=function(){if(!this._htmlBody)if(b.isEmpty(this.message_data))this._htmlBody=d.replaceReferences(this.getMessage());else{var a=this.message_data.key,c=b.omit(this.message_data,"key");this._htmlBody=d.translateFromKey(a,c)}return this._htmlBody},this.prototype.getHtmlHeading=function(){return this._htmlHeading||(this._htmlHeading=d.replaceReferences(this.heading))},this.prototype.getTime=function(){return this._jsTime||(this._jsTime=new Date(this.created_at)),this._jsTime},this.prototype.getFirstUserReference=function(){return d.getFirstUserReference(this.getMessage())},this.prototype.getGroupedObjects=function(){if(this._groupedObjects)return this._groupedObjects;for(var a={},b=0,c=this.objects.length;c>b;b++){var d=this.objects[b],e=a[d.type]||(a[d.type]=[]);e.push(d)}return this._groupedObjects=a,a},this.prototype.getImageUrl=function(){if(this._imageUrl)return this._imageUrl;var a;if(this.image)a=this.image;else{var c=b.detect(this.objects,function(a){return a.mugshot_url});a=c?c.mugshot_url:this.icon}return this._imageUrl=a,a},this.prototype.getHovercard=function(){if(this._hovercard)return this._hovercard;var a={};return this.subject&&(a=this.subject),f.val(this,"meta.fields")&&(a.updated_fields=this.meta.fields),f.val(this,"meta.target")?a.target=this.meta.target:f.val(this,"objects.0")&&(a.target=this.objects[0]),this.created_at&&(a.created_at=this.created_at),"unknown"==f.val(this,"client_type")&&"client"!=f.val(this,"subject.type")||(a.content={icon_url:this.client_large_icon||this.client_icon,url:this.client_url,name:this.client_type,message:this.getHtmlBody(),heading:this.getHtmlHeading()}),this.actions&&this.actions.length&&(a.actions=this.actions),this._hovercard=a}})}),define("models/sender",["require","core/lib/model_helper","models/lib/orm-models"],function(a){var b=a("core/lib/model_helper"),c=a("models/lib/orm-models");return b.define("yam.model.Sender",function(){this.prototype._autoKey=1,this.prototype.getUser=function(){var a=c.User();return"user"===this.type?a.findById(this.type_id):void 0},this.prototype.getGuide=function(){var a=c.Guide();return"guide"===this.type?a.findById(this.type_id):void 0},this.prototype.getMessage=function(){var a=c.Message();return a.findById(this.message_id)},this.prototype.getSnippet=function(){var a=c.Snippet();return a.findById(this.snippet_id)}})}),define("models/shared_message",["require","models/message","core/lib/model_helper","models/lib/model/class_events/on_message_create","models/lib/orm-models","core/lib/session"],function(a){var b=a("models/message"),c=a("core/lib/model_helper"),d=a("models/lib/model/class_events/on_message_create"),e=a("models/lib/orm-models"),f=a("core/lib/session"),g=c.define("yam.model.SharedMessage",b,function(){var a=this.prototype.create;this.prototype.create=function(){var b=a.apply(this,arguments);return b.isSystemMessage()||d.setTextDirection(b),b},this.processReference=function(a){var b=e.Sender();b.save({message_id:a.id,type:a.sender_type,type_id:a.sender_id}),a.is_reference=!0;var c=g.save(a);return c},this.prototype.isForeign=function(){return null!=this.network_id&&this.network_id!=f.getCurrentNetwork().id},this.prototype.getSharedThread=function(){var a=e.SharedThread();return a.findById(this.thread_id)}});return g}),define("models/shared_thread",["require","core/lib/model_helper"],function(a){var b=a("core/lib/model_helper");return b.define("yam.model.SharedThread",function(){})}),define("models/snippet",["require","underscore","core/lib/i18n","core/lib/model_helper","models/lib/orm-models"],function(a){var b=a("underscore"),c=a("core/lib/i18n"),d=a("core/lib/model_helper"),e=a("models/lib/orm-models"),f=d.define("yam.model.Snippet",function(){this.prototype.getPlainBody=function(){return this.snippet_html},this.prototype.findSender=function(){var a=this.getSender();return a.getUser()||a.getGuide()},this.prototype.getTextDirection=function(){return"undefined"==typeof this._textDirection&&(this.language?this._textDirection=c.getTextDirectionByLanguageCode(this.language):this._textDirection=null),
this._textDirection},this.clearByThreadId=function(a){var c=e.Snippet();b(c.find({thread_id:a})).each(function(a){a.destroy()})},this.prototype.getSender=function(){var a=e.Sender();return a.findFirst({snippet_id:this.id})},this.prototype.getThread=function(){var a=e.Thread();return a.findById(this.thread_id)}});return f}),define("models/lib/client/realtime_streams_client",["require","underscore","models/lib/client/base_realtime_client","core/lib/ctor","backbone","core/lib/session","core/lib/uri_helper"],function(a){var b=a("underscore"),c=a("models/lib/client/base_realtime_client"),d=a("core/lib/ctor"),e=a("backbone"),f=a("core/lib/session"),g=a("core/lib/uri_helper");return d(null,c,{THROTTLE_PERIOD:6e4,init:function(a){c.prototype.init.call(this,a),this._delayStart=a.delayStart||0,this._setChannel(this.getUrl()),this._requestedPollInterval=void 0===a.THROTTLE_PERIOD?this.THROTTLE_PERIOD:a.THROTTLE_PERIOD,this._sendRequest=this.sendRequest,this.sendRequest=this._throttledSendRequest()},start:function(){b.delay(c.prototype.start.bind(this),this._delayStart)},getUrl:function(){var a={mark_seen:!0,count:20,inbox_supported_client:!0};this._latestId&&(a.newer_than=this._latestId);var c=this._url;return b.each(a,function(a,b){c=g.replaceParam(c,b,a)}),c},shouldConnectToRealtime:function(){return!b.isUndefined(this._channel)},onProcessFirstRestData:function(a){this._success(a)},onRealtimeData:function(){this.sendRequest()},setLatestId:function(a){this._latestId=a},hasOlderAvailable:function(){return!!this._hasOlderAvailable},getChannels:function(){var a=[["/users",f.getCurrentUser().id,this._channel].join("/")];return a},_throttledSendRequest:function(){return b.throttle(this._sendRequest,this._requestedPollInterval)},_setChannel:function(a){-1!==a.indexOf("streams/activities")?this._channel="activities":-1!==a.indexOf("streams/notifications")?this._channel="current":this._channel=void 0},_success:function(a){a&&(this._hasOlderAvailable=a.meta.older_available,this._requestedPollInterval!==1e3*a.meta.requested_poll_interval&&(this._requestedPollInterval=1e3*a.meta.requested_poll_interval,this.sendRequest=this._throttledSendRequest()))},onDataError:function(a){e.trigger("/message/error",a)}})}),define("models/stream_payload_processor",["require","models/lib/domain_controller","core/lib/ctor"],function(a){var b=a("models/lib/domain_controller"),c=a("core/lib/ctor");return c("yam.model.StreamPayloadProcessor",b,{init:function(a,b){this._currentUser=a,this._feed=b},listen:function(){},process:function(a){this.onStream(a,this._feed)}})}),define("models/stream",["require","underscore","models/lib/client/realtime_streams_client","models/receiver","models/stream_payload_processor","core/lib/model_helper","core/lib/client/payload_helper","core/lib/session","core/lib/uri_helper","backbone"],function(a){var b=a("underscore"),c=a("models/lib/client/realtime_streams_client"),d=a("models/receiver"),e=a("models/stream_payload_processor"),f=a("core/lib/model_helper"),g=a("core/lib/client/payload_helper"),h=a("core/lib/session"),i=a("core/lib/uri_helper"),j=a("backbone");return f.define("yam.model.Stream",[d,j.Events],function(){this.clientize(c,"Stream"),this.prototype._autoKey=1,this.prototype.getRollups=function(){return this.getDeliveryObjectsByType("rollup")},this.prototype.getRollupDeliverys=function(){return this.getDeliverysByType("rollup")},this.prototype.fetchRollups=function(a){return a||(a={}),a.url=this.url,a.processor=g.messagePayloadProcessor,this.fetchPayload(a)},this.prototype._destroy=this.prototype.destroy,this.prototype.destroy=function(){b(this.getDeliverys()).each(function(a){a.destroy()}),this._destroy()},this.prototype.destroyRollups=function(){return this.destroyObjectsByType("rollup")},this.prototype.fetch=function(a){var b=i.parse(this.url);return b.query="",b.queryKey={},a||(a={}),a.url=i.stringify(b),a.processor=g.messagePayloadProcessor,this.fetchPayload(a)},this.prototype.process=function(a){new e(h.getCurrentUser(),this).process(a)},this.prototype.onRemoteDataError=function(){console.error("remote data error occurred: ",arguments)},this.prototype.setLastSeen=function(a){this.getClient()&&this.getClient().setLatestId(a.id)},this.prototype.getOlderUnseenCount=function(){return 0}}),yam.model.Stream}),define("models/tag",["require","core/lib/model_helper"],function(a){var b=a("core/lib/model_helper");return b.define("yam.model.Tag",function(){})}),define("models/unknown",["require","core/lib/model_helper"],function(a){var b=a("core/lib/model_helper"),c=b.define("yam.model.Unknown",function(){this._save=this.save,this.save=function(a){a.lookup_id=a.id+"/"+a.type,this._save(a)}});return c}),define("models/uploaded_file",["require","core/lib/model_helper"],function(a){var b=a("core/lib/model_helper");return b.define("yam.model.UploadedFile",function(){})}),define("models/lib/orm-models",["require","exports","module","models/activity","models/attachment","models/conversation","models/count","models/delivery","models/feed","models/group","collections/groups","models/guide","models/inbox_follow","models/network","models/message","models/lib/model/class_events/on_thread_create","models/lib/model/class_events/on_thread_update","models/page","models/rollup","models/sender","models/shared_message","models/shared_thread","models/snippet","models/stream","models/stream_payload_processor","models/tag","models/thread","models/topic","models/unknown","models/uploaded_file","models/user"],function(a,b){function c(b){var c=d[b];if(!c){switch(b){case"Activity":c=a("models/activity");break;case"Attachment":c=a("models/attachment");break;case"Conversation":c=a("models/conversation");break;case"Count":c=a("models/count");break;case"Delivery":c=a("models/delivery");break;case"Feed":c=a("models/feed");break;case"Group":c=a("models/group");break;case"Groups":c=a("collections/groups");break;case"Guide":c=a("models/guide");break;case"InboxFollow":c=a("models/inbox_follow");break;case"Network":c=a("models/network");break;case"Message":c=a("models/message");break;case"OnThreadCreate":c=a("models/lib/model/class_events/on_thread_create");break;case"OnThreadUpdate":c=a("models/lib/model/class_events/on_thread_update");break;case"Page":c=a("models/page");break;case"Rollup":c=a("models/rollup");break;case"Sender":c=a("models/sender");break;case"SharedMessage":c=a("models/shared_message");break;case"SharedThread":c=a("models/shared_thread");break;case"Snippet":c=a("models/snippet");break;case"Stream":c=a("models/stream");break;case"StreamPayloadProcessor":c=a("models/stream_payload_processor");break;case"Tag":c=a("models/tag");break;case"Thread":c=a("models/thread");break;case"Topic":c=a("models/topic");break;case"Unknown":c=a("models/unknown");break;case"UploadedFile":c=a("models/uploaded_file");break;case"User":c=a("models/user");break;default:throw new Error("Could not find a model for "+b)}d[b]=c}return c}var d={};b.Activity=function(){return c("Activity")},b.Attachment=function(){return c("Attachment")},b.Conversation=function(){return c("Conversation")},b.Count=function(){return c("Count")},b.Delivery=function(){return c("Delivery")},b.Feed=function(){return c("Feed")},b.Group=function(){return c("Group")},b.Groups=function(){return c("Groups")},b.Guide=function(){return c("Guide")},b.InboxFollow=function(){return c("InboxFollow")},b.Network=function(){return c("Network")},b.Message=function(){return c("Message")},b.OnThreadCreate=function(){return c("OnThreadCreate")},b.OnThreadUpdate=function(){return c("OnThreadUpdate")},b.Page=function(){return c("Page")},b.Rollup=function(){return c("Rollup")},b.Sender=function(){return c("Sender")},b.SharedMessage=function(){return c("SharedMessage")},b.SharedThread=function(){return c("SharedThread")},b.Snippet=function(){return c("Snippet")},b.Stream=function(){return c("Stream")},b.StreamPayloadProcessor=function(){return c("StreamPayloadProcessor")},b.Tag=function(){return c("Tag")},b.Thread=function(){return c("Thread")},b.Topic=function(){return c("Topic")},b.Unknown=function(){return c("Unknown")},b.UploadedFile=function(){return c("UploadedFile")},b.User=function(){return c("User")}}),define("common-ui/lib/ui/accessibility/screenreader_announcer",["require","jquery","underscore","core/lib/log"],function(a){"use strict";var b,c=a("jquery"),d=a("underscore"),e=a("core/lib/log");return{announceText:function(a,f){d.defer(function(){var d;return d=c("polite"===f?"#yj-screenreader-announcer-polite":"#yj-screenreader-announcer-assertive"),0===d.length?void e.log("ScreenreaderAnnouncer could not find its element; cannot announce text: "+a):(b&&(window.clearTimeout(b),b=null),d.empty().append(c("<div />").text(a)),void(b=window.setTimeout(function(){d.find("div").attr("aria-hidden","true")},500)))})}}}),define("feeds/lib/ui/util/title_updater",["require","underscore","models/lib/orm-models","core/lib/session","core/lib/tr","common-ui/lib/ui/accessibility/screenreader_announcer"],function(a){var b=a("underscore"),c=a("models/lib/orm-models"),d=a("core/lib/session"),e=a("core/lib/tr"),f=a("common-ui/lib/ui/accessibility/screenreader_announcer");return{_titleRe:/^\((\d*)\).*/,_flashMessage:null,_flashTimeout:null,_flashCycles:5,_flashCycleInterval:1e3,_flashReps:2,_flashRepInterval:3e5,_flashLock:!1,init:function(){this._title=document.title,c.Count().getCounter("currentNetwork",this._renderTitle.bind(this))},setTitle:function(a,c){this._shortTitle=a;var g=d.getCurrentNetwork();this._title=b.compact(["Yammer",g&&g.community?g.name:void 0,a]).join(" : "),this._renderTitle(),c&&c.announce&&f.announceText(e.t("navigated_to",{title:document.title}))},hasTitle:function(){return!!this._shortTitle},_renderTitle:function(){var a=c.Count().getCounter("currentNetwork").getCount();document.title=(a>0?"("+a+") ":"")+this._title},flashChat:function(){this._flashLock||(this.clearFlash(),this._flashMessage||(this._flashMessage=e.t("new_message_2")),this._doFlash())},clearFlash:function(){this._flashTimeout&&(clearTimeout(this._flashTimeout),this._flashTimeout=null),this._renderTitle()},_doFlash:function(){var a,b=this,c={cycles:0,reps:0};this._flashLock=!0,(a=function(c){var d=b._flashCycleInterval;if(document.title==b._flashMessage?b._renderTitle():document.title=b._flashMessage,c.cycles++,c.cycles==b._flashCycles){if(c.reps++,c.reps==b._flashReps)return;c.cycles=1,d=b._flashRepInterval,b._flashLock=!1}b._flashTimeout=setTimeout(function(){a(c)},d)})(c)}}}),define("workfeed/lib/app/idleness_check",["require","jquery","underscore","core/lib/log","core/lib/namespace","backbone","common-ui/lib/helper/environment"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/log"),e=a("core/lib/namespace"),f=a("backbone"),g=a("common-ui/lib/helper/environment");return e.ns("yam.workfeed"),yam.workfeed.idlenessCheck=new function(){var a=1e3,e=3e5,h=null,i=null;this.init=function(){var d=["keydown.idle","click.idle"];g.isIE()&&8===g.isIE().version||d.push("mousemove.idle"),d=d.join(" "),this.setHandler=c.debounce(this.setLastActivityTime.bind(this),a),this.checkHandler=c.debounce(this.checkLastActivityTime.bind(this),a,!0),b(document.body).on(d,this.setHandler),b(document.body).on(d,this.checkHandler),this.setLastActivityTime()},this.checkLastActivityTime=function(){Date.now()-h>e&&(d.log("/app/idle/ended"),f.trigger("/app/idle/ended"))},this.getLastActivityTime=function(){return h},this.setLastActivityTime=function(){h=Date.now(),this.resetTimeout()},this.resetTimeout=function(){i&&clearTimeout(i),i=setTimeout(function(){clearTimeout(i),d.log("/app/idle/started"),f.trigger("/app/idle/started")},e)}}}),define("models/lib/backbone_orm_adapter",["require","underscore","collections/groups","collections/group_memberships","collections/likes","core/lib/namespace","core/lib/string_helper","models/lib/orm-models"],function(a){"use strict";var b=a("underscore"),c=a("collections/groups"),d=a("collections/group_memberships"),e=a("collections/likes"),f=a("core/lib/namespace"),g=a("core/lib/string_helper");a("models/lib/orm-models");var h=function(a){return b.indexOf(a,".")<0&&(a="yam.model."+g.camelize(a,!0)),j.hasOwnProperty(a)?j[a]:void 0},i=function(a){return b.indexOf(a,".")<0&&(a="yam.model."+g.camelize(a,!0)),j.hasOwnProperty(a)};f.ns("yam.backbone"),yam.backbone.isBackboneModel=i,yam.backbone.getBackboneCollectionInstance=h;var j=b.extend({"yam.model.Like":e,"yam.model.Group":c,"yam.model.GroupMembership":d})}),define("models/lib/all",["require","models/lib/backbone_orm_adapter"],function(a){a("models/lib/backbone_orm_adapter")}),define("workfeed/lib/app/bundles/model_bundle",["require","models/lib/client/presence_client","core/lib/session","feeds/lib/ui/util/title_updater","workfeed/lib/app/idleness_check","models/lib/all"],function(a){"use strict";var b=a("models/lib/client/presence_client"),c=a("core/lib/session"),d=a("feeds/lib/ui/util/title_updater");return a("workfeed/lib/app/idleness_check"),a("models/lib/all"),{run:function(a,b,d){c.setCurrentNetwork(b),c.setAllNetworks(d),this.initUser(a)},initUser:function(a){a.groupsMap={};for(var e=0,f=a.group_memberships.length;f>e;e++)a.groupsMap[a.group_memberships[e].id.toString()]=a.group_memberships[e];var g=c.setCurrentUser(a),h=new b({url:g.get("url")});h.start(),d.init(),yam.workfeed.idlenessCheck.init()}}}),/*
* Copyright (c) John Resig

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/
define("resig-class",[],function(){function a(){}var b=!1,c=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;return a.extend=function(a){function d(){!b&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;b=!0;var f=new this;b=!1;for(var g in a)f[g]="function"==typeof a[g]&&"function"==typeof e[g]&&c.test(a[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,a[g]):a[g];return d.prototype=f,d.constructor=d,d.extend=arguments.callee,d},a}),define("core/lib/jam/component",["require","underscore","jquery","backbone","resig-class","core/lib/namespace","core/lib/report","core/lib/string_helper","core/lib/treatment","mustache"],function(a){var b=a("underscore"),c=a("jquery"),d=a("backbone"),e=a("resig-class"),f=a("core/lib/namespace"),g=a("core/lib/report"),h=a("core/lib/string_helper"),i=a("core/lib/treatment"),j=a("mustache"),k=function(a){a.getId=function(){return this.id||this.cid},a.destroy=a.remove};f.ns("yam.jam.registry");var l=e.extend({init:function(a,d){c.extend(!0,this,this.defaults,a),yam.jam.registry[this.getId()]=this,this.children=[],this.childMap={},this.rendered=!1,this.destroyed=!1,this.beforeInit(),this.setParent(d),this.initComponents(a.children),this.observeEvents(),this.subscribeToData(),"function"==typeof this.afterInit&&b.defer(b.bind(function(){this.afterInit()},this))},beforeInit:function(){},getId:function(){var a;if(this.id)a=this.id;else{if(!(this.settings&&this.settings.idPrefix&&this.data&&this.data.id))throw new Error("Component - Unable to create ID for "+this.type);a=this.settings.idPrefix+this.data.id}return a=this.getUniqueId(a),this.getId=function(){return a},a},getUniqueId:function(a,b){b=b||0;var c=0===b?"":b,d=a.toString()+c.toString();return yam.jam.registry[d]?this.getUniqueId(a,++b):d},getDomId:function(){return h.snakeize(this.getId().toString(),"-")},defaults:null,template:void 0,setParent:function(a){a&&(this.parent=a,this.view=a.view)},registerChild:function(a){if(a instanceof d.View&&k(a),!this.destroyed&&this.children){var b=this.children;"function"==typeof b.push&&b.push(a),this.childMap[a.getId()]=a}else a.destroy()},removeChild:function(a){for(var b=a.getId(),c=this.children,d=0,e=c.length;e>d;d++)if(c[d]===a){this.children.splice(d,1),delete this.childMap[b],a.parent=null;break}},removeChildren:function(){b.invoke(this.children,function(){b.isFunction(this.destroy)&&this.destroy()}),this.children=[],this.childMap={}},initComponents:function(a){var c=a;if(c){"function"==typeof c&&(c=c.apply(this,[]));for(var d=0,e=c.length;e>d;d++){var f=i.treatment(c[d].abtest)==c[d].abside;b.isArray(c[d].abside)&&(f=b.indexOf(c[d].abside,i.treatment(c[d].abtest))>-1),c[d].abtest&&!f||this.initComponent(c[d])}}},initComponent:function(a){var b,c,e;if(e=a.type,"string"==typeof ctor){if(c=f.ns(e),"function"!=typeof c)throw new Error('Jam-component type "'+e+'" is not a constructor.');e=c}try{this.mediator&&(a.mediator=this.mediator),b=new e(a,this),b instanceof d.View&&a.target&&!b.target&&(b.target=a.target),this.registerChild(b)}catch(b){console.log("initComponent error: ",b),console.log("type: ",a),g.error({message:b.message},b)}},addChild:function(a,b){b&&(a.target=b),a instanceof d.View||a.setParent(this),this.registerChild(a)},addComponent:function(){return this.addChild.apply(this,arguments)},getChild:function(a){return this.childMap[a]},getChildByType:function(a){var b,c=new RegExp(h.escapeRegExp(a));if(this.children)for(var d=0,e=this.children.length;e>d;d++)if(b=this.children[d],c.test(b.getId()))return b},getComponent:function(){return this.getChild.apply(this,arguments)},prepViewData:function(a){return a},createElement:function(){if(!this.template||!this.data)throw new Error("Component - Create element not implemented for: "+this.id);var a=this.prepViewData(this.data);this.$element=c(c.trim(j.render(this.template,a)))},_removeComponent2ParentRef:function(){var a=this.__parent;a&&(delete a[this.__key],"function"==typeof a.getChildren&&(a.__children=b(a.getChildren()).without(this)))},destroy:function(){this.clearTimers(),this.removeChildren(),this.destroyElement(),this._removeFromRegistry(),this._removeComponent2ParentRef(),this.unsubscribeData(),this.destroyed=!0},remove:function(){this.destroy()},_removeFromRegistry:function(){delete yam.jam.registry[this.getId()]},destroyElement:function(){this.$element&&this.$element.empty().remove()},observeEvents:function(){},subscribeToData:function(){},unsubscribeData:function(){},clearTimers:function(){},observeDomEvents:function(){},delegateEvents:function(){},on:function(){},off:function(){},render:function(a){return this.destroyElement(),this.createElement(),this.$el=this.$element,this.$el&&(this.el=this.$el.get(0)),this.isDelegator&&this.delegator(),this.renderChildren(this.children),this.rendered=!0,this.afterRender(),this.observeDomEvents(),a&&this.$element.hide(),this.$element&&this.$element.addClass("yj-component"),this.subscriptions&&this.subscribe(this.subscriptions()),this.$element},renderChildren:function(a){var b,d,e,f,g;if(a&&a.length)for(var h=0,i=a.length;i>h;h++)b=a[h],b.manuallyRender||(e=b.target,f=e?"string"==typeof e?this.$element.find(e+":first"):c(e):this.$element,d=!!b.renderHidden,g=b.render(d),null==g||g instanceof c||(g=g.$el),b.prependToTarget?f.prepend(g):b.afterTarget?f.after(g):b.replaceTarget?f.replaceWith(g):f.append(g))},renderChild:function(a){this.renderChildren([this.childMap[a]])},afterRender:function(){},show:function(){this.$element&&this.$element.show()},hide:function(){this.$element&&this.$element.hide()},isVisible:function(){return this.$element.is(":visible")},callOnChildren:function(a){var b,c=Array.prototype.slice.call(arguments,1);if(this.children&&this.children.length)for(var d=0,e=this.children.length;e>d;d++)b=this.children[d],"function"==typeof b[a]&&b[a].apply(b,c)},delegator:function(){var a=this;c(a.$element).addClass("yj-delegator")},subscribe:function(a){var b=this;setTimeout(function(){if(!b.doneDelegation){var d=b.$element.closest(".yj-delegator");d=d.is("*")?d:c("body"),c.each(a,function(){var a=this[2];d.delegate(this[0],this[1],function(c){b.$element.has(this).is("*")&&a.apply(b,[c])})}),b.doneDelegation=!0}},10)}});return l}),define("core/lib/jam/component2",["require","jquery","underscore","backbone","mustache","core/lib/ctor","core/lib/log","core/lib/namespace","core/lib/string_helper"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("mustache"),f=a("core/lib/ctor"),g=a("core/lib/log"),h=a("core/lib/namespace"),i=a("core/lib/string_helper"),j=function(a){a.getId=function(){return this.id||this.cid},a.destroy=a.remove};return h.ns("yam.jam.registry"),f("yam.jam.Component2",{init:function(a,d){var e=a||{};this.__children=[],this.__rendered=!1,this.__attached=!1,this.__domDelegations={},this.__delegator=null,this.__timeouts=[],this.__intervals=[],this.enabled=!0,this.shown=!0,b.extend(this,e,!0);var f=this.id||this.declaredClass;this.__id=yam.jam.registry[f]?c.uniqueId(f):f,delete this.id,yam.jam.registry[this.getId()]=this;var g,i,j;for(g in this)j=this[g],j&&j.type&&!j.isComponent&&(j.id=j.id?j.id:g,i="string"==typeof j.type?"yam"==j.type.slice(0,3)?h.val(window,j.type):null:j.type,i&&(this.mediator&&(j.mediator=this.mediator),this[g]=this.__registerChild(g,new i(j))));d&&this.setParent(d),this.onLoad()},setParent:function(a){this.__isLegacyParent=!(a instanceof yam.jam.Component2),this.__parent=a},getId:function(){return this.__id},onLoad:function(){},render:function(a){if(this.__rendered&&!a)return this.$el;var b,c;if(this.createElement(),this.$=this.$el.find.bind(this.$el),this.$el||this.fail("createElement must create $el property which is a jQuery wrapped DOM node"),this.$element=this.$el,this.el=this.$el[0],this.getChildren().forEach(function(a){a.autoRender!==!1&&this.__attachChild(a)},this),this.el.id="yj-"+this.getId(),this.$el.addClass("yj-component "+this.__getDomNs()),this.cssClass&&this.$el.addClass(this.cssClass),b=this._listeners)for(var d in b){c=b[d];for(var e=0,f=c.length;f>e;e++)this.addListener(d,c[e])}return delete this._listeners,this.__rendered=!0,this.onRendered(),this.__isLegacyParent&&this.attach(),this.$el},__attachChild:function(a){var c=a.attachPoint,d=a.attachMethod||"append",e=a.render();null==e||e instanceof b||(e=e.$el),c?("string"==typeof c&&(c=this.$(c)),c[d](e)):this.$el[d](e)},createElement:function(){var a,d=h.val(window,this.declaredClass+".prototype.template"),f=h.val(window,this.declaredClass+".template"),g=d||this.template||f,i={template:g,model:c.clone(c.isObject(this.model)?this.model:{})};this.onTemplating&&"function"==typeof this.onTemplating&&(i=this.onTemplating(i)),g=i.template,a=i.model;var j;g&&c.isFunction(g)?this.$el=b(b.trim(g(a))):g?this.$el=b(b.trim(e.render(g,a))):(j="<"+(this.tag||"div")+"/>",this.$el=b(j,b.extend({},this.attrs,{text:this.text,class:this.cssClass}))),this.$element=this.$el,this.el=this.$el[0]},onRendered:function(){},attach:function(){this.__attached||this.__rendered&&(this.__bindEvents(),this.__attached=!0,this.onAttach(),this.getChildren().forEach(function(a){a.attach&&a.attach()}))},attachTo:function(a,c){a=b(a),c=c||"appendTo",this.render(!0),this.$el[c](a),this.attach()},onAttach:function(){},getChildren:function(){return this.__children},getChildById:function(a){return c(this.getChildren()).find(function(b){return b.getId()==a})},getChildrenByType:function(a){return c(this.getChildren()).select(function(b){return b.declaredClass==a})},add:function(a,b,c){"string"!=typeof a&&this.fail("component.add requires a key as its first argument");try{b.isComponent()||this.fail("component.add requires a component instance as its second argument")}catch(a){}return this.__registerChild(a,b,c),this.__rendered&&(this.__attachChild(b),this.__attached&&b.attach&&b.attach()),b},addTo:function(a,b){return this.add(a,b,!0)},replace:function(a,b){var c=a.__key,e=a instanceof d.View,f=a.$el;b.attachPoint=f,b.attachMethod="replaceWith",e||(a.preserveDom=!0,a.$el.hide(),a.destroy()),this.add(c,b),e?a.remove():f.empty().remove()},remove:function(a){return"undefined"==typeof a?void(this.destroy&&this.destroy()):("string"==typeof a&&(a=this[a]),void(a.isComponent()&&a.destroy()))},__removeParentRef:function(){var a=this.__parent;a&&(delete a[this.__key],"function"==typeof a.getChildren&&(a.__children=c(a.getChildren()).without(this)))},destroy:function(){this.onDestroy(),delete yam.jam.registry[this.getId()],this.preserveDom||this.$el&&this.$el.empty().remove(),this.__removeParentRef(),this.getChildren().forEach(function(a){"function"==typeof a.destroy&&a.destroy()}),this.__delegator&&this.__delegator.__undelegate(this.__getDomNs());for(var a=0,b=this.__timeouts.length;b>a;a++)clearTimeout(this.__timeouts[a]);for(a=0,b=this.__intervals.length;b>a;a++)clearInterval(this.__intervals[a]);for(var c in this)this[c]=null;this.remove=function(){},this.off=function(){}},onDestroy:function(){},addListener:function(a,b){var c;this.$el?(this._noPropagation=this._noPropagation||{},c=a+this.__getEvtNs(),this._noPropagation[a]||this.$el.bind(c,function(a){a.stopPropagation()}),this._noPropagation[a]=!0,this.$el.bind(c,b)):(this._listeners=this._listeners||{},this._listeners[a]=this._listeners[a]||[],this._listeners[a].push(b))},on:function(){return this.addListener.apply(this,arguments)},removeListener:function(a,b){var c,d,e,f;if(this.$el)f=a+this.__getEvtNs(),this.$el.unbind(f,b);else if(c=this._listeners&&this._listeners[a]){e=[];for(var g=0,h=c.length;h>g;g++)d=c[g],d!=b&&e.push(d);e.length?this._listeners[a]=e:delete this._listeners[a]}},trigger:function(){var a=c.toArray(arguments);if(a[0]=a[0]+this.__getEvtNs(),!this.$el)throw new Error("Component must be rendered to trigger events");this.$el.trigger.apply(this.$el,a)},setTimeout:function(a,b){var c=setTimeout(a,b);return this.__timeouts.push(c),c},setInterval:function(a,b){var c=setInterval(a,b);return this.__intervals.push(c),c},log:function(){var a=Array.prototype.slice.apply(arguments);a=[this.declaredClass+": "].concat(a),g.log.apply(null,a)},fail:function(a){throw new Error(a)},isComponent:function(){return!0},disableChildren:function(){this.getChildren().forEach(function(a){"function"==typeof a.disable&&a.disable()})},enableChildren:function(){this.getChildren().forEach(function(a){"function"==typeof a.enable&&a.enable()})},disableSelf:function(){this.enabled=!1},enableSelf:function(){this.enabled=!0},disable:function(){this.disableChildren(),this.disableSelf()},enable:function(){this.enableChildren(),this.enableSelf()},hide:function(){this.$el&&(this.$el.hide(),this.shown=!1)},show:function(){this.$el&&(this.$el.show(),this.shown=!0)},__registerChild:function(a,b,e){return b instanceof d.View?(j(b),b.__key=a):(b.__parent=b.parent=this,b.__key=a),this.__children.push(b),e&&!c.isArray(this[a])&&(this[a]=this[a]?[this[a]]:[]),e?this[a].push(b):this[a]=b,b},delegateEvents:function(){this.attach()},__bindEvents:function(){if(this.events){var a,b=this.__delegator=this.__findDelegator(this);b?(this.log("delegating to ",b.declaredClass),b.__delegate(this)):c(this.events).each(function(b,c){b="function"==typeof b?b:this[b],b=b.bind(this),a=this.__parseEventKey(c),a.selector?this.$el.on(a.type,a.selector,b):this.$el.on(a.type,b)},this)}},__parseEventKey:function(a){var b=a.indexOf(" ");return b>-1?{type:a.substring(0,b),selector:a.substring(b,a.length)}:{type:a}},__delegate:function(a){var d,e,f=a.__getDomNs(),g=this.__domDelegations[f],h=this;g=b.extend({count:0,evts:{}},g),g.count++,1===g.count&&(e="."+f+" ",c(a.events).each(function(c,i){c="function"==typeof c?c:a[c],d=this.__parseEventKey(i),g.evts[d.type]=!0,d.selector=d.selector?e+d.selector:e,this.$el.on(d.type+"."+f,d.selector,null,function(a){var d=b(a.target).closest(".yj-component"),e=d[0].id.replace("yj-",""),f=h.__findDescendant(e);a.stopImmediatePropagation(),c.call(f,a)})},this)),this.__domDelegations[f]=g},__undelegate:function(a){var b=this.__domDelegations[a];b.count--,0===b.count&&c(b.evts).each(function(c,d){this.$el.off(d+"."+a),delete b[d]},this)},__findDelegator:function(a){var b=a.__parent;return a.delegates?a:b&&b.isComponent?this.__findDelegator(a.__parent):void 0},__findDescendant:function(a){if(this.getId()==a)return this;var b;return this.getChildren().forEach(function(c){b=b||c.__findDescendant(a)}),b},__getSanitized:function(a){var b=a.replace(/\./g,"-");return b=i.snakeize(b,"-"),b=b.replace(/--/g,"-")},__getDomNs:function(){var a;return this.__domNs?this.__domNs:(a=this.__getSanitized(this.declaredClass),this.__domNs=a,a)},__getEvtNs:function(){var a;return this.__evtNs?this.__evtNs:(a=this.__getSanitized(this.__id),a="."+a,this.__evtNs=a,a)}})}),define("common-ui/lib/helper/selection",["require","jquery","underscore","core/lib/string_helper"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/string_helper"),e=function(a,c){return 3==b(a)[0].nodeType?c(a):void b(a).contents().each(function(){3==this.nodeType?c(this):1==this.nodeType&&e(this,c)})},f=function(){return!!document.createRange},g=function(){switch(arguments.length){case 1:this._initRaw(arguments[0]);break;case 3:this._initFromIndices.apply(this,arguments);break;default:throw"wrong arguments for new Range"}};g.prototype._initFromIndices=function(a,c,d){var g=b(a),h=g.text(),i=this,j=!1,k=!1;if(h.length<d)throw"Range end exceeds element length:"+d+" > "+h.length;if(h.length<c)throw"Range start exceeds element length: "+c+" > "+h.length;if(f()){this.raw=document.createRange();var l,m=0;e(a,function(a){var b=a.nodeValue.length;m+b>c&&!j&&(i.raw.setStart(a,c-m),j=!0),m+b>=d&&!k&&(i.raw.setEnd(a,d-m),k=!0),l=a,m+=b}),l&&!k&&i.raw.setEnd(l,d),c==d&&i.raw.collapse(!1)}else if(document.selection&&document.selection.createRange){this.raw=document.selection.createRange().duplicate(),this.raw.moveToElementText(a),this.raw.collapse(!0);for(var n=this.raw.moveEnd("character",d);this.raw.text.length!=n;)this.raw.moveEnd("character",n-this.raw.text.length);for(var o=this.raw.moveStart("character",c);this.raw.text.length!=d-o;)this.raw.moveStart("character",this.raw.text.length-(n-o))}},g.prototype._initRaw=function(a){this.raw=a},g.prototype.toString=function(){return document.createRange?this.raw.toString():this.raw.text},g.prototype.wrap=function(a){if(f())this.raw.surroundContents(b(a)[0]);else if(document.selection){var c=b(a).append(this.raw.htmlText+"");this.raw.pasteHTML(c[0].outerHTML)}},g.prototype.inside=function(a){var c=this.raw.commonAncestorContainer;return b(c).parents().is(a)},g.prototype.select=function(){if(window.getSelection&&f()){var a=window.getSelection();a.removeAllRanges(),a.addRange(this.raw)}else document.selection&&document.body.createTextRange&&this.raw.select();return this},g.prototype.insert=function(a){if(f()){var c="string"==typeof a?document.createTextNode(a):b(a)[0];this.raw.insertNode(c)}},g.prototype.deleteContents=function(){f()&&(this.raw.collapsed||this.raw.deleteContents())},g.prototype.replaceContents=function(a){this.deleteContents(),this.insert(a)};var h=function(a,b){if(a=a.length?a[0]:a,a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}},i=function(a){var c=a instanceof jQuery?a:b(a);if(document.selection){var d=c.val().length+1;if(c[0].createTextRange)for(var e=document.selection.createRange().duplicate();e.parentElement()==c[0]&&1==e.move("character",1);)--d;return d==c.val().length+1?-1:d}var f=c.is(":visible")?c[0].selectionStart:0;return f},j=function(a){a=a instanceof jQuery?a[0]:a;var c;if(window.getSelection&&window.getSelection().getRangeAt){var d=window.getSelection().getRangeAt(0).cloneRange();d.setEnd(d.startContainer,d.startOffset);var e=d.startContainer;return e=3==e.nodeType?e.parentNode:e,d.setStart(b(e).parents().add(e).filter('[contenteditable="true"], [contenteditable="plaintext-only"]')[0].firstChild,0),c=d.cloneContents(),c.textContent.length}throw"Aaaaargh, not in a known browser. CaretPos not implemented"},k=function(a,b){if(1==a.nodeType){if(a.hasChildNodes())for(var c=a.childNodes,d=0;d<c.length;d++)k(c[d],b)}else 3==a.nodeType&&b(a)},l=function(a,b){var c;if(window.getSelection&&window.getSelection().getRangeAt){var d=!1;if(k(a,function(a){d||(b<=a.data.length?(c=document.createRange(),c.setStart(a,b),c.setEnd(a,b),window.getSelection().removeAllRanges(),window.getSelection().addRange(c),d=!0):b-=a.data.length)}),!d)throw"yam.selection index error - not called"}},m={};return m.caretPos=function(a,c){if(0===arguments.length&&document.activeElement&&(a=document.activeElement),a instanceof b&&(a=a[0]),!a||!a.nodeName)return-1;var d="input"===a.nodeName.toLowerCase()||"textarea"===a.nodeName.toLowerCase();try{return null!=c?d?h(a,c):l(a,c):d?i(a):j(a)}catch(a){return-1}},m.caretCoords=function(a){var c=m.caretPos(a);if(!(1>c)){b(".yj-ghost").remove();var d=b("<span class='yj-ghost'>I</span>"),e=new g(a,c,c);e.replaceContents(d);var f=b(".yj-ghost"),h=f.offset();return h.height=f.height(),f.remove(),h}},m.replaceRange=function(a,b){if(window.getSelection&&window.getSelection().getRangeAt){var c=a.createContextualFragment(b);a.deleteContents(),a.insertNode(c)}},m.moveCursorToEnd=function(a){var b;window.getSelection&&window.getSelection().getRangeAt&&(b=document.createRange(),b.selectNodeContents(a),b.collapse(!1),window.getSelection().removeAllRanges(),window.getSelection().addRange(b))},m.underlineTerm=function(a,e,f){if(a.find(".yj-underline").each(function(){b(this).replaceWith(b(this).text())}),e){var g=d._synonymsList,h=new RegExp("("+c.flatten(g).join("|")+")","ig"),i=d.escapeRegExp(e).replace(h,function(a){a=a.toLowerCase();var b=c(g).find(function(b){return c(b).contains(a)});return"("+b.join("|")+")"}),j=new RegExp("(^|\\s)"+i,"ig");a.find(f||"span").each(function(){var a=b(this),d=a.text(),f=d.search(j);f>-1&&(" "===d.charAt(f)&&f++,a.html(""+c.escape(d.slice(0,f))+"<span class='yj-underline'>"+c.escape(d.slice(f,f+e.length))+"</span>"+c.escape(d.slice(f+e.length))))})}},m}),define("common-ui/lib/helper/ui",["require","jquery","underscore","./selection","core/lib/tr","core/lib/report"],function(a){var b=a("jquery"),c=a("underscore"),d=a("./selection"),e=a("core/lib/tr"),f=a("core/lib/report"),g={image:{}};return g.scrollTop=function(a,c){b("html, body").animate({scrollTop:c||0},a)},g.setCaretPosition=function(a,b){return d.caretPos(a,b)},g.getCaretPosition=function(a){return d.caretPos(a)},g.shiftCount=function(a,c){var d=25,e="",f=d.toString()+"+";0!==b(a).length&&b(a).text()!=f&&(e=parseInt(b(a).text(),10)+c,e>d?b(a).text(f):b(a).text(e))},g.toggleSection=function(a){var c=a.data("static-content"),d=a.attr("data-more-text")||e.t("more"),g=a.attr("data-less-text")||e.t("less"),h=a.data("arrow-direction"),i=g,j=b("#"+a.attr("data-toggle-section")),k=a.find(".yj-arrow"),l="yj-down-arrow",m="yj-up-arrow",n="shown",o=" &#9650;",p=" &#9660;",q=o,r="slideDown",s=!0;if(j.is(":visible")&&(l="yj-up-arrow",m="yj-down-arrow",q=p,n="hidden",r="slideUp",i=d,s=!1),"up"===h){var t=l;l=m,m=t}j[r](a.trigger.bind(a,n)),"slideDown"==r&&a.data("qaid")&&f.event("ui_toggle_selection",{toggler:a.data("qaid"),toggler_id:a[0].id,page_title:document.title}),k.length&&k.removeClass(l).addClass(m).html(q),c||(a.text(i),k.length&&k.appendTo(a)),a.attr("aria-expanded",s)},g.setSelectedTabForFeed=function(a,c){b("li.yj-filter-tab").removeClass("yj-selected"),b("li.yj-tab-dropdown-item").removeClass("yj-selected"),a?b("li[data-app-id='"+a+"']").addClass("yj-selected"):c&&b("li[data-from-user-type='"+c+"']").addClass("yj-selected"),b(".yj-action-bar-tabs .yj-selected").length||b(".yj-action-bar-with-tabs li:first").addClass("yj-selected")},g.getOrientation=function(){var a=window.orientation;return void 0===a?void 0:90===a||-90===a?"landscape":"portrait"},g.isTextSelected=function(){var a=!1,b=window.getSelection();return a=b.focusOffset-b.anchorOffset!==0},g.getTextWidth=c.memoize(function(a){var c,d=b("<span/>",{text:a,css:{position:"absolute",visibility:"hidden"}}).appendTo(b("body"));return c=d.width()+25,d.remove(),c}),g.image.crop=function(a,c){if(!(a instanceof b))throw new Error("Please pass a jQuery object for the $img parameter");if("number"!=typeof c.w||"number"!=typeof c.h)throw new Error("uiHelper::crop: both dimensions must be numbers");var d=0,e=0,f=a.width(),g=0,h=0,i=a.height();a.width()>c.w&&(d=Math.abs(c.w-a.width()),e=d/2,f=e+c.w),a.height()>c.h&&(g=Math.abs(c.h-a.height()),h=g/2,i=h+c.h);var j="rect("+h+"px,"+f+"px,"+i+"px,"+e+"px)";return a.css("position","absolute").css("left",-e).css("top",-h).css("clip",j),{$img:a,clipRectMarginX:d,clipRectMarginY:g,leftClip:e,rightClip:f,topClip:h,bottomClip:i,clipRectangle:j}},g.batchClassToggle=function(a,b){var d=[],e=[];c.each(b,function(a,b){a?d.push(b):e.push(b)}),d.length&&a.addClass(d.join(" ")),e.length&&a.removeClass(e.join(" "))},g.buildParticipantList=function(a){if(a.participants){var c={visible:3,threshold:4},d=b.extend({},c,a),f=d.participants.length,g="",h=[],i=[];return f>d.threshold?(h=d.participants.slice(0,d.visible),i=d.participants.slice(d.visible),g=e.t("count_others",{count:d.participants.length-d.visible})):h=d.participants,{visibleParticipants:h,hiddenParticipants:i,othersText:g}}},g.getScrollerWidth=function(){var a=null,b=null,c=0,d=0;return a=document.createElement("div"),a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.style.width="100px",a.style.height="50px",a.style.overflow="hidden",b=document.createElement("div"),b.style.width="100%",b.style.height="200px",a.appendChild(b),document.body.appendChild(a),c=b.offsetWidth,a.style.overflow="auto",d=b.offsetWidth,document.body.removeChild(document.body.lastChild),parseInt(c-d,10)},g.enableButton=function(a){a.removeClass("yj-btn-disabled").prop("disabled",!1)},g.disableButton=function(a){a.addClass("yj-btn-disabled").prop("disabled",!0)},g.forceBrowserRepaint=function(){var a=document.body;a.style.display="inline-block",a.offsetHeight,a.style.display="block"},g}),define("common-ui/lib/ui/accessibility/traversal_util",["require","jquery"],function(a){var b=a("jquery"),c=function(){"firstElementChild"in document.body&&(d=function(a){return a.firstElementChild},e=function(a){return a.lastElementChild},f=function(a){return a.nextElementSibling},g=function(a){return a.previousElementSibling})},d=function(a){return c(),d(a)},e=function(a){return c(),e(a)},f=function(a){return c(),f(a)},g=function(a){return c(),g(a)},h=function(a,b){if(null==a)return b;var c=a;if(d(c))return d(c);for(;c&&c!=b;c=c.parentNode)if(f(c))return f(c);return null},i=function(a,b){var c=a;if(c==b)return null;if(!c||g(c))for(c=c?g(c):b;e(c);)c=e(c);else c=c.parentNode;return c},j=function(a,b,c){for(var d=h(a,b);d;){if(c(d))return d;d=h(d,b)}return null},k=function(a,b,c){for(var d=i(a,b);d;){if(c(d))return d;d=i(d,b)}return null},l=function(a){if(0===b(a).filter(":visible").length)return!1;for(var c=a;c&&c!=document.body;){var d=b(c).css("visibility");if("visible"!=d&&"inherit"!=d)return!1;c=c.parentNode}return!0},m=function(a){if(!l(a))return!1;var b=a.getAttribute("tabIndex");return null!=b?b>=0:"A"===a.tagName||"AREA"===a.tagName?a.href:"INPUT"===a.tagName||"TEXTAREA"===a.tagName||"SELECT"===a.tagName||"BUTTON"===a.tagName?!a.disabled:"IFRAME"===a.tagName||"OBJECT"===a.tagName||"EMBED"===a.tagName?!0:"true"===a.contentEditable},n=function(a,b){return j(a,b?b:document.body,m)},o=function(a,b){return k(a,b?b:document.body,m)},p=function(a){return j(null,a,m)},q=function(a){return k(null,a,m)},r=function(a,b){var c=j(null,a,m);c?c.focus():b&&(b.tabIndex=-1,b.focus())},s=function(a,b){var c=k(null,a,m);c?c.focus():b&&(b.tabIndex=-1,b.focus())};return{stepToNextElement:h,stepToPreviousElement:i,findNextElementThat:j,findPreviousElementThat:k,isVisible:l,isTabbable:m,findNextTabbable:n,findPreviousTabbable:o,findFirstTabbableWithin:p,findLastTabbableWithin:q,focusFirstTabbableWithin:r,focusLastTabbableWithin:s}}),define("common-ui/lib/ui/accessibility/accessibility_util",["require","jquery","underscore","backbone","core/lib/tr","core/lib/treatment","common-ui/lib/ui/accessibility/screenreader_announcer","./traversal_util","feeds/lib/ui/util/title_updater"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/tr"),f=a("core/lib/treatment"),g=a("common-ui/lib/ui/accessibility/screenreader_announcer"),h=a("./traversal_util"),i=a("feeds/lib/ui/util/title_updater"),j={},k=0;j.getOrAssignElementId=function(a){var b=a.id;return b?b:(b="e"+k++,a.id=b,b)},j.extractTextExcluding=function(a,d){var e=[];return c.each(a.childNodes,function(a){3===a.nodeType?e.push(a.data):1===a.nodeType&&(b(a).is(d)||e.push(j.extractTextExcluding(a,d)))}),e.join(" ")},j.adjustAccessibilityHeadingLevels=function(a,d){c.each(b(a).find("h1,h2,h3,h4,h5,h6"),function(a){var c=+a.tagName.charAt(1),e=Math.min(Math.max(c+d,0),6);b(a).attr({role:"heading","aria-level":e})})},d.on("routeChange",function(){var a;a=i.hasTitle()?e.t("navigated_to",{title:document.title}):e.t("navigating"),g.announceText(a)}),b(document.body).on("keypress","a[role=button]",function(a){return f.treatment("keyboardshortcuts2")&&32===a.which?(b(a.target).click(),!1):void 0});var l="";b(document.body).on("keydown",function(a){9===a.which&&(l=a.shiftKey?"shifttab":"tab")}),b(document.body).on("keyup",function(a){9===a.which&&(l="")}),b(document.body).on("focusin","svg",function(a){var b;"tab"===l?b=h.findNextTabbable(a.target):"shifttab"===l&&(b=h.findPreviousTabbable(a.target)),b&&c.defer(function(){b.focus()})});var m,n=!1,o=function(){n||(b(document.body).addClass("yj-acc-hide-outlines"),b(document.body).removeClass("yj-acc-show-outlines"),n=!0)},p=function(){n&&(b(document.body).addClass("yj-acc-show-outlines"),b(document.body).removeClass("yj-acc-hide-outlines"),n=!1)},q=!1,r=!1;j.notifyMouseDown=function(a){q=!0,o(),a.target==m||m&&b.contains(m,a.target)||(r=!0)},b(document.body).on("mousedown.yj-accHelper-int",j.notifyMouseDown),b(document.body).on("mouseup.yj-accHelper-int",function(){q=!1}),b(document.body).on("focusin.yj-accHelper-int",function(a){q||(m=a.target,r=!1)}),b(document.body).on("keydown.yj-accHelper-int",function(a){9===a.which&&p()}),j.actionInitiatedByKeyboardOrScreenreader=function(){return!r},j.mostRecentNonMouseFocusTarget=function(){return m};var s,t,u=function(a){a&&c.defer(function(){a.focus()})};return j.saveFocusForMenu=function(){s=null;var a=document.activeElement;!a||"A"!==a.tagName&&"BUTTON"!==a.tagName||(s=a)},j.restoreFocusForMenu=function(){s&&u(s),s=null},j.saveFocusForModal=function(){return j.actionInitiatedByKeyboardOrScreenreader()?void(s?(t=s,s=null):t=j.mostRecentNonMouseFocusTarget()):void(t=null)},j.restoreFocusForModal=function(){u(t),t=null},j}),function(a,b){"function"==typeof define&&define.amd?define("backbone-component",["underscore","Backbone"],b):"object"==typeof exports?module.exports=b(require("underscore","Backbone")):b(a._,a.Backbone)}(this,function(a,b){var c=function(){return document.all?!0:!window.ActiveXObject&&"ActiveXObject"in window}();return b.Component=b.View.extend({constructor:function(c){this._setup(),a.each(c,function(a,b){"undefined"==typeof a&&delete c[b]}),c=a.extend({},a.result(this,"defaults"),c),b.View.call(this,c)},append:function(a,b){return this._addChild(a,b,"append"),this},prepend:function(a,b){return this._addChild(a,b,"prepend"),this},children:function(){return a.pluck(this._children,"view")},empty:function(){return this._removeChildren(),this},renderTemplate:function(a){return this.$el.html(this._compile(this.template)(a||{})),this},renderer:{compile:function(b){return this._template=this._template||a.partial(a.template,b),this._template}},_setup:function(){a.extend(this,{_compile:this.renderer.compile}),this._children=[],this.render=this._wrapRender(),this.remove=this._wrapRemove()},_addChild:function(b,c,d){var e={view:b,selector:c,method:d||"append"},f=function(b){this._children=a.without(this._children,b)};b._removeFromParent=a.bind(f,this,e),this._children.push(e)},_removeChildren:function(){a.invoke(this.children(),"remove"),this._children=[]},_removeFromParent:function(){},_wrapRender:function(){var d=function(d){var e=a.rest(arguments);return c&&this._detachChildren(),d.apply(this,e),this._attachChildren(),b.Component.prototype.render.apply(this,e)},e=a.bind(this.render,this);return a.wrap(e,d)},_wrapRemove:function(){var c=function(c){var d=a.rest(arguments);return this._removeFromParent(),this._removeChildren(),c.apply(this,d),b.Component.prototype.remove.apply(this,d)},d=a.bind(this.remove,this);return a.wrap(d,c)},_attachChild:function(a){var b=a.selector?this.$(a.selector):this.$el;a.rendered||(a.view.render(),a.rendered=!0),b[a.method](a.view.$el)},_attachChildren:function(){a.each(this._children,function(a){this._attachChild(a),a.view.delegateEvents()},this)},_detachChildren:function(){a.each(this._children,function(a){a.view.$el&&a.view.$el.detach()})}}),b.Component.prototype.add=b.Component.prototype.append,b.Component}),define("core/lib/backbone_legacy_integration",["require","underscore","backbone-component","mustache"],function(a){var b=a("underscore"),c=a("backbone-component"),d=a("mustache");return b.extend(c.prototype,{show:function(){return this.$el.show.apply(this.$el,arguments),this.trigger("show")},hide:function(){return this.$el.hide.apply(this.$el,arguments),this.trigger("hide")},toggle:function(){return this.$el.toggle.apply(this.$el,arguments),this.trigger(this.isVisible()?"show":"hide")},isVisible:function(){return this.$el.is(":visible")}}),b.extend(c.prototype,{setTimeout:function(a,b){var c=setTimeout(a,b);return this._timeouts=this._timeouts||[],this._timeouts.push(c),c},clearTimeout:function(a){clearTimeout(a),this._timeouts=b.without(this._timeouts,a)},clearTimeouts:function(){b.each(this._timeouts,function(a){clearTimeout(a);
},this),this._timeouts&&(this._timeouts.length=0)},setInterval:function(a,b){var c=setInterval(a,b);return this._intervals=this._intervals||[],this._intervals.push(c),c},clearInterval:function(a){clearInterval(a),this._intervals=b.without(this._intervals,a)},clearIntervals:function(){b.each(this._intervals,function(a){clearInterval(a)},this),this._intervals&&(this._intervals.length=0)}}),b.extend(c.prototype,{renderer:{compile:function(a){return b.isFunction(a)?a:b.partial(d.render,a)}}}),c}),define("common-ui/lib/ui/shared/modal",["require","jquery","underscore","core/lib/backbone_legacy_integration","backbone"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_legacy_integration"),e=a("backbone");return d.extend({className:"yj-modal",preserveDom:!0,initialize:function(a){var b="";if(this.component=a.component,!this.component)throw new Error("Modal requires `component`");this.append(this.component),b="function"==typeof this.component.destroy?"destroy":"remove",this.component[b]=c.wrap(this.component[b],function(a){a.call(this.component),this.hideAndRemove()}.bind(this))},render:function(){return e.trigger("/ui/tooltip/hide"),b("body").children("div").attr("aria-hidden","true"),this.$el.removeAttr("aria-hidden").attr("role","dialog"),this.$el.fadeIn("fast"),this.rendered=!0,this},hideAndRemove:function(){var a=this;b("body").children("div").removeAttr("aria-hidden"),a.preserveDom=this,a.$el.fadeOut("fast",function(){a.$el.empty(),a.remove()}),this.rendered&&this.trigger("destroy")}})}),define("common-ui/lib/ui/accessibility/lightbox_accessibility",["require","jquery","underscore","common-ui/lib/ui/accessibility/traversal_util","common-ui/lib/ui/accessibility/accessibility_util"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/accessibility/traversal_util"),e=a("common-ui/lib/ui/accessibility/accessibility_util"),f={},g={isActive:!1,focusSentinels:[],ariaHiddenRemoveList:[],ariaHiddenRestoreList:[],tabSink:null};return f.isModalPresent=function(){return g.isActive},f.beforeModalShow=function(){e.saveFocusForModal()},f.afterModalShow=function(a,c){if(!g.isActive){g.isActive=!0;var f=c,h=function(){d.focusFirstTabbableWithin(a,f)},i=function(){d.focusLastTabbableWithin(a,f)};g.tabSink=b('<span tabindex="-1" style="position:absolute; left:0px; top:0px"></span>');var j=b(a).find("[role=document]");j.prepend(g.tabSink),g.tabSink.on("keydown.yj-accHelper-modal",function(a){return 9==a.which?(a.shiftKey?i():h(),!1):void 0}),f&&b(f).is(":visible")||(f=g.tabSink[0]),b.contains(a,document.activeElement)||(e.actionInitiatedByKeyboardOrScreenreader()&&d.focusFirstTabbableWithin(a,c),b.contains(a,document.activeElement)||g.tabSink.focus()),g.ariaHiddenRemoveList=[],g.ariaHiddenRestoreList=[],b(document.body.children).not("script").each(function(){this!=a&&"yj-screenreader-announcer"!=this.id&&("aria-hidden"in this.attributes?g.ariaHiddenRestoreList.push({el:this,val:this.getAttribute("aria-hidden")}):g.ariaHiddenRemoveList.push(this),this.setAttribute("aria-hidden",!0))});var k=[],l='<div aria-hidden="true" tabindex="0" style="position:fixed; left:0px; top:0px;"></div>';k.push(b(l).focus(i).insertBefore(a)),k.push(b(l).focus(h).insertAfter(a)),k.push(b(l).focus(h).prependTo(document.body)),k.push(b(l).focus(i).appendTo(document.body)),g.focusSentinels=k}},f.afterModalDone=function(){if(g.isActive){g.isActive=!1,b(document.body).off(".yj-accHelper-modal");for(var a=0;a<g.focusSentinels.length;a++)g.focusSentinels[a].remove();b(g.ariaHiddenRemoveList).removeAttr("aria-hidden"),c.each(g.ariaHiddenRestoreList,function(a){a.el.setAttribute("aria-hidden",a.val)}),e.restoreFocusForModal(),g.tabSink&&(g.tabSink.off(".yj-accHelper-modal"),g.tabSink.remove(),g.tabSink=null)}},f}),define("css!common-ui/lib/resources/stylesheets/colorbox",[],function(){}),/*!
// ColorBox v1.3.15 - a full featured, light-weight, customizable lightbox based on jQuery 1.3+
// Copyright (c) 2010 Jack Moore - jack@colorpowered.com
// Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
*/
define("colorbox",["require","common-ui/lib/helper/environment","common-ui/lib/ui/accessibility/lightbox_accessibility","css!common-ui/lib/resources/stylesheets/colorbox"],function(a){var b=a("common-ui/lib/helper/environment"),c=a("common-ui/lib/ui/accessibility/lightbox_accessibility");return a("css!common-ui/lib/resources/stylesheets/colorbox"),function(a,d){function e(b,c,d){return b=b?' id="'+Q+b+'"':"",c=c?' style="'+c+'"':"",d=d?d:"div",a("<"+d+b+c+"/>")}function f(a,b){return b="x"===b?u.width():u.height(),"string"==typeof a?Math.round(/%/.test(a)?b/100*parseInt(a,10):parseInt(a,10)):a}function g(a){return K.photo||/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i.test(a)}function h(b){for(var c in b)a.isFunction(b[c])&&"on"!==c.substring(0,2)&&(b[c]=b[c].call(I));return b.rel=b.rel||I.rel||"nofollow",b.href=b.href||a(I).attr("href"),b.title=b.title||I.title,b}function i(b,c){c&&c.call(I),a(document).trigger(b),Z.trigger(b)}function j(){var a,b,c,d=Q+"Slideshow_",e="click."+Q;K.slideshow&&t[1]&&(b=function(){A.text(K.slideshowStop).unbind(e).one(e+" "+U,c),Z.bind(T,function(){(J<t.length-1||K.loop)&&(a=setTimeout(N.next,K.slideshowSpeed))}).bind(S,function(){clearTimeout(a)}),m.removeClass(d+"off").addClass(d+"on"),a=setTimeout(N.next,K.slideshowSpeed)},c=function(){clearTimeout(a),Z.unbind([T,S,U].join(" ")),A.text(K.slideshowStart).unbind(e).one(e,b),m.removeClass(d+"on").addClass(d+"off")},K.slideshowAuto?b():c())}function k(b){if(!$){if(I=b,K=h(a.extend({},a.data(I,P))),t=a(I),J=0,c.beforeModalShow(),"nofollow"!==K.rel&&(t=a("."+_).filter(function(){var b=a.data(this,P).rel||this.rel;return b===K.rel}),J=t.index(I),-1===J&&(t=t.add(I),J=t.length-1)),!L){if(L=M=!0,m.show(),K.returnFocus)try{I.blur(),Z.one(V,function(){a(I).focus()})}catch(a){}l.css({opacity:+K.opacity,cursor:K.overlayClose?"pointer":"auto"}).show(),K.w=f(K.initialWidth,"x"),K.h=f(K.initialHeight,"y"),N.position(0),i(R,K.onOpen),z.add(C).add(B).add(A).add(y).hide();var d=a("<span/>",{class:"yj-acc-hidden",html:K.close});D.html(d).addClass("yj-close-link").prepend('<span class="yamicon yamicon-x yamicon-xx-small"></span>').attr("data-speechtip","").show()}K.closeButton||D.hide(),N.load(!0)}}var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O={transition:"elastic",speed:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,inline:!1,html:!1,iframe:!1,photo:!1,href:!1,title:!1,rel:!1,opacity:.9,preloading:!0,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:!1,returnFocus:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,overlayClose:!0,escKey:!0,arrowKey:!0,closeButton:!0},P="colorbox",Q="yj_cbox",R=Q+"_open",S=Q+"_load",T=Q+"_complete",U=Q+"_cleanup",V=Q+"_closed",W=Q+"_purge",X=Q+"_loaded",Y=b.isOlderIE()&&!a.support.opacity,Z=a("<a/>"),$=!1,_=Q+"Element";N=a.fn[P]=a[P]=function(b,c){var d,e=this;return!e[0]&&e.selector?e:(b=b||{},c&&(b.onComplete=c),e[0]&&void 0!==e.selector||(e=a("<a/>"),b.open=!0),e.each(function(){a.data(this,P,a.extend({},a.data(this,P)||O,b)),a(this).addClass(_)}),d=b.open,a.isFunction(d)&&(d=d.call(e)),d&&k(e[0]),e)},N.init=function(){u=a(d),m=e().attr({id:"yj-"+P,class:Y?Q+"IE":""}),l=e("Overlay","").hide(),n=e("Wrapper"),n.attr("role","document"),o=e("Content").append(y=e("Title",null,"h1"),D=e("Close"),v=e("LoadedContent","width:0; height:0; overflow:hidden"),x=e("LoadingOverlay").add(e("LoadingGraphic")),z=e("Current"),B=e("Next"),C=e("Previous"),A=e("Slideshow")),Z.bind(R,j),m.attr({role:"dialog","aria-labelledby":y[0].id}),D.attr({role:"button"}),D.css("z-index",1),n.append(e("Top").append(e("TopLeft"),p=e("TopCenter"),e("TopRight")),e(!1,"clear:left").append(q=e("MiddleLeft"),o,r=e("MiddleRight")),e("Bottom","clear:left").append(e("BottomLeft"),s=e("BottomCenter"),e("BottomRight"))).children().children().css({float:"left"}),w=e(!1,"position:absolute; width:9999px; visibility:hidden; display:none"),a("body").prepend(l,m.append(n,w)),o.children().hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")}).addClass("hover"),E=p.height()+s.height()+o.outerHeight(!0)-o.height(),F=q.width()+r.width()+o.outerWidth(!0)-o.width(),G=v.outerHeight(!0),H=v.outerWidth(!0),m.css({"padding-bottom":E,"padding-right":F}).hide(),B.click(N.next),C.click(N.prev),D.click(function(){N.close()}),o.children().removeClass("hover"),a(document).on("click","."+_,function(a){0!==a.button&&"undefined"!=typeof a.button||a.ctrlKey||a.shiftKey||a.altKey||(a.preventDefault(),k(this))}),l.click(function(){K.overlayClose&&N.close()}),a(document).bind("keydown",function(a){L&&K.escKey&&27===a.which&&(a.preventDefault(),N.close()),L&&K.arrowKey&&!M&&t[1]&&(37===a.which&&(J||K.loop)?(a.preventDefault(),C.click()):39===a.which&&(J<t.length-1||K.loop)&&(a.preventDefault(),B.click()))})},N.remove=function(){m.add(l).remove(),a(document).off("click","."+_).removeData(P).removeClass(_)},N.position=function(a,b){function c(a){p[0].style.width=s[0].style.width=o[0].style.width=a.style.width,x[0].style.height=x[1].style.height=o[0].style.height=q[0].style.height=r[0].style.height=a.style.height}var d,e=Math.max(document.documentElement.clientHeight-K.h-G-E,0)/2+("scrollTop"in K?K.scrollTop:u.scrollTop()),f=Math.max(u.width()-K.w-H-F,0)/2+u.scrollLeft()-12;d=m.width()===K.w+H&&m.height()===K.h+G?0:a;var g=m.width(),h=m.height(),i=K.w+H,j=K.h+G;0==j||g==i&&h==j?b&&b():m.dequeue().animate({width:i,height:j,top:e,left:f},{duration:d,complete:function(){c(this),M=!1,n[0].style.width=i+F+"px",n[0].style.height=j+E+"px",b&&b()},step:function(){c(this)}})},N.resize=function(a){L&&(a=a||{},a.width&&(K.w=f(a.width,"x")-H-F),a.innerWidth&&(K.w=f(a.innerWidth,"x")),v.css({width:K.w}),a.height&&(K.h=f(a.height,"y")-G-E),a.innerHeight&&(K.h=f(a.innerHeight,"y")),a.innerHeight||a.height||(v.css({height:"auto"}),K.h=v.height()),"scrollTop"in a&&(K.scrollTop=a.scrollTop),N.position("none"===K.transition?0:K.speed))},N.prep=function(b){function d(){return K.w=K.w||v.width(),K.w=K.mw&&K.mw<K.w?K.mw:K.w,K.w}function f(){return K.h=K.h||v.height(),K.h=K.mh&&K.mh<K.h?K.mh:K.h,K.h}function h(b){var d,e,f,h,l=t.length,n=K.loop;N.position(b,function(){function b(){Y&&m[0].style.removeAttribute("filter")}L&&(Y&&j&&v.fadeIn(100),v.show(),i(X),y.show().html(K.title),l>1&&("string"==typeof K.current&&z.html(K.current.replace(/\{current\}/,J+1).replace(/\{total\}/,l)).show(),B[n||l-1>J?"show":"hide"]().html(K.next),C[n||J?"show":"hide"]().html(K.previous),d=J?t[J-1]:t[l-1],f=l-1>J?t[J+1]:t[0],K.slideshow&&A.show(),K.preloading&&(h=a.data(f,P).href||f.href,e=a.data(d,P).href||d.href,h=a.isFunction(h)?h.call(f):h,e=a.isFunction(e)?e.call(d):e,g(h)&&(a("<img/>")[0].src=h),g(e)&&(a("<img/>")[0].src=e))),x.hide(),"fade"===K.transition?m.fadeTo(k,1,function(){b()}):b(),u.bind("resize."+Q,function(){N.position(0)}),c.afterModalShow(m[0],D[0]),i(T,K.onComplete))})}if(L){var j,k="none"===K.transition?0:K.speed;u.unbind("resize."+Q),v.remove(),v=e("LoadedContent").html(b),v.hide().appendTo(w.show()).css({width:d(),overflow:K.scrolling?"auto":"hidden"}).css({height:f()}).insertAfter(D),w.hide(),a("#"+Q+"Photo").css({cssFloat:"none",marginLeft:"auto",marginRight:"auto"}),"fade"===K.transition?m.fadeTo(k,0,function(){h(0)}):h(k)}},N.load=function(b){a("body").addClass("modal");var c,d,j,k=N.prep;if(M=!0,I=t[J],b||(K=h(a.extend({},a.data(I,P)))),i(W),i(S,K.onLoad),K.h=K.height?f(K.height,"y")-G-E:K.innerHeight&&f(K.innerHeight,"y"),K.w=K.width?f(K.width,"x")-H-F:K.innerWidth&&f(K.innerWidth,"x"),K.mw=K.w,K.mh=K.h,K.maxWidth&&(K.mw=f(K.maxWidth,"x")-H-F,K.mw=K.w&&K.w<K.mw?K.w:K.mw),K.maxHeight&&(K.mh=f(K.maxHeight,"y")-G-E,K.mh=K.h&&K.h<K.mh?K.h:K.mh),c=K.href,x.show(),K.inline){var l=e().hide().insertBefore(a(c)[0]);Z.one(W,function(){l.replaceWith(v.children())}),k(a(c))}else K.iframe?(Z.one(X,function(){var b=a("<iframe frameborder='0' style='width:100%; height:100%; border:0; display:block'/>")[0];b.name=Q+ +new Date,b.src=K.href,K.scrolling||(b.scrolling="no"),Y&&(b.allowtransparency="true"),a(b).appendTo(v),Z.one(W,function(){b.src="//about:blank"})}),k(" ")):K.html?k(K.html):g(c)?(d=new Image,d.onload=function(){var b;d.onload=null,d.id=Q+"Photo",a(d).css({border:"none",display:"block",cssFloat:"left"}),K.scalePhotos&&(j=function(){d.height-=d.height*b,d.width-=d.width*b},K.mw&&d.width>K.mw&&(b=(d.width-K.mw)/d.width,j()),K.mh&&d.height>K.mh&&(b=(d.height-K.mh)/d.height,j())),K.h&&(d.style.marginTop=Math.max(K.h-d.height,0)/2+"px"),t[1]&&(J<t.length-1||K.loop)&&a(d).css({cursor:"pointer"}).click(N.next),Y&&(d.style.msInterpolationMode="bicubic"),setTimeout(function(){k(d)},1)},setTimeout(function(){d.src=c},1)):c&&w.load(c,function(b,c,d){k("error"===c?"Request unsuccessful: "+d.statusText:a(this).children())})},N.next=function(){M||(J=J<t.length-1?J+1:0,N.load())},N.prev=function(){M||(J=J?J-1:t.length-1,N.load())},N.close=function(){a("body").removeClass("modal"),L&&!$&&($=!0,L=!1,i(U,K.onCleanup),u.unbind("."+Q),l.fadeTo("fast",0),m.stop().fadeTo("fast",0,function(){i(W),v.remove(),m.add(l).css({opacity:1,cursor:"auto"}).hide(),setTimeout(function(){$=!1,i(V,K.onClosed)},1)}),c.afterModalDone())},N.element=function(){return a(I)},N.settings=O,a(N.init)}(jQuery,window)}),define("common-ui/lib/ui/general/lightbox_manager",["require","jquery","underscore","backbone","core/lib/jam/component","core/lib/jam/component2","common-ui/lib/helper/environment","core/lib/tr","common-ui/lib/helper/ui","common-ui/lib/ui/accessibility/accessibility_util","common-ui/lib/ui/shared/modal","colorbox"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/jam/component"),f=a("core/lib/jam/component2"),g=a("common-ui/lib/helper/environment"),h=a("core/lib/tr"),i=a("common-ui/lib/helper/ui"),j=a("common-ui/lib/ui/accessibility/accessibility_util");a("common-ui/lib/ui/shared/modal"),a("colorbox");var k={html:{disabled:{overflow:"hidden"},enabled:{overflow:"visible"}},body:{disabled:{"margin-right":"$"},enabled:{"margin-right":"0"}},"#masthead":{disabled:{"padding-right":"$"},enabled:{"padding-right":"0"}},".topnav-fixed #uni-header":{disabled:{"padding-right":"$"},enabled:{"padding-right":"0"}},".yam-ui-chat-chat-manager":{disabled:{right:"$"},enabled:{right:"0"}}},l=b.fn.colorbox.close,m=e.extend({init:function(a,c){this._docScrollTop=null,this._windowScrollTop=null,e.prototype.init.call(this,b.extend({},this.defaults,a),c),this._findAndRegister(),this.manageBorder.init(),b("#yj_cboxContent").delegate("#yj_cboxLoadedContent","resize",this.handleResize.bind(this)),b("#yj_cboxOverlay").bind("mousedown",function(a){j.notifyMouseDown(a)}).addClass("zindex-t4"),b("#yj-colorbox").bind("mousedown",function(a){j.notifyMouseDown(a)}).addClass("zindex-t4"),yam.router&&yam.router.on("route",this._onRoute,this)},_onRoute:function(){this._fragment!==d.history.fragment&&this.close()},getTargetOptions:function(a){var b={attachmentId:a.data("image-id"),target:a},c=a.data("image-model");return c&&(b.attachmentModel=c),b},createElement:function(){},_findAndRegister:function(){var a=this;b(document).on("click",".tightbox",function(c){if("A"===c.currentTarget.tagName.toUpperCase()){var e=b(c.currentTarget),f={href:function(){var a=e.attr("href");if(b.fn.colorbox.inline){var c=window.location.href;c=c.split("#")[0],a.substr(0,c.length)===c&&(a=a.substr(c.length))}return a},title:function(){return e.attr("title")},inline:function(){return e.attr("href").indexOf("#")>-1},onOpen:function(){e.attr("data-lightbox-class")&&b("#yj_cboxContent").addClass(e.attr("data-lightbox-class"))},onClosed:function(){a.handleClose.bind(a)(),e.attr("data-lightbox-class")&&b("#yj_cboxContent").removeClass(e.attr("data-lightbox-class")),b("#yj_cboxWrapper").unbind(".lightBox")},onCleanup:function(){a.handleCleanup.bind(a)()},onComplete:function(){d.trigger("/ui/lightbox/opened")},close:h.t("close")};!f.inline()&&e.is(".avatar")&&(f.photo=!0,f.maxWidth=640),b.fn.colorbox(f),a.style&&(b("#yj-colorbox").removeClass(a.style),b("#yj_cboxOverlay").removeClass(a.style)),f.style&&(b("#yj-colorbox").addClass(f.style),b("#yj_cboxOverlay").addClass(f.style),a.style=f.style),c.preventDefault()}})},observeEvents:function(){d.on("/ui/lightbox/open",this.open,this),d.on("/ui/lightbox/close",this.close,this),d.on("/ui/lightbox/bind",this.bind,this),d.on("/ui/lightbox/resize",this.resize,this),d.on("/ui/lightbox/setTitle",this.setTitle,this)},observeDomEvents:function(){b(document).on("click",".cancel-colorbox",c.bind(function(){this.close()},this)),b(document).on("click","#yj_cboxNext",c.bind(function(){this.manageBorder.resizeBorder()},this)),b(document).bind("yj_cbox_closed",function(){d.trigger("/ui/lightbox/closed")})},isOpen:!1,bind:function(){},open:function(a){var e=this;a=a||{};var f=a.confirmClose;a=c.omit(a,"confirmClose"),a.title=c.escape(a.title)||a.titleHtml;var g=a.onClosed||function(){};a.onClosed=function(){e.handleClose.bind(e)(),g()};var i=a.onCleanup||function(){};a.onCleanup=function(){e.handleCleanup.bind(e)(),i()},a.close=h.t("close"),b.fn.colorbox.close=c.isFunction(f)?function(){f()===!0&&(b.fn.colorbox.close=l,b.fn.colorbox.close())}:l,b.fn.colorbox(a),this.style&&(b("#yj-colorbox").removeClass(this.style),b("#yj_cboxOverlay").removeClass(this.style)),a.style&&(b("#yj-colorbox").addClass(a.style),b("#yj_cboxOverlay").addClass(a.style),this.style=a.style),b(window).height()>b("#yj-colorbox").height()&&this.disableScrolling(),this._windowScrollTop=b(window).scrollTop(),this.isOpen=!0,this._fragment=d.history.fragment},disableScrolling:function(){var a=document.documentElement;this._docScrollTop=a.scrollTop,this._adjustElements("disabled"),a.scrollTop=this._docScrollTop,this.disabledScroll=!0},enableScrolling:function(){var a=document.documentElement;this.disabledScroll=!1;var b=a.scrollTop;this._adjustElements("enabled"),a.scrollTop=b},_adjustElements:function(a){c.each(k,function(d,e){var f=b(e);0!==f.length&&c.each(d[a],function(a,b){a=a.replace("$",m.scrollerWidth+"px"),f.css(b,a)})})},close:function(){b.fn.colorbox.close()},handleClose:function(){this.isOpen=!1,this.style&&(b("#yj-colorbox").removeClass(this.style),b("#yj_cboxOverlay").removeClass(this.style)),this.style=void 0,this.disabledScroll&&this.enableScrolling()},handleCleanup:function(){b(".yj-quick-link-lightbox .yj-hidden-file-input").hide()},resize:function(a){b.fn.colorbox.resize(a)},manageBorder:{init:function(){},resizeBorder:function(){}},handleResize:function(){var a={},c=b(window).scrollTop();g.isIOS()&&c!==this._windowScrollTop&&(a.scrollTop=this._windowScrollTop),d.trigger("/ui/lightbox/resize",a)},setTitle:function(a){b("#yj_cboxTitle").text(a)},destroy:function(){b("#yj_cboxContent").undelegate("#yj_cboxLoadedContent","resize"),yam.router&&yam.router.off("route",this._onRoute,this),e.prototype.destroy.call(this)}});return b(function(){m.scrollerWidth=i.getScrollerWidth()}),m.openComponent=function(a,e,g,h){a.render(),a instanceof f&&a.attach();var i=h||{},j=b('<div class="yj-lightbox-content '+e+'"></div>').append(a.$el).append('<div class="clear"></div>'),k={title:"",width:500,html:j,transition:"none",overlayClose:!0,style:e,onClosed:function(){a&&a.remove()}},l=c.wrap(i.onComplete,function(b){c.isFunction(a.show)&&a.show(),d.trigger("/ui/lightbox/resize"),c.isFunction(b)&&b()}),n=c.wrap(i.onClosed,function(b){c.isFunction(a.remove)&&a.remove(),c.isFunction(b)&&b()});return c.extend(i,{onComplete:l,onClosed:n}),"function"==typeof a.on&&a.on("shouldRemove",m._onContentShouldRemove),c.extend(k,i),d.trigger("/ui/lightbox/open",k),a},m._onContentShouldRemove=function(){d.trigger("/ui/lightbox/close")},m}),define("stache!common-ui/lib/ui/general/flash_alert",["mustache"],function(a){var b='<span class="alert-icon yamicon {{yamiconClasses}}"></span>\n<p class="alert-content">{{content}}</p>\n<a href="#" class="alert-close yamicon yamicon-x" aria-label="close"></a\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/general/flash_alert",["require","jquery","underscore","backbone","core/lib/backbone_base_view","core/lib/tr","common-ui/lib/ui/accessibility/screenreader_announcer","html!./flash_alert"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/backbone_base_view"),f=a("core/lib/tr"),g=a("common-ui/lib/ui/accessibility/screenreader_announcer"),h=a("html!./flash_alert");return e.extend({defaults:{animationSpeed:666,delay:window.location.toString().indexOf("global_admin")>0?1e4:4e3},events:{"click .alert-close":"hideHandler",mouseenter:"clearCloseTimeout",mouseleave:"setCloseTimeout"},template:h,initialize:function(a){var e=this,f=b(".yj-show-alert");this.options=c.extend({},this.defaults,a),d.on("/ui/alert/show",function(){e.show.apply(e,arguments)}),f.length&&(this.setElement(f),this.show()),this.listenToOnce(d,"initialRoute",this._onInitialRoute)},render:function(){return this.data&&this.$el.html(this.template(this.data)),this},setCloseTimeout:function(){this.closeTimeout=setTimeout(c.bind(function(){this.hide()},this),this.options.delay)},clearCloseTimeout:function(){clearTimeout(this.closeTimeout)},hideHandler:function(a){a.preventDefault(),a.stopPropagation(),this.hide()},hide:function(){this.$el.fadeOut(this.options.animationSpeed),this.$accEl.hide(),this.undelegateEvents()},show:function(a,c){var d="";this.$el.length&&(this.$el.hide(),this.clearCloseTimeout()),a&&this.setElement(b("#yj-"+a)),this.$accEl=b("#"+this.$el[0].id+"-acc");var e={notice:"yj-green yamicon-circle-check",error:"yamicon-danger"};if(a in e&&(d=e[a]),c){this.data={yamiconClasses:d,content:c},this.render();var h="notice"===a?f.t("notice"):f.t("error");this.$accEl.text(h+": "+c)}-1!=window.navigator.userAgent.indexOf("Macintosh")&&g.announceText(this.$(".alert-content").text(),"assertive"),this.$el.fadeIn(this.options.animationSpeed,this.setCloseTimeout.bind(this)),this.$accEl.show()},_onInitialRoute:function(a,b){this._routeHasFlash(b)&&this._showFlashFromRoute(b)},_routeHasFlash:function(a){return c.has(a,"flash_type")&&c.has(a,"flash_message")},_showFlashFromRoute:function(a){var b="error"==a.flash_type?"error":"notice",c=f.t(a.flash_message);this.show(b,c)}})}),define("common-ui/lib/ui/accessibility/menu_accessibility",["require","jquery","underscore","common-ui/lib/ui/accessibility/traversal_util","common-ui/lib/ui/accessibility/accessibility_util"],function(a){var b,c,d,e=a("jquery"),f=a("underscore"),g=a("common-ui/lib/ui/accessibility/traversal_util"),h=a("common-ui/lib/ui/accessibility/accessibility_util"),i="yj-acc-keyboard-selected",j="data-acc-menu-interaction-style",k={};k.isMenuPresent=function(){return b};var l=function(a,d){e(b).off(".yj-accHelper-menu"),e(document.body).off(".yj-accHelper-menu"),b=null,a&&a(),c&&(c.removeClass(i),c=null),d&&h.restoreFocusForMenu()},m=function(a){a&&(c&&c.removeClass(i),a.focus(),c=e(a).closest("LI").addClass(i))},n=function(a,b){var c=function(c){if(27==c.which)return l(b,!0),!1;if("menu"===d){if(38===c.which||40===c.which){var e,f=38===c.which;return e=a.contains(document.activeElement)?f?g.findPreviousTabbable(document.activeElement,a):g.findNextTabbable(document.activeElement,a):f?g.findLastTabbableWithin(a):g.findFirstTabbableWithin(a),m(e),!1}if(9==c.which)return l(b,!0),!1}};e(a).on("keydown.yj-accHelper-menu",c),e(document.body).on("keydown.yj-accHelper-menu",c)},o=function(a,b){var c=document.activeElement;e(document.body).on("focusin.yj-accHelper-menu",function(){var d=e.contains(document.activeElement,c);document.activeElement==c||d||a.contains(document.activeElement)||l(b,!1)})};return k.afterMenuShow=function(a,c){if(a!==b){b&&b!=a&&k.afterMenuDone(b),b=a;var i=e(a),l=h.actionInitiatedByKeyboardOrScreenreader();h.saveFocusForMenu(),d="popup"===i.attr(j)?"popup":"menu","menu"===d&&(i.find("ul").attr("role","menu"),i.find("li a, li button").each(function(){this.getAttribute("role")||(this.setAttribute("role","menuitem"),this.title&&this.setAttribute("aria-label",e(this).text()))}),i.find("li").each(function(){this.getAttribute("role")||this.setAttribute("role","presentation")})),l&&f.defer(function(){m(g.findFirstTabbableWithin(a))}),n(a,c),"popup"===d&&o(a,c)}},k.afterMenuDone=function(a){a==b&&l(null,!0)},k}),define("common-ui/lib/ui/general/click_menu",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/string_helper","common-ui/lib/helper/environment","common-ui/lib/ui/accessibility/menu_accessibility"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/string_helper"),f=a("common-ui/lib/helper/environment"),g=a("common-ui/lib/ui/accessibility/menu_accessibility");return d.extend({defaults:{_triggerCls:"yj-click-menu-trigger"},className:"yj-click-menu-container",attributes:{"data-yamjs-id":"click-menu-container"},initialize:function(a){this.options=b.extend(this.defaults,a),b(document).on("click","."+this.options._triggerCls,this.handleMenuClick.bind(this))},handleMenuClick:function(a){a.stopPropagation();var c,d,e=this.setMenuTrigger(a);if(e.data("menuContent"))c=e.data("menuContent"),this.$el.empty().append(c);else if(e.attr("data-content-id")){var f=e.attr("data-content-id");c=b("[data-yamjs-id="+f+"]:first").detach(),this.$el.empty().append(c),this.$targ.data("menuContent",c)}else if(e.find(".yj-click-menu-content").length)c=e.find(".yj-click-menu-content").detach(),this.$el.empty().append(c),this.$targ.data("menuContent",c);else{if(d=this.findComponent(),!d)return;"function"==typeof d.createClickMenu&&(c=d.createClickMenu()),c&&this.$el.empty().append(c),this.$targ.data("menuContent",!1)}this.open()},setMenuTrigger:function(a){var c=b(a.target);return c.hasClass(this.options._triggerCls)||(c=c.closest("."+this.options._triggerCls)),this.$targ&&this.$targ[0]!==c[0]&&(a.stopPropagation(),this.close()),this.$targ=c,this.$overflowElement=this.$targ.attr("data-overflow-element")?this.$targ.closest("."+this.$targ.attr("data-overflow-element")):[],c},findComponent:function(){var a,b=this.$targ.closest(".yj-component"),c=b.attr("data-yamjs-id"),d=b.attr("id");return c?a=e.camelize(c.toString()):d&&(a=d.replace("yj-","")),a?yam.jam.registry[a]:void 0},position:function(){var a;"true"===this.$targ.attr("data-attach-menu")?(a=this.$targ.position(),this.$el.detach().insertAfter(this.$targ)):(a=this.$targ.offset(),this.$el.detach().appendTo(b("body"))),this.$el.width(this.$(".yj-menu:first").outerWidth());var c={top:a.top+this.$targ.outerHeight()};this.$overflowElement.length?this.isOverflowing=this.checkOverflow():this.isOverflowing=!1,"right"===this.$targ.attr("data-position-menu")||this.isOverflowing?(c.left="auto",c.right=0):(c.left=a.left,c.right="auto"),this.$el.css(c),this.fixScroll()},checkOverflow:function(){var a=this.$el.offset().left+this.$el.outerWidth(),b=this.$overflowElement.offset().left+this.$overflowElement.outerWidth();return a>b},show:function(){this.$targ.trigger("show.ClickMenu"),this.$(".yj-menu").css("display","block"),this.$targ.addClass("yj-click-menu-opened is-open"),this.$el.show()},fixScroll:function(){var a,c=this.$targ.closest(".yj-scrollbar-fix");c.length&&(a=c.height(),f.isOlderIE()&&f.isIE().version>=9&&a++),null!=a&&a<c.get(0).scrollHeight&&(this.$spacerDiv=b("<div></div>").height(this.$(".yj-menu").height()).appendTo(c))},open:function(){this.show(),this.position(),this.bindCloser(),g.afterMenuShow(this.$el[0],this.close.bind(this))},close:function(){b(document).off(".ClickMenu"),this.$targ&&(this.$el.hide(),this.$targ.trigger("hide.ClickMenu").removeClass("yj-click-menu-opened is-open"),this.$spacerDiv&&this.$spacerDiv.remove(),this.$(".yj-click-menu-content").length&&this.$(".yj-click-menu-content:first").detach().appendTo(this.$targ).hide(),this.$el.css({top:"auto",left:"auto",right:"auto"}),this.$targ=null,this.$overflowElement=null,this.$spacerDiv=null,g.afterMenuDone(this.$el[0]))},bindCloser:function(){b(document).off("click.ClickMenu","body"),b(document).on("click.ClickMenu","body",c.bind(function(a){a.isPropagationStopped()||this.close()},this))}})}),define("stache!common-ui/lib/ui/general/refresh_countdown",["mustache"],function(a){var b='{{message}} <a href="#" role="button" class="yj-btn yj-btn-secondary yj-icon yj-refresh-button">{{btn_text}}</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/general/refresh_countdown",[],function(){}),define("common-ui/lib/ui/general/refresh_countdown",["require","jquery","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/tr","html!./refresh_countdown","css!./refresh_countdown"],function(a){var b=a("jquery"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("backbone"),f=a("core/lib/tr"),g=a("html!./refresh_countdown");return a("css!./refresh_countdown"),c.extend({mixins:[d],initialize:function(){var a=this;e.on("/application/reload",function(){a._showReloadNotice.call(a)}),this.$el.hide()},events:{"click .yj-refresh-button":"refreshHandler"},className:"yj-refresh-countdown",template:g,refreshHandler:function(a){a.preventDefault(),this.$el.text(f.t("reloading_now")),window.location.reload(!0)},getTemplateData:function(){return{message:f.t("yammer_has_been_updated_and_needs_to_be_reloaded"),btn_text:f.t("reload_now")}},_showReloadNotice:function(){b("body").append(this.render().el),this.$el.slideDown()}})}),define("common-ui/lib/ui/general/refresh_treatment_meta_data",["require","core/lib/backbone_base_view","backbone","core/lib/session","core/lib/yammer_api"],function(a){var b=a("core/lib/backbone_base_view"),c=a("backbone"),d=a("core/lib/session"),e=a("core/lib/yammer_api");return b.extend({initialize:function(){var a=this;c.on("/application/reload",function(){a._getTreatmentMetaData.call(a)})},_getTreatmentMetaData:function(){e.getTreatmentsMetaData().then(function(a){d.getCurrentUser().treatments_meta_data=a})}})}),define("models/helpers/avatar",["require","underscore","core/lib/util/screen_helper","models/helpers/user","models/helpers/models","core/lib/report","core/lib/yammer_uri"],function(a){var b=a("underscore"),c=a("core/lib/util/screen_helper"),d=a("models/helpers/user"),e=a("models/helpers/models"),f=a("core/lib/report"),g=a("core/lib/yammer_uri"),h=function(a,b){return a[b]||a.get&&a.get(b)},i=function(a){var c=h(a,"first_name"),d=h(a,"last_name"),e=h(a,"full_name");if(!c&&!d&&e){var f=e.split(" ");c=f[0],f.length>1&&(d=f[f.length-1])}return b.map([c,d],function(a){var b;return a&&(b=a.match(/[A-Z]/i),b=b?b[0].toUpperCase():void 0),b})},j=function(a,c){var e=h(a,"type"),j=h(a,"mugshot_url"),k=d.isForeign(a,c);if("domain"===e)return{replaceAvatar:!0,firstLetter:h(a,"full_name")[0].toUpperCase(),letterCount:1,hasLetters:!0,avatarColorClass:1,transparentAvatarUrl:g.cdn("assets/images/avatars/no_photo.png")};if(!d.isUser(a))return{replaceAvatar:!1};if(!k&&j&&-1===j.indexOf("no_photo"))return{replaceAvatar:!1};var l=i(a),n=b.compact(l);if(b.isEmpty(n))return{replaceAvatar:!1};if(n.length<=0)try{throw new Error("no_photo_avatar")}catch(a){f.info({message:a.message},a)}return{replaceAvatar:!0,firstLetter:l[0],lastLetter:l[1],letterCount:n.length,hasLetters:n.length>0,avatarColorClass:m(a),transparentAvatarUrl:g.cdn("assets/images/avatars/no_photo.png")}},k=function(a,b,c,d){if(!b)return h(a,"mugshot_url");var e=n(b,c,d);return l(a,e.width,e.height)},l=function(a,b,c){var d=h(a,"mugshot_url_template");return d?d.replace("{width}",b).replace("{height}",c):h(a,"mugshot_url")},m=function(a){var b=11,c=parseInt(e.getId(a),10);return c%b+1},n=function(a,b,d){return d&&(a=c.getScaledDimension(a),b=c.getScaledDimension(b)),{width:a,height:b}},o=function(a){return k(a,48,48,!0)};return{determineAvatarReplacementInfo:j,getAvatarUrl:k,getDefaultAvatar:o,getInitials:i}}),define("stache!common-ui/lib/helper/svg_icon",["mustache"],function(a){var b='<svg data-qaid="svg-icon" aria-hidden="true" class="yj-svg-icon yk-svg-{{iconName}} {{classList}}" {{#width}}width="{{.}}"{{/width}} {{#height}}height="{{.}}"{{/height}}>\n  <use xlink:href="{{svgSpriteUrl}}#yk-svg-{{iconName}}"></use>\n</svg>\n';return a.parse(b),function(c){return a.render(b,c)}}),!function(a,b){"function"==typeof define&&define.amd?define("svg4everybody",[],function(){return a.svg4everybody=b()}):"object"==typeof exports?module.exports=b():a.svg4everybody=b()}(this,function(){/*! svg4everybody v2.0.3 | github.com/jonathantneal/svg4everybody */
function a(a,b){if(b){var c=document.createDocumentFragment(),d=!a.getAttribute("viewBox")&&b.getAttribute("viewBox");d&&a.setAttribute("viewBox",d);for(var e=b.cloneNode(!0);e.childNodes.length;)c.appendChild(e.firstChild);a.appendChild(c)}}function b(b){b.onreadystatechange=function(){if(4===b.readyState){var c=b._cachedDocument;c||(c=b._cachedDocument=document.implementation.createHTMLDocument(""),c.body.innerHTML=b.responseText,b._cachedTarget={}),b._embeds.splice(0).map(function(d){var e=b._cachedTarget[d.id];e||(e=b._cachedTarget[d.id]=c.getElementById(d.id)),a(d.svg,e)})}},b.onreadystatechange()}function c(c){function d(){for(var c=0;c<l.length;){var g=l[c],h=g.parentNode;if(h&&/svg/i.test(h.nodeName)){var i=g.getAttribute("xlink:href");if(e&&(!f.validate||f.validate(i,h,g))){h.removeChild(g);var m=i.split("#"),n=m.shift(),o=m.join("#");if(n.length){var p=j[n];p||(p=j[n]=new XMLHttpRequest,p.open("GET",n),p.send(),p._embeds=[]),p._embeds.push({svg:h,id:o}),b(p)}else a(h,document.getElementById(o))}}else++c}k(d,67)}var e,f=Object(c),g=/\bTrident\/[567]\b|\bMSIE (?:9|10)\.0\b/,h=/\bAppleWebKit\/(\d+)\b/,i=/\bEdge\/12\.(\d+)\b/;e="polyfill"in f?f.polyfill:g.test(navigator.userAgent)||(navigator.userAgent.match(i)||[])[1]<10547||(navigator.userAgent.match(h)||[])[1]<537;var j={},k=window.requestAnimationFrame||setTimeout,l=document.getElementsByTagName("use");e&&d()}return c}),define("text!common-ui/lib/helper/svg_icon.txt",[],function(){return"svg-sprite-6474dcdb3f0d666e89d4561290fe9a74.svg"}),define("css!common-ui/lib/helper/svg_icon",[],function(){}),define("common-ui/lib/helper/svg_icon",["require","underscore","html!./svg_icon","core/lib/yammer_uri","svg4everybody","text!./svg_icon.txt","css!./svg_icon.css"],function(a){var b=a("underscore"),c=a("html!./svg_icon"),d=a("core/lib/yammer_uri"),e=a("svg4everybody");e();var f=a("text!./svg_icon.txt");return a("css!./svg_icon.css"),function(a,e){return c(b.extend({iconName:a,svgSpriteUrl:d.base("assets/images",f)},e))}}),define("stache!components/avatar/src/avatar",["mustache"],function(a){var b='{{#url}}\n  <a class="yj-avatar--link {{#askForPhoto}}yj-avatar--no-photo{{/askForPhoto}}" href="{{url}}"\n    {{#hideFromAccessibility}} tabindex="-1"{{/hideFromAccessibility}}\n    {{^showingHovercard}} title="{{badge}}"{{/showingHovercard}}>\n{{/url}}\n  {{^askForPhoto}}\n    {{#replaceAvatar}}\n      <span class="yj-avatar--thumb yj-avatar--replacement yj-avatar--replacement-color-{{avatarColorClass}} yj-avatar--replacement-letters-{{letterCount}}">\n        {{#hasLetters}}\n          <span class="yj-avatar--initials" aria-hidden="true">{{firstLetter}}{{lastLetter}}</span>\n          <span class="yj-avatar--alt-text yj-acc-hidden">{{imageAltText}}</span>\n        {{/hasLetters}}\n        {{^hasLetters}}\n          <img class="yj-avatar--image" src="{{transparentAvatarUrl}}" alt="{{imageAltText}}" />\n        {{/hasLetters}}\n      </span>\n    {{/replaceAvatar}}\n    {{^replaceAvatar}}\n      <img class="yj-avatar--thumb yj-avatar--image" src="{{mugshotUrl}}" alt="{{imageAltText}}" />\n    {{/replaceAvatar}}\n  {{/askForPhoto}}\n  {{#askForPhoto}}\n    <div class="yj-avatar--thumb">\n      <span class="yj-avatar--ask-photo">{{askForPhotoLabel}}</span>\n    </div>\n  {{/askForPhoto}}\n  {{#badge}}\n    <span class="yj-avatar--badge">\n      <span class="yj-avatar--badge-icon" title="{{badge}}">{{{svgIcon}}}</span>\n      <span class="yj-acc-hidden">{{badge}}</span>\n    </span>\n  {{/badge}}\n{{#url}}\n  </a>\n{{/url}}\n{{#verifiedAdmin}}\n  <a class="yj-avatar--admin" href="/admin/directory">\n    <span class="yj-avatar--admin-icon yamicon yamicon-filled-star"></span>\n    <span class="yj-avatar--admin-label yj-acc-hidden">Admin</span>\n  </a>\n{{/verifiedAdmin}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/avatar/src/avatar",[],function(){}),define("components/avatar/src/avatar",["require","jquery","underscore","core/lib/tr","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","models/helpers/avatar","core/lib/yammer_uri","models/yammer_model","models/helpers/user","common-ui/lib/helper/svg_icon","html!./avatar","core/lib/treatment","core/lib/session","core/lib/urls","css!./avatar.css"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/tr"),e=a("backbone"),f=a("core/lib/backbone_base_view"),g=a("core/lib/backbone_with_auto_render"),h=a("models/helpers/avatar"),i=a("core/lib/yammer_uri"),j=a("models/yammer_model"),k=a("models/helpers/user"),l=a("common-ui/lib/helper/svg_icon"),m=a("html!./avatar"),n=a("core/lib/treatment"),o=a("core/lib/session"),p=a("core/lib/urls");return a("css!./avatar.css"),f.extend({mixins:[g],template:m,className:"yj-avatar",attributes:function(){return{"data-userid":this.model.id}},defaults:{askForPhoto:!1,badge:void 0,size:48,verifiedAdmin:!1,withAltText:!0,withHovercard:!0,hideFromAccessibility:!1,excludeLink:!1},events:{click:"_onClick"},initialize:function(a){this.askForPhoto=a.askForPhoto,a.verifiedAdmin?this.verifiedAdmin=a.verifiedAdmin:this.badge=a.badge,this.size=a.size,this.withAltText=a.withAltText,this.withHovercard=a.withHovercard,this.hideFromAccessibility=a.hideFromAccessibility,this.excludeLink=a.excludeLink},getTemplateData:function(){var a;if(null==this._templateData){if(a=this.model instanceof j?c.clone(this.model.attributes):c.isFunction(this.model.toJSON)?this.model.toJSON():c.clone(this.model),a.url=p.userIndex(this.model),c.extend(a,h),c.extend(a,c.omit(this.options,"model")),!this.askForPhoto&&(a.replaceAvatar!==!1&&c.extend(a,h.determineAvatarReplacementInfo(a,o)),a.badge=this._getBadgeText(),a.badge)){var b=k.isUser(this.model)&&k.isNew(this.model,o)?"new":"admin",e=16,f={width:e,height:e};a.svgIcon=l("avatar-badge-"+b,f)}if(this.excludeLink&&(a.url=null),a.url){var g=this.askForPhoto&&"user"===a.type?p.userIndex(a)+"/ask_for_photo":p.indexForModel(a);a.url=i.makeAbsoluteUrl(g)}"open_graph_object"===a.type?a.mugshotUrl=a.mugshot_url:a.mugshot_url&&(a.mugshot_url_template||(a.mugshot_url_template=a.mugshot_url.replace(/(images\/)(\d+)x(\d+)(.+)/,"$1{width}x{height}$4")),a.mugshotUrl=h.getAvatarUrl(a,this.size,this.size,!0)),a.imageAltText=this.withAltText&&!this.hideFromAccessibility?a.full_name||a.name:null,a.askForPhoto=this.askForPhoto,a.askForPhoto&&(a.askForPhotoLabel=d.t("ask_for_photo")),a.showingHovercard=this._shouldAddHovercard(),a.verifiedAdmin=this.verifiedAdmin,a.hideFromAccessibility=this.hideFromAccessibility,this._templateData=a}return this._templateData},render:function(){var a=c.isFunction(this.model.toJSON)?this.model.toJSON():c.clone(this.model);return this.$(".yj-avatar--thumb").data("resource-model",a.type),this._shouldAddHovercard()&&this._addHovercard(),this.hideFromAccessibility&&this.$el.attr("aria-hidden",!0),this},_onClick:function(a){var b=this.$("a").attr("href");this._shouldAskForPhoto(b)&&(a.preventDefault(),this._askForPhoto(b))},_shouldAskForPhoto:function(a){return this.askForPhoto&&-1!==a.indexOf("ask_for_photo")},_askForPhoto:function(a){n.treatment("fast_switching_user_profile")&&(a=a.split("/#").join("")),b.get(a).done(function(){e.trigger("/ui/alert/show","notice",d.t("your_photo_request_has_been_sent"))}).fail(function(){e.trigger("/ui/alert/show","error",d.t("error_please_try_again_later"))})},_shouldAddHovercard:function(){return this.withHovercard},_addHovercard:function(){e.trigger("/ui/hovercard/add",this.$(".yj-avatar--thumb"),{id:this.model.id,type:this.model.get?this.model.get("type"):this.model.type,orientation:"string"==typeof this.withHovercard?this.withHovercard:null})},_getBadgeText:function(){if(void 0!==this.badge)return this.badge;if(void 0!==this.model.badge)return this.model.badge;if(this.model.get&&this.model.get("badge"))return this.model.get("badge");if("guide"!==this.model.type)return k.isUser(this.model)&&k.isNew(this.model,o)?d.t("new"):void 0}})}),define("components/avatar/index",["require","./src/avatar"],function(a){"use strict";var b=a("./src/avatar");return b}),define("css!common-ui/lib/ui/hovercards/hovercards",[],function(){}),define("common-ui/lib/ui/hovercards/hovercard_base",["require","underscore","core/lib/backbone_legacy_integration","components/avatar/index","core/lib/model_helper","backbone","core/lib/uri_helper","core/lib/yammer_api","core/lib/yammer_uri","core/lib/report","models/helpers/user","core/lib/session","core/lib/urls","css!common-ui/lib/ui/hovercards/hovercards"],function(a){var b=a("underscore"),c=a("core/lib/backbone_legacy_integration"),d=a("components/avatar/index"),e=a("core/lib/model_helper"),f=a("backbone"),g=a("core/lib/uri_helper"),h=a("core/lib/yammer_api"),i=a("core/lib/yammer_uri"),j=a("core/lib/report"),k=a("models/helpers/user"),l=a("core/lib/session"),m=a("core/lib/urls");return a("css!common-ui/lib/ui/hovercards/hovercards"),c.extend({className:"yj-hovercard-resource yj-hovercard-base",initialize:function(){this._tooltipOpts=null,this._data=null,this._requests={},this._cancelRequestResource=!1},getResourceModel:function(){if(!this._resourceModel)throw"Must override _resourceModel in HovercardBase";return this._resourceModel},getApiMethodName:function(){if(!this._apiMethodName)throw"Must override _apiMethodName in HovercardBase";return this._apiMethodName},buildHovercard:function(a,b){return this.empty(),this._tooltipOpts=a,this._data=b,this._requestedData=!1,this.render(),"ticker"===b.track_event&&j.event("rr_home_recent_activity"),this.$el},render:function(){var a=this.getLocalResource();if(a)this.renderTemplate(this.getTemplateContent(a)),this.addDynamicElements(a),this.prepareDom();else if(!this._requestedData){this._requestedData=!0,this.$el.empty();var c=this._data.id;this._requests[c]||(this.resourceTimeout=setTimeout(b.bind(function(){this._requests[c]=!0,this.requestResource(this.getRequestParams())},this),this._tooltipOpts.delay),this._addMouseLeaveListener())}return this},_onMouseLeaveBase:function(){clearTimeout(this.resourceTimeout),this._cancelRequestResource=!0,this._removeMouseLeaveListener()},_addMouseLeaveListener:function(){this._boundOnMouseLeaveBase=b.bind(this._onMouseLeaveBase,this),this._tooltipOpts.target.on("mouseleave",this._boundOnMouseLeaveBase)},_removeMouseLeaveListener:function(){this._tooltipOpts.target.off("mouseleave",this._boundOnMouseLeaveBase)},getLocalResource:function(){var a,b={id:this._data.id,type:this._resourceModel};a=yam.backbone.isBackboneModel(b.type)?yam.backbone.getBackboneCollectionInstance(b.type).get(b.id):e.objectForReference(b);var c;return a&&(c=a.get("is_reference")),a&&c===!1?a:!1},getRequestParams:function(){return{id:this._data.id}},requestResource:function(a){this._cancelRequestResource=!1;var b=this,c=this._data;h[this.getApiMethodName()](a).then(function(a){b.onRequestSuccess(a,c)},function(a){b.onRequestError(a,c)})},onRequestSuccess:function(a,b){delete this._requests[b.id],this._cancelRequestResource||(this.processPayload(a),b===this._data&&(this.render(),this.getLocalResource()&&f.trigger("/ui/tooltip/contentLoaded",this.$el,this._tooltipOpts.target,this._tooltipOpts)))},onRequestError:function(a,b){if(delete this._requests[b.id],!this._cancelRequestResource&&b===this._data){var c=this.getTemplateContentOnError(a);c&&(this.renderTemplate(c),this.addDynamicElementsOnError(a),this.prepareDom(),f.trigger("/ui/tooltip/contentLoaded",this.$el,this._tooltipOpts.target,this._tooltipOpts))}},processPayload:function(a){a&&a.type&&(a.is_reference=!1,yam.backbone.isBackboneModel(a.type)?yam.backbone.getBackboneCollectionInstance(a.type).add(a):e.getModelByType(a.type).save(a))},getTemplateContent:function(){},getTemplateContentOnError:function(){},addDynamicElements:function(){},addDynamicElementsOnError:function(){},prepareDom:function(){if(this.$el){this.isForeign()&&this._addForeignClassName();var a=!this.$(".yj-hovercard-action-buttons").children().length;a?this.$el.addClass("yj-no-action-buttons"):(this.$el.removeClass("yj-no-action-buttons"),this.$el.parents(".yj-hovercard").removeClass("yj-hovercard-no-action-buttons"),this._tooltipOpts.className="yj-hovercard yj-balloon");var b=this._data.track_event;this.$("a").each(function(){var a=this.href;a&&(-1===a.indexOf(i.base())&&-1===a.indexOf("javascript://")?(this.target="_blank",this.rel="noreferrer"):b&&(this.href=g.replaceParam(a,"trk_event",b)))})}},isForeign:function(){return!1},_addForeignClassName:function(){this.$el.addClass("yj-foreign-hovercard")},buildAvatar:function(a){return new d({model:a,link:this.decorate("qs",m.indexForModel(a)),askForPhoto:k.isUser(a)&&k.askForPhoto(a,l),size:75,withHovercard:!1,hideFromAccessibility:!0})},decorate:function(a,b,c){return this._data&&this._data.decorator&&this._data.decorator[a]?(c=c||{},this._data.decorator[a](b,c)):b}})}),define("stache!common-ui/lib/ui/shared/follow_button_follow",["mustache"],function(a){var b='<span>\n<span class="yamicon yamicon-plus yamicon-xxx-small" style="position:relative;top:-2px;left:-4px"></span>{{text}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/shared/follow_button_unfollow",["mustache"],function(a){var b='<span>\n<span class="yj-unfollow-button-mouseout"><span class="yamicon yamicon-checkmark yj-green yamicon-xxx-small" style="padding-right: 4px"></span>{{text}}</span>\n<span class="yj-unfollow-button-mouseover"><span class="yamicon yamicon-dash yj-red yamicon-xxx-small" style="padding-right: 4px"></span>{{mouseoverText}}</span></span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/shared/follow_button_pending",["mustache"],function(a){var b='<span>\n<span class="yamicon yamicon-clock yamicon-x-small" style="margin-right: 4px; margin-top: -3px;"></span>{{text}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/follow_button",["require","underscore","core/lib/backbone_base_view","backbone","core/lib/session","core/lib/tr","models/yammer_model","core/lib/model_helper","core/lib/yammer_api","models/helpers/user","models/user","html!./follow_button_follow","html!./follow_button_unfollow","html!./follow_button_pending"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("backbone"),e=a("core/lib/session"),f=a("core/lib/tr"),g=a("models/yammer_model"),h=a("core/lib/model_helper"),i=a("core/lib/yammer_api"),j=a("models/helpers/user");a("models/user");var k=a("html!./follow_button_follow"),l=a("html!./follow_button_unfollow"),m=a("html!./follow_button_pending");return c.extend({elementClassName:"yj-tristate-button",tagName:"button",className:"yj-btn",attributes:{"data-qaid":"follow_unfollow_button"},defaults:{followTemplate:k,unfollowTemplate:l,pendingTemplate:m,useButtonClassNames:!0},strings:{follow:f.t("follow"),unfollow:f.t("unfollow"),following:f.t("following"),pending:f.t("pending")},events:{click:"handleClick"},initialize:function(a){if(b.bindAll(this,"handleSubscribe","handleUnsubscribe","failureCallback","updateButtonState"),a&&(this.target=a.target),this.model=this.model||{},void 0!==this.model.attributes&&(this.model=b.clone(this.model.attributes)),!(this.model instanceof g)){if(!this.model.id||!this.model.type)return console.error("FollowButton - Missing id or type");if(void 0===this.model.get){var c=h.objectForReference({type:this.model.type,id:this.model.id});c&&(this.model=c)}}void 0===this.options.following&&this.initFollowingState()},initFollowingState:function(){var a=this.model.type||this.model.get&&this.model.get("type");this.options.following=j.isFollowing(e.getCurrentUser(),a,this.model.id);var b=j.getFollowing(e.getCurrentUser(),a);this.listenTo(b,"add push",this.updateButtonState),this.listenTo(b,"reset remove",this.updateButtonState)},render:function(){return this.$el.attr("class",this.className),this.$el.addClass(this.getButtonClassName()),this.options.isSecondary===!0&&this.$el.addClass("yj-btn-alt"),this.$el.attr("title",this.getTooltipText()),this.$el.attr("data-qaid",this.getButtonQaid()),this.$el.html(this.getTemplate()),this},getTemplate:function(){var a;return(a=this.isFollowing()?"pending"===this.isFollowing()?this.options.pendingTemplate:this.options.unfollowTemplate:this.options.followTemplate)(this.getTemplateData())},getTemplateData:function(){return{id:this.model.id,text:this.getButtonText(),mouseoverText:this.strings.unfollow,type:this.model.type}},getButtonClassName:function(){if(this.options.useButtonClassNames){var a=this.options.elementClassName||this.elementClassName;return a+=this.isFollowing()?" yj-follow-buttons yj-unfollow-button yj-btn-alt":" yj-follow-button yj-follow-buttons"}},getButtonText:function(){return this.strings[this.isFollowing()?"following":"follow"]},getButtonQaid:function(){return this.isFollowing()?"unfollow_user_button":"follow_user_button"},getTooltipText:function(){var a;return a=this.isFollowing()?"pending"===this.isFollowing()?f.t("you_will_follow_once_your_request_is_approved"):{page:f.t("stop_receiving_notifications_about_this_note"),uploaded_file:f.t("stop_receiving_notifications_about_this_file"),user:f.t("stop_receiving_posts_from_this_user")}[this.model.type]:{page:f.t("get_notified_of_changes_to_this_note"),uploaded_file:f.t("get_notified_of_changes_to_this_file"),user:f.t("receive_future_posts_from_this_user")}[this.model.type]},isFollowing:function(){var a=e.getCurrentUser(),b=this.model.type||this.model.get&&this.model.get("type");return this.options.following||j.isFollowing(a,b,this.model.id)},setFollowing:function(a){this.options.following=a},updateButtonState:function(){this.$el.removeClass("yj-follow-button yj-unfollow-button yj-follow-btn-pending yj-btn-disabled"),this.$el.addClass(this.getButtonClassName()),this.$el.html(this.getTemplate()),this.$el.attr("title",this.getTooltipText()),this.$el.attr("data-qaid",this.getButtonQaid()),this.$el.blur(),this.trigger("following",this.isFollowing())},handleClick:function(a){a.preventDefault(),this.toggleLoading(!1);var b={target_type:this.model.type,target_id:this.model.record_id||this.model.id};this.options.inHovercard?b.bfr_source="hovercard":this.options.inAvatar?b.bfr_source="avatar":this.options.inNotification?b.bfr_source="notification":this.options.isAggregation&&(b.bfr_source="aggregation");var c=this.model.type||this.model.get&&this.model.get("type"),d=this.isFollowing();d?(i.unsubscribeFromTarget(b).then(this.handleUnsubscribe,this.failureCallback),j.unfollow(e.getCurrentUser(),c,this.model.id)):(i.subscribeToTarget(b).then(this.handleSubscribe,this.failureCallback),j.follow(e.getCurrentUser(),c,this.model.id)),this.setFollowing(!d),this.trigger("following",this.isFollowing())},toggleLoading:function(a){this.$el.parent().toggleClass("yj-loading",a)},isLoading:function(){return this.$el.parent().hasClass("yj-loading")},handleSubscribe:function(){this.toggleLoading(!1),this.updateButtonState();var a=this.getSuccessMessage();a&&a.length>0&&d.trigger("/ui/alert/show","notice",this.getSuccessMessage()),j.follow(e.getCurrentUser(),this.model.type,this.model.id)},handleUnsubscribe:function(){this.toggleLoading(!1),this.updateButtonState(),j.unfollow(e.getCurrentUser(),this.model.type,this.model.id)},getSuccessMessage:function(){return f.t("you_are_now_following_name",{name:this.model.full_name||this.model.name})},failureCallback:function(){this.toggleLoading(!1)},remove:function(){this.toggleLoading(!1),c.prototype.remove.call(this)}})}),define("core/lib/backbone_with_legacy_subviews",["require","underscore","mustache"],function(a){"use strict";var b=a("underscore"),c=a("mustache"),d={},e=function(a){return"LegacySub"+a.cid},f=function(a){return d[a.cid]||(d[a.cid]=[])},g=function(a,b){for(var c=f(a),d=0,e=c.length;e>d;d++)if(c[d].view.cid===b.cid)return d;return 1},h=function(a,c,d){return c.render&&(c.render=b.wrap(c.render,i)),a.call(this,c,d)},i=function(a){var b;return b=a.call(this),k(this),b},j=function(a,b){return o.call(a,this),b.call(this)},k=function(a){var c=f(a);b.each(c,b.partial(l,a))},l=function(a,b){var c=null!=b.selector?a.$(b.selector):a.$el,d=e(b.view);c[b.method]("<"+d+' key="'+d+'"/>')},m=function(a,c,d){var g=e(c);c.remove=b.wrap(c.remove,b.partial(j,this)),f(this).push({method:a,view:c,selector:d}),null==this.views&&(this.views={}),this.views[g]=b.constant(c)},n=function(a){var c=b.pluck(f(a),"view");b.invoke(c,"remove")},o=function(a){var b=e(a);f(this).splice(g(this,a),1),delete this.views[b]},p=function(a){var d;return d=b.isString(this.template)?c.render(this.template,a):this.template(a),this.$el.html(d),this},q=function(){return b.pluck(f(this),"view")},r=function(){return n(this),this},s=function(){this.constructor.extend=b.wrap(this.constructor.extend,h),this.render=b.wrap(this.render,i),this.append=b.partial(m,"append"),this.prepend=b.partial(m,"prepend"),this.children=q,this.empty=r,this.renderTemplate=p,this.add=this.append};return s}),define("feeds/lib/helper/i18n_helper",[],function(){return{addDirectionSupportToElement:function(a,b){var c=b?b:"auto";return a.attr("dir",c),a.find(".yammer-object").attr("dir","auto"),a}}}),define("stache!feeds/lib/ui/shared/message_subheader",["mustache"],function(a){var b='{{#visible}}\n<span class="yj-to-label-wrap yj-to-label-to-line yj-clearfix">\n  <span class="yj-to-label {{#private}}is-private{{/private}}">\n    <span class="yj-to-label">\n    	{{#private}}{{to}} {{privateLabel}}{{/private}}\n      {{^private}}{{to}} {{{recipients}}}{{/private}}\n    </span>\n  </span>\n</span>\n{{/visible}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/shared/message_subheader",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/hovercard_link/index","core/lib/tr","core/lib/treatment","core/lib/session","collections/yammer_collection","html!./message_subheader"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/hovercard_link/index"),g=a("core/lib/tr"),h=a("core/lib/treatment"),i=a("core/lib/session"),j=a("collections/yammer_collection");return c.extend({mixins:[d,e],template:a("html!./message_subheader"),tagName:"span",className:"yj-to-label-wrap yj-to-label-to-line yj-clearfix",views:{HovercardLink:"_getHovercardLink"},initialize:function(){if(!this.model)throw"Message subheader requires a message model";this.collection=new j,this.collection.push(this.model.getGroup()),this._generateUsers()},getTemplateData:function(){var a=this.collection.pluck("id").map(function(a){return'<HovercardLink key="'+a+'" />'});if(this.otherUsers.length){var b=g.t("count_others",{count:this.otherUsers.length});a.push(b)}return{visible:!this.model.system_message,private:this._isPrivate(),recipients:g.tlist(a),to:this._pickTo(),privateLabel:this._pickPrivateLabel()}},_getHovercardLink:function(a){return new f({model:this.collection.get(a)})},_isPrivate:function(){return this.model.isDirectMessage()||!this.model.getGroup()},_generateUsers:function(){var a=this.model.getNotifiedUsers(),b=this.model.getThread(),c=[];b&&(c=b.getInvitedUsers());var d=this._groupUsersByVisibility(a,c);this.collection.add(d.visible),this.otherUsers=d.others},_groupUsersByVisibility:function(a,c){var d=[],e=[],f=15,g=i.getCurrentUser().id;return a=b.sortBy(a,function(a){return b.contains(c,a)?0:1}),a=b.sortBy(a,function(a){return a.id===g?0:1}),a.length+1<=f?d=a:(d=a.slice(0,f-2),e=a.slice(f-2)),{visible:d,others:e}},_pickTo:function(){return this.model.isDirectMessage()?"":this.options.useIn&&1===this.collection.length?g.t("in"):this.options.isAReply?g.t("carbon_copy"):g.t("to")},_pickPrivateLabel:function(){return this.model.isDirectMessage()?h.usePriorityCopy()?g.t("direct_message"):g.t("private_message"):this.model.getGroup()?void 0:g.t("a_private_group")}})}),define("models/helpers/attachment",["require","underscore","core/lib/string_helper","core/lib/filename_helper","core/lib/yammer_config"],function(a){var b=a("underscore"),c=a("core/lib/string_helper"),d=a("core/lib/filename_helper"),e=a("core/lib/yammer_config"),f=function(a,d){if(!d)throw new Error("filterByType requires a type or list of types");var e="string"==typeof d?[d]:d;if(a&&a.length){var f=function(a){for(var b,d=0,f=e.length;f>d;d++)if(b="is"+c.capitalize(e[d]),"function"==typeof this[b]&&this[b](a))return!0;return!1};return b.filter(a,f,this)}return null},g=function(a){var c=[],d=[],e=[],f=[],g=[],h=[],i=[];return b.each(a,function(a){j(a)?c.push(a):l(a)?(d.push(a),m(a)?e.push(a):f.push(a)):(g.push(a),"ymodule"==a.type&&(n(a)?h.push(a):o(a)&&i.push(a)))}),{file:c,image:d,previewableImage:e,nonPreviewableImage:f,note:h,link:i,other:g}},h=function(a){return Boolean(a.height&&a.width&&a.scaled_url&&!e.config().isEmbed)},i=function(a){return a.messages||[]},j=function(a){return"file"===a.type},k=function(a){return"uploaded_file"===a.type},l=function(a){return"image"==a.type||a.content_class&&"image"==a.content_class.toLowerCase()},m=function(a){var c,e;return l(a)?(c=["png","jpg","jpeg","gif"],e=a.extension||d.getExtension(a.name||a.fileName),e=e&&e.toLowerCase(),"Image"==a.content_class&&b.contains(c,e)):!1},n=function(a){return"ymodule"===a.type&&"page"===a.real_type||"page"===a.type},o=function(a){return"ymodule"===a.type&&"page"===a.object_type},p=function(a){return a.ymodule&&a.ymodule.web_app_id&&"open_graph_object"===a.ymodule.web_app_id},q=function(a){return p(a)&&!!a.video_url},r=function(a){return p(a)&&!!a.client_application_icon},s=function(a){return"praise"===a.type},t=function(a){return"sticker"===a.type},u=function(a,b){return b&&b.id===a.owner_id},v=function(a,b){return Boolean(a.edit_url)&&!!b.getCurrentNetwork()&&Boolean(b.getCurrentNetwork().paid)&&(!x(a,b)||u(a,b.getCurrentUser()))},w=function(a){return"private"===a.privacy},x=function(a,b){return null!=a.network_id&&a.network_id!=b.getCurrentNetwork().id};return{filterByType:f,groupByType:g,isSpotlightImage:h,getMessages:i,isFile:j,isUploadedFile:k,isImage:l,isPreviewableImage:m,isNote:n,isLink:o,isOgo:p,isVideoOgo:q,isThirdPartyOgo:r,isPraise:s,isSticker:t,isOwnedByUser:u,isEditable:v,isPrivate:w,isForeign:x}}),define("stache!feeds/lib/ui/shared/message_excerpt",["mustache"],function(a){var b="<div class='yj-thread-share-excerpt yj-clearfix'>\n  <div class='yj-thread-share-avatar'>\n    <Avatar />\n  </div>\n  <div class='yj-thread-share-excerpt-container'>\n    {{#foreign}}\n      <span class='yj-private-icon-to-line universal-publisher'>\n        <span class='yamicon yamicon-network' />\n      </span>\n    {{/foreign}}\n    {{^foreign}}\n      {{#privateGroup}}\n        <span data-desc='Only visible to this group.' class='yj-private-icon-to-line universal-publisher'>\n          <span class='yamicon yamicon-lock yamicon-inline'></span>\n          {{private}}\n        </span>\n      {{/privateGroup}}\n    {{/foreign}}\n    <div class='yj-thread-share-sender-name'><HovercardLink /></div>\n    <MessageSubheader />\n    <div class='yj-excerpt-content'>\n      {{#title}}\n      <span class='yj-message-title'>\n        {{{title}}}\n      </span>\n      {{/title}}\n      {{{ content }}}\n      {{^content}}{{#shared}}{{shareAttachedLabel}}{{/shared}}{{/content}}\n    </div>\n    <div class='yj-excerpt-options'>\n      <a href='{{ threadUrl }}'>{{viewFullConversationLabel}}</a>\n      <div class='yj-excerpt-action-container'>\n      {{#comments}}\n        <span class='yj-excerpt-action--icon yamicon yamicon-rd_more_replies'><span class='yj-acc-hidden'>{{ replies }}</span></span>\n        <span class='yj-excerpt-action--count yj-comments-count'>{{ comments }}</span>\n      {{/comments}}\n      {{#likes}}\n        <span class='yj-excerpt-action--icon yamicon yamicon-rd_like'><span class='yj-acc-hidden'>{{ likes }}</span></span>\n        <span class='yj-excerpt-action--count yj-likes-count'>{{ likes }}</span>\n      {{/likes}}\n      </div>\n    </div>\n  </div>\n</div>\n";return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/shared/message_excerpt",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/hovercard_link/index","components/avatar/index","./message_subheader","core/lib/tr","core/lib/urls","models/helpers/attachment","html!./message_excerpt"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/hovercard_link/index"),g=a("components/avatar/index"),h=a("./message_subheader"),i=a("core/lib/tr"),j=a("core/lib/urls"),k=a("models/helpers/attachment");return c.extend({mixins:[d,e],template:a("html!./message_excerpt"),views:{HovercardLink:"_getHovercardLink",Avatar:"_getAvatar",MessageSubheader:"_getMessageSubheader"},initialize:function(){if(!this.model||!this.options.thread)throw"Message excerpt requires a message model and a thread";this.sender=this._getSender()},getTemplateData:function(){return{sender:this.sender,shared:this.model.hasAttachmentOfType("message"),title:this._getTitle(),foreign:this.model.isForeign(),privateGroup:this._isPrivate(),content:this._getContent(),likes:this._getLikes(),comments:this.options.thread.stats.updates-1,threadUrl:j.thread(this.options.thread),shareAttachedLabel:i.t("share_attached"),viewFullConversationLabel:i.t("view_full_conversation")}},_getHovercardLink:function(){return new f({model:this.sender})},_getAvatar:function(){return new g({model:this.sender,hideFromAccessibility:!0})},_getMessageSubheader:function(){return new h({model:this.model,useIn:!0,isAReply:!1})},_getSender:function(){var a=this.model.getSender();return"user"===a.type?a.getUser():"guide"===a.type?a.getGuide():null},_getTitle:function(){return this.model.title&&"announcement"===this.model.message_type?b.escape(this.model.title):null},_getContent:function(){var a=k.filterByType(this.model.getAttachments(),["file","image","note","link"]);return a=a&&a.length?b.escape(a[0].name):"",this.model.getHtmlBody()||this.model.content_excerpt||a},_getLikes:function(){return isNaN(this.model.liked_by)?this.model.liked_by?this.model.liked_by.count:this.model.getLikes().length:this.model.liked_by},_isPrivate:function(){return this.model.isDirectMessage()||!this.model.getGroup()}})}),define("stache!feeds/lib/ui/shared/excerpt_attachmentTemplate",["mustache"],function(a){var b='<div class="yj-yamio-preview"><div class="yj-thumbnail"><div class="yj-wrapper"><div class="yj-img-container">{{#thumbnailUrl}}<img src="{{thumbnailUrl}}" data-qaid="attachment_thumbnail" alt="" {{#imageClass}}class="{{imageClass}}"{{/imageClass}}/>{{/thumbnailUrl}}{{^thumbnailUrl}}<img src="{{largeIconUrl}}" data-qaid="attachment_thumbnail_icon" alt="" class="yj-icon" /><span class="yj-icon-file-ext">{{extension}}</span>{{/thumbnailUrl}}</div></div></div><div class="yj-yamio-content"><div class="yj-yamio-middle"><div class="yj-yamio-inner">{{#name}}<span class="yj-name"><span>{{name}}</span></span>{{/name}}{{#subtitle}}<div class="yj-subtitle"><span>{{{subtitle}}}</span></div>{{/subtitle}}{{#description}}<p class="yj-description"><span>{{description}}</span></p>{{/description}}</div></div></div><div class="yj-clear"></div></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/shared/excerpt_graphObjectExcerptTemplate",["mustache"],function(a){var b='<div class="yj-yamio-preview yj-open-graph-object yj-open-graph-object-excerpt {{^thumbnailUrl}}has-no-image yj-open-graph-no-image{{/thumbnailUrl}}">\n  {{#thumbnailUrl}}\n    <div class="yj-thumbnail">\n      <div class="yj-wrapper">\n        <div class="yj-img-container" style="background-image: url({{thumbnailUrl}})">\n          <img src="{{thumbnailUrl}}" alt="" class="yj-thumbnail--sizer"/>\n        </div>\n      </div>\n    </div>\n  {{/thumbnailUrl}}\n  <div class="yj-yamio-content">\n    {{#subtitle}}\n      <div class="yj-subtitle">\n        <span>{{{subtitle}}}</span>\n      </div>\n    {{/subtitle}}\n    {{#name}}\n      <span class="yj-name" aria-hidden="true">\n        <span>{{name}}</span>\n      </span>\n    {{/name}}\n    {{#description}}\n      <p class="yj-description">\n        <span>{{description}}</span>\n      </p>\n    {{/description}}\n  </div>\n</div>\n';
return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/shared/excerpt_pageExcerptTemplate",["mustache"],function(a){var b='<div class="yj-page-inline-view yj-yamio-preview">\n  <div class="yj-page-inline-view--thumbnail yj-thumbnail" aria-hidden="true">\n    <div class="yj-page-inline-view--icon">\n      {{{svgIconThumbnail}}}{{! generated HTML }}\n    </div>\n  </div>\n  <div class="yj-page-inline-view--content yj-yamio-content">\n    <div class="yj-yamio-inner">\n      {{#subtitle}}\n      <h6 class="yj-page-inline-view--content--subtitle yj-subtitle" role="presentation">\n        {{{subtitle}}}\n      </h6>\n      {{/subtitle}}\n      {{#title}}\n        <span class="yj-page-inline-view--name yj-name">\n          {{title}}\n        </span>\n      {{/title}}\n    </div>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/shared/excerpt_deleted",["mustache"],function(a){var b='<div class="yj-thread-share-excerpt is-deleted">\n  {{{deletedIcon}}}{{! HTML generated from svg_icon }}\n  <h6 role="presentation" class="yj-thread-share-excerpt--deleted-message">{{message}}</h6>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/shared/excerpt",["require","underscore","models/attachment","collections/groups","models/group","components/hovercard_link/index","feeds/lib/helper/i18n_helper","models/message","models/shared_message","core/lib/string_helper","core/lib/filename_helper","core/lib/tr","./message_excerpt","common-ui/lib/helper/svg_icon","core/lib/urls","core/lib/yammer_uri","html!./excerpt_attachmentTemplate","html!./excerpt_graphObjectExcerptTemplate","html!./excerpt_pageExcerptTemplate","html!./excerpt_deleted"],function(a){var b=a("underscore"),c=a("models/attachment"),d=a("collections/groups"),e=a("models/group"),f=a("components/hovercard_link/index"),g=a("feeds/lib/helper/i18n_helper"),h=a("models/message"),i=a("models/shared_message"),j=a("core/lib/string_helper"),k=a("core/lib/filename_helper"),l=a("core/lib/tr"),m=a("./message_excerpt"),n=a("common-ui/lib/helper/svg_icon"),o=a("core/lib/urls"),p=a("core/lib/yammer_uri"),q={},r=a("html!./excerpt_attachmentTemplate"),s=a("html!./excerpt_graphObjectExcerptTemplate"),t=a("html!./excerpt_pageExcerptTemplate"),u=a("html!./excerpt_deleted");return q.generateExcerpt=function(a,b,c,g){function h(a,b,c,g){var h,i,j,m;if(a=a.findById(b),!a&&!g)throw"Object is not found";a||(a=g),void 0!==a.group_id&&(h=a.group_id?d.get(a.group_id):e.ALL_COMPANY(),m=new f({model:h}),i=l.t("uploaded_to_container",{container:h&&m.render().el.innerHTML+' <span aria-hidden="true">▸</span> <a href="'+o.groupFiles(h)+'">'+l.t("files")+"</a>"}));var n="";"Document"===a.content_class&&(n="yj-document-thumbnail"),j={thumbnailUrl:a.thumbnail_url,largeIconUrl:a.large_icon_url||p.cdn("assets/images/file_icons/file.png"),name:a.full_name||a.name,imageClass:n,subtitle:i,description:a.description,extension:k.getExtension(a.name||a.fileName)},c(r(j))}a=j.capitalize(j.camelize(a));var i=yam.model[a];if(!i)throw new Error("generateExcerpt needs a model");h(i,b,c,g)},q.generateMessageExcerpt=function(a,c){var d={deletedIcon:n("docicon-big-delete",{width:60,height:60,classList:"yj-thread-share-excerpt--deleted-icon"})};if(null===a)return void c(u(b.extend({message:l.t("the_attached_conversation_has_been_deleted")},d)));var e,f=i.findById(a),j=h.findById(a),k=u(b.extend({message:l.t("there_was_a_problem_with_this_attachment")},d));if(null==f&&null==j)return void c(k);if(f?(j=f,e=j.getSharedThread()):e=j.getThread(),!e)return void c(k);var o,p=new m({model:j,thread:e});if(o=p.render().$el,!j.isSystemMessage()){var q=j.getTextDirection();g.addDirectionSupportToElement(o.find(".yj-excerpt-content"),q)}c(o)},q.generateOpenGraphObjectExcerpt=function(a,d,e){var f,g=c.findById(a);if(!g&&!e)throw"Message for excerpt is not in repo";if(g||(g=e),!g.group_id&&g.messages.length){var i=h.findById(g.messages[0].id);i.group_id&&(g.group_id=i.group_id)}var k,l=g.image||g.thumbnail_url,m=g.client_application_icon;l?k=l:m&&(k=m),f={thumbnailUrl:k,name:j.truncate(g.full_name||g.name,90),subtitle:j.truncate(g.host_url,40),description:j.truncate(g.description,150,{truncateOnWords:!0})};var n=s(f);d(n,b.noop)},q.generatePageExcerpt=function(a,c,g){var h,i,j,k;if(!g)throw"Message for excerpt is not in repo";h=g.group_id&&"undefined"!=g.group_id?d.get(g.group_id):e.ALL_COMPANY(),k=new f({model:h}),i=l.t("posted_in_container",{container:h&&k.render().el.innerHTML+' <span aria-hidden="true">▸</span> <a href="'+b.escape(o.groupIndex(h)+"/notes")+'">'+l.t("notes")+"</a>"}),j={image:g.image,title:g.title,subtitle:i,svgIconThumbnail:n("docicon-big-note",{classList:"yj-yamio-preview--svg-icon-thumbnail"})},c(t(j))},q}),define("css!feeds/lib/ui/publisher/global/excerpt_container",[],function(){}),define("feeds/lib/ui/publisher/global/excerpt_container",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","backbone","feeds/lib/ui/shared/excerpt","css!./excerpt_container"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("backbone"),h=a("feeds/lib/ui/shared/excerpt");a("css!./excerpt_container");var i={CONVERSATION:"thread",FILE:"file",LINK:"link",NOTE:"note"},j=d.extend({mixins:[e,f],className:"yj-global-excerpt-container",initialize:function(a){if(this._type=a.type,this._createExcerpt=this._getExcerptCreator(),null==this._createExcerpt)throw new Error("ExcerptContainer must be given a valid type");this._addTypeClass(),this._setupListeners()},render:function(){return this._createExcerpt(this.model),this},_setupListeners:function(){var a=this._getCollectionForExcerptType();this.listenTo(a,"add remove reset change",this.render)},_getConversationExcerptCreator:function(){return function(a){var b=a.get("ogos"),c=b.first();if(null!=c){var d=c.get("sharedMessageId");if(null!=d){var e=this;h.generateMessageExcerpt(d,function(a){e._handleExcerpt(a)})}}}},_getFileExcerptCreator:function(){return function(a){var b=a.get("files"),c=b.first();if(null!=c){var d=this;h.generateExcerpt(c.get("type"),c.getId(),function(a){d._handleExcerpt(a)},c.toJSON())}}},_getLinkExcerptCreator:function(){return function(a){var c=a.get("ogos"),d=c.first();if(null!=d){var e=d.get("excerptId")||d.getId(),f=this;h.generateOpenGraphObjectExcerpt(e,function(a,c){var d=b(a);c(d),f._handleExcerpt(d)},d.toJSON())}}},_getNoteExcerptCreator:function(){return function(a){var b=a.get("files"),c=b.first();if(null!=c){var d=this;h.generatePageExcerpt(c.getId(),function(a){d._handleExcerpt(a)},c.toJSON())}}},_getExcerptCreator:function(){switch(this._type){case i.CONVERSATION:return this._getConversationExcerptCreator();case i.FILE:return this._getFileExcerptCreator();case i.LINK:return this._getLinkExcerptCreator();case i.NOTE:return this._getNoteExcerptCreator()}},_getCollectionForExcerptType:function(){switch(this._type){case i.CONVERSATION:return this.model.get("ogos");case i.FILE:return this.model.get("files");case i.LINK:return this.model.get("ogos");case i.NOTE:return this.model.get("files")}},_addTypeClass:function(){var a="";switch(this._type){case i.CONVERSATION:a="yj-global-thread-excerpt";break;case i.FILE:a="yj-global-file-excerpt";break;case i.LINK:a="yj-global-link-excerpt";break;case i.NOTE:a="yj-global-note-excerpt"}this.$el.addClass(a)},_handleExcerpt:function(a){a instanceof jQuery||(a=b(a)),a.find(".expand-body").replaceWith("<span>&hellip;</span>"),c.each(a.find("a"),function(a){a.setAttribute("target","_blank")}),this.$el.empty().append(a),g.trigger("/ui/lightbox/resize")}});return j.TYPE=i,j}),define("models/recipient",["require","underscore","backbone","core/lib/log","core/lib/namespace","core/lib/session","models/helpers/user","models/network"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/log"),e=a("core/lib/namespace"),f=a("core/lib/session"),g=a("models/helpers/user"),h=a("models/network"),i="COMPANY_GROUP_ID",j={PUBLIC_GROUP:"public_group",PRIVATE_GROUP:"private_group",USER:"user",DOMAIN:"domain"},k=b.object([[j.PUBLIC_GROUP,"g"],[j.PRIVATE_GROUP,"g"],[j.USER,"u"],[j.DOMAIN,"d"]]),l=0,m=c.Model.extend({defaults:{external:!1,mention:!1,fixed:!1,foreign:!1,type:"recipient"},initialize:function(a){if(a=a||{},!a.id)throw new Error("Recipient models must have an ID");if(!a.type)throw new Error("Recipient models must have a type");this._maintainId(),this._maintainForeign(),this.listenTo(this,"change:id",this._maintainId),this.listenTo(this,"change:type",this._maintainId),this.listenTo(this,"change:networkId",this._maintainForeign),this._storeCreationOrder()},getId:function(){return this.get("realId")},getNetworkName:function(){var a;switch(this.getType()){case j.PUBLIC_GROUP:case j.PRIVATE_GROUP:a=this.get("networkName");break;case j.USER:case j.DOMAIN:a=g.getNetworkName(this,h)}return a},getType:function(){return this.get("type")},isForeign:function(){return g.isForeign(this,f)},hasFailed:function(){return"failed"===this.get("status")},toJSON:function(){var a,d=c.Model.prototype.toJSON.call(this),e=this.getType();return e!==j.PRIVATE_GROUP&&e!==j.PUBLIC_GROUP||(a=e===j.PRIVATE_GROUP?"private":"public"),b.extend(b.omit(d,"realId"),{id:this.getId(),privacy:a})},toOriginalHash:function(){var a=b.extend(this.toJSON(),{full_name:this.get("name"),network_id:this.get("networkId")});switch(a=b.omit(a,"name","privacy","order","networkId"),null==a.network_id&&delete a.network_id,a.type){case j.USER:a.type="user";break;case j.PUBLIC_GROUP:a.type="group",a.privacy="public";break;case j.PRIVATE_GROUP:a.type="group",a.privacy="private"}return a},_maintainId:function(){var a=this.get("id"),b=this.get("type"),c=k[b];"undefined"!=typeof a&&(a=""+a,a.match(/[a-z]:/)&&(a=a.substring(2)),isNaN(a)||(a=parseInt(a,10)),this.set({id:c+":"+a,realId:a},{silent:!0}))},_maintainForeign:function(){var a=f.getCurrentNetwork(),c=this.get("networkId"),d=this.get("foreign")||a&&c&&c!=a.id;d&&(this.set("foreign",!0),-1!==b.indexOf([j.USER,j.DOMAIN],this.get("type"))&&this.set("external",!0))},_storeCreationOrder:function(){this.set("order",l++)}});return m.fromOriginalModel=function(a){if(null==a)return void d.warn("Recipient.fromOriginalModel was not given a valid model");void 0===a.get&&(a=new yam.backbone.model.YammerModel(a));var c={id:a.get("id"),email:a.get("email"),foreign:a.get("foreign"),name:a.get("name"),state:a.get("state"),type:a.get("type")};return b.extend(c,{permalink:c.name,name:a.get("full_name")||c.name,networkId:a.get("network_id"),networkName:a.get("network_name"),groupIds:b.map(a.get("group_ids"),function(a){return parseInt(a,10)})}),"group"===c.type&&(a.private||"private"===a.get("privacy")||a.get("private")===!0?c.type=j.PRIVATE_GROUP:c.type=j.PUBLIC_GROUP,c.fixed=a.get("fixed"),c.external=!!a.get("external")),new m(c)},m.ALL_COMPANY_ID=i,m.TYPE=j,e.ns("yam.backbone.model"),yam.backbone.model.Recipient=m,m}),define("collections/recipients",["require","underscore","backbone","models/recipient","core/lib/namespace"],function(a){var b=a("underscore"),c=a("backbone"),d=a("models/recipient"),e=a("core/lib/namespace"),f=d.TYPE,g={EMPTY:"empty",ALL_COMPANY:"all_company",ALL_COMPANY_WITH_EXTERNAL:"all_company_with_external",PUBLIC_GROUP:"public_group",PUBLIC_GROUP_WITH_EXTERNAL:"public_group_with_external",PRIVATE_GROUP:"private_group",PRIVATE_GROUP_WITH_EXTERNAL:"private_group_with_external",PRIVATE_MESSAGE:"private_message",PRIVATE_MESSAGE_WITH_EXTERNAL:"private_message_with_external",PRIVATE_MESSAGE_WITH_MENTIONS:"private_message_with_mentions"},h=c.Collection.extend({model:d,comparator:function(a){switch(a.get("type")){case f.PUBLIC_GROUP:case f.PRIVATE_GROUP:return-1;default:return a.get("order")}},whereContains:function(a,c){return b.isEmpty(a)?c?void 0:[]:this[c?"find":"filter"](function(c){var d,e,f;for(d in a)if(e=a[d],f=c.get(d),b.isArray(e)){if(!b.contains(e,f))return!1}else if(e!==f)return!1;return!0})},findWhereContains:function(a){return this.whereContains(a,!0)},get:function(a,b){return a&&b?this.findWhere({realId:a,type:b}):c.Collection.prototype.get.call(this,a)},getType:function(){var a=d.TYPE,b=this.findWhere({type:a.PUBLIC_GROUP}),c=this.findWhere({type:a.PRIVATE_GROUP}),e=this.findWhereContains({type:[a.USER,a.DOMAIN]}),f=this.findWhereContains({type:[a.USER,a.DOMAIN],external:!0}),h=this.findWhereContains({type:[a.USER,a.DOMAIN],mention:!0}),i=this.findWhere({foreign:!0}),j=g.EMPTY;return b&&"COMPANY_GROUP_ID"===b.getId()?j=i?g.ALL_COMPANY_WITH_EXTERNAL:g.ALL_COMPANY:b?j=i?g.PUBLIC_GROUP_WITH_EXTERNAL:g.PUBLIC_GROUP:c&&(i||f)?j=g.PRIVATE_GROUP_WITH_EXTERNAL:c?j=g.PRIVATE_GROUP:e&&(i||f)?j=g.PRIVATE_MESSAGE_WITH_EXTERNAL:e&&h?j=g.PRIVATE_MESSAGE_WITH_MENTIONS:e&&(j=g.PRIVATE_MESSAGE),j}});return h.TYPE=g,e.ns("yam.backbone.collection"),yam.backbone.collection.Recipients=h,h}),define("models/thread_backbone",["require","underscore","backbone","core/lib/log","core/lib/namespace","models/recipient","collections/recipients","core/lib/session","models/user","models/group","models/lib/orm-models","models/lib/events","models/helpers/conversation"],function(a){"use strict";var b=a("underscore"),c=a("backbone"),d=a("core/lib/log"),e=a("core/lib/namespace"),f=a("models/recipient"),g=a("collections/recipients"),h=a("core/lib/session"),i=a("models/user"),j=a("models/group"),k=a("models/lib/orm-models"),l=a("models/lib/events"),m=a("models/helpers/conversation"),n=c.Model.extend({defaults:{direct:!1,type:"thread"},initialize:function(a){a=a||{},null==a.implicitRecipients&&this.set("implicitRecipients",new g)},isDirect:function(){return this.get("direct")},isForeign:function(){var a=this.get("foreign");if(null!=a)return a;var b=this.get("networkId");return null!=b&&b!=h.getCurrentNetwork().id}}),o=function(a){var b=a.network_id||a.getThreadStarter().network_id;return k.Network().findById(b)},p=function(a,b){var c=!!a.direct_message,d=a.isForeign(),e=a.getGroup();return null!=e||c||(e=j.ALL_COMPANY()),null!=e?f.fromOriginalModel(e).set({foreign:d,implicit:!0,networkId:b&&b.id}):void 0};return n.fromOriginalModel=function(a){if(null==a)return void d.warn("Thread.fromOriginalModel was not given an ORM thread model");var e=a.id,h=o(a),j=a.isForeign(),q=!!a.direct_message,r=new g,s=a.thread_starter_id,t=function(){var c=p(a,h),d=b.compact([c]),e=q?m.getParticipants(a):[];e=b.map(e,function(a){return a?f.fromOriginalModel(i.save(a)).set({implicit:!0}):void 0});var g=a.getInvitedUsers();g=b.map(g,function(a){return(a=f.fromOriginalModel(a))?(a.set({implicit:!0}),a):void 0});var j=b.map(a.getForeignUsers(),function(a){return a=f.fromOriginalModel(a),a&&a.set({foreign:!0,implicit:!0}),a});if(a.isForeign()){var l=k.Message().findById(a.id),n=l&&k.User().findById(l.sender_id);n&&j.unshift(f.fromOriginalModel(n))}r.reset(b.compact(b.union(d,e,g,j)))};t(),c.listenTo(l,"Thread/"+a.id+"/update",t);var u=n.extend({cleanup:function(){c.stopListening(l,null,t)}});return new u({id:e,networkId:h&&h.id,foreign:j,direct:q,implicitRecipients:r,threadStarterId:s})},e.ns("yam.backbone.model"),yam.backbone.model.Thread=n,n}),define("models/feed_backbone",["require","backbone","models/helpers/feed","core/lib/namespace"],function(a){var b=a("backbone"),c=a("models/helpers/feed"),d=a("core/lib/namespace"),e=b.Model.extend({getLogSource:function(){return c.getLogSource(this.get("keyType"))},getId:function(){return this.get("id")}});return e.fromOriginalModel=function(a){return new e({id:a.id,keyType:a.keyType})},d.ns("yam.backbone.model"),yam.backbone.model.Feed=e,e}),define("models/file_backbone",["require","underscore","backbone","core/lib/log","core/lib/namespace"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/log"),e=a("core/lib/namespace"),f={FILE:"uploaded_file",NOTE:"page"},g=b.object([[f.FILE,"u"],[f.NOTE,"p"]]),h=c.Model.extend({defaults:{type:"file",fixed:!1},initialize:function(a){if(a=a||{},null==a.type)throw new Error("File models must have a type");this._maintainId(),this.listenTo(this,"change:id",this._maintainId),this.listenTo(this,"change:type",this._maintainId)},getId:function(){return this.get("realId")},getType:function(){return this.get("type")},_maintainId:function(){var a=this.get("id"),b=this.get("type"),c=g[b];"undefined"!=typeof a&&(a=""+a,a.match(/[a-z]:/)&&(a=a.substring(2)),isNaN(a)||(a=parseInt(a,10)),this.set({id:c+":"+a,realId:a},{silent:!0}))},toJSON:function(){var a=c.Model.prototype.toJSON.call(this);return b.extend(b.omit(a,"realId"),{id:this.getId()})},isHydrated:function(){return 100===this.get("progress")}});return h.fromOriginalModel=function(a){return null==a?void d.warn("File.fromOriginalModel was not given an original"):new h({id:a.id,type:a.real_type||a.type,name:a.name,description:a.description,thumbnail_url:a.thumbnail_url,progress:100,fixed:a.fixed||!1})},h.TYPE=f,e.ns("yam.backbone.model"),yam.backbone.model.File=h,h}),define("collections/files",["require","backbone","models/file_backbone","core/lib/namespace"],function(a){var b=a("backbone"),c=a("models/file_backbone"),d=a("core/lib/namespace"),e=b.Collection.extend({model:c,get:function(a,c){return a&&c?this.findWhere({realId:a,type:c}):b.Collection.prototype.get.call(this,a)}});return d.ns("yam.backbone.collection"),yam.backbone.collection.Files=e,e}),define("models/ogo",["require","underscore","backbone","core/lib/log","core/lib/namespace"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/log"),e=a("core/lib/namespace"),f=c.Model.extend({defaults:{type:"open_graph_object",fixed:!1},initialize:function(){this._maintainId(),this.listenTo(this,"change:id",this._maintainId)},getId:function(){return this.get("realId")},_maintainId:function(){var a=this.get("id"),b="o";"undefined"!=typeof a&&(a=""+a,a.match(/[a-z]:/)&&(a=a.substring(2)),isNaN(a)||(a=parseInt(a,10)),this.set({id:b+":"+a,realId:a},{silent:!0}))},toJSON:function(){var a=c.Model.prototype.toJSON.call(this);return b.extend(b.omit(a,"realId"),{id:this.getId()})},isHydrated:function(){return 100===this.get("progress")}});return f.fromOriginalModel=function(a){return null==a?void d.warn("Ogo.fromOriginalModel was not given an original"):new f({id:a.id,url:a.web_url,type:a.type,host:a.host_url,name:a.title||a.full_name,description:a.hasOwnProperty("description")?a.description:a.web_url,thumbnail:a.thumbnail||a.image,progress:100,media_height:a.media_height,media_type:a.media_type,media_url:a.media_url,media_width:a.media_width,official_name:a.official_name,site_name:a.site_name,is_first_party:a.is_first_party,private:a.private,title_and_desc_editable:a.title_and_desc_editable,provided_url:a.provided_url,provider_name:a.provider_name,provider_url:a.provider_url,fetch:a.fetch,ignore_canonical_url:a.ignore_canonical_url,fixed:a.fixed||!1})},e.ns("yam.backbone.model"),yam.backbone.model.Ogo=f,f}),define("collections/ogos",["require","backbone","models/ogo","core/lib/namespace"],function(a){var b=a("backbone"),c=a("models/ogo"),d=a("core/lib/namespace"),e=b.Collection.extend({model:c});return d.ns("yam.backbone.collection"),yam.backbone.collection.Ogos=e,e}),define("models/topic_backbone",["require","backbone","core/lib/namespace","core/lib/session"],function(a){var b=a("backbone"),c=a("core/lib/namespace"),d=a("core/lib/session"),e=b.Model.extend({defaults:{type:"topic"},isForeign:function(){var a=this.get("network_id");return a&&a!==d.getCurrentNetwork().id},getNetworkName:function(){return this.get("network_name")}});return e.fromOriginalModel=function(a){var b=a.id,c=a.url,d=a.name;return new e({id:b,url:c,name:d})},c.ns("yam.backbone.model"),yam.backbone.model.Topic=e,e}),define("collections/topics",["require","backbone","models/topic_backbone","core/lib/namespace"],function(a){var b=a("backbone"),c=a("models/topic_backbone"),d=a("core/lib/namespace"),e=b.Collection.extend({model:c});return d.ns("yam.backbone.collection"),yam.backbone.collection.Topics=e,e}),define("models/message_backbone",["require","underscore","backbone","core/lib/log","models/group","models/thread_backbone","models/feed_backbone","collections/recipients","collections/files","collections/groups","collections/ogos","collections/topics","core/lib/session","core/lib/namespace","core/lib/tr"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/log"),e=a("models/group"),f=a("models/thread_backbone"),g=a("models/feed_backbone"),h=a("collections/recipients"),i=a("collections/files"),j=a("collections/groups"),k=a("collections/ogos"),l=a("collections/topics"),m=a("core/lib/session"),n=a("core/lib/namespace"),o=a("core/lib/tr"),p={LINK:"link",FILE:"file"},q=yam.backbone.model.Recipient.TYPE,r=yam.backbone.collection.Recipients.TYPE,s=c.Model.extend({defaults:{body:"",state:void 0,type:"message"},initialize:function(a){a=a||{},this.set("allRecipients",new h),null==a.recipients&&this.set("recipients",new h),null==a.files&&this.set("files",new i),null==a.ogos&&this.set("ogos",new k),null==a.topics&&this.set("topics",new l),null!=a.poll&&this.listenTo(a.poll,"change",b.bind(function(){this.trigger("change:poll"),this.trigger("change")},this)),null!=a.praise&&(this.listenTo(a.praise,"change",b.bind(function(){this.trigger("change:praise"),this.trigger("change")},this)),this.listenTo(a.praise.get("recipients"),"add remove reset",this._updateRecipients)),null!=a.announcement&&this.listenTo(a.announcement,"change",b.bind(function(){this.trigger("change:announcement"),this.trigger("change")},this)),null!=a.thread&&this.listenTo(a.thread,"change",b.bind(function(){this.trigger("change:thread"),this.trigger("change")},this));var c=this.get("recipients"),d=this.getImplicitRecipients();this._updateRecipients(),this.listenTo(c,"add remove reset",this._updateRecipients),null!=d&&this.listenTo(d,"add remove reset",this._updateRecipients)},getType:function(){var a=this.get("allRecipients").getType();return a===r.PRIVATE_MESSAGE_WITH_MENTIONS&&null==this.findRecipient({implicit:!1,mention:!0})&&(a=r.PRIVATE_MESSAGE),a},getFeed:function(){return this.get("feed")},getThread:function(){return this.get("thread")},isReply:function(){return!!this.get("original")},isReplyToThreadStarter:function(){var a=this.getThread(),b=this.get("original");return a&&b?b.get("id")===a.get("threadStarterId"):!1},getImplicitRecipients:function(){var a=this.get("thread");if(a)return a.get("implicitRecipients")},findRecipient:function(){var a=this.get("allRecipients");return a.findWhereContains.apply(a,arguments)},findRecipients:function(){var a=this.get("allRecipients");return a.whereContains.apply(a,arguments)},getGroup:function(){if(!this.isDirectMessage()){var a=this.findRecipient({type:[q.PUBLIC_GROUP,q.PRIVATE_GROUP]});return a?this._groupFromRecipient(a):this._groupFromId()}},_groupFromRecipient:function(a){return j.get(a.getId())||new e(a.toJSON())},_groupFromId:function(){return this.get("group_id")?this._privateGroupPlaceholder():this._allCompanyGroup()},_privateGroupPlaceholder:function(){return new e({id:this.get("group_id"),full_name:o.t("a_private_group"),privacy:"private"})},_allCompanyGroup:function(){return e.ALL_COMPANY().set("network_id",this.get("network_id"))},getInvitedUsers:function(){var a=[],c=[q.USER,q.DOMAIN];switch(this.getType()){case q.PRIVATE_MESSAGE:a=this.findRecipients({type:q.USER,external:!0,implicit:!0,foreign:!1});break;case r.PRIVATE_MESSAGE_WITH_EXTERNAL:var d=this.findRecipients({type:c,external:!0,foreign:!1}),e=this.findRecipients({type:q.USER,mention:!0,foreign:!1});a=b.union(d,e);break;case r.PRIVATE_MESSAGE_WITH_MENTIONS:a=this.findRecipients({type:c,mention:!0,foreign:!1});break;default:if(a=this.findRecipients({type:c,external:!0,foreign:!1}),!this.hasBeenSubmitted()){var f=m.getCurrentUser().id,g=b.find(a,function(a){return a.getId()==f});g&&(a=b.without(a,g))}}return a},getForeignUsers:function(){return this.findRecipients({type:[q.USER,q.DOMAIN],foreign:!0})},isBeingSubmitted:function(){return"submitting"===this.get("state")},hasBeenSubmitted:function(){return"submitted"===this.get("state")},hasFailed:function(){return"failed"===this.get("state")},hasBody:function(){var a=this.get("body");return null!=a&&a.replace(/^\s+|\s+$/gm,"").length>0},hasGroup:function(){return!!this.getGroup()},hasForeignRecipients:function(){return this.getForeignUsers().length>0},hasRecipients:function(){return this.get("recipients").length>0},hasMultipleRecipients:function(){return this.get("recipients").length>1},hasNonFixedRecipients:function(){return this._collectionContainsNonFixedValues(this.get("recipients"))},hasMultipleNonFixedRecipients:function(){return this.get("recipients").where({fixed:!1}).length>1},hasFiles:function(){return this.get("files").length>0},hasFilesInProgress:function(){return this.get("files").some(function(a){var c=a.get("progress");return b.isFinite(c)&&100>c})},hasNonFixedFiles:function(){return this._collectionContainsNonFixedValues(this.get("files"))},hasOgos:function(){return this.get("ogos").length>0},hasOgosInProgress:function(){return this.get("ogos").some(function(a){var c=a.get("progress");return b.isFinite(c)&&100>c})},hasNonFixedOgos:function(){return this._collectionContainsNonFixedValues(this.get("ogos"))},hasPoll:function(){var a=this.get("poll");return null!=a&&a.get("enabled")},hasNonEmptyPoll:function(){var a=this.get("poll");return null!=a&&!a.isEmpty()},hasValidPoll:function(){var a=this.get("poll");return null!=a&&a.isValid()},hasPraise:function(){var a=this.get("praise");return null!=a&&a.get("enabled")},hasNonEmptyPraise:function(){var a=this.get("praise");return null!=a&&!a.isEmpty()},hasValidPraise:function(){var a=this.get("praise");return null!=a&&a.isValid()},hasAnnouncement:function(){var a=this.get("announcement");return null!=a&&a.get("enabled")},hasNonEmptyAnnouncement:function(){var a=this.get("announcement");return null!=a&&!a.isEmpty()},hasUnsubmittedContent:function(){return!this.isEmpty()&&!this.hasBeenSubmitted()},hasValidAnnouncement:function(){var a=this.get("announcement");return null!=a&&a.isValid()},isEmpty:function(){var a=this.hasBody(),b=this.hasPoll()&&this.hasNonEmptyPoll(),c=this.hasPraise()&&this.hasNonEmptyPraise(),d=this.hasAnnouncement()&&this.hasNonEmptyAnnouncement(),e=this.hasNonFixedFiles()||this.hasNonFixedOgos(),f=this.hasMultipleNonFixedRecipients();return!(a||b||c||d||e||f)},isForeign:function(){var a=this.get("foreign");if(null!=a)return a;var b=this.get("networkId");if(null!=b&&b!=m.getCurrentNetwork().id)return!0;var c=this.getThread();return null!=c?c.isForeign():!1},isDirectMessage:function(){return this.get("direct_message")===!0},validate:function(a,b){var c=this.hasBody(),d=this.hasPoll(),e=this.hasValidPoll(),f=this.hasPraise(),g=this.hasValidPraise(),h=this.hasAnnouncement(),i=this.hasValidAnnouncement(),j=this.hasFiles()||this.hasOgos(),k=this.hasFilesInProgress()||this.hasOgosInProgress(),l=this.hasRecipients(),m=this.isReply();void 0!==b.hasRecipients&&(l=b.hasRecipients);var n=m||l;this.hasFailedRecipients()&&(n=!1);var o=m?!(j||l):!(j||d||f||h);return o&&(n=n&&c),j&&(n=n&&!k),d&&(n=n&&e),f&&(n=n&&g),h&&(n=n&&i),n?void 0:"Message is not valid"},isValidButRecipients:function(){return this.isValid({hasRecipients:!0})},hasFailedRecipients:function(){return!!this.findRecipient({status:"failed"})},clear:function(a){var c=["sender","feed","thread"],d=["poll","praise","announcement"],e=["files","ogos","topics","recipients","allRecipients"];b.each(d,function(a){a=this.get(a),a&&a.clear()},this),b.each(e,function(a){a=this.get(a),a&&a.reset(null)},this);var f=b.omit(this.attributes,b.union(c,d,e));for(var g in f)f[g]=this.defaults[g];return this.set(f,b.extend({},a)),this.trigger("clear")},_isRecipientForeign:function(a,b){var c=a.get("networkId");return null==c||null==b?!!a.get("foreign"):c!=b},_isRecipientExternal:function(a,b,c,d){return b||c&&!b||!d},_collectionContainsNonFixedValues:function(a){return null!=a.findWhere({fixed:!1})},_updateRecipients:function(){var a=this.get("recipients"),c=this.getImplicitRecipients(),d=this.hasPraise()&&this.get("praise").hasRecipients()?this.get("praise").get("recipients"):null,e=null!=c&&c.length>0,f=this.get("allRecipients"),g=this.isForeign(),i=new h(a.toArray());null!=c&&i.add(c.toArray()),d&&i.add(d.toArray());var j=m.getCurrentNetwork(),k=j&&j.id,l=i.findWhere({type:q.PUBLIC_GROUP}),n=i.findWhere({type:q.PRIVATE_GROUP}),o=i.whereContains({type:[q.DOMAIN,q.USER]});b.each(o,function(a){var d=e&&null!=c.get(a.getId(),q.USER),f=null!=l&&b.contains(a.get("groupIds"),l.getId()),h=null!=l&&(!l.get("foreign")||f),i=null!=n&&b.contains(a.get("groupIds"),n.getId()),j=null==l&&null==n&&(!e||d),m=this._isRecipientForeign(a,k),o=h||i||j,p=this._isRecipientExternal(a,m,g,o);a.set({implicit:d,external:p,foreign:m})},this),f.reset(i.toArray())}});return s.fromOriginalModel=function(a){if(null==a)return void d.warn("Message.fromOriginalModel was not given an original");var b=a.getFeed&&a.getFeed(),c=a.getThread&&a.getThread(),e=a.findSender&&a.findSender();null!=b&&(b=g.fromOriginalModel(b)),null!=c&&(c=f.fromOriginalModel(c));var h=new s({id:a.id,feed:b,thread:c,sender:e,state:"submitted",networkId:a.network_id,direct_message:a.direct_message});return h._updateRecipients(),h},s.TYPE=r,s.SHARE_MODE=p,n.ns("yam.backbone.model"),yam.backbone.model.Message=s,s}),define("feeds/lib/modules/video_encoding_progress",["require","core/lib/ctor","core/lib/yammer_request"],function(a){var b=a("core/lib/ctor"),c=a("core/lib/yammer_request"),d={ENCODED:"encoded",ENCODING:"encoding",FAILED:"failed"},e=b("yam.lib.modules.VideoEncodingProgress",{init:function(a){this._fileId=a.fileId,this._versionId=a.versionId,this._allowPolling=!1,this._requestTimer=null},destroy:function(){this.unhandleEncodingStatusChange()},unhandleEncodingStatusChange:function(){this._allowPolling=!1,null!=this._requestTimer&&clearTimeout(this._requestTimer)},handleEncodingStatusChange:function(a,b){b=b||1e4;var c=function(){},e=a.onEncoded||c,f=a.onEncoding||c,g=a.onError||c;this._allowPolling=!0;var h="/api/v1/uploaded_files/"+this._fileId+"/version/"+this._versionId+"/async_video_encoding_status",i=function(){this._allowPolling&&(this._requestTimer=window.setTimeout(function(){this._check(h,j.bind(this))}.bind(this),b))}.bind(this),j=function(a){switch(a.status){case d.ENCODED:e(a);break;case d.ENCODING:f(a),i();break;case d.FAILED:g(a)}};this._check(h,j.bind(this))},_check:function(a,b){c.send({url:a,success:b,error:function(a){a.status&&4===Math.floor(a.status/100)&&this.destroy()}.bind(this)})}});return{EncodingStatus:d,create:function(a){return new e(a)}}}),define("stache!components/file_thumbnail/src/file_thumbnail",["mustache"],function(a){var b='{{^thumbnail}}\n{{{icon}}}\n{{/thumbnail}}\n{{#thumbnail}}\n<span class="thumbnail" alt="" style="background-image: url(\'{{thumbnail}}\')"></span>\n{{/thumbnail}}\n{{#show_preview}}\n<span class="item-preview yamicon yamicon-add-search"></span>\n{{/show_preview}}';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/file_thumbnail/src/file_thumbnail",[],function(){}),define("components/file_thumbnail/src/file_thumbnail",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/helper/svg_icon","core/lib/filename_helper","feeds/lib/modules/video_encoding_progress","models/helpers/file","html!./file_thumbnail","css!./file_thumbnail"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("common-ui/lib/helper/svg_icon"),e=a("core/lib/filename_helper"),f=a("feeds/lib/modules/video_encoding_progress"),g=a("models/helpers/file"),h=a("html!./file_thumbnail");a("css!./file_thumbnail");var i=function(a,b){return a[b]||a.get&&a.get(b)},j=function(a){var b=["doc","pdf","graph","picture"],c=e.getFileIconClass(i(a,"name"));return g.isPage(a)||b.indexOf(c)>-1;
},k=function(a,b){var c;return c=g.isPage(a)?"note":e.getFileIconClass(i(a,"name")||i(a,"title")),d("docicon-big-"+c,{width:b,height:b})},l=48,m=f.EncodingStatus;return b.extend({mixins:[c],template:h,tagName:"span",className:"yj-file-thumbnail",attributes:{"aria-hidden":!0},getTemplateData:function(){var a,b,c,d=i(this.model,"status");return b=k(this.model,this.options.size||l),this.options.showPreviewIfPossible&&j(this.model)&&(c=i(this.model,"thumbnail_url"),(d===m.ENCODING||d===m.FAILED||g.isPage(this.model))&&(c=null),a=!0),{icon:b,thumbnail:c,show_preview:a}}})}),define("components/file_thumbnail/index",["require","./src/file_thumbnail"],function(a){"use strict";return a("./src/file_thumbnail")}),/**
* Copyright (C) 2012 Paul Thurlow
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*/
function(){var a=function(a){this.options={maxCache:50,enableCache:!0,insertOrder:!1,returnRoot:!1,dataType:"array",insert:null,sort:null,clip:null,copy:null,merge:null},this.root={},this.index=0;for(var b in a)a.hasOwnProperty(b)&&(this.options[b]=a[b]);"function"!=typeof this.options.insert&&(this.options.insert=function(a,b){return this.options.insertOrder&&"undefined"==typeof b.d&&"undefined"==typeof b.o&&(b={d:b,o:this.index++}),a&&a.length?a.push(b):a=[b],a}),"function"!=typeof this.options.sort&&(this.options.insertOrder?this.options.insertOrder&&(this.options.sort=function(){this.sort(function(a,b){return a.o-b.o})}):this.options.sort=function(){this.sort()}),"function"!=typeof this.options.clip&&(this.options.clip=function(a){this.length>a&&this.splice(a,this.length-a)}),"function"!=typeof this.options.copy&&(this.options.copy=function(a){return a.slice(0)}),"function"!=typeof this.options.merge&&(this.options.merge=function(a,b,c){for(var d=0,e=b.length;e>d;d++)a=this.options.insert.call(this,a,b[d]),this.options.sort.call(a,c),this.options.clip.call(a,this.options.maxCache);return a})};a.prototype={_addCacheData:function(a,b){return this.root===a&&!this.options.returnRoot||this.options.enableCache===!1?!1:(a.$d||(a.$d={}),a.$d=this.options.insert.call(this,a.$d,b),this.options.sort.call(a.$d),this.options.clip.call(a.$d,this.options.maxCache),!0)},_addSuffix:function(a,b,c){var d=a.charAt(0),e=a.substring(1)||null,f={$d:{}};e&&(f.$s=e),"undefined"==typeof c[d]?c[d]=f:"undefined"==typeof c[d].$d&&(c[d].$d={},e&&"undefined"==typeof c[d].$s&&(c[d].$s=e)),c[d].$d=this.options.insert.call(this,c[d].$d,b),this.options.sort.call(c[d].$d)},_moveSuffix:function(a,b,c){var d=a.charAt(0),e=a.substring(1)||null,f={$d:{}};e&&(f.$s=e),"undefined"==typeof c[d]&&(c[d]=f),c[d].$d=this.options.copy(b)},_getDataAtNode:function(a,b,c){var d;return this.options.enableCache?(this.options.sort.call(a.$d,b),d=a.$d):(d=this._getSubtree(a,b),d&&this.options.sort.call(d,b)),"function"==typeof c?d=c(d):d&&this.options.clip.call(d,this.options.maxCache),d?this.options.copy(d):void 0},_stripInsertOrder:function(a){if("undefined"!=typeof a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(a[c].d);return b}},_getSubtree:function(a,b){for(var c,d,e=[a];d=e.pop();)for(var f in d)d.hasOwnProperty(f)&&("$d"==f?("undefined"==typeof c&&(c="object"==this.options.dataType?{}:[]),c=this.options.merge.call(this,c,d.$d,b)):"$s"!=f&&e.push(d[f]));return c},add:function(a,b){if("string"!=typeof a)return!1;1==arguments.length&&(b=a),a=a.toLowerCase();for(var c=this.root,d=0,e=a.length;e>d;d++){var f=a.charAt(d);if(c[f])d==e-1?(this._addCacheData(c,b),this._addCacheData(c[f],b)||this._addSuffix(f,b,c)):(this._addCacheData(c,b),c=c[f]);else{if(c.$s){if(c.$s==a.substring(d)){this._addCacheData(c,b)||(c.$d=this.options.insert.call(this,c.$d,b),this.options.sort.call(c.$d));break}this._moveSuffix(c.$s,c.$d,c),delete c.$s,this.options.enableCache===!1&&delete c.$d}if(!c[f]){this._addSuffix(a.substring(d),b,c),this._addCacheData(c,b);break}this._addCacheData(c,b),d==e-1&&(c[f].$s?(this._moveSuffix(c[f].$s,c[f].$d,c[f]),delete c[f].$s,this.options.enableCache===!1&&delete c[f].$d,this._addSuffix(f,b,c)):this._addCacheData(c[f],b)||this._addSuffix(f,b,c)),c=c[f]}}},remove:function(a){if("string"==typeof a&&""!==a&&!this.options.enableCache){a=a.toLowerCase();var b,c,d,e,f,g,h=this.root,i=0;for(c=0,d=a.length;d>c;c++){if(b=a.charAt(c),!h[b]){if(h.$s&&h.$s===a.substring(c))break;return}e=h,f=b,h=h[b]}g=this.options.copy(h.$d),this.options.insertOrder&&(g=this._stripInsertOrder(g)),delete h.$d,delete h.$s;for(var j in h)h.hasOwnProperty(j)&&i++;return i||delete e[f],g}},contains:function(a){if("string"!=typeof a||""===a)return!1;a=a.toLowerCase();for(var b=this.root,c=0,d=a.length;d>c;c++){var e=a.charAt(c);if(!b[e])return!(!b.$s||b.$s!==a.substring(c));b=b[e]}return!(!b.$d||"undefined"!=typeof b.$s)},find:function(a,b){if("string"==typeof a&&(""!==a||this.options.returnRoot)){a=a.toLowerCase();for(var c=this.root,d=0,e=a.length;e>d;d++){var f=a.charAt(d);if(!c[f])return c.$s&&0===c.$s.indexOf(a.substring(d))?this._getDataAtNode(c,a,b):void 0;c=c[f]}return this._getDataAtNode(c,a,b)}}},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=a),exports.Triejs=a):"function"==typeof define&&define.amd?define("common-ui/lib/ui/shared/trie",[],function(){return a}):yam.Triejs=a}(this),define("common-ui/lib/ui/shared/autocompletion/autocomplete_models",["require","underscore","core/lib/tr"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d={FILE:{id:"file",title:c.t("files"),early:1,icon:"yamicon-paperclip"},PAGE:{id:"page",title:c.t("notes"),early:1,icon:"yamicon-write"},USER:{id:"user",title:c.t("people"),early:5,icon:"yamicon-user",triggers:["@","to:","To:"]},PENDINGUSER:{id:"pendinguser",title:c.t("pending_users"),early:2,icon:"yamicon-add-user",triggers:["@","to:","To:"]},GROUP:{id:"group",title:c.t("groups"),early:2,icon:"yamicon-group",triggers:["to:","To:"]},TOPIC:{id:"topic",title:c.t("topics"),early:1,icon:"yamicon-tag"},DEPARTMENT:{id:"department",title:c.t("departments"),early:5,icon:"yamicon-building"},DOMAIN:{id:"domain",title:c.t("emails"),early:5,icon:"yamicon-mesage-MSFT"},OGO:{id:"open_graph_object",title:c.t("links"),early:2,icon:"yamicon-link"}},e=b.chain(d).pluck("id").without("domain").value(),f=["user","pendinguser","group","page","file","topic","department","open_graph_object","domain"],g=["group","user","pendinguser","page","file","topic","department","open_graph_object","domain"];return d.COMPLETABLE=e,d.DISPLAY_ORDER=f,d.DISPLAY_ORDER_GROUPS_FIRST=g,d}),define("common-ui/lib/ui/shared/autocompletion",["require","underscore","jquery","./trie","core/lib/session","core/lib/string_helper","core/lib/yammer_config","core/lib/yammer_request","core/lib/yammer_uri","core/lib/cookie_helper","models/helpers/network","backbone","models/lib/events","common-ui/lib/ui/shared/autocompletion/autocomplete_models"],function(a){var b=a("underscore"),c=a("jquery"),d=a("./trie"),e=a("core/lib/session"),f=a("core/lib/string_helper"),g=a("core/lib/yammer_config"),h=a("core/lib/yammer_request"),i=a("core/lib/yammer_uri"),j=a("core/lib/cookie_helper"),k=a("models/helpers/network"),l=a("backbone"),m=a("models/lib/events"),n=a("common-ui/lib/ui/shared/autocompletion/autocomplete_models"),o=b.extend({},l.Events);o.request=function(a){var b=i.api("complete");a.auth="oauth2",a.url=a.data.url||b,a.timeout=3e3;var c=e.getCurrentUser()&&e.getCurrentUser().web_oauth_access_token,d=g.config().autocomplete_token||c||j.get("pending_user_oauth_token");h.getAuthenticator(a).setAuthToken({token:d}),h.send(a)},o.get=function(a){var d=a.prefix,e=a.models,f=a.fetchSize,g=a.data,h=a.success,i=a.error;e=e||[];var j;j="number"==typeof f?e.join(":"+f+",")+":"+f:b(e).map(function(a){return a+":"+f[a]}).join(",");var k={data:{prefix:d,models:j,secondOrderRanks:!0,client_id:1},success:h,error:i},l={data:{includePendingUsers:!0}};c.extend(!0,k.data,l.data,g),"jsonp"===g.dataType&&(k.dataType="jsonp"),o.request(k)};var p=function(a){var c=a.models,d=a.prefix,e=b.any(c,function(a){return o.moreResultsFromCompletieFor(a,d)}),f=b.all(c,function(a){return o._wasAlreadyRequested(a,d)});(!a.lookcache||e&&!f)&&o.get(a)};return o._throttle=b.throttle(p,500),o._debounce=b.debounce(p,300),o.throttleGet=function(a){var b=void 0===a.debounce?!0:a.debounce,c=this.buildGetOptions(a);null!=c&&(b?o._debounce(c):o._throttle(c))},o.noThrottleGet=function(a){var b=this.buildGetOptions(a);p(b)},o.buildGetOptions=function(a){var c=a.prefix,d=a.models,f=a.fetchSize,g=a.data,h=a.success,i=a.error,j=a.lookcache,l=a.filter,m=a.unoptimizeResults,p=e.getCurrentNetwork();if(o._lastSearch=c,p&&k.isExternalMessagingEnabled(p)&&b.defaults(g,{search_foreign:!0}),(g.excludeUserGroupIds||g.userGroupIds)&&(j=!1),j){var q=o.cache(c,l),r=1===d.length&&b.contains(d,n.DOMAIN.id);if(r&&o.domainMatches)return void h(b.clone(o.domainMatches),c,!1);var s=b.all(d,function(a){return o._wasAlreadyRequested(a,c)}),t=b.any(d,function(a){return o.moreResultsFromCompletieFor(a,c)}),u=q&&b.any(d,function(a){return null!=q[a]});if(u)h(q,c,t&&!s);else if(t===!1){var v={};b(d).each(function(a){v[a]=[]}),h(v,c,!1)}}return{prefix:c,models:b.without(d,n.DOMAIN.id,n.PENDINGUSER.id),fetchSize:f,data:g,success:this._buildSuccessCallback(a),error:i,unoptimizeResults:m,lookcache:j}},o.cache=function(a,b){return"undefined"==typeof b||"function"==typeof b?o._cache.find(a,b):void o._cache.add(a,b)},o.prefetch=function(a){var c=n.COMPLETABLE.concat(["domain"]);return o.prefetchModels(b.without(c,"pendinguser"),a)},o.prefetchModels=function(a,c){c=c||{};var d=!!c.cacheEmails,f=n.COMPLETABLE.concat(["domain"]),g=b.map(f,function(a){switch(a){case"user":return 150;case"domain":return 500;default:return 50}}),h=e.getCurrentNetwork();h&&k.isExternalMessagingEnabled(h)&&b.defaults(c,{search_foreign:!0}),o.get({prefix:"",models:a,fetchSize:b.object(f,g),data:c,success:function(a){o.cachePayload(a,d),c.success&&c.success.apply(this,arguments)}})},o.cachePayload=function(a,c){a.domain&&(o.domainMatches=a.domain,delete a.domain),a.departments&&(a.department=a.departments,delete a.departments),b.each(a,function(a,d){b.each(a,function(a){var e=[],g=(a.name||a.title||"").toLowerCase(),h=(a.full_name||"").toLowerCase(),i=f.removeAccents(h);g&&e.push(g),h&&e.push(h),i&&h!==i&&e.push(i),c&&a.email&&e.push(a.email),c&&a.getEmailAddress&&e.push(a.getEmailAddress()),a.model=d,b.each(e,function(c){var d=c.split(" ");b.each(d,function(b,c){b&&o.cache(b+" "+d.slice(c+1).join(" "),a)})})})})},o._rememberFetchResults=function(a,b,c,d){var e=c===d;b=b.toLowerCase(),this._resultsLeft[a]=this._resultsLeft[a]||{},this._resultsLeft[a][b]=e},o.moreResultsFromCompletieFor=function(a,b){var c=!0;b=b.toLowerCase();for(var d=b.length;d>=0;d--){var e=b.substr(0,d);if(o._wasAlreadyRequested(a,e)){c=this._resultsLeft[a][e];break}}return c},o._wasAlreadyRequested=function(a,b){return b=b.toLowerCase(),this._resultsLeft[a]&&void 0!==this._resultsLeft[a][b]},o._trieOptions={enableCache:!1,dataType:"object",returnRoot:!0,sort:function(a){for(var b in this)this.hasOwnProperty(b)&&this[b].sort((o._sorters[b]||o._sorters.default)(a))},insert:function(a,c){if(a[c.model])if(c.model===n.USER.id){for(var d=!1,e=0,f=a[c.model].length;f>e;e++){var g=a[c.model][e];if("undefined"==typeof g.id?g.name===c.name:g.id===c.id){a[c.model][e]=c,d=!0;break}}d||a[c.model].push(c)}else{var h=!b.detect(a[c.model],function(a){return"undefined"==typeof a.id?a.name===c.name:a.id===c.id});h&&a[c.model].push(c)}else a[c.model]=[c];return a},copy:function(a){var b={};for(var c in a)if(a.hasOwnProperty(c)){b[c]=[];for(var d=0,e=a[c].length;e>d;d++)b[c].push(JSON.parse(JSON.stringify(a[c][d])))}return b},clip:function(a){for(var b in this)this.hasOwnProperty(b)&&this[b].length>a&&this[b].splice(a,this[b].length-a)},merge:function(a,b){for(var c in b)if(b.hasOwnProperty(c))for(var d=0,e=b[c].length;e>d;d++)a=this.options.insert.call(this,a,b[c][d]);return a}},o._buildSuccessCallback=function(a){var c=a.prefix,d=a.models,e=a.fetchSize,f=a.data,g=a.success,h=a.filter,i=!a.unoptimizeResults,j=!!a.cacheEmails;return function(a){if(i&&b.each(d,function(b){var d=e[b]||e;if(a[b]){var f=a[b].length||0;o._rememberFetchResults(b,c,d,f)}}),f.excludeUserGroupIds||f.userGroupIds)g.apply(this,[a,c,!1]);else if(o.cachePayload(a,j),c===o._lastSearch){var k=o.cache(c,h);"undefined"==typeof k&&(k={},b(d).each(function(a){k[a]=[]})),g.apply(this,[k,c,!1])}}},o._flushCache=function(){this._resultsLeft={},this._sorters={},this._sorters.default=function(a){var b=function(b,c){return"undefined"!=typeof a&&(b.name&&b.name.toLowerCase()===a||b.full_name&&b.full_name.toLowerCase()===a)?-1:"undefined"!=typeof a&&(c.name&&c.name.toLowerCase()===a||c.full_name&&c.full_name.toLowerCase()===a)?1:c.ranking-b.ranking};return b};var a=function(a,b){var c=b.ranking-a.ranking;if(0!==c)return c;var d=parseInt(a.id,10)-parseInt(b.id,10);return d};this._sorters.user=function(){return a},this._cache=new d(this._trieOptions)},o._flushCache(),o.listenTo(m,"User/update",function(a,b){b.before&&b.after&&b.before.full_name!==b.after.full_name&&o._flushCache()}),o}),define("common-ui/lib/ui/shared/type_ahead/type_ahead_update_list",["require","underscore","jquery","core/lib/tr","core/lib/session","models/helpers/user","common-ui/lib/ui/shared/autocompletion/autocomplete_models"],function(a){"use strict";function b(a,b,d,e){var f=a.groupsFirst?h.DISPLAY_ORDER_GROUPS_FIRST:h.DISPLAY_ORDER;c.each(f,function(c){var f,g;if(d.hasOwnProperty(c)){var h=i.calculateFreePositions(a,e),j=i.calculateNumberOfModelsToDisplay(a,c);f=d[c].slice(0,j+h),e+=Math.max(f.length-j,0)}b.hasOwnProperty(c)&&(g=b[c]),(f||g)&&a.buildModelResults(c,f,g)})}var c=a("underscore"),d=a("jquery"),e=a("core/lib/tr"),f=a("core/lib/session"),g=a("models/helpers/user"),h=a("common-ui/lib/ui/shared/autocompletion/autocomplete_models"),i={};return i.updateList=function(a){if(a.isUserInteractingWithList())return i.callUpdateListDeferred(a);var b=a.isElementVisible(),e=!1,f=a.$results;a.clearSelectedOption(),i.removeAllItems(f),i.removeFirstCssClass(f);var g=i.getPossibleMatches(a),h=i.renderMatches(a,g);a.hideHint(),h&&!a.isElementVisible()&&a.show(),h&&!f.find(".yj-selected").length&&(a.selectFirst||a.selectOnType&&""!==a.getSearchText())&&(e=!0,c.defer(function(){var b=f.find(".yj-ta-option:first");b.addClass("yj-selected"),a.announceAccessibleState(b,{announceInstructions:!0})})),i.buildOptionalElements(a,h),f.find(".yj-ta-option").each(function(b,c){a.underlineTerm(d(c))}),f.find("dt + dd").addClass("yj-first"),f.find("dt + dt + dd").removeClass("yj-first"),h||a.isHintVisible()||i.showResultsAction(a,h)?a.$element.removeClass("yj-ta-empty"):a.$element.addClass("yj-ta-empty"),h&&f.removeClass("yj-ta-empty"),e||b||!a.isElementVisible()||a.announceAccessibleState(f.find(".yj-selected"),{announceInstructions:!0}),a.onListUpdateFromSettings(h,f)},i.renderMatches=function(a,d){if(!d)return!1;var e,f=!1,g={},h={},j=0;return 1===a.activeCompletableModels.length&&(a.earlyModelResults[a.activeCompletableModels[0]]=a.maxResults),c.each(a.activeCompletableModels,function(b){if(d=i.filterOutExcludedModels(a,d,b),g=a.updateNoticesFromSettings(g,b,d),d=a.filterUsingFilterFromSettings(d,b),d=i.filterOutUnaccessibleGroups(a,d,b),d=i.filterForeignUsers(a,d,b),!i.noUserInfoForPendingUser(b,d)&&!i.noResultsForModel(b,d))if(f=!0,"user"===b||"pendinguser"===b){var c=i.calcDisplayedResultsForUsers(a,d,b);h[b]=c.subMatchesModel||[],j+=c.totalDisplayedResults||0}else e=i.calcModelSizes(a,b),h[b]=d[b].slice(0,e.modelSize),j+=Math.min(h[b].length,e.earlySize)}),b(a,g,h,j),f},i.calcDisplayedResultsForUsers=function(a,b,d){var e,f,g,h=[],j=0,k=10;return"pendinguser"!==d&&(c.each(b.user,function(a){a.state&&"active"===a.state&&(j++,h.push(a))}),k>j&&c.indexOf(a.activeCompletableModels,"pendinguser")>0&&(h=b[d]),h=i.balanceUserList(a,h)),h.length>0&&(e=i.calcModelSizes(a,d),f=h.slice(0,e.modelSize),g=Math.min(f.length,e.earlySize)),{subMatchesModel:f,displayedResults:g}},i.noUserInfoForPendingUser=function(a,b){return!("pendinguser"!==a||c.isArray(b.user)&&c.size(b.user))},i.noResultsForModel=function(a,b){return!(c.isArray(b[a])&&c.size(b[a])||"pendinguser"==a)},i.callUpdateListDeferred=function(a){setTimeout(function(){i.updateList(a)},20)},i.calculateFreePositions=function(a,b){return a.fromCache&&a.isPrefetchingNotComplete()?0:Math.max(a.maxResults-b,0)},i.calculateNumberOfModelsToDisplay=function(a,b){return parseInt(a.earlyModelResults[b],10)||a.maxResults},i.getPossibleMatches=function(a){var b=a.matches||{};return b=a.addDomains(b),b=a._addForeignEmailSuggestions(b),b=a.addIncludeAllCompany(a.emptyQuery,b),b=a.addIncludes(a.emptyQuery,b)},i.filterOutExcludedModels=function(a,b,d){var e=a.excludes;return e&&e[d]&&(b[d]=c.select(b[d],function(a){return!c.contains(e[d],a.id)})),b},i.filterOutUnaccessibleGroups=function(a,b,d){if("post"!==a.accessFilter||"group"!==d)return b;var e=b[d];return g.isSupervisorAdmin(f.getCurrentUser())?(b[d]=e,b):(b[d]=c.filter(e,function(a){return void 0!==a.current_user_can_post?a.current_user_can_post:!0}),b)},i.filterForeignUsers=function(a,b,d){var e=f.getCurrentNetwork();return a.allowForeignUsers||"user"!==d&&"pendinguser"!==d||(b[d]=c.select(b[d],function(a){return c.isNull(a.network_id)||c.isUndefined(a.network_id)||Number(a.network_id)===Number(e.id)})),b},i.removeAllItems=function(a){a.find("dd, dt, .yj-ta-additional").remove()},i.removeFirstCssClass=function(a){a.find(".yj-first").removeClass(".yj-first")},i.showResultsAction=function(a,b){return a.noResultsAction&&!b&&!a.$results.find(".yj-ta-option").length&&""!==a.getSearchText()},i.buildOptionalElements=function(a,b){var f;if(a.isAdditionalOptionSet()&&(b||a.$results.find(".yj-ta-option").length))f=a.createAdditionalOptionsHtml();else if(i.showResultsAction(a,b)){var g=c.escape(a.noResultsMessage)||e.t("search_for_text",{text:c.escape(a.getSearchText())});f=d('<a href="#" class="yj-ta-no-results" data-qaid="no_search_typeahead_results_dropdown">'+g+"</a>")}f&&(a.$results.append(d("<a class='yj-ta-additional yj-btn yj-btn-alt' />").append(f)).addClass("yj-ta-has-additional"),a.$element.addClass("yj-ta-has-additional"))},i.balanceUserList=function(a,b){var d=a.maxInternalUsers,e=a.maxExternalUsers;if(d&&e){var f=[],g=[],h=0,i=0;return c.each(b,function(b){a._isForeign(b)?(i++,i>e?g.push(b):f.push(b)):(h++,h>d?g.push(b):f.push(b))}),c.union(f,g)}return b},i.calcModelSizes=function(a,b){var d={};return d.modelSize=c.isNumber(a.maxModelResults[b])?a.maxModelResults[b]:a.maxResults,d.earlySize=c.isNumber(a.earlyModelResults[b])?a.earlyModelResults[b]:a.maxResults,d},i}),define("stache!common-ui/lib/ui/shared/type_ahead/results_grouping_header",["mustache"],function(a){var b='<div class="head">\n  {{#icon}}<span class="yamicon {{ icon }}"></span>{{/icon}}\n  {{#iconUrl}}<img class="yj-ta-heading-img" src="{{ iconUrl }}" />{{/iconUrl}}\n  {{ title }}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/type_ahead/results_grouping_header",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/string_helper","html!./results_grouping_header"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/string_helper"),e=a("html!./results_grouping_header");return b.extend({mixins:[c],tagName:"dt",template:e,render:function(){return this.$el.addClass(this._getClassName()),this.$el.attr("data-header-type",this.options.modelName),this},getTemplateData:function(){return{title:d.capitalize(this.options.title),icon:this.options.icon,iconUrl:this.options.iconUrl}},_getClassName:function(){return"yj-ta-heading yj-ta-heading-"+this.options.modelName}})}),/*	
	Watermark plugin for jQuery
	Version: 3.2.0
	http://jquery-watermark.googlecode.com/

	Copyright (c) 2009-2014 Todd Northrop
	http://www.speednet.biz/
	
	August 16, 2014

	Requires:  jQuery 1.2.3+
	
	Dual licensed under the MIT or GPL Version 2 licenses.
	See mit-license.txt and gpl2-license.txt in the project root for details.
------------------------------------------------------*/
function(a,b,c){var d="watermark",e="watermarkClass",f="watermarkFocus",g="watermarkSubmit",h="watermarkMaxLength",i="watermarkPassword",j="watermarkText",k=/\r/g,l=/^(button|checkbox|hidden|image|radio|range|reset|submit)$/i,m="input:data("+d+"),textarea:data("+d+")",n=":watermarkable",o=["Page_ClientValidate"],p=!1,q="placeholder"in document.createElement("input");a.watermark=a.watermark||{version:"3.2.0",runOnce:!0,options:{className:"watermark",clearAllFormsOnSubmit:!1,hideBeforeUnload:!0,textAttr:"",useNative:!0},hide:function(b){a(b).filter(m).each(function(){a.watermark._hide(a(this))})},_hide:function(a,c){var d=a[0],f=(d.value||"").replace(k,""),g=a.data(j)||"",l=a.data(h)||0,m=a.data(e);if(g.length&&f==g){if(d.value="",a.data(i)&&"text"===(a.attr("type")||"")){var n=a.data(i)||[],o=a.parent()||[];n.length&&o.length&&(o[0].removeChild(a[0]),o[0].appendChild(n[0]),a=n)}l&&(a.attr("maxLength",l),a.removeData(h)),c&&(a.attr("autocomplete","off"),b.setTimeout(function(){a.select()},1))}m&&a.removeClass(m)},show:function(b){a(b).filter(m).each(function(){a.watermark._show(a(this))})},_show:function(b){var c=b[0],d=(c.value||"").replace(k,""),g=b.data(j)||"",l=b.attr("type")||"",m=b.data(e);if(0!=d.length&&d!=g||b.data(f))a.watermark._hide(b);else{if(p=!0,b.data(i)&&"password"===l){var n=b.data(i)||[],o=b.parent()||[];n.length&&o.length&&(o[0].removeChild(b[0]),o[0].appendChild(n[0]),b=n,b.attr("maxLength",g.length),c=b[0])}if("text"===l||"search"===l){var q=b.attr("maxLength")||0;q>0&&g.length>q&&(b.data(h,q),b.attr("maxLength",g.length))}m&&b.addClass(m),c.value=g}},hideAll:function(b){p&&(a.watermark.hide(a(n,b)),p=!1)},showAll:function(){a.watermark.show(n)}},a.fn.watermark=a.fn.watermark||function(c,h){if(!this.length)return this;var l=!1,m="string"==typeof c;return m&&(c=c.replace(k,"")),"object"==typeof h?(l="string"==typeof h.className,h=a.extend({},a.watermark.options,h)):"string"==typeof h?(l=!0,h=a.extend({},a.watermark.options,{className:h})):"object"==typeof c?(h=a.extend({},a.watermark.options,c),c=""):h=a.watermark.options,"function"!=typeof h.useNative&&(h.useNative=h.useNative?function(){return!0}:function(){return!1}),this.each(function(){var o=a(this);if(o.is(n)){if(h.textAttr&&(c=(o.attr(h.textAttr)||"").replace(k,""),m=!!c),o.data(d))(m||l)&&(a.watermark._hide(o),m&&o.data(j,c),l&&o.data(e,h.className));else{if(q&&h.useNative.call(this,o)&&"TEXTAREA"!==(o.attr("tagName")||""))return void(m&&"placeholder"!==h.textAttr&&o.attr("placeholder",c));if(o.data(j,m?c:""),o.data(e,h.className),o.data(d,1),"password"===(o.attr("type")||"")){var p=o.wrap("<span>").parent(),r=a(p.html().replace(/type=["']?password["']?/i,'type="text"'));r.data(j,o.data(j)),r.data(e,o.data(e)),r.data(d,1),r.attr("maxLength",c.length),r.focus(function(){a.watermark._hide(r,!0)}).bind("dragenter",function(){a.watermark._hide(r)}).bind("dragend",function(){b.setTimeout(function(){r.blur()},1)}),o.blur(function(){a.watermark._show(o)}).bind("dragleave",function(){a.watermark._show(o)}),r.data(i,o),o.data(i,r)}else o.focus(function(){o.data(f,1),a.watermark._hide(o,!0)}).blur(function(){o.data(f,0),a.watermark._show(o)}).bind("dragenter",function(){a.watermark._hide(o)}).bind("dragleave",function(){a.watermark._show(o)}).bind("dragend",function(){b.setTimeout(function(){a.watermark._show(o)},1)}).bind("drop",function(a){var b=o[0],c=a.originalEvent.dataTransfer.getData("Text");(b.value||"").replace(k,"").replace(c,"")===o.data(j)&&(b.value=c),o.focus()});if(this.form){var s=this.form,t=a(s);t.data(g)||(t.submit(function(){return a.watermark.hideAll.apply(this,h.clearAllFormsOnSubmit?[]:[s])}),s.submit?(t.data(g,s.submit),s.submit=function(b,c){return function(){var d=c.data(g);a.watermark.hideAll(h.clearAllFormsOnSubmit?null:b),d.apply?d.apply(b,Array.prototype.slice.call(arguments)):d()}}(s,t)):(t.data(g,1),s.submit=function(b){return function(){a.watermark.hideAll(h.clearAllFormsOnSubmit?null:b),delete b.submit,b.submit()}}(s)))}}a.watermark._show(o)}})},a.watermark.runOnce&&(a.watermark.runOnce=!1,a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},watermarkable:function(a){var b,c=a.nodeName;return"TEXTAREA"===c?!0:"INPUT"!==c?!1:(b=a.getAttribute("type"),!b||!l.test(b))}}),function(b){a.fn.val=function(){var e=Array.prototype.slice.call(arguments);if(!this.length)return e.length?this:c;if(e.length)return b.apply(this,e),a.watermark.show(this),this;if(this.data(d)){var f=(this[0].value||"").replace(k,"");return f===(this.data(j)||"")?"":f}return b.apply(this)}}(a.fn.val),o.length&&a(function(){var c,d,e;for(c=o.length-1;c>=0;c--)d=o[c],e=b[d],"function"==typeof e&&(b[d]=function(b){return function(){return a.watermark.hideAll(),b.apply(null,Array.prototype.slice.call(arguments))}}(e))}),a(b).bind("beforeunload",function(){a.watermark.options.hideBeforeUnload&&a.watermark.hideAll()}))}(jQuery,window),define("jquery-watermark",["jquery"],function(a){return function(){var b,c;return c=function(a){return a.watermark.options.className="yj-watermark",a.watermark.options.useNative=!0,a.watermark.options.hideBeforeUnload=!1,a.watermark},b=c.apply(a,arguments)}}(this)),define("css!common-ui/lib/ui/shared/type_ahead",[],function(){}),define("common-ui/lib/ui/shared/type_ahead_component",["require","jquery","underscore","mustache","components/avatar/index","core/lib/jam/component","core/lib/log","backbone","core/lib/session","core/lib/string_helper","components/file_thumbnail/index","core/lib/tr","core/lib/uri_helper","common-ui/lib/helper/selection","common-ui/lib/helper/environment","core/lib/util/email_extractor","models/helpers/user","common-ui/lib/ui/accessibility/screenreader_announcer","common-ui/lib/ui/shared/autocompletion","common-ui/lib/ui/shared/autocompletion/autocomplete_models","common-ui/lib/helper/ui","core/lib/urls","core/lib/yammer_uri","models/helpers/network","models/network","./type_ahead/type_ahead_update_list","./type_ahead/results_grouping_header","jquery-watermark","css!common-ui/lib/ui/shared/type_ahead"],function(a){function b(a){var b=["COMPLETABLE","DISPLAY_ORDER","DISPLAY_ORDER_GROUPS_FIRST"],c=e.omit(v,function(a,c){return e.includes(b,c)});e.each(c,function(b,c){a["MODEL_"+c]=v[c].id})}function c(a){var b;return v[a.toUpperCase()]&&(b=v[a.toUpperCase()].icon),b}var d=a("jquery"),e=a("underscore"),f=a("mustache"),g=a("components/avatar/index"),h=a("core/lib/jam/component"),i=a("core/lib/log"),j=a("backbone"),k=a("core/lib/session"),l=a("core/lib/string_helper"),m=a("components/file_thumbnail/index"),n=a("core/lib/tr"),o=a("core/lib/uri_helper"),p=a("common-ui/lib/helper/selection"),q=a("common-ui/lib/helper/environment"),r=a("core/lib/util/email_extractor"),s=a("models/helpers/user"),t=a("common-ui/lib/ui/accessibility/screenreader_announcer"),u=a("common-ui/lib/ui/shared/autocompletion"),v=a("common-ui/lib/ui/shared/autocompletion/autocomplete_models"),w=a("common-ui/lib/helper/ui"),x=a("core/lib/urls"),y=a("core/lib/yammer_uri"),z=a("models/helpers/network"),A=a("models/network"),B=a("./type_ahead/type_ahead_update_list"),C=a("./type_ahead/results_grouping_header");a("jquery-watermark"),a("css!common-ui/lib/ui/shared/type_ahead");var D=function(){return['<dd class="yj-ta-option {{modelClass}} {{#img}}yj-ta-exp{{/img}}" data-option-id="{{ id }}" role="button">','<div class="yj-avatar-placeholder"></div>','<div class="yj-ta-content">','{{#official}}<div class="official-badge-small yj-enhanced-tooltip"></div>{{/official}}','<span class="yj-ta-name">{{{ name }}}</span>','<span class="yj-ta-byline">{{{ byline }}}</span>',"</div>","</dd>"].join("")},E=function(){return'<dt class="yj-ta-option-header">{{message}}</dt>'},F=function(){return"{{byline}}"},G=function(){return['<div class="foreign-network-byline">','<span class="yamicon yamicon-network">','<span class="yj-acc-hidden"> &nbsp; {{foreignIconAltText}} &nbsp; </span>',"</span>","{{byLine}}","</div>"].join("")},H=1,I=4497,J=[1,4497,41291,41292];return h.extend({template:['<div class="yj-ta zindex-t5">','<div class="yj-ta-hint"></div>','<dl class="yj-ta-results yj-menu"></dl>',"</div>"].join(""),init:function(a,c){var f={};this.id="typeAhead",this.target="body",h.prototype.init.call(this,d.extend(this.defaults,a),c),b(this),e.each(v,function(a,b){a.early&&a.title&&(this.defaults.settings.earlyModelResults[b]=a.early,this.defaults.settings.modelTitles[b]=a.title),a.triggers&&(f[b]=a.triggers)},this),this.defaults.settings.triggerStrings=f,this.$field={},this.matches=null,this.fieldOptions={},this.donePrefetch=!1,this.interaction=void 0,this.lastSearch="",this.active=!1,this.activeCompletableModels=[],this.overloadFunctions=[{name:"onSelect",fallback:this.defaultOnSelect},{name:"onMark",fallback:this.defaultOnMark},{name:"onTab",fallback:this.defaultOnTab},{name:"onEnter",fallback:this.defaultOnEnter},{name:"onAdditional",fallback:this.defaultOnEnter},{name:"onListUpdate",fallback:this.defaultOnListUpdate},{name:"buildOption",fallback:this.defaultBuildOption}],this.keydownRepeats=!d.browser.opera,this._subviews={resultsGroupingHeaders:{}}},defaults:{id:"typeAhead",settings:{displayHeaders:!0,includeAllCompany:!1,maxResults:10,insertionMode:!1,pluggableEnhancerMode:!1,width:!1,noResultsMessage:n.t("no_results"),hintMessage:n.t("type_to_search_for_results"),noResultsAction:!1,toTriggerHintMessage:n.t("type_to_find_a_user_to_send_a_private_message"),optionalParams:null,excludeEmails:!1,allowForeignEmails:!1,allowForeignUsers:!1,completableModels:v.COMPLETABLE,modelTitles:{},triggerStrings:{},maxModelResults:{pendinguser:2},earlyModelResults:{},selectFirst:!0,excludes:void 0,includes:void 0,filter:void 0,notice:void 0,additionalOption:!1,showTopRankings:!1,showTopRankingsOnce:!1,allowWide:!0,dataType:"json",noCache:!1,scrollResults:!1,clearInput:!0,headerTruncationLength:!1,reactivateOnClearedField:!1,accessFilter:"view",debounce:!0,selectOnType:void 0}},createElement:function(){this.$element=d(f.render(this.template,{})),this.$results=this.$element.find(".yj-ta-results"),this.$hint=this.$element.find(".yj-ta-hint"),this.toTrigger=!1},observeDomEvents:function(){var a=this;d(document).on("mousedown",".yj-ta",this.handleClick.bind(this)),d(document).on("mouseover",".yj-ta",this.handleHover.bind(this)),j.on("/ui/reflow/vertical",function(){a.active&&a.positionElement()});var b=e.throttle(e.bind(function(){this.$field.length&&!this.settings.inline&&this.positionElement()},this),150);j.on("/ui/resize",b)},reactivateOnClearedField:function(){if(this.settings.reactivateOnClearedField&&!this.active){var a=this.$field.val();a||(this.activeCompletableModels=this.settings.completableModels,this.activate(),this.displayHint())}},handleKeydown:function(a){if((this.settings.insertionMode&&(!this.active||!this.$element.is(":visible"))||!this.settings.insertionMode&&!this.active)&&9===a.which&&!a.shiftKey&&"function"==typeof this.settings.onTab)return void this.settings.onTab(a);if(this.active){switch(this.lastKeydown=a.which,a.which){case 8:this.currentTrigger&&p.caretPos(this.$field)<=this.wordStart+this.currentTrigger.length&&this.deactivate();break;case 9:if(a.shiftKey)return;if(this.getSelectedOption())this.selectOption(a);else{if(this.settings.allowNoMatch||this.isTextEmpty())return void this.hide();this.settings.onNoSelection&&this.settings.onNoSelection(this.$field.val(),a)}return a.preventDefault(),void a.stopPropagation();case 13:return void(a.isDefaultPrevented()||this.settings.insertionMode&&!this.$element.is(":visible")?this.$field[0]&&this.$field[0]===a.target&&this.deactivate():(a.preventDefault(),this.getSelectedOption()?(this.selectOption(a),a.stopPropagation()):this.settings.onNoSelection&&!this.isTextEmpty()&&(this.settings.onNoSelection(this.$field.val(),a),a.stopPropagation())));case 27:return this.deactivate(),void a.stopPropagation();case 32:this.settings.insertionMode&&this.deactivate()}a.which>=37&&a.which<=40&&this.keydownRepeats&&this.handleArrowKeys(a),17!==a.which&&91!==a.which&&(a.ctrlKey||a.metaKey)&&setTimeout(function(){var b=d.Event("keyup");b.which=a.which,d(a.target).trigger(b)},20)}},handleKeypress:function(a){!this.keydownRepeats&&this.active&&this.handleArrowKeys(a)},handleKeyup:function(a){return 91===a.which?void(this.lastKeydown=-1):(this.active?this.checkField():!this.settings.reactivateOnClearedField||8!==a.which&&46!==a.which?this.detectTriggers():this.reactivateOnClearedField(),void(this.lastKeydown=-1))},handleArrowKeys:function(a){if(!(this.lastKeydown<37||this.lastKeydown>40)&&this.$element.is(":visible")){this.resetInteractionTimeout();var b=39,c=40,d=38,e=37;switch(this.lastKeydown){case e:break;case d:this.markOption("prev",a),a.preventDefault(),a.stopPropagation();break;case b:!this.getSelectedOption()&&this.settings.insertionMode&&this.deactivate();break;case c:this.markOption("next",a),a.preventDefault(),a.stopPropagation()}}},handleChange:function(){},handleBlur:function(){return q.isIE()&&this.settings.scrollResults&&d(document.activeElement).closest(".yj-ta").length?void this.$field.focus():void this.deactivate()},handleClick:function(a){var b=d(a.target);if(b=b.filter(".yj-ta-option").add(b.parents(".yj-ta-option")),1===b.length)this.$results.find(".yj-selected").removeClass("yj-selected"),b.addClass("yj-selected"),this.selectOption(a),a.stopPropagation();else if(d(a.target).closest(".yj-ta-additional").length)this.settings.onAdditional(),a.stopPropagation();else if(d(a.target).closest(".yj-ta").length){var c=d(a.target).closest(".yj-invite-them");c.length?window.location=c.attr("href"):(a.stopPropagation(),a.preventDefault())}},handleHover:function(a){var b=d(a.target).closest(".yj-ta-option, .yj-ta-additional");b&&b.length&&(this.$results.find(".yj-selected").removeClass("yj-selected"),b.addClass("yj-selected"))},registerField:function(a,b){var c=d(a);if(c[0])return b.excludes&&i.deprecate("typeahead","exclude option","please use the filter option instead"),this.removeField(c),c[0].id||(c[0].id=e.uniqueId("yamjs")),c.attr("autocomplete","off"),b.watermarkText&&c.watermark(b.watermarkText),b.watermarkIcon&&(b.watermarkIconAlignLeft?c.css("background","#fff url("+b.watermarkIcon+") 4% center no-repeat"):c.css("background","#fff url("+b.watermarkIcon+") 98% center no-repeat")),c.bind("focus.TypeAheadGlobal",this.changeField.bind(this)),c.bind("createMention.TypeAheadGlobal",this.createMention.bind(this)),this.fieldOptions[c[0].id]=b,b.showTopRankings&&this.prefetchResultsIfNotComplete(),this},updateField:function(a,b){var c=d(a);if(0!==c.length){var f=c[0].id;if(!f||!this.fieldOptions[f])throw"Field element is not a type ahead element";return e.extend(this.fieldOptions[f],b),this.constructSettings(),this}},exclude:function(a,b){return i.deprecate("typeahead","exclude","please use the filter option instead"),this._updateExcludeList("replace",a,b)},addExclude:function(a,b){return i.deprecate("typeahead","addExclude","please use the filter option instead"),this._updateExcludeList("add",a,b)},removeExclude:function(a,b){return i.deprecate("typeahead","removeExclude","please use the filter option instead"),this._updateExcludeList("remove",a,b)},_updateExcludeList:function(a,b,c){var d,f,g,h,i=b[0]&&b[0].id,j=this.$field&&this.$field[0]&&this.$field[0].id,k=this.fieldOptions[i];if(!k)throw new Error("Typeahead not registered for that field");switch(d=k.excludes,a){case"replace":f=c;break;case"add":f=d||{};for(h in c)c.hasOwnProperty(h)&&(g=f[h]||[],g=g.concat(c[h]),f[h]=g);break;case"remove":if(d)for(h in c)c.hasOwnProperty(h)&&(g=d[h],g&&g.length&&(c[h].unshift(g),g=e.without.apply(e,c[h])),g&&g.length?f[h]=g:delete d[h])}k.excludes=f,j===i&&(this.settings.excludes=f,this.$element.is(":visible")&&this.updateList())},removeField:function(a){var b=d(a);b[0]&&this.fieldOptions[b[0].id]&&(b.unbind(".TypeAheadGlobal"),this.$field[0]&&b[0].id===this.$field[0].id&&(this.ajax&&(this.ajax="abort"),this.hide(),this.reset(),this.$field={}),delete this.fieldOptions[b[0].id])},changeField:function(a){this.active||(this.prefetchResultsIfNotComplete(),this.$field[0]&&this.$field[0].id===a.target.id||(this.reset(),this.$field=d(a.target),this.constructSettings(),this.settings.excludeEmails&&(this.settings.completableModels=e.without(this.settings.completableModels,v.DOMAIN.id)),e.each(this.overloadFunctions,function(a){var b=this.settings[a.name]||a.fallback;this.settings[a.name]=b.bind(this)},this),this.settings.pluggableEnhancerMode||e.each(["keydown","keyup","blur","keypress"],function(a){this.$field.bind(a+".TypeAhead",this["handle"+l.capitalize(a)].bind(this))},this)),this.positionElement(),this.settings.insertionMode?this.deactivate():(this.activeCompletableModels=this.settings.completableModels,this.activate(),this.displayHint()))},getFieldOptions:function(){var a=this.$field[0];return a&&a.id?this.fieldOptions[a.id]:{}},constructSettings:function(){this.settings=d.extend(this.settings,this.defaults.settings,{styles:"reduced"},this.getFieldOptions()),this.settings.optimizeForGroupSelection&&(this.settings.earlyModelResults.group=5,this.settings.showTopRankings=!0)},activate:function(){this.active=!0,this.$element.addClass("yj-ta-empty"),this.settings.scrollResults&&this.addResultsScrollbar(),this.show()},deactivate:function(){this.active=!1,this.matches=null,this.previousSelected=null,this.$results.removeClass("yj-ta-has-additional"),this.$hint.empty(),this.$results.empty(),this.hide(),this.removeChildren(),this.settings.scrollResults&&this.removeResultsScrollbar()},unbindEvents:function(){this.$field&&this.$field.length&&this.$field.unbind(".TypeAhead")},positionElement:function(){var a,b,c,e=this.$field.offset(),f=e.left,g=e.top+this.$field.outerHeight(!1);this.settings.getPosition&&(e=this.settings.getPosition(),f=e.left,g=e.top),this.settings.insertionMode&&!this.$field.is("input, textarea")&&(e={left:0,right:0,top:0,height:0},e=p.caretCoords(this.$field[0])||e,f=e.left,g=e.top+e.height),this.removeStyles(),this.addStyles(),a=this.getWidth(),this.settings.inline?this.$element.appendTo(this.$field.parent()):this.settings.target?this.$element.appendTo(this.settings.target):this.$element.appendTo(d("body")),this.settings.inline&&!this.settings.getPosition?this.$element.css({left:"inherit",top:"inherit",width:a}):this.$element.css({left:f,top:g,width:a}),this.$results.width(a),b=this.isWideMode()?"addClass":"removeClass",c=this.withHeaders()?"addClass":"removeClass",this.$results[c]("yj-ta-withheaders"),this.$element[b]("yj-ta-wide")},createMention:function(a){var b=d(a.target),c=b.val(),f=c.length>0&&" "!==c.charAt(c.length-1)?c+" @":c+"@";b.val(f),p.caretPos(b[0],b.val().length),this.detectTriggers(),q.isOlderIE()?e.defer(e.bind(function(){this.activate(),this.displayHint()},this),1):this.displayHint()},defaultOnSelect:function(a){this.settings.insertionMode?this.insertResult(a):this.$field.val(a.name)},defaultOnListUpdate:function(){},defaultOnMark:function(){},defaultOnTab:function(){},defaultOnEnter:function(){},insertResult:function(a){var b=this.$field.val(),c=b.substring(0,this.wordStart),d=this.getResultText(a),e=b.substring(this.wordStart+this.getSearchText().length,b.length);e||(e=" ")," "!==e.charAt(0)&&(e=" "+e),this.$field.val(c+d+e)},getResultText:function(a){return a?(this.currentTrigger||"")+a.name:""},removeAllItems:function(){this.destroySubviews(),this.$results.find("dd, dt, .yj-ta-additional").remove()},destroySubviews:function(){e.each(this._subviews.resultsGroupingHeaders,function(a){a.remove()}),this._subviews.resultsGroupingHeaders={}},withHeaders:function(){return this.settings.displayHeaders&&e.size(this.settings.completableModels)>1},getWidth:function(){return this.settings.width||this.$field.outerWidth()-2},isWideMode:function(){return this.getWidth()>220&&this.settings.allowWide},buildModelResults:function(a,b,c){if(a===v.OGO.id)return this.buildOgoModelResults(b,c);if(!(null==b||b.length<1)){var g=this.$results.find(".yj-ta-heading-"+a);g.length||(g=d(this.buildHeader(a)),this.$results.append(g)),null==c?e.each(b,function(b){this.appendOption(a,this.buildOption(b,a),g,b,a)},this):g.after(f.render(E(),{message:c})),"pendinguser"===a&&g.after(f.render(E(),{message:"People not yet on Yammer"}))}},buildOgoModelResults:function(a){var b,c,d,f,g=this.getOgoId(H),h=[];if(!(a.length<=0)&&(e.each(a,function(a){b=this.getOgoId(a.client_application_id),c=e.indexOf(J,a.client_application_id)>-1,f=this.buildOgoHeader(a),this.hasHeader(b)||(c?d=f:this.$results.append(f));var g=v.OGO.id;c?h.push({option:this.buildOption(a,g),match:a,type:g}):this.appendOption(b,this.buildOption(a,g),f,a,g)},this),d)){this.$results.append(d);for(var i=0;i<h.length;i++)this.appendOption(g,h[i].option,d,h[i].match,h[i].type)}},hasHeader:function(a){return!!this._subviews.resultsGroupingHeaders[a]},buildOption:function(a,b){a.id=a.id||a.name;var c=this.settings.buildOption(a,b);return c.data("item",a),c},appendOption:function(a,b,c,d,f){var h=this.$results.find(".yj-ta-model-"+a).last();(this._optionWasPreviouslySelected(b)||this._matchIsForeignEmailSuggestion(d))&&b.addClass("yj-selected");var i=h.length?h:c;i.after(b);var j=this.buildImage(d,f),k=b.find(".yj-avatar-placeholder");if(f===v.FILE.id){var l=new m({model:d,size:36});l.render(),k.append(l.$el)}else if(j){var n=e.extend(e.clone(d),{mugshot_url:j,name:this.buildName(d,f)}),o=new g({model:n,withHovercard:!1,hideFromAccessibility:!0,excludeLink:!0});this.addChild(o),k.append(o.$el),o.render()}},_optionWasPreviouslySelected:function(a){return a.data("option-id")===this.previousSelected},_matchIsForeignEmailSuggestion:function(a){return!!a.foreignEmailSuggestion},getDomains:function(){return u.domainMatches},addDomains:function(a){var b,c,f=this.getRawSearchText();if(!this.isTextEmpty()&&u.domainMatches&&e.include(this.activeCompletableModels,"domain")){a=a||{},c=d.extend(!0,[],u.domainMatches),-1!==f.indexOf("@")&&(b=f.substring(f.indexOf("@")+1),c=e.select(c,function(a){return 0===a.name.indexOf(b)}));var g=e.map(c,function(a){return{name:a.name,id:f.replace(/@.*/,"")+"@"+a.name,ranking:a.ranking}});a.domain=e.compact(e.union(a.domain,g))}return a},addIncludeAllCompany:function(a,b){if(a||!this.settings.includeAllCompany)return b;b=b||{};var c={id:"COMPANY_GROUP_ID",full_name:z.getCompanyGroupName(k.getCurrentNetwork()),description:n.t("this_is_the_default_group_for_everyone_in_the_currentnetwork",{currentNetwork:k.getCurrentNetwork().name}),web_url:x.networkIndex(k.getCurrentNetwork())+"/groups/company",photo:y.cdn("assets/images/company_group_profile.png")};return"undefined"==typeof b.group&&(b.group=[]),this.includeMatches(c)&&b.group.unshift(c),b},addIncludes:function(a,b){return a||!this.settings.includes?b:(b=b||{},e.each(this.activeCompletableModels,function(a){this.settings.includes[a]&&e(this.settings.includes[a]).each(function(c){"undefined"==typeof b[a]&&(b[a]=[]),this.includeMatches(c)&&b[a].unshift(c)},this)},this),b)},includeMatches:function(a){var b,c=this.getSearchText().toLowerCase(),d=a.full_name.toLowerCase(),f=d.indexOf(c),g=!1;return-1!==f&&(b=d.split(" "),g=e.any(b,function(a){return d.indexOf(a)===f})),g},isPrefetchingNotComplete:function(){return this.donePrefetch===!1},prefetchResultsIfNotComplete:function(){this.isPrefetchingNotComplete()&&(u.prefetch(this.settings.optionalParams),this.donePrefetch=!0)},isUserInteractingWithList:function(){return void 0!==this.interactionTimeout},resetInteractionTimeout:function(){clearTimeout(this.interactionTimeout),this.interactionTimeout=setTimeout(function(){this.interactionTimeout=void 0}.bind(this),300)},isElementVisible:function(){return this.$element.is(":visible")},isHintVisible:function(){return this.$hint.is(":visible")},filterUsingFilterFromSettings:function(a,b){var c=this.settings.filter;return c&&(a[b]=e.select(a[b],function(a){return c(b,a)})),a},updateNotices:function(a,b,c){return this.settings.notice&&(a[b]=this.settings.notice(b,c[b])),a},onListUpdateFromSettings:function(a,b){this.settings.onListUpdate&&this.settings.onListUpdate(a,b)},isAdditionalOptionSet:function(){return this.settings.additionalOption},createAdditionalOptionsHtml:function(){return d(this.settings.additionalOption(this.getSearchText()))},hideHint:function(){""!==this.removePrefix(this.getSearchText())?this.$hint.hide():""===this.removePrefix(this.getSearchText())&&this.hint&&!this.$hint.is(":visible")&&this.$hint.show()},updateList:function(a,b){B.updateList({fromCache:a,emptyQuery:b,$results:this.$results,$element:this.$element,matches:this.matches,isUserInteractingWithList:this.isUserInteractingWithList.bind(this),isPrefetchingNotComplete:this.isPrefetchingNotComplete.bind(this),isElementVisible:this.isElementVisible.bind(this),isHintVisible:this.isHintVisible.bind(this),maxResults:this.settings.maxResults,maxInternalUsers:this.settings.maxInternalUsers,maxExternalUsers:this.settings.maxExternalUsers,maxModelResults:this.settings.maxModelResults,earlyModelResults:this.settings.earlyModelResults,groupsFirst:this.settings.groupsFirst,noResultsAction:this.settings.noResultsAction,noResultsMessage:this.settings.noResultsMessage,excludes:this.settings.excludes,accessFilter:this.settings.accessFilter,allowForeignUsers:this.settings.allowForeignUsers,selectFirst:this.settings.selectFirst,selectOnType:this.settings.selectOnType,buildModelResults:this.buildModelResults.bind(this),addIncludes:this.addIncludes.bind(this),announceAccessibleState:this.announceAccessibleState,addIncludeAllCompany:this.addIncludeAllCompany.bind(this),clearSelectedOption:this.clearSelectedOption.bind(this),activeCompletableModels:this.activeCompletableModels,updateNoticesFromSettings:this.updateNotices.bind(this),filterUsingFilterFromSettings:this.filterUsingFilterFromSettings.bind(this),onListUpdateFromSettings:this.onListUpdateFromSettings.bind(this),getSearchText:this.getSearchText.bind(this),isAdditionalOptionSet:this.isAdditionalOptionSet.bind(this),createAdditionalOptionsHtml:this.createAdditionalOptionsHtml.bind(this),_isForeign:this._isForeign.bind(this),_addForeignEmailSuggestions:this._addForeignEmailSuggestions.bind(this),hideHint:this.hideHint.bind(this),show:this.show.bind(this),addDomains:this.addDomains.bind(this),underlineTerm:this.underlineTerm.bind(this)})},buildHeader:function(a){var b=this.settings.modelTitles[a]||a;this.settings.headerTruncationLength&&this.settings.headerTruncationLength>0&&(b=l.truncate(b,this.settings.headerTruncationLength));var d=c(a),e={title:b,modelName:a,icon:d};return this.createHeaderComponent(e).render().$el},createHeaderComponent:function(a){var b=new C(a);return this._subviews.resultsGroupingHeaders[a.modelName]=b,b},buildOgoHeader:function(a){var b,c={};return e.indexOf(J,a.client_application_id)>-1?(b=v.OGO,c.title=b.title,c.icon=b.icon):(c.title=a.client_application_name,"Web"===c.title?c.icon="yamicon-rd_apps":c.iconUrl=a.client_application_icon),this.settings.headerTruncationLength&&this.settings.headerTruncationLength>0&&(c.title=l.truncate(c.title,this.settings.headerTruncationLength)),c.modelName=this.getOgoId(a.client_application_id),this.createHeaderComponent(c).render().$el},underlineTerm:function(a){var b=this.removePrefix(this.getSearchText());p.underlineTerm(a,b,".yj-ta-name")},defaultBuildOption:function(a,b){var c,g,h=this.withHeaders()?this.isWideMode()?125:26:0,i="yj-ta-model-"+b;return e.isEmpty(this.getStyles())||(h=this.getWidth()),b===v.OGO.id&&(i="yj-ta-model-"+this.getOgoId(a.client_application_id)),c={id:b+"-"+a.id,width:this.$element.width()-10-h,modelClass:i,name:e.escape(this.buildName(a,b)),byline:this.buildDescription(a,b),img:this.buildImage(a,b),official:a.official},g=d(f.render(D(),c)),c.width>0&&g.width(c.width),j.trigger("/ui/tooltip/add",{target:g.find(".official-badge-small"),text:"page"===a.model?n.t("marked_as_an_official_note"):n.t("marked_as_an_official_note_file")}),a.type=b,g},getOgoId:function(a){return v.OGO.id+"-"+a},buildName:function(a,b){switch(b){case v.TOPIC.id:return"# "+a.name;case v.FILE.id:return a.title||"";case v.PAGE.id:return a.title||n.t("untitled_note");case v.PENDINGUSER.id:return a.full_name||a.email;case v.USER.id:return a.full_name||a.name;case v.GROUP.id:return a.full_name||a.name;case v.DOMAIN.id:var c=this.removePrefix(this.getSearchText());return-1!==c.indexOf("@")&&(c=c.substring(0,c.indexOf("@"))),a.name=c+"@"+(a.name||""),a.name;case v.OGO.id:return a.title;default:return a.name||""}},buildDescription:function(a,b){var c,d;if(null==this._networkId){var g=k.getCurrentNetwork();this._networkId=g&&g.id}if(this._matchIsForeignUserModel(a,b))return f.render(G(),{byLine:s.getNetworkName(a,A),foreignIconAltText:n.t("other_network_icon_alttext")});if(this._matchIsForeignGroupModel(a,b))return f.render(G(),{byLine:a.network_name,foreignIconAltText:n.t("other_network_icon_alttext")});switch(b){case v.FILE.id:case v.PAGE.id:return e.escape(a.group)||"";case v.GROUP.id:return e.escape(a.description)||"";case v.PENDINGUSER.id:return"Notify and add them";case v.USER.id:return("pending"===a.state?a.email:e.escape(a.job_title))||"";case v.OGO.id:return a.client_application_id===H||a.client_application_id===I?!a.site_name||a.site_name.length<1?(d=o.parse(a.web_url),c=d.host.replace(/^www\./,"")):c=a.site_name:c=l.capitalize(a.object_type)+" in "+a.client_application_name,c=e.escape(c),f.render(F(),{byline:c});default:return""}},_matchIsForeignUserModel:function(a,b){var c=b===v.USER.id;return c&&this._isForeign(a)},_matchIsForeignGroupModel:function(a,b){var c=b===v.GROUP.id;return c&&this._isExternal(a)},_isForeign:function(a){var b=a.network_id;return null!=this._networkId&&null!=b&&b!=this._networkId},_isExternal:function(a){return!!a.external},buildImage:function(a,b){switch(b){case v.USER.id:case v.PENDINGUSER.id:return a.photo||y.cdn("assets/images/no_photo_small.gif");case v.GROUP.id:return a.photo||y.cdn("assets/images/group_profile_small.gif");case v.OGO.id:return a.image||"";default:return""}},defaultAdditionalOption:function(){return this.$field.parents("div[data-yj-component=header-navbar]").length?"<a href='#'>"+n.t("see_more_search_results")+"</a>":"<a href='#'>"+n.t("see_all_search_results")+"</a>"},displayHint:function(){var a,b=this.toTrigger?this.settings.toTriggerHintMessage:this.settings.hintMessage;this.settings.hintMessage&&!this.$results.find(".yj-ta-option").length?(this.$hint.text(b),this.$element.removeClass("yj-ta-empty"),this.$results.addClass("yj-ta-empty"),this.settings.showTopRankings&&""===this.removePrefix(this.getSearchText())&&(a=u.cache(""),a&&e.any(this.activeCompletableModels,function(b){return void 0!==a[b]})&&(this.matches=a,this.updateList())),this.$hint.show()):(this.settings.showTopRankings||this.settings.showTopRankingsOnce)&&""===this.removePrefix(this.getSearchText())?(a=u.cache(""),a&&e.any(this.activeCompletableModels,function(b){return void 0!==a[b]})&&(this.$hint.text(b),this.$element.removeClass("yj-ta-empty"),this.matches=a,this.updateList(),this.$hint.toggle(null!=b)),this.settings.showTopRankingsOnce&&(this.settings.showTopRankingsOnce=!1)):(this.$hint.hide(),this.$results.find(".yj-ta-option").length?this.$element.removeClass("yj-ta-empty"):this.$element.addClass("yj-ta-empty")),this.settings.onListUpdate&&this.settings.onListUpdate(!1,this.$results)},reset:function(){this.deactivate(),this.unbindEvents(),this.lastSearch="",this.settings={},this.wordStart=null,this.currentTrigger=null,this.toTrigger=!1,this.matches=null,this.pluggableEnhancerMode=!1,this.$results.removeClass("yj-ta-has-additional").empty(),this.$hint.empty(),this.settings.onSelect=null,this.settings.onMark=null,this.settings.onTab=null,this.settings.onEnter=null,this.settings.onListUpdate=null,this.activeCompletableModels=[],this.$element.removeClass("yj-ta-wide yj-ta-has-additional")},detectTriggers:function(){if(this.$field.val()){var a=this.$field.caretPos?this.$field.caretPos():p.caretPos(this.$field),b=this.$field.rawText?this.$field.rawText():this.$field.val(),c=this,d=b.split();
d.splice(a,0,"|"),this.activeCompletableModels=[],e.each(this.settings.triggerStrings,function(d,f){if(!(e.indexOf(c.settings.completableModels,f)<=-1))for(var g=0,h=d.length;h>g;g++){if(!d[g].exec&&"to:"===d[g].toLowerCase()&&(!b.match(/^to:/gi)||b.match(/to:/gi).length>1))return;var i=d[g],j=a-++i.length,k=new RegExp("^(\\s|[^A-Za-z0-9])"+l.escapeRegExp(i.toString())+"$|^"+l.escapeRegExp(i.toString())+"$");i.exec&&(k=i,i=b.substring(j,a).match(k),i=i&&i[0]||"",j=a-++i.length),b.substring(j,a).match(k)&&(a+1<b.length&&!b.charAt(a).match(/\s|\n/)&&setTimeout(function(){var d;p.caretPos(c.$field)===a&&(d=b.split(""),c.$field.val(d.join("")),w.setCaretPosition(c.$field,a))},300),this.toTrigger="to:"===i.toLowerCase(),this.activate(),this.activeCompletableModels.push(f),this.wordStart=++j,this.currentTrigger=i,this.positionElement())}},this)}},selectOption:function(a){var b=this.getSelectedOption(),c=this.$results.find(".yj-selected"),d=this.$results.find(".yj-ta-option"),e=d.index(c),f=d.length;this.$field.focus(),this.deactivate(),this.settings.onSelect(b,a,e+1,f),!this.settings.insertionMode&&this.settings.clearInput&&(this.$field.val(""),this.lastSearch=""),a.preventDefault()},getSelectedOption:function(){var a=this.$results.find(".yj-selected").data("item");return a},clearSelectedOption:function(){var a=this.$results.find(".yj-selected").removeClass("yj-selected").data("option-id");a&&(this.previousSelected=a)},markOption:function(a,b){var c,d="next"===a?"first":"last",e=this.$results.find(".yj-selected");this.$results.find(".yj-ta-option, .yj-ta-additional").length&&(e.length&&(c=e.removeClass("yj-selected")[a+"All"]("dd, .yj-ta-additional").first()),c&&c.length||(c=this.$results.find(".yj-ta-option, .yj-ta-additional")[d]()),c.addClass("yj-selected"),this.announceAccessibleState(c),this.settings.onMark(c.data("item"),b))},getSearchText:function(){var a,b,c,d;return this.settings.getSearchText?this.settings.getSearchText():(d=this.$field.rawText?this.$field.rawText():this.$field.val(),this.settings.insertionMode&&(a=d.indexOf(" ",this.wordStart),b=d.indexOf("\n",this.wordStart),c=0>a&&0>b?d.length:0>a?b:0>b?a:Math.min(b,a),d=d.substring(this.wordStart,c)),d)},isTextEmpty:function(){return""===this.getSearchText()},getRawSearchText:function(){return this.removePrefix(this.getSearchText())},isTextSelected:function(){var a="";return window.getSelection?a=window.getSelection():document.getSelection&&(a=document.getSelection()),""!==a},checkField:function(){var a=this.getSearchText();return this.settings.showOnEmptyString&&""===a||a===this.currentTrigger?(this.displayHint(),void(this.lastSearch=a)):(a!==this.lastSearch?this.getSuggestions(a):!a&&this.active&&this.settings.insertionMode&&!this.isTextSelected()&&this.deactivate(),void(this.lastSearch=a))},getStyles:function(){var a=this.settings.styles;return e.isArray(a)?a:e.isString(a)?a.split(" "):[]},addStyles:function(){e.each(this.getStyles(),function(a){this.$element.addClass("yj-ta-style-"+a)},this)},removeStyles:function(){var a=e.filter(this.$element.attr("class").split(" "),function(a){return a.indexOf("yj-ta-style-")<0});this.$element.attr("class",a.join(" "))},getSuggestions:function(){var a=this.getSearchText(),b=this.removePrefix(a);return this.matches=null,this.clearSelectedOption(),""!==b||this.settings.showTopResults?(this.lastSearch=b,void(a&&(this._canSuggestForeignEmail(b)?this.handleSuggestions({},b,!0):this._getRemoteSuggestionsAsync(b)))):void this.updateList(!1,!0)},_canSuggestForeignEmail:function(a){return this.settings.allowForeignEmails&&this._isPotentialEmailMatch(a)},_isPotentialEmailMatch:function(a){return r.hasValidFirstHalfOfEmail(a)},_getRemoteSuggestionsAsync:function(a){var b=d.extend(!0,{preference:"official,ranked"},this.settings.optionalParams);this.ajax=u.throttleGet({prefix:a,models:this.activeCompletableModels,fetchSize:Math.min(50,10*a.length+10),data:b,success:this.handleSuggestions.bind(this),lookcache:!this.settings.noCache,debounce:this.settings.debounce})},_addForeignEmailSuggestions:function(a){var b=a.domain;b||(a.domain=b=[]);var c=this.getRawSearchText(),d=this._canSuggestForeignEmail(c)&&b.every(function(a){return a.id!==c});return d&&b.unshift({name:this._charactersAfterAtSign(c),id:c,email:c,foreign:!0,foreignEmailSuggestion:!0}),a},_charactersAfterAtSign:function(a){var b=a.indexOf("@");return a.substring(b+1)},handleSuggestions:function(a,b,c){a.departments&&(a.department=a.departments,delete a.departments),this.active&&b===this.removePrefix(this.lastSearch)&&(this.matches=a,this.updateList(c))},addResultsScrollbar:function(){this.$results.addClass("yj-ta-results-scrollable")},removeResultsScrollbar:function(){this.$results.css("max-height",""),this.$results.removeClass("yj-ta-results-scrollable")},removePrefix:function(a){return this.currentTrigger&&0===a.indexOf(this.currentTrigger)?a.substring(this.currentTrigger.length,a.length):a},showManually:function(){this.activeCompletableModels=this.settings.completableModels,this.lastSearch="",this.activate(),this.positionElement(),this.checkField()},hideManually:function(){this.deactivate()},announceAccessibleState:function(a,b){if(t){var c="",d=b&&b.announceInstructions;if(d&&(c+=n.t("autocomplete_list")+". "),a&&a[0]){var e=a.find(".yj-ta-content");e.length||(e=a),c+=e.text(),c+=". "}d&&(c+=n.t("use_shift_plus_up_and_down_arrow_keys_to_move")),t.announceText(c,"assertive")}}})}),define("common-ui/lib/ui/shared/type_ahead",["require","jquery","common-ui/lib/ui/shared/type_ahead_component"],function(a){var b=a("jquery"),c=a("common-ui/lib/ui/shared/type_ahead_component"),d=new c;return d.render(),b(function(){b(d.target).append(d.$el)}),d}),define("common-ui/lib/ui/shared/input/direction_aware_text_input",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","core/lib/i18n","core/lib/session","core/lib/string_helper","jquery-watermark"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/i18n"),g=a("core/lib/session"),h=a("core/lib/string_helper");return a("jquery-watermark"),c.extend({mixins:[d,e],tagName:"input",events:{keydown:"_onKeydown"},initialize:function(a){this.placeholder=a.placeholder,this.usesLegacyInputEvents=!1,this.detectionString=void 0,this._updatePlaceholder(),this._listenForInput(),this._listenForDirectionChanges()},remove:function(){return this._removeListeners(),c.prototype.remove.call(this)},enable:function(){return this.$el.prop("disabled",!1),this},disable:function(){return this.$el.prop("disabled",!0),this},clear:function(){return this.val(""),this},val:function(){return this.$el.val.apply(this.$el,arguments)},focus:function(){return this.$el.focus(),this},blur:function(){return this.$el.blur(),this},_updatePlaceholder:function(){this.placeholder&&this.$el.watermark(this.placeholder)},_listenForInput:function(){b.bindAll(this,"_onInput");var a=this;"undefined"!=typeof this.el.oninput?this.$el.on("input keyup",this._onInput):"undefined"!=typeof this.el.onpropertychange&&(this.el.attachEvent("onpropertychange",function(b){"value"===b.propertyName&&a._onInput(b)}),this.usesLegacyInputEvents=!0)},_listenForDirectionChanges:function(){if("function"==typeof window.MutationObserver){b.bindAll(this,"_onElementMutated"),this._observer=new MutationObserver(this._onElementMutated);var a={attributes:!0,attributeFilter:["dir"]};this._observer.observe(this.$el.get(0),a)}},_removeListeners:function(){this._observer&&(this._observer.disconnect(),this._observer=void 0),this.usesLegacyInputEvents?this.el.detachEvent("onpropertychange",this._onInput):this.$el.off("input keyup",this._onInput)},_onElementMutated:function(){this.trigger("textDirectionChanged",this.$el.attr("dir"))},_onInput:function(){var a=this.$el.val();if(!this.detectionString||0!==a.indexOf(this.detectionString)){var b=f.getTextDirectionByFirstStrongCharacter(a);b&&(this.detectionString=a,this.$el.attr("dir",b))}this.trigger("input")},_onKeydown:function(a){if(13===a.which){var b=g.getCurrentUser(),c=b&&b.web_preferences,d=c?!h.convertStringyBoolean(c.enter_does_not_submit_message):!1;(d&&!a.shiftKey||!d&&a.shiftKey)&&(a.preventDefault(),this.trigger("submit"))}}})}),define("feeds/lib/ui/shared/type_ahead_manager",["require","underscore","core/lib/ctor","common-ui/lib/ui/shared/autocompletion","common-ui/lib/ui/shared/autocompletion/autocomplete_models","common-ui/lib/ui/shared/type_ahead"],function(a){var b=a("underscore"),c=a("core/lib/ctor"),d=a("common-ui/lib/ui/shared/autocompletion"),e=a("common-ui/lib/ui/shared/autocompletion/autocomplete_models"),f=a("common-ui/lib/ui/shared/type_ahead");return c(null,{init:function(a){this._autocomplete=d,this._models=[e.USER.id,e.PENDINGUSER.id],this.target=a.target,this.$field=a.$field,this.maxResults=a.maxResults,this.textCallback=a.textCallback,this.positionCallback=a.positionCallback,this.selectCallback=a.selectCallback,this.filter=a.filter,this.groupId=a.groupId,this.allowForeignUsers=!!a.allowForeignUsers,this._registerTypeahead()},_registerTypeahead:function(){f.registerField(this.$field,{target:this.target,insertionMode:!0,width:260,allowWide:!1,styles:"reduced",completableModels:this._models,maxResults:this.maxResults,triggerStrings:{},showTopRankings:!1,showOnEmptyString:!0,displayHeaders:!1,optionalParams:{groupId:this.groupId},getSearchText:this.textCallback,getPosition:this.positionCallback,onSelect:this.selectCallback,filter:this.filter,debounce:!1,allowForeignUsers:this.allowForeignUsers})},_unregisterTypeahead:function(){f.removeField(this.$field)},destroy:function(){this._unregisterTypeahead()},models:function(){return this._models},cache:function(){return this._autocomplete.cache.apply(this._autocomplete,arguments)},showTypeahead:function(){this.isCurrentTypeahead()&&(f.showManually(),this.onShownTypeahead())},onShownTypeahead:function(){},hideTypeahead:function(){this.isCurrentTypeahead()&&(f.hideManually(),this.onHiddenTypeahead())},onHiddenTypeahead:function(){},hideTypeaheadWithDelay:function(a){b.delay(this.hideTypeahead.bind(this),a)},isCurrentTypeahead:function(){var a=f.$field,b=this.$field;return"function"==typeof a.attr&&"function"==typeof b.attr&&a.attr("id")===b.attr("id")},isTypeaheadVisible:function(){return this.isCurrentTypeahead()&&f.active},moreResultsFromCompletieFor:function(a){return this._autocomplete.moreResultsFromCompletieFor.call(this._autocomplete,"user",a)}})}),define("stache!common-ui/lib/ui/accessibility/focus_helper",["mustache"],function(a){var b='{{! tabindex=-1 used so that this can receive focus. Must contain\n    at least a single space else Chrome may ignore it and think focus\n    is actually somewhere else. }}\n<{{el}} role="presentation" class="yj-focus-helper-placeholder" tabindex="-1"> </{{el}}>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/accessibility/focus_helper",[],function(){}),define("common-ui/lib/ui/accessibility/focus_helper",["require","jquery","html!./focus_helper","css!./focus_helper"],function(a){"use strict";var b=a("jquery"),c=a("html!./focus_helper");return a("css!./focus_helper"),{notifyRemoval:function(a){var d=b(a);if(d[0]!==document.activeElement&&!b.contains(d[0],document.activeElement))return!1;var e="div";"OL"!==d.parent()[0].tagName&&"UL"!==d.parent()[0].tagName||(e="li");var f=b(c({el:e}));f.insertBefore(d),f.focus(),b(document.body).on("focusin.focusplaceholder",function(a){a.target!==f[0]&&(f.remove(),b(document.body).off("focusin.focusplaceholder"))})}}}),define("css!feeds/lib/ui/shared/type_ahead_publisher_field",[],function(){}),define("feeds/lib/ui/shared/type_ahead_publisher_field",["require","jquery","underscore","core/lib/ctor","core/lib/report","core/lib/jam/component2","common-ui/lib/ui/shared/input/direction_aware_text_input","models/thread","common-ui/lib/ui/shared/type_ahead","feeds/lib/ui/shared/type_ahead_manager","backbone","core/lib/session","core/lib/string_helper","models/helpers/user","common-ui/lib/helper/environment","common-ui/lib/helper/ui","common-ui/lib/ui/accessibility/focus_helper","models/network","jquery-watermark","css!./type_ahead_publisher_field"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/ctor"),e=a("core/lib/report"),f=a("core/lib/jam/component2"),g=a("common-ui/lib/ui/shared/input/direction_aware_text_input"),h=a("models/thread"),i=a("common-ui/lib/ui/shared/type_ahead"),j=a("feeds/lib/ui/shared/type_ahead_manager"),k=a("backbone"),l=a("core/lib/session"),m=a("core/lib/string_helper"),n=a("models/helpers/user"),o=a("common-ui/lib/helper/environment"),p=a("common-ui/lib/helper/ui"),q=a("common-ui/lib/ui/accessibility/focus_helper"),r=a("models/network");a("jquery-watermark"),a("css!./type_ahead_publisher_field");var s=2,t=5,u=m.escapeRegExp("!\"#$%&'()*+,-./:;@<=>?[\\]^_`{|}~"),v="A-ZÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝÞ",w=new RegExp(["(^|\\s|[",u,"])","(?:","(","\\@","[^\\s]*","\\s?","[^\\s]*",")","|","(","[",v,"]","[^\\s]{"+(s-1)+",}","\\s?","[^\\s]*",")",")$"].join(""));return d(null,f,{watermark:"",template:'      <div class="yj-tapf-container">        <div class="yj-tapf-wrap">          <div class="yj-tapf-highlighter" aria-hidden="true"><span class="yj-tapf-precaret"></span><span class="yj-tapf-incaret"></span><span class="yj-tapf-postcaret"></span> </div>          <label>            <span class="yj-acc-label-text yj-acc-hidden"></span>            <span class="yj-tapf-textarea-container">            </span>          </label>        </div>      </div>    ',onLoad:function(){this._rendered=!1,this._preRenderRefresh=!1,c.bindAll(this,"_onTextInputDirectionChanged");var a=new g({tagName:"textarea",className:"yj-tapf-textarea",attributes:{"aria-haspopup":"true","aria-autocomplete":"list",maxlength:"10000"}});a.on("textDirectionChanged",this._onTextInputDirectionChanged),a.attachPoint=".yj-tapf-textarea-container",this.add("textInput",a)},_onTextInputDirectionChanged:function(a){this.$highlighter.attr("dir",a)},typeaheadPositions:[{name:"cursor",calculate:function(){var a=this.$wrap.position(),b=this.$incaret.position(),c=this.$incaret.outerHeight(),d=this.$el.offsetParent().width(),e=i.$el.width();return{left:Math.min(a.left+b.left+e,d)-e,top:a.top+b.top+c+1}}},{name:"below-publisher",calculate:function(){var a=this.$container.position(),b=this.$container.innerWidth()-this.$container.width(),c=this.$container.outerHeight();return{left:a.left-b/2,top:a.top+c}}}],onRendered:function(){this._mentions=[],this._selinfo={},this._reftext="",this._tamanager=null,this._selinfo.precaret="",this._selinfo.incaret="",this._selinfo.postcaret="",this._storeSelectors(),this._initTextarea(),this._initTypeaheadManager(),this.fixedHeight&&this.$container.addClass("yj-tapf-fixed"),this._preRenderRefresh&&(this._preRenderRefresh=!1,c.defer(this.refresh.bind(this))),this._observeTags(),this._rendered=!0},_observeTags:function(){k.on("/ui/publisher/removedTag",this._toggleEmphasisForMentionFalse,this),k.on("/ui/publisher/addedTag",this._toggleEmphasisForMentionTrue,this)},_toggleEmphasisForMentionFalse:function(a){this.toggleEmphasisForMention(!1,a)},_toggleEmphasisForMentionTrue:function(a){this.toggleEmphasisForMention(!0,a)},onDestroy:function(){this._tamanager&&this._tamanager.destroy(),k.off("/ui/publisher/removedTag",this._toggleEmphasisForMentionFalse,this),k.off("/ui/publisher/addedTag",this._toggleEmphasisForMentionTrue,this),this.textInput&&this.textInput.off("textDirectionChanged")},_storeSelectors:function(){this.$container=this.$el,this.$wrap=this.$el.find(".yj-tapf-wrap"),this.$highlighter=this.$el.find(".yj-tapf-highlighter"),this.$precaret=this.$el.find(".yj-tapf-precaret"),this.$incaret=this.$el.find(".yj-tapf-incaret"),this.$postcaret=this.$el.find(".yj-tapf-postcaret"),this.$textarea=this.textInput.$el},_initTextarea:function(){var a=this;if(this.watermark&&this.$textarea.watermark(this.watermark),this.accessibilityLabel||this.watermark){var b=this.accessibilityLabel||this.watermark;this.$container.find(".yj-acc-label-text").text(b),this.$textarea.attr("aria-label",b)}this.$container.on("click",function(){a.focus()}),this.$textarea.on("click focus",function(){a.refresh()}).on("blur",function(){a._tamanager.hideTypeaheadWithDelay(200)}).on("keydown cut paste",function(b){a._handleKeydownEvent(b)}).on("keyup",function(a){a.stopImmediatePropagation()})},_initTypeaheadManager:function(){var a=this;this._tamanager=new j({target:this.$container,$field:this.$textarea,maxResults:this.maxResults,groupId:this.groupId>0?this.groupId:-1,allowForeignUsers:this.allowForeignUsers,textCallback:function(){return a.getTypeaheadText().replace(/^@/,"")},positionCallback:function(){return a.getTypeaheadPosition()},selectCallback:function(b,c,d,f){var g=b.full_name||b.name;e.event("typeahead_select",{text:a.getTypeaheadText().length,name:g.length,model_type:b.model,model_id:b.id,ranking:b.ranking_index,index:d,total:f}),a.selectTypeaheadOption(b)},filter:function(d,e){var f=b.trim(a.getTypeaheadText()),g=f.lastIndexOf(" ");g=0>g?f.length:g;var h=f.substring(0,g),i=e.full_name||e.name;if(f.length>=t||0===f.indexOf("@")||!c.contains(a._tamanager.models(),d)||!i)return!0;var j=new RegExp("(\\s|^|["+u+"])"+m.escapeRegExp(h)+"(\\s|$|["+u+"])","i");return null!=i.match(j)}})},onAttach:function(){this.refresh()},content:function(a){return"undefined"==typeof a?this.$textarea.val():(this.$textarea.val(a),void this.refresh())},reset:function(){this.content(""),this._tamanager.hideTypeahead()},val:function(){return this._updateReferencedText(),this._reftext},show:function(){this.$el.show.apply(this.$el,arguments)},hide:function(){this.$el.hide.apply(this.$el,arguments)},focus:function(){this.$textarea.focus()},blur:function(){this.$textarea.blur()},isFocused:function(){return this.$textarea.is(":focus")},caret:function(a){return"undefined"==typeof a?p.getCaretPosition(this.$textarea.get(0)):p.setCaretPosition(this.$textarea.get(0),a)},enableSelf:function(){this.$textarea&&this.$textarea.prop("disabled",!1).removeClass("yj-disabled"),f.prototype.enableSelf.call(this)},disableSelf:function(){this.$textarea&&(q.notifyRemoval(this.$textarea),this.$textarea.prop("disabled",!0).addClass("yj-disabled")),f.prototype.disableSelf.call(this)},_handleKeydownEvent:function(a){var b=this,d=!0,e=!1,f=l.getCurrentUser(),g=f&&f.web_preferences,h=g?!m.convertStringyBoolean(g.enter_does_not_submit_message):!1;switch(a.which){case 8:this._removeMentionBeforeCursor()&&a.preventDefault();break;case 13:(h&&!a.shiftKey||!h&&a.shiftKey)&&(a.preventDefault(),this.trigger("submit")),e=!0;break;case 9:case 16:case 17:case 18:case 91:case 92:d=!(a.shiftKey||a.ctrlKey||a.altKey||a.metaKey),e=!0;break;case 27:this._tamanager.isTypeaheadVisible()?(a.preventDefault(),this._tamanager.hideTypeahead(),d=!1):(d=!1,e=!0,a.preventDefault());break;case 37:case 38:case 39:case 40:d=!1,e=!0}"paste"===a.type&&(e=!0),d&&c.defer(function(){b.refresh(a)}),e||a.stopImmediatePropagation()},refresh:function(a){if(null!=this.$el){this._rendered||(this._preRenderRefresh=!0),this._updateMentions(),this._updateReferencedText(),this._updateSelectionInfo(),this._updateHighlighter(),this._updateWidth(),this._updateHeight(),this.triggerValidation(),this.triggerChange(a);var b=this.getTypeaheadText();b.length>0?this._tamanager.showTypeahead():this._tamanager.hideTypeahead()}},triggerValidation:function(){this.trigger("validation",!0)},triggerChange:function(a){this.trigger("change",a)},_removeMentionBeforeCursor:function(){var a=this.caret(),b=this.content(),c=b.substr(0,a),d=this._findLastMentionInText(c);if(null!=d&&d.offset.end===a){var e=b.substr(0,d.offset.start)+b.substr(d.offset.end);return this.content(e),this.caret(d.offset.start),!0}return!1},_updateMentions:function(){var a=this.content(),b=this.getUniqueMentions(),d=c.reduce(b,this._getMentionDataFromText.bind(this,a),[]),e=c.reject(b,function(a){return c.any(d,function(b){return b.name===a.name})});c.each(e,function(a){this.trigger("mentionRemoved",a)},this),this.resetMentions(d)},_getMentionDataFromText:function(a,b,c){for(var d,e=this._getFullName(c),f=new RegExp(m.escapeRegExp(e),"g");null!==(d=f.exec(a));){var g=this._createMentionObject(c);g.offset={start:d.index,end:d.index+d[0].length},b.push(g)}return b},_updateReferencedText:function(){this._reftext=this._replaceMentionsInText(this.content())},_updateSelectionInfo:function(){this._selinfo=this._generateSelectionInfo()},_updateHighlighter:function(){this.$precaret.html(this._replaceMentionsInHtml(this._precaret())),this.$incaret.html(this._cleanupHtml(this._incaret())),this.$postcaret.html(this._replaceMentionsInHtml(this._postcaret()))},width:function(a){return"undefined"==typeof a?this.$highlighter.width():void this.$textarea.width(a+(b.browser.mozilla?2:o.isOlderIE()?4:0))},_updateWidth:function(){this.width(this.width())},height:function(a){return"undefined"==typeof a?this.$highlighter.height():(this.$textarea.height(a),this.$wrap.height(a),void k.trigger("/ui/lightbox/resize"))},_updateHeight:function(){this.height(this.height()+1)},_generateSelectionInfo:function(){var a=this.content(),b=this.caret(),c=a,d="",e="";return this._isPositionInsideMention(b)||(c=a.substring(0,b),e=a.substring(b),d=this._findTriggerInText(c),c=this._removeTriggerInText(c,d),this._isPositionInsideMention(b-d.length)&&(c=a,d="",e="")),{precaret:c,incaret:d,postcaret:e}},_precaret:function(){return this._selinfo.precaret},_incaret:function(){return this._selinfo.incaret},_postcaret:function(){return this._selinfo.postcaret},_isPositionInsideMention:function(a){var b=c.find(this._mentions,function(b){return a>b.offset.start&&a<=b.offset.end});return void 0!==b},_findTriggerInText:function(a){var b=this._findLastMentionInText(a),c=null!=b?b.offset.end:0,d=a.substr(c).match(w),e=null!=d?d[2]||d[3]:"";return this._excludeUnmatchedFirstName(e)},_findLastMentionInText:function(a){var b=-1,d=null;return c.each(this.getUniqueMentions(),function(c){for(var e,f=this._getFullName(c),g=new RegExp(m.escapeRegExp(f),"g"),h=-1;null!==(e=g.exec(a));)h=e.index;h>b&&(b=h,d=this._createMentionObject(c),d.offset={start:b,end:b+f.length})},this),d},_excludeUnmatchedFirstName:function(a){var b=a.lastIndexOf(" ");if(0>b)return a;var c=a.substring(0,b).replace(/^@/,""),d=a.substring(b+1),e=c+" "+d,f=this._tamanager.cache(e),g=null!=f&&null!=f.user&&f.user.length>0,h=this._tamanager.moreResultsFromCompletieFor(e);return g||h?a:this._findTriggerInText(d)},_removeTriggerInText:function(a,b){return a.substr(0,a.length-b.length)},_replaceTriggerInTextareaWith:function(a){var b=this._precaret()+a+" ",c=this._postcaret();this._replaceTextareaWith(b,c)},_replaceTextareaWith:function(a,b){this.content(a+b),this.caret(a.length)},_replaceMentionsInText:function(a){return this._replaceMentions(a,c.bind(function(a){var b=this._getFullName(a);return new RegExp(m.escapeRegExp(b)+"(\\W)?","g")},this),function(a){return function(b,c){return c&&/[^\u0000-\u00ff]/.test(c)&&(c=" "+c),"[["+a.type+":"+a.id+"]]"+(c||" ")}})},_replaceMentionsInHtml:function(a){var b=this;return this._replaceMentions(b._cleanupHtml(a),c.bind(function(a){var c=this._getFullName(a);return new RegExp(m.escapeRegExp(b._cleanupHtml(c)),"g")},this),c.bind(function(a){var c=this._getFullName(a),d=a.noCC?"yj-tapf-mention-no-cc":"";return function(){return'<span class="yj-tapf-mention '+d+'" data-user-id="'+a.id+'">'+b._cleanupHtml(c)+"</span>"}},this))},_replaceMentions:function(a,b,d){return c.each(this.getUniqueMentions(),function(c){a=a.replace(b(c),d(c))}),a},_cleanupHtml:function(a){return a=c.escape(a),a=a.replace(/\r\n|[\r\n]/g,"<br/>")},getTypeaheadText:function(){return this._incaret()},getTypeaheadPosition:function(){var a=this.typeaheadPosition||"cursor";if(!this._getTypeaheadPositionFunction){var b=c.find(this.typeaheadPositions,function(b){return b.name===a});b&&(this._getTypeaheadPositionFunction=b.calculate)}return this._getTypeaheadPositionFunction?this._getTypeaheadPositionFunction.call(this):null},selectTypeaheadOption:function(a){var b=this.addMention(this._createMentionObject(a));this._replaceTriggerInTextareaWith(this._getFullName(b)),this.refresh(),this.focus()},_isForeignMention:function(a){return n.isForeign(a,l)},_createMentionObject:function(a){var b={id:a.id,name:a.name,full_name:a.full_name||a.name,network_id:a.network_id,network_name:a.network_name,email:a.email,type:a.type,state:a.state,noCC:!1};if(this._isForeignMention(b)&&!b.network_name){var d=n.getNetworkName(b,r);null!=d&&(b.network_name=d)}if("user"===a.type&&a.group_ids&&(b.group_ids=a.group_ids),a.noCC)b.noCC=a.noCC;else if("user"==a.type){var e;if(this.isInPM&&!this.threadId){var f=this.parent.addressBar.tagList.tags;e=c.filter(f,function(b){return b.id==a.id}).length,b.noCC=!e}else{var g=h.findById(this.threadId);g&&"private"==g.privacy&&g.participants&&(e=c.filter(g.participants,function(b){return b.id==a.id}).length,b.noCC=!e)}}return b},getMentions:function(){return this._mentions},getUniqueMentions:function(){return c.chain(this._mentions).uniq(!1,function(a){return a.name}).map(this._createMentionObject,this).value()},findMention:function(a){return c.find(this._mentions,function(b){return a==b.id})},addMention:function(a){return this._mentions.push(a),this.trigger("mentionAdded",a),a},removeMentionsByUser:function(a){this._mentions=c.reject(this._mentions,function(b){return b.id===a}),this._updateHighlighter()},toggleEmphasisForMention:function(a,b){this.$el.find('.yj-tapf-mention[data-user-id="'+b+'"]').toggleClass("yj-tapf-mention-no-cc",!a);var c=this.findMention(b);c&&(c.noCC=!a)},resetMentions:function(a){this._mentions=a},serialize:function(){return JSON.stringify({content:this.content(),mentions:this.getUniqueMentions()})},deserialize:function(a){var b=JSON.parse(a);b&&(b.content&&this.content(b.content),b.mentions&&this.resetMentions(b.mentions))},_getFullName:function(a){var b=a.full_name;return this._isForeignMention(a)&&a.network_name&&(b+=" ("+a.network_name+")"),b}})}),/**
 * mOxie - multi-runtime File API & XMLHttpRequest L2 Polyfill
 * v1.2.1
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2014-05-14
 */
!function(a,b){"use strict";function c(a,b){for(var c,d=[],f=0;f<a.length;++f){if(c=g[a[f]]||e(a[f]),!c)throw"module definition dependecy not found: "+a[f];d.push(c)}b.apply(null,d)}function d(a,d,e){if("string"!=typeof a)throw"invalid module definition, module id must be defined and be a string";if(d===b)throw"invalid module definition, dependencies must be specified";if(e===b)throw"invalid module definition, definition function must be specified";c(d,function(){g[a]=e.apply(null,arguments)})}function e(b){for(var c=a,d=b.split(/[.\/]/),e=0;e<d.length;++e){if(!c[d[e]])return;c=c[d[e]]}return c}function f(c){for(var d=0;d<c.length;d++){for(var e=a,f=c[d],h=f.split(/[.\/]/),i=0;i<h.length-1;++i)e[h[i]]===b&&(e[h[i]]={}),e=e[h[i]];e[h[h.length-1]]=g[f]}}var g={},h="moxie/core/utils/Basic",i="moxie/core/I18n",j="moxie/core/utils/Mime",k="moxie/core/utils/Env",l="moxie/core/utils/Dom",m="moxie/core/Exceptions",n="moxie/core/EventTarget",o="moxie/core/utils/Encode",p="moxie/runtime/Runtime",q="moxie/runtime/RuntimeClient",r="moxie/file/Blob",s="moxie/file/File",t="moxie/file/FileInput",u="moxie/file/FileDrop",v="moxie/runtime/RuntimeTarget",w="moxie/file/FileReader",x="moxie/core/utils/Url",y="moxie/file/FileReaderSync",z="moxie/xhr/FormData",A="moxie/xhr/XMLHttpRequest",B="moxie/runtime/Transporter",C="moxie/image/Image",D="moxie/runtime/html5/Runtime",E="moxie/runtime/html5/file/Blob",F="moxie/core/utils/Events",G="moxie/runtime/html5/file/FileInput",H="moxie/runtime/html5/file/FileDrop",I="moxie/runtime/html5/file/FileReader",J="moxie/runtime/html5/xhr/XMLHttpRequest",K="moxie/runtime/html5/utils/BinaryReader",L="moxie/runtime/html5/image/JPEGHeaders",M="moxie/runtime/html5/image/ExifParser",N="moxie/runtime/html5/image/JPEG",O="moxie/runtime/html5/image/PNG",P="moxie/runtime/html5/image/ImageInfo",Q="moxie/runtime/html5/image/MegaPixel",R="moxie/runtime/html5/image/Image",S="moxie/runtime/flash/Runtime",T="moxie/runtime/flash/file/Blob",U="moxie/runtime/flash/file/FileInput",V="moxie/runtime/flash/file/FileReader",W="moxie/runtime/flash/file/FileReaderSync",X="moxie/runtime/flash/xhr/XMLHttpRequest",Y="moxie/runtime/flash/runtime/Transporter",Z="moxie/runtime/flash/image/Image",$="moxie/runtime/silverlight/Runtime",_="moxie/runtime/silverlight/file/Blob",aa="moxie/runtime/silverlight/file/FileInput",ba="moxie/runtime/silverlight/file/FileDrop",ca="moxie/runtime/silverlight/file/FileReader",da="moxie/runtime/silverlight/file/FileReaderSync",ea="moxie/runtime/silverlight/xhr/XMLHttpRequest",fa="moxie/runtime/silverlight/runtime/Transporter",ga="moxie/runtime/silverlight/image/Image",ha="moxie/runtime/html4/Runtime",ia="moxie/runtime/html4/file/FileInput",ja="moxie/runtime/html4/file/FileReader",ka="moxie/runtime/html4/xhr/XMLHttpRequest",la="moxie/runtime/html4/image/Image";d(h,[],function(){var a=function(a){var b;return a===b?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},b=function(d){var e;return c(arguments,function(f,h){h>0&&c(f,function(c,f){c!==e&&(a(d[f])===a(c)&&~g(a(c),["array","object"])?b(d[f],c):d[f]=c)})}),d},c=function(a,b){var c,d,e,f;if(a){try{c=a.length}catch(a){c=f}if(c===f){for(d in a)if(a.hasOwnProperty(d)&&b(a[d],d)===!1)return}else for(e=0;c>e;e++)if(b(a[e],e)===!1)return}},d=function(b){var c;if(!b||"object"!==a(b))return!0;for(c in b)return!1;return!0},e=function(b,c){function d(e){"function"===a(b[e])&&b[e](function(a){++e<f&&!a?d(e):c(a)})}var e=0,f=b.length;"function"!==a(c)&&(c=function(){}),b&&b.length||c(),d(e)},f=function(a,b){var d=0,e=a.length,f=new Array(e);c(a,function(a,c){a(function(a){if(a)return b(a);var g=[].slice.call(arguments);g.shift(),f[c]=g,d++,d===e&&(f.unshift(null),b.apply(this,f))})})},g=function(a,b){if(b){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(b,a);for(var c=0,d=b.length;d>c;c++)if(b[c]===a)return c}return-1},h=function(b,c){var d=[];"array"!==a(b)&&(b=[b]),"array"!==a(c)&&(c=[c]);for(var e in b)-1===g(b[e],c)&&d.push(b[e]);return d.length?d:!1},i=function(a,b){var d=[];return c(a,function(a){-1!==g(a,b)&&d.push(a)}),d.length?d:null},j=function(a){var b,c=[];for(b=0;b<a.length;b++)c[b]=a[b];return c},k=function(){var a=0;return function(b){var c,d=(new Date).getTime().toString(32);for(c=0;5>c;c++)d+=Math.floor(65535*Math.random()).toString(32);return(b||"o_")+d+(a++).toString(32)}}(),l=function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},m=function(a){if("string"!=typeof a)return a;var b,c={t:1099511627776,g:1073741824,m:1048576,k:1024};return a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,"")),b=a[2],a=+a[1],c.hasOwnProperty(b)&&(a*=c[b]),a};return{guid:k,typeOf:a,extend:b,each:c,isEmptyObj:d,inSeries:e,inParallel:f,inArray:g,arrayDiff:h,arrayIntersect:i,toArray:j,trim:l,parseSizeStr:m}}),d(i,[h],function(a){var b={};return{addI18n:function(c){return a.extend(b,c)},translate:function(a){return b[a]||a},_:function(a){return this.translate(a)},sprintf:function(b){var c=[].slice.call(arguments,1);return b.replace(/%[a-z]/g,function(){var b=c.shift();return"undefined"!==a.typeOf(b)?b:""})}}}),d(j,[h,i],function(a,b){var c="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",d={mimes:{},extensions:{},addMimeType:function(a){var b,c,d,e=a.split(/,/);for(b=0;b<e.length;b+=2){for(d=e[b+1].split(/ /),c=0;c<d.length;c++)this.mimes[d[c]]=e[b];this.extensions[e[b]]=d}},extList2mimes:function(b,c){var d,e,f,g,h=this,i=[];for(e=0;e<b.length;e++)for(d=b[e].extensions.split(/\s*,\s*/),f=0;f<d.length;f++){if("*"===d[f])return[];if(g=h.mimes[d[f]])-1===a.inArray(g,i)&&i.push(g);else{if(!c||!/^\w+$/.test(d[f]))return[];i.push("."+d[f])}}return i},mimes2exts:function(b){var c=this,d=[];return a.each(b,function(b){if("*"===b)return d=[],!1;var e=b.match(/^(\w+)\/(\*|\w+)$/);e&&("*"===e[2]?a.each(c.extensions,function(a,b){new RegExp("^"+e[1]+"/").test(b)&&[].push.apply(d,c.extensions[b])}):c.extensions[b]&&[].push.apply(d,c.extensions[b]))}),d},mimes2extList:function(c){var d=[],e=[];return"string"===a.typeOf(c)&&(c=a.trim(c).split(/\s*,\s*/)),e=this.mimes2exts(c),d.push({title:b.translate("Files"),extensions:e.length?e.join(","):"*"}),d.mimes=c,d},getFileExtension:function(a){var b=a&&a.match(/\.([^.]+)$/);return b?b[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};return d.addMimeType(c),d}),d(k,[h],function(a){function b(a,b,c){var d=0,e=0,f=0,g={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},h=function(a){return a=(""+a).replace(/[_\-+]/g,"."),a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),a.length?a.split("."):[-8]},i=function(a){return a?isNaN(a)?g[a]||-7:parseInt(a,10):0};for(a=h(a),b=h(b),e=Math.max(a.length,b.length),d=0;e>d;d++)if(a[d]!=b[d]){if(a[d]=i(a[d]),b[d]=i(b[d]),a[d]<b[d]){f=-1;break}if(a[d]>b[d]){f=1;break}}if(!c)return f;switch(c){case">":case"gt":return f>0;case">=":case"ge":return f>=0;case"<=":case"le":return 0>=f;case"==":case"=":case"eq":return 0===f;case"<>":case"!=":case"ne":return 0!==f;case"":case"<":case"lt":return 0>f;default:return null}}var c=function(a){var b="",c="?",d="function",e="undefined",f="object",g="major",h="name",i="version",j={has:function(a,b){return-1!==b.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},k={rgx:function(){for(var b,c,g,h,i,j,k,l=0,m=arguments;l<m.length;l+=2){var n=m[l],o=m[l+1];if(typeof b===e){b={};for(h in o)i=o[h],typeof i===f?b[i[0]]=a:b[i]=a}for(c=g=0;c<n.length;c++)if(j=n[c].exec(this.getUA())){for(h=0;h<o.length;h++)k=j[++g],i=o[h],typeof i===f&&i.length>0?2==i.length?b[i[0]]=typeof i[1]==d?i[1].call(this,k):i[1]:3==i.length?b[i[0]]=typeof i[1]!==d||i[1].exec&&i[1].test?k?k.replace(i[1],i[2]):a:k?i[1].call(this,k,i[2]):a:4==i.length&&(b[i[0]]=k?i[3].call(this,k.replace(i[1],i[2])):a):b[i]=k?k:a;break}if(j)break}return b},str:function(b,d){for(var e in d)if(typeof d[e]===f&&d[e].length>0){for(var g=0;g<d[e].length;g++)if(j.has(d[e][g],b))return e===c?a:e}else if(j.has(d[e],b))return e===c?a:e;return b}},l={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},m={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[h,i,g],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[h,"Opera"],i,g],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[h,i,g],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[h,"IE"],i,g],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[h,"Yandex"],i,g],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[h,/_/g," "],i,g],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[h,i,g],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[h,"Dolphin"],i,g],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[h,"Chrome"],i,g],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[[h,"Android Browser"],i,g],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[i,g,[h,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[i,g,h],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[h,[g,k.str,l.browser.oldsafari.major],[i,k.str,l.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[h,i,g],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[h,"Netscape"],i,g],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[h,i,g]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[h,i],[/rv\:([\w\.]+).*(gecko)/i],[i,h]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[h,[i,k.str,l.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[h,"Windows"],[i,k.str,l.os.windows.version]],[/\((bb)(10);/i],[[h,"BlackBerry"],i],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[h,i],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[h,"Symbian"],i],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[h,"Firefox OS"],i],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[h,i],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[h,"Chromium OS"],i],[/(sunos)\s?([\w\.]+\d)*/i],[[h,"Solaris"],i],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[h,i],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[h,"iOS"],[i,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[h,[i,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[h,i]]},n=function(a){var c=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:b);this.getBrowser=function(){return k.rgx.apply(this,m.browser)},this.getEngine=function(){return k.rgx.apply(this,m.engine)},this.getOS=function(){return k.rgx.apply(this,m.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return c},this.setUA=function(a){return c=a,this},this.setUA(c)};return(new n).getResult()}(),d=function(){var b={define_property:function(){return!1}(),create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(b){try{if(-1!==a.inArray(b,["","text","document"]))return!0;if(window.XMLHttpRequest){var c=new XMLHttpRequest;if(c.open("get","/"),"responseType"in c)return c.responseType=b,c.responseType===b}}catch(a){}return!1},use_data_uri:function(){var a=new Image;return a.onload=function(){b.use_data_uri=1===a.width&&1===a.height},setTimeout(function(){a.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return b.use_data_uri&&("IE"!==e.browser||e.version>=9)},use_data_uri_of:function(a){return b.use_data_uri&&33e3>a||b.use_data_uri_over32kb()},use_fileinput:function(){var a=document.createElement("input");return a.setAttribute("type","file"),!a.disabled}};return function(c){var d=[].slice.call(arguments);return d.shift(),"function"===a.typeOf(b[c])?b[c].apply(this,d):!!b[c]}}(),e={can:d,browser:c.browser.name,version:parseFloat(c.browser.major),os:c.os.name,osVersion:c.os.version,verComp:b,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return e.OS=e.os,e}),d(l,[k],function(a){var b=function(a){return"string"!=typeof a?a:document.getElementById(a)},c=function(a,b){if(!a.className)return!1;var c=new RegExp("(^|\\s+)"+b+"(\\s+|$)");return c.test(a.className)},d=function(a,b){c(a,b)||(a.className=a.className?a.className.replace(/\s+$/,"")+" "+b:b)},e=function(a,b){if(a.className){var c=new RegExp("(^|\\s+)"+b+"(\\s+|$)");a.className=a.className.replace(c,function(a,b,c){return" "===b&&" "===c?" ":""})}},f=function(a,b){return a.currentStyle?a.currentStyle[b]:window.getComputedStyle?window.getComputedStyle(a,null)[b]:void 0},g=function(b,c){function d(a){var b,c,d=0,e=0;return a&&(c=a.getBoundingClientRect(),b="CSS1Compat"===j.compatMode?j.documentElement:j.body,d=c.left+b.scrollLeft,e=c.top+b.scrollTop),{x:d,y:e}}var e,f,g,h=0,i=0,j=document;if(b=b,c=c||j.body,b&&b.getBoundingClientRect&&"IE"===a.browser&&(!j.documentMode||j.documentMode<8))return f=d(b),g=d(c),{x:f.x-g.x,y:f.y-g.y};for(e=b;e&&e!=c&&e.nodeType;)h+=e.offsetLeft||0,i+=e.offsetTop||0,e=e.offsetParent;for(e=b.parentNode;e&&e!=c&&e.nodeType;)h-=e.scrollLeft||0,i-=e.scrollTop||0,e=e.parentNode;return{x:h,y:i}},h=function(a){return{w:a.offsetWidth||a.clientWidth,h:a.offsetHeight||a.clientHeight}};return{get:b,hasClass:c,addClass:d,removeClass:e,getStyle:f,getPos:g,getSize:h}}),d(m,[h],function(a){function b(a,b){var c;for(c in a)if(a[c]===b)return c;return null}return{RuntimeError:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": RuntimeError "+this.code}var d={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return a.extend(c,d),c.prototype=Error.prototype,c}(),OperationNotAllowedException:function(){function b(a){this.code=a,this.name="OperationNotAllowedException"}return a.extend(b,{NOT_ALLOWED_ERR:1}),b.prototype=Error.prototype,b}(),ImageError:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": ImageError "+this.code}var d={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return a.extend(c,d),c.prototype=Error.prototype,c}(),FileException:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": FileException "+this.code}var d={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return a.extend(c,d),c.prototype=Error.prototype,c}(),DOMException:function(){function c(a){this.code=a,this.name=b(d,a),this.message=this.name+": DOMException "+this.code}var d={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return a.extend(c,d),c.prototype=Error.prototype,c}(),EventException:function(){function b(a){this.code=a,this.name="EventException"}return a.extend(b,{UNSPECIFIED_EVENT_TYPE_ERR:0}),b.prototype=Error.prototype,b}()}}),d(n,[m,h],function(a,b){function c(){var c={};b.extend(this,{uid:null,init:function(){this.uid||(this.uid=b.guid("uid_"))},addEventListener:function(a,d,e,f){var g,h=this;return a=b.trim(a),/\s/.test(a)?void b.each(a.split(/\s+/),function(a){h.addEventListener(a,d,e,f)}):(a=a.toLowerCase(),e=parseInt(e,10)||0,g=c[this.uid]&&c[this.uid][a]||[],g.push({fn:d,priority:e,scope:f||this}),c[this.uid]||(c[this.uid]={}),void(c[this.uid][a]=g))},hasEventListener:function(a){return a?!(!c[this.uid]||!c[this.uid][a]):!!c[this.uid]},removeEventListener:function(a,d){a=a.toLowerCase();var e,f=c[this.uid]&&c[this.uid][a];if(f){if(d){for(e=f.length-1;e>=0;e--)if(f[e].fn===d){f.splice(e,1);break}}else f=[];f.length||(delete c[this.uid][a],b.isEmptyObj(c[this.uid])&&delete c[this.uid])}},removeAllEventListeners:function(){c[this.uid]&&delete c[this.uid]},dispatchEvent:function(d){var e,f,g,h,i,j={},k=!0;if("string"!==b.typeOf(d)){if(h=d,"string"!==b.typeOf(h.type))throw new a.EventException(a.EventException.UNSPECIFIED_EVENT_TYPE_ERR);d=h.type,h.total!==i&&h.loaded!==i&&(j.total=h.total,j.loaded=h.loaded),j.async=h.async||!1}if(-1!==d.indexOf("::")?!function(a){e=a[0],d=a[1]}(d.split("::")):e=this.uid,d=d.toLowerCase(),f=c[e]&&c[e][d]){f.sort(function(a,b){return b.priority-a.priority}),g=[].slice.call(arguments),g.shift(),j.type=d,g.unshift(j);var l=[];b.each(f,function(a){g[0].target=a.scope,l.push(j.async?function(b){setTimeout(function(){b(a.fn.apply(a.scope,g)===!1)},1)}:function(b){b(a.fn.apply(a.scope,g)===!1)})}),l.length&&b.inSeries(l,function(a){k=!a})}return k},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(a){var c;"array"!==b.typeOf(a)&&(a=[a]);for(var d=0;d<a.length;d++)c="on"+a[d],"function"===b.typeOf(this[c])?this.addEventListener(a[d],this[c]):"undefined"===b.typeOf(this[c])&&(this[c]=null)}})}return c.instance=new c,c}),d(o,[],function(){var a=function(a){return unescape(encodeURIComponent(a))},b=function(a){return decodeURIComponent(escape(a))},c=function(a,c){if("function"==typeof window.atob)return c?b(window.atob(a)):window.atob(a);var d,e,f,g,h,i,j,k,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=0,n=0,o="",p=[];if(!a)return a;a+="";do g=l.indexOf(a.charAt(m++)),h=l.indexOf(a.charAt(m++)),i=l.indexOf(a.charAt(m++)),j=l.indexOf(a.charAt(m++)),k=g<<18|h<<12|i<<6|j,d=k>>16&255,e=k>>8&255,f=255&k,p[n++]=64==i?String.fromCharCode(d):64==j?String.fromCharCode(d,e):String.fromCharCode(d,e,f);while(m<a.length);return o=p.join(""),c?b(o):o},d=function(b,c){if(c&&a(b),"function"==typeof window.btoa)return window.btoa(b);var d,e,f,g,h,i,j,k,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=0,n=0,o="",p=[];if(!b)return b;do d=b.charCodeAt(m++),e=b.charCodeAt(m++),f=b.charCodeAt(m++),k=d<<16|e<<8|f,g=k>>18&63,h=k>>12&63,i=k>>6&63,j=63&k,p[n++]=l.charAt(g)+l.charAt(h)+l.charAt(i)+l.charAt(j);while(m<b.length);o=p.join("");var q=b.length%3;return(q?o.slice(0,q-3):o)+"===".slice(q||3)};return{utf8_encode:a,utf8_decode:b,atob:c,btoa:d}}),d(p,[h,l,n],function(a,b,c){function d(c,e,g,h,i){var j,k=this,l=a.guid(e+"_"),m=i||"browser";c=c||{},f[l]=this,g=a.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},g),c.preferred_caps&&(m=d.getMode(h,c.preferred_caps,m)),j=function(){var b={};return{exec:function(a,c,d,e){return j[c]&&(b[a]||(b[a]={context:this,instance:new j[c]}),b[a].instance[d])?b[a].instance[d].apply(this,e):void 0},removeInstance:function(a){delete b[a]},removeAllInstances:function(){var c=this;a.each(b,function(b,d){"function"===a.typeOf(b.instance.destroy)&&b.instance.destroy.call(b.context),c.removeInstance(d)})}}}(),a.extend(this,{initialized:!1,uid:l,type:e,mode:d.getMode(h,c.required_caps,m),shimid:l+"_container",clients:0,options:c,can:function(b,c){var e=arguments[2]||g;if("string"===a.typeOf(b)&&"undefined"===a.typeOf(c)&&(b=d.parseCaps(b)),"object"===a.typeOf(b)){for(var f in b)if(!this.can(f,b[f],e))return!1;return!0}return"function"===a.typeOf(e[b])?e[b].call(this,c):c===e[b]},getShimContainer:function(){var c,d=b.get(this.shimid);return d||(c=this.options.container?b.get(this.options.container):document.body,d=document.createElement("div"),d.id=this.shimid,d.className="moxie-shim moxie-shim-"+this.type,a.extend(d.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),c.appendChild(d),c=null),d},getShim:function(){return j},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec.call(this,this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,2);return k[a]&&k[a][b]?k[a][b].apply(this,c):k.shimExec.apply(this,arguments)},destroy:function(){if(k){var a=b.get(this.shimid);a&&a.parentNode.removeChild(a),j&&j.removeAllInstances(),this.unbindAll(),delete f[this.uid],this.uid=null,l=k=j=a=null}}}),this.mode&&c.required_caps&&!this.can(c.required_caps)&&(this.mode=!1)}var e={},f={};return d.order="html5,flash,silverlight,html4",d.getRuntime=function(a){return f[a]?f[a]:!1},d.addConstructor=function(a,b){b.prototype=c.instance,e[a]=b},d.getConstructor=function(a){return e[a]||null},d.getInfo=function(a){var b=d.getRuntime(a);return b?{uid:b.uid,type:b.type,mode:b.mode,can:function(){return b.can.apply(b,arguments)}}:null},d.parseCaps=function(b){var c={};return"string"!==a.typeOf(b)?b||{}:(a.each(b.split(","),function(a){c[a]=!0}),c)},d.can=function(a,b){var c,e,f=d.getConstructor(a);return f?(c=new f({required_caps:b}),e=c.mode,c.destroy(),!!e):!1},d.thatCan=function(a,b){var c=(b||d.order).split(/\s*,\s*/);for(var e in c)if(d.can(c[e],a))return c[e];return null},d.getMode=function(b,c,d){var e=null;if("undefined"===a.typeOf(d)&&(d="browser"),c&&!a.isEmptyObj(b)){if(a.each(c,function(c,d){if(b.hasOwnProperty(d)){var f=b[d](c);if("string"==typeof f&&(f=[f]),e){if(!(e=a.arrayIntersect(e,f)))return e=!1}else e=f}}),e)return-1!==a.inArray(d,e)?d:e[0];if(e===!1)return!1}return d},d.capTrue=function(){return!0},d.capFalse=function(){return!1},d.capTest=function(a){return function(){return!!a}},d}),d(q,[m,h,p],function(a,b,c){return function d(){var d;b.extend(this,{connectRuntime:function(e){function f(b){var g,i;return b.length?(g=b.shift(),(i=c.getConstructor(g))?(d=new i(e),d.bind("Init",function(){d.initialized=!0,setTimeout(function(){d.clients++,h.trigger("RuntimeInit",d)},1)}),d.bind("Error",function(){d.destroy(),f(b)}),d.mode?void d.init():void d.trigger("Error")):void f(b)):(h.trigger("RuntimeError",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR)),void(d=null))}var g,h=this;if("string"===b.typeOf(e)?g=e:"string"===b.typeOf(e.ruid)&&(g=e.ruid),g){if(d=c.getRuntime(g))return d.clients++,d;throw new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR)}f((e.runtime_order||c.order).split(/\s*,\s*/))},getRuntime:function(){return d&&d.uid?d:(d=null,null)},disconnectRuntime:function(){d&&--d.clients<=0&&(d.destroy(),d=null)}})}}),d(r,[h,o,q],function(a,b,c){function d(f,g){function h(b,c,f){var g,h=e[this.uid];return"string"===a.typeOf(h)&&h.length?(g=new d(null,{type:f,size:c-b}),g.detach(h.substr(b,g.size)),g):null}c.call(this),f&&this.connectRuntime(f),g?"string"===a.typeOf(g)&&(g={data:g}):g={},a.extend(this,{uid:g.uid||a.guid("uid_"),ruid:f,size:g.size||0,type:g.type||"",slice:function(a,b,c){return this.isDetached()?h.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,c)},getSource:function(){return e[this.uid]?e[this.uid]:null},detach:function(a){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),a=a||"";var c=a.match(/^data:([^;]*);base64,/);c&&(this.type=c[1],a=b.atob(a.substring(a.indexOf("base64,")+7))),this.size=a.length,e[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===a.typeOf(e[this.uid])},destroy:function(){this.detach(),delete e[this.uid]}}),g.data?this.detach(g.data):e[this.uid]=g}var e={};return d}),d(s,[h,j,r],function(a,b,c){function d(d,e){var f,g;if(e||(e={}),g=e.type&&""!==e.type?e.type:b.getFileMime(e.name),e.name)f=e.name.replace(/\\/g,"/"),f=f.substr(f.lastIndexOf("/")+1);else{var h=g.split("/")[0];f=a.guid((""!==h?h:"file")+"_"),b.extensions[g]&&(f+="."+b.extensions[g][0])}c.apply(this,arguments),a.extend(this,{type:g||"",name:f||a.guid("file_"),lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString()})}return d.prototype=c.prototype,d}),d(t,[h,j,l,m,n,i,s,p,q],function(a,b,c,d,e,f,g,h,i){function j(e){var j,l,m,n=this;if(-1!==a.inArray(a.typeOf(e),["string","node"])&&(e={browse_button:e}),l=c.get(e.browse_button),!l)throw new d.DOMException(d.DOMException.NOT_FOUND_ERR);m={accept:[{title:f.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:l.parentNode||document.body},e=a.extend({},m,e),"string"==typeof e.required_caps&&(e.required_caps=h.parseCaps(e.required_caps)),"string"==typeof e.accept&&(e.accept=b.mimes2extList(e.accept)),j=c.get(e.container),j||(j=document.body),"static"===c.getStyle(j,"position")&&(j.style.position="relative"),j=l=null,i.call(n),a.extend(n,{uid:a.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){n.convertEventPropsToHandlers(k),n.bind("RuntimeInit",function(b,d){n.ruid=d.uid,n.shimid=d.shimid,n.bind("Ready",function(){n.trigger("Refresh")},999),n.bind("Change",function(){var b=d.exec.call(n,"FileInput","getFiles");n.files=[],a.each(b,function(a){return 0===a.size?!0:void n.files.push(new g(n.ruid,a))})},999),n.bind("Refresh",function(){var b,f,g,h;g=c.get(e.browse_button),h=c.get(d.shimid),g&&(b=c.getPos(g,c.get(e.container)),f=c.getSize(g),h&&a.extend(h.style,{top:b.y+"px",left:b.x+"px",width:f.w+"px",height:f.h+"px"})),h=g=null}),d.exec.call(n,"FileInput","init",e)}),n.connectRuntime(a.extend({},e,{required_caps:{select_file:!0}}))},disable:function(b){var c=this.getRuntime();c&&c.exec.call(this,"FileInput","disable","undefined"===a.typeOf(b)?!0:b)},refresh:function(){n.trigger("Refresh")},destroy:function(){var b=this.getRuntime();b&&(b.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===a.typeOf(this.files)&&a.each(this.files,function(a){a.destroy()}),this.files=null}})}var k=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return j.prototype=e.instance,j}),d(u,[i,l,m,h,s,q,n,j],function(a,b,c,d,e,f,g,h){function i(c){var g,i=this;"string"==typeof c&&(c={drop_zone:c}),g={accept:[{title:a.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},c="object"==typeof c?d.extend({},g,c):g,c.container=b.get(c.drop_zone)||document.body,"static"===b.getStyle(c.container,"position")&&(c.container.style.position="relative"),"string"==typeof c.accept&&(c.accept=h.mimes2extList(c.accept)),f.call(i),d.extend(i,{uid:d.guid("uid_"),ruid:null,files:null,init:function(){i.convertEventPropsToHandlers(j),i.bind("RuntimeInit",function(a,b){i.ruid=b.uid,i.bind("Drop",function(){var a=b.exec.call(i,"FileDrop","getFiles");i.files=[],d.each(a,function(a){i.files.push(new e(i.ruid,a))})},999),b.exec.call(i,"FileDrop","init",c),i.dispatchEvent("ready")}),i.connectRuntime(c)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null}})}var j=["ready","dragenter","dragleave","drop","error"];return i.prototype=g.instance,i}),d(v,[h,q,n],function(a,b,c){function d(){this.uid=a.guid("uid_"),b.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return d.prototype=c.instance,d}),d(w,[h,o,m,n,r,s,v],function(a,b,c,d,e,f,g){function h(){function d(a,d){function k(a){j.readyState=h.DONE,j.error=a,j.trigger("error"),l()}function l(){f.destroy(),f=null,j.trigger("loadend")}function m(b){f.bind("Error",function(a,b){k(b)}),f.bind("Progress",function(a){j.result=b.exec.call(f,"FileReader","getResult"),j.trigger(a)}),f.bind("Load",function(a){j.readyState=h.DONE,j.result=b.exec.call(f,"FileReader","getResult"),j.trigger(a),l()}),b.exec.call(f,"FileReader","read",a,d)}if(f=new g,this.convertEventPropsToHandlers(i),this.readyState===h.LOADING)return k(new c.DOMException(c.DOMException.INVALID_STATE_ERR));if(this.readyState=h.LOADING,this.trigger("loadstart"),d instanceof e)if(d.isDetached()){var n=d.getSource();switch(a){case"readAsText":case"readAsBinaryString":this.result=n;break;case"readAsDataURL":this.result="data:"+d.type+";base64,"+b.btoa(n)}this.readyState=h.DONE,this.trigger("load"),l()}else m(f.connectRuntime(d.ruid));else k(new c.DOMException(c.DOMException.NOT_FOUND_ERR))}var f,j=this;a.extend(this,{uid:a.guid("uid_"),readyState:h.EMPTY,result:null,error:null,readAsBinaryString:function(a){d.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){d.call(this,"readAsDataURL",a)},readAsText:function(a){d.call(this,"readAsText",a)},abort:function(){this.result=null,-1===a.inArray(this.readyState,[h.EMPTY,h.DONE])&&(this.readyState===h.LOADING&&(this.readyState=h.DONE),f&&f.getRuntime().exec.call(this,"FileReader","abort"),
this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),f&&(f.getRuntime().exec.call(this,"FileReader","destroy"),f.disconnectRuntime()),j=f=null}})}var i=["loadstart","progress","load","abort","error","loadend"];return h.EMPTY=0,h.LOADING=1,h.DONE=2,h.prototype=d.instance,h}),d(x,[],function(){var a=function(b,c){for(var d=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],e=d.length,f={http:80,https:443},g={},h=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,i=h.exec(b||"");e--;)i[e]&&(g[d[e]]=i[e]);if(!g.scheme){c&&"string"!=typeof c||(c=a(c||document.location.href)),g.scheme=c.scheme,g.host=c.host,g.port=c.port;var j="";/^[^\/]/.test(g.path)&&(j=c.path,/(\/|\/[^\.]+)$/.test(j)?j+="/":j=j.replace(/\/[^\/]+$/,"/")),g.path=j+(g.path||"")}return g.port||(g.port=f[g.scheme]||80),g.port=parseInt(g.port,10),g.path||(g.path="/"),delete g.source,g},b=function(b){var c={http:80,https:443},d=a(b);return d.scheme+"://"+d.host+(d.port!==c[d.scheme]?":"+d.port:"")+d.path+(d.query?d.query:"")},c=function(b){function c(a){return[a.scheme,a.host,a.port].join("/")}return"string"==typeof b&&(b=a(b)),c(a())===c(b)};return{parseUrl:a,resolveUrl:b,hasSameOrigin:c}}),d(y,[h,q,o],function(a,b,c){return function(){function d(a,b){if(!b.isDetached()){var d=this.connectRuntime(b.ruid).exec.call(this,"FileReaderSync","read",a,b);return this.disconnectRuntime(),d}var e=b.getSource();switch(a){case"readAsBinaryString":return e;case"readAsDataURL":return"data:"+b.type+";base64,"+c.btoa(e);case"readAsText":for(var f="",g=0,h=e.length;h>g;g++)f+=String.fromCharCode(e[g]);return f}}b.call(this),a.extend(this,{uid:a.guid("uid_"),readAsBinaryString:function(a){return d.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){return d.call(this,"readAsDataURL",a)},readAsText:function(a){return d.call(this,"readAsText",a)}})}}),d(z,[m,h,r],function(a,b,c){function d(){var a,d=[];b.extend(this,{append:function(e,f){var g=this,h=b.typeOf(f);f instanceof c?a={name:e,value:f}:"array"===h?(e+="[]",b.each(f,function(a){g.append(e,a)})):"object"===h?b.each(f,function(a,b){g.append(e+"["+b+"]",a)}):"null"===h||"undefined"===h||"number"===h&&isNaN(f)?g.append(e,"false"):d.push({name:e,value:f.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&a.name||null},each:function(c){b.each(d,function(a){c(a.value,a.name)}),a&&c(a.value,a.name)},destroy:function(){a=null,d=[]}})}return d}),d(A,[h,m,n,o,x,p,v,r,y,z,k,j],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){this.uid=a.guid("uid_")}function n(){function c(a,b){return A.hasOwnProperty(a)?1===arguments.length?k.can("define_property")?A[a]:z[a]:void(k.can("define_property")?A[a]=b:z[a]=b):void 0}function i(b){function d(){x&&(x.destroy(),x=null),h.dispatchEvent("loadend"),h=null}function e(e){x.bind("LoadStart",function(a){c("readyState",n.LOADING),h.dispatchEvent("readystatechange"),h.dispatchEvent(a),H&&h.upload.dispatchEvent(a)}),x.bind("Progress",function(a){c("readyState")!==n.LOADING&&(c("readyState",n.LOADING),h.dispatchEvent("readystatechange")),h.dispatchEvent(a)}),x.bind("UploadProgress",function(a){H&&h.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})}),x.bind("Load",function(b){c("readyState",n.DONE),c("status",Number(e.exec.call(x,"XMLHttpRequest","getStatus")||0)),c("statusText",o[c("status")]||""),c("response",e.exec.call(x,"XMLHttpRequest","getResponse",c("responseType"))),~a.inArray(c("responseType"),["text",""])?c("responseText",c("response")):"document"===c("responseType")&&c("responseXML",c("response")),O=e.exec.call(x,"XMLHttpRequest","getAllResponseHeaders"),h.dispatchEvent("readystatechange"),c("status")>0?(H&&h.upload.dispatchEvent(b),h.dispatchEvent(b)):(J=!0,h.dispatchEvent("error")),d()}),x.bind("Abort",function(a){h.dispatchEvent(a),d()}),x.bind("Error",function(a){J=!0,c("readyState",n.DONE),h.dispatchEvent("readystatechange"),I=!0,h.dispatchEvent(a),d()}),e.exec.call(x,"XMLHttpRequest","send",{url:r,method:s,async:B,user:t,password:u,headers:C,mimeType:E,encoding:D,responseType:h.responseType,withCredentials:h.withCredentials,options:N},b)}var h=this;v=(new Date).getTime(),x=new g,"string"==typeof N.required_caps&&(N.required_caps=f.parseCaps(N.required_caps)),N.required_caps=a.extend({},N.required_caps,{return_response_type:h.responseType}),b instanceof j&&(N.required_caps.send_multipart=!0),K||(N.required_caps.do_cors=!0),N.ruid?e(x.connectRuntime(N)):(x.bind("RuntimeInit",function(a,b){e(b)}),x.bind("RuntimeError",function(a,b){h.dispatchEvent("RuntimeError",b)}),x.connectRuntime(N))}function q(){c("responseText",""),c("responseXML",null),c("response",null),c("status",0),c("statusText",""),v=w=null}var r,s,t,u,v,w,x,y,z=this,A={timeout:0,readyState:n.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},B=!0,C={},D=null,E=null,F=!1,G=!1,H=!1,I=!1,J=!1,K=!1,L=null,M=null,N={},O="";a.extend(this,A,{uid:a.guid("uid_"),upload:new m,open:function(f,g,h,i,j){var k;if(!f||!g)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(f)||d.utf8_encode(f)!==f)throw new b.DOMException(b.DOMException.SYNTAX_ERR);if(~a.inArray(f.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(s=f.toUpperCase()),~a.inArray(s,["CONNECT","TRACE","TRACK"]))throw new b.DOMException(b.DOMException.SECURITY_ERR);if(g=d.utf8_encode(g),k=e.parseUrl(g),K=e.hasSameOrigin(k),r=e.resolveUrl(g),(i||j)&&!K)throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);if(t=i||k.user,u=j||k.pass,B=h||!0,B===!1&&(c("timeout")||c("withCredentials")||""!==c("responseType")))throw new b.DOMException(b.DOMException.INVALID_ACCESS_ERR);F=!B,G=!1,C={},q.call(this),c("readyState",n.OPENED),this.convertEventPropsToHandlers(["readystatechange"]),this.dispatchEvent("readystatechange")},setRequestHeader:function(e,f){var g=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(c("readyState")!==n.OPENED||G)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(e)||d.utf8_encode(e)!==e)throw new b.DOMException(b.DOMException.SYNTAX_ERR);return e=a.trim(e).toLowerCase(),~a.inArray(e,g)||/^(proxy\-|sec\-)/.test(e)?!1:(C[e]?C[e]+=", "+f:C[e]=f,!0)},getAllResponseHeaders:function(){return O||""},getResponseHeader:function(b){return b=b.toLowerCase(),J||~a.inArray(b,["set-cookie","set-cookie2"])?null:O&&""!==O&&(y||(y={},a.each(O.split(/\r\n/),function(b){var c=b.split(/:\s+/);2===c.length&&(c[0]=a.trim(c[0]),y[c[0].toLowerCase()]={header:c[0],value:a.trim(c[1])})})),y.hasOwnProperty(b))?y[b].header+": "+y[b].value:null},overrideMimeType:function(d){var e,f;if(~a.inArray(c("readyState"),[n.LOADING,n.DONE]))throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(d=a.trim(d.toLowerCase()),/;/.test(d)&&(e=d.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(d=e[1],e[2]&&(f=e[2])),!l.mimes[d])throw new b.DOMException(b.DOMException.SYNTAX_ERR);L=d,M=f},send:function(c,e){if(N="string"===a.typeOf(e)?{ruid:e}:e?e:{},this.convertEventPropsToHandlers(p),this.upload.convertEventPropsToHandlers(p),this.readyState!==n.OPENED||G)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);if(c instanceof h)N.ruid=c.ruid,E=c.type||"application/octet-stream";else if(c instanceof j){if(c.hasBlob()){var f=c.getBlob();N.ruid=f.ruid,E=f.type||"application/octet-stream"}}else"string"==typeof c&&(D="UTF-8",E="text/plain;charset=UTF-8",c=d.utf8_encode(c));this.withCredentials||(this.withCredentials=N.required_caps&&N.required_caps.send_browser_cookies&&!K),H=!F&&this.upload.hasEventListener(),J=!1,I=!c,F||(G=!0),i.call(this,c)},abort:function(){if(J=!0,F=!1,~a.inArray(c("readyState"),[n.UNSENT,n.OPENED,n.DONE]))c("readyState",n.UNSENT);else{if(c("readyState",n.DONE),G=!1,!x)throw new b.DOMException(b.DOMException.INVALID_STATE_ERR);x.getRuntime().exec.call(x,"XMLHttpRequest","abort",I),I=!0}},destroy:function(){x&&("function"===a.typeOf(x.destroy)&&x.destroy(),x=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var o={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};m.prototype=c.instance;var p=["loadstart","progress","abort","error","load","timeout","loadend"];return n.UNSENT=0,n.OPENED=1,n.HEADERS_RECEIVED=2,n.LOADING=3,n.DONE=4,n.prototype=c.instance,n}),d(B,[h,o,q,n],function(a,b,c,d){function e(){function d(){k=l=0,j=this.result=null}function f(b,c){var d=this;i=c,d.bind("TransportingProgress",function(b){l=b.loaded,k>l&&-1===a.inArray(d.state,[e.IDLE,e.DONE])&&g.call(d)},999),d.bind("TransportingComplete",function(){l=k,d.state=e.DONE,j=null,d.result=i.exec.call(d,"Transporter","getAsBlob",b||"")},999),d.state=e.BUSY,d.trigger("TransportingStarted"),g.call(d)}function g(){var a,c=this,d=k-l;m>d&&(m=d),a=b.btoa(j.substr(l,m)),i.exec.call(c,"Transporter","receive",a,k)}var h,i,j,k,l,m;c.call(this),a.extend(this,{uid:a.guid("uid_"),state:e.IDLE,result:null,transport:function(b,c,e){var g=this;if(e=a.extend({chunk_size:204798},e),(h=e.chunk_size%3)&&(e.chunk_size+=3-h),m=e.chunk_size,d.call(this),j=b,k=b.length,"string"===a.typeOf(e)||e.ruid)f.call(g,c,this.connectRuntime(e));else{var i=function(a,b){g.unbind("RuntimeInit",i),f.call(g,c,b)};this.bind("RuntimeInit",i),this.connectRuntime(e)}},abort:function(){var a=this;a.state=e.IDLE,i&&(i.exec.call(a,"Transporter","clear"),a.trigger("TransportingAborted")),d.call(a)},destroy:function(){this.unbindAll(),i=null,this.disconnectRuntime(),d.call(this)}})}return e.IDLE=0,e.BUSY=1,e.DONE=2,e.prototype=d.instance,e}),d(C,[h,l,m,y,A,p,q,B,k,n,r,s,o],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){function d(a){a||(a=this.getRuntime().exec.call(this,"Image","getInfo")),this.size=a.size,this.width=a.width,this.height=a.height,this.type=a.type,this.meta=a.meta,""===this.name&&(this.name=a.name)}function j(b){var d=a.typeOf(b);try{if(b instanceof n){if(!b.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);p.apply(this,arguments)}else if(b instanceof k){if(!~a.inArray(b.type,["image/jpeg","image/png"]))throw new c.ImageError(c.ImageError.WRONG_FORMAT);q.apply(this,arguments)}else if(-1!==a.inArray(d,["blob","file"]))j.call(this,new l(null,b),arguments[1]);else if("string"===d)/^data:[^;]*;base64,/.test(b)?j.call(this,new k(null,{data:b}),arguments[1]):r.apply(this,arguments);else{if("node"!==d||"img"!==b.nodeName.toLowerCase())throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);j.call(this,b.src,arguments[1])}}catch(a){this.trigger("error",a.code)}}function p(b,c){var d=this.connectRuntime(b.ruid);this.ruid=d.uid,d.exec.call(this,"Image","loadFromImage",b,"undefined"===a.typeOf(c)?!0:c)}function q(b,c){function d(a){e.ruid=a.uid,a.exec.call(e,"Image","loadFromBlob",b)}var e=this;e.name=b.name||"",b.isDetached()?(this.bind("RuntimeInit",function(a,b){d(b)}),c&&"string"==typeof c.required_caps&&(c.required_caps=f.parseCaps(c.required_caps)),this.connectRuntime(a.extend({required_caps:{access_image_binary:!0,resize_image:!0}},c))):d(this.connectRuntime(b.ruid))}function r(a,b){var c,d=this;c=new e,c.open("get",a),c.responseType="blob",c.onprogress=function(a){d.trigger(a)},c.onload=function(){q.call(d,c.response,!0)},c.onerror=function(a){d.trigger(a)},c.onloadend=function(){c.destroy()},c.bind("RuntimeError",function(a,b){d.trigger("RuntimeError",b)}),c.send(null,b)}g.call(this),a.extend(this,{uid:a.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){d.call(this)},999),this.convertEventPropsToHandlers(o),j.apply(this,arguments)},downsize:function(b){var d={width:this.width,height:this.height,crop:!1,preserveHeaders:!0};b="object"==typeof b?a.extend(d,b):a.extend(d,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]});try{if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>n.MAX_RESIZE_WIDTH||this.height>n.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);this.getRuntime().exec.call(this,"Image","downsize",b.width,b.height,b.crop,b.preserveHeaders)}catch(a){this.trigger("error",a.code)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!i.can("create_canvas"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);var a=this.connectRuntime(this.ruid);return a.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return a||(a="image/jpeg"),"image/jpeg"!==a||b||(b=90),this.getRuntime().exec.call(this,"Image","getAsBlob",a,b)},getAsDataURL:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",a,b)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return m.atob(c.substring(c.indexOf("base64,")+7))},embed:function(d){function e(){if(i.can("create_canvas")){var b=f.getAsCanvas();if(b)return d.appendChild(b),b=null,f.destroy(),void o.trigger("embedded")}var e=f.getAsDataURL(g,j);if(!e)throw new c.ImageError(c.ImageError.WRONG_FORMAT);if(i.can("use_data_uri_of",e.length))d.innerHTML='<img src="'+e+'" width="'+f.width+'" height="'+f.height+'" />',f.destroy(),o.trigger("embedded");else{var k=new h;k.bind("TransportingComplete",function(){l=o.connectRuntime(this.result.ruid),o.bind("Embedded",function(){a.extend(l.getShimContainer().style,{top:"0px",left:"0px",width:f.width+"px",height:f.height+"px"}),l=null},999),l.exec.call(o,"ImageView","display",this.result.uid,q,r),f.destroy()}),k.transport(m.atob(e.substring(e.indexOf("base64,")+7)),g,a.extend({},p,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:d}))}}var f,g,j,k,l,o=this,p=arguments[1]||{},q=this.width,r=this.height;try{if(!(d=b.get(d)))throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>n.MAX_RESIZE_WIDTH||this.height>n.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);if(g=p.type||this.type||"image/jpeg",j=p.quality||90,k="undefined"!==a.typeOf(p.crop)?p.crop:!1,p.width)q=p.width,r=p.height||q;else{var s=b.getSize(d);s.w&&s.h&&(q=s.w,r=s.h)}return f=new n,f.bind("Resize",function(){e.call(o)}),f.bind("Load",function(){f.downsize(q,r,k,!1)}),f.clone(this,!1),f}catch(a){this.trigger("error",a.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}})}var o=["progress","load","error","resize","embedded"];return n.MAX_RESIZE_WIDTH=6500,n.MAX_RESIZE_HEIGHT=6500,n.prototype=j.instance,n}),d(D,[h,m,p,k],function(a,b,c,d){function e(b){var e=this,h=c.capTest,i=c.capTrue,j=a.extend({access_binary:h(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return e.can("access_binary")&&!!g.Image},display_media:h(d.can("create_canvas")||d.can("use_data_uri_over32kb")),do_cors:h(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:h(function(){var a=document.createElement("div");return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&("IE"!==d.browser||d.version>9)}()),filter_by_extension:h(function(){return"Chrome"===d.browser&&d.version>=28||"IE"===d.browser&&d.version>=10}()),return_response_headers:i,return_response_type:function(a){return"json"===a&&window.JSON?!0:d.can("return_response_type",a)},return_status_code:i,report_upload_progress:h(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return e.can("access_binary")&&d.can("create_canvas")},select_file:function(){return d.can("use_fileinput")&&window.File},select_folder:function(){return e.can("select_file")&&"Chrome"===d.browser&&d.version>=21},select_multiple:function(){return!(!e.can("select_file")||"Safari"===d.browser&&"Windows"===d.os||"iOS"===d.os&&d.verComp(d.osVersion,"7.0.4","<"))},send_binary_string:h(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:h(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||e.can("send_binary_string")},slice_blob:h(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return e.can("slice_blob")&&e.can("send_multipart")},summon_file_dialog:h(function(){return"Firefox"===d.browser&&d.version>=4||"Opera"===d.browser&&d.version>=12||"IE"===d.browser&&d.version>=10||!!~a.inArray(d.browser,["Chrome","Safari"])}()),upload_filesize:i},arguments[2]);c.call(this,b,arguments[1]||f,j),a.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(e),a=e=null}}(this.destroy)}),a.extend(this.getShim(),g)}var f="html5",g={};return c.addConstructor(f,e),g}),d(E,[D,r],function(a,b){function c(){function a(a,b,c){var d;if(!window.File.prototype.slice)return(d=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?d.call(a,b,c):null;try{return a.slice(),a.slice(b,c)}catch(d){return a.slice(b,c-b)}}this.slice=function(){return new b(this.getRuntime().uid,a.apply(this,arguments))}}return a.Blob=c}),d(F,[h],function(a){function b(){this.returnValue=!1}function c(){this.cancelBubble=!0}var d={},e="moxie_"+a.guid(),f=function(f,g,h,i){var j,k;g=g.toLowerCase(),f.addEventListener?(j=h,f.addEventListener(g,j,!1)):f.attachEvent&&(j=function(){var a=window.event;a.target||(a.target=a.srcElement),a.preventDefault=b,a.stopPropagation=c,h(a)},f.attachEvent("on"+g,j)),f[e]||(f[e]=a.guid()),d.hasOwnProperty(f[e])||(d[f[e]]={}),k=d[f[e]],k.hasOwnProperty(g)||(k[g]=[]),k[g].push({func:j,orig:h,key:i})},g=function(b,c,f){var g,h;if(c=c.toLowerCase(),b[e]&&d[b[e]]&&d[b[e]][c]){g=d[b[e]][c];for(var i=g.length-1;i>=0&&(g[i].orig!==f&&g[i].key!==f||(b.removeEventListener?b.removeEventListener(c,g[i].func,!1):b.detachEvent&&b.detachEvent("on"+c,g[i].func),g[i].orig=null,g[i].func=null,g.splice(i,1),f===h));i--);if(g.length||delete d[b[e]][c],a.isEmptyObj(d[b[e]])){delete d[b[e]];try{delete b[e]}catch(a){b[e]=h}}}},h=function(b,c){b&&b[e]&&a.each(d[b[e]],function(a,d){g(b,d,c)})};return{addEvent:f,removeEvent:g,removeAllEvents:h}}),d(G,[D,h,l,F,j,k],function(a,b,c,d,e,f){function g(){var a,g=[];b.extend(this,{init:function(h){var i,j,k,l,m,n,o=this,p=o.getRuntime();a=h,g=[],k=a.accept.mimes||e.extList2mimes(a.accept,p.can("filter_by_extension")),j=p.getShimContainer(),j.innerHTML='<input id="'+p.uid+'" type="file" style="font-size:999px;opacity:0;"'+(a.multiple&&p.can("select_multiple")?"multiple":"")+(a.directory&&p.can("select_folder")?"webkitdirectory directory":"")+(k?' accept="'+k.join(",")+'"':"")+" />",i=c.get(p.uid),b.extend(i.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),l=c.get(a.browse_button),p.can("summon_file_dialog")&&("static"===c.getStyle(l,"position")&&(l.style.position="relative"),m=parseInt(c.getStyle(l,"z-index"),10)||1,l.style.zIndex=m,j.style.zIndex=m-1,d.addEvent(l,"click",function(a){var b=c.get(p.uid);b&&!b.disabled&&b.click(),a.preventDefault()},o.uid)),n=p.can("summon_file_dialog")?l:j,d.addEvent(n,"mouseover",function(){o.trigger("mouseenter")},o.uid),d.addEvent(n,"mouseout",function(){o.trigger("mouseleave")},o.uid),d.addEvent(n,"mousedown",function(){o.trigger("mousedown")},o.uid),d.addEvent(c.get(a.container),"mouseup",function(){o.trigger("mouseup")},o.uid),i.onchange=function c(){if(g=[],a.directory?b.each(this.files,function(a){"."!==a.name&&g.push(a)}):g=[].slice.call(this.files),"IE"!==f.browser&&"IEMobile"!==f.browser)this.value="";else{var d=this.cloneNode(!0);this.parentNode.replaceChild(d,this),d.onchange=c}o.trigger("change")},o.trigger({type:"ready",async:!0}),j=null},getFiles:function(){return g},disable:function(a){var b,d=this.getRuntime();(b=c.get(d.uid))&&(b.disabled=!!a)},destroy:function(){var b=this.getRuntime(),e=b.getShim(),f=b.getShimContainer();d.removeAllEvents(f,this.uid),d.removeAllEvents(a&&c.get(a.container),this.uid),d.removeAllEvents(a&&c.get(a.browse_button),this.uid),f&&(f.innerHTML=""),e.removeInstance(this.uid),g=a=f=e=null}})}return a.FileInput=g}),d(H,[D,h,l,F,j],function(a,b,c,d,e){function f(){function a(a){if(!a.dataTransfer||!a.dataTransfer.types)return!1;var c=b.toArray(a.dataTransfer.types||[]);return-1!==b.inArray("Files",c)||-1!==b.inArray("public.file-url",c)||-1!==b.inArray("application/x-moz-file",c)}function f(a){for(var c=[],d=0;d<a.length;d++)[].push.apply(c,a[d].extensions.split(/\s*,\s*/));return-1===b.inArray("*",c)?c:[]}function g(a){if(!n.length)return!0;var c=e.getFileExtension(a.name);return!c||-1!==b.inArray(c,n)}function h(a,c){var d=[];b.each(a,function(a){var b=a.webkitGetAsEntry();if(b)if(b.isFile){var c=a.getAsFile();g(c)&&m.push(c)}else d.push(b)}),d.length?i(d,c):c()}function i(a,c){var d=[];b.each(a,function(a){d.push(function(b){j(a,b)})}),b.inSeries(d,function(){c()})}function j(a,b){a.isFile?a.file(function(a){g(a)&&m.push(a),b()},function(){b()}):a.isDirectory?k(a,b):b()}function k(a,b){function c(a){e.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],e=a.createReader();c(function(){i(d,b)})}var l,m=[],n=[];b.extend(this,{init:function(c){var e,i=this;l=c,n=f(l.accept),e=l.container,d.addEvent(e,"dragover",function(b){a(b)&&(b.preventDefault(),b.dataTransfer.dropEffect="copy")},i.uid),d.addEvent(e,"drop",function(c){a(c)&&(c.preventDefault(),m=[],c.dataTransfer.items&&c.dataTransfer.items[0].webkitGetAsEntry?h(c.dataTransfer.items,function(){i.trigger("drop")}):(b.each(c.dataTransfer.files,function(a){g(a)&&m.push(a)}),i.trigger("drop")))},i.uid),d.addEvent(e,"dragenter",function(a){i.trigger("dragenter")},i.uid),d.addEvent(e,"dragleave",function(a){i.trigger("dragleave")},i.uid)},getFiles:function(){return m},destroy:function(){d.removeAllEvents(l&&c.get(l.container),this.uid),m=n=l=null}})}return a.FileDrop=f}),d(I,[D,o,h],function(a,b,c){function d(){function a(a){return b.atob(a.substring(a.indexOf("base64,")+7))}var d,e=!1;c.extend(this,{read:function(a,b){var f=this;d=new window.FileReader,d.addEventListener("progress",function(a){f.trigger(a)}),d.addEventListener("load",function(a){f.trigger(a)}),d.addEventListener("error",function(a){f.trigger(a,d.error)}),d.addEventListener("loadend",function(){d=null}),"function"===c.typeOf(d[a])?(e=!1,d[a](b.getSource())):"readAsBinaryString"===a&&(e=!0,d.readAsDataURL(b.getSource()))},getResult:function(){return d&&d.result?e?a(d.result):d.result:null},abort:function(){d&&d.abort()},destroy:function(){d=null}})}return a.FileReader=d}),d(J,[D,h,j,x,s,r,z,m,k],function(a,b,c,d,e,f,g,h,i){function j(){function a(a,b){var c,d,e=this;c=b.getBlob().getSource(),d=new window.FileReader,d.onload=function(){b.append(b.getBlobName(),new f(null,{type:c.type,data:d.result})),o.send.call(e,a,b)},d.readAsBinaryString(c)}function j(){return!window.XMLHttpRequest||"IE"===i.browser&&i.version<8?function(){for(var a=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],b=0;b<a.length;b++)try{return new ActiveXObject(a[b])}catch(a){}}():new window.XMLHttpRequest}function k(a){var b=a.responseXML,c=a.responseText;return"IE"===i.browser&&c&&b&&!b.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(a.getResponseHeader("Content-Type"))&&(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.validateOnParse=!1,b.loadXML(c)),b&&("IE"===i.browser&&0!==b.parseError||!b.documentElement||"parsererror"===b.documentElement.tagName)?null:b}function l(a){var b="----moxieboundary"+(new Date).getTime(),c="--",d="\r\n",e="",g=this.getRuntime();if(!g.can("send_binary_string"))throw new h.RuntimeError(h.RuntimeError.NOT_SUPPORTED_ERR);return m.setRequestHeader("Content-Type","multipart/form-data; boundary="+b),a.each(function(a,g){e+=a instanceof f?c+b+d+'Content-Disposition: form-data; name="'+g+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"'+d+"Content-Type: "+(a.type||"application/octet-stream")+d+d+a.getSource()+d:c+b+d+'Content-Disposition: form-data; name="'+g+'"'+d+d+unescape(encodeURIComponent(a))+d}),e+=c+b+c+d}var m,n,o=this;b.extend(this,{send:function(c,e){var h=this,k="Mozilla"===i.browser&&i.version>=4&&i.version<7,o="Android Browser"===i.browser,p=!1;if(n=c.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),m=j(),m.open(c.method,c.url,c.async,c.user,c.password),e instanceof f)e.isDetached()&&(p=!0),e=e.getSource();else if(e instanceof g){if(e.hasBlob())if(e.getBlob().isDetached())e=l.call(h,e),p=!0;else if((k||o)&&"blob"===b.typeOf(e.getBlob().getSource())&&window.FileReader)return void a.call(h,c,e);if(e instanceof g){var q=new window.FormData;e.each(function(a,b){a instanceof f?q.append(b,a.getSource()):q.append(b,a)}),e=q}}m.upload?(c.withCredentials&&(m.withCredentials=!0),m.addEventListener("load",function(a){h.trigger(a)}),m.addEventListener("error",function(a){h.trigger(a)}),m.addEventListener("progress",function(a){h.trigger(a)}),m.upload.addEventListener("progress",function(a){h.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):m.onreadystatechange=function(){switch(m.readyState){case 1:break;case 2:break;case 3:var a,b;try{d.hasSameOrigin(c.url)&&(a=m.getResponseHeader("Content-Length")||0),m.responseText&&(b=m.responseText.length)}catch(c){a=b=0}h.trigger({type:"progress",lengthComputable:!!a,total:parseInt(a,10),loaded:b});break;case 4:m.onreadystatechange=function(){},h.trigger(0===m.status?"error":"load")}},b.isEmptyObj(c.headers)||b.each(c.headers,function(a,b){m.setRequestHeader(b,a)}),""!==c.responseType&&"responseType"in m&&(m.responseType="json"!==c.responseType||i.can("return_response_type","json")?c.responseType:"text"),p?m.sendAsBinary?m.sendAsBinary(e):!function(){for(var a=new Uint8Array(e.length),b=0;b<e.length;b++)a[b]=255&e.charCodeAt(b);m.send(a.buffer)}():m.send(e),h.trigger("loadstart")},getStatus:function(){try{if(m)return m.status}catch(a){}return 0},getResponse:function(a){var b=this.getRuntime();try{switch(a){case"blob":var d=new e(b.uid,m.response),f=m.getResponseHeader("Content-Disposition");if(f){var g=f.match(/filename=([\'\"'])([^\1]+)\1/);g&&(n=g[2])}return d.name=n,d.type||(d.type=c.getFileMime(n)),d;case"json":return i.can("return_response_type","json")?m.response:200===m.status&&window.JSON?JSON.parse(m.responseText):null;case"document":return k(m);default:return""!==m.responseText?m.responseText:null}}catch(a){return null}},getAllResponseHeaders:function(){try{return m.getAllResponseHeaders()}catch(a){}return""},abort:function(){m&&m.abort()},destroy:function(){o=n=null}})}return a.XMLHttpRequest=j}),d(K,[],function(){return function(){function a(a,b){var c,d=f?0:-8*(b-1),g=0;for(c=0;b>c;c++)g|=e.charCodeAt(a+c)<<Math.abs(d+8*c);return g}function c(a,b,c){c=3===arguments.length?c:e.length-b-1,e=e.substr(0,b)+a+e.substr(c+b)}function d(a,b,d){var e,g="",h=f?0:-8*(d-1);for(e=0;d>e;e++)g+=String.fromCharCode(b>>Math.abs(h+8*e)&255);c(g,a,d)}var e,f=!1;return{II:function(a){return a===b?f:void(f=a)},init:function(a){f=!1,e=a},SEGMENT:function(a,b,d){switch(arguments.length){case 1:return e.substr(a,e.length-a-1);case 2:return e.substr(a,b);case 3:c(d,a,b);break;default:return e}},BYTE:function(b){return a(b,1)},SHORT:function(b){return a(b,2)},LONG:function(c,e){return e===b?a(c,4):void d(c,e,4)},SLONG:function(b){var c=a(b,4);return c>2147483647?c-4294967296:c},STRING:function(b,c){var d="";for(c+=b;c>b;b++)d+=String.fromCharCode(a(b,1));return d}}}}),d(L,[K],function(a){return function b(c){var d,e,f,g=[],h=0;if(d=new a,d.init(c),65496===d.SHORT(0)){for(e=2;e<=c.length;)if(f=d.SHORT(e),f>=65488&&65495>=f)e+=2;else{if(65498===f||65497===f)break;h=d.SHORT(e+2)+2,f>=65505&&65519>=f&&g.push({hex:f,name:"APP"+(15&f),start:e,length:h,segment:d.SEGMENT(e,h)}),e+=h}return d.init(null),{headers:g,restore:function(a){var b,c;for(d.init(a),e=65504==d.SHORT(2)?4+d.SHORT(4):2,c=0,b=g.length;b>c;c++)d.SEGMENT(e,0,g[c].segment),e+=g[c].length;return a=d.SEGMENT(),d.init(null),a},strip:function(a){var c,e,f;for(e=new b(a),c=e.headers,e.purge(),d.init(a),f=c.length;f--;)d.SEGMENT(c[f].start,c[f].length,"");return a=d.SEGMENT(),d.init(null),a},get:function(a){for(var b=[],c=0,d=g.length;d>c;c++)g[c].name===a.toUpperCase()&&b.push(g[c].segment);return b},set:function(a,b){var c,d,e,f=[];for("string"==typeof b?f.push(b):f=b,c=d=0,e=g.length;e>c&&(g[c].name===a.toUpperCase()&&(g[c].segment=f[d],g[c].length=f[d].length,d++),!(d>=f.length));c++);},purge:function(){g=[],d.init(null),d=null}}}}}),d(M,[h,K],function(a,c){return function d(){function d(a,c){var d,e,f,h,i,l,m,n,o=g.SHORT(a),p=[],q={};for(d=0;o>d;d++)if(m=l=a+12*d+2,f=c[g.SHORT(m)],f!==b){switch(h=g.SHORT(m+=2),i=g.LONG(m+=2),m+=4,p=[],h){case 1:case 7:for(i>4&&(m=g.LONG(m)+k.tiffHeader),e=0;i>e;e++)p[e]=g.BYTE(m+e);break;case 2:i>4&&(m=g.LONG(m)+k.tiffHeader),q[f]=g.STRING(m,i-1);continue;case 3:for(i>2&&(m=g.LONG(m)+k.tiffHeader),e=0;i>e;e++)p[e]=g.SHORT(m+2*e);break;case 4:for(i>1&&(m=g.LONG(m)+k.tiffHeader),e=0;i>e;e++)p[e]=g.LONG(m+4*e);break;case 5:for(m=g.LONG(m)+k.tiffHeader,e=0;i>e;e++)p[e]=g.LONG(m+4*e)/g.LONG(m+4*e+4);break;case 9:for(m=g.LONG(m)+k.tiffHeader,e=0;i>e;e++)p[e]=g.SLONG(m+4*e);break;case 10:for(m=g.LONG(m)+k.tiffHeader,e=0;i>e;e++)p[e]=g.SLONG(m+4*e)/g.SLONG(m+4*e+4);break;default:continue}n=1==i?p[0]:p,q[f]=j.hasOwnProperty(f)&&"object"!=typeof n?j[f][n]:n}return q}function e(){var a=k.tiffHeader;return g.II(18761==g.SHORT(a)),42!==g.SHORT(a+=2)?!1:(k.IFD0=k.tiffHeader+g.LONG(a+=2),i=d(k.IFD0,h.tiff),"ExifIFDPointer"in i&&(k.exifIFD=k.tiffHeader+i.ExifIFDPointer,delete i.ExifIFDPointer),"GPSInfoIFDPointer"in i&&(k.gpsIFD=k.tiffHeader+i.GPSInfoIFDPointer,delete i.GPSInfoIFDPointer),!0)}function f(a,b,c){var d,e,f,i=0;if("string"==typeof b){var j=h[a.toLowerCase()];for(var l in j)if(j[l]===b){b=l;break}}d=k[a.toLowerCase()+"IFD"],e=g.SHORT(d);for(var m=0;e>m;m++)if(f=d+12*m+2,g.SHORT(f)==b){i=f+8;break}return i?(g.LONG(i,c),!0):!1}var g,h,i,j,k={};return g=new c,h={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",
37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},j={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(a){return k={tiffHeader:10},a!==b&&a.length?(g.init(a),65505===g.SHORT(0)&&"EXIF\x00"===g.STRING(4,5).toUpperCase()?e():!1):!1},TIFF:function(){return i},EXIF:function(){var b;if(b=d(k.exifIFD,h.exif),b.ExifVersion&&"array"===a.typeOf(b.ExifVersion)){for(var c=0,e="";c<b.ExifVersion.length;c++)e+=String.fromCharCode(b.ExifVersion[c]);b.ExifVersion=e}return b},GPS:function(){var b;return b=d(k.gpsIFD,h.gps),b.GPSVersionID&&"array"===a.typeOf(b.GPSVersionID)&&(b.GPSVersionID=b.GPSVersionID.join(".")),b},setExif:function(a,b){return"PixelXDimension"!==a&&"PixelYDimension"!==a?!1:f("exif",a,b)},getBinary:function(){return g.SEGMENT()},purge:function(){g.init(null),g=i=null,k={}}}}}),d(N,[h,m,L,K,M],function(a,b,c,d,e){function f(f){function g(){for(var a,b,c=0;c<=i.length;){if(a=j.SHORT(c+=2),a>=65472&&65475>=a)return c+=5,{height:j.SHORT(c),width:j.SHORT(c+=2)};b=j.SHORT(c+=2),c+=b-2}return null}function h(){l&&k&&j&&(l.purge(),k.purge(),j.init(null),i=m=k=l=j=null)}var i,j,k,l,m,n;if(i=f,j=new d,j.init(i),65496!==j.SHORT(0))throw new b.ImageError(b.ImageError.WRONG_FORMAT);k=new c(f),l=new e,n=!!l.init(k.get("app1")[0]),m=g.call(this),a.extend(this,{type:"image/jpeg",size:i.length,width:m&&m.width||0,height:m&&m.height||0,setExif:function(b,c){return n?("object"===a.typeOf(b)?a.each(b,function(a,b){l.setExif(b,a)}):l.setExif(b,c),void k.set("app1",l.getBinary())):!1},writeHeaders:function(){return arguments.length?k.restore(arguments[0]):i=k.restore(i)},stripHeaders:function(a){return k.strip(a)},purge:function(){h.call(this)}}),n&&(this.meta={tiff:l.TIFF(),exif:l.EXIF(),gps:l.GPS()})}return f}),d(O,[m,h,K],function(a,b,c){function d(d){function e(){var a,b;return a=g.call(this,8),"IHDR"==a.type?(b=a.start,{width:i.LONG(b),height:i.LONG(b+=4)}):null}function f(){i&&(i.init(null),h=l=j=k=i=null)}function g(a){var b,c,d,e;return b=i.LONG(a),c=i.STRING(a+=4,4),d=a+=4,e=i.LONG(a+b),{length:b,type:c,start:d,CRC:e}}var h,i,j,k,l;h=d,i=new c,i.init(h),function(){var b=0,c=0,d=[35152,20039,3338,6666];for(c=0;c<d.length;c++,b+=2)if(d[c]!=i.SHORT(b))throw new a.ImageError(a.ImageError.WRONG_FORMAT)}(),l=e.call(this),b.extend(this,{type:"image/png",size:h.length,width:l.width,height:l.height,purge:function(){f.call(this)}}),f.call(this)}return d}),d(P,[h,m,N,O],function(a,b,c,d){return function(e){var f,g=[c,d];f=function(){for(var a=0;a<g.length;a++)try{return new g[a](e)}catch(a){}throw new b.ImageError(b.ImageError.WRONG_FORMAT)}(),a.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){}}),a.extend(this,f),this.purge=function(){f.purge(),f=null}}}),d(Q,[],function(){function a(a,d,e){var f=a.naturalWidth,g=a.naturalHeight,h=e.width,i=e.height,j=e.x||0,k=e.y||0,l=d.getContext("2d");b(a)&&(f/=2,g/=2);var m=1024,n=document.createElement("canvas");n.width=n.height=m;for(var o=n.getContext("2d"),p=c(a,f,g),q=0;g>q;){for(var r=q+m>g?g-q:m,s=0;f>s;){var t=s+m>f?f-s:m;o.clearRect(0,0,m,m),o.drawImage(a,-s,-q);var u=s*h/f+j<<0,v=Math.ceil(t*h/f),w=q*i/g/p+k<<0,x=Math.ceil(r*i/g/p);l.drawImage(n,0,0,t,r,u,w,v,x),s+=m}q+=m}n=o=null}function b(a){var b=a.naturalWidth,c=a.naturalHeight;if(b*c>1048576){var d=document.createElement("canvas");d.width=d.height=1;var e=d.getContext("2d");return e.drawImage(a,-b+1,0),0===e.getImageData(0,0,1,1).data[3]}return!1}function c(a,b,c){var d=document.createElement("canvas");d.width=1,d.height=c;var e=d.getContext("2d");e.drawImage(a,0,0);for(var f=e.getImageData(0,0,1,c).data,g=0,h=c,i=c;i>g;){var j=f[4*(i-1)+3];0===j?h=i:g=i,i=h+g>>1}d=null;var k=i/c;return 0===k?1:k}return{isSubsampled:b,renderTo:a}}),d(R,[D,h,m,o,s,P,Q,j,k],function(a,b,c,d,e,f,g,h,i){function j(){function a(){if(!t&&!r)throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);return t||r}function j(a){return d.atob(a.substring(a.indexOf("base64,")+7))}function k(a,b){return"data:"+(b||"")+";base64,"+d.btoa(a)}function l(a){var b=this;r=new Image,r.onerror=function(){q.call(this),b.trigger("error",c.ImageError.WRONG_FORMAT)},r.onload=function(){b.trigger("load")},r.src=/^data:[^;]*;base64,/.test(a)?a:k(a,v.type)}function m(a,b){var d,e=this;return window.FileReader?(d=new FileReader,d.onload=function(){b(this.result)},d.onerror=function(){e.trigger("error",c.ImageError.WRONG_FORMAT)},void d.readAsDataURL(a)):b(a.getAsDataURL())}function n(c,d,e,f){var g,h,i,j,k,l=this,m=0,n=0;if(y=f,k=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==b.inArray(k,[5,6,7,8])){var q=c;c=d,d=q}return h=a(),e?(c=Math.min(c,h.width),d=Math.min(d,h.height),g=Math.max(c/h.width,d/h.height)):g=Math.min(c/h.width,d/h.height),g>1&&!e&&f?void this.trigger("Resize"):(t||(t=document.createElement("canvas")),i=Math.round(h.width*g),j=Math.round(h.height*g),e?(t.width=c,t.height=d,i>c&&(m=Math.round((i-c)/2)),j>d&&(n=Math.round((j-d)/2))):(t.width=i,t.height=j),y||p(t.width,t.height,k),o.call(this,h,t,-m,-n,i,j),this.width=t.width,this.height=t.height,x=!0,void l.trigger("Resize"))}function o(a,b,c,d,e,f){if("iOS"===i.OS)g.renderTo(a,b,{width:e,height:f,x:c,y:d});else{var h=b.getContext("2d");h.drawImage(a,c,d,e,f)}}function p(a,b,c){switch(c){case 5:case 6:case 7:case 8:t.width=b,t.height=a;break;default:t.width=a,t.height=b}var d=t.getContext("2d");switch(c){case 2:d.translate(a,0),d.scale(-1,1);break;case 3:d.translate(a,b),d.rotate(Math.PI);break;case 4:d.translate(0,b),d.scale(1,-1);break;case 5:d.rotate(.5*Math.PI),d.scale(1,-1);break;case 6:d.rotate(.5*Math.PI),d.translate(0,-b);break;case 7:d.rotate(.5*Math.PI),d.translate(a,-b),d.scale(-1,1);break;case 8:d.rotate(-.5*Math.PI),d.translate(-a,0)}}function q(){s&&(s.purge(),s=null),u=r=t=v=null,x=!1}var r,s,t,u,v,w=this,x=!1,y=!0;b.extend(this,{loadFromBlob:function(a){var b=this,d=b.getRuntime(),e=arguments.length>1?arguments[1]:!0;if(!d.can("access_binary"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);return v=a,a.isDetached()?(u=a.getSource(),void l.call(this,u)):void m.call(this,a.getSource(),function(a){e&&(u=j(a)),l.call(b,a)})},loadFromImage:function(a,b){this.meta=a.meta,v=new e(null,{name:a.name,size:a.size,type:a.type}),l.call(this,b?u=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var b,c=this.getRuntime();return!s&&u&&c.can("access_image_binary")&&(s=new f(u)),b={width:a().width||0,height:a().height||0,type:v.type||h.getFileMime(v.name),size:u&&u.length||v.size||0,name:v.name||"",meta:s&&s.meta||this.meta||{}}},downsize:function(){n.apply(this,arguments)},getAsCanvas:function(){return t&&(t.id=this.uid+"_canvas"),t},getAsBlob:function(a,b){return a!==this.type&&n.call(this,this.width,this.height,!1),new e(null,{name:v.name||"",type:a,data:w.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a){var b=arguments[1]||90;if(!x)return r.src;if("image/jpeg"!==a)return t.toDataURL("image/png");try{return t.toDataURL("image/jpeg",b/100)}catch(a){return t.toDataURL("image/jpeg")}},getAsBinaryString:function(a,b){if(!x)return u||(u=j(w.getAsDataURL(a,b))),u;if("image/jpeg"!==a)u=j(w.getAsDataURL(a,b));else{var c;b||(b=90);try{c=t.toDataURL("image/jpeg",b/100)}catch(a){c=t.toDataURL("image/jpeg")}u=j(c),s&&(u=s.stripHeaders(u),y&&(s.meta&&s.meta.exif&&s.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),u=s.writeHeaders(u)),s.purge(),s=null)}return x=!1,u},destroy:function(){w=null,q.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return a.Image=j}),d(S,[h,k,l,m,p],function(a,b,c,d,e){function f(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(b){a="0.0"}}return a=a.match(/\d+/g),parseFloat(a[0]+"."+a[1])}function g(g){var j,k=this;g=a.extend({swf_url:b.swf_url},g),e.call(this,g,h,{access_binary:function(a){return a&&"browser"===k.mode},access_image_binary:function(a){return a&&"browser"===k.mode},display_media:e.capTrue,do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===k.mode},resize_image:e.capTrue,return_response_headers:!1,return_response_type:function(b){return"json"===b&&window.JSON?!0:!a.arrayDiff(b,["","text","document"])||"browser"===k.mode},return_status_code:function(b){return"browser"===k.mode||!a.arrayDiff(b,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:function(a){return a&&"browser"===k.mode},send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"browser"===k.mode},send_multipart:e.capTrue,slice_blob:function(a){return a&&"browser"===k.mode},stream_upload:function(a){return a&&"browser"===k.mode},summon_file_dialog:!1,upload_filesize:function(b){return a.parseSizeStr(b)<=2097152||"client"===k.mode},use_http_method:function(b){return!a.arrayDiff(b,["GET","POST"])}},{access_binary:function(a){return a?"browser":"client"},access_image_binary:function(a){return a?"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(b){return a.arrayDiff(b,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(b){return a.arrayDiff(b,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"browser":"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(b){return a.parseSizeStr(b)>=2097152?"client":"browser"}},"client"),f()<10&&(this.mode=!1),a.extend(this,{getShim:function(){return c.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){var c,e,f;f=this.getShimContainer(),a.extend(f.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),c='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+g.swf_url+'" ',"IE"===b.browser&&(c+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),c+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+g.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+b.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===b.browser?(e=document.createElement("div"),f.appendChild(e),e.outerHTML=c,e=f=null):f.innerHTML=c,j=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(a){return function(){a.call(k),clearTimeout(j),g=j=a=k=null}}(this.destroy)},i)}var h="flash",i={};return e.addConstructor(h,g),i}),d(T,[S,r],function(a,b){var c={slice:function(a,c,d,e){var f=this.getRuntime();return 0>c?c=Math.max(a.size+c,0):c>0&&(c=Math.min(c,a.size)),0>d?d=Math.max(a.size+d,0):d>0&&(d=Math.min(d,a.size)),a=f.shimExec.call(this,"Blob","slice",c,d,e||""),a&&(a=new b(f.uid,a)),a}};return a.Blob=c}),d(U,[S],function(a){var b={init:function(a){this.getRuntime().shimExec.call(this,"FileInput","init",{name:a.name,accept:a.accept,multiple:a.multiple}),this.trigger("ready")}};return a.FileInput=b}),d(V,[S,o],function(a,b){function c(a,c){switch(c){case"readAsText":return b.atob(a,"utf8");case"readAsBinaryString":return b.atob(a);case"readAsDataURL":return a}return null}var d="",e={read:function(a,b){var e=this,f=e.getRuntime();return"readAsDataURL"===a&&(d="data:"+(b.type||"")+";base64,"),e.bind("Progress",function(b,e){e&&(d+=c(e,a))}),f.shimExec.call(this,"FileReader","readAsBase64",b.uid)},getResult:function(){return d},destroy:function(){d=null}};return a.FileReader=e}),d(W,[S,o],function(a,b){function c(a,c){switch(c){case"readAsText":return b.atob(a,"utf8");case"readAsBinaryString":return b.atob(a);case"readAsDataURL":return a}return null}var d={read:function(a,b){var d,e=this.getRuntime();return(d=e.shimExec.call(this,"FileReaderSync","readAsBase64",b.uid))?("readAsDataURL"===a&&(d="data:"+(b.type||"")+";base64,"+d),c(d,a,b.type)):null}};return a.FileReaderSync=d}),d(X,[S,h,r,s,y,z,B],function(a,b,c,d,e,f,g){var h={send:function(a,d){function e(){a.transport=k.mode,k.shimExec.call(j,"XMLHttpRequest","send",a,d)}function h(a,b){k.shimExec.call(j,"XMLHttpRequest","appendBlob",a,b.uid),d=null,e()}function i(a,b){var c=new g;c.bind("TransportingComplete",function(){b(this.result)}),c.transport(a.getSource(),a.type,{ruid:k.uid})}var j=this,k=j.getRuntime();if(b.isEmptyObj(a.headers)||b.each(a.headers,function(a,b){k.shimExec.call(j,"XMLHttpRequest","setRequestHeader",b,a.toString())}),d instanceof f){var l;if(d.each(function(a,b){a instanceof c?l=b:k.shimExec.call(j,"XMLHttpRequest","append",b,a)}),d.hasBlob()){var m=d.getBlob();m.isDetached()?i(m,function(a){m.destroy(),h(l,a)}):h(l,m)}else d=null,e()}else d instanceof c?d.isDetached()?i(d,function(a){d.destroy(),d=a.uid,e()}):(d=d.uid,e()):e()},getResponse:function(a){var c,f,g=this.getRuntime();if(f=g.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(f=new d(g.uid,f),"blob"===a)return f;try{if(c=new e,~b.inArray(a,["","text"]))return c.readAsText(f);if("json"===a&&window.JSON)return JSON.parse(c.readAsText(f))}finally{f.destroy()}}return null},abort:function(a){var b=this.getRuntime();b.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return a.XMLHttpRequest=h}),d(Y,[S,r],function(a,b){var c={getAsBlob:function(a){var c=this.getRuntime(),d=c.shimExec.call(this,"Transporter","getAsBlob",a);return d?new b(c.uid,d):null}};return a.Transporter=c}),d(Z,[S,h,B,r,y],function(a,b,c,d,e){var f={loadFromBlob:function(a){function b(a){e.shimExec.call(d,"Image","loadFromBlob",a.uid),d=e=null}var d=this,e=d.getRuntime();if(a.isDetached()){var f=new c;f.bind("TransportingComplete",function(){b(f.result.getSource())}),f.transport(a.getSource(),a.type,{ruid:e.uid})}else b(a.getSource())},loadFromImage:function(a){var b=this.getRuntime();return b.shimExec.call(this,"Image","loadFromImage",a.uid)},getAsBlob:function(a,b){var c=this.getRuntime(),e=c.shimExec.call(this,"Image","getAsBlob",a,b);return e?new d(c.uid,e):null},getAsDataURL:function(){var a,b=this.getRuntime(),c=b.Image.getAsBlob.apply(this,arguments);return c?(a=new e,a.readAsDataURL(c)):null}};return a.Image=f}),d($,[h,k,l,m,p],function(a,b,c,d,e){function f(a){var b,c,d,e,f,g=!1,h=null,i=0;try{try{h=new ActiveXObject("AgControl.AgControl"),h.IsVersionSupported(a)&&(g=!0),h=null}catch(h){var j=navigator.plugins["Silverlight Plug-In"];if(j){for(b=j.description,"1.0.30226.2"===b&&(b="2.0.30226.2"),c=b.split(".");c.length>3;)c.pop();for(;c.length<4;)c.push(0);for(d=a.split(".");d.length>4;)d.pop();do e=parseInt(d[i],10),f=parseInt(c[i],10),i++;while(i<d.length&&e===f);f>=e&&!isNaN(e)&&(g=!0)}}}catch(a){g=!1}return g}function g(g){var j,k=this;g=a.extend({xap_url:b.xap_url},g),e.call(this,g,h,{access_binary:e.capTrue,access_image_binary:e.capTrue,display_media:e.capTrue,do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:e.capTrue,resize_image:e.capTrue,return_response_headers:function(a){return a&&"client"===k.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(b){return"client"===k.mode||!a.arrayDiff(b,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:e.capTrue,send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"client"===k.mode},send_multipart:e.capTrue,slice_blob:e.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:e.capTrue,use_http_method:function(b){return"client"===k.mode||!a.arrayDiff(b,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(b){return a.arrayDiff(b,[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(b){return a.arrayDiff(b,["GET","POST"])?"client":["client","browser"]}}),f("2.0.31005.0")&&"Opera"!==b.browser||(this.mode=!1),a.extend(this,{getShim:function(){return c.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){var a;a=this.getShimContainer(),a.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+g.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+b.global_event_dispatcher+'"/></object>',j=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR))},"Windows"!==b.OS?1e4:5e3)},destroy:function(a){return function(){a.call(k),clearTimeout(j),g=j=a=k=null}}(this.destroy)},i)}var h="silverlight",i={};return e.addConstructor(h,g),i}),d(_,[$,h,T],function(a,b,c){return a.Blob=b.extend({},c)}),d(aa,[$],function(a){var b={init:function(a){function b(a){for(var b="",c=0;c<a.length;c++)b+=(""!==b?"|":"")+a[c].title+" | *."+a[c].extensions.replace(/,/g,";*.");return b}this.getRuntime().shimExec.call(this,"FileInput","init",b(a.accept),a.name,a.multiple),this.trigger("ready")}};return a.FileInput=b}),d(ba,[$,l,F],function(a,b,c){var d={init:function(){var a,d=this,e=d.getRuntime();return a=e.getShimContainer(),c.addEvent(a,"dragover",function(a){a.preventDefault(),a.stopPropagation(),a.dataTransfer.dropEffect="copy"},d.uid),c.addEvent(a,"dragenter",function(a){a.preventDefault();var c=b.get(e.uid).dragEnter(a);c&&a.stopPropagation()},d.uid),c.addEvent(a,"drop",function(a){a.preventDefault();var c=b.get(e.uid).dragDrop(a);c&&a.stopPropagation()},d.uid),e.shimExec.call(this,"FileDrop","init")}};return a.FileDrop=d}),d(ca,[$,h,V],function(a,b,c){return a.FileReader=b.extend({},c)}),d(da,[$,h,W],function(a,b,c){return a.FileReaderSync=b.extend({},c)}),d(ea,[$,h,X],function(a,b,c){return a.XMLHttpRequest=b.extend({},c)}),d(fa,[$,h,Y],function(a,b,c){return a.Transporter=b.extend({},c)}),d(ga,[$,h,Z],function(a,b,c){return a.Image=b.extend({},c,{getInfo:function(){var a=this.getRuntime(),c=["tiff","exif","gps"],d={meta:{}},e=a.shimExec.call(this,"Image","getInfo");return e.meta&&b.each(c,function(a){var b,c,f,g,h=e.meta[a];if(h&&h.keys)for(d.meta[a]={},c=0,f=h.keys.length;f>c;c++)b=h.keys[c],g=h[b],g&&(/^(\d|[1-9]\d+)$/.test(g)?g=parseInt(g,10):/^\d*\.\d+$/.test(g)&&(g=parseFloat(g)),d.meta[a][b]=g)}),d.width=parseInt(e.width,10),d.height=parseInt(e.height,10),d.size=parseInt(e.size,10),d.type=e.type,d.name=e.name,d}})}),d(ha,[h,m,p,k],function(a,b,c,d){function e(b){var e=this,h=c.capTest,i=c.capTrue;c.call(this,b,f,{access_binary:h(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:h(g.Image&&(d.can("create_canvas")||d.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:h(function(){return"Chrome"===d.browser&&d.version>=28||"IE"===d.browser&&d.version>=10}()),resize_image:function(){return g.Image&&e.can("access_binary")&&d.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(b){return"json"===b&&window.JSON?!0:!!~a.inArray(b,["text","document",""])},return_status_code:function(b){return!a.arrayDiff(b,[200,404])},select_file:function(){return d.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return e.can("select_file")},summon_file_dialog:h(function(){return"Firefox"===d.browser&&d.version>=4||"Opera"===d.browser&&d.version>=12||!!~a.inArray(d.browser,["Chrome","Safari"])}()),upload_filesize:i,use_http_method:function(b){return!a.arrayDiff(b,["GET","POST"])}}),a.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(e),a=e=null}}(this.destroy)}),a.extend(this.getShim(),g)}var f="html4",g={};return c.addConstructor(f,e),g}),d(ia,[ha,h,l,F,j,k],function(a,b,c,d,e,f){function g(){function a(){var e,k,l,m,n,o,p=this,q=p.getRuntime();o=b.guid("uid_"),e=q.getShimContainer(),g&&(l=c.get(g+"_form"),l&&b.extend(l.style,{top:"100%"})),m=document.createElement("form"),m.setAttribute("id",o+"_form"),m.setAttribute("method","post"),m.setAttribute("enctype","multipart/form-data"),m.setAttribute("encoding","multipart/form-data"),b.extend(m.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),n=document.createElement("input"),n.setAttribute("id",o),n.setAttribute("type","file"),n.setAttribute("name",h.name||"Filedata"),n.setAttribute("accept",j.join(",")),b.extend(n.style,{fontSize:"999px",opacity:0}),m.appendChild(n),e.appendChild(m),b.extend(n.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===f.browser&&f.version<10&&b.extend(n.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),n.onchange=function(){var b;this.value&&(b=this.files?this.files[0]:{name:this.value},i=[b],this.onchange=function(){},a.call(p),p.bind("change",function a(){var b,d=c.get(o),e=c.get(o+"_form");p.unbind("change",a),p.files.length&&d&&e&&(b=p.files[0],d.setAttribute("id",b.uid),e.setAttribute("id",b.uid+"_form"),e.setAttribute("target",b.uid+"_iframe")),d=e=null},998),n=m=null,p.trigger("change"))},q.can("summon_file_dialog")&&(k=c.get(h.browse_button),d.removeEvent(k,"click",p.uid),d.addEvent(k,"click",function(a){n&&!n.disabled&&n.click(),a.preventDefault()},p.uid)),g=o,e=l=k=null}var g,h,i=[],j=[];b.extend(this,{init:function(b){var f,g=this,i=g.getRuntime();h=b,j=b.accept.mimes||e.extList2mimes(b.accept,i.can("filter_by_extension")),f=i.getShimContainer(),function(){var a,e,h;a=c.get(b.browse_button),i.can("summon_file_dialog")&&("static"===c.getStyle(a,"position")&&(a.style.position="relative"),e=parseInt(c.getStyle(a,"z-index"),10)||1,a.style.zIndex=e,f.style.zIndex=e-1),h=i.can("summon_file_dialog")?a:f,d.addEvent(h,"mouseover",function(){g.trigger("mouseenter")},g.uid),d.addEvent(h,"mouseout",function(){g.trigger("mouseleave")},g.uid),d.addEvent(h,"mousedown",function(){g.trigger("mousedown")},g.uid),d.addEvent(c.get(b.container),"mouseup",function(){g.trigger("mouseup")},g.uid),a=null}(),a.call(this),f=null,g.trigger({type:"ready",async:!0})},getFiles:function(){return i},disable:function(a){var b;(b=c.get(g))&&(b.disabled=!!a)},destroy:function(){var a=this.getRuntime(),b=a.getShim(),e=a.getShimContainer();d.removeAllEvents(e,this.uid),d.removeAllEvents(h&&c.get(h.container),this.uid),d.removeAllEvents(h&&c.get(h.browse_button),this.uid),e&&(e.innerHTML=""),b.removeInstance(this.uid),g=i=j=h=e=b=null}})}return a.FileInput=g}),d(ja,[ha,I],function(a,b){return a.FileReader=b}),d(ka,[ha,h,l,x,m,F,r,z],function(a,b,c,d,e,f,g,h){function i(){function a(a){var b,d,e,g,h=this,i=!1;if(k){if(b=k.id.replace(/_iframe$/,""),d=c.get(b+"_form")){for(e=d.getElementsByTagName("input"),g=e.length;g--;)switch(e[g].getAttribute("type")){case"hidden":e[g].parentNode.removeChild(e[g]);break;case"file":i=!0}e=[],i||d.parentNode.removeChild(d),d=null}setTimeout(function(){f.removeEvent(k,"load",h.uid),k.parentNode&&k.parentNode.removeChild(k);var b=h.getRuntime().getShimContainer();b.children.length||b.parentNode.removeChild(b),b=k=null,a()},1)}}var i,j,k;b.extend(this,{send:function(l,m){function n(){var c=t.getShimContainer()||document.body,e=document.createElement("div");e.innerHTML='<iframe id="'+o+'_iframe" name="'+o+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',k=e.firstChild,c.appendChild(k),f.addEvent(k,"load",function(){var c;try{c=k.contentWindow.document||k.contentDocument||window.frames[k.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(c.title)?i=c.title.replace(/^(\d+).*$/,"$1"):(i=200,j=b.trim(c.body.innerHTML),s.trigger({type:"progress",loaded:j.length,total:j.length}),r&&s.trigger({type:"uploadprogress",loaded:r.size||1025,total:r.size||1025}))}catch(b){if(!d.hasSameOrigin(l.url))return void a.call(s,function(){s.trigger("error")});i=404}a.call(s,function(){s.trigger("load")})},s.uid)}var o,p,q,r,s=this,t=s.getRuntime();if(i=j=null,m instanceof h&&m.hasBlob()){if(r=m.getBlob(),o=r.uid,q=c.get(o),p=c.get(o+"_form"),!p)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR)}else o=b.guid("uid_"),p=document.createElement("form"),p.setAttribute("id",o+"_form"),p.setAttribute("method",l.method),p.setAttribute("enctype","multipart/form-data"),p.setAttribute("encoding","multipart/form-data"),p.setAttribute("target",o+"_iframe"),t.getShimContainer().appendChild(p);m instanceof h&&m.each(function(a,c){if(a instanceof g)q&&q.setAttribute("name",c);else{var d=document.createElement("input");b.extend(d,{type:"hidden",name:c,value:a}),q?p.insertBefore(d,q):p.appendChild(d)}}),p.setAttribute("action",l.url),n(),p.submit(),s.trigger("loadstart")},getStatus:function(){return i},getResponse:function(a){if("json"===a&&"string"===b.typeOf(j)&&window.JSON)try{return JSON.parse(j.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(a){return null}return j},abort:function(){var b=this;k&&k.contentWindow&&(k.contentWindow.stop?k.contentWindow.stop():k.contentWindow.document.execCommand?k.contentWindow.document.execCommand("Stop"):k.src="about:blank"),a.call(this,function(){b.dispatchEvent("abort")})}})}return a.XMLHttpRequest=i}),d(la,[ha,R],function(a,b){return a.Image=b}),f([h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,F])}(this),function(a){"use strict";var b={},c=a.moxie.core.utils.Basic.inArray;return function a(d){var e,f;for(e in d)f=typeof d[e],"object"!==f||~c(e,["Exceptions","Env","Mime"])?"function"===f&&(b[e]=d[e]):a(d[e])}(a.moxie),b.Env=a.moxie.core.utils.Env,b.Mime=a.moxie.core.utils.Mime,b.Exceptions=a.moxie.core.Exceptions,a.mOxie=b,a.o||(a.o=b),b}(this),function(a,b,c){function d(a){function b(a,b,c){var e={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};e[a]?d[e[a]]=b:c||(d[a]=b)}var c=a.required_features,d={};return"string"==typeof c?g.each(c.split(/\s*,\s*/),function(a){b(a,!0)}):"object"==typeof c?g.each(c,function(a,c){b(c,a)}):c===!0&&(a.chunk_size>0&&(d.slice_blob=!0),!a.resize.enabled&&a.multipart||(d.send_binary_string=!0),g.each(a,function(a,c){b(c,!!a,!0)})),d}var e=a.setTimeout,f={},g={VERSION:"2.1.6",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:b.mimes,ua:b.ua,typeOf:b.typeOf,extend:b.extend,guid:b.guid,get:function(a){var c,d=[];"array"!==b.typeOf(a)&&(a=[a]);for(var e=a.length;e--;)c=b.get(a[e]),c&&d.push(c);return d.length?d:null},each:b.each,getPos:b.getPos,getSize:b.getSize,xmlEncode:function(a){var b={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},c=/[<>&\"\']/g;return a?(""+a).replace(c,function(a){return b[a]?"&"+b[a]+";":a}):a},toArray:b.toArray,inArray:b.inArray,addI18n:b.addI18n,translate:b.translate,isEmptyObj:b.isEmptyObj,hasClass:b.hasClass,addClass:b.addClass,removeClass:b.removeClass,getStyle:b.getStyle,addEvent:b.addEvent,removeEvent:b.removeEvent,removeAllEvents:b.removeAllEvents,cleanName:function(a){var b,c;for(c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],b=0;b<c.length;b+=2)a=a.replace(c[b],c[b+1]);return a=a.replace(/\s+/g,"_"),a=a.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(a,b){var c="";return g.each(b,function(a,b){c+=(c?"&":"")+encodeURIComponent(b)+"="+encodeURIComponent(a)}),c&&(a+=(a.indexOf("?")>0?"&":"?")+c),a},formatSize:function(a){function b(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}if(a===c||/\D/.test(a))return g.translate("N/A");var d=Math.pow(1024,4);return a>d?b(a/d,1)+" "+g.translate("tb"):a>(d/=1024)?b(a/d,1)+" "+g.translate("gb"):a>(d/=1024)?b(a/d,1)+" "+g.translate("mb"):a>1024?Math.round(a/1024)+" "+g.translate("kb"):a+" "+g.translate("b")},parseSize:b.parseSizeStr,predictRuntime:function(a,c){var d,e;return d=new g.Uploader(a),e=b.Runtime.thatCan(d.getOption().required_features,c||a.runtimes),d.destroy(),e},addFileFilter:function(a,b){f[a]=b}};g.addFileFilter("mime_types",function(a,b,c){a.length&&!a.regexp.test(b.name)?(this.trigger("Error",{code:g.FILE_EXTENSION_ERROR,message:g.translate("File extension error."),file:b}),c(!1)):c(!0)}),g.addFileFilter("max_file_size",function(a,b,c){var d;a=g.parseSize(a),b.size!==d&&a&&b.size>a?(this.trigger("Error",{code:g.FILE_SIZE_ERROR,message:g.translate("File size error."),file:b}),c(!1)):c(!0)}),g.addFileFilter("prevent_duplicates",function(a,b,c){if(a)for(var d=this.files.length;d--;)if(b.name===this.files[d].name&&b.size===this.files[d].size)return this.trigger("Error",{code:g.FILE_DUPLICATE_ERROR,
message:g.translate("Duplicate file error."),file:b}),void c(!1);c(!0)}),g.Uploader=function(a){function h(){var a,b,c=0;if(this.state==g.STARTED){for(b=0;b<D.length;b++)a||D[b].status!=g.QUEUED?c++:(a=D[b],this.trigger("BeforeUpload",a)&&(a.status=g.UPLOADING,this.trigger("UploadFile",a)));c==D.length&&(this.state!==g.STOPPED&&(this.state=g.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",D))}}function i(a){a.percent=a.size>0?Math.ceil(a.loaded/a.size*100):100,j()}function j(){var a,b;for(A.reset(),a=0;a<D.length;a++)b=D[a],b.size!==c?(A.size+=b.origSize,A.loaded+=b.loaded*b.origSize/b.size):A.size=c,b.status==g.DONE?A.uploaded++:b.status==g.FAILED?A.failed++:A.queued++;A.size===c?A.percent=D.length>0?Math.ceil(A.uploaded/D.length*100):0:(A.bytesPerSec=Math.ceil(A.loaded/((+new Date-z||1)/1e3)),A.percent=A.size>0?Math.ceil(A.loaded/A.size*100):0)}function k(){var a=F[0]||G[0];return a?a.getRuntime().uid:!1}function l(a,c){if(a.ruid){var d=b.Runtime.getInfo(a.ruid);if(d)return d.can(c)}return!1}function m(){this.bind("FilesAdded FilesRemoved",function(a){a.trigger("QueueChanged"),a.refresh()}),this.bind("CancelUpload",u),this.bind("BeforeUpload",q),this.bind("UploadFile",r),this.bind("UploadProgress",s),this.bind("StateChanged",t),this.bind("QueueChanged",j),this.bind("Error",w),this.bind("FileUploaded",v),this.bind("Destroy",x)}function n(a,c){var d=this,e=0,f=[],h={runtime_order:a.runtimes,required_caps:a.required_features,preferred_caps:E,swf_url:a.flash_swf_url,xap_url:a.silverlight_xap_url};g.each(a.runtimes.split(/\s*,\s*/),function(b){a[b]&&(h[b]=a[b])}),a.browse_button&&g.each(a.browse_button,function(c){f.push(function(f){var i=new b.FileInput(g.extend({},h,{accept:a.filters.mime_types,name:a.file_data_name,multiple:a.multi_selection,container:a.container,browse_button:c}));i.onready=function(){var a=b.Runtime.getInfo(this.ruid);b.extend(d.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),multi_selection:a.can("select_multiple")}),e++,F.push(this),f()},i.onchange=function(){d.addFile(this.files)},i.bind("mouseenter mouseleave mousedown mouseup",function(d){H||(a.browse_button_hover&&("mouseenter"===d.type?b.addClass(c,a.browse_button_hover):"mouseleave"===d.type&&b.removeClass(c,a.browse_button_hover)),a.browse_button_active&&("mousedown"===d.type?b.addClass(c,a.browse_button_active):"mouseup"===d.type&&b.removeClass(c,a.browse_button_active)))}),i.bind("mousedown",function(){d.trigger("Browse")}),i.bind("error runtimeerror",function(){i=null,f()}),i.init()})}),a.drop_element&&g.each(a.drop_element,function(a){f.push(function(c){var f=new b.FileDrop(g.extend({},h,{drop_zone:a}));f.onready=function(){var a=b.Runtime.getInfo(this.ruid);d.features.dragdrop=a.can("drag_and_drop"),e++,G.push(this),c()},f.ondrop=function(){d.addFile(this.files)},f.bind("error runtimeerror",function(){f=null,c()}),f.init()})}),b.inSeries(f,function(){"function"==typeof c&&c(e)})}function o(a,d,e){var f=new b.Image;try{f.onload=function(){return d.width>this.width&&d.height>this.height&&d.quality===c&&d.preserve_headers&&!d.crop?(this.destroy(),e(a)):void f.downsize(d.width,d.height,d.crop,d.preserve_headers)},f.onresize=function(){e(this.getAsBlob(a.type,d.quality)),this.destroy()},f.onerror=function(){e(a)},f.load(a)}catch(b){e(a)}}function p(a,c,e){function f(a,b,c){var d=y[a];switch(a){case"max_file_size":"max_file_size"===a&&(y.max_file_size=y.filters.max_file_size=b);break;case"chunk_size":(b=g.parseSize(b))&&(y[a]=b,y.send_file_name=!0);break;case"multipart":y[a]=b,b||(y.send_file_name=!0);break;case"unique_names":y[a]=b,b&&(y.send_file_name=!0);break;case"filters":"array"===g.typeOf(b)&&(b={mime_types:b}),c?g.extend(y.filters,b):y.filters=b,b.mime_types&&(y.filters.mime_types.regexp=function(a){var b=[];return g.each(a,function(a){g.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?b.push("\\.*"):b.push("\\."+a.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+b.join("|")+")$","i")}(y.filters.mime_types));break;case"resize":c?g.extend(y.resize,b,{enabled:!0}):y.resize=b;break;case"prevent_duplicates":y.prevent_duplicates=y.filters.prevent_duplicates=!!b;break;case"browse_button":case"drop_element":b=g.get(b);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":y[a]=b,c||(i=!0);break;default:y[a]=b}c||h.trigger("OptionChanged",a,b,d)}var h=this,i=!1;"object"==typeof a?g.each(a,function(a,b){f(b,a,e)}):f(a,c,e),e?(y.required_features=d(g.extend({},y)),E=d(g.extend({},y,{required_features:!0}))):i&&(h.trigger("Destroy"),n.call(h,y,function(a){a?(h.runtime=b.Runtime.getInfo(k()).type,h.trigger("Init",{runtime:h.runtime}),h.trigger("PostInit")):h.trigger("Error",{code:g.INIT_ERROR,message:g.translate("Init error.")})}))}function q(a,b){if(a.settings.unique_names){var c=b.name.match(/\.([^.]+)$/),d="part";c&&(d=c[1]),b.target_name=b.id+"."+d}}function r(a,c){function d(){k-- >0?e(f,1e3):(c.loaded=n,a.trigger("Error",{code:g.HTTP_ERROR,message:g.translate("HTTP Error."),file:c,response:B.responseText,status:B.status,responseHeaders:B.getAllResponseHeaders()}))}function f(){var l,o,p,q={};c.status===g.UPLOADING&&a.state!==g.STOPPED&&(a.settings.send_file_name&&(q.name=c.target_name||c.name),j&&m.chunks&&h.size>j?(p=Math.min(j,h.size-n),l=h.slice(n,n+p)):(p=h.size,l=h),j&&m.chunks&&(a.settings.send_chunk_number?(q.chunk=Math.ceil(n/j),q.chunks=Math.ceil(h.size/j)):(q.offset=n,q.total=h.size)),B=new b.XMLHttpRequest,B.upload&&(B.upload.onprogress=function(b){c.loaded=Math.min(c.size,n+b.loaded),a.trigger("UploadProgress",c)}),B.onload=function(){return B.status>=400?void d():(k=a.settings.max_retries,p<h.size?(l.destroy(),n+=p,c.loaded=Math.min(n,h.size),a.trigger("ChunkUploaded",c,{offset:c.loaded,total:h.size,response:B.responseText,status:B.status,responseHeaders:B.getAllResponseHeaders()}),"Android Browser"===b.Env.browser&&a.trigger("UploadProgress",c)):c.loaded=c.size,l=o=null,!n||n>=h.size?(c.size!=c.origSize&&(h.destroy(),h=null),a.trigger("UploadProgress",c),c.status=g.DONE,a.trigger("FileUploaded",c,{response:B.responseText,status:B.status,responseHeaders:B.getAllResponseHeaders()})):e(f,1),void 0)},B.onerror=function(){d()},B.onloadend=function(){this.destroy(),B=null},a.settings.multipart&&m.multipart?(B.open("post",i,!0),g.each(a.settings.headers,function(a,b){B.setRequestHeader(b,a)}),o=new b.FormData,g.each(g.extend(q,a.settings.multipart_params),function(a,b){o.append(b,a)}),o.append(a.settings.file_data_name,l),B.send(o,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:E,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})):(i=g.buildUrl(a.settings.url,g.extend(q,a.settings.multipart_params)),B.open("post",i,!0),B.setRequestHeader("Content-Type","application/octet-stream"),g.each(a.settings.headers,function(a,b){B.setRequestHeader(b,a)}),B.send(l,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:E,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})))}var h,i=a.settings.url,j=a.settings.chunk_size,k=a.settings.max_retries,m=a.features,n=0;c.loaded&&(n=c.loaded=j?j*Math.floor(c.loaded/j):0),h=c.getSource(),a.settings.resize.enabled&&l(h,"send_binary_string")&&~b.inArray(h.type,["image/jpeg","image/png"])?o.call(this,h,a.settings.resize,function(a){h=a,c.size=a.size,f()}):f()}function s(a,b){i(b)}function t(a){if(a.state==g.STARTED)z=+new Date;else if(a.state==g.STOPPED)for(var b=a.files.length-1;b>=0;b--)a.files[b].status==g.UPLOADING&&(a.files[b].status=g.QUEUED,j())}function u(){B&&B.abort()}function v(a){j(),e(function(){h.call(a)},1)}function w(a,b){b.code===g.INIT_ERROR?a.destroy():b.code===g.HTTP_ERROR&&(b.file.status=g.FAILED,i(b.file),a.state==g.STARTED&&(a.trigger("CancelUpload"),e(function(){h.call(a)},1)))}function x(a){a.stop(),g.each(D,function(a){a.destroy()}),D=[],F.length&&(g.each(F,function(a){a.destroy()}),F=[]),G.length&&(g.each(G,function(a){a.destroy()}),G=[]),E={},H=!1,z=B=null,A.reset()}var y,z,A,B,C=g.guid(),D=[],E={},F=[],G=[],H=!1;y={runtimes:b.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_file_name:!0,send_chunk_number:!0},p.call(this,a,null,!0),A=new g.QueueProgress,g.extend(this,{id:C,uid:C,state:g.STOPPED,features:{},runtime:null,files:D,settings:y,total:A,init:function(){var a=this;return"function"==typeof y.preinit?y.preinit(a):g.each(y.preinit,function(b,c){a.bind(c,b)}),m.call(this),y.browse_button&&y.url?void n.call(this,y,function(c){"function"==typeof y.init?y.init(a):g.each(y.init,function(b,c){a.bind(c,b)}),c?(a.runtime=b.Runtime.getInfo(k()).type,a.trigger("Init",{runtime:a.runtime}),a.trigger("PostInit")):a.trigger("Error",{code:g.INIT_ERROR,message:g.translate("Init error.")})}):void this.trigger("Error",{code:g.INIT_ERROR,message:g.translate("Init error.")})},setOption:function(a,b){p.call(this,a,b,!this.runtime)},getOption:function(a){return a?y[a]:y},refresh:function(){F.length&&g.each(F,function(a){a.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=g.STARTED&&(this.state=g.STARTED,this.trigger("StateChanged"),h.call(this))},stop:function(){this.state!=g.STOPPED&&(this.state=g.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){H=arguments[0]!==c?arguments[0]:!0,F.length&&g.each(F,function(a){a.disable(H)}),this.trigger("DisableBrowse",H)},getFile:function(a){var b;for(b=D.length-1;b>=0;b--)if(D[b].id===a)return D[b]},addFile:function(a,c){function d(a,c){var d=[];b.each(j.settings.filters,function(b,c){f[c]&&d.push(function(d){f[c].call(j,b,a,function(a){d(!a)})})}),b.inSeries(d,c)}function h(a){var f=b.typeOf(a);if(a instanceof b.File){if(!a.ruid&&!a.isDetached()){if(!i)return!1;a.ruid=i,a.connectRuntime(i)}h(new g.File(a))}else a instanceof b.Blob?(h(a.getSource()),a.destroy()):a instanceof g.File?(c&&(a.name=c),l.push(function(b){d(a,function(c){c||(D.push(a),m.push(a),j.trigger("FileFiltered",a)),e(b,1)})})):-1!==b.inArray(f,["file","blob"])?h(new b.File(null,a)):"node"===f&&"filelist"===b.typeOf(a.files)?b.each(a.files,h):"array"===f&&(c=null,b.each(a,h))}var i,j=this,l=[],m=[];i=k(),h(a),l.length&&b.inSeries(l,function(){m.length&&j.trigger("FilesAdded",m)})},removeFile:function(a){for(var b="string"==typeof a?a:a.id,c=D.length-1;c>=0;c--)if(D[c].id===b)return this.splice(c,1)[0]},splice:function(a,b){var d=D.splice(a===c?0:a,b===c?D.length:b),e=!1;return this.state==g.STARTED&&(g.each(d,function(a){return a.status===g.UPLOADING?(e=!0,!1):void 0}),e&&this.stop()),this.trigger("FilesRemoved",d),g.each(d,function(a){a.destroy()}),e&&this.start(),d},bind:function(a,b,c){var d=this;g.Uploader.prototype.bind.call(this,a,function(){var a=[].slice.call(arguments);return a.splice(0,1,d),b.apply(this,a)},0,c)},destroy:function(){this.trigger("Destroy"),y=A=null,this.unbindAll()}})},g.Uploader.prototype=b.EventTarget.instance,g.File=function(){function a(a){g.extend(this,{id:g.guid(),name:a.name||a.fileName,type:a.type||"",size:a.size||a.fileSize,origSize:a.size||a.fileSize,loaded:0,percent:0,status:g.QUEUED,lastModifiedDate:a.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var a=this.getSource().getSource();return-1!==b.inArray(b.typeOf(a),["blob","file"])?a:null},getSource:function(){return c[this.id]?c[this.id]:null},destroy:function(){var a=this.getSource();a&&(a.destroy(),delete c[this.id])}}),c[this.id]=a}var c={};return a}(),g.QueueProgress=function(){var a=this;a.size=0,a.loaded=0,a.uploaded=0,a.failed=0,a.queued=0,a.percent=0,a.bytesPerSec=0,a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}},a.plupload=g}(window,mOxie),define("plupload",function(){}),define("feeds/lib/ui/attachments/uploader",["require","backbone","jquery","underscore","feeds/lib/modules/video_encoding_progress","core/lib/ctor","common-ui/lib/helper/environment","core/lib/filename_helper","core/lib/report","core/lib/session","core/lib/tr","core/lib/yammer_config","core/lib/yammer_request","plupload"],function(a){var b=a("backbone"),c=a("jquery"),d=a("underscore"),e=a("feeds/lib/modules/video_encoding_progress"),f=a("core/lib/ctor"),g=a("common-ui/lib/helper/environment"),h=a("core/lib/filename_helper"),i=a("core/lib/report"),j=a("core/lib/session"),k=a("core/lib/tr"),l=a("core/lib/yammer_config"),m=a("core/lib/yammer_request");a("plupload");var n=[["jpg","jpeg"],["tif","tiff"]];return f("yam.ui.attachments.FileVilleUploader",[b.Events],{init:function(a){this.files={},this._encodingFiles={},this.maxFiles=25,this._validateArguments(a),this._delegate=this._getDelegate(a.eventDelegate),this._filters=this._getFilters(a.extensions),this._feedId=a.feedId,this._fileId=a.fileId,this._networkId=a.networkId,this._url=l.config().filesHost,this._fileParams=this._createParams(),this._headers=this._getHeaders(),this._uploader=this._setupPlupload(a),this._attachUploaderEvents(),this._videoEncodingProgresses={}},_setupPlupload:function(a){var b=this._createPluploadInstance(a),c=a.button,d=a.container;return this.button=c,b.init(),b.bind("PostInit",function(){var a=d.find(".moxie-shim-html5");a.attr("aria-hidden",!0).find("input").prop("tabIndex",-1)}),b},_createPluploadInstance:function(a){var b="html5",c=null!=a.button?[a.button.get(0)]:null,d=null!=a.container?a.container.get(0):null,e=new plupload.Uploader({runtimes:b,browse_button:c,drop_element:c,container:d,url:this._url,multipart:!0,multipart_params:this._fileParams,headers:this._headers,filters:this._filters,chunk_size:"28MB"});return e},_isVideo:function(a){var b=h.getCanonicalExtension(a);return"mov"===b||"swf"===b},_handleFilesAdded:function(a,c){return a.files.length+c.length>this.maxFiles?(b.trigger("/ui/alert/show","error",k.t("your_upload_failed_too_many_files")),d.each(c,function(b){a.removeFile(b)},this),!1):(a.start(),void this._delegate.handleFilesAdded(c))},_handleUploadComplete:function(){this._complete=!0,0===d.keys(this._encodingFiles).length&&this._delegate.handleUploadFinish(this)},_handleFileUpload:function(a,b,c){if(0===c.status)return!1;try{c=JSON.parse(c.response)}catch(a){return this._fail(b),!1}var d=c.file_id?c.path:c.name;this.files[b.id]=c,this._isVideo(d)&&!c.transcoded&&this._handleAsyncFileEncoding(b,c);var e=!0;this._delegate.handleFileUpload(b,c,e),this.trigger("fileUpload",b,c,e)},_handleAsyncFileEncoding:function(a,b){var c=null,d=null,f=a.id;b.latest_version?(c=b.latest_version.file_id,d=b.latest_version.id):(c=b.file_id,d=b.id);var g=e.create({fileId:c,versionId:d});this._videoEncodingProgresses[f]=g;var h=function(b){this._delegate.handleEncodingComplete(a,b)},i=function(){this.files[f]||g.unhandleEncodingStatusChange()};this.files[f]&&g.handleEncodingStatusChange({onEncoded:h.bind(this),onEncoding:i.bind(this)},1e3)},_handleUploadProgress:function(a,b){this._delegate.handleUploadProgress(b),this.trigger("uploadProgress",b)},_handleUploadError:function(a,c){if(c.code==plupload.INIT_ERROR)this.destroy();else{var e=k.t("your_upload_failed");switch(c.code){case plupload.FILE_EXTENSION_ERROR:e=k.t("your_upload_failed_file_extension_error");break;case plupload.FILE_SIZE_ERROR:e=k.t("your_upload_failed_file_size_error");break;case plupload.HTTP_ERROR:var f=new Error,g={status:c.status,responseHeaders:c.responseHeaders,message:c.message,file:d.pick(c.file,["size","origSize","loaded","type"])};i.error({message:"Plupload error: Error communicating with server",plupload_error:g},f)}this._delegate.handleUploadError(c.file),this.trigger("uploadError",c.file),b.trigger("/ui/alert/show","error",e)}},_beforeUpload:function(a,b){this._uploader.settings.multipart_params.file_name=b.name,this._delegate.handleUpload(b),this.trigger("uploadStart",b)},_validateArguments:function(a){if(!a.button)throw new Error("Invalid arguments: button property missing")},_attachUploaderEvents:function(){this._uploader.bind("BeforeUpload",this._beforeUpload.bind(this)),this._uploader.bind("UploadComplete",this._handleUploadComplete.bind(this)),this._uploader.bind("FileUploaded",this._handleFileUpload.bind(this)),this._uploader.bind("Error",this._handleUploadError.bind(this)),this._uploader.bind("FilesAdded",this._handleFilesAdded.bind(this)),this._uploader.bind("UploadProgress",this._handleUploadProgress.bind(this))},_getHeaders:function(){return{Authorization:"Bearer "+j.getCurrentUser().web_oauth_access_token}},_createParams:function(){var a={};return this._feedId&&"company"!==this._feedId&&(a.group_id=this._feedId),this._fileId&&(a.file_id=this._fileId),this._networkId&&(a.network_id=this._networkId),a.encode_video_with_ams=!0,a},_fail:function(a){b.trigger("/ui/alert/show","error","Upload failed"),this._delegate.handleUploadError(a),this.trigger("uploadError",a)},destroy:function(){this.button.off(),this._uploader.stop(),d.each(this._encodingFiles,function(a){window.clearInterval(a)}),this._encodingFiles={};for(var a in this._videoEncodingProgresses)a.destroy&&(a.destroy(),delete this._videoEncodingProgresses[a]);try{this._uploader.destroy()}catch(a){}},get:function(a){return this._uploader.getFile(a)},remove:function(a){delete this.files[a.id];var c=this._encodingFiles[a.name];window.clearInterval(c),delete this._encodingFiles[a.name],this._uploader.stop(),this._uploader.removeFile(a),b.trigger("/ui/alert/show","notice",k.t("file_removed")),this._delegate.handleUploadCancel(a),this.trigger("uploadCancel",a),this._uploader.files.length?this._uploader.start():(this._delegate.handleUploadFinish(this),this.trigger("uploadFinish",this))},reset:function(){for(var a in this.files){delete this.files[a];var b=this._encodingFiles[a.name];window.clearInterval(b),delete this._encodingFiles[a.name],this._uploader.stop(),this._uploader.removeFile(a);var c=this._videoEncodingProgresses[a.id];c&&(c.destroy(),delete this._videoEncodingProgresses[a.id])}},complete:function(a){if(0===d.keys(this.files).length)return void(a&&a());var c=this,e=function(d){var f=d.shift(),g="/api/v1/uploaded_files/"+f.id+"/finish",h="PUT";c._feedId&&(g+="?group_id="+c._feedId),c._networkId&&(g+="&network_id="+c._networkId),c._fileId&&(h="POST",g="/api/v1/uploaded_files/"+f.file_id+"/versions/"+f.id+"?finish=true"),m.send({url:g,type:h,success:function(f){b.trigger("/ui/files/newFile",f),d.length?e(d):(c.files={},a&&a(f,c))},error:function(){c._fail(f)}})};e(d.map(this.files,function(a){return a}))},setGroup:function(a){this._feedId=a,this._fileParams=this._createParams(),this._uploader.settings.multipart_params=this._fileParams},setNetwork:function(a){this._networkId=a,this._fileParams=this._createParams(),this._uploader.settings.multipart_params=this._fileParams},_getDelegate:function(a){var b=["Upload","FileUpload","UploadFinish","UploadProgress","FilesAdded","UploadCancel","UploadError","EncodingComplete"];return a=a||{},d.each(b,function(b){var d="handle"+b;d in a||(a[d]=c.noop)}),a},_getFilters:function(a){if(null==a||g.isIE()&&g.isIE().version<11)return[];d.isArray(a)||(a=a.split(","));var b=d.reduce(a,function(a,b){b=b.toLowerCase();var c=d.find(n,function(a){return d.contains(a,b)});return null!=c?a.push.apply(a,c):a.push(b),a},[]);return[{extensions:b.join(",")}]},refresh:function(){this._uploader.refresh()},disableBrowse:function(a){this._uploader.disableBrowse(a||!0)}})}),define("core/lib/file_upload_delegate",["require","underscore","core/lib/backbone_base_view"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view");return c.extend({initialize:function(){b.bindAll(this,"_removeFileForUpload","handleFilesAdded","handleUploadProgress","handleFileUpload","handleEncodingComplete","handleUploadFinish","handleUploadCancel","handleUploadError")},handleFilesAdded:function(a){return this.options.collection.add(b.map(a,function(a){return{uploadId:a.id,type:"uploaded_file",name:a.name,description:a.description,progress:0}})),a},handleUploadProgress:function(a){if(b.isFinite(a.percent)){var c=this._getFileForUpload(a);c&&c.set({progress:Math.max(1,Math.min(a.percent,99))})}},handleFileUpload:function(a,c,d){var e=b.extend({progress:d?100:99},c);this._getFileForUpload(a).set(e)},handleEncodingComplete:function(a,b){this._getFileForUpload(a).set(b)},handleUploadFinish:function(){this.options.collection.each(function(a){a.set({progress:100})})},handleUploadCancel:function(a){this._removeFileForUpload(a)},handleUploadError:function(a){this._removeFileForUpload(a)},handleUpload:b.noop,_getFileForUpload:function(a){return this.options.collection.findWhere({uploadId:a.id})},_removeFileForUpload:function(a){var b=this._getFileForUpload(a);null!=b&&this.options.collection.remove(b)}})}),define("feeds/lib/ui/publisher/global/paste_uploader",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","feeds/lib/ui/attachments/uploader","core/lib/file_upload_delegate"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("feeds/lib/ui/attachments/uploader"),e=a("core/lib/file_upload_delegate");return b.extend({mixins:[c],initialize:function(a){this._networkId=a.networkId,this._createUploader()},addFile:function(a){this._uploader._uploader.addFile(a)},start:function(){this._uploader._uploader.start()},refresh:function(){return this._uploader.refresh(),this},remove:function(){return null!=this._uploader&&this._uploader.destroy(),b.prototype.remove.call(this)},_createUploader:function(){this._uploader=new d({button:this.$el,container:this.$el,eventDelegate:new e({collection:this.collection}),networkId:this._networkId}),this._setupListeners()},_setupListeners:function(){this.listenTo(this.collection,"remove",this._removeUploadFromUploader),this.listenTo(this.collection,"reset",this._resetUploader)},_resetUploader:function(){this._uploader&&this._uploader.reset&&this._uploader.reset()},_removeUploadFromUploader:function(a){var b=this._uploader.get(a.get("uploadId"));null!=b&&this._uploader.remove(b)}})}),define("core/lib/util/clipboard",[],function(){"use strict";return{getFileFromPaste:function(a){return a.originalEvent.clipboardData.items&&a.originalEvent.clipboardData.items.length?a.originalEvent.clipboardData.items[0].getAsFile():void 0}}}),define("feeds/lib/ui/publisher/global/body_editor",["require","underscore","core/lib/tr","core/lib/log","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","models/recipient","feeds/lib/ui/shared/type_ahead_publisher_field","feeds/lib/ui/publisher/global/paste_uploader","core/lib/util/clipboard","models/helpers/message","plupload"],function(a){var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/log"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_legacy_subviews"),g=a("core/lib/backbone_with_subviews"),h=a("models/recipient"),i=a("feeds/lib/ui/shared/type_ahead_publisher_field"),j=a("feeds/lib/ui/publisher/global/paste_uploader"),k=a("core/lib/util/clipboard"),l=a("models/helpers/message");a("plupload");var m=h.TYPE,n={placeholder:null};return e.extend({mixins:[f,g],defaults:{strings:n},className:"yj-global-body-editor",initialize:function(a){this._strings=a.strings,this._body=this.model.get("body"),this._createChildren(),this._setupListeners()},refresh:function(){return this._textarea.show(),this._textarea.refresh(),this._pasteUploader.refresh(),this._initBody(),this},enable:function(){return this._textarea.enableSelf(),this},disable:function(){return this._textarea.disableSelf(),this},clear:function(){return this.val(""),this},val:function(){return this._textarea.content.apply(this._textarea,arguments)},focus:function(){return this._textarea.focus(),this},blur:function(){return this._textarea.blur(),this},_createChildren:function(){this._textarea=new i({watermark:this._strings.placeholder,accessibilityLabel:this._strings.placeholder||c.t("message_body"),allowForeignUsers:!0}),this.add(this._textarea),this._pasteUploader=new j({collection:this.model.get("files"),networkId:l.getNetworkId(this.model)}),this.add(this._pasteUploader)},_setupListeners:function(){b.bindAll(this,"_onChange","_onMentionAdded","_onMentionRemoved","_onSubmit","_onPaste"),this.listenTo(this.model.get("recipients"),"add",this._emphasizeMention),this.listenTo(this.model.get("recipients"),"remove",this._deemphasizeMention),this._textarea.on("change",this._onChange),this._textarea.on("mentionAdded",this._onMentionAdded),this._textarea.on("mentionRemoved",this._onMentionRemoved),this._textarea.on("submit",this._onSubmit),this._textarea.on("paste",this._onPaste)},_initBody:function(){null!=this._body&&(this.val(this._body),this._body=null)},_updateModel:function(){this.model.set({body:this._textarea.val()})},_onChange:function(){this._updateModel()},_onMentionAdded:function(a,b){var c=this.model.get("recipients"),e=yam.backbone.model.Recipient.fromOriginalModel(b);return e?(e.set({mention:!0}),void c.add(e)):void d.warn("BodyEditor: could not add recipient")},_onMentionRemoved:function(a,b){var c=this.model.get("recipients"),e=yam.backbone.model.Recipient.fromOriginalModel(b);if(!e)return void d.warn("BodyEditor: could not remove recipient");var f=c.findWhere({id:e.id,fixed:!1});c.remove(f)},_onSubmit:function(){this._updateModel(),this.trigger("submit")},_onPaste:function(a){var b=k.getFileFromPaste(a);this._pasteUploader.addFile(b),this._pasteUploader.start()},_emphasizeMention:function(a){a.getType()===m.USER&&this._textarea.toggleEmphasisForMention(!0,a.getId())},_deemphasizeMention:function(a){a.getType()===m.USER&&this._textarea.toggleEmphasisForMention(!1,a.getId())},_clearTextarea:function(){this._textarea.content("")}})}),define("stache!feeds/lib/ui/publisher/global/recipient_list_item",["mustache"],function(a){var b='{{#icon}}\n  <span class="item-icon yamicon yamicon-{{icon}}" aria-hidden="true"></span>\n{{/icon}}\n<span class="item-type yj-acc-hidden">{{typeLabel}}:</span>\n<span class="item-name"><span class="yj-recipient-name">{{name}}<NetworkLabel /></span></span>\n<button class="item-remove unstyle-button-as-span" data-speechtip="{{removeLabelShort}}">\n  <span class="yamicon yamicon-x"></span>\n  <span class="yj-acc-hidden">{{removeLabel}}: {{name}}</span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/recipient_list_item",[],function(){}),define("feeds/lib/ui/publisher/global/recipient_list_item",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_subviews","components/network_label/index","core/lib/tr","models/recipient","html!./recipient_list_item","css!./recipient_list_item"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("components/network_label/index"),f=a("core/lib/tr"),g=a("models/recipient"),h=a("html!./recipient_list_item");a("css!./recipient_list_item");var i=g.TYPE,j=b.object([[i.PUBLIC_GROUP,[[{external:!0},"network"],[{},"group-alt"]]],[i.PRIVATE_GROUP,[[{external:!0},"network"],[{},"lock-MSFT"]]],[i.DOMAIN,[[{external:!0},"asterisk"],[{foreign:!0},"asterisk"]]],[i.USER,[[{external:!0},"asterisk"],[{mention:!0},"asterisk"],[{},null]]]]);return c.extend({mixins:[d],defaults:function(){var a=b.object([[i.PUBLIC_GROUP,[[{external:!0},f.t("public_external_group")],[{},f.t("public_group_2")]]],[i.PRIVATE_GROUP,[[{external:!0},f.t("private_external_group")],[{},f.t("private_group_2")]]],[i.DOMAIN,[[{external:!0},f.t("external_user")],[{foreign:!0},f.t("external_user")]]],[i.USER,[[{external:!0},f.t("external_user")],[{mention:!0},f.t("mentioned_user")],[{},"User"]]]]),c=b.object([[i.PUBLIC_GROUP,[[{external:!0},f.t("remove_public_external_group")],[{},f.t("remove_public_group")]]],[i.PRIVATE_GROUP,[[{external:!0},f.t("remove_private_external_group")],[{},f.t("remove_private_group")]]],[i.DOMAIN,[[{external:!0},f.t("remove_external_user")],[{foreign:!0},f.t("remove_external_user")]]],[i.USER,[[{external:!0},f.t("remove_external_user")],[{mention:!0},f.t("remove_mentioned_user")],[{},f.t("remove_user_2")]]]]),d={type:a,remove:c,removeShort:f.t("remove")};return{icons:j,strings:d}},views:{NetworkLabel:"_getNetworkLabel"},events:{"click .item-remove":"_onClickRemove"},tagName:"li",className:"yj-global-tag-list-item yj-global-recipient-list-item",template:h,initialize:function(a){this._icons=a.icons,this._strings=a.strings,this._setupListeners()},getTemplateData:function(){return b.extend(this.model.toJSON(),{icon:this._getValue(this._icons),typeLabel:this._getValue(this._strings.type),removeLabel:this._getValue(this._strings.remove),removeLabelShort:this._strings.removeShort})},render:function(){var a=this.getTemplateData();return this.$el.html(this.template(a)),this.$el.attr("data-type",a.type),this.$el.attr("data-implicit",!!a.implicit),this.$el.attr("data-external",!!a.external),this.$el.attr("data-fixed",!!a.fixed),this.$el.attr("data-mention",!!a.mention),this.$el.attr("data-hasicon",!!a.icon),this.$el.attr("data-failed",this.model.hasFailed()),this.model.isForeign()&&this.$el.attr("title",this.model.getNetworkName()),this.$removeButton=this.$(".item-remove"),this},enable:function(){return this.$removeButton&&this.$removeButton.prop("disabled",!1),this},disable:function(){return this.$removeButton&&this.$removeButton.prop("disabled",!0),this},_setupListeners:function(){this.listenTo(this.model,"change",this.render)},_getValue:function(a){var c=this.model.getType(),d=a[c];return b.isArray(d)&&(d=b.reduce(d,function(a,c){if(null!=a)return a;var d=b.every(c[0],function(a,b){return this.model.get(b)===a},this);return d?c[1]:void 0},null,this)),d},_getNetworkLabel:function(){return new e({model:this.model})},_onClickRemove:function(){this.remove(),this.model.collection.remove(this.model)}})}),define("feeds/lib/ui/publisher/global/recipient_list",["require","underscore","backbone","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/recipient_list_item"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("feeds/lib/ui/publisher/global/recipient_list_item");return d.extend({mixins:[e,f],tagName:"ol",className:"yj-global-tag-list yj-global-recipient-list",initialize:function(a){this._filter=a.filter||this.collection.toArray,this._createChildren(),this._setupListeners()},enable:function(){return b.invoke(this.children(),"enable"),this},disable:function(){return b.invoke(this.children(),"disable"),this},_createChildren:function(){var a=this._filter.call(this.collection);b.each(a,function(a){this.add(new g({model:a}))},this)},_setupListeners:function(){this.listenTo(this.collection,"add remove reset sort",this._recreateChildren)},_recreateChildren:function(){this.empty(),this._createChildren(),this.render(),c.trigger("/ui/lightbox/resize")}})}),define("stache!feeds/lib/ui/publisher/global/recipient_list_with_more",["mustache"],function(a){var b='<button class="list-more unstyle-button-as-span">{{moreLabel}}</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/recipient_list_with_more",["require","underscore","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/recipient_list","html!./recipient_list_with_more"],function(a){var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_legacy_subviews"),g=a("core/lib/backbone_with_subviews"),h=a("feeds/lib/ui/publisher/global/recipient_list"),i=a("html!./recipient_list_with_more");
return d.extend({mixins:[e,f,g],defaults:{maxResults:5},events:{click:"_onClick"},className:"yj-global-tag-list-with-more yj-global-recipient-list-with-more",template:i,initialize:function(a){this._maxResults=a.maxResults,this._createChildren(),this._setupListeners()},getTemplateData:function(){var a=Math.max(0,this.collection.size()-this._maxResults);return{moreLabel:c.t("and_count_more",{count:a})}},enable:function(){return this._list.enable(),this},disable:function(){return this._list.disable(),this},_createChildren:function(){var a=function(a){return this.first(a)};this._list=new h({collection:this.collection,filter:b.partial(a,this._maxResults)}),this.prepend(this._list)},_setupListeners:function(){this.listenTo(this.collection,"add remove reset",this.render)},_onClick:function(){this.trigger("more")}})}),define("stache!feeds/lib/ui/publisher/global/recipient_input",["mustache"],function(a){var b='<label>\n  <span class="input-label yj-acc-hidden"></span>\n    <input aria-haspopup="true" aria-autocomplete="list" />\n</label>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/recipient_input",["require","underscore","core/lib/backbone_base_view","core/lib/tr","core/lib/log","core/lib/session","models/recipient","models/message_backbone","core/lib/util/email_extractor","common-ui/lib/ui/shared/type_ahead","common-ui/lib/helper/ui","core/lib/string_helper","html!./recipient_input","jquery-watermark"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/tr"),e=a("core/lib/log"),f=a("core/lib/session"),g=a("models/recipient"),h=a("models/message_backbone"),i=a("core/lib/util/email_extractor"),j=a("common-ui/lib/ui/shared/type_ahead"),k=a("common-ui/lib/helper/ui"),l=a("core/lib/string_helper"),m=a("html!./recipient_input");a("jquery-watermark");var n=g.TYPE,o=h.TYPE,p=new i,q=j,r={maxResults:6,hintMessage:null,accessFilter:"post",includeAllCompany:!0,selectFirst:!1,selectOnType:!0,groupsFirst:!0,inline:!0,allowWide:!1,width:260,showTopRankingsOnce:!0,cacheEmails:!0,allowForeignUsers:!1,allowForeignEmails:!1},s=[j.MODEL_DOMAIN,j.MODEL_USER,j.MODEL_PENDINGUSER,j.MODEL_GROUP],t=function(){return!0},u=function(a){return function(c,d){return b.reduce(a,function(a,b){return a&&b(c,d)},!0)}};return c.extend({defaults:function(){var a=b.object([[o.EMPTY,d.t("add_a_group_andor_people")],[o.ALL_COMPANY,d.t("add_people_to_notify")],[o.ALL_COMPANY_WITH_EXTERNAL,d.t("add_people_to_notify")],[o.PUBLIC_GROUP,d.t("add_people_to_notify")],[o.PUBLIC_GROUP_WITH_EXTERNAL,d.t("add_people_to_notify")],[o.PRIVATE_GROUP,d.t("add_people_to_notify")],[o.PRIVATE_GROUP_WITH_EXTERNAL,d.t("add_people_to_notify")],[o.PRIVATE_MESSAGE,d.t("add_a_group_andor_people_to_notify")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("add_a_group_andor_people_to_notify")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("add_a_group_andor_people_to_notify")]]),c={placeholders:a},e=d.t("you_can_only_add_one_group");return{strings:c,allowExternalEmails:!0,extractor:p,typeahead:q,typeaheadNotice:e,typeaheadOptions:r,typeaheadModels:s,typeaheadFilter:t}},events:{"keydown input":"_onKeydown"},className:"yj-global-tag-input yj-global-recipient-input",template:m,initialize:function(a){b.bindAll(this,"_getTypeaheadPosition","_filterTypeaheadResults","_noticeForTypeaheadResults","_onSelectTypeahead"),this._strings=a.strings,this._extractor=a.extractor,this._typeahead=a.typeahead,this._typeaheadNotice=a.typeaheadNotice,this._typeaheadOptions=a.typeaheadOptions,this._typeaheadModels=a.typeaheadModels,this._typeaheadFilter=a.typeaheadFilter,this._allowExternalEmails=a.allowExternalEmails,this._optimizeForGroupSelection=a.optimizeForGroupSelection,this._setupListeners()},render:function(){return this._destroyTypeahead(),this.$el.html(this.template()),this.$input=this.$("input"),this.$label=this.$(".input-label"),this.updatePlaceholder(),this._registerTypeahead(),this},remove:function(){return this._destroyTypeahead(),c.prototype.remove.call(this)},enable:function(){return this.$input&&this.$input.prop("disabled",!1),this},disable:function(){return this.$input&&this.$input.prop("disabled",!0),this},clear:function(){return this.val(""),this},val:function(){return this.$input?this.$input.val.apply(this.$input,arguments):""},focus:function(){this.$input&&this.$input.focus();var a=b.map(this._typeahead.children,function(a){return{id:a.model.id,type:a.model.type,full_name:a.model.full_name}});return this._notifyParent("focus.embed_no_default_group",a),this},blur:function(){return this.$input&&this.$input.blur(),this},updatePlaceholder:function(a){if(null!=this.$input){a&&(this._strings.placeholders=a);var b=this.collection.getType(),c=this.collection.length;a=a||this._strings.placeholders;var d=a[b],e=0===c?"100%":k.getTextWidth(d);this.$input.watermark(d),this.$input.css({width:e}),this.$label.text(d)}},_setupListeners:function(){this.listenTo(this.collection,"add remove reset",this._onChangeCollection),this.listenTo(this.collection,"remove",this._onEmptyRecipientList)},_registerTypeahead:function(){var a=u([this._filterTypeaheadResults,this._typeaheadFilter]),c=b.extend({completableModels:this._typeaheadModels,getPosition:this._getTypeaheadPosition,filter:a,notice:this._noticeForTypeaheadResults,onSelect:this._onSelectTypeahead,optimizeForGroupSelection:this._optimizeForGroupSelection},this._typeaheadOptions);b.extend(c,{allowForeignUsers:!0,allowForeignEmails:this._allowExternalEmails}),this._typeahead.registerField(this.$input,c)},_destroyTypeahead:function(){this.$input&&this._typeahead.removeField(this.$input)},_getTypeaheadPosition:function(){var a=this.$input.position(),b=this.$input.outerHeight(),c=this.$el.offsetParent().width(),d=this._typeahead.$el.width();return{left:Math.min(a.left+d,c)-d,top:a.top+b+1}},_filterTypeaheadResults:function(a,b){switch(a){case this._typeahead.MODEL_USER:return null==this.collection.findWhere({realId:isNaN(b.id)?b.id:parseInt(b.id,10),type:n.USER});case this._typeahead.MODEL_GROUP:return null==this.collection.findWhereContains({realId:isNaN(b.id)?b.id:parseInt(b.id,10),type:[n.PUBLIC_GROUP,n.PRIVATE_GROUP]});default:return!0}},_noticeForTypeaheadResults:function(a){switch(a){case this._typeahead.MODEL_GROUP:var b=this.collection.findWhereContains({type:[n.PUBLIC_GROUP,n.PRIVATE_GROUP]});if(null!=b)return this._typeaheadNotice}},_onSelectTypeahead:function(a){var b=g.fromOriginalModel(a);return b?void this._addRecipient(b):void e.warn("RecipientInput: could not create recipient")},_onKeydown:function(a){switch(a.which){case 8:this._onDeleteKeydown(a);break;case 13:this._onEnterKeydown(a)}},_onDeleteKeydown:function(a){0===this.val().length&&this.collection.length>0&&(a.preventDefault(),a.stopPropagation(),this._removeLastRecipient())},_onEnterKeydown:function(a){var b=f.getCurrentUser(),c=b&&b.web_preferences,d=c?!l.convertStringyBoolean(c.enter_does_not_submit_message):!1;(d&&!a.shiftKey||!d&&a.shiftKey)&&(a.preventDefault(),this.trigger("submit"))},_isLocalDomain:function(a){return b.some(this._typeahead.getDomains(),function(b){return b.name==a})},_recipientFromEmail:function(a){var b={id:a,domain:i.getDomainFromEmail(a),name:a,type:n.DOMAIN};return this._isLocalDomain(b.domain)||(b.foreign=!0),b},_addRecipient:function(a){this.collection.add(a),this.blur(),this.focus()},_removeLastRecipient:function(){var a=this.collection.where({fixed:!1}).pop();this.collection.remove(a),this.blur(),this.focus()},_onChangeCollection:function(){this.updatePlaceholder()},_onEmptyRecipientList:function(a,b){0===b.length&&this._typeahead.constructSettings()},_notifyParent:function(){this.trigger.apply(this,arguments)}})}),define("core/lib/backbone_with_show_hide",[],function(){"use strict";var a=function(){return this.$el.show.apply(this.$el,arguments),this.trigger("show")},b=function(){return this.$el.hide.apply(this.$el,arguments),this.trigger("hide")},c=function(){return this.$el.toggle.apply(this.$el,arguments),this.trigger(this.isVisible()?"show":"hide")},d=function(){return this.$el.is(":visible")},e=function(){this.show=a,this.hide=b,this.toggle=c,this.isVisible=d};return e}),define("feeds/lib/ui/publisher/global/recipient_change_announcer",["require","core/lib/tr","models/recipient","common-ui/lib/ui/accessibility/screenreader_announcer","core/lib/backbone_base_view","core/lib/backbone_with_show_hide"],function(a){var b=a("core/lib/tr"),c=a("models/recipient"),d=a("common-ui/lib/ui/accessibility/screenreader_announcer"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_show_hide"),g=c.TYPE;return e.extend({mixins:[f],initialize:function(){this._enabled=!0,this.listenTo(this.collection,"add",this._onRecipientAdded),this.listenTo(this.collection,"remove",this._onRecipientRemoved),this.hide()},enable:function(){return this._enabled=!0,this},disable:function(){return this._enabled=!1,this},_getAddMessage:function(a,c){var d;switch(a){case g.PUBLIC_GROUP:d=b.t("added_group_name",{name:c});break;case g.PRIVATE_GROUP:d=b.t("added_private_group_name",{name:c});break;case g.USER:d=b.t("added_user_name",{name:c});break;default:d=b.t("added_name",{name:c})}return d},_getRemoveMessage:function(a,c){var d;switch(a){case g.PUBLIC_GROUP:d=b.t("removed_group_name",{name:c});break;case g.PRIVATE_GROUP:d=b.t("removed_private_group_name",{name:c});break;case g.USER:d=b.t("removed_user_name",{name:c});break;default:d=b.t("removed_name",{name:c})}return d},_onRecipientAdded:function(a){this._enabled&&d.announceText(this._getAddMessage(a.getType(),a.get("name")),"assertive")},_onRecipientRemoved:function(a){this._enabled&&d.announceText(this._getRemoveMessage(a.getType(),a.get("name")),"assertive")}})}),define("feeds/lib/ui/publisher/global/recipient_change_reporter",["require","core/lib/report","models/recipient","core/lib/backbone_base_view","core/lib/backbone_with_show_hide"],function(a){var b=a("core/lib/report"),c=a("models/recipient"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_show_hide"),f=c.TYPE;return d.extend({mixins:[e],initialize:function(){this._enabled=!0,this.listenTo(this.collection,"add",this._onRecipientAdded),this.listenTo(this.collection,"remove",this._onRecipientRemoved),this.hide()},enable:function(){return this._enabled=!0,this},disable:function(){return this._enabled=!1,this},_onRecipientAdded:function(a){if(this._enabled){var c=a.getType();c!==f.PUBLIC_GROUP&&c!==f.PRIVATE_GROUP||b.event("group_added",{all_company:"COMPANY_GROUP_ID"===a.getId()})}},_onRecipientRemoved:function(a){if(this._enabled){var c=a.getType();c!==f.PUBLIC_GROUP&&c!==f.PRIVATE_GROUP||b.event("group_removed",{all_company:"COMPANY_GROUP_ID"===a.getId()})}}})}),define("feeds/lib/ui/publisher/global/recipient_selector",["require","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/recipient_list","feeds/lib/ui/publisher/global/recipient_input","feeds/lib/ui/publisher/global/recipient_change_announcer","feeds/lib/ui/publisher/global/recipient_change_reporter"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_legacy_subviews"),d=a("core/lib/backbone_with_subviews"),e=a("feeds/lib/ui/publisher/global/recipient_list"),f=a("feeds/lib/ui/publisher/global/recipient_input"),g=a("feeds/lib/ui/publisher/global/recipient_change_announcer"),h=a("feeds/lib/ui/publisher/global/recipient_change_reporter");return b.extend({mixins:[c,d],events:{click:"_onClick"},className:"yj-global-tag-selector yj-global-recipient-selector",initialize:function(a){this._strings=a.strings,this._allowExternalEmails=a.allowExternalEmails,this._typeaheadOptions=a.typeaheadOptions,this._typeaheadModels=a.typeaheadModels,this._typeaheadFilter=a.typeaheadFilter,this._message=a.message,this._optimizeForGroupSelection=a.optimizeForGroupSelection,this._createChildren(),this._setupListeners()},enable:function(){return this._list.enable(),this._input.enable(),this._announcer.enable(),this._reporter.enable(),this},disable:function(){return this._list.disable(),this._input.disable(),this._announcer.disable(),this._reporter.disable(),this},clear:function(){return this.val(""),this},val:function(){return this._input.val.apply(this._input,arguments)},focus:function(){return this._input.focus(),this},blur:function(){return this._input.blur(),this},_createChildren:function(){this._list=new e({collection:this.collection}),this.add(this._list),this._input=new f({message:this._message,collection:this.collection,strings:this._strings,allowExternalEmails:this._allowExternalEmails,typeaheadOptions:this._typeaheadOptions,typeaheadModels:this._typeaheadModels,optimizeForGroupSelection:this._optimizeForGroupSelection,typeaheadFilter:this._typeaheadFilter}),this.add(this._input),this._announcer=new g({collection:this.collection}),this.add(this._announcer),this._reporter=new h({collection:this.collection}),this.add(this._reporter)},_setupListeners:function(){this.listenTo(this._input,"submit",this._notifyParent.bind(this,"submit")),this.listenTo(this._input,"focus.embed_no_default_group",this._notifyParent.bind(this,"focus.embed_no_default_group"))},_notifyParent:function(){this.trigger.apply(this,arguments)},_onClick:function(){this.focus()}})}),define("feeds/lib/ui/publisher/global/recipient_selector_with_more",["require","jquery","underscore","backbone","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/recipient_list_with_more","feeds/lib/ui/publisher/global/recipient_selector"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_legacy_subviews"),g=a("core/lib/backbone_with_subviews"),h=a("feeds/lib/ui/publisher/global/recipient_list_with_more"),i=a("feeds/lib/ui/publisher/global/recipient_selector");return e.extend({mixins:[f,g],defaults:{maxResults:5},events:{click:"_onClick","blur input":"_onBlur"},className:"yj-global-tag-selector-with-more yj-global-recipient-selector-with-more",initialize:function(a){this._strings=a.strings,this._maxResults=a.maxResults,this._allowExternalEmails=a.allowExternalEmails,this._typeaheadOptions=a.typeaheadOptions,this._typeaheadModels=a.typeaheadModels,this._typeaheadFilter=a.typeaheadFilter,this._message=a.message,this._optimizeForGroupSelection=a.optimizeForGroupSelection,this._createChildren(a),this._setupListeners()},remove:function(){return this._removeListeners(),e.prototype.remove.call(this)},render:function(){return this.expand(),this},expand:function(){return this.swap(!0),this},collapse:function(){return this.swap(!1),this},swap:function(a){return this.$el.toggleClass("yj-open",a),this.trigger(a?"open":"close"),d.trigger("/ui/lightbox/resize"),this},swapWhenAppropriate:function(a){if(this.isFocused())return this;var b=0===this.val().length,c=this.collection.size()>this._maxResults;return this.swap(a||!(b&&c)),this},isExpanded:function(){return this.$el.hasClass("yj-open")},enable:function(){return this._selector.enable(),this._list.enable(),this},disable:function(){return this._selector.disable(),this._list.disable(),this},clear:function(){return this._selector.clear(),this},val:function(){return this._selector.val.apply(this._selector,arguments)},focus:function(){return this._selector.focus(),this},blur:function(){return this._selector.blur(),this},isFocused:function(){return this.$el.has(window.document.activeElement).length>0},updatePlaceholder:function(a){return this._selector.updatePlaceholder(a)},_createChildren:function(){this._selector=new i({message:this._message,collection:this.collection,strings:this._strings,allowExternalEmails:this._allowExternalEmails,typeaheadOptions:this._typeaheadOptions,typeaheadModels:this._typeaheadModels,typeaheadFilter:this._typeaheadFilter,optimizeForGroupSelection:this._optimizeForGroupSelection}),this.add(this._selector),this._selector.on("blur",this._onBlur,this),this._list=new h({collection:this.collection,maxResults:this._maxResults}),this.add(this._list),this._list.on("more",this._onClick,this)},_setupListeners:function(){c.bindAll(this,"swapWhenAppropriate","_onBlur"),this.listenTo(this.collection,"add remove reset",this._onChangeCollection),this.listenTo(this._selector,"submit",this._notifyParent.bind(this,"submit")),b(window).on("click",this._onBlur),this.listenTo(this.collection,"add",this._notifyParent.bind(this,"add.embed_no_default_group")),this.listenTo(this.collection,"remove",this._notifyParent.bind(this,"remove.embed_no_default_group")),this.listenTo(this._selector,"focus.embed_no_default_group",c.debounce(this._notifyParent.bind(this,"focus.embed_no_default_group"),1e3,!0))},_removeListeners:function(){b(window).off("click",this._onBlur)},_notifyParent:function(){this.trigger.apply(this,arguments)},_onClick:function(){this.expand(),this.focus()},_onBlur:function(a){b.contains(window.document,a.target)&&!b.contains(this.el,a.target)&&c.defer(this.swapWhenAppropriate)},_onChangeCollection:function(){this.swapWhenAppropriate()}})}),define("feeds/lib/ui/publisher/global/publisher_errors",["require","underscore","core/lib/backbone_base_class","core/lib/tr"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_class"),d=a("core/lib/tr"),e=d.t("sorry_were_still_working_please_give_us_just_a_moment"),f=d.t("your_message_has_not_been_posted_and_your_draft_will"),g=d.t("youve_been_logged_out_of_yammer_somewhere_else_please_refresh"),h=d.t("there_was_an_error_posting_your_message"),i=d.t("please_include_a_message"),j=d.t("this_group_has_been_deleted_you_cannot_post_to_it"),k=d.t("looks_like_you_entered_an_incomplete_email_address"),l=d.t("you_are_trying_to_reply_to_a_message_that_has_been_deleted_please_refresh_and_try_again"),m=d.t("sorry_you_are_not_able_to_post_to_this_group"),n=d.t("you_do_not_have_permission_to_make_an_announcement_in_this_group"),o=d.t("you_are_trying_to_post_to_someone_that_is_not_in_your_network"),p=d.t("looks_like_youre_trying_to_include_a_colleagues_personal_email_address"),q=d.t("publisher_error_flexternal_disabled_in_home_network"),r=d.t("publisher_error_flexternal_disabled_in_recipients_network"),s=d.t("publisher_error_flexternal_disabled_in_home_network_read_only"),t=d.t("read_only_warning"),u={group_deleted:j,invalid_email_address:k,body_blank:i,message_deleted:l,no_access_to_group:m,no_permission_to_announce:n,recipient_outside_of_network:o,recipient_not_invitable:p,unknown_error:h,adding_foreign_user_blocked_in_posters_network_error:q,adding_foreign_user_blocked_in_recepients_network_error:r,reply_to_flexternal_thread_blocked_in_posters_network_error:s,reply_to_flexternal_thread_blocked_in_receivers_network_error:t},v=["adding_foreign_user_blocked_in_posters_network_error","adding_foreign_user_blocked_in_recepients_network_error","reply_to_flexternal_thread_blocked_in_posters_network_error","reply_to_flexternal_thread_blocked_in_receivers_network_error"],w=c.extend({showInFlightWarning:function(){window.alert(e)},showUnsavedWarningDialog:function(){return window.confirm(f)},isGenericPostingError:function(a){return a===h},isRecipientError:function(a){return b.contains(v,a)},parseErrorMessage:function(a){return 401===a.status?this._constructError(g):(this._response=a.responseText,this._responseJustWhitespace()?this._constructError(h):this._errorFromResponse())},_responseJustWhitespace:function(){return!/\S/.test(this._response)},_responseTooLong:function(){return this._response&&this._response.length>300},_errorFromResponse:function(){try{return this._parseErrorFromResponse()}catch(a){return this._constructError(h)}},_parseErrorFromResponse:function(){var a=JSON.parse(this._response),b=this._messageForCode(a.code);return null!==b?this._constructError(b,a):this._constructError(h,a)},_constructError:function(a,c){var d={message:a};return c&&b.extend(d,b.pick(c,"code","data")),d},_messageForCode:function(a){return null==a?null:b.has(u,a)?u[a]:null}});return new w}),define("feeds/lib/ui/publisher/global/message_poster_reporter",["require","underscore","core/lib/report"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/report");return{createSuccessCallthrough:function(a,c){return b.wrap(c,function(b,c){b(c),this._checkResponseData(a,c)}.bind(this))},_checkResponseData:function(a,b){if(b.hasOwnProperty("getMessages")){var d=b.getMessages();if(1!==d.length)return void c.info({message:"Incorrect message count",count:d.length});var e=d[0],f=a.attached_objects?a.attached_objects.length:0,g=e.attachments?e.attachments.length:0;f!==g&&c.info({message:"Missing attachments",message_id:e.id,missing_attachments:a.attached_objects})}}}}),define("feeds/lib/ui/publisher/global/message_poster",["require","underscore","core/lib/backbone_base_class","core/lib/yammer_api","models/recipient","models/message_backbone","models/message","feeds/lib/ui/publisher/global/publisher_errors","models/lib/helper/feed_factory","models/lib/orm-models","backbone","feeds/lib/ui/publisher/global/message_poster_reporter"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_class"),d=a("core/lib/yammer_api"),e=a("models/recipient"),f=a("models/message_backbone"),g=a("models/message"),h=a("feeds/lib/ui/publisher/global/publisher_errors"),i=a("models/lib/helper/feed_factory"),j=a("models/lib/orm-models"),k=a("backbone"),l=a("feeds/lib/ui/publisher/global/message_poster_reporter"),m=j.Feed(),n=e.TYPE,o=f.TYPE,p=f.SHARE_MODE;return c.extend({initialize:function(a){this._logType=a.logType,this._logSource=a.logSource},post:function(a,b,c){return this._postMessage(a,b,c),this},_postMessage:function(a,c,e){if(!a.isValid())throw new Error("Message is not valid");var f=a.get("sharing"),g=this._createData(a,f),i=this._getFeed(a);if(null==i)throw new Error("Feed could not be found");c=b.wrap(c,function(c,e){var f=a.get("thread");if(null!=f){var g=f.get("id");d.getThreadInfo({thread_id:g}).then(function(a){k.trigger("threadinfo-updated",a)})}if(b.isFunction(c)){var h=b.isFunction(e.getRaw)?e.getRaw():e;c({status:"success",response:h})}}),e=b.wrap(e,function(a,c){if(b.isFunction(a)){var d=h.parseErrorMessage(c);a({status:"error",error:d})}});var j=l.createSuccessCallthrough(g,c);f?d.postMessage(j,e,g):i.postMessage(g).then(j,e)},_createData:function(a,c){var d=a.getType(),e=a.get("files"),f=a.get("ogos"),g=b.contains([o.PRIVATE_MESSAGE,o.PRIVATE_MESSAGE_WITH_EXTERNAL,o.PRIVATE_MESSAGE_WITH_MENTIONS],d),h={body:a.get("body"),log_data:{publisher_type:this._logType,publisher_source:this._logSource}};return this._extendWithXmess(h),this._extendWithFiles(h,a,c),this._extendWithOgos(h,a,c),this._extendWithRecipients(h,a),this._extendWithGroup(h,a),this._extendWithReply(h,a),this._extendWithPoll(h,a),this._extendWithPraise(h,a),this._extendWithEvent(h,a),this._extendWithAnnouncement(h,a),this._extendWithTopics(h,a),g&&e.size()+f.size()>0&&b.extend(h,{auto_follow_attachments:!0}),h},_extendWithXmess:function(a){b.extend(a,{invited_user_ids:"",skip_body_notifications:!0})},_extendWithFiles:function(a,c,d){var e=c.get("files"),f=e.map(function(a){var b=a.getId(),c=a.getType();if(null==b||null==c)throw new Error("File is not valid");return d&&"attachment"===c&&(c="uploaded_file"),c+":"+b});f.length&&(d===p.FILE&&(a["attached_objects[]"]=b.first(f),f=b.rest(f)),f.length&&b.extend(a,{attached_objects:f}))},_extendWithOgos:function(a,c,d){var e=c.get("ogos"),f=e.first();if(null!=f){var g=f.get("url"),h=f.get("name"),i=f.get("sharedMessageId");if(null!=i)i+="",this._markSharedMessageAsRead(i),b.extend(a,{shared_message_id:i});else if(d===p.LINK)a["attached_objects[]"]="open_graph_object:"+f.getId();else{if(null==h||null==g)throw new Error("OGO is not valid");a=b.chain(f.attributes).omit("id","progress","realId","name","thumbnail").reduce(function(a,b,c){return a["og_"+c]=b,a},a||{}).value(),b.extend(a,{og_title:h,og_image:f.get("thumbnail")})}}},_markSharedMessageAsRead:function(a){var b=g.findById(a),c=b&&b.getThread();null!=c&&c.markAsRead()},_extendWithRecipients:function(a,c){var d=c.get("recipients");a&&a.log_data&&b.extend(a.log_data,{number_of_recipients:d.size()});var e=b.contains([o.PRIVATE_MESSAGE,o.PRIVATE_MESSAGE_WITH_EXTERNAL,o.PRIVATE_MESSAGE_WITH_MENTIONS],c.getType()),f=!c.get("body")&&!c.get("files").size()&&!c.get("ogos").size(),g=c.getGroup(),h=function(a){return!g||!b.contains(a.get("groupIds"),g.get("id"))},i=d.where({type:n.USER}),j=d.where({type:n.USER,external:!0});j=b.filter(j,h);var k=d.where({type:n.DOMAIN}),l=b.map(i,function(a){return a.getId()}),m=b.map(i,function(a){return"@"+a.get("permalink")}),p=b.map(l,function(a){return"[[user:"+a+"]]"}),q=b.map(j,function(a){return a.getId()}),r=b.map(k,function(a){return a.getId()}),s=r;e?(b.extend(a,{direct_to_user_ids:b.union(l,r).join(",")}),c.isReply()&&f&&b.extend(a,{body:m.join(", ")})):q.length&&b.extend(a,{invited_user_ids:q.join(",")}),p.length+s.length>0&&b.extend(a,{cc:b.union(p,s).join(",")})},_extendWithGroup:function(a,c){var d=c.findRecipient({type:[n.PUBLIC_GROUP,n.PRIVATE_GROUP]}),e=null!=d?d.getId():null;null!=e&&"COMPANY_GROUP_ID"!=e&&b.extend(a,{group_id:e})},_extendWithReply:function(a,c){var d=c.get("original");if(d){var e=d.get("id");null!=e&&b.extend(a,{replied_to_id:e})}},_extendWithPoll:function(a,c){var d=c.get("poll");null!=d&&d.isEnabled()&&b.extend(a,d.toModuleHash())},_extendWithPraise:function(a,c){var d=c.get("praise");null!=d&&d.isEnabled()&&b.extend(a,d.toModuleHash())},_extendWithEvent:function(a,c){var d=c.get("event");null!=d&&d.isEnabled()&&b.extend(a,d.toModuleHash())},_extendWithAnnouncement:function(a,c){var d=c.get("announcement");null!=d&&d.isEnabled()&&b.extend(a,d.toModuleHash())},_extendWithTopics:function(a,b){var c=b.get("topics");c.each(function(b,c){a["topic"+(c+1)]=b.get("name")})},_getFeed:function(a){var b=a.getType(),c=a.get("feed");if(null!=c)return this._getFeedModel(c);switch(b){case o.ALL_COMPANY:case o.ALL_COMPANY_WITH_EXTERNAL:return this._getAllCompanyFeedModel(a);case o.PRIVATE_MESSAGE:case o.PRIVATE_MESSAGE_WITH_EXTERNAL:case o.PRIVATE_MESSAGE_WITH_MENTIONS:return this._getInboxFeedModel(a);default:return this._getGroupFeedModel(a)}},_getFeedModel:function(a){return m.findById(a.getId())},_getAllCompanyFeedModel:function(){return i.findOrCreate("general")},_getInboxFeedModel:function(){return i.findOrCreate("inboxUnread")},_getGroupFeedModel:function(a){var b=a.getGroup();if(null!=b)return i.findOrCreate("group",b.get("id"))}})}),define("stache!feeds/lib/ui/publisher/global/file_upload_button",["mustache"],function(a){var b='<button class="unstyle-button-as-span" {{#hideFromAccessibility}}tabindex="-1" aria-hidden="true"{{/hideFromAccessibility}}>\n  <span class="button-icon yamicon yamicon-{{icon}}"></span>\n  <span class="button-label">{{label}}</span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/file_upload_button",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","feeds/lib/ui/attachments/uploader","core/lib/file_upload_delegate","core/lib/report","core/lib/tr","html!./file_upload_button","common-ui/lib/helper/environment"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("feeds/lib/ui/attachments/uploader"),f=a("core/lib/file_upload_delegate"),g=a("core/lib/report"),h=a("core/lib/tr"),i=a("html!./file_upload_button"),j=a("common-ui/lib/helper/environment"),k=e,l={main:"upload"};return c.extend({mixins:[d],defaults:function(){var a={main:h.t("upload_a_file_from_your_computer_2")};return{uploader:k,icons:l,strings:a,hideFromAccessibility:!1}},events:{"click button":"_onClick"},className:"yj-global-file-upload-button",template:i,initialize:function(a){this._uploader=a.uploader,this._networkId=a.networkId,this._icons=a.icons,this._strings=a.strings,this._hideFromAccessibility=a.hideFromAccessibility},getTemplateData:function(){return{icon:this._icons.main,label:this._strings.main,hideFromAccessibility:this._hideFromAccessibility}},render:function(){return this.$button=this.$("button"),this},refresh:function(){return null!=this._uploaderInstance?this._uploaderInstance.refresh():this._createUploader(),this},remove:function(){return null!=this._uploaderInstance&&this._uploaderInstance.destroy(),c.prototype.remove.call(this)},enable:function(){return this.$button&&this.$button.prop("disabled",!1),this},disable:function(){return this.$button&&this.$button.prop("disabled",!0),this},setNetworkId:function(a){this._networkId=a,this._uploaderInstance&&this._uploaderInstance.setNetwork(a)},_createUploader:function(){var a=new f({collection:this.collection});a.handleFilesAdded=b.compose(a.handleFilesAdded,this._handleFilesAdded.bind(this)),this._uploaderInstance=new this._uploader({button:this.$button,container:this.$el,eventDelegate:a,networkId:this._networkId}),this._setupListeners()},_handleFilesAdded:function(a){return j.isIE()&&j.isIE().version<=10&&this.$el.trigger("click"),a},_setupListeners:function(){this.listenTo(this.collection,"remove",this._removeUploadFromUploader),this.listenTo(this.collection,"reset",this._resetUploader)},_resetUploader:function(){this._uploaderInstance&&this._uploaderInstance.reset&&this._uploaderInstance.reset()},_removeUploadFromUploader:function(a){var b=this._uploaderInstance.get(a.get("uploadId"));null!=b&&this._uploaderInstance.remove(b)},_onClick:function(){g.event("upload_file_clicked")}})}),define("core/lib/date_helper",["require","core/lib/tr"],function(a){var b=a("core/lib/tr"),c=function(a){return 10>a?"0"+a:a},d={DAYS:[b.t("sunday"),b.t("monday"),b.t("tuesday"),b.t("wednesday"),b.t("thursday"),b.t("friday"),b.t("saturday")],MONTHS:[b.t("january"),b.t("february"),b.t("march"),b.t("april"),b.t("may"),b.t("june"),b.t("july"),b.t("august"),b.t("september"),b.t("october"),b.t("november"),b.t("december")],SHORT_MONTHS:[b.t("jan"),b.t("feb"),b.t("mar"),b.t("apr"),b.t("may"),b.t("jun"),b.t("jul"),b.t("aug"),b.t("sep"),b.t("oct"),b.t("nov"),b.t("dec")],formatDate:function(a){return b.t("month_date_year",{month:d.MONTHS[a.getMonth()],date:a.getDate(),year:a.getFullYear()})},formatTime:function(a){return((a.getHours()>12?a.getHours()%12:a.getHours())||12)+":"+c(a.getMinutes())+(a.getHours()>=12?"pm":"am")},formatDateTime:function(a){return b.t("time_month_dayofmonth",{time:d.formatTime(a),month:d.MONTHS[a.getMonth()],dayOfMonth:a.getDate()})},formatYearDateTime:function(a){return b.t("time_month_dayofmonth_year",{time:d.formatTime(a),month:d.MONTHS[a.getMonth()],dayOfMonth:a.getDate(),year:a.getFullYear()})},formatDateTimeShortMonth:function(a){return b.t("time_shortmonth_dayofmonth",{time:d.formatTime(a),shortMonth:d.SHORT_MONTHS[a.getMonth()],dayOfMonth:a.getDate()})},formatMonthsAgo:function(a,c){parseInt(a,10)&&(a=new Date(parseInt(a,10))),c=c||new Date;var d=Math.floor(c.getTime()/1e3)-Math.floor(a.getTime()/1e3);return 50>d?b.t("count_seconds_ago",{count:10*Math.ceil(d/10)}):3600>d?b.t("count_minutes_ago",{count:Math.floor(d/60)}):86400>d?b.t("count_hours_ago",{count:Math.ceil(d/3600)}):172800>d?b.t("count_days_ago",{count:1}):1209600>d?b.t("count_days_ago",{count:Math.ceil(d/86400)}):2419200>d?b.t("count_weeks_ago",{count:Math.ceil(d/604800)}):31536e3>d?b.t("count_months_ago",{count:Math.round(d/2419200)}):47304e3>d?b.t("count_years_ago",{count:1}):b.t("count_years_ago",{count:Math.ceil(d/31536e3)})},formatAgo:function(a,c,e){parseInt(a,10)&&(a=new Date(parseInt(a,10))),c=c||new Date;var f=Math.floor(c.getTime()/1e3)-Math.floor(a.getTime()/1e3),g=a.getDate(),h=d.MONTHS[a.getMonth()],i=a.getFullYear(),j=d.formatTime(a);if(i<c.getFullYear()||f>=31536e3)return e?b.t("month_date_year",{month:h,date:g,year:i,time:j}):b.t("month_date_year_at_time",{month:h,date:g,year:i,time:j});if(0>=f)return b.t("second_ago");if(50>f){var k=10*Math.ceil(f/10);return b.t("seconds_seconds_ago",{seconds:k})}return 120>f?b.t("minute_ago"):3600>f?b.t("mins_minutes_ago",{
mins:Math.floor(f/60)}):3660>f?b.t("hour_ago"):86400>f?b.t("hours_hours_ago",{hours:Math.ceil(f/3600)}):259200>f?(g=d.DAYS[a.getDay()],e?b.t("day",{day:g}):b.t("day_at_time",{day:g,time:j})):31536e3>f?e?b.t("month_date",{month:h,date:g}):b.t("month_date_at_time",{month:h,date:g,time:j}):void 0},formatAgoForInboxPreviews:function(a){var c=new Date,e=Math.floor(c.getTime()/1e3)-Math.floor(a.getTime()/1e3),f=a.getDate(),g=d.SHORT_MONTHS[a.getMonth()],h=a.getFullYear();return h<c.getFullYear()?b.t("shortmonth_dayofmonth_year",{shortMonth:g,dayOfMonth:f,year:h}):0>=e?b.t("s"):10>e?b.t("secondss",{seconds:e}):55>e?b.t("secondss",{seconds:10*Math.round(e/10)}):3600>e?b.t("minutesm",{minutes:Math.floor(e/60)}):86400>e?b.t("hoursh",{hours:Math.ceil(e/3600)}):259200>e?b.t("daysd",{days:Math.ceil(e/86400)}):31536e3>e?b.t("shortmonth_dayofmonth",{shortMonth:g,dayOfMonth:f}):void 0},formatStringTime:function(a){var b=new Date(a).getTime();return!isNaN(b)&&b||void 0}};return d}),define("stache!common-ui/lib/ui/general/actions/action",["mustache"],function(a){var b='<a {{#url}}href="{{url}}"{{/url}}{{^url}}href="javascript://"{{/url}} title="{{title}}"\n{{#data_resource_model}} data-resource-model="{{data_resource_model}}" {{/data_resource_model}}\n{{#target}} target="{{target}}" {{/target}} role="button" class="yj-{{key}}"><span class="yamicon yamicon-regular yamicon-{{iconClass}}"></span>{{^altWord}}{{word}}{{/altWord}}{{#altWord}}<span aria-hidden="true">{{word}}</span><span class="yj-acc-hidden"> {{altWord}}</span>{{/altWord}}</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/general/actions/action",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./action"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=b.extend({mixins:[c],tagName:"li",template:a("html!./action"),initialize:function(a){this.word=a.word||this.word,this.altWord=a.altWord||this.altWord,this.type=a.type},getTemplateData:function(){return{url:this.url,title:this.title,data_resource_model:this.data_resource_model,target:this.target,key:this.key,iconClass:this.iconClass,word:this.word,altWord:this.altWord}}});return d}),define("common-ui/lib/ui/general/actions/file_action",["require","common-ui/lib/ui/general/actions/action"],function(a){var b=a("common-ui/lib/ui/general/actions/action"),c=b.extend({initialize:function(a){this.url_fn&&(this.url=this.url_fn.call(null,this.options.file)),this.iconClass=a.iconClass||this.icon||this.key,b.prototype.initialize.apply(this,arguments)}});return c}),define("common-ui/lib/ui/general/actions/attachment_detail",["require","common-ui/lib/ui/general/actions/file_action","core/lib/tr","core/lib/urls"],function(a){var b=a("common-ui/lib/ui/general/actions/file_action"),c=a("core/lib/tr"),d=a("core/lib/urls"),e=b.extend({className:"yj-detail",url_fn:d.fileIndex,key:"detail",icon:"goto",word:c.t("go_to_file"),title:c.t("view_file_page"),initialize:function(a){a.iconClass="rd_right_arrow",b.prototype.initialize.apply(this,arguments)}});return e}),define("common-ui/lib/ui/general/actions/download",["require","common-ui/lib/ui/general/actions/file_action","core/lib/tr","core/lib/urls"],function(a){var b=a("common-ui/lib/ui/general/actions/file_action"),c=a("core/lib/tr"),d=a("core/lib/urls"),e=b.extend({className:"yj-download",url_fn:d.fileDownload,key:"download",icon:"download",word:c.t("download"),altWord:c.t("download_this_file"),initialize:function(a){a.iconClass="rd_download",this.title=c.t("download_file")+" ("+this.formatSize(a.file.size)+")",b.prototype.initialize.apply(this,arguments)},formatSize:function(a){if(!a)return!1;var b=parseInt(a,10),c="";return c+=1e3>b?b+" bytes":1e6>a?(b/1e3).toFixed(2)+" kB":1e9>a?(b/1e6).toFixed(2)+" MB":(b/1e9).toFixed(2)+" GB",c.replace(" "," ")}});return e}),define("stache!common-ui/lib/ui/general/actions/follow_follow",["mustache"],function(a){var b='<span class="yj-show-follow"><span class="yamicon yamicon-plus"></span>{{text}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/general/actions/follow_unfollow",["mustache"],function(a){var b='<span class="yj-show-unfollow"><span class="yamicon yamicon-dash"></span>{{mouseoverText}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/general/actions/follow",["require","underscore","core/lib/backbone_base_view","common-ui/lib/ui/shared/follow_button","html!./follow_follow","html!./follow_unfollow"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("common-ui/lib/ui/shared/follow_button"),e=a("html!./follow_follow"),f=a("html!./follow_unfollow"),g=c.extend({tagName:"li",className:"yj-action-follow",initialize:function(a){function c(){this.type="uploaded_file",a.data&&b.extend(this,a.data)}this.type=a.type,this.data=a.data,this.file=a.file,c.prototype=this.file,this.fakeUploadedFile=new c},render:function(){return this.followButton=new d({model:this.fakeUploadedFile,tagName:"a",className:"yj-action-follow",attributes:{href:"javascript://",role:"button"},useButtonClassNames:!1,followTemplate:e,unfollowTemplate:f}),this.$el.html(this.followButton.render().$el),this},remove:function(){return this.followButton&&(this.followButton.remove(),this.followButton=null),c.prototype.remove.call(this)}});return g}),define("stache!common-ui/lib/ui/general/hover_bar",["mustache"],function(a){var b='<div class="yj-hover-bar--container yj-actions">\n  {{#more_menu}}\n    <div class="yj-hover-bar-more-menu">\n      <a href="javascript://" class="yj-click-menu-trigger" data-position-menu="right" data-attach-menu="true" aria-haspopup="true" role="button" data-speechtip="{{more_alt_text_short}}">\n        <span class="yj-down-arrow"><span class="yj-acc-hidden">{{more_alt_text}}</span></span>\n        <span class="yj-menu yj-click-menu yj-click-menu-content yj-menu-shadow">\n          <ul class="yj-menu yj-hover-bar-more-menu-actions">\n            {{#more_menu_actions}}\n              <MoreMenuActionView key="{{.}}" />\n            {{/more_menu_actions}}\n          </ul>\n        </span>\n      </a>\n    </div>\n  {{/more_menu}}\n  <ul class="yj-hover-bar--actions yj-hover-bar-actions">\n    {{#actions}}\n      <ActionView key="{{.}}" />\n    {{/actions}}\n  </ul>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/general/hover_bar",["require","underscore","core/lib/tr","html!./hover_bar","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews"],function(a){var b=a("underscore"),c=a("core/lib/tr"),d=a("html!./hover_bar"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("core/lib/backbone_with_subviews"),h=e.extend({className:"yj-hover-bar",template:d,mixins:[f,g],views:{MoreMenuActionView:"_getMoreMenuActionView",ActionView:"_getActionView"},initialize:function(a){this.actions=a.actions,this.moreMenuActions=a.moreMenuActions,this.attachPoint=a.attachPoint,this.data=a.data},getTemplateData:function(){var a={more_menu:!!this.moreMenuActions,more_alt_text:c.t("more_attachment_actions"),more_alt_text_short:c.t("more_attachment_actions_short"),more_menu_actions:b.map(this.moreMenuActions,function(a,b){return b}),actions:b.map(this.actions,function(a,b){return b})};return a},render:function(){return this.moreMenuActions&&this._bindMoreMenuEvents(),this},push:function(a){this.actions.push(a),this.render()},_bindMoreMenuEvents:function(){var a=this.$(".yj-click-menu-trigger"),c=b.bind(function(){this.trigger("moreMenuShown")},this),d=b.bind(function(){this.trigger("moreMenuHidden")},this);a.on("show.ClickMenu",c),a.on("hide.ClickMenu",d)},_getMoreMenuActionView:function(a){return this.moreMenuActions[a]},_getActionView:function(a){return this.actions[a]},remove:function(){var a=this.$(".yj-click-menu-trigger");return a.off(),e.prototype.remove.call(this)}});return h}),define("common-ui/lib/ui/general/actions/preview",["require","common-ui/lib/ui/general/actions/file_action","core/lib/tr","core/lib/urls"],function(a){var b=a("common-ui/lib/ui/general/actions/file_action"),c=a("core/lib/tr"),d=a("core/lib/urls"),e=b.extend({className:"yj-preview",url_fn:d.filePreview,key:"preview",icon:"add-search",word:c.t("preview"),altWord:c.t("preview_file"),title:c.t("preview_file"),target:"_blank"});return e}),define("common-ui/lib/ui/general/actions/share_file",["require","common-ui/lib/ui/general/actions/file_action","backbone","core/lib/tr"],function(a){var b=a("common-ui/lib/ui/general/actions/file_action"),c=a("backbone"),d=a("core/lib/tr"),e=b.extend({className:"yj-share-file",events:{"click a":"_clickHandler"},key:"share-file",icon:"share",url:"",word:d.t("share"),altWord:d.t("share_this_file"),title:d.t("share"),modelType:"attachment",initialize:function(a){this.file=a.file,a.iconClass="rd_share",this.file.modelType&&(this.modelType=this.file.modelType),b.prototype.initialize.apply(this,arguments)},_clickHandler:function(a){a.preventDefault(),a.stopPropagation(),this._openPublisherShareLightbox()},_openPublisherShareLightbox:function(){c.trigger("/ui/publisher/share-lightbox/open",{excerptOptions:{id:this.file.record_id||this.file.id,excerptId:this.file.id,type:this.modelType,source:"actions_bar"}})}});return e}),define("css!common-ui/lib/ui/keyboard/navigable_element_adaptor",[],function(){}),define("common-ui/lib/ui/keyboard/navigable_element_adaptor",["require","underscore","core/lib/backbone_base_class","css!common-ui/lib/ui/keyboard/navigable_element_adaptor"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_class");a("css!common-ui/lib/ui/keyboard/navigable_element_adaptor");var d=c.extend({initialize:function(){this._navigator=this.options.navigator,this._model=this.options.model||this,this._rootElement=$(this.options.rootElement),this._focusTarget=this.options.focusTarget,this.listenTo(this._navigator,"change:current",this._onSelectionChange),this.listenTo(this._navigator,"updatedByCommand",this._onSelectionChangeByCommand),this._rootElement.on("focusin.nav_el_adaptor",b.bind(this._trackFocusToNavigation,this)),this._rootElement.addClass("yj-navigable")},stop:function(){this.stopListening(),this._rootElement.off("focusin.nav_el_adaptor")},isSelected:function(){return this._navigator.get("current")===this._model},_scrollIntoView:function(){var a=$("html, body"),b=this._rootElement.offset();b&&(b.top-=200,a.animate({scrollTop:b.top},200))},_onSelectionChange:function(){this.isSelected()?this._rootElement.addClass("yj-kbdSelected"):this._rootElement.removeClass("yj-kbdSelected")},_takeFocus:function(){var a;a="string"==typeof this._focusTarget?this._rootElement.find(this._focusTarget).first():this._focusTarget,a&&a[0]&&d._focusElement(a[0])},_onSelectionChangeByCommand:function(){if(this.isSelected()){this._scrollIntoView();var a=this._rootElement[0]==d._getActiveElement(),b=$.contains(this._rootElement[0],d._getActiveElement());a||b||this._takeFocus()}},_trackFocusToNavigation:function(){var a=$(d._getActiveElement());a.is(".yj-navigable")||(a=a.parents(".yj-navigable").first()),this._rootElement[0]===a[0]&&this._navigator.setCurrent(this._model)}},{_getActiveElement:function(){return document.activeElement},_focusElement:function(a){$(a).focus()}});return d}),define("stache!common-ui/lib/ui/shared/spinner",["mustache"],function(a){var b='<span class="yj-inline-icon"></span>{{message}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/spinner",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_show_hide","core/lib/tr","html!./spinner"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_show_hide"),e=a("core/lib/tr");return b.extend({mixins:[c,d],defaults:{message:e.t("loading")},className:"yj-spinner",template:a("html!./spinner"),getTemplateData:function(){return this.options},render:function(){return this.options.isOnDark&&this.$el.addClass("is-on-dark"),this}})}),define("core/lib/util/lazy_loader",["require","underscore"],function(a){"use strict";var b=a("underscore"),c=function(a){var b=document.createElement("link");b.type="text/css",b.rel="stylesheet",b.href=a,document.head.appendChild(b)},d=function(a){b.each(a,function(a){c(a)})},e=function(b,c){return a.call(null,[b],c)},f=function(b,c){return a.call(null,b,c)};return{getStylesheet:c,getStylesheets:d,getScript:e,getScripts:f}}),define("stache!common-ui/lib/ui/general/video",["mustache"],function(a){var b='<video id="{{videoId}}" class="video-js vjs-big-play-centered vjs-default-skin"\n  controls autoplay="{{autostart}}" preload="auto" width="{{width}}" height="{{height}}">\n  {{#sources}}\n    <source src="{{url}}" type="{{mime}}" />\n  {{/sources}}\n</video>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/general/video",["require","jquery","underscore","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/log","common-ui/lib/helper/environment","core/lib/yammer_uri","core/lib/util/lazy_loader","html!./video"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("core/lib/log"),h=a("common-ui/lib/helper/environment"),i=a("core/lib/yammer_uri"),j=a("core/lib/util/lazy_loader"),k=a("html!./video"),l=1,m=!1,n="html5",o="video/mp4",p=function(){m||(m=!0,j.getStylesheets([i.cdn("assets/misc/video-js/video-js.css"),i.cdn("assets/misc/video-js/video-js-yammer.css")]))};return e.extend({mixins:[f],template:k,initialize:function(a){c.bindAll(this,"_escapeFlowWhenFullScreen","_toggleFlow","_ensureVideoJs","_initVideoJs","_configVideoJs"),this._videoPlayer=null;var b,e;a.videoOpts&&a.videoOpts.width&&(b=a.videoOpts.width,e=b?Math.floor(.75*b):null),this.data={videoId:this._getNextId(),autostart:a.videoOpts.autostart,width:b||"auto",height:e||"auto",sources:[],techOrder:[]},this.data.sources.push({url:a.attachment.signed_url,mime:o}),this.data.techOrder.push(n),a.inLightbox&&(this.inLightbox=!0,d.on("/ui/fancy-lightbox/opened",function(){this._ensureVideoJs(this._initVideoJs)},this)),p(),this._ensureVideoJs(this._configVideoJs);var f="video-player/"+a.attachment.id+"/fullscreen";this.listenTo(d,f,this._goFullScreen)},_getNextId:function(){return"video_"+l++},_useNewId:function(){this.data.videoId=this._getNextId()},_ensureVideoJs:function(a){j.getScript(i.cdn("assets/misc/video-js/video.js"),a)},getTemplateData:function(){return this.data},render:function(){this.inLightbox||this._ensureVideoJs(this._initVideoJs)},remove:function(){return d.off("/ui/fancy-lightbox/opened",null,this),this._disposePlayer(),e.prototype.remove.call(this)},_disposePlayer:function(){if(this._videoPlayer){try{this._videoPlayer.dispose()}catch(a){g.log("Failed to dispose of video player - "+a.message)}this._videoPlayer=null}},_toggleFlow:function(){var a=!this._fullScreen,c=!this._videoPlayer.paused(),d=this._videoPlayer.currentTime(),e=this;this._disposePlayer(),this._useNewId(),this.render(),a?(this._oldFlow={$parent:this.$el.parent(),position:this.$el.css("position"),zIndex:this.$el.css("z-index")},this.$el.css({position:"absolute","z-index":"999999"}),b(document.body).append(this.$el),this._createNewVideoJS(function(){e._videoPlayer.currentTime(d),e._videoPlayer.requestFullscreen(),c&&e._videoPlayer.play()})):(this.$el.css({position:this._oldFlow.position,"z-index":this._oldFlow.zIndex}),this._oldFlow.$parent.append(this.$el),this._createNewVideoJS(function(){e._videoPlayer.currentTime(d),c&&e._videoPlayer.play()})),this._fullScreen=a},_escapeFlowWhenFullScreen:function(){var a=this.$(".vjs-fullscreen-control"),b=a.clone();b.on("click",this._toggleFlow),a.replaceWith(b)},_configVideoJs:function(){videojs.options.flash.swf=i.cdn("assets/misc/video-js/video-js.swf"),videojs.options.notSupportedMessage=["Sorry, no compatible source and playback technology were found for ","this video. Try using a modern browser like ",'<a href="http://www.microsoft.com/ie/" target="_blank">Internet Explorer 11</a> or ',"download the latest ",'<a href="https://get.adobe.com/flashplayer/" target="_blank">Adobe Flash Player</a>.'].join("")},_goFullScreen:function(){if(this._videoPlayer){if(this._videoPlayer.isFullscreen())return;h.isIE()&&h.isIE().version<11?this._toggleFlow():this._videoPlayer.requestFullscreen()}},_createNewVideoJS:function(a){var b=this.data;this._videoPlayer=videojs(b.videoId,{controls:!0,autoplay:!1,techOrder:b.techOrder}),a&&c.defer(a)},_initVideoJs:function(){this._createNewVideoJS(),h.isIE()&&h.isIE().version<11&&c.defer(this._escapeFlowWhenFullScreen),0===this.$(".video-js.loaded").length&&this.$(".video-js").addClass("loaded")}})}),define("css!components/banner_with_icon/src/banner_with_icon",[],function(){}),define("stache!components/banner_with_icon/src/banner_with_icon",["mustache"],function(a){var b='<div class="yj-banner-with-icon--icon">{{{svgIcon}}}</div>\n{{#message}}\n  <p class="yj-banner-with-icon--message">{{message}}</p>\n{{/message}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/banner_with_icon/src/banner_with_icon",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/helper/svg_icon","css!./banner_with_icon","html!./banner_with_icon"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("common-ui/lib/helper/svg_icon");return a("css!./banner_with_icon"),b.extend({mixins:[c],className:"yj-banner-with-icon",template:a("html!./banner_with_icon"),getTemplateData:function(){return{svgIcon:d(this.options.iconName,this.options.iconOptions),message:this.options.message}}})}),define("components/banner_with_icon/index",["require","./src/banner_with_icon"],function(a){"use strict";return a("./src/banner_with_icon")}),define("feeds/lib/modules/attachments",["require","underscore","jquery","models/attachment","collections/likes","common-ui/lib/ui/shared/spinner","common-ui/lib/ui/general/video","feeds/lib/modules/video_encoding_progress","core/lib/util/work_queue","core/lib/util/work_queue_task","core/lib/log","backbone","core/lib/session","core/lib/tr","core/lib/uri_helper","core/lib/yammer_api","models/helpers/attachment","components/banner_with_icon/index"],function(a){var b=a("underscore"),c=a("jquery"),d=a("models/attachment"),e=a("collections/likes"),f=a("common-ui/lib/ui/shared/spinner"),g=a("common-ui/lib/ui/general/video"),h=a("feeds/lib/modules/video_encoding_progress"),i=a("core/lib/util/work_queue"),j=a("core/lib/util/work_queue_task"),k=a("core/lib/log"),l=a("backbone"),m=a("core/lib/session"),n=a("core/lib/tr"),o=a("core/lib/uri_helper"),p=a("core/lib/yammer_api"),q=a("models/helpers/attachment"),r=a("components/banner_with_icon/index");return yam.attachments=new function(){var a=this,s="ymodule-instance";this.currentMessageFormId="",this.currentAttachmentTypeData={},this.attachmentsByAppId={},this.IMAGE_PREVIEW_OPTIONS={preloading:!1,maxWidth:"770px",maxHeight:"600px",minWidth:"335px",minHeight:"75px",title:function(){return c(this).attr("title")||n.t("image")}},this._addVideoInContainer=function(a,b,c){var d=new g({el:a,attachment:b,videoOpts:c});d.render()},this.playVideoInContainer=function(a,b,d){return b&&"Video"==b.content_class?b.status===h.EncodingStatus.FAILED?(a=a||c("#file-preview"),void this._updateVideoStatusMessage(a,b)):void this._initVideoPlayer(a,b,d):void 0},this._initVideoPlayer=function(a,b,c){b.status===h.EncodingStatus.ENCODED||b.transcoded?this._createVideoPlayer(a,b,c):b.status===h.EncodingStatus.FAILED?this._updateVideoStatusMessage(a,b):b.status===h.EncodingStatus.ENCODING&&(this._updateVideoStatusMessage(a,b),this._videoEncodingProgress=h.create({fileId:b.id,versionId:b.latest_version_id}),this._videoEncodingProgress.handleEncodingStatusChange({onEncoded:function(d){this._handleVideoEncoded(d,a,b,c)}.bind(this),onError:function(c){this._handleVideoEncodingError(c,a,b)}.bind(this)},5e3))},this._handleVideoEncoded=function(a,c,d,e){b.extend(d,a),d.transcoded=!0,this._createVideoPlayer(c,d,e)},this._handleVideoEncodingError=function(a,c,d){b.extend(d,a),this._updateVideoStatusMessage(c,d)},this._createVideoPlayer=function(a,d,e){var f=this,g=c(a);if(e=e||{},"undefined"==typeof e.autostart&&(e.autostart=!0),e.width=e.width?e.width+"px":"100%",e.height=e.height?e.height+"px":"100%",!d.transcoded&&!d.streaming_url)throw new Error("Instance is not transcoded.");g.html('<div class="yj-spinner" style="width:'+e.width+'; display:inline-block"><span class="yj-inline-icon"></span></div>'),p.getVideoStreamingPath({file_id:d.id,version_id:d.versionId}).then(function(c){g.children(".yj-spinner").remove();var h;try{h=JSON.parse(c).signed_url}catch(a){h=c.signed_url?c.signed_url:c}b.extend(d,{signed_url:h}),f._addVideoInContainer(a,d,e)},function(){var a=new r({message:n.t("sorry_something_went_wrong_please_refresh"),iconName:"docicon-big-default",iconOptions:{width:64,height:64}});g.html(a.render().el)})},this._updateVideoStatusMessage=function(a,b){var d=c(a).find(".msg"),e="";if(b.status===h.EncodingStatus.ENCODING){e=n.t("were_encoding_this_video_it_should_be_ready_soon");var g=new f({message:e,isOnDark:!0});c(d).html(g.render().$el)}else if(b.status===h.EncodingStatus.FAILED){var i=m.getCurrentUser();e=i&&i.id==b.owner_id?n.t("sorry_this_video_could_not_be_encoded"):n.t("this_video_cannot_be_played"),c(d).html(e);var j=c(a).find(".failure-link");j.length>0&&b.download_url&&c(j).attr("href",b.download_url)}},this.openUrlInDocumentViewer=function(a){var d=window.location.href,e=c('<div class="yj-letterbox">        <div class="yj-inner">          <div class="yj-control-area">            <a class="yj-close" href="'+b.escape(d)+'">              <span class="yj-inner">×<span> '+n.t("close_close_document")+'</span></span>            </a>          </div>          <iframe frameBorder="0" src="javascript:" class="yj-content">          </iframe>          <div class="yj-mask"></div>        </div>      </div>'),f=e.children(".yj-inner"),g=f.children("iframe:first"),h=f.children(".yj-control-area"),i=h.children(".yj-close"),j=f.children(".yj-mask"),k=function(a){a.target!==i[0]&&(a.preventDefault(),i.focus())},l=function(a){27===a.which&&o.call(this,a)},m=!1,o=function(a){a.stopPropagation(),a.preventDefault(),m||(m=!0,jQuery(document.body).unbind("focus",k),jQuery(document.body).unbind("keydown",l),jQuery(document.body).css("overflowY",""),e.slideUp(function(){e.remove()}))};return jQuery(document.body).bind("focus",k),jQuery(document.body).bind("keydown",l),i.click(o),i.attr("title",n.t("close_document")),j.mousedown(function(a){a.stopPropagation(),a.preventDefault()}),j.click(function(a){a.stopPropagation(),a.preventDefault(),i.clearQueue().stop().focus().animate({left:"10px"},"fast").delay(250).animate({left:"0"},"slow")}),jQuery(document.body).css("overflowY","hidden"),jQuery(document.body).append(e),g.attr("src",a),e},this.init=function(a){for(var b,d,e=a||m.getCurrentUser().attachments||[],f=0,g=e.length;g>f;f++)b=new Image,d=e[f],yam.attachments.attachmentsByAppId[d.app_id]=d,b.src=d.icon_url;var h=this;jQuery.each(["click","submit"],function(a,b){c(document.body).bind(b,function(a){var c=jQuery(a.target).closest("[data-"+s+"],*[data-action-on"+b+"]");c.attr("data-action-on"+b)&&(a.target=c[0],h.handleInteractiveEvent(a))})}),this._videoEncodingProgress=null},this.openURLInParent=function(a){window.location=a.url},this.getAttachmentByFeedId=function(a){var b=m.getCurrentUser(),c=b&&b.attachments;for(var d in c)if(c[d].id===a)return c[d];for(var e in this.attachmentsByAppId)if(this.attachmentsByAppId[e].id===a)return this.attachmentsByAppId[e]},this.reloadInlineView=function(a,b){p.getAttachmentInlineHtml({ymodule_id:a}).then(function(c){jQuery("[data-"+s+"='"+a+"']").html(c),b&&b()})},this.setOverlayOptions=function(a){var b=JSON.parse(a),c={},d={};b.width&&(c.innerWidth=b.width,d.width=b.width+"px"),b.height&&(c.innerHeight=b.height,d.height=b.height+"px"),l.trigger("/ui/lightbox/resize",c),jQuery("#ymodule-attachment-iframe").css(d)};var t=function(b,c){return function(){a.reloadInlineView(b,c.onComplete)}};this.reloadReloadableInlineViews=function(){var a,b,c=jQuery("#threads .reloadable"),d=new i;c.each(function(c,e){a=e.getAttribute("data-"+s),b=new j,b.execute=t(a,b),d.enqueue(b)})};var u=new function(){var a=function(a){return"string"==typeof a&&!a.match(/^[^<]*(<[\w\W]+>)[^>]/)},b=function(a){return"string"==typeof a&&a.match(/^(?:\s*https?:|[^:]+$)/i)},f=function(a){return parseInt(a[0].getAttribute("data-"+s),10)},g=function(a){var b=f(a),c=yam.model.Attachment.findById(b),d=q.getMessages(c),e=d[0];return d.length>1&&k.log("Attachment has mutliple messages -- probably shouldn't use getMessage."),e.liked_by||(e.liked_by={count:0}),e},h=function(b,c){var d=f(c);if(a(b)){var e=b.replace(/^(\s*[a-zA-Z]*[\.#])([\w\-]+)/g,"$1"+s+"-"+d+"-$2");return jQuery(c).find(e)}};this.show=function(b,c,d){var e=d[0],f=a(e)?h(e,b):c;f.show()},this.hide=function(b,c,d){var e=d[0],f=a(e)?h(e,b):c;f.hide()},this.reload=function(a){var b=f(a);yam.attachments.reloadInlineView(b)},this.embedIframe=function(c,d,e){var f=e[0],g=e[1],i=parseInt(e[2],10),j=parseInt(e[3],10);a(f)||(f=null),b(g)||(g="javascript:false");var k=f?h(f,c):c,l=document.createElement("iframe");l.src=g,l.setAttribute("width",i?i+"px":"100%"),l.setAttribute("height",j?j+"px":"200px"),l.setAttribute("frameBorder","0"),l.setAttribute("border","0"),l.setAttribute("scrolling","no"),k.append(l)},this.embedVideo=function(c,d,e){var f=e[0],g=e[1];if(!g||!b(g))throw new Error("Invalid url.");a(f)||(f=null);var i,j,k=o.parse(g);if(k.host.match(/youtube.com$/)&&"/watch"===k.path||k.host.match(/youtu.be$/))i=g.match(/(?:.be\/|\/watch\?v=|\/(?=p\/))([\w\/\-]+)/)[1],i&&i.match(/^[\w-]+$/)&&(j='<iframe title="YouTube video player" width="380" height="239" src="https://www.youtube.com/embed/'+i+'?rel=0&autoplay=1&wmode=transparent" frameborder="0" allowfullscreen></iframe>');else if(k.host.match(/vimeo.com$/)){var l=k.path.match(/^\/(\d+)$/);l&&(i=l[1],j='<iframe src="https://player.vimeo.com/video/'+i+'?autoplay=1&wmode=transparent" width="100%" height="214" frameborder="0" style="min-width: 380px"></iframe>')}if(!j)throw new Error('Cannot embed video for "'+g+'".');var m=f?h(f,c):c;m.addClass("yj-video"),m.append(j)},this.remote=function(a,b,c,e){var g={ymodule_id:f(a),rpc:c[0]};void 0!==e&&(g.form=e),p.sendYmoduleForm(g).then(function(b){a.html(b);var c=d.findById(g.id);c&&(c.inline_html=b)})},this.sendForm=function(a,b,c){if(b[0].nodeName.match(/form/i)){for(var d=b.serializeArray(),e={},f=0;f<d.length;f++)e[d[f].name]=d[f].value;this.remote(a,b,c,e)}},this.likeMessage=function(a){var b=c(a).closest(".yj-message-container"),d=b.find(".yj-like"),f=g(a),h={message_id:f.id,name:m.getCurrentUser().full_name,permalink:m.getCurrentUser().name},i=e.findWhere(h);if(0!==i.length)k.log("message is already liked");else if(d[0])d.click();else{var j=e.add(h);j.save(),f.liked_by.count++}},this.unlikeMessage=function(a){var b=c(a).closest(".yj-message-container"),d=b.find(".yj-like"),f=g(a),h={message_id:f.id,name:m.getCurrentUser().full_name,permalink:m.getCurrentUser().name},i=e.findWhere(h);0===i.length?k.log("message is already unliked"):d[0]?d.click():(p.unlikeMessage({message_id:f.id}),i[0].destroy()&&f.liked_by.count--)},this.setText=function(b,c,d){var e=d[0],f=d[1],g=a(e)?h(e,b):c;g.text(f)},this.sharePage=function(a,b,c){this._openPublisherShareLightbox(c)},this._openPublisherShareLightbox=function(a){l.trigger("/ui/publisher/share-lightbox/open",{excerptOptions:{type:"page",id:a[0],image:a[1],title:a[2],group_id:""===a[3]?void 0:a[3],source:"actions_bar"}})}},v=function(){var a={};return function(a){var b,c=function(){var a={};return function(a){var b=function(a){this._definitions=a.concat(),this._tokenRegExp=void 0};b.prototype=new function(){this._construct=function(){for(var a=[],b=this._definitions,c=0,d=b.length;d>c;c++){var e=b[c],f=e[0];a.push(f)}this._tokenRegExp=new RegExp("("+a.join(")|(")+")","gm")},this.lex=function(a){this._tokenRegExp||this._construct();for(var b,c=[],d=this._tokenRegExp,e=0;b=d.exec(a);){if(b.index!==e)throw new Error("Unexpected character found: "+a.charAt(e));e+=b[0].length;for(var f={value:b[0],match:b[0],offset:e},g=1;!b[g];)g++;var h=this._definitions[g-1];f.type=h[1],h[2]&&h[2].call(f),f.type&&c.push(f)}return c}},a.Lexer=b}(a),a}().Lexer,d=function(a){if(!b){var d=[["(?:\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*')","STRING",function(){this.value=this.match.substring(1,this.match.length-1).replace(new RegExp('\\\\"',"g"),'"').replace(new RegExp("\\\\'","g"),"'").replace(new RegExp("\\\\\\\\","g"),"\\")}],["[_a-zA-Z][_a-zA-Z0-9]*\\(","FUNC",function(){this.value=this.match.substring(0,this.match.length-1)}],["[+-]?(?:(?:[1-9][0-9]*|0?)\\.[0-9]+|NaN|Infinity|0x[0-9a-fA-F]+|[0-9]+)","NUM",function(){this.match.match(/^[+-]?0[^\.]/)?this.value=parseInt(this.match,10):this.value=parseFloat(this.match)}],["\\)","RPAREN"],[";","SEMI"],[",","COMMA"],["\\s+",null]];b=new c(d)}return b.lex(a)},e=function(a){for(var b=[],c=0,d=a.length;d>c;){var e=a[c];if("FUNC"!==e.type){if("SEMI"!==e.type)throw new Error('ParseError: Unexpected token "'+e.match.replace('"','\\"')+'".');c++}else{for(var f=c+1,g=[],h=a[f];d>f&&("STRING"===h.type||"NUM"===h.type)&&(g.push(h.value),h=a[++f],!(d>f)||"RPAREN"!==h.type&&"COMMA"===h.type);)h=a[++f];if(f>=d||"RPAREN"!==h.type)throw new Error("ParseError: Expected ')' instead found \""+h.match.replace('"','\\"')+'".');b.push([e.value,g]),c=f+1}}if(c!==d)throw new Error("ParseError: Unexpected token, expected EOF.");return b},f=function(a){this._code=a,this._tokens=d(a),this._statements=e(this._tokens)};f.prototype=new function(){this.runInContext=function(a){for(var b=this._statements,c=0,d=b.length;d>c;c++){var e=b[c];if(!Object.prototype.hasOwnProperty.call(a,e[0]))throw new Error('RuntimeError: Method "'+e[0].replace('"','\\"')+'" is not defined.');var f=a[e[0]];f.apply(this,e[1])}}},f.runInContext=function(a,b){var c=new this(a);c.runInContext(b)},a.MiniScript=f}(a),a}().MiniScript;this.handleInteractiveEvent=function(a){var b=a.target,c=jQuery(b).closest("."+s),d=b.getAttribute("data-action-on"+a.type);if(d&&!(b.nodeName.match(/a/i)&&b.href&&b.href.match(/^http/)&&(void 0!==a.metaKey?a.metaKey:a.ctrlKey))){var e={};for(var f in u)e[f]=function(a,d){return function(){a.call(d,c,jQuery(b),Array.prototype.slice.call(arguments))}}(u[f],u);var g=new v(d);g.runInContext(e),a.preventDefault()}}},yam.attachments}),define("stache!feeds/lib/ui/attachments/yamio_preview",["mustache"],function(a){var b='<div class="yj-yamio-preview yj-want-focuswithin" role="listitem">\n  <span class="yj-acc-hidden">{{alt_text}}</span>\n  <div class="yj-thumbnail {{#showPreviewHover}}yj-img-container{{/showPreviewHover}}" data-qaid="attachment_thumbnail">\n    {{^svgIconThumbnail}}\n      <div class="yj-thumbnail-frame" style="background-image: url({{imageUrl}})">\n        <img src="{{imageUrl}}" data-qaid="attachment_thumbnail" alt="" class="yj-thumbnail--sizer {{#imageClass}}{{imageClass}}{{/imageClass}}"/>\n        {{#isVideo}}\n          <div class="yj-play-button">\n            <div class="yj-play-button--icon">\n              {{{svgIconPlayButton}}}\n            </div>\n          </div>\n        {{/isVideo}}\n      </div>\n    {{/svgIconThumbnail}}\n    {{#svgIconThumbnail}}\n      {{{svgIconThumbnail}}}\n    {{/svgIconThumbnail}}\n  </div>\n  <div class="yj-yamio-content">\n    {{#subtitle}}\n    <div class="yj-subtitle">\n      <span>{{{subtitle}}}</span>\n    </div>\n    {{/subtitle}}\n    {{#name}}\n    <span class="yj-name" aria-hidden="true">\n      <span>{{name}}</span>\n    </span>\n    {{/name}}\n    {{#description}}\n    <p class="yj-description">\n      <span>{{description}}</span>\n    </p>\n    {{/description}}\n    {{#videoStatusMessage}}\n    <p class="yj-video-status-message">\n      <span></span>\n    </p>\n    {{/videoStatusMessage}}\n  </div>\n  <div class="yj-actions-container"></div>\n</div>\n';
return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/yamio_preview",["require","underscore","jquery","common-ui/lib/ui/general/actions/attachment_detail","core/lib/jam/component","common-ui/lib/ui/general/actions/download","common-ui/lib/ui/general/actions/follow","models/group","collections/groups","common-ui/lib/ui/general/hover_bar","components/hovercard_link/index","common-ui/lib/ui/general/actions/preview","common-ui/lib/ui/general/actions/share_file","feeds/lib/modules/video_encoding_progress","core/lib/filename_helper","core/lib/namespace","backbone","core/lib/session","common-ui/lib/helper/svg_icon","core/lib/tr","core/lib/urls","common-ui/lib/ui/keyboard/navigable_element_adaptor","models/helpers/attachment","models/helpers/group","core/lib/yammer_uri","feeds/lib/modules/attachments","html!./yamio_preview"],function(a){function b(){var a=this.$element.addClass("ymodule-instance"),b=this._attachment,c=d(b);c&&b.thumbnail_url&&a.addClass("yj-video-preview");var e=!1;if(i.each(this.actions,function(a){"preview"===w.val(a,"key")&&(e=this._displayPreview)},this),e){var f=j(".yj-thumbnail",a);c&&f.find(".yj-play-button").hide();var h=this,k=function(){f.find(".yj-play-button").show(),a.addClass("yj-yamio-click").on("click",function(d){var e=j(d.target),g=e.closest(".yj-actions a, .yj-subtitle a",d.currentTarget)[0],i=!j("body").hasClass("yj-touch")||a.hasClass("yj-highlight");if(!g&&i){if(c&&!h._overlay){var k=j('<div class="yj-video-container"></div>').replaceAll(f),l="yj-video-preview-"+b.id+"-"+(G+=1),m=j('<div id="'+l+'"></div>').appendTo(k);a.addClass("yj-video-play").unbind("click"),yam.attachments.playVideoInContainer(m[0],b)}else if(b.showOverlay)b.showOverlay();else{var n=e.parents("[data-thread-id]"),o={isUploadPreview:h._isUploadPreview};n.length>0&&(o.threadId=n.data("thread-id")),I.showOverlayForAttachment(b,o)}return!1}})};this._noClick||c&&!b.transcoded||k()}else!this._noClick&&g(b)&&a.addClass("yj-yamio-click").on("click",function(){window.location=b.web_url})}function c(){return o.ALL_COMPANY()}function d(a){var b=a.extension||v.getExtension(a.name||a.fileName);return-1!==j.inArray(b&&b.toLowerCase(),H)}function e(a,b){b=b||{};var c=b.isUploadPreview||!!a.is_pending;return x.trigger("/ui/fancy-lightbox/open",{attachmentId:a.id,type:a.type,instance:a,threadId:b.threadId,simple:c})}function f(a){return a.status===u.EncodingStatus.ENCODING||a.status===u.EncodingStatus.FAILED}function g(a){return a.web_url}function h(a){var b=[],c=D.isForeign(a,y),e=p.get(a.group_id);return g(a)&&b.unshift(new k({file:a})),a.download_url&&b.unshift(new m({file:a})),c||"private"===a.privacy||e&&E.isExternal(e)||b.unshift(new t({file:a})),(a.preview_url||d(a))&&b.unshift(new s({file:a})),b}var i=a("underscore"),j=a("jquery"),k=a("common-ui/lib/ui/general/actions/attachment_detail"),l=a("core/lib/jam/component"),m=a("common-ui/lib/ui/general/actions/download"),n=a("common-ui/lib/ui/general/actions/follow"),o=a("models/group"),p=a("collections/groups"),q=a("common-ui/lib/ui/general/hover_bar"),r=a("components/hovercard_link/index"),s=a("common-ui/lib/ui/general/actions/preview"),t=a("common-ui/lib/ui/general/actions/share_file"),u=a("feeds/lib/modules/video_encoding_progress"),v=a("core/lib/filename_helper"),w=a("core/lib/namespace"),x=a("backbone"),y=a("core/lib/session"),z=a("common-ui/lib/helper/svg_icon"),A=a("core/lib/tr"),B=a("core/lib/urls"),C=a("common-ui/lib/ui/keyboard/navigable_element_adaptor"),D=a("models/helpers/attachment"),E=a("models/helpers/group"),F=a("core/lib/yammer_uri");a("feeds/lib/modules/attachments");var G=0,H="avi mpeg mpg wmv ogm ogv mkv 3gp flv mov mp4".split(" "),I=l.extend(new function(){this.init=function(a,b){l.prototype.init.call(this,{id:"YamioPreview"}),this._navigator=a.navigator||b&&b.navigator,b=b||{},a=a.model||a;var c=p.get(a.group_id),d=c&&E.isExternal(c);this._overlay=!1,this._displayFilename=!0,this._displaySubtitle=!0,this._displayDetailAction=!0,this._displayFollowButton=!D.isForeign(a,y)&&!d,this._displayPreview=!0,this._isUploadPreview=b.isUploadPreview||!1,this._noHoverbar=b.noHoverbar||!1,this._noClick=b.noClick||!1,this._defaultToLoadingIcon=b.defaultToLoadingIcon||!1,this._attachment=a,this._videoEncodingProgress=null,this._navigator&&(this.isNavigable=!0)},this.destroy=function(){this.actionBar&&this.actionBar.destroy&&this.actionBar.destroy(),l.prototype.destroy.call(this),this._videoEncodingProgress&&this._videoEncodingProgress.destroy&&(this._videoEncodingProgress=this._videoEncodingProgress.destroy()),this._navigableElementAdaptor&&this._navigableElementAdaptor.stop()},this.afterRender=function(){this._noHoverbar||this._updateActionBar(),I.instrumentPreview.call(this),d(this._attachment)&&f(this._attachment)&&this._updateEncodingStatus(this._attachment)},this._updateActionBar=function(){if(this.actions=this._availableFileActions(this._attachment),this.actionBar=new q({actions:this.actions}),this.$element.find(".yj-actions-container").html(this.actionBar.render().$el),this._displayFollowButton&&void 0!==this._attachment.group_id){var a=new n({file:this._attachment});this.actionBar.push(a)}},this.createElement=function(){var a,e=this._attachment,g=this._attachment;if(void 0!==g.group_id){var h,k;if(h=g.group_id?p.get(g.group_id):c(),h&&!D.isForeign(g,y)){var l=new r({model:h});k=i.escape(B.groupFiles(h)),a=h&&l.render().el.innerHTML+'<span aria-hidden="true"> &rsaquo; </span><a href="'+k+'">'+A.t("files")+"</a>"}}var m=f(e),n=y.getCurrentUser(),o=n&&n.id===this._attachment.owner_id,q=m?null:e.thumbnail_url,s=v.getFileIconClass(e.name||e.fileName),t=e.preview_url;this._displayPreview=!!q||!!t;var u,w,x,E="yj-icon";u="Document"===e.content_class?"yj-document-thumbnail":"spreadsheet"===s?E:q?"":t?"yj-preview-without-thumbnail":E,u===E&&(w=z("docicon-big-"+s,{classList:"yj-yamio-preview--svg-icon-thumbnail"})),d(e)&&!m&&(x=z("play_video",{classList:"yj-yamio-preview--svg-icon-play-button"}));var G=F.cdn("assets/images/file_icons/file.png"),H=F.cdn("assets/images/loader-gif.gif"),I=this._defaultToLoadingIcon?H:G,J=j(b({showPreviewHover:this._displayPreview,imageUrl:q||e.large_icon_url||I,imageClass:u,name:this._displayFilename&&(e.full_name||e.name),subtitle:this._displaySubtitle&&a,description:e.description,extension:v.getExtension(e.name||e.fileName),showExtensionText:!q,alt_text:A.t("file")+" "+e.name,isVideo:d(e),svgIconThumbnail:w,svgIconPlayButton:x,videoStatusMessage:m&&o}));return this.$element=J,j("body").hasClass("yj-touch")&&(J.append('<span class="yj-inline-icon yj-align-icon add-icon yj-hover-touch"></span>'),J.bind("click.touch",function(a){a.preventDefault(),a.stopPropagation(),J.find(".yj-hover-touch").hide(),J.addClass("yj-highlight"),J.unbind("click.touch")})),this._navigator&&(this._navigableElementAdaptor=new C({navigator:this._navigator,model:this._attachment,rootElement:this.$element,focusTarget:"a:first"})),J},this._availableFileActions=function(a){for(var b=h(a),c=[],d=0,e=b.length;e>d;d++){var f=b[d];("detail"!=f.key||this._displayDetailAction)&&(f.share=!0,c.push(f))}return c},this._updateVideoPreview=function(a){i.extend(this._attachment,a),this._updateActionBar();var b=this.$element.find(".yj-video-status-message span"),c=y.getCurrentUser(),d=c&&c.id===this._attachment.owner_id;if(this._attachment.status===u.EncodingStatus.ENCODED){j(b).text(""),this._displayPreview=!0;var e=this.createElement();this.$el.replaceWith(e),this.$el=j(e),this.afterRender()}else this._attachment.status===u.EncodingStatus.ENCODING?j(b).text(A.t("were_encoding_this_video_it_should_be_ready_soon")):this._attachment.status===u.EncodingStatus.FAILED&&d&&j(b).text(A.t("sorry_this_video_could_not_be_encoded"))},this._updateEncodingStatus=function(a){this._updateVideoPreview(null),this._videoEncodingProgress=u.create({fileId:a.id,versionId:a.latest_version_id});var b=function(a){a.transcoded=!0,this._updateVideoPreview(a)},c=function(a){this._updateVideoPreview(a)};this._videoEncodingProgress.handleEncodingStatusChange({onEncoded:b.bind(this),onError:c.bind(this)},5e3)};var b=a("html!./yamio_preview")});return I.instrumentPreview=b,I.previewable=function(a){return!!a.preview_url},I.showOverlayForAttachment=e,I.isVideo=d,I.availableFileActions=h,I}),define("stache!feeds/lib/ui/shared/sidebar_navigator",["mustache"],function(a){var b='<ul class="yj-sidebar-list">{{#sections}}{{#header}}<li><div class="yj-sidebar-header">{{header}}</div><ul>{{/header}}{{#items}}<li><a href="javascript://" data-item-id="{{id}}" title="{{full_title}}" class="yj-sidebar-item {{#header}}yj-sidebar-item-sub{{/header}} {{^header}}yj-sidebar-item-top{{/header}}">{{#showSidebarIcons}}<span class="yamicon-inline yj-dark-gray yamicon yamicon-folder">{{/showSidebarIcons}}</span>{{title}}<span class="yj-acc-selectedstate"> {{selectedAltText}}</span></a></li>{{/items}}{{#header}}</ul></li>{{/header}}{{/sections}}</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/shared/sidebar_navigator",["require","underscore","jquery","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/session","core/lib/tr","models/helpers/network","html!./sidebar_navigator"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("backbone"),g=a("core/lib/session"),h=a("core/lib/tr"),i=a("models/helpers/network"),j=a("html!./sidebar_navigator"),k="data-item-id",l="yj-sidebar-item-selected";return d.extend({mixins:[e],template:j,className:"yj-sidebar-nav yj-component",events:{"click.yj-sidebar-item":"_handleClick"},attributes:{role:"navigation",style:"overflow-x: hidden"},initialize:function(){f.on("/ui/lightbox/open",this.toggleScrollbars,this)},remove:function(){f.off("/ui/lightbox/open",this.toggleScrollbars,this),d.prototype.remove.call(this)},getTemplateData:function(){return b.extend({selectedAltText:h.t("selected")},this.options)},render:function(){var a;if(null!=this.options.defaultSelection){var c=this.$el.find("["+k+"="+this.options.defaultSelection+"]").first();c.length>0&&(a=c)}return null==a&&(a=this.$el.find("["+k+"]").first()),a.addClass(l),this.trigger("navigate",a.attr(k)),this.$el.height()<this.minHeight&&this.$el.height(this.minHeight),b.defer(b.bind(function(){var b=this.$el,c=a.position().top;b.scrollTop(b.scrollTop()+c)},this)),this},_handleClick:function(a){var b=c(a.target),d=b.attr(k);if(null!=d){var e=this.$el.find("."+l);e.removeClass(l),b.addClass(l);var h="group"===d.split("-")[1]?b.attr("title"):i.getCompanyGroupName(g.getCurrentNetwork());this.trigger("navigate",d),f.trigger("/ui/SidebarNavigator/selection",b.attr("data-item-id").split("-").reverse()[0],h)}},getSelectedItemId:function(){return this.$el.find("."+l).attr(k)},toggleScrollbars:function(){this.$el.height()<this.$el.find(".yj-sidebar-list").height()&&this.$el.css("overflow-y","scroll")}})}),define("stache!common-ui/lib/ui/shared/more_button",["mustache"],function(a){var b='<button class="yj-more-button--button yj-more-button-link yj-btn yj-btn-alt yj-btn-wide">\n  <span class="yj-more-button-error yj-hide">{{oopsLabel}}<span class="yj-fake-link">{{tryAgainLabel}}</span></span>\n  <span class="yj-more-button-okay">{{labelText}}<span class="yj-count badge" style="display:none;"></span></span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/shared/more_button",[],function(){}),define("common-ui/lib/ui/shared/more_button",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","html!./more_button","css!./more_button"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("html!./more_button");return a("css!./more_button"),b.extend({mixins:[c],tagName:"div",className:"yj-more-button-container",template:e,events:{"click .yj-more-button-link":"handleClick"},initialize:function(a){this.cid="moreButton",a&&(this.model=a.model,this.clickCallBack=a.clickCallBack,this.renderVisible=a.renderVisible)},getTemplateData:function(){return{oopsLabel:d.t("oops_loading_is_taking_longer_than_usual"),tryAgainLabel:d.t("try_again"),labelText:this.model&&this.model.labelText?this.model.labelText:d.t("more_button_text_to_show_more_items")}},render:function(){return this.renderVisible||this.$el.hide(),this.$link=this.$el.find(".yj-more-button-link"),this.$count=this.$el.find(".yj-count"),this.$error=this.$el.find(".yj-more-button-error"),this.$okay=this.$el.find(".yj-more-button-okay"),this},handleClick:function(a){this.$link&&(!this.$link.hasClass("yj-loading")&&this.clickCallBack&&"function"==typeof this.clickCallBack&&this.clickCallBack(a),this.trigger("click"),this.hideError(),this.startLoading())},show:function(){this.stopLoading(),this.$el.show()},hide:function(){this.$el.hide()},startLoading:function(){this.$link.addClass("yj-loading")},stopLoading:function(){return this.$link.hasClass("yj-loading")?(this.$link.removeClass("yj-loading"),!0):!1},showError:function(a){a&&this.$error.text(a),this.$error.removeClass("yj-hide"),this.$okay.addClass("yj-hide")},hideError:function(){this.$error.addClass("yj-hide"),this.$okay.removeClass("yj-hide")},setCount:function(a,b){b=b||100;var c="";c=0===a||"undefined"==typeof a?"":0>a||a>=b?"+":a,this.$count.html(c),""===c?this.$count.hide():this.$count.show()}})}),define("stache!feeds/lib/ui/shared/tabular_item_viewer",["mustache"],function(a){var b='<div class="yj-create">\n  {{#showGroup}}\n  <span class="yj-create-text-wrap">\n    <span class="yj-create-text"></span>\n    <span class="yj-inline-icon yj-align-icon crumb-arrow-icon"></span>\n  </span>\n  {{/showGroup}}\n  {{#canUpload}}\n  <a data-action-type="file" class="yj-btn yj-btn-secondary yj-create-link yj-inline-icon yj-align-icon" href="javascript://" role="button">\n    <span>{{createLinkText}}</span>\n  </a>\n  {{/canUpload}}\n  {{#canCreatePage}}\n  <a data-action-type="page" class="yj-btn yj-btn-secondary yj-create-link yj-inline-icon yj-align-icon" href="javascript://" role="button">\n    <span>{{createPageText}}</span>\n  </a>\n  {{/canCreatePage}}\n</div>\n<table class="yj-tabular"></table>\n<div class="yj-tabular-notice"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/shared/tabular_item_viewer_header",["mustache"],function(a){var b='<thead>\n  <tr>\n  {{#cols}}\n    <th scope="col" class="yj-tabular-header" title="{{title}}" style="{{headerStyle}}">{{title}}</th>\n  {{/cols}}\n  </tr>\n</thead>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/shared/tabular_item_viewer",["require","jquery","underscore","core/lib/backbone_legacy_integration","common-ui/lib/ui/shared/spinner","core/lib/log","backbone","core/lib/tr","common-ui/lib/ui/shared/more_button","html!./tabular_item_viewer","html!./tabular_item_viewer_header"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_legacy_integration"),e=a("common-ui/lib/ui/shared/spinner"),f=a("core/lib/log"),g=a("backbone"),h=a("core/lib/tr"),i=a("common-ui/lib/ui/shared/more_button"),j=a("html!./tabular_item_viewer"),k=a("html!./tabular_item_viewer_header");return d.extend({className:"yj-item-viewer",events:{click:"handleClick",dblclick:"handleDblClick","click .yj-create-link":"handleCreateClick"},initialize:function(a){this._parent=a.parent,this.columns=a.columns,this.target=a.target,this.createLinkIcon=a.createLinkIcon,this.createLinkText=a.createLinkText,this.showCreateLink=a.showCreateLink,this.canCreatePage=a.canCreatePage,this.createPageText=a.createPageText,this.showGroup=a.showGroup,this.showSelection=a.showSelection,this.tableClass=a.tableClass,this.minItems=a.minItems,this._$currentSelection=null,this.moreButton=new i({clickCallBack:c.bind(function(a){this.trigger("more",a)},this)}),this.append(this.moreButton),this.spinner=new e,this.append(this.spinner),this.$table=null,this.$tableBody=null},render:function(){return this.$el.html(j({createLinkIcon:this.createLinkIcon,createLinkText:this.createLinkText,canUpload:this.showCreateLink,canCreatePage:this.canCreatePage,createPageText:this.createPageText,showGroup:this.showGroup})),this.$create=this.$(".yj-create"),this.$createLink=this.$(".yj-create-link"),this.$table=this.$(".yj-tabular"),this.$notice=this.$(".yj-tabular-notice"),this.showCreateLink||this.$(".crumb-arrow-icon").hide(),this.$contentArea=this.$table,this.$el.height()<this.minHeight&&this.$el.height(this.minHeight),this},displayItems:function(a){if(this.spacerRowCount=0,this.minItems&&a.length<=this.minItems&&b(".yj-tabular-row").length<=this.minItems&&(this.spacerRowCount=this.minItems-a.length),!this._parent._triggeredMore){var c=b(k({cols:this.columns}));this.spinner.$el.hide(),this.$table.empty(),this.$table.addClass(this.tableClass).append(c).show().find(".yj-tabular-header:first").addClass("yj-tabular-header-first"),this._lastItemIndex=0,this.$table.append(b("<tbody>")),this.$tableBody=this.$table.find("tbody")}for(var d=0,e=a.length+this.spacerRowCount;e>d;d++)this.addItem(a[d]);if(this.toggleScrollbars(),this._parent._triggeredMore=!1,this._parent._nextURL?(this.moreButton.show(),this.moreButton.$link.removeClass("yj-loading")):this.moreButton.hide(),a.length>0){var f=h.t("marked_as_an_official_note_2"),i=h.t("marked_as_an_official_file"),j="page"===a[0].type?f:i;g.trigger("/ui/tooltip/add",{target:b(".official-badge-small"),text:j})}},addItem:function(a,b){var c=this.displayItem(this._lastItemIndex,a);b?this.$tableBody.prepend(c):this.$tableBody.append(c),this.$notice.hide(),a&&this._lastItemIndex++},displayItem:function(a,c){var d,e,h,i,j,k,l=this.columns;j=b(c?'<tr class="yj-tabular-row" data-row-id="yj-tabular-'+a+'">':'<tr class="yj-tabular-row">');for(var m=0,n=l.length;n>m;m++){if(i="",h="",d=l[m],e=d.source,i+=0===m?'<th scope="row" class="yj-tabular-data unstyle-th-as-td':'<td class="yj-tabular-data',i+='"',d.dataStyle&&(i+=' style="'+d.dataStyle+'"'),i+=">",k=b(i),void 0!==c)try{"function"==typeof e?e.apply(this._parent,[c,m,k]):(h=c[e],k.append(b(h||"")))}catch(a){f.log(d.title+" column failed",a)}else k.html("&nbsp;");g.trigger("/ui/hovercard/build",k,".yj-hovercard-link"),j.append(k)}return j},toggleScrollbars:function(){this.inLightbox&&(this.$el.height()<this.$table.height()?(this.$el.css("overflow-y","scroll"),this.$el.css("overflow-x","hidden")):this.$el.css("overflow","hidden"))},handleSelection:function(a){var c=b(a.target),d=c.closest("tr");return this._$currentSelection&&this._$currentSelection.removeClass("yj-tabular-selected"),this.showSelection&&d.addClass("yj-tabular-selected"),this._$currentSelection=d,d},handleClick:function(a){var b=this.handleSelection(a);this.trigger("select",b.attr("data-row-id"),a)},handleDblClick:function(a){var b=this.handleSelection(a);this.trigger("select",b.attr("data-row-id"),a,!0)},handleCreateClick:function(a){this.trigger("createItem",a)}})}),define("feeds/lib/ui/selectors/templates_helper",["require","underscore","core/lib/backbone_base_class","collections/groups","models/group","core/lib/tr","core/lib/urls"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_class"),d=a("collections/groups"),e=a("models/group"),f=a("core/lib/tr"),g=a("core/lib/urls"),h=c.extend({});return b.extend(h,{getGroupTemplateData:function(a){var b;return b=a.group_id?d.get(a.group_id):e.ALL_COMPANY(),this._isItemInPrivateMessage(a)?this._getPrivateFileGroupData(b,a.web_url):this._getPublicFileGroupData(b)},_isItemInPrivateMessage:function(a){return"private"==a.privacy&&!a.group_id},_getPrivateFileGroupData:function(a,b){return{group_id:"pm",group_name:f.t("private_message"),group_url:b,group_class:""}},_getPublicFileGroupData:function(a){return{group_id:a.id,group_name:a.get("full_name")||a.get("name"),group_url:g.groupIndex(a),group_class:"yj-hovercard-link"}}}),h}),define("css!common-ui/lib/ui/shared/tooltip",[],function(){}),define("common-ui/lib/ui/shared/tooltip",["require","jquery","underscore","common-ui/lib/ui/shared/spinner","core/lib/log","backbone","common-ui/lib/helper/environment","common-ui/lib/ui/accessibility/lightbox_accessibility","core/lib/tr","mustache","core/lib/treatment","css!./tooltip.css"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/shared/spinner"),e=a("core/lib/log"),f=a("backbone"),g=a("common-ui/lib/helper/environment"),h=a("common-ui/lib/ui/accessibility/lightbox_accessibility"),i=a("core/lib/tr"),j=a("mustache"),k=a("core/lib/treatment");return a("css!./tooltip.css"),yam.TooltipManager=function(){var a=null,l=null,m=!1,n=function(){this.delayTimeout=null,this.visible=!1};return n.prototype={defaults:{orientation:"top",delay:750,fadeTime:400,hideTime:200,className:"yj-tooltip-default",arrowPadding:4,arrowOffset:9,hideOnScroll:!0,showOnFocus:!0,showOnClick:!1,accessibilityLabel:i.t("tooltip")},startDelay:function(a,c,e,f){function h(a){var b;b=g.isIOS()?0:"number"==typeof f.delay?f.delay:i.defaults.delay,i.delayTimeout||(i.delayTimeout=setTimeout(function(){i.show(a,e,f)},b))}if(!m){var i=this;if("object"==typeof c){var j=b(c);if(j.is(":empty")){var k=setTimeout(function(){j.is(":empty")&&(i.spinner=new d,j.append(i.spinner.render().$el),i.show(j,e,f))},f.spinnerDelay);b(e).on("mouseleave",function(){clearTimeout(k)})}else h(j)}else h(c)}},show:function(a,d,g){if(!m){var k=this,n=b.extend({},this.defaults,g);if(this.visible===!0&&n.fixed===!0&&e.warn("There can only be one fixed tooltip at one time"),d=b(d),!d[0]||d.is(":hidden"))return!1;if(n.hoverOrigin){var o=d.find(n.hoverOrigin);if(0===o.length)return!1;d=o}clearTimeout(this.delayTimeout),clearTimeout(this.hideTimeout),this.delayTimeout=null;var p=b("<div class='yj-tooltip zindex-t5' style='display:none' role='tooltip'><div class='yj-tooltip-container'></div></div>"),q=b("div:first",p);n.treatAsDialog&&(p.attr("role","dialog"),p.find(".yj-tooltip-container").attr("role","document")),n.accessibilityLabel&&p.attr("aria-label",n.accessibilityLabel),q.addClass(n.contentClassName),q.html(a);var r;if(n.closeButton){var s='<a class="yj-close-link" href="javascript://" role="button" tabindex="-1"><span class="{{iconClass}}"><span class="yj-acc-hidden">{{closeLabel}}</span></span></a>';r=b(j.render(s,{iconClass:n.closeButton.icon,closeLabel:i.t("close")})),r.on("click",function(){k.hide({noFade:!0}),"function"==typeof n.onClose&&n.onClose()}),q.prepend(r),b(document.body).on("keydown.tooltip",function(a){27===a.which&&k.hide({noFade:!0})})}n.stayVisible&&!n.fixed&&p.hover(function(){clearTimeout(k.hideTimeout)},function(){k.hide(n)});var t=[n.className];"blue"===n.tooltipColor&&t.push("yj-blue-tooltip"),"small"===n.tooltipSize&&t.push("yj-sm-tooltip"),"wide"===n.tooltipSize&&t.push("yj-wide-tooltip"),n.arrowHTML||t.push("yj-tooltip-with-default-arrows"),p.addClass(t.join(" "));var u=this.$element;if(u&&u.remove(),this.$element=p.appendTo("body"),this._opts=n,this._target=d,this.visible=!0,this.position(),n.forceModal&&h.beforeModalShow(),p.fadeIn(n.fadeTime),n.forceModal){h.afterModalShow(p[0],r[0]);var v=function(a){b.contains(p[0],a.target)||k.hide({noFade:!0})};b(document.body).on("mousedown.tooltip",v),b(document.body).on("focusin.tooltip",v)}f.trigger("/ui/tooltip/visible",d),n.hideOnScroll&&b(window).on("scroll.tooltip",c.bind(function(){if(k===l){var a=b(window).scrollTop()>p.position().top+p.outerHeight()+100;a&&this.hide({fadeTime:100})}else this.hide({noFade:!0})},this)),yam.router&&yam.router.on("route",function(){this.hide({noFade:!0})},this)}},getTarget:function(){return this._target},position:function(){if(!m&&this.visible){var a=this.$element,c=a.outerWidth(),d=a.outerHeight(),e=this._target,f=e.outerWidth(),g=e.outerHeight(),h=e.offset(),i=h.left,j=h.top,k=this._opts,l=k.orientation,n="left"===l,o="right"===l,p="top"===l,q=!n&&!o&&!p,r="left"===k.align,s="right"===k.align;p&&d>j-b(window).scrollTop()&&(p=!p,q=!q),!r&&0>i-c/2?(r=!0,s=!1):!s&&c+i>b(window).width()&&(s=!0,r=!1);var t=n?"yj-left":o?"yj-right":r?"yj-tooltip-align-left":s?"yj-tooltip-align-right":"yj-tooltip-align-x-center",u=p?"yj-top":q?"yj-bottom":"yj-tooltip-align-y-center";a.addClass(t+" "+u);var v="small"===k.tooltipSize,w="yamicon-"+(n?"right-arrow":o?"left-arrow":p?"down-arrow":"up-arrow");w+=v?" small":"";var x=b(k.arrowHTML||"<span class='yj-tooltip-icon yamicon "+w+"'></span>"),y=this.$arrow;y&&y.remove(),this.$arrow=x.appendTo(a);var z,A,B=k.arrowPadding,C=k.arrowOffset,D=i+(n?-c-B:o?f+B:r?-parseInt(a.css("paddingLeft"),10)-C:s?f-c+C/2+parseInt(a.css("paddingLeft"),10):f/2-(c-parseInt(a.css("paddingLeft"),10))/2),E=j+(p?-d-B:q?g+B:g/2-d/2);(n||o)&&(z=E-b(window).scrollTop()+d,A=b(window).height(),z>A&&(a.addClass("is-adjusted"),E-=z-A+1)),a.css({left:Math.floor(D)+"px",top:Math.floor(E)+"px"})}},hide:function(a){if(!m){a=a||{};var c="number"==typeof a.fadeTime?a.fadeTime:this.defaults.fadeTime,d=this,e=a.hideTime||this.defaults.hideTime,g=d.$element;clearTimeout(this.delayTimeout),this.delayTimeout=null;var i=this._opts&&this._opts.forceModal;a.noFade||0===a.fadeTime?(g&&g.hide(),this.visible=!1,d._opts={},f.trigger("/ui/tooltip/hidden")):(clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout(function(){g&&g.fadeOut(c,function(){d.visible=!1,d._opts={}}),f.trigger("/ui/tooltip/hidden")},e)),i&&(h.afterModalDone(),b(document.body).off("mousedown.tooltip"),b(document.body).off("focusin.tooltip")),b(window).off("scroll.tooltip"),yam.router&&yam.router.off(null,null,this),b(document.body).off("keydown.tooltip")}}},{addTooltip:function(a,d,e){function f(a){var b=d;return"function"==typeof d&&(b=d(a),l.validHTML||(b=c.escape(b))),b}function g(a){m.hide(c.extend({},l,{noFade:!0})),m.startDelay(a,f(a),this,l),m._opts=l}function h(){o.unbind("mousemove.tooltip"),m.hide(l)}function i(a){m.hide(c.extend({},l,{noFade:!0})),m.startDelay(a,f(a),this,l),m._opts=l}function j(){m.hide(l)}var l={};"string"==typeof e?l.orientation=e:"object"==typeof e&&(l=e);var m=this.getTooltip(l),n="object"==typeof a&&a.node&&a.delegateString;n?a.node instanceof b||(a.node=b("#"+a)):a instanceof b||(a=b("#"+a)),"function"!=typeof d&&(void 0===d&&a.attr("title")?(d=a.attr("title"),d=c.escape(d)):l.validHTML||(d=c.escape(d)));var o;return n?(o=a.node,o.delegateString=a.delegateString):(o=a,o.delegateString=null),l.fixed?m.show(f(),a,l):(o.off(".tooltip",o.delegateString).on("mouseenter.tooltip",o.delegateString,g).on("mouseleave.tooltip",o.delegateString,h),l.showOnClick&&o.on("click.tooltip",function(){o.off("mouseleave.tooltip mouseenter.tooltip"),m.show(f(),a,c.extend(l,{fixed:!0,forceModal:!0}))}),k.treatment("keyboard_tooltips")&&l.showOnFocus!==!1&&o.addClass("yj-want-focuswithin").on("yj-focusenter.tooltip",o.delegateString,i).on("yj-focusleave.tooltip",o.delegateString,j),o.addClass("yj-tooltip-target")),o},hideAndRemoveTooltip:function(a){this.hideTooltipWithTarget(a),this.removeTooltip(a)},removeTooltip:function(a){b(a).off(".tooltip")},hideTooltip:function(){m=!1,a&&a.hide({fadeTime:0}),l&&l.hide({fadeTime:0})},_isInstanceVisibleAndAttachedToTarget:function(a,b){return a.visible&&a.getTarget().get(0)===b.get(0)},hideTooltipWithTarget:function(b){m=!1,a&&this._isInstanceVisibleAndAttachedToTarget(a,b)&&a.hide({fadeTime:0}),l&&this._isInstanceVisibleAndAttachedToTarget(l,b)&&l.hide({fadeTime:0}),clearTimeout(this.getTooltip().delayTimeout)},getTooltip:function(b){return b=b||{},b.fixed?l=l?l:new n:a=a?a:new n},position:function(){var a=this.getTooltip();a.position()},show:function(a,b,c){var d=this.getTooltip();d.show(a,b,c)},_destroyTooltips:function(){var b;a&&(b=a.$element,b&&b.remove(),a=null),l&&(b=l.$element,b&&b.remove(),l=null)},subscribe:function(){f.on("/ui/tooltip/add",function(a){this.addTooltip(a.target,a.text,a)},this),f.on("/ui/tooltip/remove",function(a){this.hideTooltipWithTarget(a.target),this.removeTooltip(a.target,a)},this),f.on("/ui/tooltip/hide",this.hideTooltip,this),f.on("/ui/tooltip/position",function(){this.getTooltip().position(),l&&l.position()},this),f.on("/ui/tooltip/lock",function(){m=!0},this),f.on("/ui/tooltip/unlock",function(){m=!1},this),this._repositon=b(window).on("resize",c.throttle(function(){f.trigger("/ui/tooltip/position")},100)),f.on("/ui/tooltip/contentLoaded",function(a,b,c){this.spinner&&this.spinner.destroy(),this.show(a,b,c)},this)},unsubscribe:function(){f.off("/ui/tooltip/add",null,this),f.off("/ui/tooltip/position",null,this),f.off("/ui/tooltip/hide",null,this),f.off("/ui/tooltip/remove",null,this),f.off("/ui/tooltip/lock",null,this),f.off("/ui/tooltip/unlock",null,this),f.off("/ui/tooltip/contentLoaded",null,this),b(window).off("resize",this._repositon)}}}()}),define("stache!feeds/lib/ui/shared/thumbnail_item_viewer",["mustache"],function(a){var b='<div class="yj-create">\n  {{#showGroup}}\n  <span class="yj-create-text-wrap">\n    <span class="yj-create-text"></span>\n    <span class="yj-inline-icon yj-align-icon crumb-arrow-icon"></span>\n  </span>\n  {{/showGroup}}\n  {{#canUpload}}\n  <a data-action-type="file" class="yj-btn yj-btn-secondary yj-create-link yj-inline-icon yj-align-icon" href="javascript://" role="button"><span>{{createLinkText}}</span></a>\n  {{/canUpload}}\n  {{#canCreatePage}}\n  <a data-action-type="page" class="yj-btn yj-btn-secondary yj-create-link yj-inline-icon yj-align-icon" href="javascript://" role="button"><span>{{createPageText}}</span></a>\n  {{/canCreatePage}}\n</div>\n<ul class="yj-thumbnail-list"></ul>\n<div class="yj-tabular-notice yj-thumbnail-view-notice"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/shared/thumbnail_item_viewer_item",["mustache"],function(a){var b='<li class="yj-thumbnail-item">\n  <a class="yj-thumbnail-item-link {{#showFileIcon}}yj-thumbnail-with-file-icon{{/showFileIcon}} yj-enhanced-tooltip" tooltip-content-id="yj-thumb-tip-{{rowId}}" data-has-preview="{{#hasPreview}}true{{/hasPreview}}{{^hasPreview}}false{{/hasPreview}}" href="{{previewUrl}}" title="" data-id="{{dataId}}" data-row-id="{{rowId}}">\n    <img class="yj-thumbnail-item-image" src="{{thumbnailUrl}}" alt="{{nameTruncatedShort}}">\n    {{#showFileIcon}}\n      <span class="yj-file-type-overlay">{{extension}}</span>\n    {{/showFileIcon}}\n  </a>\n  <div id="yj-thumb-tip-{{rowId}}" class="yj-tooltip-content">\n    <a href="{{webUrl}}" title="{{name}}">{{nameTruncatedLong}}</a>\n    <div class="yj-info-bubble-content">\n      {{{groupHtml}}}\n      <div class="yj-info-bubble-text">{{{uploadText}}}</div>\n    </div>\n    <span class="yj-info-bubble-arrow"></span>\n  </div>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/shared/thumbnail_item_viewer",[],function(){}),define("feeds/lib/ui/shared/thumbnail_item_viewer",["require","jquery","underscore","core/lib/date_helper","feeds/lib/ui/attachments/yamio_preview","backbone","core/lib/string_helper","core/lib/tr","core/lib/session","feeds/lib/ui/shared/tabular_item_viewer","feeds/lib/ui/selectors/templates_helper","mustache","core/lib/urls","common-ui/lib/ui/shared/tooltip","html!./thumbnail_item_viewer","html!./thumbnail_item_viewer_item","css!./thumbnail_item_viewer"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/date_helper"),e=a("feeds/lib/ui/attachments/yamio_preview"),f=a("backbone"),g=a("core/lib/string_helper"),h=a("core/lib/tr"),i=a("core/lib/session"),j=a("feeds/lib/ui/shared/tabular_item_viewer"),k=a("feeds/lib/ui/selectors/templates_helper"),l=a("mustache"),m=a("core/lib/urls");a("common-ui/lib/ui/shared/tooltip");var n=a("html!./thumbnail_item_viewer"),o=a("html!./thumbnail_item_viewer_item");return a("css!./thumbnail_item_viewer"),j.extend({className:"yj-item-viewer yj-thumbnail-item-viewer",events:c.extend({"click .yj-thumbnail-item-link":"_showPreview"},j.prototype.events),render:function(){this.$el.html(n({createLinkIcon:this.createLinkIcon,createLinkText:this.createLinkText,canUpload:this.showCreateLink,canCreatePage:this.canCreatePage,
createPageText:this.createPageText,showGroup:this.showGroup})),this.$create=this.$(".yj-create"),this.$createLink=this.$(".yj-create-link"),this.$table=this.$(".yj-thumbnail-list"),this.$notice=this.$(".yj-tabular-notice"),this.showCreateLink||this.$(".crumb-arrow-icon").hide(),this.$contentArea=this.$table,this._setToolTips()},_setToolTips:function(){var a=".yj-thumbnail-item",d=function(c){var d=b(c.target),f=d.hasClass(a.substr(1))?d:d.parents(a),g=f.siblings().addBack().index(f);return e(a+g,f)},e=c.memoize(function(a,b){return b.find(".yj-tooltip-content").html()}),g={target:{node:this.$table,delegateString:a},text:d,delay:0,fadeTime:10,className:"yj-info-bubble",stayVisible:!0,validHTML:!0};f.trigger("/ui/tooltip/remove",{target:this.$table.find(a)}),f.trigger("/ui/tooltip/add",g)},displayItems:function(a){this._parent._triggeredMore||(this.spinner.hide(),this.$table.empty().show(),this._lastItemIndex=0);for(var b=0,c=a.length;c>b;b++)this.addItem(a[b]);this.toggleScrollbars(),this._parent._triggeredMore=!1,this._parent._nextURL?(this.moreButton.show(),this.moreButton.$link.removeClass("yj-loading")):this.moreButton.hide(),a.length>0&&a.length<6&&this.$table.addClass("yj-thumbnail-list-one-row")},displayItem:function(a,b){return o({webUrl:m.fileIndex(b),previewUrl:b.preview_url,hasPreview:b.preview_url&&!this.showSelection,thumbnailUrl:b.thumbnail_url||b.large_icon_url,showFileIcon:!b.thumbnail_url,rowId:a,name:b.name,nameTruncatedLong:g.truncate(b.name,30),nameTruncatedShort:g.truncate(b.name,15),extension:b.name.split(".").pop().toLowerCase(),dataId:b.id,groupHtml:this._itemGroup(b),uploadText:h.t("uploaded_uploaddate_uploader_2",{uploadDate:c.escape(d.formatAgo(new Date(b.last_uploaded_at),null,!0)),uploaderName:this._itemUploadedBy(b)})})},_itemGroup:function(a){if(a.external_share)return h.t("external_file_2");var b=k.getGroupTemplateData(a);return h.t("in_link_group",{link:'<a href="'+b.group_url+'" title="'+b.group_name+'">'+g.truncate(b.group_name,20)+"</a>"})},_itemUploadedBy:function(a){if(a.external_share)return"";var b;b=c.isEmpty(a.versions)?a.owner_id:c.first(a.versions).uploader_id;var d=this._parent._refs.user[b]||i.getCurrentUser(),e=' <a href="{{url}}" title="{{title}}">{{name}}</a>';return l.render(e,{url:m.userIndex(d,i),title:d.full_name,name:g.truncate(d.full_name,20)})},_checkOverflowX:function(a){var b=a.offset().left+a.outerWidth()+50,c=this.$el.offset().left+this.$el.outerWidth();return b>c},_checkOverflowY:function(a){var b=a.offset().top+a.outerHeight()+50,c=this.$el.offset().top+this.$el.height();return b>c},addItem:function(a,c){var d=b(this.displayItem(this._lastItemIndex,a));c?this.$table.prepend(d):(this.$table.append(d),this.$table.find(".yj-clear").remove(),this.$table.append('<li class="yj-clear"></li>')),this.$notice.hide(),this._lastItemIndex++,this._setToolTips()},_showPreview:function(a){var d=b(a.currentTarget);if("true"===d.attr("data-has-preview")){var g=c.find(this._parent.data,function(a){return a.id===parseInt(d.attr("data-id"),10)});g&&(f.trigger("/ui/tooltip/hide"),e.showOverlayForAttachment(g))}a.preventDefault()},handleSelection:function(a){var c=b(a.target).hasClass(".yj-thumbnail-item-link")?b(a.target):b(a.target).closest(".yj-thumbnail-item-link");return c.length&&(a.preventDefault(),this._$currentSelection&&this._$currentSelection.removeClass("yj-thumbnail-selected"),this.showSelection&&c.addClass("yj-thumbnail-selected"),this._$currentSelection=c),c}})}),define("stache!feeds/lib/ui/shared/type_filter",["mustache"],function(a){var b='{{#items}}<li class="yj-type-filter-item yj-tab yj-filter-tab" data-type="{{data}}"><a class="yj-type-filter-link yj-tab-link yj-filter-tab-link" title="" href="javascript://">{{text}}<span class="yj-acc-hidden"> {{tabAltText}}</span><span class="yj-acc-selectedstate"> {{selectedAltText}}</span></a></li>{{/items}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/shared/type_filter",["require","jquery","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/tr","html!./type_filter"],function(a){var b=a("jquery"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("backbone"),f=a("core/lib/tr"),g=a("html!./type_filter");return c.extend({mixins:[d],tagName:"ul",className:"yj-type-filter yj-tabs",defaults:{contentClickHandler:function(){},menuItems:[]},template:g,events:{click:"contentClickHandler","click .yj-type-filter-item":"onTabClick"},initialize:function(a){this._activeClass="yj-selected",this.contentClickHandler=a.contentClickHandler,this.menuItems=a.menuItems,this.delegateEvents(),e.on("/ui/SidebarNavigator/selection",function(){this.resetMenu()},this)},getTemplateData:function(){return{items:this.menuItems,selectedAltText:f.t("selected"),tabAltText:f.t("tab")}},render:function(){return this.$(".yj-type-filter-item:first").addClass(this._activeClass),this},remove:function(){e.off("/ui/SidebarNavigator/selection",null,this)},resetMenu:function(){this._selectTab(this.$(".yj-type-filter-item:first"))},onTabClick:function(a){this._selectTab(a.currentTarget)},_selectTab:function(a){this.$("."+this._activeClass).removeClass(this._activeClass),b(a).addClass(this._activeClass)}})}),define("stache!feeds/lib/ui/attachments/upload_progress_bar",["mustache"],function(a){var b='<div class="yj-progress-bar-inner-container yj-float-left">\n  <div class="yj-progress-bar">&nbsp;</div>\n</div>\n<button class="yj-progress-bar--cancel-button yj-cancel-button yj-attachment-remove-progress yj-float-left yj-remove-button unstyle-button-as-span">\n  <span class="yamicon yamicon-x">\n    <span class="yj-acc-hidden">{{remove}}</span>\n  </span>\n</button>\n<p class="yj-progress-text">\n  <span class="file-name"></span>\n  <span class="percent">0</span>%\n  <span class="status">{{uploading}}</span>\n</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/attachments/upload_progress_bar",[],function(){}),define("feeds/lib/ui/attachments/upload_progress_bar",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_show_hide","backbone","core/lib/string_helper","core/lib/tr","html!./upload_progress_bar","core/lib/namespace","css!./upload_progress_bar"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_show_hide"),e=a("backbone"),f=a("core/lib/string_helper"),g=a("core/lib/tr"),h=a("html!./upload_progress_bar"),i=a("core/lib/namespace");return a("css!./upload_progress_bar"),i.ns("yam.ui.attachments"),yam.ui.attachments.UploadProgressBar=b.extend({mixins:[c,d],template:h,events:{"click .yj-cancel-button":"cancel"},className:"yj-progress-bar-container",initialize:function(a){this.file=a.file,this.uploader=a.uploader},render:function(){if(b.prototype.render.call(this),this.file){var a=f.truncate(this.file.name,12,{file:!0});this.$el.find(".yj-progress-text .file-name").text(a)}return this},getTemplateData:function(){var a={remove:g.t("remove"),uploading:g.t("uploading")};return a},cancel:function(a){a&&a.preventDefault(),this.uploader.remove(this.file),this.hide(),e.trigger("/ui/lightbox/resize")},update:function(a){var b=this.$el.find(".yj-progress-bar-inner-container");this.$el.find(".yj-progress-bar").width(b.width()/100*a),this.$el.find(".yj-progress-text .percent").text(a);var c=f.truncate(this.file.name,12,{file:!0});this.$el.find(".yj-progress-text .file-name").text(c),100==a&&this.$el.find(".yj-progress-text .status").text("(processing)")}}),yam.ui.attachments.UploadProgressBar}),define("css!feeds/lib/ui/attachments/fileville_upload_preview",[],function(){}),define("stache!feeds/lib/ui/attachments/fileville_upload_preview",["mustache"],function(a){var b='<span class="yamicon {{iconType}} yj-upload-img"></span>\n<span class="yj-label" title="{{fileName}}">{{abbreviatedFileName}}</span>\n<span class="yj-file-processing">{{labelProcessing}}</span>\n{{#details}}\n    <a href="javascript://" class="yj-file-details-button" style="display:none">\n      <span class="detail-right-arrow-icon yj-inline-icon"></span>{{labelDetails}}\n    </a>\n{{/details}}\n<a href="javascript://" class="yj-remove-button yj-close-link">\n  <span class="yamicon yamicon-x"><span class="yj-acc-hidden">{{removeText}}</span></span>\n</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/fileville_upload_preview",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","feeds/lib/ui/attachments/yamio_preview","core/lib/namespace","core/lib/string_helper","core/lib/filename_helper","core/lib/tr","css!feeds/lib/ui/attachments/fileville_upload_preview","html!./fileville_upload_preview"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("backbone"),f=a("feeds/lib/ui/attachments/yamio_preview"),g=a("core/lib/namespace"),h=a("core/lib/string_helper"),i=a("core/lib/filename_helper"),j=a("core/lib/tr");a("css!feeds/lib/ui/attachments/fileville_upload_preview"),g.ns("yam.ui.attachments");var k=c.extend({mixins:[d],events:{"click .yj-remove-button":"close","click .yj-file-details-button":"toggleDetails"},className:"yj-pending-attachment",template:a("html!./fileville_upload_preview"),extToYamicon:{doc:"yamicon-doc",xls:"yamicon-excel",ppt:"yamicon-powerpoint",ai:"yamicon-illustrator",swf:"yamicon-flash",mov:"yamicon-tv",image:"yamicon-picture",mp3:"yamicon-music-doc",zip:"yamicon-zip",adp:"yamicon-doc",fla:"yamicon-flash",html:"yamicon-code-doc",pdf:"yamicon-doc",php:"yamicon-code-doc",psd:"yamicon-photoshop",pst:"yamicon-doc",txt:"yamicon-doc",default:"yamicon-doc"},options:{detailsOpen:!1},initialize:function(a){a=a||{},this.file=a.file||{},delete a.file,this.options=b.extend({},this.options,a)},iconType:function(){return this._isImage()?"yamicon-picture":this._isVideo()?"yamicon-tv":this._yamiconExtenstion()},remove:function(){this.details&&this.details.destroy()},showDetails:function(){var a=this.$el.find(".yj-file-details-button");this.$el.find(".yj-yamio-preview").show(),a.find(".detail-right-arrow-icon").removeClass("detail-right-arrow-icon").addClass("detail-down-arrow-icon"),this.options.detailsOpen=!0,this.$el.trigger("resize")},hideDetails:function(){var a=this.$el.find(".yj-file-details-button");a.find(".detail-down-arrow-icon").removeClass("detail-down-arrow-icon").addClass("detail-right-arrow-icon"),this.$el.find(".yj-yamio-preview").hide(),this.options.detailsOpen=!1,e.trigger("/ui/lightbox/resize")},refreshDetails:function(a){if(!a)return this.details.destroy(),!1;this.fileData=a;var b=new f(this.fileData,{isUploadPreview:!0,noHoverbar:!0,noClick:!0});b._overlay=!0,b._displayFilename=!0,b._displaySubtitle=!1,b._displayDetailAction=!1,b._displayFollowButton=!1,b._displayActions=!1,b._displayPreview=this.options.displayPreview,this.$el.append(b.render()),b.hide();var c=this;b.$element.find(".yj-thumbnail img").load(function(){c.details.destroy(),c.details=b,b.show(),e.trigger("/ui/lightbox/resize")}).on("error",function(){c.details.destroy(),c.details=b,b.show()})},createDetails:function(){if(this.details)return this.details;var a=new f(this.fileData,{isUploadPreview:!0,defaultToLoadingIcon:!0,noHoverbar:!0,noClick:!0});return a._overlay=!0,a._displayFilename=!0,a._displaySubtitle=!1,a._displayDetailAction=!1,a._displayFollowButton=!1,a._displayActions=!1,a._displayPreview=this.options.displayPreview,this.details=a,this.$el.append(a.render()),this.hideDetails(),this.details},toggleDetails:function(){return this.completed?void(this.options.detailsOpen?this.hideDetails():this.showDetails()):!1},hasDetails:function(){return this._isImage()||this._isVideo()||this._isPreviewable()},getTemplateData:function(){var a={fileName:this.file.name,abbreviatedFileName:h.truncate(this.file.name,20,{file:!0}),iconType:this.iconType(),details:this.hasDetails(),removeText:j.t("remove_remove_pending_attachment"),labelDetails:j.t("details"),labelProcessing:j.t("processing")};return a},close:function(){this.$el.hide(),this.trigger("close"),this.$el.trigger("resize")},failed:function(){this.remove()},complete:function(a){var b=this;this.fileData=a,this.completed=!0,"Video"===this.fileData.content_class?this.$el.find(".yj-file-processing").text(""):this.$el.find(".yj-file-processing").text(j.t("done_2")),this.hasDetails()&&(this.createDetails(),this.$el.trigger("resize"),this.$el.find(".yj-thumbnail img").load(function(){b.$el.find(".yj-file-details-button").show(),b.showDetails()}))},_extension:function(){return i.getCanonicalExtension(this.file.name)},_yamiconExtenstion:function(a){return a||(a=this._extension(this.file.name)),this.extToYamicon[a]?this.extToYamicon[a]:"yamicon-doc"},_isImage:function(){var a=this._extension();return"image"===a},_isVideo:function(){var a=this._extension();return"mov"===a||"swf"===a},_isPreviewable:function(){var a={doc:!0,docx:!0,ppt:!0,pptx:!0,pdf:!0};return a[this._extension()]}});return yam.ui.attachments.FileVilleUploadPreview=k,yam.ui.attachments.FileVilleUploadPreview}),define("stache!feeds/lib/ui/files/upload_dialog",["mustache"],function(a){var b='<div class="uploader">\n  <div>\n    <div class="yj-attach-label">{{select_file_label}}</div>\n    <button class="yj-file-attachment-menu-item yj-btn yj-btn-alt yj-clearfix">{{choose_file_label}}</button>\n  </div>\n  <div class="yj-upload-display yj-attachments-container">\n    <div class="yj-file-previews"></div>\n    <div class="yj-attached-files"></div>\n  </div>\n  <div class="yj-button-bar">\n    <button class="yj-btn yj-btn-disabled yj-upload-form-submit" disabled>{{upload_label}}</button>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/files/upload_dialog",[],function(){}),define("feeds/lib/ui/files/upload_dialog",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","collections/groups","core/lib/namespace","backbone","core/lib/tr","common-ui/lib/helper/ui","feeds/lib/ui/attachments/uploader","feeds/lib/ui/attachments/upload_progress_bar","feeds/lib/ui/attachments/fileville_upload_preview","html!./upload_dialog","css!./upload_dialog"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("collections/groups"),h=a("core/lib/namespace"),i=a("backbone"),j=a("core/lib/tr"),k=a("common-ui/lib/helper/ui");a("feeds/lib/ui/attachments/uploader"),a("feeds/lib/ui/attachments/upload_progress_bar"),a("feeds/lib/ui/attachments/fileville_upload_preview");var l=a("html!./upload_dialog");return a("css!./upload_dialog"),h.ns("yam.ui.file"),yam.ui.file.UploadDialog=c.extend({mixins:[d,e,f],events:{"click .yj-upload-form-submit.yj-btn-enabled":"submit"},className:"yam-ui-file-upload-dialog",template:l,initialize:function(a){this.feed=a.feed,this.file=a.file,this.extensions=a.extensions,this.filePreviews=[],this.progressBars=[]},getTemplateData:function(){return{select_file_label:j.t("select_a_file"),choose_file_label:j.t("choose_file"),upload_label:j.t("upload")}},render:function(){var a=this.$(".yj-file-attachment-menu-item"),b={handleUpload:function(){},handleFileUpload:this.handleFileUpload.bind(this),handleUploadFinish:this.handleUploadFinish.bind(this),handleUploadProgress:this.handleUploadProgress.bind(this),handleFilesAdded:this.handleFilesAdded.bind(this),handleUploadCancel:function(){},handleUploadError:this.handleUploadError.bind(this),handleEncodingComplete:this.handleEncodingComplete.bind(this)},c={button:a,container:this.$(".uploader"),eventDelegate:b,feedId:this.feed,fileId:this.file,extensions:this.extensions},d=g.get(this.feed);d&&(c.networkId=d.get("network_id")),this.$submit=this.$(".yj-upload-form-submit");var e=this;return i.once("/ui/lightbox/open",function(){e.uploader=new yam.ui.attachments.FileVilleUploader(c)}),this},remove:function(){return this.uploader&&this.uploader.destroy&&this.uploader.destroy(),b(this.filePreviews).each(function(a){a.remove()}),c.prototype.remove.call(this)},disable:function(){this.$submit.addClass("yj-btn-disabled").removeClass("yj-btn-enabled").prop("diabled",!0)},enable:function(){this.$submit.removeClass("yj-btn-disabled").addClass("yj-btn-enabled").prop("disabled",!1)},submit:function(){this.uploader.complete(function(a,c){var d=b.keys(c.files).length;void 0!==c._uploader&&(d=b.keys(c._uploader.files).length),i.trigger("/ui/alert/show","notice",d>1?j.t("the_files_have_been_uploaded"):j.t("the_file_has_been_uploaded")),k.shiftCount("#yj-group-files-link .yj-tab-counter",d)}),i.trigger("/ui/lightbox/close")},addFile:function(a){var b=new yam.ui.attachments.UploadProgressBar({file:a,uploader:this.uploader});this.progressBars.push(b),this.$(".yj-attached-files").append(b.$el),b.render(),i.trigger("/ui/lightbox/resize")},findPreview:function(a){var c=b.find(this.filePreviews,function(b){return b.file===a});return c},showPreview:function(a){if(!this.findPreview(a)){var c=new yam.ui.attachments.FileVilleUploadPreview({file:a});this.filePreviews.push(c),this.append(c),this.$(".yj-file-previews").append(c.render().el),i.trigger("/ui/lightbox/resize");var d=this;c.on("close",function(){d.uploader.remove(a),i.trigger("/ui/lightbox/resize"),b.keys(d.uploader.files).length||d.disable()})}},findProgressBar:function(a){var c=b.find(this.progressBars,function(b){return b.file===a});return c},handleFileUpload:function(a,b){var c=this.findPreview(a);c.complete(b),i.trigger("/ui/lightbox/resize")},handleUploadFinish:function(){b.keys(this.uploader.files).length&&this.enable()},handleEncodingComplete:function(a,b){var c=this.findPreview(a);c&&c.refreshDetails(b),i.trigger("/ui/lightbox/resize")},handleUploadError:function(a){var b=this.findPreview(a);null!=b&&(b.failed(),i.trigger("/ui/lightbox/resize"))},handleUploadProgress:function(a){var b=this.findProgressBar(a);b&&(a.percent<100?b.update(a.percent):(b&&b.hide(),this.showPreview(a)))},handleFilesAdded:function(a){b.each(a,this.addFile,this)}})}),define("stache!feeds/lib/ui/shared/simple_menu",["mustache"],function(a){var b='<div class="yj-simple-menu-button-container">{{{button}}}</div>\n<div class="yj-simple-menu-content" style="display: none;">{{{menuContent}}}</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/shared/simple_menu",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/ui/accessibility/menu_accessibility","html!./simple_menu"],function(a){var b,c=a("jquery"),d=a("underscore"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("common-ui/lib/ui/accessibility/menu_accessibility"),h=a("html!./simple_menu");return c(document).bind("click.SimpleMenu",function(a){var c=b.current;c&&c._visible&&(b._isOriginalEventReference.call(c,a)||d.defer(function(){c.hideMenu()}))}),b=e.extend({mixins:[f],template:h,options:{align:"left",zIndexFix:!1},events:{"click .yj-simple-menu-button-container":"handleClick","SimpleMenuClick .yj-simple-menu-button-container":"handleClick","click .yj-simple-menu-content":"contentClickHandler"},initialize:function(a){this.options=d.extend({},this.options,a),this.contentClickHandler=this.options.contentClickHandler,this.delegateEvents(),this.$el.addClass(b.className),this._visible=!1,this._targ=null,this.$buttonContainer=null,this.$menuContent=null},getTemplateData:function(){return{button:"string"==typeof this.options.button?this.options.button:"",menuContent:"string"==typeof this.options.menuContent?this.options.menuContent:""}},render:function(){if(this.$buttonContainer=this.$(".yj-simple-menu-button-container"),this.$menuContent=this.$(".yj-simple-menu-content"),"string"!=typeof this.options.button&&this.$buttonContainer.append(this.options.button),this.options.zIndexFix){var a="number"==typeof this.options.zIndexFix?this.options.zIndexFix:19;this.$el.css("zIndex",a)}return this},handleClick:function(a){"click"===a.type?(b._saveOriginalEventReference.call(this,a),c(a.currentTarget).trigger("SimpleMenuClick")):(this.toggleMenu(a),a.stopPropagation())},toggleMenu:function(a){this._visible?this.hideMenu():this.$buttonContainer.get(0)===a.target&&this.showMenu()},showMenu:function(){this.trigger("showMenu");var a=b.current;a&&a.hideMenu(),b.current=this,this._visible=!0,this.$menuContent.css({position:"absolute",top:this.$buttonContainer.outerHeight()+"px"}),"right"===this.options.align&&(this.$menuContent.css({right:"0"}),this.$el.css({position:"absolute",right:"0"})),this.$menuContent.show(),this.toggleElement(),g.afterMenuShow(this.$menuContent[0],d.bind(function(){this.hideMenu()},this))},hideMenu:function(){this.trigger("hideMenu"),this._visible=!1,this.$menuContent.hide(),this.toggleElement(),g.afterMenuDone(this.$menuContent[0])},toggleElement:function(){var a="addClass",b="addContainerOverflowFix",c="menu.opened";this._visible||(a="removeClass",b="removeContainerOverflowFix",c="menu.closed"),this.$el[a]("yj-open"),this[b](),this.$menuContent.trigger("resize"),this.$el.trigger(c)},addContainerOverflowFix:function(){var a,b,d,e;this.$fixContainer=this.$el.closest(".yj-scrollbar-fix"),this.$fixContainer.length&&(a=this.$fixContainer.find(".yj-scrollbar-fix-spacer"),b=this.$menuContent.outerHeight(),a.length||(a=c('<div class="yj-scrollbar-fix-spacer"></div>'),this.$fixContainer.append(a)),d=a.outerHeight(),e=b-d,e>0&&a.css("height",b),this.$el.trigger("resize"))},removeContainerOverflowFix:function(){var a;this.$fixContainer||(this.$fixContainer=this.$el.closest(".yj-scrollbar-fix")),this.$fixContainer.length&&(a=this.$fixContainer.find(".yj-scrollbar-fix-spacer"),a.length&&a.remove())}},{current:null,className:"yj-simple-menu",_isOriginalEventReference:function(a){return this._targ===a.target},_saveOriginalEventReference:function(a){this._targ=a.target}})}),define("common-ui/lib/ui/shared/scroll_watcher",["require","underscore","jquery","core/lib/ctor","core/lib/log"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/ctor"),e=a("core/lib/log");return d(null,{defaults:function(){return{$contentArea:c(document.body),$scrollableArea:c(window),pollInterval:500,maxLoads:-1,isInstantUpdateAllowed:!1}},init:function(a){this.options=b.extend({},b.result(this,"defaults"),a),this.options.$scrollableArea instanceof jQuery||(this.options.$scrollableArea=c(window)),this.options.$contentArea instanceof jQuery||(this.options.$contentArea=c(document.body)),b.isFunction(this.options.onReached)||(this.options.onReached=function(){}),this._numLoads=0},start:function(){function a(){clearTimeout(b.timeout),b.scrolled?b.options.$contentArea.off("focusin.ScrollWatcher"):b.timeout=setTimeout(function(){b._checkOffset(),a()},b.options.pollInterval)}if(!(this.options.maxLoads>-1&&this._numLoads>=this.options.maxLoads)){var b=this;this.scrolled=!1,this.options.$contentArea.off("focusin.ScrollWatcher"),this.options.$contentArea.on("focusin.ScrollWatcher",function(){b.lastFocusChangeTime=new Date}),this._updateTrigger(),a()}},restart:function(){this._numLoads=0,this.start()},stop:function(){this.options.$contentArea.off("focusin.ScrollWatcher"),this.timeout&&clearTimeout(this.timeout)},_checkOffset:function(){var a=this._getScrollTop();a!=this.lastOffset&&(this.lastOffset=a,(!this.lastFocusChangeTime||new Date-this.lastFocusChangeTime>500)&&a>=this.triggerOffset&&this._scrolled(a))},_getScrollTop:function(){return this.options.$scrollableArea.scrollTop()},_scrolled:function(a){this.scrolled=!0,this.options.onReached(Math.round(a)),this._numLoads++,this.options.maxLoads>-1&&this._numLoads>=this.options.maxLoads&&(e.log("ScrollWatcher reached "+this.options.maxLoads+" loads, stopping"),this.stop())},_shouldUpdateInstantly:function(a,b){return this.options.isInstantUpdateAllowed&&2*b>a},_updateTrigger:function(){var a=this.options.$contentArea.height(),b=this.options.$scrollableArea.height();this._shouldUpdateInstantly(a,b)?this.triggerOffset=0:this.triggerOffset=Math.max(a-3*b,b),this.contentHeight=a,this.scrollableHeight=b}})}),define("common-ui/lib/ui/shared/navigator",["require","jquery","underscore","backbone","core/lib/jam/component","models/unknown","collections/groups","models/helpers/group","feeds/lib/ui/shared/sidebar_navigator","feeds/lib/ui/shared/thumbnail_item_viewer","feeds/lib/ui/shared/tabular_item_viewer","feeds/lib/ui/shared/type_filter","feeds/lib/ui/files/upload_dialog","core/lib/session","feeds/lib/ui/shared/simple_menu","common-ui/lib/ui/shared/scroll_watcher","common-ui/lib/ui/general/lightbox_manager","core/lib/secure_opener","core/lib/tr","core/lib/uri_helper","core/lib/yammer_request","core/lib/yammer_uri","core/lib/yammer_api","models/helpers/network","models/network","core/lib/urls","core/lib/location_helper"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/jam/component"),f=a("models/unknown"),g=a("collections/groups"),h=a("models/helpers/group"),i=a("feeds/lib/ui/shared/sidebar_navigator"),j=a("feeds/lib/ui/shared/thumbnail_item_viewer"),k=a("feeds/lib/ui/shared/tabular_item_viewer"),l=a("feeds/lib/ui/shared/type_filter"),m=a("feeds/lib/ui/files/upload_dialog"),n=a("core/lib/session"),o=a("feeds/lib/ui/shared/simple_menu"),p=a("common-ui/lib/ui/shared/scroll_watcher"),q=a("common-ui/lib/ui/general/lightbox_manager"),r=a("core/lib/secure_opener"),s=a("core/lib/tr"),t=a("core/lib/uri_helper"),u=a("core/lib/yammer_request"),v=a("core/lib/yammer_uri"),w=a("core/lib/yammer_api"),x=a("models/helpers/network"),y=a("models/network"),z=a("core/lib/urls"),A=a("core/lib/location_helper");return e.extend(new function(){var a=function(a){var b=this.defaults._groupApiBase+a.id+".json",c={id:this.defaults._dataName+"-group-"+a.id,full_title:a.get?a.get("full_name"):a.full_name,title:(a.get?a.get("full_name"):a.full_name)||(a.get?a.get("name"):a.name)||"",api:b};return c},B=function(a){var b=this.defaults._userApiBase+a.id+".json",c={id:this.defaults._dataName+"-user-"+a.id,full_title:a.full_name,title:a.full_name,api:b};return c},C=function(a){var b=this.defaults._topicApiBase+a.id+".json",c={id:this.defaults._dataName+"-topic-"+a.id,full_title:a.full_name,title:a.full_name||a.name||"",api:b};return c};this.defaults={id:"itemNavigator",_dataName:"",_navSections:[],_tableCols:[],_methods:{},_groupApiBase:"",_filterComponentId:"",_selectorComponentId:"",_typeFilterComponentId:"",_allCompanyGroupName:""},this.init=function(b,f){var g=b||{};g=c.extend({},this.defaults,g);var h=g.hasFilter,m=g.filterGroup,p=g.filterUser,q=g.filterTopic;if(this._filterMap={},this._selectorHookHandles=[],this._refs={},this._nextURL="",this._followedIds={},this._showCreateLink=this.isCreateLinkVisible(g),this.data=[],this.dataRequest=null,this.currentItem=null,this.childMap={},this.listener=c.extend({},d.Events),g.children=[],this.defaults._prototypeLazyInit||(this.lazyUserInit(),this.defaults._allCompanyGroupName=x.getCompanyGroupName(n.getCurrentNetwork())),h)m?this._filterMap[g._dataName+"-group-"+m.id]=a.call(this,m):p?this._filterMap[g._dataName+"-user-"+p.id]=B.call(this,p):q&&(this._filterMap[g._dataName+"-topic-"+q.id]=C.call(this,q));else{var r,t=n.getCurrentUser();r=g.groupId&&t.groupsMap[g.groupId]?"-group-"+g.groupId:"-user-accessed",g.children.push({id:g._filterComponentId,type:i,target:".yj-selector-filter",sections:g._navSections,showSidebarIcons:b.showSidebarIcons,defaultSelection:this.defaults._dataName+r}),this.defaults._prototypeLazyInit||this.lazyGroupInit()}if(this.buildFilterMap(),g.children.push({id:g._selectorComponentId,type:g._viewType&&"thumbnail"==g._viewType?j:k,target:".yj-selector-list",columns:g._tableCols,createLinkText:g._createLinkText,canCreatePage:!!g.fullWidthNavigator,createPageText:g._createPageText,showGroup:!g.fullWidthNavigator,minItems:g.fullWidthNavigator?10:null,createLinkIcon:g._createLinkIcon,tableClass:"yj-"+this.defaults._dataName+"-selector",showSelection:g.inLightbox,showCreateLink:this._showCreateLink,parent:this}),g.showTypeFilter){var u={id:g._typeFilterComponentId||"",type:"tabs"===g.filterMenuType?l:o,menuItems:[{text:s.t("documents"),data:"all"},{text:s.t("notes"),data:"pages"},{text:s.t("images"),data:"images"},{text:s.t("videos"),data:"videos"},{text:s.t("official_files"),data:"official"}],target:".yj-type-filter",button:'<a class="yj-simple-menu-trigger yj-type-filter-link" title="" href="javascript://" role="button" aria-haspopup="true"><span class="yj-type-filter-text">'+c.escape(g._typeFilterText)+'</span> <span class="yj-inline-icon down-arrow-grey-icon"></span></a>',menuContent:g._typeFilterMenuTemplate,contentClickHandler:g._typeFilterClickHandler.bind(this)};g.children.push(u)}e.prototype.init.call(this,g,f),this.defaults._prototypeLazyInit=!0,this.page=1},this.createElement=function(){var a=this.inLightbox?"yj-selector-in-lightbox":"yj-selector-in-page";this.hasFilter&&(a+="-no-nav"),this.filterGroup&&(a+=" yj-selector-no-group"),this.showTypeFilter&&(a+=" yj-selector-with-type-filter");var c='<div class="yj-selector-wrap '+a+'">';this.filterGroup||(c+='<div class="yj-selector-filter"></div>'),this.fullWidthNavigator?(c+='<div class="yj-selector-right-col"><h2 class="yj-type-filter-text"></h2><div class="yj-type-filter"></div>',c+='<div class="yj-attachments-selector-status-message"></div>',c+='<div class="yj-selector-list"></div><br class="yj-clear"></div></div>'):(c+='<div class="yj-type-filter"></div>',c+='<div class="yj-attachments-selector-status-message"></div>',c+='<div class="yj-selector-list yj-scrollbar-fix"></div></div>'),this.$element=b(c),this.$statusMessage=this.$element.find(".yj-attachments-selector-status-message")},this.afterRender=function(){for(var a,b=this.children,d=0,e=b.length;e>d;d++)a=b[d],this.childMap[a.id]=a;this.filterComponent=this.childMap[this.defaults._filterComponentId],this.selectorComponent=this.childMap[this.defaults._selectorComponentId],this.showTypeFilter&&(this.typeFilterComponent=this.childMap[this.defaults._typeFilterComponentId]),this.filterComponent&&(this.listener.listenTo(this.filterComponent,"navigate",c.bind(function(a){this.handleFilter(a)},this)),this.handleFilter(this.filterComponent.getSelectedItemId())),this.hookSelectorComponent(),this.$element.trigger("resize"),this.filterForView()},this.filterForView=function(){this.filterGroup?this.handleFilter(this.defaults._dataName+"-group-"+this.filterGroup.id):this.filterUser?this.handleFilter(this.defaults._dataName+"-user-"+this.filterUser.id):this.filterTopic&&this.handleFilter(this.defaults._dataName+"-topic-"+this.filterTopic.id)},this.hookSelectorComponent=function(){this.selectorComponent.on("select",this.handleSelect.bind(this)),this.selectorComponent.on("createItem",this.handleCreateItem.bind(this)),this.selectorComponent.on("more",this.handleClickedMore.bind(this));var a=this;this.infiniteScroll=new p({onReached:function(){c.bind(function(){this.infiniteScrollCallback=function(){this.selectorComponent.moreButton.$link.removeClass("yj-loading"),this.infiniteScroll.start()},this.selectorComponent.moreButton.$link.addClass("yj-loading"),this.handleMore()},a)()},$scrollableArea:a.inLightbox?a.$element.find(".yj-selector-list"):void 0,$contentArea:a.selectorComponent.$contentArea})},this.unhookSelectorComponent=function(){this.selectorComponent.off("select"),this.selectorComponent.off("createItem"),this.selectorComponent.off("more"),this.infiniteScroll.stop()},this.lazyUserInit=function(){for(var a,b,c,d=this.defaults._navSections,e=n.getCurrentUser().id,f=0,g=d.length;g>f;f++)switch(a=d[f],b=a.items,a.id){case"group":break;case"user":for(var h=0,i=b.length;i>h;h++)c=b[h],c.api=c.api.replace(":user_id",e);return}},this.selectedGroup=function(){var a=this.currentFilterId.match(/group-(\d+)/);
return a&&a[1]?a[1]:void 0},this.lazyGroupInit=function(){var b,c,d,e,f,h,i=this.defaults._navSections,j=n.getCurrentUser().group_memberships;if(n.getCurrentNetwork().is_group_enabled)for(f=0,h=i.length;h>f;f++)switch(b=i[f],d=b.items,b.id){case"group":d[0].title=this.defaults._allCompanyGroupName;for(var k=0,l=j.length;l>k;k++)c=g.add(j[k]),d.push(a.call(this,c));return;case"user":}else{for(f=0,h=i.length;h>f;f++)b=i[f],"group"===b.id&&(e=f);i.splice(e,1)}},this.buildFilterMap=function(){for(var a,b,c,d=this.defaults._navSections,e=0,f=d.length;f>e;e++){a=d[e],b=a.items;for(var g=0,h=b.length;h>g;g++)c=b[g],this._filterMap[c.id]=c}},this._getData=function(a,b,c){this.dataRequest&&this.dataRequest.abort();var d=this.handleData.bind(this),e=function(a){d(a,c)};if(a){var f={url:a,data:b,success:e,error:this.handleError.bind(this)};this.dataRequest=u.send(f)}},this.generateNextPageUrl=function(){var a=this._filterMap[this.currentFilterId],b=a.api,d=b.split("?"),e=d[0],f=t.objectify(d[1]||"");return c.extend(f,{page:this.page,content_class:this.filterClass}),v.api(e,f)},this.handleFilter=function(a){var b=this._filterMap[a],e=b.api,f=e.split("?"),g=f[0],h=t.objectify(f[1]||""),i={page:1};if(this.page=1,e){this.selectorComponentChanged&&(this.filterClass=null,this.resetSelectorComponent(),this.typeFilterComponent&&(this.typeFilterComponent instanceof d.View?this.typeFilterComponent.$(".yj-type-filter-text").text(this._typeFilterText):this.typeFilterComponent.$element.find(".yj-type-filter-text").text(this._typeFilterText))),this.filterClass&&(h.content_class=this.filterClass),this.currentFilterId=a,this.adjustSelectorComponent(),i=c.extend(i,h);var j=c.bind(function(){this.data=[],this._triggeredMore=!1,this._clickedMore=!1,this.onSelect(null),this.infiniteScroll.restart()},this);this._getData(v.api(g),i,j)}else d.trigger("/ui/alert/show","error","No API endpoint defined.")},this.adjustSelectorComponent=function(){if(this.selectorComponent.$notice.hide(),this.selectorComponent.moreButton&&this.selectorComponent.moreButton.hide(),this.selectorComponent.spinner&&(this.selectorComponent.$table.empty().hide(),this.selectorComponent.spinner.show(),this.selectorComponent.toggleScrollbars()),!this.inLightbox)if(this.hasFilter)this.selectorComponent.$create.css("display","block"),this.selectorComponent.$create.find(".yj-create-text-wrap").hide();else{var a,b="";(a=this.selectedGroup())?(this.currentGroup=c.find(n.getCurrentUser().group_memberships,function(b){return b.id==a}),b=this.currentGroup.full_name):(this.currentGroup=null,b=this.defaults._allCompanyGroupName),this.selectorComponent.$create.find(".yj-create-icon").hide(),this.selectorComponent.$create.find(".yj-create-text").text(b).end().css("display","block")}},this.handleNoData=function(a){this.selectorComponent.spinner&&this.selectorComponent.spinner.hide(),a&&this.selectorComponent.$notice&&this.selectorComponent.$notice.text(s.t("no_type_found",{type:this.defaults._dataType?this.defaults._dataType:this.defaults._dataName})).show()},this.handleSelect=function(){},this.handleCreateItem=function(a){if("page"!==b(a.currentTarget).data("actionType")&&"page"!==b(a.delegateTarget).data("actionType")&&"pages"!==this._dataName){var c,e,f=parseInt(this.selectedGroup(),10),h=f?this.filterGroup:null;!h&&this.currentGroup&&this.currentGroup.id===f&&(h=this.currentGroup);var i=f?h.full_name:x.getCompanyGroupName(n.getCurrentNetwork());if(!i&&f){var j=g.get(f);j&&(i=j.get("full_name"))}switch(this.filterClass){case"images":e=s.t("upload_an_image_to_group",{group:i});break;case"videos":e=s.t("upload_a_video_to_group",{group:i});break;case"documents":e=s.t("upload_a_document_to_group",{group:i});break;default:e=s.t("upload_a_file_to_group",{group:i})}this.filterGroup&&(c=parseInt(this.filterGroup.id,10)>0?this.filterGroup.id:null),q.openComponent(new m({feed:c}),"yj-quick-link-lightbox yj-scrollbar-fix",void 0,{title:e,overlayClose:!1,scrolling:!1})}else{var k=this.selectedGroup(),l=k?{group_id:k}:{},o=w.createNote(l);o.then(function(b){var c=z.noteEdit(b);a.metaKey||2===a.which?r.open(c):A.assign(c)}),o.fail(function(){d.trigger("/ui/alert/show","error",s.t("error_failed_to_create_note"))})}},this.handleClickedMore=function(){this._clickedMore=!0,this.infiniteScroll&&this.infiniteScroll.start(),this.handleMore()},this.handleMore=function(a){this._triggeredMore=!0,this._getData(this._nextURL,{}),a&&a.stopPropagation()},this.parseData=function(a){var b,d,e=a[this.defaults._dataName],h=c.union(a.references,a.external_references),i=a.meta;if(!e||!e.length)return this.handleNoData(1===this.page),{data:e,meta:i};for(var j=0,k=h.length;k>j;j++)b=h[j],d=this._refs[b.type]||{},d[b.id]=b,this._refs[b.type]=d;return c.each(h,function(a){"group"===a.type&&g.add(a)}),c.each(e,function(a){f.save(a)}),{data:e,meta:i}},this.prependOne=function(a){this.data.push(a),this.selectorComponent.addItem(a,!0)},this.handleData=function(a,b){var c,d,e;if(b&&b(),c=this.parseData(a),d="pages"!==this.filterClass?this.defaults._dataName.replace(/s$/,""):"page",e=c.meta["followed_"+d+"_ids"])for(var f=0,g=e.length;g>f;f++)this._followedIds[e[f]]=!0;this.data=this.data.concat(c.data),c.meta.pagination.is_last_page===!1?(this.page++,this._nextURL=this.generateNextPageUrl()):this._nextURL=null,this.selectorComponent.displayItems(c.data),this.afterHandleData()},this.getLockedStatus=function(a){var b={locked:!1},c=this.groupId&&a.group_id&&this.groupId===a.group_id,d=a.network_id!==n.getCurrentNetwork().id||a.external_share===!0,e="private"===a.privacy;return a.id===this.sourceId?(b.locked=!0,b.message="page"===this.getType()?s.t("a_note_cannot_be_related_to_itself"):s.t("a_file_cannot_be_related_to_itself")):!e&&!d||c||(b.locked=!0,d?b.message="page"===this.getType()?s.t("you_cannot_share_a_note_that_is_from_another_network"):s.t("you_cannot_share_a_file_that_is_from_another_network"):b.message="page"===this.getType()?s.t("private_notes_can_only_be_shared_within_their_group"):s.t("private_files_can_only_be_shared_within_their_group")),b},this.getGroupLockedStatus=function(){var a={locked:!1},b=this.selectedGroup();if(b){var c=parseInt(b,10),d=!!this.groupId&&this.groupId===c,e=g.get(c);if(e&&h.isForeign(e,n)&&!d){var f=h.getNetworkName(e,y);a.locked=!0,a.message="page"===this.getType()?s.t("you_cannot_share_notes_from_named_network",{network:f}):s.t("you_cannot_share_notes_from_named_network",{network:f})}else e&&h.isPrivate(e)&&!d&&(a.locked=!0,a.message="page"===this.getType()?s.t("private_notes_can_only_be_shared_within_their_group"):s.t("private_files_can_only_be_shared_within_their_group"))}return a},this.showStatusMessage=function(a){this.$statusMessage.html('<span class="yj-attachments-selector-status-message--icon yamicon yamicon-rd_info"></span><span class="yj-attachments-selector-status-message--text">'+a+"</span>")},this.clearStatusMessage=function(){this.$statusMessage.html("")},this.handleError=function(){console.log("Error",arguments),this.afterHandleData()},this.afterHandleData=function(){this.infiniteScrollCallback&&this.infiniteScrollCallback(),this._clickedMore&&(this.infiniteScroll.start(),this._clickedMore=!1)},this.isCreateLinkVisible=function(a){var b=!0,c=a.filterUser;return a.hasFilter&&(c?b=c.id===n.getCurrentUser().id:a.filterTopic&&(b=!1)),b},this.destroy=function(){this.listener.stopListening(),this.unhookSelectorComponent(),e.prototype.destroy.call(this)},this.onSelect=function(a,b){this.listener.trigger("onSelect",a,b)},this.onAct=function(a,b){this.listener.trigger("onAct",a,b)},this.getType=function(){},this.getTypeLabel=function(){}})}),define("stache!feeds/lib/ui/selectors/group",["mustache"],function(a){var b='<span>\n{{#in_lightbox}}\n  <span class="{{group_class}}" data-resource-id="{{group_id}}" data-resource-model="group">{{group_name}}</span>\n{{/in_lightbox}}\n{{^in_lightbox}}\n  <a class="{{group_class}}" data-resource-id="{{group_id}}" data-resource-model="group" href="{{group_url}}">{{group_name}}</a>\n{{/in_lightbox}}\n</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/files/selector",["require","jquery","underscore","components/avatar/index","mustache","core/lib/date_helper","collections/groups","feeds/lib/ui/attachments/yamio_preview","common-ui/lib/ui/shared/navigator","core/lib/filename_helper","core/lib/namespace","backbone","core/lib/session","core/lib/string_helper","core/lib/tr","core/lib/yammer_request","common-ui/lib/helper/environment","core/lib/yammer_api","feeds/lib/ui/selectors/templates_helper","feeds/lib/ui/shared/thumbnail_item_viewer","feeds/lib/ui/shared/tabular_item_viewer","feeds/lib/ui/shared/simple_menu","common-ui/lib/helper/ui","models/helpers/user","models/helpers/group","core/lib/urls","html!feeds/lib/ui/selectors/group"],function(a){var b=a("jquery"),c=a("underscore"),d=a("components/avatar/index"),e=a("mustache"),f=a("core/lib/date_helper"),g=a("collections/groups"),h=a("feeds/lib/ui/attachments/yamio_preview"),i=a("common-ui/lib/ui/shared/navigator"),j=a("core/lib/filename_helper"),k=a("core/lib/namespace"),l=a("backbone"),m=a("core/lib/session"),n=a("core/lib/string_helper"),o=a("core/lib/tr"),p=a("core/lib/yammer_request"),q=a("common-ui/lib/helper/environment"),r=a("core/lib/yammer_api"),s=a("feeds/lib/ui/selectors/templates_helper"),t=a("feeds/lib/ui/shared/thumbnail_item_viewer"),u=a("feeds/lib/ui/shared/tabular_item_viewer"),v=a("feeds/lib/ui/shared/simple_menu"),w=a("common-ui/lib/helper/ui"),x=a("models/helpers/user"),y=a("models/helpers/group"),z=a("core/lib/urls"),A=a("html!feeds/lib/ui/selectors/group");return i.extend(new function(){this.defaults={id:"fileSelector",_dataName:"files",_createLinkText:o.t("upload_file"),_createPageText:o.t("create_note"),_createLinkIcon:"inbox-upload-icon",_navSections:[{id:"all",header:null,items:[{id:"files-all",title:o.t("all_files_2"),api:"uploaded_files.json"}]},{id:"user",header:o.t("my_files_2"),items:[{id:"files-user-accessed",title:o.t("recently_accessed"),api:"uploaded_files/recently_accessed.json"},{id:"files-user-follow",title:o.t("files_i_follow"),api:"uploaded_files/followed_by/:user_id.json"},{id:"files-user-uploaded",title:o.t("files_i_uploaded"),api:"uploaded_files/uploaded_by/:user_id.json"}]},{id:"group",header:o.t("my_groups"),items:[{id:"files-all-company",title:"",api:"uploaded_files/in_group/company.json"}]}],_prototypeLazyInit:!1,_tableCols:[{title:o.t("name_header_for_file_name_column"),source:function(a,b,d){var f="private"===a.privacy,g=a.official,h=c.escape(a.name),i=j.getExtension(a.name),k=j.getCanonicalExtension(a.name),l=z.fileIndex(a),m=""!==i?h.replace(new RegExp("\\."+n.escapeRegExp(i)+"$"),""):h,p='<div class="{{contClass}}"><span class="yj-inline-icon document-{{ext}}-icon"></span> {{#official}}<span class="official-badge-small yj-inline-icon yj-enhanced-tooltip"><span class="yj-acc-hidden"> '+o.t("official")+' </span></span> {{/official}}{{#lightbox}}<a href="javascript://" title="{{{name}}}" class="{{itemClass}} unstyle-link-as-span">{{{name}}}<span class="yj-acc-selectedstate"> '+o.t("selected")+' </span></a> {{/lightbox}}{{^lightbox}}<a title="{{{name}}}" class="{{itemClass}}" href="{{url}}">{{{name}}}</a> {{/lightbox}}</div>{{#private}}<div class="yj-tabular-data-icon"><span class="yamicon-lock yamicon yamicon-xx-small yamicon-lock yamicon yj-dark-gray"></span></div>{{/private}}',q=e.render(p,{contClass:"yj-tabular-data-cont"+(f?" yj-private-cont":""),itemClass:"yj-tabular-data-name"+(f?" yj-private-name":""),name:m,ext:k,url:l,lightbox:this.inLightbox,private:f,official:g});d.html(q)}},{title:o.t("type_2"),source:function(a,b,c){var d=j.getExtension(a.name)||"";c.html(d)},headerStyle:"width: 50px;",dataStyle:"text-align: center;"},{title:o.t("group_2"),source:function(a,b,d){if(a.external_share)return void d.html('<span><em style="color:#999">'+o.t("external_file")+"</em></span>");var e=s.getGroupTemplateData(a),f=A(c.extend({in_lightbox:this.inLightbox},e));d.html(f)},headerStyle:"width: 15%;"},{title:o.t("last_uploaded_by"),source:function(a,b,e){if(!a.external_share){var f=this._refs.user[a.last_uploaded_by_id]||m.getCurrentUser(),g=c.escape(f.full_name),h=this.inLightbox?'<span class="yj-hovercard-link" data-resource-id="'+f.id+'">'+g+"</span>":'<a class="yj-tabular-user-link yj-hovercard-link" href="'+c.escape(f.web_url)+'" data-resource-id="'+f.id+'">'+g+"</a>",i=new d({model:f,withHovercard:!0,hideFromAccessibility:!0});e.append(i.render().$el),e.append(" "+h)}},headerStyle:"width: 20%;"},{title:o.t("last_uploaded_on"),source:function(a,b,c){var d,e=new Date(a.last_uploaded_at);e=f.formatAgo(e,null,!0),d='<div class="yj-tabular-last-uploaded-wrap"><div title="'+e+'" class="yj-tabular-last-uploaded">'+e+"</div>",this.inLightbox||a.external_share||(d+=' <button aria-haspopup="true" class="yj-simple-menu-trigger yj-btn yj-btn-alt yj-btn-tiny" data-selector-menu-link="true" data-speechtip> <span class="yj-down-arrow"><span class="yj-acc-hidden">'+o.t("actions")+"</span></span></button></div>"),c.attr("title",e),c.html(d)},headerStyle:"width: 20%;",dataStyle:"overflow: visible; padding: 0 3px 0 0;"}],_methods:{preview:function(){var a=this.currentItem;l.trigger("/ui/fancy-lightbox/open",{attachmentId:a.id,type:a.type,instance:a})},share:function(){var a=this.currentItem,b=c.extend({},a,{id:a.id,type:a.type,source:"files_tab_dropdown"});l.trigger("/ui/publisher/share-lightbox/open",{excerptOptions:b})},follow:function(){var a=this.currentItem,b=function(){l.trigger("/ui/alert/show","notice",o.t("you_are_now_following_name",{name:a.name})),x.followFile(m.getCurrentUser(),a.id),this._followedIds[a.id]=!0};r.subscribeToTarget({target_type:a.type,target_id:a.id}).then(b.bind(this))},unfollow:function(){var a=this.currentItem,b=function(){l.trigger("/ui/alert/show","notice",o.t("you_are_no_longer_following_name",{name:a.name})),x.unfollowFile(m.getCurrentUser(),a.id),delete this._followedIds[a.id]};r.unsubscribeFromTarget({target_type:a.type,target_id:a.id}).then(b.bind(this))},delete:function(a){var c=window.confirm(o.t("delete_file_warning_confirm",{linebreak:"\n"}));c&&p.send({type:"delete",dataType:"text",url:this.currentItem.url,success:function(){w.shiftCount("#yj-group-files-link .yj-tab-counter",-1),l.trigger("/ui/alert/show","notice",o.t("the_file_has_been_deleted")),b("[data-row-id="+a+"]").fadeOut("slow")},error:function(){l.trigger("/ui/alert/show","error",o.t("there_was_an_error_deleting_your_file"))}})}},_groupApiBase:"uploaded_files/in_group/",_userApiBase:"uploaded_files/uploaded_by/",_topicApiBase:"uploaded_files/with_topic/",_filterComponentId:"fileSelectorFilter",_selectorComponentId:"fileSelectorItems",showTypeFilter:!0,_typeFilterComponentId:"fileSelectorTypeFilter",_typeFilterText:o.t("all_file_types"),_typeFilterClickHandler:function(a){var c=b(a.target).closest(".yj-type-filter-list-item"),d=c.closest(".yj-type-filter");if(c.length){var e=c.attr("data-type");this.selectorComponentChanged=!1,this.filterClass="all"==e?null:e,this.resetSelectorComponent(),this.filterComponent?this.filterComponent.trigger("navigate",this.currentFilterId):this.filterForView(),this.selectorComponentChanged=!0,d.find(".yj-type-filter-text").text(c.text())}},_typeFilterMenuTemplate:'<ul class="yj-type-filter-list"><li class="yj-type-filter-list-item" data-type="all"><a class="yj-type-filter-list-link" title="" href="javascript://">'+o.t("all_file_types")+'</a></li><li class="yj-type-filter-list-item" data-type="documents"><a class="yj-type-filter-list-link" title="" href="javascript://">'+o.t("documents")+'</a></li><li class="yj-type-filter-list-item" data-type="images"><a class="yj-type-filter-list-link" title="" href="javascript://">'+o.t("images")+'</a></li><li class="yj-type-filter-list-item" data-type="videos"><a class="yj-type-filter-list-link" title="" href="javascript://">'+o.t("videos")+"</a></li></ul>"},this.init=function(a,b){var d=a||{},e=this;d=c.extend({},this.defaults,d),this.$actionsMenu=null,this.menu=null,d.filterGroup&&(d._tableCols=c.filter(d._tableCols,function(a){return!a||!/^group$/i.test(a.title)}));for(var f=!1,g=0;g<d._navSections[0].items.length;g++)"files-official"==d._navSections[0].items[g].id&&(f=!0);f||d._navSections[0].items.push({id:"files-official",title:o.t("official_files"),api:"uploaded_files/official.json"}),k.val(m.getCurrentUser(),"web_preferences.network_settings.allow_external_sharing")&&d._navSections[1]&&"user"==d._navSections[1].id&&d._navSections[1].items&&!c.any(d._navSections[1].items,function(a){return"files-user-share"==a.id})&&d._navSections[1].items.push({id:"files-user-share",title:o.t("emailed_to_me"),api:"uploaded_files/shared_with_me"}),this.$actionsMenu=null,this.menu=null,l.on("/ui/files/newFile",function(a){a.group_id!=this.selectedGroup()||this.filterClass!=a.content_class.toLowerCase()+"s"&&this.filterClass||this.prependOne(a)},this),l.on("/ui/SidebarNavigator/selection",function(a,b){e.filterGroup={full_name:b,id:"company"==a?null:a}}),i.prototype.init.call(this,d,b),this._tableCols=d._tableCols},this.simpleMenuTemplate='<ul class="yj-action-list">{{#canPreview}}<li class="yj-selector-action yj-action-list-item" data-action="selector-method-preview" data-selector-menu-link="true"><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-search yamicon-inline"></span> '+o.t("preview_2")+'</a></li>{{/canPreview}}{{#canEdit}}<li class="yj-selector-action yj-action-list-item" data-selector-menu-link="true"><a href="{{editUrl}}" target="_blank" class="yj-action-list-link"><span class="yamicon yamicon-pencil yamicon-inline"></span> '+o.t("edit")+'</a></li>{{/canEdit}}{{#canFollow}}<li class="yj-selector-action yj-action-list-item yj-selector-follow-link" data-action="selector-method-unfollow" data-selector-menu-link="true" {{^following}}style="display: none;"{{/following}}><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-dash yamicon-inline"></span> '+o.t("unfollow")+'</a></li><li class="yj-selector-action yj-action-list-item yj-selector-follow-link" data-action="selector-method-follow" data-selector-menu-link="true" {{#following}}style="display: none;"{{/following}}><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-plus yamicon-inline"></span> '+o.t("follow")+'</a></li>{{/canFollow}}{{#share}}<li class="yj-selector-action yj-action-list-item" data-action="selector-method-share" data-selector-menu-link="true"><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-share yamicon-inline"></span> '+o.t("share_2")+'</a></li>{{/share}}<li class="yj-action-list-item"><a href="{{downloadUrl}}" class="yj-action-list-link"><span class="yamicon yamicon-download yamicon-inline"></span> '+o.t("download_2")+'</a></li>{{#canDelete}}<li class="yj-selector-action yj-action-list-item" data-action="selector-method-delete" data-selector-menu-link="true"><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-stop yamicon-inline"></span> '+o.t("delete")+"</a></li>{{/canDelete}}</ul>",this.handleSelect=function(a,c,d){var e,f,g,h,i,j=b(c?c.target:a);if(a&&(g=a.replace("yj-tabular-",""),g=parseInt(g,10),h=this.data[g],h&&(this.currentItem=h)),j.parents("[data-selector-menu-link]").length&&(j=j.closest("[data-selector-menu-link]")),j.hasClass("yj-simple-menu-trigger"))return this.createActionsMenu(a),j.after(this.$actionsMenu),this.menu.showMenu(),void(c&&c.stopPropagation());if(j.hasClass("yj-selector-action")){var k=j.attr("data-action");return e=k.replace("selector-method-",""),void(e!=k&&(f=this._methods[e],"function"==typeof f&&f.call(this,a)))}h&&(i=this.getLockedStatus(h),d?this.onAct(h,i):this.onSelect(h,i))},this.createActionsMenu=function(a){var d=this.currentItem.network_id!==m.getCurrentNetwork().id,f=this._refs.group,i=f&&g.get(this.currentItem.group_id),j={id:"selectorActions",className:"yj-selector-simple-menu",align:"right",button:'<a href="javascript://" class="yj-btn yj-btn-alt yj-btn-tiny"><span class="yj-down-arrow"></span></a> ',menuContent:e.render(this.simpleMenuTemplate,{canPreview:h.previewable(this.currentItem),canEdit:this.currentItem.edit_url,canFollow:!i||!y.isExternal(i),editUrl:this.currentItem.web_url+"/edit",following:this._followedIds[this.currentItem.id],downloadUrl:this.currentItem.download_url,canDelete:n.convertStringyBoolean(m.getCurrentUser().id==this.currentItem.owner_id||"true"==m.getCurrentUser().admin&&!d||i&&x.isAdminOf(m.getCurrentUser(),i)),share:!("private"==this.currentItem.privacy||i&&y.isForeign(i,m))})};this.menu&&this.menu.remove(),this.menu=new v(j,this),this.$actionsMenu=this.menu.render().$el,this.listener.listenTo(this.menu,"showMenu",c.bind(function(){b("[data-row-id="+a+"]").find(".yj-simple-menu-trigger").hide(),this.menu.$buttonContainer.css("z-index","2"),this.menu.$buttonContainer.show()},this)),this.listener.listenTo(this.menu,"hideMenu",c.bind(function(){this.$element.find(".yj-simple-menu-trigger").show(),this.menu.$buttonContainer.hide()},this))},this.resetSelectorComponent=function(){var a=this.filterClass&&("images"==this.filterClass||"videos"==this.filterClass),b={id:this._selectorComponentId,target:".yj-selector-list",columns:this._tableCols,createLinkText:this._createLinkText,canCreatePage:!1,createPageText:this._createPageText,showGroup:!0,minItems:null,createLinkIcon:this._createLinkIcon,tableClass:"yj-"+this.defaults._dataName+"-selector",showSelection:this.inLightbox,showCreateLink:this._showCreateLink,parent:this},c=a?new t(b,this):new u(b,this);this.unhookSelectorComponent(),this.selectorComponent.remove(),this.selectorComponent=c,this.$element.find(c.target).append(c.render().$el),this.hookSelectorComponent()},this.isCreateLinkVisible=function(a){var b=i.prototype.isCreateLinkVisible.call(this,a);return b&&!q.isIOS()},this.getTypeLabel=function(){return"file"},this.getType=function(){return"file"}})}),define("stache!common-ui/lib/ui/general/delete_confirmation",["mustache"],function(a){var b='<div class="yj-lightbox-content extra-padding">\n  <p>{{confirm_message}}</p>\n  <div class="yj-confirm-action">\n    <button id="cancel-action" name="cancel" class="yj-btn" type="submit">{{negative_action}}</button> &nbsp;\n    <button id="confirm-action" name="confirm" type="submit" class="yj-btn yj-btn-alt" data-qaid="confirm_action">{{positive_action}}</button>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/general/delete_note_confirmation",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","backbone","core/lib/yammer_api","html!./delete_confirmation"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("backbone"),f=a("core/lib/yammer_api"),g=a("html!./delete_confirmation");return b.extend({mixins:[c],events:{"click #cancel-action":"_cancelDelete","click #confirm-action":"_confirmDelete"},className:"yj-colorbox",template:g,initialize:function(a){this._confirmCallback=a.confirmCallback,this.itemId=a.itemId},getTemplateData:function(){return{negative_action:d.t("dont_delete"),positive_action:d.t("delete"),confirm_message:d.t("delete_note_warning_confirm")}},_confirmDelete:function(){f.deleteNote({note_id:this.itemId}).then(this._confirmCallback,function(){e.trigger("/ui/alert/show","error",d.t("there_was_an_error_deleting_your_note"))}),e.trigger("/ui/lightbox/close")},_cancelDelete:function(){e.trigger("/ui/lightbox/close")}})}),define("feeds/lib/ui/pages/selector",["require","jquery","underscore","mustache","core/lib/date_helper","collections/groups","common-ui/lib/ui/shared/navigator","core/lib/namespace","backbone","core/lib/session","core/lib/string_helper","core/lib/tr","core/lib/yammer_api","feeds/lib/ui/selectors/templates_helper","components/avatar/index","feeds/lib/ui/shared/simple_menu","common-ui/lib/helper/ui","common-ui/lib/ui/general/delete_note_confirmation","common-ui/lib/ui/general/lightbox_manager","models/helpers/user","models/helpers/group","core/lib/urls","html!feeds/lib/ui/selectors/group"],function(a){var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("core/lib/date_helper"),f=a("collections/groups"),g=a("common-ui/lib/ui/shared/navigator"),h=a("core/lib/namespace"),i=a("backbone"),j=a("core/lib/session"),k=a("core/lib/string_helper"),l=a("core/lib/tr"),m=a("core/lib/yammer_api"),n=a("feeds/lib/ui/selectors/templates_helper"),o=a("components/avatar/index"),p=a("feeds/lib/ui/shared/simple_menu"),q=a("common-ui/lib/helper/ui"),r=a("common-ui/lib/ui/general/delete_note_confirmation"),s=a("common-ui/lib/ui/general/lightbox_manager"),t=a("models/helpers/user"),u=a("models/helpers/group"),v=a("core/lib/urls"),w=a("html!feeds/lib/ui/selectors/group");return g.extend(new function(){this.defaults={id:"pageSelector",_dataName:"pages",_dataType:"Notes",_createLinkText:l.t("create_a_note"),_createLinkIcon:"page-pen-icon",_navSections:[{id:"all",header:null,items:[{id:"pages-all",title:l.t("all_notes"),api:"notes.json"}]},{id:"user",header:l.t("my_notes"),items:[{id:"pages-user-accessed",title:l.t("recently_accessed"),api:"notes/recently_accessed.json"},{id:"pages-user-follow",title:l.t("notes_i_follow"),api:"notes/followed_by/:user_id.json"},{id:"pages-user-authored",title:l.t("notes_ive_edited"),api:"notes/authored_by/:user_id.json"}]},{id:"group",header:l.t("my_groups"),items:[{id:"pages-all-company",title:"",api:"notes/in_group/company.json"}]}],_prototypeLazyInit:!1,_tableCols:[{title:l.t("name"),source:function(a,b,e){var f,g="private"==a.privacy,h=a.official,i=!this.inLightbox&&a.unpublished_contributor_ids&&a.unpublished_contributor_ids.length>0,j=c.escape(a.name),k=v.noteIndex(a),m="",n="",o=0,p=3;if(i){for(var q=0,r=a.unpublished_contributor_ids.length;r>q;q++)if(f=this._refs.user[a.unpublished_contributor_ids[q]],m+='<img title="'+c.escape(f.full_name)+'" class="yj-tabular-editor-thumb" src="'+c.escape(f.mugshot_url)+'" alt="" />',q==p-1){o=a.unpublished_contributor_ids.length-p;break}o>0&&(n=' <span class="yj-tabular-others">'+l.t("and_count_others",{count:o})+"</span>")}var s='<div class="{{contClass}}">{{#official}}<span class="official-badge-small yj-inline-icon yj-enhanced-tooltip"><span class="yj-acc-hidden"> '+l.t("official")+' </span></span> {{/official}}{{#lightbox}}<a href="javascript://" title="{{{name}}}" class="{{itemClass}} unstyle-link-as-span">{{{name}}}<span class="yj-acc-selectedstate"> '+l.t("selected")+' </span></a> {{/lightbox}}{{^lightbox}}<a title="{{{name}}}" class="{{itemClass}}" href="{{url}}">{{{name}}}</a> {{/lightbox}}</div>{{#private}}<div class="yj-tabular-data-icon"><span class="yamicon yamicon-lock yamicon-xx-small yj-dark-gray"></span></div>{{/private}}{{#unpublished}}<div class="yj-tabular-data-icon"><span class="yamicon yamicon-pencil yamicon-inline yj-dark-gray"></span><span class="yj-tooltip-content"><span class="yj-info-bubble-content"><strong>'+l.t("members_with_unpublished_edits")+'</strong><br />{{{editors}}}{{{others}}}<span class="yj-info-bubble-arrow"></span></span></span></div>{{/unpublished}}',t=d.render(s,{contClass:"yj-tabular-data-cont"+(g?" yj-private-cont":"")+(i?" yj-editors-cont":""),itemClass:"yj-tabular-data-name"+(g?" yj-private-name":"")+(i?" yj-editors-name":""),name:j,url:k,lightbox:this.inLightbox,private:g,official:h,unpublished:i,editors:m,others:n});e.html(t)}},{title:l.t("group_2"),source:function(a,b,d){if(a.external_share)return void d.html('<span><em style="color:#999">'+l.t("external_note")+"</em></span>");var e=n.getGroupTemplateData(a),f=w(c.extend({in_lightbox:this.inLightbox},e));d.html(f)},headerStyle:"width: 90px;"},{title:l.t("last_published_by"),source:function(a,b,d){if(!a.external_share){var e,f,g,h="",i=a.last_published_by;i&&this._refs.user[i]?(e=this._refs.user[i],h=c.escape(e.full_name),g=this.inLightbox?'<span class="yj-tabular-user-span yj-hovercard-link" data-resource-id="'+e.id+'">'+h+"</span>":'<a class="yj-tabular-user-link yj-hovercard-link" href="'+c.escape(e.web_url)+'" data-resource-id="'+e.id+'">'+h+"</a>",f=new o({model:e,withHovercard:!0,hideFromAccessibility:!0}),d.append(f.render().$el),d.append(" "+g)):d.html("&nbsp;")}}},{title:l.t("last_published_on"),source:function(a,b,d){var f,g="";if(a.last_published_by||a.external_share){if(!a.displayDate){if(!a.last_published_at)return;f=e.formatAgo(new Date(a.last_published_at),null,!0),a.displayDate=f,d.attr("title",f)}g='<div class="yj-tabular-last-uploaded-wrap"><div class="yj-tabular-last-uploaded">'+c.escape(a.displayDate)+"</div>"}else g='<div class="yj-tabular-last-uploaded-wrap"><i>Draft</i>';this.inLightbox||a.external_share||(g+=' <button aria-haspopup="true" class="yj-simple-menu-trigger yj-btn yj-btn-alt yj-btn-tiny" data-selector-menu-link="true" data-speechtip> <span class="yj-down-arrow"><span class="yj-acc-hidden">'+l.t("actions")+"</span></span></button></div>"),d.html(g)},headerStyle:"width: 130px;",dataStyle:"overflow: visible; padding: 0 3px 0 0;"}],_methods:{preview:function(){var a=this.currentItem;i.trigger("/ui/fancy-lightbox/open",{attachmentId:a.id,type:a.type,instance:a})},share:function(){var a=this.currentItem,b=c.extend({},a,{id:a.id,type:a.type,source:"notes_tab_dropdown",group_id:a.group_id});i.trigger("/ui/publisher/share-lightbox/open",{excerptOptions:b})},follow:function(){var a=this.currentItem;m.subscribeToTarget({target_type:a.type,target_id:a.id}).then(c.bind(function(){i.trigger("/ui/alert/show","notice",l.t("you_are_now_following_name",{name:a.title||a.name})),t.followPage(j.getCurrentUser(),a.id),this._followedIds[a.id]=!0},this))},unfollow:function(){var a=this.currentItem;m.unsubscribeFromTarget({target_type:a.type,target_id:a.id}).then(c.bind(function(){i.trigger("/ui/alert/show","notice",l.t("you_are_no_longer_following_name",{name:a.name})),t.unfollowPage(j.getCurrentUser(),a.id),delete this._followedIds[a.id]},this))},delete:function(a){var c=new r({itemId:this.currentItem.id,confirmCallback:function(){q.shiftCount("#yj-group-notes-link .yj-tab-counter",-1),i.trigger("/ui/alert/show","notice",l.t("the_note_has_been_deleted")),b("[data-row-id="+a+"]").fadeOut("slow")}});s.openComponent(c,"",null,{title:l.t("delete_note_warning_confirm_title"),width:"370",onComplete:function(){b("#cancel-action").focus()}})}},_groupApiBase:"notes/in_group/",_topicApiBase:"notes/with_topic/",_filterComponentId:"pageSelectorFilter",_selectorComponentId:"pageSelectorItems"},this.init=function(a,b){var d=a||{};d=c.extend({},this.defaults,d),d.filterGroup&&(d._tableCols=c.filter(d._tableCols,function(a){return!a||!/^group$/i.test(a.title)}));for(var e=!1,f=0;f<d._navSections[0].items.length;f++)"pages-official"==d._navSections[0].items[f].id&&(e=!0);e||d._navSections[0].items.push({id:"pages-official",title:l.t("official_notes"),api:"notes/official.json"}),h.val(j.getCurrentUser(),"web_preferences.network_settings.allow_external_sharing")&&d._navSections[1]&&"user"==d._navSections[1].id&&d._navSections[1].items&&!c.any(d._navSections[1].items,function(a){return"pages-user-share"==a.id})&&d._navSections[1].items.push({id:"pages-user-share",title:l.t("shared_by_email"),api:"notes/shared_with_me"}),this.$actionsMenu=null,this.menu=null,g.prototype.init.call(this,d,b)},this.simpleMenuTemplate='<ul class="yj-action-list"><li class="yj-selector-action yj-action-list-item" data-action="selector-method-preview" data-selector-menu-link="true"><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-add-search"></span> '+l.t("preview_2")+'</a></li>{{#canFollow}}<li class="yj-selector-action yj-action-list-item yj-selector-follow-link" data-action="selector-method-unfollow" data-selector-menu-link="true" {{^following}}style="display: none;"{{/following}}><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-dash"></span> '+l.t("unfollow")+'</a></li><li class="yj-selector-action yj-action-list-item yj-selector-follow-link" data-action="selector-method-follow" data-selector-menu-link="true" {{#following}}style="display: none;"{{/following}}><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-plus"></span> '+l.t("follow")+'</a></li>{{/canFollow}}{{#share}}<li class="yj-selector-action yj-action-list-item" data-action="selector-method-share" data-selector-menu-link="true"><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-share"></span> '+l.t("share_2")+'</a></li>{{/share}}{{#canDelete}}<li class="yj-selector-action yj-action-list-item" data-action="selector-method-delete" data-selector-menu-link="true"><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-stop"></span> '+l.t("delete")+"</a></li>{{/canDelete}}</ul>",
this.handleSelect=function(a,c,d){var e,f,g,h,i,j,k=b(c.target);return a&&(h=a.replace("yj-tabular-",""),h=parseInt(h,10),i=this.data[h],i&&(this.currentItem=i)),k.parents("[data-selector-menu-link]").length&&(k=k.closest("[data-selector-menu-link]")),k.hasClass("yj-simple-menu-trigger")?(this.createActionsMenu(a),k.after(this.$actionsMenu),this.menu.showMenu(),void c.stopPropagation()):k.hasClass("yj-selector-action")?(g=k.attr("data-action"),e=g.replace("selector-method-",""),void(e!=g&&(f=this._methods[e],"function"==typeof f&&f.call(this,a)))):void(i&&(j=this.getLockedStatus(i),d?this.onAct(i,j):this.onSelect(i,j)))},this.createActionsMenu=function(a){var e=this.currentItem.network_id!==j.getCurrentNetwork().id,g=this._refs.group,h=g&&f.get(this.currentItem.group_id),i={id:"selectorActions",className:"yj-selector-simple-menu",align:"right",button:'<a href="javascript://" class="yj-btn yj-btn-alt yj-btn-tiny"><span class="yj-down-arrow"></span></a> ',menuContent:d.render(this.simpleMenuTemplate,{following:this._followedIds[this.currentItem.id],canDelete:k.convertStringyBoolean(j.getCurrentUser().id==this.currentItem.owner_id||"true"==j.getCurrentUser().admin&&!e||h&&t.isAdminOf(j.getCurrentUser(),h)),share:!("private"==this.currentItem.privacy||h&&u.isForeign(h,j)),canFollow:!(e||h&&u.isExternal(h))})};this.menu&&this.menu.remove(),this.menu=new p(i,this),this.$actionsMenu=this.menu.render().$el,this.listener.listenTo(this.menu,"showMenu",c.bind(function(){b("[data-row-id="+a+"]").find(".yj-simple-menu-trigger").hide(),this.menu.$buttonContainer.css("z-index","2"),this.menu.$buttonContainer.show()},this)),this.listener.listenTo(this.menu,"hideMenu",c.bind(function(){this.$element.find(".yj-simple-menu-trigger").show(),this.menu.$buttonContainer.hide()},this))},this.getTypeLabel=function(){return"Note"},this.getType=function(){return"page"},this.afterRender=function(){g.prototype.afterRender.call(this);var a=function(a){var c=b(a.target);return c.parents("tr").find(".yj-tooltip-content").html()},c={target:{node:this.$element,delegateString:"tbody tr"},text:a,delay:0,fadeTime:10,arrowPadding:15,className:"yj-info-bubble",stayVisible:!0,validHTML:!0,hoverOrigin:".yamicon-pencil"};i.trigger("/ui/tooltip/add",c)}})}),define("stache!feeds/lib/ui/files/upload_button",["mustache"],function(a){var b='<div class="yj-upload-button-ready">\n  <a class="yj-btn yj-btn-alt yj-clearfix" href="javascript://" role="button">{{choose}}</a>\n  <span style="padding-left: 3px">to</span>\n  <span class="yj-upload-button-group-name">{{group_name}}</span>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/files/upload_button",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/session","core/lib/tr","models/helpers/network","html!./upload_button","feeds/lib/ui/attachments/uploader","feeds/lib/ui/attachments/upload_progress_bar"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("backbone"),f=a("core/lib/session"),g=a("core/lib/tr"),h=a("models/helpers/network"),i=a("html!./upload_button");return a("feeds/lib/ui/attachments/uploader"),a("feeds/lib/ui/attachments/upload_progress_bar"),c.extend({mixins:[d],chooseFileText:g.t("upload_file"),className:"yj-attachments-container",template:i,getTemplateData:function(){return{choose:this.chooseFileText,group_name:h.getCompanyGroupName(f.getCurrentNetwork())}},addUploader:function(a){function c(a,b){i.setGroup(a),g.text(b)}if(!this._removeUploader){var d,f=this.$(".yj-upload-button-ready"),g=this.$(".yj-upload-button-group-name"),h={handleUpload:function(a){d.file=a,d.show(),f.hide()},handleFileUpload:function(){},handleUploadFinish:b.bind(function(){this._completeUpload(),d.hide(),f.show()},this),handleUploadProgress:function(a){d.file=a,d.update(a.percent)},handleFilesAdded:function(){},handleUploadCancel:function(){},handleUploadError:function(){},handleEncodingComplete:function(){}},i=new yam.ui.attachments.FileVilleUploader({button:this.$(".yj-btn"),container:this.$el,eventDelegate:h,feedId:a.groupId,networkId:a.networkId});d=new yam.ui.attachments.UploadProgressBar({uploader:i,showFileName:!0}),this.$el.append(d.$el),d.render(),d.hide(),a.groupName&&g.text(a.groupName),e.on("/ui/SidebarNavigator/selection",c),this._completeUpload=function(){i.complete()},this._removeUploader=function(){i.destroy(),e.off("/ui/SidebarNavigator/selection",c),d.remove()}}},remove:function(){var a=this._removeUploader;a&&a(),c.prototype.remove.call(this)}})}),define("stache!feeds/lib/ui/attachments/selector",["mustache"],function(a){var b='{{#showToggle}}\n<div class="yj-attachments-selector-toggle">\n  <a href="javascript://" role="button" class="yj-attachments-selector-toggle-button yj-attachments-selector-files" data-yj-section-id="files">\n    <span class="yamicon yamicon-paperclip yj-blue yamicon-med"></span>\n    <strong>{{filesTitle}}</strong>\n    <span class="yj-acc-hidden"> {{tabAltText}}</span>\n    <span class="yj-acc-selectedstate"> {{selectedAltText}}</span>\n    &ndash; {{filesDescription}}\n    <span class="selector-arrow-icon yj-selector-arrow"></span>\n  </a>\n  <a href="javascript://" role="button" class="yj-attachments-selector-toggle-button yj-attachments-selector-pages" data-yj-section-id="pages">\n    <span class="yamicon yamicon-old-note yj-blue yamicon-med"></span>\n    <strong>{{pagesTitle}}</strong>\n    <span class="yj-acc-hidden"> {{tabAltText}}</span>\n    <span class="yj-acc-selectedstate"> {{selectedAltText}}</span>\n    &ndash; {{pagesDescription}}\n    <span class="selector-arrow-icon yj-selector-arrow"></span>\n  </a>\n</div>\n{{/showToggle}}\n<div class="yj-attachments-selector-main"></div>\n<div class="yj-attachments-selector-toolbar">\n  <div class="yj-attachments-selector-upload-button">\n    <UploadButton key="upload-button" />\n  </div>\n  <div class="yj-attachments-selector-toolbar-item">\n    <button class="yj-btn yj-attachments-selector-select">\n      {{defaultBtnText}}\n    </button>\n  </div>\n  <div class="yj-attachments-selector-toolbar-item">\n    <a href="javascript://" role="button" class="yj-attachments-selector-cancel">\n      {{cancelBtnText}}\n    </a>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/selector",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_show_hide","core/lib/backbone_with_subviews","collections/groups","feeds/lib/ui/files/selector","feeds/lib/ui/pages/selector","backbone","feeds/lib/ui/files/upload_button","core/lib/session","core/lib/string_helper","core/lib/tr","html!./selector"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_show_hide"),e=a("core/lib/backbone_with_subviews"),f=a("collections/groups"),g=a("feeds/lib/ui/files/selector"),h=a("feeds/lib/ui/pages/selector"),i=a("backbone"),j=a("feeds/lib/ui/files/upload_button"),k=a("core/lib/session"),l=a("core/lib/string_helper"),m=a("core/lib/tr"),n=a("html!./selector"),o="files",p="pages",q=c.extend({className:"yj-attachments-selector",defaults:{id:"attachmentsSelector",selectors:b.object([o,p],[g,h]),defaultSelector:o},mixins:[d,e],template:n,views:{UploadButton:"_getUploadButton"},events:{"click .yj-attachments-selector-toggle-button":"handleToggle","click .yj-attachments-selector-select":"handleSelect","click .yj-attachments-selector-cancel":"handleCancel"},initialize:function(a){this._selectEnabled=!1,this._groupId=a.groupId,this.currentSelector="",this.childMap={}},_hideSelector:function(a){var b=this.getSelectorByKey(a);return b.$element.hide(),b},_showSelector:function(a){var b=this.getSelectorByKey(a);return b.$element.show(),b.filterComponent.toggleScrollbars(),b},displaySelector:function(a){this.currentSelector&&this._hideSelector(this.currentSelector);var b=this._showSelector(a);this.currentSelector=a,this.$toggle.find(".yj-attachments-selector-toggle-button:not([data-yj-section-id="+a+"])").removeClass("yj-selected"),this.$toggle.find(".yj-attachments-selector-toggle-button[data-yj-section-id="+a+"]").addClass("yj-selected"),b.currentItem?this.handleComponentSelect(b.currentItem):this.reset()},_createAllSelectors:function(){b.each(this.options.selectors,function(a,b){this._createSelectorByKey(b)},this)},_createSelectorByKey:function(a){var b=this.options.selectors[a],c=".yj-attachments-selector-main",d=new b({id:"attachmentsSelector__"+a,inLightbox:this.options.inLightbox,groupId:this.options.groupId});d.render().hide(),this.$(c).append(d.$el),this.childMap[a]=d,this.listenTo(d.listener,"onSelect",this.handleComponentSelect.bind(this)),this.listenTo(d.listener,"onAct",this.handleComponentAct.bind(this)),d.groupId=this.options.groupId,d.sourceId=this.sourceId,d.filterClass=this.filterClass},getSelectorByKey:function(a){return this.childMap[a]},getTemplateData:function(){var a=l.convertStringyBoolean(k.getCurrentUser().web_preferences.network_settings.allow_attachments);return{defaultBtnText:m.t("attach"),cancelBtnText:m.t("cancel"),filesTitle:m.t("files"),pagesTitle:m.t("notes"),filesDescription:m.t("content_uploaded_to_yammer"),pagesDescription:m.t("content_created_in_yammer"),tabAltText:m.t("tab"),selectedAltText:m.t("selected"),showToggle:!this.publisherHack&&a}},_getUploadButton:function(){return this.uploadButton=new j,this.uploadButton},addUploader:function(){if(this.uploadButton){var a=f.get(this.options.groupId),b=k.getCurrentUser(),c={};a&&b.groupsMap[a.get("id")]&&(c={groupId:a.get("id"),groupName:a.get("full_name"),networkId:a.get("network_id")}),this.uploadButton.addUploader(c)}},render:function(){var a=this.getTemplateData();this.$el.html(this.template(a)),this.$toggle=this.$(".yj-attachments-selector-toggle"),this.$selectButton=this.$(".yj-attachments-selector-select"),this.$upload=this.$(".yj-attachments-selector-upload-button");var b=l.convertStringyBoolean(k.getCurrentUser().web_preferences.network_settings.allow_attachments);return b&&this.options.defaultSelector!==p||this.$upload.hide(),this._createAllSelectors(),this.displaySelector(this.options.defaultSelector),this.reset(),i.trigger("/ui/lightbox/resize"),this},handleToggle:function(a){var b=this.$(a.currentTarget).attr("data-yj-section-id");b!==this.currentSelector&&(this.displaySelector(b),this.updateItemInteraction(),b!==o?this.$upload.hide():this.$upload.show())},disableItemInteraction:function(a){this.$el.addClass("item-selection-disabled"),this.getSelectorByKey(this.currentSelector).showStatusMessage(a)},enableItemInteraction:function(){this.$el.removeClass("item-selection-disabled"),this.getSelectorByKey(this.currentSelector).clearStatusMessage()},disableSelect:function(){this._selectEnabled=!1,this.$selectButton.addClass("yj-btn-disabled"),this.$selectButton[0].disabled=!0},enableSelect:function(){this._selectEnabled=!0,this.$selectButton.removeClass("yj-btn-disabled"),this.$selectButton[0].disabled=!1},handleSelect:function(){if(this._selectEnabled){var a=this.getSelectorByKey(this.currentSelector),b=a.currentItem;b?(this.trigger("select",b),i.trigger("/ui/lightbox/close")):i.trigger("/ui/alert/show","error",m.t("no_item_selected"))}},handleCancel:function(a){a.preventDefault(),i.trigger("/ui/lightbox/close")},handleComponentSelect:function(a,b){var c,d,e=!1;if(this.reset(),a){var f=this.getSelectorByKey(this.currentSelector);void 0===b&&(b=f.getLockedStatus(a)),c=b.locked,d=b.message,c?(f.showStatusMessage(d),this.disableSelect()):(this.enableSelect(),e=!0)}else this.updateItemInteraction();return e},handleComponentAct:function(a,b){this.handleComponentSelect(a,b)&&this.handleSelect()},reset:function(){this.getSelectorByKey(this.currentSelector).clearStatusMessage(),this.disableSelect(),this.enableItemInteraction()},updateItemInteraction:function(){var a=this.getSelectorByKey(this.currentSelector),b=a.getGroupLockedStatus();b.locked?this.disableItemInteraction(b.message):this.enableItemInteraction()},remove:function(){var a=this._removeUploadButton;return a&&a(),c.prototype.remove.call(this)}});return q.PAGES=p,q.FILES=o,q}),define("stache!feeds/lib/ui/publisher/global/file_select_button",["mustache"],function(a){var b='<button class="unstyle-button-as-span">\n  <span class="button-icon yamicon yamicon-{{icon}}"></span>\n  <span class="button-label">{{label}}</span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/file_select_button",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","models/recipient","common-ui/lib/ui/general/lightbox_manager","feeds/lib/ui/attachments/selector","core/lib/report","core/lib/tr","html!./file_select_button"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("models/recipient"),f=a("common-ui/lib/ui/general/lightbox_manager"),g=a("feeds/lib/ui/attachments/selector"),h=a("core/lib/report"),i=a("core/lib/tr"),j=a("html!./file_select_button"),k=e.TYPE,l={files:"empty-page",pages:"write"};return c.extend({mixins:[d],defaults:function(){var a={files:i.t("select_a_file_on_yammer_2"),pages:i.t("select_a_note_on_yammer_2"),selector:i.t("select_an_attachment_2")};return{width:800,height:480,icons:l,strings:a}},events:{click:"_onClick"},className:"yj-global-file-select-button",template:j,initialize:function(a){b.bindAll(this,"_onSelect"),this._type=a.type,this._width=a.width,this._height=a.height,this._icons=a.icons,this._strings=a.strings,this._getGroupId=a.getGroupId},getTemplateData:function(){return{icon:this._icons[this._type],label:this._strings[this._type]}},render:function(){return this.$button=this.$("button"),this},enable:function(){return this.$button&&this.$button.prop("disabled",!1),this},disable:function(){return this.$button&&this.$button.prop("disabled",!0),this},_showSelector:function(){var a=this.model.findRecipient({type:[k.PUBLIC_GROUP,k.PRIVATE_GROUP]}),b={inLightbox:!0,defaultSelector:this._type,groupId:a&&a.getId()},c=new g(b),d={title:this._strings.selector,width:this._width,height:this._height,overlayClose:!1,onComplete:function(){c.addUploader()}},e=f.openComponent(c,"yj-attachment-selector-lightbox",void 0,d);e.on("select",this._onSelect)},_onClick:function(){h.event("select_file_clicked"),this._showSelector()},_onSelect:function(a){var c=b.extend({progress:100},a);this.model.get("files").add(c)}})}),define("feeds/lib/ui/publisher/global/menu_list_item",["require","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_legacy_subviews"),d=a("core/lib/backbone_with_subviews");return b.extend({mixins:[c,d],tagName:"li",className:"yj-global-menu-list-item",initialize:function(a){this._childView=a.childView,this._childView&&this.add(this._childView)},enable:function(){return this._childView.enable(),this},disable:function(){return this._childView.disable(),this}})}),define("stache!feeds/lib/ui/publisher/global/menu_list",["mustache"],function(a){var b='<button class="unstyle-button-as-span menu-button" data-speechtip>\n  <span class="menu-icon yamicon yamicon-{{icon}}"></span>\n  <span class="menu-label">{{label}}</span>\n</button>\n<ul class="menu-list"></ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/menu_list",[],function(){}),define("feeds/lib/ui/publisher/global/menu_list",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/menu_list_item","common-ui/lib/ui/accessibility/menu_accessibility","core/lib/tr","common-ui/lib/helper/environment","html!./menu_list","css!./menu_list"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_legacy_subviews"),g=a("core/lib/backbone_with_subviews"),h=a("feeds/lib/ui/publisher/global/menu_list_item"),i=a("common-ui/lib/ui/accessibility/menu_accessibility"),j=a("core/lib/tr"),k=a("common-ui/lib/helper/environment"),l=a("html!./menu_list");a("css!./menu_list");var m="down",n={main:"hamburger"};return d.extend({mixins:[e,f,g],defaults:function(){var a={main:j.t("menu")};return{direction:m,icons:n,strings:a}},events:{"click .menu-button":"_onClickButton","click .menu-list":"_onClickList"},className:"yj-global-menu-list",template:l,initialize:function(a){this._childViews=a.childViews,this._direction=a.direction,this._icons=a.icons,this._strings=a.strings,this._createChildren(),this._setupListeners()},remove:function(){return this._removeListeners(),d.prototype.remove.call(this)},getTemplateData:function(){return{icon:this._icons.main,label:this._strings.main}},render:function(){return this.$el.addClass(this.className+"-"+this._direction),this.$button=this.$(".menu-button"),this.$list=this.$(".menu-list"),this.collapse(),this},expand:function(){return this.swap(!0),this},collapse:function(){return this.swap(!1),this},swap:function(a){return null!=this.$list?("undefined"==typeof a&&(a=!this.isExpanded()),this._toggleList(a),this._positionList(),this.trigger(a?"expand":"collapse"),this):void 0},swapWhenAppropriate:function(a){return this.isFocused()?this:(this.swap(a),this)},isExpanded:function(){return this.$el.hasClass("yj-open")},enable:function(){return c.invoke(this.children(),"enable"),this},disable:function(){return c.invoke(this.children(),"disable"),this},isFocused:function(){return this.$el.has(window.document.activeElement).length>0},_createChildren:function(){c.each(this._childViews,function(a){this.add(new h({childView:a}),".menu-list")},this)},_setupListeners:function(){c.bindAll(this,"swapWhenAppropriate","_onBlur"),b(window).on("click",this._onBlur)},_removeListeners:function(){b(window).off("click",this._onBlur)},_toggleList:function(a){this.$el.toggleClass("yj-open",a),a?(this.$list.removeAttr("aria-hidden"),i.afterMenuShow(this.$list[0],this.collapse.bind(this))):(this.$list.attr("aria-hidden",!0),i.afterMenuDone(this.$list[0]))},_positionList:function(){var a={down:"top",up:"bottom"};this.$list.css(a[this._direction],this.$button.outerHeight()-(k.isIE()?1:0))},_onClickButton:function(a){a.preventDefault(),this.swap()},_onClickList:function(){this.collapse()},_onBlur:function(a){b.contains(window.document,a.target)&&!b.contains(this.el,a.target)&&this.collapse()}})}),define("feeds/lib/ui/publisher/global/file_menu",["require","core/lib/backbone_base_view","core/lib/backbone_with_show_hide","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/file_upload_button","feeds/lib/ui/publisher/global/file_select_button","feeds/lib/ui/publisher/global/menu_list","core/lib/report","core/lib/session","core/lib/string_helper","core/lib/tr","models/helpers/message"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_show_hide"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("feeds/lib/ui/publisher/global/file_upload_button"),g=a("feeds/lib/ui/publisher/global/file_select_button"),h=a("feeds/lib/ui/publisher/global/menu_list"),i=a("core/lib/report"),j=a("core/lib/session"),k=a("core/lib/string_helper"),l=a("core/lib/tr"),m=a("models/helpers/message"),n="down",o={main:"paperclip"},p={main:l.t("add_files")};return b.extend({mixins:[c,d,e],defaults:{direction:n,icons:o,strings:p,inLightbox:!1},className:"yj-global-file-menu",initialize:function(a){return this._direction=a.direction,this._icons=a.icons,this._strings=a.strings,this._inLightbox=a.inLightbox,this._allowAttachments()?(this._createChildren(),void this._setupListeners()):void this.hide()},enable:function(){return this._menuList&&this._menuList.enable(),this},disable:function(){return this._menuList&&this._menuList.disable(),this},open:function(){this.enable(),this._menuList&&this._menuList.swap(!0)},_createChildren:function(){var a=[];this._fileUploadButton=new f({collection:this.model.get("files"),networkId:m.getNetworkId(this.model)}),a.push(this._fileUploadButton),this._inLightbox||(this._fileSelectButton=new g({type:"files",model:this.model}),a.push(this._fileSelectButton),this._noteSelectButton=new g({type:"pages",model:this.model}),a.push(this._noteSelectButton)),this._menuList=new h({direction:this._direction,icons:this._icons,strings:this._strings,childViews:a}),this.add(this._menuList)},_setupListeners:function(){null!=this._menuList&&this.listenTo(this._menuList,"expand",this._onExpandFileMenu),this.listenTo(this.model.get("allRecipients"),"change add remove reset",this._updateNetworkId)},_updateNetworkId:function(){this._fileUploadButton.setNetworkId(m.getNetworkId(this.model))},_onExpandFileMenu:function(){null!=this._fileUploadButton&&this._fileUploadButton.refresh(),i.event("paperclip_menu_expanded")},_allowAttachments:function(){var a=j.getCurrentUser(),b=a&&a.web_preferences,c=b&&b.network_settings;return c?k.convertStringyBoolean(c.allow_attachments):!0}})}),define("css!common-ui/lib/ui/shared/inline_edit",[],function(){}),define("stache!common-ui/lib/ui/shared/inline_edit_static",["mustache"],function(a){var b='<span class="yj-inline-edit-text">{{text}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/shared/inline_edit_editable",["mustache"],function(a){var b='<span class="yj-inline-edit-text yj-inline-edit-text-editable">{{text}}</span>\n<a href="javascript://" role="button" class="yamicon yamicon-xxx-small yamicon-pencil yj-dark-gray" data-speechtip>\n  <span class="yj-acc-hidden">{{editButtonLabel}}</span>\n</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/shared/inline_edit_edit",["mustache"],function(a){var b='<label><span class="yj-acc-hidden">{{label}}</span>\n<input value="{{text}}" maxlength="{{maxLength}}" class="yj-inline-edit--val yj-inline-edit--input"></input></label>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/shared/inline_edit_textarea",["mustache"],function(a){var b='<label><span class="yj-acc-hidden">{{label}}</span>\n<textarea class="yj-inline-edit--val yj-inline-edit--textarea" maxlength="{{maxLength}}" rows="2" cols="55">{{text}}</textarea></label>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/inline_edit",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/report","core/lib/tr","css!common-ui/lib/ui/shared/inline_edit","html!./inline_edit_static","html!./inline_edit_editable","html!./inline_edit_edit","html!./inline_edit_textarea"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/report"),f=a("core/lib/tr");return a("css!common-ui/lib/ui/shared/inline_edit"),d.extend({tagName:"span",templates:{static:a("html!./inline_edit_static"),editable:a("html!./inline_edit_editable"),edit:a("html!./inline_edit_edit"),textarea:a("html!./inline_edit_textarea")},events:{"click .yamicon-pencil":"_onStartEdit","click .yj-inline-edit-text-editable":"_onStartEdit","change .yj-inline-edit--val":"_onChange","blur .yj-inline-edit--val":"_onChange","focus .yj-inline-edit--val":"_onFocus","keypress .yj-inline-edit--val":"_onKeyPress"},defaults:{editType:"input",allowBlanks:!0,text:"",type:"static",maxLength:100,defaultText:f.t("edit")},className:"yj-inline-edit",initialize:function(){this.state="static"===this.options.type?"static":"editable"},render:function(){return this.setState(this.state),this},setState:function(a){this.state=a;var c=this.templates[a],d={text:this.options.text,maxLength:this.options.maxLength,label:this.options.fieldLabel,editButtonLabel:this.options.editLabel};"textarea"===this.state&&d.text&&(d.text=d.text.replace(/<br[\s]?[\s\/]?>/gi,"\n")),"editable"!==a||this.options.text||(d.text=this.options.defaultText),this.$state=b(c(d)),this.$el.empty().append(this.$state),"edit"!==a&&"textarea"!==this.state||this.focusState()},isEditing:function(){return"edit"===this.state||"textarea"===this.state},focusState:function(){this.$state.find("input, textarea").focus()},_onStartEdit:function(){"input"===this.options.editType?this.setState("edit"):"textarea"===this.options.editType&&this.setState("textarea"),this.reportEvent("edit_inline_start")},_onKeyPress:function(a){13===a.which&&"textarea"!==this.state&&this._onChange()},_onFocus:function(){this.trigger("focus")},reportEvent:function(a){var b=c.reject(this.el.classList,function(a){return"yj-inline-edit"===a}).join(" ");e.event(a,{element_class:b||"no-descriptive-class"})},_onChange:function(){if("edit"===this.state||"textarea"===this.state){var a=document.activeElement===this.$(".yj-inline-edit--val")[0],c=b(".yj-inline-edit--val",this.$el).val();c!==this.options.text&&this.reportEvent("edit_inline_change"),(this.options.allowBlanks||!this.options.allowBlanks&&""!==c)&&c!==this.options.text&&(this.trigger("change",{value:c}),this.options.text=c),this.trigger("blur"),this.setState("editable"),a&&this.$(".yamicon-pencil").focus()}}})}),define("stache!feeds/lib/ui/publisher/global/file_list_item",["mustache"],function(a){var b='{{#showPreview}}\n  <span class="item-link">\n{{/showPreview}}\n  <span class="item-thumbnail" aria-hidden="true">\n   <FileThumbnail key="{{thumbnail}}"/>\n  </span>\n  {{#showPreview}}\n    <a href="javascript://" role="button" class="unstyle-link-as-span">\n  {{/showPreview}}\n  <span class="item-type yj-acc-hidden">{{typeLabel}}:</span>\n  <span class="item-name">{{name}}</span>\n  {{#showPreview}}\n    <span class="yj-acc-hidden"> {{previewAlt}}</span>\n    </a>\n  {{/showPreview}}\n  {{#inProgress}}\n    <span class="item-progress">\n      <span class="item-progress-meter yj-progress-meter yj-progress-meter-blue yj-progress-meter-animated"\n            role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">\n        {{^from_link}}\n        <span style="width: {{progress}}%"></span>\n        {{/from_link}}\n        {{#from_link}}\n        <span style="width: 100%"></span>\n        {{/from_link}}\n      </span>\n      <span class="item-progress-label">{{progress}}%</span>\n    </span>\n  {{/inProgress}}\n  {{^inProgress}}\n    <span class="item-description">\n      {{#showEditDescription}}\n        <div class="item-edit-description"></div>\n      {{/showEditDescription}}\n      {{^showEditDescription}}\n        {{#description}}{{description}}{{/description}}\n        {{^description}}{{doneLabel}}{{/description}}\n      {{/showEditDescription}}\n    </span>\n  {{/inProgress}}\n{{#showPreview}}\n  </span>\n{{/showPreview}}\n<button class="item-remove unstyle-button-as-span" data-speechtip="{{removeLabelShort}}">\n  <span class="yamicon yamicon-x"></span>\n  <span class="yj-acc-hidden">{{removeLabel}}</span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/file_list_item",["require","underscore","core/lib/tr","backbone","core/lib/yammer_request","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","common-ui/lib/ui/shared/inline_edit","feeds/lib/modules/video_encoding_progress","common-ui/lib/ui/accessibility/focus_helper","models/helpers/file","components/file_thumbnail/index","html!./file_list_item"],function(a){var b=a("underscore"),c=a("core/lib/tr"),d=a("backbone"),e=a("core/lib/yammer_request"),f=a("core/lib/backbone_base_view"),g=a("core/lib/backbone_with_legacy_subviews"),h=a("core/lib/backbone_with_subviews"),i=a("common-ui/lib/ui/shared/inline_edit"),j=a("feeds/lib/modules/video_encoding_progress"),k=a("common-ui/lib/ui/accessibility/focus_helper"),l=a("models/helpers/file"),m=a("components/file_thumbnail/index"),n=a("html!./file_list_item");return f.extend({mixins:[g,h],defaults:function(){var a={typeFile:c.t("attachments_file_label"),typeNote:c.t("attachments_note_label"),preview:c.t("preview_file_2"),removeFileId:"attachments_remove_file",removeNoteId:"attachments_remove_note",removeShort:c.t("remove"),done:c.t("file_attached_successfully"),imageDone:c.t("file_attached_successfully_click_to_add_a_description"),previewAlt:c.t("attachments_click_to_preview")};return{strings:a,inLightbox:!1}},events:{"click .item-link":"_onClickPreview","click .item-remove":"_onClickRemove"},tagName:"li",className:"yj-global-attach-list-item yj-global-file-list-item",template:n,views:{FileThumbnail:"_getFileThumbnail"},initialize:function(a){this._strings=a.strings,this._inLightbox=a.inLightbox,this._setupListeners()},getTemplateData:function(){var a=this.model.toJSON(),d=j.EncodingStatus,e=a.status===d.ENCODING||a.status===d.FAILED?a.small_icon_url:a.thumbnail_url,f=a.progress<100,g=l.isPage(this.model),h=!this._inLightbox&&(null!=e||g),i=100===a.progress&&"Image"===a.content_class,k=this.model.get("name");return b.extend(a,{thumbnail:e,inProgress:f,showPreview:h,typeLabel:g?this._strings.typeNote:this._strings.typeFile,previewLabel:this._strings.preview,removeLabel:g?c.t(this._strings.removeNoteId,{name:k}):c.t(this._strings.removeFileId,{name:k}),removeLabelShort:this._strings.removeShort,doneLabel:this._strings.done,showEditDescription:i,previewAlt:this._strings.previewAlt})},render:function(){var a=this.getTemplateData();return this.$el.html(this.template(a)),this.$progressMeter=this.$(".item-progress-meter span"),this.$progressBar=this.$(".item-progress-meter"),this.$progressLabel=this.$(".item-progress-label"),this.$removeButton=this.$(".item-remove"),this._setupInlineEdit(),this},enable:function(){return this.$removeButton&&this.$removeButton.prop("disabled",!1),this},disable:function(){return this.$removeButton&&this.$removeButton.prop("disabled",!0),this},_setupListeners:function(){this.listenTo(this.model,"change",this._onChangeAny),this.listenTo(this.model,"change:progress",this._onChangeProgress)},_onChangeAny:function(){var a=this.model.changedAttributes(),c=a.progress&&100!==a.progress;(b.size(a)>1||!c)&&this.render()},_onChangeProgress:function(){var a=this.model.get("progress"),b=a+"%";this.$progressMeter.css({width:b}),this.$progressBar.attr("aria-valuenow",a),this.$progressLabel.text(b)},_onClickPreview:function(a){if(a.preventDefault(),!(this._inLightbox||this._imageDescriptionEditor&&this._imageDescriptionEditor.isEditing())){var b=this.model.toJSON();d.trigger("/ui/fancy-lightbox/open",{attachmentId:b.id,type:b.type,instance:b,simple:!0})}},_onClickRemove:function(){k.notifyRemoval(this.$el),this.remove(),this.model.collection.remove(this.model)},_setupInlineEdit:function(){var a=this.$(".item-edit-description");if(!this._imageDescriptionEditor&&0!==a.length){var f=this.model.get("description");this._imageDescriptionEditor=new i({type:"editable",maxLength:255,editType:"input",defaultText:f||this._strings.imageDone,fieldLabel:c.t("image_description"),editLabel:c.t("edit_image_description")}),this.add(this._imageDescriptionEditor,".item-edit-description"),this._imageDescriptionEditor.$el.addClass("yj-file-item-acc-description"),this._imageDescriptionEditor.on("change",function(a){var c=this.model.toJSON();this.model.set({description:a.value}),e.send({type:"PUT",url:c.url,data:{description:a.value}}),b.defer(function(){d.trigger("/ui/lightbox/resize")})},this)}},_getFileThumbnail:function(){return new m({model:this.model,showPreviewIfPossible:!0})}})}),define("feeds/lib/ui/publisher/global/file_list",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/file_list_item","backbone"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("feeds/lib/ui/publisher/global/file_list_item"),g=a("backbone");
return c.extend({mixins:[d,e],defaults:{inLightbox:!1},tagName:"ol",className:"yj-global-attach-list yj-global-file-list",initialize:function(a){this._inLightbox=a.inLightbox,this._createChildren(),this._setupListeners()},enable:function(){return b.invoke(this.children(),"enable"),this},disable:function(){return b.invoke(this.children(),"disable"),this},_createChildren:function(){this.collection.each(function(a){this.add(new f({model:a,inLightbox:this._inLightbox}))},this)},_setupListeners:function(){this.listenTo(this.collection,"add remove reset sort",this._recreateChildren)},_recreateChildren:function(){this.empty(),this._createChildren(),this.render(),g.trigger("/ui/lightbox/resize")}})}),define("feeds/lib/ui/publisher/global/file_change_reporter",["require","core/lib/backbone_base_view","core/lib/backbone_with_show_hide","core/lib/report"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_show_hide"),d=a("core/lib/report");return b.extend({mixins:[c],initialize:function(){this._enabled=!0,this.listenTo(this.collection,"add",this._onFileAdded),this.listenTo(this.collection,"remove",this._onFileRemoved),this.hide()},enable:function(){return this._enabled=!0,this},disable:function(){return this._enabled=!1,this},_onFileAdded:function(){this._enabled&&d.event("file_added")},_onFileRemoved:function(){this._enabled&&d.event("file_removed")}})}),define("feeds/lib/ui/publisher/global/file_change_announcer",["require","core/lib/tr","core/lib/backbone_base_class","models/file_backbone","common-ui/lib/ui/accessibility/screenreader_announcer"],function(a){var b=a("core/lib/tr"),c=a("core/lib/backbone_base_class"),d=a("models/file_backbone"),e=a("common-ui/lib/ui/accessibility/screenreader_announcer");return c.extend({initialize:function(){this.listenTo(this.options.collection,"add",this._onFileAdded),this.listenTo(this.options.collection,"remove",this._onFileRemoved),this.listenTo(this.options.collection,"change:progress",this._onFileProgressChanged)},_isPublisherVisible:function(){return this.options.publisherElement.is(":visible")},_onFileAdded:function(a){this._isPublisherVisible()&&(a.getType()===d.TYPE.NOTE?e.announceText(b.t("attachments_announce_added_note",{name:a.get("name")})):100===a.get("progress")?e.announceText(b.t("attachments_announce_added_file",{name:a.get("name")})):e.announceText(b.t("attachments_announce_uploading_start",{name:a.get("name")})))},_onFileProgressChanged:function(a){if(this._isPublisherVisible()){var c=a.get("progress");100===c&&e.announceText(b.t("attachments_announce_uploading_complete",{name:a.get("name")}))}},_onFileRemoved:function(a){this._isPublisherVisible()&&(a.getType()===d.TYPE.NOTE?e.announceText(b.t("attachments_announce_removed_note",{name:a.get("name")})):e.announceText(b.t("attachments_announce_removed_file",{name:a.get("name")})))}})}),define("stache!feeds/lib/ui/publisher/global/ogo_list_item",["mustache"],function(a){var b='<span class="item-thumbnail" aria-hidden="true">\n  {{^thumbnail}}<span class="item-icon yamicon yamicon-link"></span>{{/thumbnail}}\n  {{#thumbnail}}\n    <span class="thumbnail" alt="" style="background-image: url(\'{{thumbnail}}\')"/>\n  {{/thumbnail}}\n</span>\n<span class="item-type yj-acc-hidden">{{typeLabel}}:</span>\n<span class="item-name">{{name}}</span>\n<span class="item-host">{{host}}</span>\n<span class="item-description">{{description}}</span>\n<button class="item-remove unstyle-button-as-span" data-speechtip="{{removeLabelShort}}">\n  <span class="yamicon yamicon-x"></span>\n  <span class="yj-acc-hidden">{{removeLabel}}</span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/ogo_list_item",[],function(){}),define("feeds/lib/ui/publisher/global/ogo_list_item",["require","underscore","core/lib/backbone_base_view","core/lib/tr","common-ui/lib/ui/accessibility/focus_helper","html!./ogo_list_item","css!./ogo_list_item"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/tr"),e=a("common-ui/lib/ui/accessibility/focus_helper"),f=a("html!./ogo_list_item");return a("css!./ogo_list_item"),c.extend({defaults:function(){var a={type:d.t("attachments_link_label"),removeId:"attachments_remove_link",removeShort:d.t("remove"),fetching:d.t("fetching_page_data_2")};return{strings:a}},events:{"click .item-remove":"_onClickRemove"},tagName:"li",className:"yj-global-attach-list-item yj-global-ogo-list-item",template:f,initialize:function(a){this._strings=a.strings,this._setupListeners()},getTemplateData:function(){var a=this.model.toJSON(),c=0===this.model.get("progress");c&&(a.name=this.model.get("url"),a.description=this._strings.fetching);var e=this.model.get("name")||this.model.get("url"),f={typeLabel:this._strings.type,removeLabel:d.t(this._strings.removeId,{name:e}),removeLabelShort:this._strings.removeShort};return b.extend(a,f)},render:function(){var a=this.getTemplateData();return this.$el.html(this.template(a)),this.$removeButton=this.$(".item-remove"),this},enable:function(){return this.$removeButton&&this.$removeButton.prop("disabled",!1),this},disable:function(){return this.$removeButton&&this.$removeButton.prop("disabled",!0),this},_setupListeners:function(){this.listenTo(this.model,"change",this.render)},_onClickRemove:function(){e.notifyRemoval(this.$el),this.remove(),this.model.collection.remove(this.model)}})}),define("feeds/lib/ui/publisher/global/ogo_list",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/ogo_list_item","backbone"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("feeds/lib/ui/publisher/global/ogo_list_item"),g=a("backbone");return c.extend({mixins:[d,e],tagName:"ol",className:"yj-global-attach-list yj-global-ogo-list",initialize:function(){this._createChildren(),this._setupListeners()},enable:function(){return b.invoke(this.children(),"enable"),this},disable:function(){return b.invoke(this.children(),"disable"),this},_createChildren:function(){this.collection.each(function(a){this.add(new f({model:a}))},this)},_setupListeners:function(){this.listenTo(this.collection,"add remove reset sort",this._recreateChildren)},_recreateChildren:function(){this.empty(),this._createChildren(),this.render(),g.trigger("/ui/lightbox/resize")}})}),define("feeds/lib/ui/publisher/global/ogo_change_reporter",["require","core/lib/backbone_base_view","core/lib/backbone_with_show_hide","core/lib/report"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_show_hide"),d=a("core/lib/report");return b.extend({mixins:[c],initialize:function(){this._enabled=!0,this.listenTo(this.collection,"add",this._onOgoAdded),this.listenTo(this.collection,"remove",this._onOgoRemoved),this.hide()},enable:function(){return this._enabled=!0,this},disable:function(){return this._enabled=!1,this},_onOgoAdded:function(){this._enabled&&d.event("ogo_attached")},_onOgoRemoved:function(){this._enabled&&d.event("ogo_removed")}})}),define("feeds/lib/ui/publisher/global/ogo_change_announcer",["require","core/lib/tr","core/lib/backbone_base_class","common-ui/lib/ui/accessibility/screenreader_announcer"],function(a){var b=a("core/lib/tr"),c=a("core/lib/backbone_base_class"),d=a("common-ui/lib/ui/accessibility/screenreader_announcer");return c.extend({initialize:function(){this.listenTo(this.options.collection,"add",this._onLinkAdded),this.listenTo(this.options.collection,"remove",this._onLinkRemoved)},_isPublisherVisible:function(){return this.options.publisherElement.is(":visible")},_getLinkName:function(a){return a.get("name")||a.get("url")},_onLinkAdded:function(a){this._isPublisherVisible()&&d.announceText(b.t("attachments_announce_added_link",{name:this._getLinkName(a)}))},_onLinkRemoved:function(a){this._isPublisherVisible()&&d.announceText(b.t("attachments_announce_removed_link",{name:this._getLinkName(a)}))}})}),define("feeds/lib/ui/publisher/global/ogo_hydrator",["require","underscore","core/lib/backbone_base_class","core/lib/session","core/lib/tr","core/lib/uri_helper","core/lib/yammer_api","models/group","collections/groups","models/helpers/group","models/message"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_class"),d=a("core/lib/session"),e=a("core/lib/tr"),f=a("core/lib/uri_helper"),g=a("core/lib/yammer_api"),h=a("models/group"),i=a("collections/groups"),j=a("models/helpers/group");return a("models/message"),c.extend({initialize:function(a){b.bindAll(this,"_onInternalSuccess","_onInternalError","_onExternalSuccess","_onExternalError","_onComplete"),this.model=a.model,this._networkId=d.getCurrentNetwork().id},abort:function(){this._request&&this._request.abort(),this.model.clear({silent:!0})},hydrate:function(){var a=this.model.get("url"),b=this.model.get("host"),c=this.model.get("name");if(null==a||null!=b)return this;a=f.normalize(a);var d=this._getParsedUrl(a);return this.model.set({url:a,host:d.host,name:c||a,progress:0}),f.isIntranet(a)?this._request=this._handleIntranetUrl():f.isInternal(a)?this._request=this._handleInternalUrl(a):this._request=this._handleExternalUrl(a),this},_getParsedUrl:function(a){return f.parse(a)},_handleIntranetUrl:function(){return this._onComplete(),null},_handleInternalUrl:function(a){var b=f.extractThreadId(a);return null==b?this._onComplete():g.getMessage({id:b}).done(this._onInternalSuccess).fail(this._onInternalError).always(this._onComplete)},_handleExternalUrl:function(a){return g.updateOpenGraphObjects({url:a}).done(this._onExternalSuccess).fail(this._onExternalError).always(this._onComplete)},_onInternalSuccess:function(a){if(null!=a.messages&&0!==a.messages.length&&!this._isThreadForeign(a)&&!this._isCurrentGroupExternal()){var c,d=new yam.model.Message(b.first(a.messages)),f=a.references,g=a.external_references,i=b.findWhere(f,{type:"user",id:d.sender_id})||b.findWhere(g,{type:"user",id:d.sender_id}),k=b.findWhere(f,{type:"group"});if(k&&(c=new h(k)),!(c&&j.isExternal(c)||null==i)){var l,m,n;c?(m=j.getFullName(c),n=j.isPrivate(c),l=e.t("yammer_conversation_started_by_user_to_group",{user:i.full_name,group:m})):l=e.t("yammer_conversation_started_by_user",{user:i.full_name});var o="";d.isPrivate()||(o=d.getPlainBody());var p=this.model.get("sharedMessageId");null==p&&(p=d.id);var q={name:l,description:o,sharedMessageId:p,sharedMessageGroup:m,sharedMessagePrivate:n};this.model.set(q)}}},_isThreadForeign:function(a){return b.some(a.messages,function(a){return this._isThreadStarter(a)&&this._isForeign(a)},this)},_isThreadStarter:function(a){return null!=a.id&&a.id===a.thread_id},_isForeign:function(a){return null!=a.network_id&&a.network_id!=this._networkId},_isCurrentGroupExternal:function(){var a=i.get(this.options.groupId);return a&&j.isExternal(a)},_onInternalError:function(){},_onExternalSuccess:function(a){var c={host:a.host_url,name:a.full_name,description:a.description,image:a.image,thumbnail:a.media_url,url:a.web_url};b.each(c,function(a,b){null==a&&delete c[b]}),this.model.set(c)},_onExternalError:function(){},_onComplete:function(){this.model.set({progress:100})}})}),define("feeds/lib/ui/publisher/global/attachment_hydrator",["require","underscore","core/lib/backbone_base_class","core/lib/session","core/lib/uri_helper","core/lib/yammer_api","models/message"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_class"),d=a("core/lib/session"),e=a("core/lib/uri_helper"),f=a("core/lib/yammer_api");return a("models/message"),c.extend({initialize:function(a){b.bindAll(this,"_onFileSuccess","_onNoteSuccess","_onError","_onComplete"),this.model=a.model,this._networkId=d.getCurrentNetwork().id},hydrate:function(){var a=this.model.get("web_url"),b=this.model.get("host");if(null==a||null!=b)return this;a=e.normalize(a);var c=this._getParsedUrl(a);this.model.set({web_url:a,host:c.host,name:a,progress:0});var d=e.extractNoteId(a),f=e.extractFileId(a);d!==!1?this._handleNote(d):f!==!1&&this._handleFile(f)},_getParsedUrl:function(a){return e.parse(a)},_handleNote:function(a){return f.getNote({note_id:a}).done(this._onNoteSuccess).fail(this._onError).always(this._onComplete)},_handleFile:function(a){return f.getUploadedFile({id:a}).done(this._onFileSuccess).fail(this._onError).always(this._onComplete)},_onNoteSuccess:function(a){this.model.set(a)},_onFileSuccess:function(a){this.model.set(a.files[0])},_onError:function(){this.trigger("error")},_onComplete:function(){this.model.set("progress",100)}})}),define("feeds/lib/ui/publisher/global/ogo_watcher",["require","underscore","core/lib/backbone_base_view","feeds/lib/ui/publisher/global/ogo_hydrator","feeds/lib/ui/publisher/global/attachment_hydrator","core/lib/string_helper","core/lib/uri_helper"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("feeds/lib/ui/publisher/global/ogo_hydrator"),e=a("feeds/lib/ui/publisher/global/attachment_hydrator"),f=a("core/lib/string_helper"),g=a("core/lib/uri_helper");return c.extend({defaults:{maxOgos:1,minPasteDiff:5},className:"yj-global-ogo-watcher",initialize:function(a){this._maxOgos=a.maxOgos,this._minPasteDiff=a.minPasteDiff,this._removedAttachments=[],this._setupListeners()},reset:function(){this._lastRemovedUrl="",this._removedAttachments=[]},_setupListeners:function(){this.listenTo(this.model,"change:body",this._scanForLinks),this.listenTo(this.model.get("ogos"),"add",this._hydrateAddedOgo),this.listenTo(this.model.get("files"),"add",this._hydrateAddedAttachment),this.listenTo(this.model.get("ogos"),"remove",this._rememberLastRemovedOgo),this.listenTo(this.model.get("files"),"remove",this._rememberRemovedAttachment)},_scanForLinks:function(){var a=this.model.get("ogos"),b=this.model.get("files"),c=this._extractUrlFromMessage(),d=a.length>=this._maxOgos;return!c||this._isLastRemovedUrl(c)||this._isRemovedAttachment(c)?void 0:this._isAttachmentUrl(c)?void(this._isExistingAttachment(c)||b.add({web_url:c,detected_url:c,type:this._getAttachmentType(c),from_link:!0})):void(d||a.add({url:c}))},_isRemovedAttachment:function(a){return this._removedAttachments.indexOf(a)>=0},_isExistingAttachment:function(a){return this.model.get("files").any(function(b){var c=b.get("detected_url")||b.get("web_url");return c===a})},_isAttachmentUrl:function(a){return g.extractNoteId(a)!==!1||g.extractFileId(a)!==!1},_getAttachmentType:function(a){return g.extractNoteId(a)!==!1?"page":"uploaded_file"},_extractUrlFromMessage:function(){var a=this.model.previous("body"),c=this.model.get("body"),d=this._isPasted(a,c),e=c.match(g.HREF_PATTERN),h=null!=e?b.last(e):null;return null==h||d||(e=c.match(new RegExp(f.escapeRegExp(h)+"\\s+")),h=null!=e?h:null),h},_isPasted:function(a,b){var c=Math.abs(a.length-b.length)>this._minPasteDiff,d=a.indexOf(b)>=0,e=b.indexOf(a)>=0;return c||!(d||e)},_rememberLastRemovedOgo:function(a){this._lastRemovedUrl=a.get("url")},_rememberRemovedAttachment:function(a){var b=a.get("detected_url")||a.get("web_url");this._removedAttachments.push(b)},_isLastRemovedUrl:function(a){return g.normalize(a)===this._lastRemovedUrl},_hydrateAddedOgo:function(a){if(!a.isHydrated()){var b=this.model.getGroup(),c=new d({model:a,groupId:b?b.get("id"):null});c.hydrate()}},_hydrateAddedAttachment:function(a){if(!a.isHydrated()){var b=new e({model:a});this.listenTo(b,"error",function(){this.model.get("files").remove(a)}.bind(this)),b.hydrate()}}})}),define("stache!feeds/lib/ui/publisher/global/submit_button",["mustache"],function(a){var b='<div class="yj-btn-content">\n  {{#altText}}\n  <div aria-hidden="true">\n  {{/altText}}\n  {{#icon}}\n  <span class="button-icon yamicon yamicon-{{icon}}"></span>\n  {{#count}}\n  <span class="button-count">+{{count}}</span>\n  {{/count}}\n  {{/icon}}\n  <span class="button-label">{{label}}</span>\n  {{#altText}}\n  </div>\n  <span class="yj-acc-hidden">{{altText}}</span>\n  {{/altText}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/submit_button",[],function(){}),define("feeds/lib/ui/publisher/global/submit_button",["require","underscore","core/lib/backbone_base_view","models/recipient","models/message_backbone","core/lib/tr","common-ui/lib/ui/accessibility/focus_helper","models/helpers/group","html!./submit_button","css!./submit_button"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("models/recipient"),e=a("models/message_backbone"),f=a("core/lib/tr"),g=a("common-ui/lib/ui/accessibility/focus_helper"),h=a("models/helpers/group"),i=a("html!./submit_button");a("css!./submit_button");var j=d.TYPE,k=e.TYPE,l=b.object([[k.EMPTY,null],[k.ALL_COMPANY,null],[k.ALL_COMPANY_WITH_EXTERNAL,null],[k.PUBLIC_GROUP,null],[k.PUBLIC_GROUP_WITH_EXTERNAL,null],[k.PRIVATE_GROUP,"lock-MSFT"],[k.PRIVATE_GROUP_WITH_EXTERNAL,null],[k.PRIVATE_MESSAGE,"lock-MSFT"],[k.PRIVATE_MESSAGE_WITH_EXTERNAL,null],[k.PRIVATE_MESSAGE_WITH_MENTIONS,"lock-MSFT"]]),m="network";return c.extend({defaults:function(){var a=b.object([[k.EMPTY,f.t("post")],[k.ALL_COMPANY,f.t("post_to_group")],[k.ALL_COMPANY_WITH_EXTERNAL,f.t("post_to_group")],[k.PUBLIC_GROUP,f.t("post_to_group")],[k.PUBLIC_GROUP_WITH_EXTERNAL,f.t("post_to_group")],[k.PRIVATE_GROUP,f.t("post_to_group")],[k.PRIVATE_GROUP_WITH_EXTERNAL,f.t("post_to_group")],[k.PRIVATE_MESSAGE,f.t("send_message")],[k.PRIVATE_MESSAGE_WITH_EXTERNAL,f.t("send_message")],[k.PRIVATE_MESSAGE_WITH_MENTIONS,f.t("send_message")]]);return{icons:l,strings:a}},events:{click:"_onClick"},className:"yj-global-submit-button yj-btn",tagName:"button",attributes:{"data-qaid":"post_button"},template:i,initialize:function(a){this._icons=a.icons,this._strings=a.strings,this._active=a.active,this._setupListeners()},getTemplateData:function(){var a=this.model.getGroup(),b=a&&h.isExternal(a),c=this.model.getType(),d=this.model.findRecipients({type:[j.USER,j.DOMAIN],external:!0}).length,e=this.model.findRecipients({type:[j.USER,j.DOMAIN],foreign:!0,implicit:!1}).length>0;return{icon:this._getIcon(),count:b?null:d,label:this._strings[c],altText:this._getAltTextStringByType(c,d,e||b),disabled:this._isDisabled()}},render:function(){var a=this.getTemplateData();return a.disabled&&g.notifyRemoval(this.$el),this.$el.html(this.template(a)),a.disabled?(this.$el.addClass("yj-btn-disabled"),this.$el.attr("disabled","disabled")):(this.$el.removeClass("yj-btn-disabled"),this.$el.removeAttr("disabled")),this},enable:function(){return this},disable:function(){return this},_setupListeners:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model.get("recipients"),"add remove reset change",this.render),this.listenTo(this.model.get("files"),"add remove reset change",this.render),this.listenTo(this.model.get("ogos"),"add remove reset change",this.render)},_isDisabled:function(){return this.model.isBeingSubmitted()?!0:this._active?!this.model.isValidButRecipients():!this.model.isValid()},_onClick:function(){this.trigger("submit")},_getAltTextStringByType:function(a,c,d){var e=[k.PRIVATE_MESSAGE,k.PRIVATE_MESSAGE_WITH_EXTERNAL,k.PRIVATE_MESSAGE_WITH_MENTIONS],g=null;return d?g=b.contains(e,a)?f.t("send_including_other_network"):f.t("post_including_other_network"):a===k.PRIVATE_GROUP?g=f.t("post_to_private_group"):a===k.PRIVATE_GROUP_WITH_EXTERNAL&&(g=f.t("post_to_private_group_including_non_members",{count:c})),g},_getIcon:function(){var a=this.model.getType(),b=this._icons[a],c=this.model.getGroup();return c&&h.isExternal(c)&&(b=m),b}})}),define("feeds/lib/ui/publisher/global/unsaved_message_warner",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/tr","common-ui/lib/helper/environment"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/tr"),f=a("common-ui/lib/helper/environment"),g=["fancy-lightbox"],h=/\/api\/v1\/uploaded_files\/[0-9]+\/download\/?$/;return d.extend({defaults:function(){var a=e.t("your_message_has_not_been_posted_and_your_draft_will"),b={warning:a};return{strings:b,warnOnRouteChange:!0}},initialize:function(a){c.bindAll(this,"checkUnsavedMessage","_checkRouteChange","_linkClicked","_onBeforeUnload"),this._enabled=!0,this._strings=a.strings,this._warnOnRouteChange=a.warnOnRouteChange,b(window).on("beforeunload",this._onBeforeUnload),b("body").on("mouseup","a",this._linkClicked),this._warnOnRouteChange&&yam.router&&yam.router.on("before-route",this._checkRouteChange)},remove:function(){return b(window).off("beforeunload",this._onBeforeUnload),b("body").off("mouseup","a",this._linkClicked),this._warnOnRouteChange&&yam.router&&yam.router.off("before-route",this._checkRouteChange),d.prototype.remove.call(this)},enable:function(){return this._enabled=!0,this},disable:function(){return this._enabled=!1,this},checkUnsavedMessage:function(){return this._enabled&&this.model.hasUnsubmittedContent()?this._strings.warning:void 0},_onBeforeUnload:function(){var a=this._nextUrlValid;return this._nextUrlValid=void 0,a?void 0:this.checkUnsavedMessage()},_linkClicked:function(a){var c=b(a.currentTarget).attr("href"),d=c&&0===c.indexOf("javascript:"),e=c&&h.test(c);!f.isIE()&&d||(this._nextUrlValid=d||e)},_checkRouteChange:function(a){if(!a.handled&&!c.contains(g,a.currentRouteName)){var b=this.checkUnsavedMessage();null!=b&&(a.handled=!0,window.confirm(b)||a.preventRouteChange())}}})}),define("common-ui/lib/helper/yerf",["require","jquery","underscore","core/lib/location_helper","core/lib/log","core/lib/session","core/lib/treatment","core/lib/yammer_config"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/location_helper"),e=a("core/lib/log"),f=a("core/lib/session"),g=a("core/lib/treatment"),h=a("core/lib/yammer_config");return{_activeEvents:{},_eventsToReport:[],_addBrowserTimingsFlag:!1,_pageViewId:void 0,recordStart:function(a,b){this.isPerformanceNowBrowser()&&(void 0===b&&(b=window.performance.now()),this._activeEvents[a]&&e.warn("Event name "+a+" already set by Yerf."),this._activeEvents[a]={startTime:b})},recordParams:function(a,b){this._activeEvents[a]?c.extend(this._activeEvents[a],b):e.warn("no start event for "+a)},recordStop:function(a,b){var d;if(this.isPerformanceNowBrowser()){if(d=window.performance.now(),-1!==a.indexOf("_load_fresh")&&(this._addBrowserTimingsFlag=!0),!this._activeEvents[a])return void e.warn("no start event for "+a);if(this._activeEvents[a].startTime===d)return void e.warn("startTime equals stopTime");var f=this._activeEvents[a].startTime;e.log("yerf",a,JSON.stringify({diff:d-f,startTime:f,stopTime:d})),this._eventsToReport.push(c.extend({eventName:a,startTime:f,stopTime:d},this._activeEvents[a])),this._activeEvents[a]=void 0,b!==!0&&this.report()}},recordStopWithStart:function(a,b,c){this.isPerformanceNowBrowser()&&(this.recordStart(a,b),this.recordStop(a,c))},recordStopWithStartAndParams:function(a,b,c,d){this.isPerformanceNowBrowser()&&(this.recordStart(a,b),this.recordParams(a,c),this.recordStop(a,d))},buildCustomRecord:function(a){var b=c.extend(c.omit(a,"startTime","stopTime"),{time_taken:Math.round(a.stopTime-a.startTime)});return this.buildRecord(a.eventName,b)},buildRecord:function(a,b){b.PageViewId=this.getPageViewId(),b.RequestUrl=d.hash();var c={LogId:this.getUniqueId(),ClientId:1,UserId:f.getCurrentUser().get("id"),NetworkId:f.getCurrentNetwork().id,LogType:"performance",ClientTimeStamp:Date.now(),DeviceId:null,EventName:a,Parameters:b};return c},buildPayload:function(){var a,b=[],d=[];return 0===this._eventsToReport.length?"":(a=c.map(this._eventsToReport,function(a){return this.buildCustomRecord(a)},this),this.isPerformanceTimingBrowser()&&this._addBrowserTimingsFlag&&(b=this.prepareNavigationTiming()),g.treatment("prodsupport_fe_timing_all_resources")&&this.isResourceTimingBrowser()&&this._addBrowserTimingsFlag&&(d=this.prepareResourceEntries()),this._addBrowserTimingsFlag=!1,a=a.concat(b,d))},prepareNavigationTiming:function(){return this.buildRecord("navigation_timing",window.performance.timing)},prepareResourceEntries:function(){return c.map(window.performance.getEntriesByType("resource"),function(a){return this.buildRecord("resource_timing",a)},this)},onError:function(a){e.log(a.message)},getUniqueId:function(){return Math.random().toString(36).slice(2)},setPageViewId:function(){this._pageViewId=this.getUniqueId()},getPageViewId:function(){return this._pageViewId},report:function(){this.setPageViewId();var a=this.buildPayload();a&&b.ajax({url:h.config().reportPerfRequestUri,type:"POST",context:this,data:JSON.stringify(a),contentType:"application/json",success:function(){this._eventsToReport=[]},error:function(a,b,c){this.onError(new Error("Yerf: Error posting stats: "+b+" "+c))},headers:{Authorization:h.config().reportAuthorizationHeader}})},isPerformanceNowBrowser:function(){return!(!window.performance||"function"!=typeof window.performance.now)},isPerformanceTimingBrowser:function(){return!(!window.performance||void 0===window.performance.timing)},isResourceTimingBrowser:function(){return!(!window.performance||void 0===window.performance.getEntriesByType)}}}),define("stache!feeds/lib/ui/publisher/global/error_reporter",["mustache"],function(a){var b="{{message}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/error_reporter",[],function(){}),define("feeds/lib/ui/publisher/global/error_reporter",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_show_hide","html!./error_reporter","css!./error_reporter"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_show_hide"),e=a("html!./error_reporter");return a("css!./error_reporter"),b.extend({mixins:[c,d],className:"publisher-error-reporter",template:e,initialize:function(a){a.message?this.showMessage(a.message):this.hide()},getTemplateData:function(){return{message:this._message}},showMessage:function(a){this._message=a,this._setupListeners(),this.render(),this.show()},_setupListeners:function(){this.listenTo(this.model.get("allRecipients"),"change add remove reset",this._handleRecipientChange),this.listenTo(this.model,"change",this._handleRecipientChange)},_handleRecipientChange:function(){this.model.hasFailedRecipients()||(this.hide(),this.stopListening())}})}),define("css!feeds/lib/ui/publisher/global/base_publisher",[],function(){}),define("stache!feeds/lib/ui/publisher/global/base_publisher",["mustache"],function(a){var b='<div class="publisher-relative">\n  <div class="publisher-main">\n    <div class="publisher-body"></div>\n    <div class="publisher-recipients"></div>\n  </div>\n  <div class="publisher-warning"></div>\n  <div class="publisher-excerpt"></div>\n  <div class="publisher-actions">\n    <div class="publisher-topic"></div>\n    <div class="publisher-file"></div>\n    <div class="publisher-submit"></div>\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/base_publisher",["require","underscore","common-ui/lib/ui/shared/autocompletion","common-ui/lib/ui/shared/autocompletion/autocomplete_models","core/lib/backbone_legacy_integration","models/recipient","feeds/lib/ui/publisher/global/message_poster","feeds/lib/ui/publisher/global/file_menu","feeds/lib/ui/publisher/global/file_list","feeds/lib/ui/publisher/global/file_change_reporter","feeds/lib/ui/publisher/global/file_change_announcer","feeds/lib/ui/publisher/global/ogo_list","feeds/lib/ui/publisher/global/ogo_change_reporter","feeds/lib/ui/publisher/global/ogo_change_announcer","feeds/lib/ui/publisher/global/ogo_watcher","backbone","feeds/lib/ui/publisher/global/excerpt_container","core/lib/report","feeds/lib/ui/publisher/global/submit_button","core/lib/tr","core/lib/treatment","feeds/lib/ui/publisher/global/unsaved_message_warner","common-ui/lib/helper/yerf","feeds/lib/ui/publisher/global/publisher_errors","feeds/lib/ui/publisher/global/error_reporter","common-ui/lib/ui/accessibility/screenreader_announcer","models/helpers/group","css!./base_publisher","html!./base_publisher"],function(a){var b=a("underscore"),c=a("common-ui/lib/ui/shared/autocompletion"),d=a("common-ui/lib/ui/shared/autocompletion/autocomplete_models"),e=a("core/lib/backbone_legacy_integration"),f=a("models/recipient"),g=a("feeds/lib/ui/publisher/global/message_poster"),h=a("feeds/lib/ui/publisher/global/file_menu"),i=a("feeds/lib/ui/publisher/global/file_list"),j=a("feeds/lib/ui/publisher/global/file_change_reporter"),k=a("feeds/lib/ui/publisher/global/file_change_announcer"),l=a("feeds/lib/ui/publisher/global/ogo_list"),m=a("feeds/lib/ui/publisher/global/ogo_change_reporter"),n=a("feeds/lib/ui/publisher/global/ogo_change_announcer"),o=a("feeds/lib/ui/publisher/global/ogo_watcher"),p=a("backbone"),q=a("feeds/lib/ui/publisher/global/excerpt_container"),r=a("core/lib/report"),s=a("feeds/lib/ui/publisher/global/submit_button"),t=a("core/lib/tr"),u=a("core/lib/treatment"),v=a("feeds/lib/ui/publisher/global/unsaved_message_warner"),w=a("common-ui/lib/helper/yerf"),x=a("feeds/lib/ui/publisher/global/publisher_errors"),y=a("feeds/lib/ui/publisher/global/error_reporter"),z=a("common-ui/lib/ui/accessibility/screenreader_announcer"),A=a("models/helpers/group");a("css!./base_publisher");var B=f.TYPE;return e.extend({defaults:{icons:{},strings:{},showAlert:!0,warnOnRouteChange:!0,inLightbox:!1,allowAttachments:!0,logType:"yam.ui.publisher.global.BasePublisher",logSource:"default"},className:"yj-global-publisher yj-clearfix",initialize:function(a){this._icons=a.icons,this._strings=a.strings,this._showAlert=a.showAlert,this._warnOnRouteChange=a.warnOnRouteChange,this._inLightbox=a.inLightbox,this._allowAttachments=a.allowAttachments,this._logType=a.logType,this._logSource=a.logSource,this._activeSubmitButton=a.activeSubmitButton||a.noAllCompanyDefault,this._noAllCompanyDefault=a.noAllCompanyDefault,this._isExternalGroupPublishingAllowed=a.isExternalGroupPublishingAllowed,this._typeaheadFilter=a.typeaheadFilter,this.model=a.model||this._createModel(),this.poster=a.poster||new g({logType:this._logType,logSource:this._logSource}),null!=a.excerpt&&(this._excerpt=new q(a.excerpt)),this._createChildren(),this._setupListeners()},template:a("html!./base_publisher"),render:function(a){return this.renderTemplate(a),this.$recipients=this.$(".publisher-recipients"),this.$body=this.$(".publisher-body"),this._updateTitle(),this._updateType(),this._updateSharing(),this},enable:function(){return this._enableModel(),this._enableChildren(),this},disable:function(){return this._disableModel(),this._disableChildren(),this},focus:function(){return this._editor.focus(),this},blur:function(){return this._editor.blur(),this},refresh:function(){return this._editor.refresh(),this},clear:function(){return this._selector.clear(),this._editor.clear(),this},reset:function(){return this._ogoWatcher.reset(),this.model.clear(),this},isResettable:function(){return!this.model.hasUnsubmittedContent()},openFileMenu:function(){this._allowAttachments!==!1&&this._fileMenu.open()},_createOther:function(){},_createModel:function(){throw"Method not implemented"},_getEditorModel:function(){throw"Method not implemented"},_getEditorClass:function(){throw"Method not implemented"},_getSelectorClass:function(){throw"Method not implemented"},_getSelectorOptions:function(){throw"Method not implemented"},_getDropdownDirection:function(){throw"Method not implemented"},_requiresGroup:function(){throw"Method not implemented"},_createChildren:function(){this._createRecipientsArea(),this._createBodyArea(),this._createExcerptArea(),this._createFileArea(),this._createSubmitArea(),this._createMessageWarner(),this._createErrorReporter(),this._createOther()},_setupListeners:function(){b.bindAll(this,"_onSubmitSuccess","_onSubmitError"),this.listenTo(this.model,"clear",this.clear),this.listenTo(this.model,"change:state",this._updateChildren),
this.listenTo(this.model,"change:sharing",this._updateSharing),this.listenTo(this.model.get("recipients"),"add remove reset",this._updateTitle),this.listenTo(this.model.get("recipients"),"add remove reset",this._updateType),this.listenTo(this.model.get("recipients"),"add remove reset sort",b.debounce(this._scrollRecipientsToBottom,500)),this.listenTo(this.model.get("files"),"add remove reset",b.debounce(this._scrollBodyToBottom,500)),this.listenTo(this.model.get("ogos"),"add remove reset",b.debounce(this._scrollBodyToBottom,500)),this.listenTo(this,"show",this._onShowPublisher),b.each(this.children(),function(a){this.listenTo(a,"submit",this._onSubmit)},this)},_createRecipientsArea:function(){var a=this._getSelectorClass(),c=b.extend({collection:this.model.get("recipients"),strings:this._strings.selector,optimizeForGroupSelection:this._noAllCompanyDefault},this._getSelectorOptions());this._selector=new a(c),this.add(this._selector,".publisher-recipients")},_createBodyArea:function(){var a=this._getEditorClass(),b=this._getEditorModel();this._editor=new a({model:b,strings:this._strings.editor,inLightbox:this._inLightbox}),this._fileList=new i({collection:this.model.get("files"),inLightbox:this._inLightbox}),this._fileReporter=new j({collection:this.model.get("files")}),this._fileAnnouncer=new k({collection:this.model.get("files"),publisherElement:this.$el}),this._ogoList=new l({collection:this.model.get("ogos"),inLightbox:this._inLightbox}),this._ogoReporter=new m({collection:this.model.get("ogos")}),this._ogoAnnouncer=new n({collection:this.model.get("ogos"),publisherElement:this.$el}),this._ogoWatcher=new o({model:this.model}),this.add(this._editor,".publisher-body"),this.add(this._fileList,".publisher-body"),this.add(this._fileReporter,".publisher-body"),this.add(this._ogoList,".publisher-body"),this.add(this._ogoReporter,".publisher-body"),this.add(this._ogoWatcher,".publisher-body")},_createExcerptArea:function(){null!=this._excerpt&&this.add(this._excerpt,".publisher-excerpt")},_createFileArea:function(){this._allowAttachments!==!1&&(this._fileMenu=new h({model:this.model,inLightbox:this._inLightbox,direction:this._getDropdownDirection()}),this.add(this._fileMenu,".publisher-file"))},_createSubmitArea:function(){this._submitButton=new s({model:this.model,icons:this._icons.submit,strings:this._strings.submit,active:this._activeSubmitButton}),this.add(this._submitButton,".publisher-submit")},_createMessageWarner:function(){this._warner=new v({model:this.model,warnOnRouteChange:this._warnOnRouteChange}),this.add(this._warner)},_createErrorReporter:function(){this._errorReporter=new y({model:this.model}),this.prepend(this._errorReporter,".publisher-actions")},_invokeMethodOnChildren:function(a){var c=Array.prototype.slice(arguments,1);b.each(this.children(),function(d){b.isFunction(d[a])&&d[a].apply(d,c)})},_enableModel:function(){this._getEditorModel().set({enabled:!0})},_disableModel:function(){this._getEditorModel().set({enabled:!1})},_enableChildren:function(){this._invokeMethodOnChildren("enable")},_disableChildren:function(){this._invokeMethodOnChildren("disable")},_updateChildren:function(){this.model.isBeingSubmitted()?this._disableChildren():this._enableChildren()},_updateTitle:function(){var a=this._getTemplateData();this.trigger("change:title",a.title)},_updateType:function(){this.$el.attr("data-type",this.model.getType())},_updateSharing:function(){this.$el.attr("data-sharing",this.model.get("sharing"))},_scrollRecipientsToBottom:function(){this.$recipients&&this.$recipients.scrollTop(this.$recipients.prop("scrollHeight"))},_scrollBodyToBottom:function(){this.$body&&this.$body.scrollTop(this.$body.prop("scrollHeight"))},_getTemplateData:function(){var a=this.model.getType();return{title:null!=this._strings.titles?this._strings.titles[a]:""}},_onShowPublisher:function(){var a=this.model.getGroup();a&&(A.isExternal(a)||A.isPrivate(a))&&c.prefetchModels([d.USER.id,d.DOMAIN.id]),this.refresh(),this.focus()},_onSubmit:function(){if(!this.model.isValid()||this.model.isBeingSubmitted()||this.model.hasBeenSubmitted())this._handleEmptyRecipientsList();else{if(this._requiresGroup()){var a=this.model.findRecipient({type:[B.PUBLIC_GROUP,B.PRIVATE_GROUP]});if(null==a)return r.event("main_publisher_submitted_without_group",{publisher_type:this._logType,publisher_source:this._logSource}),void this._onSubmitMissingRequiredGroupHandler()}u.treatment("prodsupport_fe_timing")&&w.recordStart("send_message"),this.model.set({state:"submitting"}),this.poster.post(this.model,this._onSubmitSuccess,this._onSubmitError)}},_onSubmitSuccess:function(a){var b=this.model.getType();u.treatment("prodsupport_fe_timing")&&w.recordStop("send_message"),this.model.set({state:"submitted",submission:a}),this.reset(),this._showAlert?this._showSuccessMessage(b):this._announceSuccessMessage(b)},_onSubmitMissingRequiredGroupHandler:function(){this._noAllCompanyDefault?this._openAndFocusSelector():window.alert(t.t("please_add_a_group_to_the_list_of_recipients"))},_handleEmptyRecipientsList:function(){this._openAndFocusSelector()},_openAndFocusSelector:function(){this._selector.expand(),this._selector.focus()},_showSuccessMessage:function(a){var b=this._successMessageForType(a);this._showNoticeBanner(b)},_announceSuccessMessage:function(a){var b=this._successMessageForType(a);z.announceText(b)},_successMessageForType:function(a){return this._strings.successes[a]},_showNoticeBanner:function(a){p.trigger("/ui/alert/show","notice",a)},_onSubmitError:function(a){var b=this.model.getType();this.model.set({state:"failed",submission:a});var c=this._getError(a);null!=c&&this._showErrorMessage(c,b)},_getError:function(a){return a.error},_showErrorMessage:function(a,b){var c=this._getErrorMessage(a,b);x.isRecipientError(a.code)?(this._invalidateRecipients(a.data),this._showInlineError(c)):this._showErrorBanner(c)},_getErrorMessage:function(a,b){return x.isGenericPostingError(a.message)?this._errorMessageForType(b):a.message},_errorMessageForType:function(a){return this._strings.errors[a]},_showErrorBanner:function(a){p.trigger("/ui/alert/show","error",a)},_showInlineError:function(a){this._errorReporter.showMessage(a),p.trigger("/ui/lightbox/resize")},_invalidateRecipients:function(a){if(!b.isEmpty(a)){var c=this.model.get("allRecipients"),d=c.whereContains({email:a});b.each(d,function(a){a.set("status","failed")})}}})}),define("stache!feeds/lib/ui/shared/subscription_list_user",["mustache"],function(a){var b='<div class="yj-mugshot" data-id="{{avatarDataId}}"></div>\n<a class="yj-name" href="{{web_url}}" data-id="{{avatarDataId}}"><span class="yj-name-container">{{full_name}}</span></a>\n<p class="yj-description">{{job_title}}</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/shared/subscription_list_domain",["mustache"],function(a){var b='<div class="yj-mugshot" data-id="{{avatarDataId}}"></div>\n<span class="yj-subscription-list-email-address">{{id}}</span>\n{{#foreign}}\n  <div class="yj-subscription-list--item-info">\n    <span class="yj-subscription-list--network">\n      <span class="yamicon yamicon-network">\n        <span class="yj-acc-hidden">{{foreignIconAltText}}</span>\n      </span><span class="yj-subscription-list--network-info">{{domain}}</span>\n    </span>\n  </div>\n{{/foreign}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/shared/subscription_list_group",["mustache"],function(a){var b='{{#web_url}}\n<a href="{{web_url}}" tabindex="-1" aria-hidden="true">\n{{/web_url}}\n  <img class="yj-mug" src="{{mugshot_url}}" alt="">\n{{#web_url}}\n</a>\n{{/web_url}}\n{{#web_url}}\n  <a class="yj-name" href="{{web_url}}">{{full_name}}</a>\n{{/web_url}}\n{{^web_url}}\n  <span class="yj-name">{{full_name}}</a>\n{{/web_url}}\n<div class="yj-subscription-list--item-info">\n{{^foreign}}\n  <span class="yj-subscription-list--network">\n    <span class="yamicon yamicon-lock-MSFT"></span><span class="yj-subscription-list--network-info">{{group_info}}</span>\n  </span>\n{{/foreign}}\n{{#foreign}}\n  <span class="yj-subscription-list--network">\n    <span class="yamicon yamicon-network">\n      <span class="yj-acc-hidden">{{foreignIconAltText}}</span>\n    </span><span class="yj-subscription-list--network-info">{{group_info}}</span>\n  </span>\n{{/foreign}}\n</div>\n<p class="yj-description">{{description}}</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/shared/subscription_list_topic",["mustache"],function(a){var b='<a class="yj-name" href="{{web_url}}">{{name}}</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/shared/subscription_list_network",["mustache"],function(a){var b='<img class="yj-mug" src="{{mugshot_url}}" alt="">\n<span class="yj-name">{{name}}</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/shared/subscription_list_separator",["mustache"],function(a){var b='<li class="yj-subscription-list--separator-h{{header_level}}">{{title}}</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/shared/subscription_list",[],function(){}),define("feeds/lib/ui/shared/subscription_list",["require","jquery","underscore","core/lib/session","core/lib/tr","components/avatar/index","core/lib/jam/component","models/user","collections/groups","models/group","common-ui/lib/ui/shared/spinner","common-ui/lib/ui/shared/scroll_watcher","models/helpers/user","core/lib/util/email_extractor","core/lib/yammer_api","core/lib/yammer_uri","components/network_label/src/network_label","mustache","models/network","html!./subscription_list_user","html!./subscription_list_domain","html!./subscription_list_group","html!./subscription_list_topic","html!./subscription_list_network","html!./subscription_list_separator","common-ui/lib/ui/shared/follow_button","common-ui/lib/ui/shared/more_button","models/user","core/lib/util/email_extractor","css!./subscription_list"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/session"),e=a("core/lib/tr"),f=a("components/avatar/index"),g=a("core/lib/jam/component"),h=a("models/user"),i=a("collections/groups"),j=a("models/group"),k=a("common-ui/lib/ui/shared/spinner"),l=a("common-ui/lib/ui/shared/scroll_watcher"),m=a("models/helpers/user"),n=a("core/lib/util/email_extractor"),o=a("core/lib/yammer_api"),p=a("core/lib/yammer_uri"),q=a("components/network_label/src/network_label"),r=a("mustache"),s=a("models/network"),t=a("html!./subscription_list_user"),u=a("html!./subscription_list_domain"),v=a("html!./subscription_list_group"),w=a("html!./subscription_list_topic"),x=a("html!./subscription_list_network"),y=a("html!./subscription_list_separator"),z=a("common-ui/lib/ui/shared/follow_button");a("common-ui/lib/ui/shared/more_button"),a("models/user"),a("core/lib/util/email_extractor"),a("css!./subscription_list");var A;return A=g.extend({init:function(a,c){g.prototype.init.call(this,b.extend(!0,{},this.defaults,a),c),this.page=1,this.addSpinner(),this.paginate&&this.addBottomSpinner()},defaults:{id:"subscriptionList",initialized:!1,type:A,settings:{elementClassName:"yj-subscription-list"},avatarSize:48,paginate:!1},afterRender:function(){this.$list=this.$element.find(".yj-follow-list"),this.paginate&&this.addScrollWatcher()},template:'<div class="{{className}}"><ul class="yj-follow-list"></ul></div>',itemsTemplate:["{{#items}}",'<li class="yj-follow-item follow-{{type}}">','<div class="yj-actions"></div>',"{{{info}}}","</li>","{{/items}}"].join(""),descriptionTemplates:{user:t,domain:u,group:v,topic:w,network:x},createElement:function(){this.$element=b(r.render(this.template,{className:this.settings.elementClassName}))},addSpinner:function(){this.spinner=new k,this.spinner.prependToTarget=!0,this.addComponent(this.spinner),this.hideSpinner()},showSpinner:function(){this.spinner&&this.spinner.$el.show()},hideSpinner:function(){this.spinner&&this.spinner.$el.hide()},addBottomSpinner:function(){this.bottomSpinner=new k,this.addComponent(this.bottomSpinner),this.hideBottomSpinner()},showBottomSpinner:function(){this.bottomSpinner&&this.bottomSpinner.$el.show()},hideBottomSpinner:function(){this.bottomSpinner&&this.bottomSpinner.$el.hide()},addScrollWatcher:function(){this.infiniteScroll=new l({onReached:c.bind(function(){this.showBottomSpinner(),this.load()},this),$scrollableArea:this.$element,$contentArea:this.$element.find(".yj-follow-list"),triggerOffset:10})},load:function(){var a,b=this.settings.dataRequest,d=c.clone(this.data);if(d.page=this.page,b){if(a=o[b],"function"!=typeof a)throw new Error("SubscriptionList - "+b+" is invalid.");this.showSpinner(),a(d).then(this.dataRequestSuccessCallback.bind(this),this.dataRequestFailureCallback.bind(this))}},dataRequestSuccessCallback:function(a){var b=a.references||a.users||a;this.addToRepository(b,a.meta),this.hideSpinner(),this.loadItems(b,a.more_available),this.paginate&&this.onPageLoad(a)},onPageLoad:function(a){this.page++,this.hideBottomSpinner(),a.more_available&&this.infiniteScroll.restart()},dataRequestFailureCallback:function(){this.hideSpinner(),this.hideBottomSpinner()},appendItems:function(a){var b=[];this.$list.append(r.render(this.itemsTemplate,a)),b.push.apply(b,this.addSubscribeButtons(a.items)),b.push.apply(b,this.addAvatars(a.items)),b.push.apply(b,this.addNetworkLabelsForUsers(a.items)),this.renderChildren(b)},loadSectionedItems:function(a){this.hideSpinner(),c.each(a,function(a){var b=this.prepViewData(a.items);a.title&&this.$list.append(y({title:a.title,header_level:c.isEmpty(a.items)?"1":"2"})),this.appendItems(b)},this)},loadItems:function(a){var b=this.prepViewData(a);this.hideSpinner(),this.appendItems(b)},_getNetworkName:function(a){return m.getNetworkName(a,s)||n.getDomainFromEmail(a.id)},prepViewData:function(a){var b=this.descriptionTemplates,f=d.getCurrentNetwork(),g=f&&f.id,h=c.compact(c.map(a,function(a){var d=c.isFunction(a.toJSON)?a.toJSON():c.clone(a);if(d.foreign=a.foreign||null!=g&&null!=a.network_id&&a.network_id!=g,d.avatarDataId=c.uniqueId("avatar-"),d.foreign&&(d.foreignIconAltText=e.t("other_network_icon_alttext"),d.domain=this._getNetworkName(d)),"user"==d.type){var f=yam.model.User.findById(d.id);return f&&c.extend({},f,d),"pending"===d.state?d.job_title=e.t("pending_user"):"suspended"!==d.state&&"deleted"!==d.state||(d.job_title=e.t("former_member")),c.extend(d,{info:b.user(d)})}if("group"==d.type){var h=i.get(d.id);return"COMPANY_GROUP_ID"===d.id&&(h=j.ALL_COMPANY()),h&&c.extend(d,h.toJSON()),d.foreign&&(d.mugshot_url="/mugshot/images/48x48/group_profile.png"),d.private=h.isPrivate(),h.isPrivate()&&(h.isForeign()?d.group_info=e.t("count_members_within_network",{count:d.members,network:d.domain||d.networkName}):d.group_info=e.t("private_group_count_members",{count:d.members})),c.extend(d,{info:b.group(d)})}return"domain"==d.type?(c.extend(d,{mugshot_url:p.cdn("assets/images/avatars/no_photo.png")}),d.foreign=!1,c.extend(d,{info:b.domain(d)})):"network"==d.type?(c.extend(d,{mugshot_url:"/mugshot/images/48x48/network.png"}),c.extend(d,{info:b.network(d)})):void 0},this));return this.comparator&&(h=c.sortBy(h,this.comparator)),{className:this.settings.elementClassName,selected:this.selected,items:h}},getItemClassName:function(a){return"follow-"+a.type+"-"+a.id},createSubscribeButton:function(a){return new z(a)},addToSubscriptionModel:function(a){c(a).each(function(a){m.followUser(d.getCurrentUser(),a)})},addSubscribeButtons:function(a){for(var b,c,e,f=[],g=0,h=a.length;h>g;g++)c=a[g],"user"==c.type&&c.id===d.getCurrentUser().id||("user"!=c.type||c.id==d.getCurrentUser().id||"suspended"!=c.state&&"deleted"!=c.state)&&"user"==c.type&&(m.isForeign(c,d)||(e={model:c,target:"."+this.getItemClassName(c)+" .yj-actions"},b=this.createSubscribeButton(e),f.push(b),this.addComponent(b)));return f},addAvatars:function(a){return c.map(a,function(a){var b=new f({model:a,size:this.settings.avatarSize,withHovercard:!1,hideFromAccessibility:!0});return this.addChild(b,'.yj-mugshot[data-id="'+a.avatarDataId+'"]'),b},this)},addNetworkLabelsForUsers:function(a){var b=c.filter(a,function(a){return"user"===a.type});return c.map(b,function(a){var b=new h(a),c=new q({model:b});return this.addChild(c,'.yj-name[data-id="'+a.avatarDataId+'"]'),c},this)},addToRepository:function(a,b){b&&(yam.modelController._initMeta(b),b.followed_user_ids&&this.addToSubscriptionModel(b.followed_user_ids)),c.each(a,function(a){switch(a.type){case"user":yam.model.User.save(a);break;case"group":i.add(a)}})}})}),define("feeds/lib/ui/shared/subscription_list_lightbox",["require","jquery","backbone","feeds/lib/ui/shared/subscription_list"],function(a){var b,c=a("jquery"),d=a("backbone"),e=a("feeds/lib/ui/shared/subscription_list");return b=e.extend({defaults:{id:"subscriptionListLightbox",settings:{title:"",width:"400px",open:!1,onOpen:!1,elementClassName:"yj-subscription-list"},selected:!0,type:b},init:function(a,b){e.prototype.init.call(this,c.extend(!0,{},this.defaults,a),b),this.render();var f=this,g=this.$element;a={title:this.settings.title,width:this.settings.width,html:g,onOpen:function(){f.load()},onClosed:function(){f.destroyItems()}},this.settings.style&&(a.style=this.settings.style),this.settings.open?d.trigger("/ui/lightbox/open",a):d.trigger("/ui/lightbox/bind",this.$toggle,a)},destroyItems:function(){this.$element.find("li").remove()}})}),define("stache!components/simple_lightbox/src/simple_lightbox",["mustache"],function(a){var b='{{#title}}\n  <h1 id="yj-simple-lightbox--title" class="yj-acc-hidden">{{title}}</h1>\n{{/title}}\n<div class="yj-simple-lightbox--content">\n  <LightboxContent />\n</div>\n<a role="button" href="javascript://" class="yj-simple-lightbox--close-button yamicon-x yamicon-large yamicon" data-speechtip>\n  <span class="yk-acc-hidden">{{close}}</span>\n</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/simple_lightbox/src/simple_lightbox",[],function(){}),define("components/simple_lightbox/src/simple_lightbox",["require","jquery","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","backbone","core/lib/tr","common-ui/lib/ui/accessibility/lightbox_accessibility","html!./simple_lightbox","css!./simple_lightbox"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("backbone"),g=a("core/lib/tr"),h=a("common-ui/lib/ui/accessibility/lightbox_accessibility"),i="yj-simple-lightbox-open",j=27,k=12,l=a("html!./simple_lightbox");return a("css!./simple_lightbox"),c.extend({template:l,className:"yj-simple-lightbox",attributes:{role:"dialog","aria-labelledby":"yj-simple-lightbox--title"},mixins:[d,e],events:{"click .yj-simple-lightbox--close-button":"_handleCloseBtnClick",click:"_handleBackgroundClick"},views:{LightboxContent:"_getLightboxContent"},initialize:function(a){yam.router&&(this.page=yam.router.getCurrentFragment()),this.$container=b("body"),this.$topContainer=b("html"),this._initializeComponent(a),this._setupEventListeners()},_initializeComponent:function(a){if(this.component=a.component,!this.component)throw new Error("SimpleLightbox requires `component`")},_setupEventListeners:function(){f.on("/ui/simple-lightbox/close",this._hideAndRemove,this),this.listenTo(this.component,"close",this._hideAndRemove.bind(this)),yam.router&&this.listenTo(yam.router,"route",function(){this._isPageNew()&&this._hideAndRemove()}.bind(this)),this.$container.on("keydown.simpleLightbox",this._onKeyDown.bind(this))},_getLightboxContent:function(){return this.component},_isPageNew:function(){return!yam.router||!this.page||yam.router.getCurrentFragment()!==this.page},getTemplateData:function(){return{close:g.t("close"),title:this.options.title}},render:function(){this.$(".yj-simple-lightbox--content").addClass(this.options.lbClass),b("body").hasClass("non-sticky")||this._repositionCloseButton()},show:function(){h.beforeModalShow(),this.render(),this._attach(),this._fadeIn(),h.afterModalShow(this.el,this.$(".yj-simple-lightbox--close-button").get(0))},_repositionCloseButton:function(){var a=b("#header-container");this.$(".yj-simple-lightbox--close-button").css({top:a.height()+k})},_attach:function(){this.$container.append(this.el),this.$topContainer.addClass(i)},_fadeIn:function(){this.$el.fadeIn("fast",this._childOpenHook.bind(this))},_handleBackgroundClick:function(a){this._isTargetBackground(a)&&this._hideAndRemove()},_onKeyDown:function(a){a.which===j&&this._hideAndRemove()},_handleCloseBtnClick:function(){this._hideAndRemove()},_hideAndRemove:function(){this.trigger("close"),this.$el.fadeOut("fast",this.remove.bind(this))},remove:function(){return this._childCloseHook(),this._removeEventListeners(),this._removeOpenClass(),h.afterModalDone(),c.prototype.remove.call(this)},_childOpenHook:function(){this.options.onComplete&&this.options.onComplete()},_childCloseHook:function(){this.component.onLightboxClose&&this.component.onLightboxClose()},_removeEventListeners:function(){f.off("/ui/simple-lightbox/close",this._hideAndRemove,this),this.$container.off("keydown.simpleLightbox")},_removeOpenClass:function(){this.$topContainer.removeClass(i)},_isTargetBackground:function(a){return b(a.target).is(this.$el)}})}),define("components/simple_lightbox/index",["require","./src/simple_lightbox"],function(a){"use strict";return a("./src/simple_lightbox")}),define("stache!feeds/lib/ui/publisher/global/privacy_list",["mustache"],function(a){var b='<h1 class="yj-privacy-list--header" id="yj-simple-lightbox--title">{{title}}</h1>\n<SubscriptionList/>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/privacy_list",[],function(){}),define("feeds/lib/ui/publisher/global/privacy_list",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_subviews","core/lib/backbone_with_auto_render","core/lib/urls","backbone","models/group","collections/groups","models/recipient","models/network","feeds/lib/ui/shared/subscription_list_lightbox","common-ui/lib/ui/shared/scroll_watcher","common-ui/lib/ui/shared/spinner","components/simple_lightbox/index","core/lib/session","core/lib/tr","core/lib/yammer_uri","core/lib/yammer_request","models/helpers/network","models/helpers/group","html!./privacy_list","css!./privacy_list"],function(a){function b(a){var b=q.getCurrentNetwork();return a.network?(a.network_id=a.network.id,a.network_name=a.network.name):(a.network_id=b.id,a.network_name=b.name),a.group_member&&(a.group_member_state=a.group_member.state||a.group_member.status),a.web_url=g.userIndex(a,q),a.full_name=a.name,a.type="user",a}var c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/backbone_with_auto_render"),g=a("core/lib/urls"),h=a("backbone"),i=a("models/group"),j=a("collections/groups"),k=a("models/recipient"),l=a("models/network"),m=a("feeds/lib/ui/shared/subscription_list_lightbox"),n=a("common-ui/lib/ui/shared/scroll_watcher"),o=a("common-ui/lib/ui/shared/spinner"),p=a("components/simple_lightbox/index"),q=a("core/lib/session"),r=a("core/lib/tr"),s=a("core/lib/yammer_uri"),t=a("core/lib/yammer_request"),u=a("models/helpers/network"),v=a("models/helpers/group"),w=a("html!./privacy_list");a("css!./privacy_list");var x=k.TYPE,y={GROUP:"group",INVITED_USERS:"invitedUsers",FOREIGN_USERS:"foreignUsers",ADDING_USERS:"addingUsers"},z={ADDING_USERS:"addingUsers",CONVERSATION_USERS:"conversationUsers",GROUP:"group",NETWORK:"network"},A=function(){return!0};return d.extend({defaults:function(){return{strings:{title:r.t("visible_to")}}},template:w,mixins:[f,e],views:{SubscriptionList:"_getSubscriptionList"},className:"yj-global-privacy-list external_groups_v1",initialize:function(a){this._strings=a.strings,this._lightbox=new d,c.bindAll(this,"_filterUsers")},remove:function(){return this._removeLightbox(),this._simpleLightbox&&this._simpleLightbox.remove(),d.prototype.remove.call(this)},show:function(a){if(null!=m){void 0===a&&(a=A);var d=this.model,e=this._getGroup(),f=c.filter(this.model.getInvitedUsers(),a),g=c.filter(this.model.getForeignUsers(),a),i=f.length||g.length,j=!(e||i);if(!j){h.trigger("/ui/tooltip/hide"),this._removeLightbox();var k,l=this._getLightboxSettings(),q=function(a){return!a.getType||x.PUBLIC_GROUP!==a.getType()},r=this._newGetSectionList(function(b){return a(b)&&q(b)}),u=function(a){var b=[x.PUBLIC_GROUP,x.PRIVATE_GROUP];return!a.getType||!c.contains(b,a.getType())};k=this._newGetSectionList(function(b){return a(b)&&u(b)}),this._lightbox=new m({avatarSize:32,loadPaginatedItems:function(){var a=d.getGroup();t.send({url:encodeURI(s.app())+"/groups/"+encodeURIComponent(a.get("id"))+"/get_members?page="+ ++this.memberPage,method:"GET",dataType:"json",success:function(a){1===this.memberPage&&this.loadSectionedItems(k);var d=c.chain(a.users).map(b).filter(function(a){return"approved"===a.group_member_state}).value(),e=c.reduce(d,function(a,b){if(!a[b.network_id]){var c=this.lastShownNetwork===b.network_id;a[b.network_id]={items:[],title:c?null:b.network_name}}return a[b.network_id].items.push(b),this.lastShownNetwork=b.network_id,a},{},this);this.loadSectionedItems(c.values(e)),50===a.users.length&&this.infiniteScroll.restart()}.bind(this),error:function(){this.loadSectionedItems(r)}.bind(this),complete:function(){this.bottomSpinner&&this.bottomSpinner.remove()}.bind(this)})},load:function(){var a=d.getGroup();a&&(v.isPrivate(a)||v.isExternal(a))?(this.memberPage=0,this.infiniteScroll=new n({onReached:function(){this.bottomSpinner=new o,this.bottomSpinner.render(),this.$el.append(this.bottomSpinner.$el),this.loadPaginatedItems()}.bind(this),$scrollableArea:this.$element,$contentArea:this.$element.find(".yj-follow-list")}),this.loadPaginatedItems()):this.loadSectionedItems(k)},onLightboxClose:function(){this.destroyItems()},settings:l}),this._simpleLightbox=new p({component:this,lbClass:"yj-privacy-list--lightbox",onComplete:function(){this._lightbox.load()}.bind(this)}),this._simpleLightbox.show()}}},getTemplateData:function(){var a=this._getLightboxSettings();return{title:a.title}},_removeLightbox:function(){this._lightbox&&(this._lightbox.destroy?this._lightbox.destroy():this._lightbox.remove())},_getLightboxSettings:function(){var a=!c.isEmpty(this._getAddingUsers()),b={open:!1,title:a?r.t("you_are_adding_2"):this._strings.title},d=c.isEmpty(this._getRecipientsBySectionType(y.GROUP));return d&&!a&&c.extend(b,{style:"yj-colorbox--privacy-list-headless"}),c.extend(b,{avatarSize:32}),b},_getSubscriptionList:function(){return this._lightbox},_getGroup:function(){return this.model.findRecipient({type:[x.PRIVATE_GROUP,x.PUBLIC_GROUP]})},_getNetwork:function(){var a,b=this.model.getGroup();return b&&v.isPublic(b)?(a=v.getNetwork(b,l),a?a:q.getCurrentNetwork()):null},_getAddingUsers:function(){var a=c.chain(this.model.getInvitedUsers()).union(this.model.getForeignUsers()).value(),b=c.filter(a,function(a){return!a.get("implicit")}),d=this.model.getGroup();return c.filter(b,function(a){return!d||!c.contains(a.get("groupIds"),d.get("id"))})},_filterImplicitUsers:function(a){return a.get("implicit")},_filterOutCurrentUser:function(a){return q.getCurrentUser().id!==a.id},_filterUsers:function(a){return this._filterImplicitUsers(a)&&this._filterOutCurrentUser(a)},_newGetRecipientsBySectionType:function(a){switch(a){case z.ADDING_USERS:return this._getAddingUsers();case z.CONVERSATION_USERS:var b=c.union(this.model.getInvitedUsers(),this.model.getForeignUsers());return c.filter(b,this._filterUsers);case z.GROUP:var d=this.model.findRecipient({type:[x.PUBLIC_GROUP,x.PRIVATE_GROUP]});return c.compact([d]);case z.NETWORK:return c.compact([this._getNetwork()]);default:return[]}},_getRecipientsBySectionType:function(a){switch(a){case y.ADDING_USERS:return this._getAddingUsers();case y.GROUP:var b=this.model.findRecipient({type:[x.PUBLIC_GROUP,x.PRIVATE_GROUP]});if(b){var d=j.get(b.getId());if("COMPANY_GROUP_ID"===b.getId()&&(d=i.ALL_COMPANY()),d&&v.isPublic(d))return c.compact([this._getNetwork()])}return c.compact([b]);case y.INVITED_USERS:return c.filter(this.model.getInvitedUsers(),this._filterUsers);case y.FOREIGN_USERS:return c.filter(this.model.getForeignUsers(),this._filterUsers)}return[]},_newGetSectionsByRecipients:function(a,b){if(0===a.length)return[];var d=c.map(a,function(a){return u.isNetwork(a)?u.toOriginalHash(a):a.toOriginalHash()});switch(b){case z.ADDING_USERS:case z.NETWORK:case z.GROUP:return[{items:d}];case z.CONVERSATION_USERS:return[{title:r.t("just_in_this_conversation"),items:d}]}},_getSectionsByRecipients:function(a,b){if(0===a.length)return[];var d=c.map(a,function(a){return u.isNetwork(a)?u.toOriginalHash(a):a.toOriginalHash()});switch(b){case y.ADDING_USERS:case y.GROUP:return[{items:d}];case y.FOREIGN_USERS:return[{items:d,title:r.t("not_in_your_network")}];case y.INVITED_USERS:return[{items:d,title:this.model.isForeign()?r.t("members_of_your_network"):r.t("not_in_the_group")}]}},_hasNotOnlyAddingUsers:function(a){var b=!c.isEmpty(a[y.ADDING_USERS]),d=c.chain(y).without(y.ADDING_USERS).reduce(function(b,d){return b||!c.isEmpty(a[d])},!1).value();return b&&d},_newHasNotOnlyAddingUsers:function(a){var b=!c.isEmpty(a[z.ADDING_USERS]),d=c.chain(z).without(z.ADDING_USERS).reduce(function(b,d){return b||!c.isEmpty(a[d])},!1).value();return b&&d},_newGetSectionList:function(a){var b=[z.ADDING_USERS,z.CONVERSATION_USERS,z.GROUP,z.NETWORK],d=function(b,d){var e=this._newGetRecipientsBySectionType(d);return e=c.filter(e,a),c.isEmpty(e)||(b[d]=this._newGetSectionsByRecipients(e,d)),b},e=c.reduce(b,d,{},this);return this._newHasNotOnlyAddingUsers(e)&&e[y.ADDING_USERS].push({title:this._strings.title}),c.chain(e).values().flatten().value()}})}),define("stache!feeds/lib/ui/publisher/global/privacy_warning",["mustache"],function(a){var b='{{#content}}\n<div class="warning-bar{{#flash}} flash-warning{{/flash}}">\n  <span class="warning-icon yamicon yamicon-asterisk" aria-hidden="true"></span>\n  <div class="warning-label">{{{content}}}</div>\n  <div class="privacy-container">\n    {{#icon}}\n    <span class="privacy-icon yamicon yamicon-{{icon}}"{{#iconqaid}} data-qaid="{{iconqaid}}"{{/iconqaid}}></span>\n    {{#count}}\n    <span class="privacy-count">+{{count}}</span>\n    {{/count}}\n    {{/icon}}\n  </div>\n</div>\n{{/content}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/privacy_warning",[],function(){}),define("feeds/lib/ui/publisher/global/privacy_warning",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","core/lib/tr","core/lib/session","models/message_backbone","models/recipient","feeds/lib/ui/publisher/global/privacy_list","core/lib/yammer_config","models/helpers/group","models/helpers/network","html!./privacy_warning","css!./privacy_warning"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("core/lib/tr"),h=a("core/lib/session"),i=a("models/message_backbone"),j=a("models/recipient"),k=a("feeds/lib/ui/publisher/global/privacy_list"),l=a("core/lib/yammer_config"),m=a("models/helpers/group"),n=a("models/helpers/network"),o=a("html!./privacy_warning");a("css!./privacy_warning");var p=j.TYPE,q=i.TYPE,r=b.object([[q.EMPTY,null],[q.ALL_COMPANY,null],[q.ALL_COMPANY_WITH_EXTERNAL,"lock-MSFT"],[q.PUBLIC_GROUP,null],[q.PUBLIC_GROUP_WITH_EXTERNAL,"lock-MSFT"],[q.PRIVATE_GROUP,"lock-MSFT"],[q.PRIVATE_GROUP_WITH_EXTERNAL,"lock-MSFT"],[q.PRIVATE_MESSAGE,"lock-MSFT"],[q.PRIVATE_MESSAGE_WITH_EXTERNAL,"lock-MSFT"],[q.PRIVATE_MESSAGE_WITH_MENTIONS,"lock-MSFT"]]);return c.extend({mixins:[d,e,f],defaults:{icons:r,inLightbox:!1
},className:"yj-global-privacy-warning",template:o,events:{"click .external-users":"_showExternalUserList"},initialize:function(a){this._icons=a.icons,this._inLightbox=a.inLightbox,this._createChildren(),this._setupListeners()},getTemplateData:function(){var a=this.model.getGroup(),b=this.model.getInvitedUsers(),c=this.model.getForeignUsers(),d=this.model.getType(),e=this._icons[d],f=this.model.findRecipients({type:[p.USER,p.DOMAIN],external:!0}).length;return(c.length||m.isExternal(a))&&(f=0,e="network"),{content:this._getWarningContent(b,c),flash:this._flash,icon:e,iconqaid:c.length?"flexternal_warning":null,count:f}},render:function(){return this._isSubtle=this._isSubtleWarning(),this.$el.attr("data-qaid",this._isSubtle?"privacy_warning_subtle":"privacy_warning"),this.$el.toggleClass("warning-subtle",this._isSubtle),this},remove:function(){return this.subscriptionList&&this.subscriptionList.destroy(),c.prototype.remove.call(this)},_createChildren:function(){this._list=new k({model:this.model})},_setupListeners:function(){var a=this.model.get("thread");this.listenTo(this.model.get("ogos"),"change add remove reset",this.render),this.listenTo(this.model.get("allRecipients"),"change add remove reset",this.render),a&&this.listenTo(a,"change",this.render)},_hasNonImplicitRecipients:function(a){return b.some(a,function(a){return!a.get("implicit")})},_getWarningContent:function(){var a=this._getWarningMessage();if(a&&this._isPrivateMessage()&&(a="flexternal_warning_pm"),!this.model.hasFailedRecipients()){var b={link:this._inLightbox||this._isEmbed()?"{$0}":'<a class="external-users" href="#" role="button" data-qaid="warning_recipient_link">{$0}</a>',group:this._getGroupNameForPrivateSharedMessage()};return this._flash=this._shouldShowFlash(a),this._lastMessage=a,g.t(a,b)}},_shouldShowFlash:function(a){return this.hasOwnProperty("_flash")&&this._lastMessage!==a&&!this._isSubtle},_findUsers:function(a){return this.model.findRecipients(b.extend({type:[p.USER,p.DOMAIN]},a))},_hasExternalGroup:function(){var a=h.getCurrentNetwork();return n.isExternalMessagingEnabled(a)&&this.model.findRecipients({external:!0,type:[p.PUBLIC_GROUP,p.PRIVATE_GROUP]}).length>0},_hasPublicGroup:function(){return this.model.findRecipients({external:!1,type:[p.PUBLIC_GROUP]}).length>0},_filterGroupMembers:function(a){var c=this.model.getGroup();return!c||!b.contains(a.get("groupIds"),c.get("id"))},_hasImplicitFlexternal:function(){var a=this.model.isReply(),b=this._findUsers({implicit:!0,external:!0,foreign:!0}).length>0;return b||this._hasExternalGroup()&&a},_hasImplicitXmess:function(){return this._findUsers({implicit:!0,external:!0,foreign:!1}).length>0},_hasNewFlexternal:function(){return b.filter(this._findUsers({implicit:!1,external:!0,foreign:!0}),b.bind(this._filterGroupMembers,this)).length>0},_hasNewXmess:function(){return this._findUsers({implicit:!1,external:!0,foreign:!1}).length>0},_getWarningMessage:function(){var a=this._hasImplicitFlexternal(),b=this._hasImplicitXmess(),c=this._hasNewFlexternal(),d=this._hasNewXmess(),e=!!this._getPrivateSharedMessage();if(!a&&!b){if(c&&d)return"no_implicit_adding_flexternal_and_xmess";if(c)return"no_implicit_adding_flexternal";if(d)return"no_implicit_adding_xmess";if(this._hasExternalGroup())return"no_implicit_external_group"}if(!c&&!d){if(a&&b)return"implicit_flexternal_and_xmess_no_new";if(a)return"implicit_flexternal_no_new";if(b)return"implicit_xmess_no_new"}if(a&&b&&(c||d))return"implicit_flexternal_and_xmess_new_either";if(a){if(d&&c)return"implicit_xmess_new_flexternal";if(d)return"implicit_flexternal_new_xmess";if(c)return"implicit_flexternal_new_flexternal"}if(b){if(d)return"implicit_xmess_new_xmess";if(c)return"implicit_xmess_new_flexternal"}return e?"share_private_message_warning":void 0},_getPrivateSharedMessage:function(){var a=this.model.get("ogos");return a.find(function(a){return!!a.get("sharedMessageId")&&a.get("sharedMessagePrivate")})},_getGroupNameForPrivateSharedMessage:function(){var a=this._getPrivateSharedMessage();return a&&a.get("sharedMessageGroup")||""},_isPrivateMessage:function(){var a=this.model.getType();return a===q.PRIVATE_MESSAGE||a===q.PRIVATE_MESSAGE_WITH_EXTERNAL||a===q.PRIVATE_MESSAGE_WITH_MENTIONS},_isSubtleWarning:function(){var a=this.model.get("allRecipients").models;return!b.any(a,function(a){var c=a.get("foreign"),d=a.get("implicit"),e=a.get("external"),f=b.contains([p.PRIVATE_GROUP,p.PUBLIC_GROUP],a.get("type"));return e&&(f||c||!d)})},_showExternalUserList:function(a){a.preventDefault(),a.stopPropagation(),this._inLightbox||this._list.show()},_isEmbed:function(){return l.config().isEmbed}})}),define("stache!feeds/lib/ui/publisher/global/message_publisher_recipients_on_top",["mustache"],function(a){var b='<div class="publisher-relative">\n  <div class="publisher-main">\n    <div class="publisher-recipients"></div>\n    <div class="publisher-body"></div>\n  </div>\n  <div class="publisher-warning"></div>\n  <div class="publisher-excerpt"></div>\n  <div class="publisher-actions">\n    <div class="publisher-file"></div>\n    <div class="publisher-submit"></div>\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/publisher/global/message_publisher_recipients_beneath",["mustache"],function(a){var b='<div class="publisher-relative">\n  <div class="publisher-main">\n    <div class="publisher-body"></div>\n    <div class="publisher-recipients"></div>\n  </div>\n  <div class="publisher-warning"></div>\n  <div class="publisher-excerpt"></div>\n  <div class="publisher-actions">\n    <div class="publisher-file"></div>\n    <div class="publisher-submit"></div>\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/message_publisher",["require","underscore","core/lib/session","core/lib/tr","models/message_backbone","common-ui/lib/ui/shared/type_ahead","feeds/lib/ui/publisher/global/body_editor","feeds/lib/ui/publisher/global/recipient_selector_with_more","feeds/lib/ui/publisher/global/base_publisher","feeds/lib/ui/publisher/global/privacy_warning","html!./message_publisher_recipients_on_top","html!./message_publisher_recipients_beneath"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/tr"),e=a("models/message_backbone"),f=a("common-ui/lib/ui/shared/type_ahead"),g=a("feeds/lib/ui/publisher/global/body_editor"),h=a("feeds/lib/ui/publisher/global/recipient_selector_with_more"),i=a("feeds/lib/ui/publisher/global/base_publisher"),j=a("feeds/lib/ui/publisher/global/privacy_warning"),k=a("html!./message_publisher_recipients_on_top"),l=a("html!./message_publisher_recipients_beneath"),m=e.TYPE,n={};return i.extend({defaults:function(){var a=b.object([[m.EMPTY,d.t("new_message")],[m.ALL_COMPANY,d.t("new_group_message")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("new_group_message")],[m.PUBLIC_GROUP,d.t("new_group_message")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("new_group_message")],[m.PRIVATE_GROUP,d.t("new_group_message")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("new_group_message")],[m.PRIVATE_MESSAGE,d.t("new_private_message_2")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("new_private_message_2")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("new_private_message_2")]]),c=b.object([[m.ALL_COMPANY,d.t("your_message_has_been_posted")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[m.PUBLIC_GROUP,d.t("your_message_has_been_posted")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[m.PRIVATE_GROUP,d.t("your_message_has_been_posted")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[m.PRIVATE_MESSAGE,d.t("your_private_message_has_been_sent")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_message_has_been_sent")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_message_has_been_sent")]]),e=b.object([[m.ALL_COMPANY,d.t("your_message_could_not_be_posted")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[m.PUBLIC_GROUP,d.t("your_message_could_not_be_posted")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[m.PRIVATE_GROUP,d.t("your_message_could_not_be_posted")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[m.PRIVATE_MESSAGE,d.t("your_private_message_could_not_be_sent")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_message_could_not_be_sent")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_message_could_not_be_sent")]]),f=b.object([[m.EMPTY,d.t("post")],[m.ALL_COMPANY,d.t("post_to_group")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("post_to_group")],[m.PUBLIC_GROUP,d.t("post_to_group")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("post_to_group")],[m.PRIVATE_GROUP,d.t("post_to_group")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("post_to_group")],[m.PRIVATE_MESSAGE,d.t("send_message")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("send_message")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("send_message")]]),g={titles:a,successes:c,errors:e,submit:f};return{icons:n,strings:g,showAlert:!0,warnOnRouteChange:!1,inLightbox:!1,allowAttachments:!0,logType:"yam.ui.publisher.global.MessagePublisher",logSource:"default"}},className:"yj-global-publisher yj-global-message-publisher yj-clearfix",initialize:function(a){this.template=this._getTemplate(a),a.recipientsBeneath||this.$el.addClass("publisher-recipients-on-top"),a.fancyPaperclip&&this.$el.addClass("style-paperclip"),i.prototype.initialize.apply(this,arguments)},_getTemplate:function(a){return a.recipientsBeneath?l:k},_createModel:function(){return new e({sender:c.getCurrentUser()})},_createOther:function(){this._createWarningArea()},_getEditorModel:function(){return this.model},_getEditorClass:function(){return g},_getSelectorClass:function(){return h},_getSelectorOptions:function(){return{allowExternalEmails:!0,allowForeignEmails:!0,typeaheadModels:[f.MODEL_GROUP,f.MODEL_USER,f.MODEL_PENDINGUSER,f.MODEL_DOMAIN]}},_getDropdownDirection:function(){return"down"},_requiresGroup:function(){return!1},_handleEmptyRecipientsList:function(){this._selector.focus()},_createWarningArea:function(){this._privacyWarning=new j({model:this.model,inLightbox:this._inLightbox}),this.add(this._privacyWarning,".publisher-warning")}})}),define("stache!feeds/lib/ui/publisher/global/publisher_switcher",["mustache"],function(a){var b='{{#options}}\n  <li class="switcher-option" data-name="{{name}}">\n    <button class="unstyle-button-as-span">\n      <span class="option-icon yamicon yamicon-{{icon}}"></span>\n      <span class="option-label">{{label}}</span>\n      <span class="yj-acc-hidden">&nbsp;{{accHidden}}</span>\n      <span class="yj-acc-selectedstate">&nbsp;{{accSelectedState}}</span>\n    </button>\n    <span class="option-arrow"></span>\n  </li>\n{{/options}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/publisher_switcher",[],function(){}),define("feeds/lib/ui/publisher/global/publisher_switcher",["require","jquery","underscore","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./publisher_switcher","css!./publisher_switcher"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/tr"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("html!./publisher_switcher");return a("css!./publisher_switcher"),e.extend({mixins:[f],events:{"click button":"_onClick"},tagName:"ul",className:"yj-global-publisher-switcher",template:g,initialize:function(a){this._icons=a.icons,this._strings=a.strings,this._selection=a.selection},getTemplateData:function(){var a=c.map(c.keys(this._strings),function(a){return{name:a,icon:this._icons[a],label:this._strings[a],accHidden:d.t("tab"),accSelectedState:d.t("selected")}},this);return{options:a}},render:function(){return this.$items=this.$("li"),null!=this._selection&&this._selectItem(this._selection),this},select:function(a){return this._selectItem(a),this.trigger("select",a),this},_selectItem:function(a){c.each(this.$items,function(c){var d=b(c);d.toggleClass("yj-selected",d.data("name")===a)},this),this._selection=a},_onClick:function(a){var c=b(a.target).closest("li");this.select(c.data("name"))}})}),define("stache!feeds/lib/ui/publisher/global/group_input",["mustache"],function(a){var b='<label>\n  <span class="input-label yj-acc-hidden"></span>\n  <input aria-haspopup="true" aria-autocomplete="list" />\n</label>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/group_input",["require","underscore","core/lib/backbone_base_view","core/lib/log","models/recipient","common-ui/lib/ui/shared/type_ahead","core/lib/tr","html!./group_input","jquery-watermark"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/log"),e=a("models/recipient"),f=a("common-ui/lib/ui/shared/type_ahead"),g=a("core/lib/tr"),h=a("html!./group_input");a("jquery-watermark");var i=e.TYPE,j=f,k={accessFilter:"post",includeAllCompany:!0,scrollResults:!0,showTopRankings:!0,inline:!0,allowWide:!1,width:270},l=[f.MODEL_GROUP];return c.extend({defaults:function(){var a=g.t("select_a_group"),b={placeholder:a};return{strings:b,typeahead:j,typeaheadOptions:k,typeaheadModels:l}},events:{"focus input":"_onFocus"},className:"yj-global-tag-input yj-global-group-input",template:h,initialize:function(a){this._strings=a.strings,this._typeahead=a.typeahead,this._typeaheadOptions=a.typeaheadOptions,this._typeaheadModels=a.typeaheadModels,this._setupListeners()},render:function(){return this._destroyTypeahead(),this.$el.html(this.template()),this.$input=this.$("input"),this.$label=this.$(".input-label"),this._updatePlaceholder(),this._registerTypeahead(),this},remove:function(){return this._destroyTypeahead(),c.prototype.remove.call(this)},enable:function(){return this.$input&&this.$input.prop("disabled",!1),this},disable:function(){return this.$input&&this.$input.prop("disabled",!0),this},clear:function(){return this.val(""),this},val:function(){return this.$input?this.$input.val.apply(this.$input,arguments):""},focus:function(){return this.$input&&this.$input.focus(),this},blur:function(){return this.$input&&this.$input.blur(),this},_setupListeners:function(){this.listenTo(this.collection,"add remove reset",this._onChangeCollection)},_registerTypeahead:function(){var a={completableModels:this._typeaheadModels,getPosition:this._getTypeaheadPosition.bind(this),onSelect:this._onSelectTypeahead.bind(this)};this._typeahead.registerField(this.$input,b.extend(a,this._typeaheadOptions))},_destroyTypeahead:function(){this.$input&&this._typeahead.removeField(this.$input)},_getTypeaheadPosition:function(){var a=this.$input.position(),b=this.$input.outerHeight();return{left:0,top:a.top+b+4}},_onSelectTypeahead:function(a){var b=e.fromOriginalModel(a);return b?(this._clearGroup(),void this._setGroup(b)):void d.warn("RecipientInput: could not create recipient")},_clearGroup:function(){var a=this.collection.whereContains({type:[i.PUBLIC_GROUP,i.PRIVATE_GROUP]});this.collection.remove(a)},_setGroup:function(a){this.collection.add(a)},_updatePlaceholder:function(){if(null!=this.$input){var a=this.collection.whereContains({type:[i.PUBLIC_GROUP,i.PRIVATE_GROUP]}),b=a.length,c=0===b?this._strings.placeholder:"",d=0===b?"75%":"0%";this.$input.watermark(c),this.$input.css({width:d}),this.$label.text(c)}},_onChangeCollection:function(){this._updatePlaceholder()},_onFocus:function(){this._clearGroup()}})}),define("stache!feeds/lib/ui/publisher/global/group_selector",["mustache"],function(a){var b='<button class="selector-arrow unstyle-button-as-span" data-speechtip>\n  <span class="yj-acc-hidden">{{buttonAltText}}</span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/group_selector",["require","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","models/recipient","feeds/lib/ui/publisher/global/recipient_list","feeds/lib/ui/publisher/global/group_input","feeds/lib/ui/publisher/global/recipient_change_announcer","feeds/lib/ui/publisher/global/recipient_change_reporter","core/lib/tr","html!./group_selector"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_legacy_subviews"),d=a("core/lib/backbone_with_subviews"),e=a("models/recipient"),f=a("feeds/lib/ui/publisher/global/recipient_list"),g=a("feeds/lib/ui/publisher/global/group_input"),h=a("feeds/lib/ui/publisher/global/recipient_change_announcer"),i=a("feeds/lib/ui/publisher/global/recipient_change_reporter"),j=a("core/lib/tr"),k=a("html!./group_selector"),l=e.TYPE;return b.extend({mixins:[c,d],events:{click:"_onClick"},className:"yj-global-tag-selector yj-global-group-selector",template:k,initialize:function(a){this._strings=a.strings,this._allowExternalEmails=a.allowExternalEmails,this._typeahead=a.typeahead,this._typeaheadOptions=a.typeaheadOptions,this._typeaheadModels=a.typeaheadModels,this._createChildren(),this._setupListener()},render:function(){return this.renderTemplate({buttonAltText:j.t("open")}),this.$button=this.$("button"),this},enable:function(){return this._list.enable(),this._input.enable(),this._announcer.enable(),this._reporter.enable(),this},disable:function(){return this._list.disable(),this._input.disable(),this._announcer.disable(),this._reporter.disable(),this},clear:function(){return this.val(""),this},val:function(){return this._input.val.apply(this._input,arguments)},focus:function(){return this._input.focus(),this},blur:function(){return this._input.blur(),this},_createChildren:function(){var a=function(){return this.whereContains({type:[l.PUBLIC_GROUP,l.PRIVATE_GROUP]})};this._input=new g({collection:this.collection,strings:this._strings,typeahead:this._typeahead,typeaheadOptions:this._typeaheadOptions,typeaheadModels:this._typeaheadModels}),this.prepend(this._input),this._list=new f({collection:this.collection,filter:a}),this.prepend(this._list),this._announcer=new h({collection:this.collection}),this.append(this._announcer),this._reporter=new i({collection:this.collection}),this.append(this._reporter)},_setupListener:function(){this.listenTo(this.collection,"add",this._onSelectGroup),this.listenTo(this._input,"submit",this._notifyParent.bind(this,"submit"))},_notifyParent:function(){this.trigger.apply(this,arguments)},_onSelectGroup:function(){this.$button.focus()},_onClick:function(){this.focus()}})}),define("feeds/lib/ui/publisher/global/user_selector",["require","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","models/recipient","feeds/lib/ui/publisher/global/recipient_list","feeds/lib/ui/publisher/global/recipient_input","feeds/lib/ui/publisher/global/recipient_change_announcer","feeds/lib/ui/publisher/global/recipient_change_reporter"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_legacy_subviews"),d=a("core/lib/backbone_with_subviews"),e=a("models/recipient"),f=a("feeds/lib/ui/publisher/global/recipient_list"),g=a("feeds/lib/ui/publisher/global/recipient_input"),h=a("feeds/lib/ui/publisher/global/recipient_change_announcer"),i=a("feeds/lib/ui/publisher/global/recipient_change_reporter"),j=e.TYPE;return b.extend({mixins:[c,d],events:{click:"_onClick"},className:"yj-global-tag-selector yj-global-user-selector",initialize:function(a){this._strings=a.strings,this._allowExternalEmails=a.allowExternalEmails,this._typeahead=a.typeahead,this._typeaheadOptions=a.typeaheadOptions,this._typeaheadModels=a.typeaheadModels,this._createChildren(),this._setupListener()},enable:function(){return this._list.enable(),this._input.enable(),this._announcer.enable(),this._reporter.enable(),this},disable:function(){return this._list.disable(),this._input.disable(),this._announcer.disable(),this._reporter.disable(),this},clear:function(){return this.val(""),this},val:function(){return this._input.val.apply(this._input,arguments)},focus:function(){return this._input.focus(),this},blur:function(){return this._input.blur(),this},_createChildren:function(){var a=function(){return this.whereContains({type:[j.USER,j.DOMAIN]})};this._list=new f({collection:this.collection,filter:a}),this.add(this._list),this._input=new g({collection:this.collection,strings:this._strings,allowExternalEmails:this._allowExternalEmails,typeahead:this._typeahead,typeaheadOptions:this._typeaheadOptions,typeaheadModels:this._typeaheadModels}),this.add(this._input),this._announcer=new h({collection:this.collection}),this.add(this._announcer),this._reporter=new i({collection:this.collection}),this.add(this._reporter)},_setupListener:function(){this.listenTo(this._input,"submit",this._notifyParent.bind(this,"submit"))},_notifyParent:function(){this.trigger.apply(this,arguments)},_onClick:function(){this.focus()}})}),define("stache!feeds/lib/ui/publisher/global/group_publisher",["mustache"],function(a){var b='<div class="publisher-relative">\n  <div class="publisher-main">\n    <div class="publisher-group"></div>\n    <div class="publisher-body"></div>\n    <div class="publisher-recipients"></div>\n  </div>\n  <div class="publisher-warning"></div>\n  <div class="publisher-excerpt"></div>\n  <div class="publisher-actions">\n    <div class="publisher-file"></div>\n    <div class="publisher-submit"></div>\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/group_publisher",[],function(){}),define("feeds/lib/ui/publisher/global/group_publisher",["require","underscore","core/lib/session","core/lib/tr","models/message_backbone","common-ui/lib/ui/shared/type_ahead","feeds/lib/ui/publisher/global/body_editor","feeds/lib/ui/publisher/global/group_selector","feeds/lib/ui/publisher/global/user_selector","feeds/lib/ui/publisher/global/base_publisher","feeds/lib/ui/publisher/global/privacy_warning","html!./group_publisher","css!./group_publisher"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/tr"),e=a("models/message_backbone"),f=a("common-ui/lib/ui/shared/type_ahead"),g=a("feeds/lib/ui/publisher/global/body_editor"),h=a("feeds/lib/ui/publisher/global/group_selector"),i=a("feeds/lib/ui/publisher/global/user_selector"),j=a("feeds/lib/ui/publisher/global/base_publisher"),k=a("feeds/lib/ui/publisher/global/privacy_warning"),l=e.TYPE,m=a("html!./group_publisher");a("css!./group_publisher");var n={},o=j.extend({defaults:function(){var a=b.object([[l.EMPTY,d.t("new_message")],[l.ALL_COMPANY,d.t("new_group_message")],[l.ALL_COMPANY_WITH_EXTERNAL,d.t("new_group_message")],[l.PUBLIC_GROUP,d.t("new_group_message")],[l.PUBLIC_GROUP_WITH_EXTERNAL,d.t("new_group_message")],[l.PRIVATE_GROUP,d.t("new_group_message")],[l.PRIVATE_GROUP_WITH_EXTERNAL,d.t("new_group_message")],[l.PRIVATE_MESSAGE,d.t("new_private_message_2")],[l.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("new_private_message_2")],[l.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("new_private_message_2")]]),c=b.object([[l.ALL_COMPANY,d.t("your_message_has_been_posted")],[l.ALL_COMPANY_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[l.PUBLIC_GROUP,d.t("your_message_has_been_posted")],[l.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[l.PRIVATE_GROUP,d.t("your_message_has_been_posted")],[l.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[l.PRIVATE_MESSAGE,d.t("your_private_message_has_been_sent")],[l.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_message_has_been_sent")],[l.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_message_has_been_sent")]]),e=b.object([[l.ALL_COMPANY,d.t("your_message_could_not_be_posted")],[l.ALL_COMPANY_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[l.PUBLIC_GROUP,d.t("your_message_could_not_be_posted")],[l.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[l.PRIVATE_GROUP,d.t("your_message_could_not_be_posted")],[l.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[l.PRIVATE_MESSAGE,d.t("your_private_message_could_not_be_sent")],[l.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_message_could_not_be_sent")],[l.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_message_could_not_be_sent")]]),f=d.t("say_something_about_this_conversation"),g={placeholder:f},h=b.object([[l.EMPTY,d.t("notify_specific_people")],[l.ALL_COMPANY,d.t("notify_specific_people")],[l.ALL_COMPANY_WITH_EXTERNAL,d.t("notify_specific_people")],[l.PUBLIC_GROUP,d.t("notify_specific_people")],[l.PUBLIC_GROUP_WITH_EXTERNAL,d.t("notify_specific_people")],[l.PRIVATE_GROUP,d.t("notify_specific_people")],[l.PRIVATE_GROUP_WITH_EXTERNAL,d.t("notify_specific_people")],[l.PRIVATE_MESSAGE,d.t("notify_specific_people")],[l.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("notify_specific_people")],[l.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("notify_specific_people")]]),i={placeholders:h};o.DEFAULT_SELECTOR_STRINGS=i;var j=b.object([[l.EMPTY,d.t("post")],[l.ALL_COMPANY,d.t("post_to_group")],[l.ALL_COMPANY_WITH_EXTERNAL,d.t("post_to_group")],[l.PUBLIC_GROUP,d.t("post_to_group")],[l.PUBLIC_GROUP_WITH_EXTERNAL,d.t("post_to_group")],[l.PRIVATE_GROUP,d.t("post_to_group")],[l.PRIVATE_GROUP_WITH_EXTERNAL,d.t("post_to_group")],[l.PRIVATE_MESSAGE,d.t("send_message")],[l.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("send_message")],[l.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("send_message")]]),k={titles:a,successes:c,errors:e,editor:g,selector:i,submit:j};return{icons:n,strings:k,allowAttachments:!0,showAlert:!0,inLightbox:!1,isExternalGroupPublishingAllowed:!0,logType:"yam.ui.publisher.global.GroupPublisher",logSource:"default"}},className:"yj-global-publisher yj-global-group-publisher publisher-recipients-on-top yj-clearfix",template:m,_createModel:function(){return new e({sender:c.getCurrentUser()})},_getEditorModel:function(){return this.model},_getEditorClass:function(){return g},_getSelectorClass:function(){return i},_getSelectorOptions:function(){return{strings:o.DEFAULT_SELECTOR_STRINGS,allowExternalEmails:!0,allowForeignEmails:!0,typeaheadModels:[f.MODEL_USER,f.MODEL_DOMAIN]}},_getDropdownDirection:function(){return this._inLightbox?"up":"down"},_requiresGroup:function(){return!0},_createOther:function(){this._createGroupArea(),this._createWarningArea()},_createGroupArea:function(){var a={collection:this.model.get("recipients"),typeaheadOptions:{accessFilter:"post",includeAllCompany:!0,scrollResults:!0,showTopRankings:!0,inline:!0,allowWide:!1,width:270}};this._isExternalGroupPublishingAllowed||(a.typeaheadOptions.filter=function(a,b){return!b.external}),this._groupSelector=new h(a),this.add(this._groupSelector,".publisher-group")},_createWarningArea:function(){this._privacyWarning=new k({model:this.model,inLightbox:this._inLightbox}),this.add(this._privacyWarning,".publisher-warning")}});return o}),define("stache!feeds/lib/ui/publisher/global/private_publisher",["mustache"],function(a){var b='<div class="publisher-relative">\n  <div class="publisher-main">\n  	<div class="publisher-recipients"></div>\n    <div class="publisher-body"></div>\n  </div>\n  <div class="publisher-warning"></div>\n  <div class="publisher-excerpt"></div>\n  <div class="publisher-actions">\n    <div class="publisher-topic"></div>\n    <div class="publisher-file"></div>\n    <div class="publisher-submit"></div>\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/private_publisher",["require","underscore","core/lib/session","core/lib/tr","models/message_backbone","common-ui/lib/ui/shared/type_ahead","feeds/lib/ui/publisher/global/body_editor","feeds/lib/ui/publisher/global/user_selector","feeds/lib/ui/publisher/global/base_publisher","feeds/lib/ui/publisher/global/privacy_warning","html!./private_publisher"],function(a){var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/tr"),e=a("models/message_backbone"),f=a("common-ui/lib/ui/shared/type_ahead"),g=a("feeds/lib/ui/publisher/global/body_editor"),h=a("feeds/lib/ui/publisher/global/user_selector"),i=a("feeds/lib/ui/publisher/global/base_publisher"),j=a("feeds/lib/ui/publisher/global/privacy_warning"),k=a("html!./private_publisher"),l=e.TYPE,m={},n=i.extend({defaults:function(){var a=b.object([[l.EMPTY,d.t("new_message")],[l.ALL_COMPANY,d.t("new_group_message")],[l.ALL_COMPANY_WITH_EXTERNAL,d.t("new_group_message")],[l.PUBLIC_GROUP,d.t("new_group_message")],[l.PUBLIC_GROUP_WITH_EXTERNAL,d.t("new_group_message")],[l.PRIVATE_GROUP,d.t("new_group_message")],[l.PRIVATE_GROUP_WITH_EXTERNAL,d.t("new_group_message")],[l.PRIVATE_MESSAGE,d.t("new_private_message_2")],[l.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("new_private_message_2")],[l.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("new_private_message_2")]]),c=b.object([[l.ALL_COMPANY,d.t("your_message_has_been_posted")],[l.ALL_COMPANY_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[l.PUBLIC_GROUP,d.t("your_message_has_been_posted")],[l.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[l.PRIVATE_GROUP,d.t("your_message_has_been_posted")],[l.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[l.PRIVATE_MESSAGE,d.t("your_private_message_has_been_sent")],[l.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_message_has_been_sent")],[l.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_message_has_been_sent")]]),e=b.object([[l.ALL_COMPANY,d.t("your_message_could_not_be_posted")],[l.ALL_COMPANY_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[l.PUBLIC_GROUP,d.t("your_message_could_not_be_posted")],[l.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[l.PRIVATE_GROUP,d.t("your_message_could_not_be_posted")],[l.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[l.PRIVATE_MESSAGE,d.t("your_private_message_could_not_be_sent")],[l.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_message_could_not_be_sent")],[l.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_message_could_not_be_sent")]]),f=d.t("say_something_about_this_conversation"),g={placeholder:f},h=b.object([[l.EMPTY,d.t("add_participants")],[l.ALL_COMPANY,d.t("add_more_participants")],[l.ALL_COMPANY_WITH_EXTERNAL,d.t("add_more_participants")],[l.PUBLIC_GROUP,d.t("add_more_participants")],[l.PUBLIC_GROUP_WITH_EXTERNAL,d.t("add_more_participants")],[l.PRIVATE_GROUP,d.t("add_more_participants")],[l.PRIVATE_GROUP_WITH_EXTERNAL,d.t("add_more_participants")],[l.PRIVATE_MESSAGE,d.t("add_more_participants")],[l.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("add_more_participants")],[l.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("add_more_participants")]]),i={placeholders:h};n.DEFAULT_SELECTOR_STRINGS=i;var j=b.object([[l.EMPTY,d.t("post")],[l.ALL_COMPANY,d.t("post_to_group")],[l.ALL_COMPANY_WITH_EXTERNAL,d.t("post_to_group")],[l.PUBLIC_GROUP,d.t("post_to_group")],[l.PUBLIC_GROUP_WITH_EXTERNAL,d.t("post_to_group")],[l.PRIVATE_GROUP,d.t("post_to_group")],[l.PRIVATE_GROUP_WITH_EXTERNAL,d.t("post_to_group")],[l.PRIVATE_MESSAGE,d.t("send_message")],[l.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("send_message")],[l.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("send_message")]]),k={titles:a,successes:c,errors:e,editor:g,selector:i,submit:j};return{icons:m,strings:k,allowAttachments:!0,showAlert:!0,warnOnRouteChange:!1,inLightbox:!1,logType:"yam.ui.publisher.global.PrivatePublisher",logSource:"default"}},className:"yj-global-publisher yj-global-private-publisher publisher-recipients-on-top yj-clearfix",template:k,_createModel:function(){return new e({sender:c.getCurrentUser()})},_createOther:function(){this._createWarningArea()},_getEditorModel:function(){return this.model},_getEditorClass:function(){return g},_getSelectorClass:function(){return h},_getSelectorOptions:function(){return{strings:n.DEFAULT_SELECTOR_STRINGS,allowExternalEmails:!0,allowForeignEmails:!0,typeaheadModels:[f.MODEL_USER,f.MODEL_DOMAIN]}},_getDropdownDirection:function(){return this._inLightbox?"up":"down"},_requiresGroup:function(){return!1},_createWarningArea:function(){this._privacyWarning=new j({model:this.model,inLightbox:this._inLightbox}),this.add(this._privacyWarning,".publisher-warning")}});return n}),define("stache!feeds/lib/ui/publisher/global/split_publisher",["mustache"],function(a){
var b='<div class="publisher-switcher"></div>\n<div class="publisher-real"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/split_publisher",[],function(){}),define("feeds/lib/ui/publisher/global/split_publisher",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","models/message_backbone","feeds/lib/ui/publisher/global/publisher_switcher","feeds/lib/ui/publisher/global/group_publisher","feeds/lib/ui/publisher/global/private_publisher","core/lib/session","core/lib/tr","core/lib/treatment","html!./split_publisher","css!./split_publisher"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("models/message_backbone"),h=a("feeds/lib/ui/publisher/global/publisher_switcher"),i=a("feeds/lib/ui/publisher/global/group_publisher"),j=a("feeds/lib/ui/publisher/global/private_publisher"),k=a("core/lib/session"),l=a("core/lib/tr"),m=a("core/lib/treatment"),n=a("html!./split_publisher");a("css!./split_publisher");var o=g.TYPE,p={groupPublisher:i,userPublisher:j},q={groupPublisher:"group",userPublisher:"user"},r={switcher:q},s="groupPublisher";return c.extend({mixins:[d,e,f],defaults:function(){var a={groupPublisher:l.t("post_in_a_group"),userPublisher:m.usePriorityCopy()?l.t("send_via_direct_message"):l.t("send_via_private_message")},c=b.object([[o.EMPTY,l.t("create_a_message")],[o.ALL_COMPANY,l.t("create_a_message")],[o.ALL_COMPANY_WITH_EXTERNAL,l.t("create_a_message")],[o.PUBLIC_GROUP,l.t("create_a_message")],[o.PUBLIC_GROUP_WITH_EXTERNAL,l.t("create_a_message")],[o.PRIVATE_GROUP,l.t("create_a_message")],[o.PRIVATE_GROUP_WITH_EXTERNAL,l.t("create_a_message")],[o.PRIVATE_MESSAGE,l.t("create_a_message")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,l.t("create_a_message")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,l.t("create_a_message")]]),d=b.object([[o.ALL_COMPANY,l.t("your_message_has_been_posted")],[o.ALL_COMPANY_WITH_EXTERNAL,l.t("your_message_has_been_posted")],[o.PUBLIC_GROUP,l.t("your_message_has_been_posted")],[o.PUBLIC_GROUP_WITH_EXTERNAL,l.t("your_message_has_been_posted")],[o.PRIVATE_GROUP,l.t("your_message_has_been_posted")],[o.PRIVATE_GROUP_WITH_EXTERNAL,l.t("your_message_has_been_posted")],[o.PRIVATE_MESSAGE,l.t("your_private_message_has_been_sent")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,l.t("your_private_message_has_been_sent")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,l.t("your_private_message_has_been_sent")]]),e=b.object([[o.ALL_COMPANY,l.t("your_message_could_not_be_posted")],[o.ALL_COMPANY_WITH_EXTERNAL,l.t("your_message_could_not_be_posted")],[o.PUBLIC_GROUP,l.t("your_message_could_not_be_posted")],[o.PUBLIC_GROUP_WITH_EXTERNAL,l.t("your_message_could_not_be_posted")],[o.PRIVATE_GROUP,l.t("your_message_could_not_be_posted")],[o.PRIVATE_GROUP_WITH_EXTERNAL,l.t("your_message_could_not_be_posted")],[o.PRIVATE_MESSAGE,l.t("your_private_message_could_not_be_sent")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,l.t("your_private_message_could_not_be_sent")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,l.t("your_private_message_could_not_be_sent")]]),f={switcher:a,titles:c,successes:d,errors:e};return{classes:p,icons:r,strings:f,selection:s,isExternalGroupPublishingAllowed:!0,inLightbox:!0}},className:"yj-global-split-publisher style-paperclip",template:n,initialize:function(a){this._classes=a.classes,this._icons=a.icons,this._strings=a.strings,this._selection=a.selection,this._excerpt=a.excerpt,this._inLightbox=a.inLightbox,this._logType=a.logType,this._logSource=a.logSource,this._isExternalGroupPublishingAllowed=a.isExternalGroupPublishingAllowed,this.model=a.model||new g({sender:k.getCurrentUser()}),this._createChildren(),this._setupListeners()},render:function(){return b.defer(this.select.bind(this)),this},select:function(a){return null==a&&(a=this._selection),this._switcher.select(a),this},enable:function(){return this._getPublisher().enable(),this},disable:function(){return this._getPublisher().disable(),this},focus:function(){return this._getPublisher().focus(),this},blur:function(){return this._getPublisher().blur(),this},isFocused:function(){return this.$el.has(window.document.activeElement).length>0},reset:function(){return this._getPublisher().reset(),this},isResettable:function(){return this._getPublisher().isResettable()},_createChildren:function(){var a=this._classes,c=this._icons.switcher,d=this._strings.switcher,e=this._selection;this._switcher=new h({icons:c,strings:d,selection:e}),this.add(this._switcher,".publisher-switcher"),this._publishers={};var f=b.omit(this.model.attributes,"recipients");b.each(a,function(a,b){var c=new g(f);this.listenTo(c,"change:state",function(){this.model.set("state",c.get("state"))},this);var d={model:c,icons:this._icons,strings:this._strings,excerpt:this._excerpt,inLightbox:this._inLightbox,logType:this._logType,logSource:this._logSource,isExternalGroupPublishingAllowed:this._isExternalGroupPublishingAllowed},e=new a(d);e.disable().hide(),this.listenTo(e,"change:title",this._notifyParent.bind(this,"change:title")),this._publishers[b]=e,this.add(e,".publisher-real")},this)},_setupListeners:function(){this.listenTo(this._switcher,"select",this._onSelect)},_getPublisher:function(){return this._publishers[this._selection]},_notifyParent:function(){this.trigger.apply(this,arguments)},_onSelect:function(a){null!=this._getPublisher()&&(this._selection=a),b.each(this._publishers,function(a){a.disable().hide()},this),this._getPublisher().enable().show()}})}),define("feeds/lib/ui/publisher/global/publisher_helper",["require","jquery","underscore","core/lib/backbone_base_class","common-ui/lib/ui/general/lightbox_manager","feeds/lib/ui/publisher/global/excerpt_container","models/message_backbone","feeds/lib/ui/publisher/global/message_publisher","backbone","feeds/lib/ui/publisher/global/publisher_errors","collections/recipients","feeds/lib/ui/publisher/global/split_publisher","core/lib/tr","core/lib/treatment","core/lib/urls"],function(a){"use strict";var b,c,d,e,f,g=a("jquery"),h=a("underscore"),i=a("core/lib/backbone_base_class"),j=a("common-ui/lib/ui/general/lightbox_manager"),k=a("feeds/lib/ui/publisher/global/excerpt_container"),l=a("models/message_backbone"),m=a("feeds/lib/ui/publisher/global/message_publisher"),n=a("backbone"),o=a("feeds/lib/ui/publisher/global/publisher_errors"),p=a("collections/recipients"),q=a("feeds/lib/ui/publisher/global/split_publisher"),r=a("core/lib/tr"),s=a("core/lib/treatment"),t=a("core/lib/urls"),u=l.TYPE,v=p.TYPE,w=l.SHARE_MODE,x=k.TYPE,y={CONVERSATION:"conversation",FILE:"file",LINK:"link",NOTE:"note"},z={undefined:y.CONVERSATION,conversation:y.CONVERSATION,message:y.CONVERSATION,attachment:y.FILE,uploaded_file:y.FILE,file:y.FILE,open_graph_object:y.LINK,link:y.LINK,page:y.NOTE,note:y.NOTE},A=function(a){return h.reduce(u,function(b,c){return b[c]=a,b},{})},B=h.object([[y.CONVERSATION,x.CONVERSATION],[y.FILE,x.FILE],[y.LINK,x.LINK],[y.NOTE,x.NOTE]]),C=i.extend({openShareLightbox:function(a){if(!a)throw new Error("No excerpt options given");var b=z[a.type];if(!b)throw new Error("Could not determine share type for: "+a.type);var c=a.source;a=h.omit(a,"source");var d=this._getShareFn(b);d.call(this,a,c)},openConversationShareLightbox:function(a,b){var c=function(b){b.get("ogos").add(h.extend({},a,{fixed:!0,type:"open_graph_object",url:t.thread({id:a.sharedMessageId})}))};this._openShareLightbox(y.CONVERSATION,a,c,w.LINK,b)},openFileShareLightbox:function(a,b){var c=function(b){b.get("files").add(h.extend({},a,{fixed:!0}))};this._openShareLightbox(y.FILE,a,c,w.FILE,b)},openLinkShareLightbox:function(a,b){var c=a.url,d=a.id,e=function(b){b.get("ogos").add(h.extend({},a,{id:d,name:c,url:c,fixed:!0}))};this._openShareLightbox(y.LINK,a,e,w.LINK,b)},openNoteShareLightbox:function(a,b){var c=function(b){b.get("files").add(h.extend({},a,{fixed:!0}))};this._openShareLightbox(y.NOTE,a,c,w.FILE,b)},openComposeLightbox:function(a,b,c){this._openComposeLightbox(a,b,c)},keyPerMessageType:A,initialize:function(){h.bindAll(this,"openShareLightbox","openComposeLightbox","openConversationShareLightbox","openFileShareLightbox","openLinkShareLightbox","openNoteShareLightbox"),this.listenTo(n,"/ui/publisher/share-lightbox/open",h.bind(function(a){this.openShareLightbox(a.excerptOptions)},this))},_initStrings:function(){b=h.object([[y.CONVERSATION,r.t("email_this_conversation")],[y.FILE,r.t("email_this_file")],[y.LINK,r.t("email_this_link")],[y.NOTE,r.t("email_this_note")]]);var a=h.object([["SUCCESS",h.object([[y.CONVERSATION,r.t("this_conversation_was_successfully_shared")],[y.FILE,r.t("this_file_was_successfully_shared")],[y.LINK,r.t("this_link_was_successfully_shared")],[y.NOTE,r.t("this_note_was_successfully_shared")]])],["ERROR",h.object([[y.CONVERSATION,r.t("there_was_an_error_sharing_this_conversation_please_try_again")],[y.FILE,r.t("there_was_an_error_sharing_this_file_please_try_again")],[y.LINK,r.t("there_was_an_error_sharing_this_link_please_try_again")],[y.NOTE,r.t("there_was_an_error_sharing_this_note_please_try_again")]])]]),g=h.reduce(y,function(b,c){return b[c]={SUCCESS:a.SUCCESS[c],ERROR:a.ERROR[c]},b},{}),i=h.object([[y.CONVERSATION,r.t("share_this_conversation")],[y.FILE,r.t("share_this_file_3")],[y.LINK,r.t("share_this_link_2")],[y.NOTE,r.t("share_this_note_2")]]),j=h.object([[u.EMPTY,i],[u.ALL_COMPANY,i],[u.ALL_COMPANY_WITH_EXTERNAL,i],[u.PUBLIC_GROUP,r.t("share_with_group")],[u.PUBLIC_GROUP_WITH_EXTERNAL,r.t("share_with_group")],[u.PRIVATE_GROUP,r.t("share_with_group")],[u.PRIVATE_GROUP_WITH_EXTERNAL,r.t("share_with_group")],[u.PRIVATE_MESSAGE,r.t("share_in_private_message")],[u.PRIVATE_MESSAGE_WITH_EXTERNAL,r.t("share_in_private_message")],[u.PRIVATE_MESSAGE_WITH_MENTIONS,r.t("share_in_private_message")]]),k=h.object([[y.CONVERSATION,r.t("say_something_about_this_conversation")],[y.FILE,r.t("say_something_about_this_file")],[y.LINK,r.t("say_something_about_this_link")],[y.NOTE,r.t("say_something_about_this_note")]]);c=h.object([[v.EMPTY,r.t("share_2")],[v.ALL_COMPANY,r.t("share_2")],[v.ALL_COMPANY_WITH_EXTERNAL,r.t("share_2")],[v.PUBLIC_GROUP,r.t("share_2")],[v.PUBLIC_GROUP_WITH_EXTERNAL,r.t("share_2")],[v.PRIVATE_GROUP,r.t("share_2")],[v.PRIVATE_GROUP_WITH_EXTERNAL,r.t("share_2")],[v.PRIVATE_MESSAGE,r.t("share_2")],[v.PRIVATE_MESSAGE_WITH_EXTERNAL,r.t("share_2")],[v.PRIVATE_MESSAGE_WITH_MENTIONS,r.t("share_2")]]),d=h.object([[v.EMPTY,r.t("enter_email")],[v.ALL_COMPANY,r.t("enter_email")],[v.ALL_COMPANY_WITH_EXTERNAL,r.t("enter_email")],[v.PUBLIC_GROUP,r.t("enter_email")],[v.PUBLIC_GROUP_WITH_EXTERNAL,r.t("enter_email")],[v.PRIVATE_GROUP,r.t("enter_email")],[v.PRIVATE_GROUP_WITH_EXTERNAL,r.t("enter_email")],[v.PRIVATE_MESSAGE,r.t("enter_email")],[v.PRIVATE_MESSAGE_WITH_EXTERNAL,r.t("enter_email")],[v.PRIVATE_MESSAGE_WITH_MENTIONS,r.t("enter_email")]]),e=h.object([[v.EMPTY,r.t("send")],[v.ALL_COMPANY,r.t("send")],[v.ALL_COMPANY_WITH_EXTERNAL,r.t("send")],[v.PUBLIC_GROUP,r.t("send")],[v.PUBLIC_GROUP_WITH_EXTERNAL,r.t("send")],[v.PRIVATE_GROUP,r.t("send")],[v.PRIVATE_GROUP_WITH_EXTERNAL,r.t("send")],[v.PRIVATE_MESSAGE,r.t("send")],[v.PRIVATE_MESSAGE_WITH_EXTERNAL,r.t("send")],[v.PRIVATE_MESSAGE_WITH_MENTIONS,r.t("send")]]),f=h.reduce(y,function(a,b){var c=h.reduce(j,function(a,c,d){return a[d]=!h.isFunction(c[b])&&c[b]||c,a},{});return a[b]={TITLES:c,PLACEHOLDER:k[b],SUCCESSES:A(g[b].SUCCESS),ERRORS:A(g[b].ERROR)},a},{})},_getShareFn:function(a){switch(a){case y.CONVERSATION:return this.openConversationShareLightbox;case y.FILE:return this.openFileShareLightbox;case y.LINK:return this.openLinkShareLightbox;case y.NOTE:return this.openNoteShareLightbox}},_openShareLightbox:function(a,b,d,e,i){this._initStrings();var k=B[a];if(null==k)throw new Error("Could not determine excerpt type for share type: "+a);var m=new l({sharing:e}),p={model:m,type:k},t={titles:f[a].TITLES,successes:f[a].SUCCESSES,errors:f[a].ERRORS,editor:{placeholder:f[a].PLACEHOLDER},switcher:{groupPublisher:r.t("post_in_a_group"),userPublisher:r.t("send_via_private_message")},submit:c},v=new q({model:m,excerpt:p,inLightbox:!0,isExternalGroupPublishingAllowed:s.treatment("external_message_sharing_v1"),logSource:i,strings:t}),w=g("#yj_cboxTitle");this.listenTo(v,"change:title",function(a){w.text(a),w.css({overflow:"visible"})});var x=this,y=f[a].TITLES[u.EMPTY],z={title:y,overlayClose:!1,scrolling:!1,onCleanup:function(){w.css({overflow:"hidden"})},onComplete:h.wrap(d,function(a){g("#yj_cboxLoadedContent").css({overflow:"visible"}),null!=a&&a.call(x,m)}),confirmClose:function(){var a=!0;return v.isResettable()||(a=o.showUnsavedWarningDialog()),a}};j.openComponent(v,"yj-share-lightbox",null,z),this.listenTo(m,"change:state",h.bind(function(){m.hasBeenSubmitted()&&(n.trigger("/ui/lightbox/close"),this.stopListening(m))},this))},_openComposeLightbox:function(a,b,c){null==a&&(a=new l);var d=c?q:m,e=new d({model:a,inLightbox:!0,logSource:b}),f=g("#yj_cboxTitle");this.listenTo(e,"change:title",function(a){setTimeout(function(){f.text(a),f.css({overflow:"visible"})},0)});var i={overlayClose:!1,scrolling:!1,onCleanup:function(){f.css({overflow:"hidden"})},onComplete:function(){g("#yj_cboxLoadedContent").css({overflow:"visible"})},confirmClose:function(){var a=!0;return e.isResettable()||(a=o.showUnsavedWarningDialog()),a}};j.openComponent(e,"yj-compose-lightbox",null,i),this.listenTo(a,"change:state",h.bind(function(){a.hasBeenSubmitted()&&(n.trigger("/ui/lightbox/close"),this.stopListening(a),this.stopListening(e))},this))}});return new C}),define("stache!common-ui/lib/ui/hovercards/hovercard_user",["mustache"],function(a){var b='<div class="yj-hovercard-main-details yj-clearfix">\n  <div class="yj-hovercard-pic"></div>\n  <div class="yj-hovercard-details">\n    <p class="yj-hovercard-title">\n      <a class="yj-hovercard-title-link" href="{{webUrl}}" title="">{{fullName}}</a>\n      {{^foreign}}\n        <span class="yj-presence yamicon {{presence_class}}">\n          <span class="yj-acc-hidden">{{status}}</span>\n        </span>\n      {{/foreign}}\n    </p>\n    {{#foreign}}\n        <p class="foreign-network-name">\n          <span class="external-user-icon yamicon yamicon-network">\n            <span class="yj-acc-hidden">{{foreignNetworkIconAltText}}</span>\n          </span>\n          {{networkName}}\n        </p>\n      {{/foreign}}\n      <p class="yj-hovercard-subtitle"><span class="yj-hovercard-jobtitle">{{jobTitle}}</span></p>\n  </div>\n</div>\n<div class="yj-hovercard-main yj-clearfix">\n  <div class="yj-hovercard-details">\n    <div class="yj-hovercard-details--personal-information">\n      <p>\n        {{#emailAddress}}\n          <span class="yj-hovercard-info-title">{{emailTitle}}:</span>\n          <span class="yj-hovercard-email">{{emailAddress}}</span>\n        {{/emailAddress}}\n        {{#workPhone}}<div>\n          <span class="yj-hovercard-info-title">{{workPhoneTitle}}:</span>\n          <span class="yj-hovercard-work-phone {{#workPhoneHighlighted}}yj-hovercard-highlight-text{{/workPhoneHighlighted}}">{{workPhone}}</span>\n        </div>{{/workPhone}}\n        {{#mobilePhone}}<div>\n          <span class="yj-hovercard-info-title">{{mobilePhoneTitle}}:</span>\n          <span class="yj-hovercard-mobile-phone {{#mobilePhoneHighlighted}}yj-hovercard-highlight-text{{/mobilePhoneHighlighted}}">{{mobilePhone}}</span>\n        </div>{{/mobilePhone}}\n      </p>\n    </div>\n    {{#groupsHTML}}<p class="yj-hovercard--user-groups">{{{groupsHTML}}}</p>{{/groupsHTML}}\n    {{#isNew}}<div class="yj-hovercard--new-user-section">\n      <span class="yj-hovercard--avatar-new-badge">\n        <p>{{{svgIcon}}} {{hiNewUser}}</p>\n      </span>\n    </div>{{/isNew}}\n  </div>\n</div>\n<div class="yj-hovercard-action-buttons yj-clearfix">\n  {{ #canSendMessage }}\n    <button class="yj-btn yj-btn-alt yj-chat-button">\n    {{sendMessage}}\n    </button>\n  {{ /canSendMessage }}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/hovercards/hovercard_user_button",["mustache"],function(a){var b='<a href="{{url}}" class="yj-btn {{buttonClass}}">\n  {{buttonText}}\n</a>';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/hovercards/hovercard_user_groups",["mustache"],function(a){var b='<span class="yj-hovercard-info-title">{{groupsWithColon}}</span>\n\n{{#groups}}\n  <a class="yj-hovercard-group-link" href="{{url}}" title="{{fullName}}">{{truncatedName}}</a>{{#comma}},{{/comma}}\n{{/groups}}\n\n{{#andXMore}}<span class="yj-hovercard-group-link">{{andXMore}}</span>{{/andXMore}}';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/hovercards/hovercard_user",["require","jquery","underscore","common-ui/lib/ui/hovercards/hovercard_base","common-ui/lib/ui/shared/follow_button","feeds/lib/ui/publisher/global/publisher_helper","models/message_backbone","models/recipient","models/helpers/user","models/network","models/user","backbone","core/lib/session","core/lib/string_helper","common-ui/lib/helper/svg_icon","core/lib/tr","core/lib/yammer_uri","core/lib/urls","html!./hovercard_user","html!./hovercard_user_button","html!./hovercard_user_groups"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/hovercards/hovercard_base"),e=a("common-ui/lib/ui/shared/follow_button"),f=a("feeds/lib/ui/publisher/global/publisher_helper"),g=a("models/message_backbone"),h=a("models/recipient"),i=a("models/helpers/user"),j=a("models/network"),k=a("models/user"),l=a("backbone"),m=a("core/lib/session"),n=a("core/lib/string_helper"),o=a("common-ui/lib/helper/svg_icon"),p=a("core/lib/tr"),q=a("core/lib/yammer_uri"),r=a("core/lib/urls");return d.extend({_resourceModel:"user",_apiMethodName:"getUser",template:a("html!./hovercard_user"),_buttonTemplate:a("html!./hovercard_user_button"),_groupsTemplate:a("html!./hovercard_user_groups"),accessibilityLabel:p.t("user_hovercard"),initialize:function(){d.prototype.initialize.apply(this,arguments),c.bindAll(this,"_groupData")},getRequestParams:function(){return{id:this._data.id,is_followed_by:m.getCurrentUser().id,include_top_groups:!0,include_presence:!0}},getLocalResource:function(){var a=Date.now();return a-(this._lastFetch||0)>1e4?!1:d.prototype.getLocalResource.apply(this,arguments)},requestResource:function(){return this._lastFetch=Date.now(),d.prototype.requestResource.apply(this,arguments)},processPayload:function(a){d.prototype.processPayload.apply(this,arguments),k.save(a),a.is_followed_by&&i.followUser(m.getCurrentUser(),a.id)},getTemplateContent:function(a){var b=this._getBaseContent(a);return this._isFormerMember(a)?this._formerMemberContent(b):(this._extendWithEmail(b,a),this._extendWithPhones(b,a),this._extendWithHighlightedFields(b),this._extendWithJobTitle(b,a),this._extendWithSendMessageButton(b,a),this._extendWithGroups(b,a),b)},_activityCategory:function(){return this._data&&this._data.hovercard_type},_getBaseContent:function(a){var b={width:12,height:12},c=o("avatar-badge-new",b),d=i.isUser(a)&&i.isNew(a,m);return{fullName:a.get("full_name"),webUrl:this.decorate("qs",r.userIndex(a)),status:i.getPresenceStatus(a,m),presence_class:i.getPresenceCssClass(a,m),foreign:i.isForeign(a,m),foreignNetworkIconAltText:p.t("other_network_icon_alttext"),networkName:i.getNetworkName(a,j),isNew:d,hiNewUser:p.t("hi_new_user"),svgIcon:c}},_isFormerMember:function(a){return a&&!i.isCurrentUser(a,m)&&i.isInactive(a)},_formerMemberContent:function(a){return c.extend(a,{jobTitle:p.t("former_member")})},_extendWithEmail:function(a,b){var c=b.get("email");c&&!this._userHasFakeEmail(b)&&(a.emailTitle=p.t("email"),a.emailAddress=n.truncate(c,80))},_extendWithPhones:function(a,b){a.workPhone=n.truncate(i.getWorkPhoneNumber(b),80),a.mobilePhone=n.truncate(i.getMobilePhoneNumber(b),80),a.workPhoneTitle=p.t("work_number"),a.mobilePhoneTitle=p.t("mobile_number")},_userHasFakeEmail:function(a){return a.get("has_fake_email")},_extendWithHighlightedFields:function(a){var b={};this._isProfileUpdate()&&(b=this._updatedFieldFlags()),a.workPhoneHighlighted=!!b.work_telephone,a.mobilePhoneHighlighted=!!b.mobile_telephone},_isProfileUpdate:function(){return"profile-update"===this._activityCategory()},_isProfilePhotoUpdate:function(){return"profile-update-photo"===this._activityCategory()},_extendWithJobTitle:function(a,b){var c=b.get("job_title")||p.t("member");a.jobTitle=n.truncate(c,75)},_extendWithSendMessageButton:function(a,b){a.canSendMessage=this._canSendMessageTo(b),a.sendMessage=p.t("send_message")},_canSendMessageTo:function(a){return!(this._activityCategory()||i.isCurrentUser(a,m)||i.isInactive(a))},_extendWithGroups:function(a,b){var d=b.get("groups_count")||0;if(0!==d){var e=b.get("top_groups")||[],f=this._andXMoreGroups(e.length,d),g=c.partial(this._groupData,e.length,f);a.groupsHTML=this._groupsTemplate({groupsWithColon:p.t("groups_with_colon"),groups:c.map(e,g),andXMore:f})}},_andXMoreGroups:function(a,b){return b>a?p.t("and_groupscount_more",{groupsCount:b-a}):void 0},_groupData:function(a,b,c,d){return{comma:this._trailingComma(d,a,b),fullName:c.full_name,truncatedName:n.truncate(c.full_name,40),url:this._getGroupUrl(c)}},_trailingComma:function(a,b,c){return 1===b?!1:c?!0:b>a+1},_getGroupUrl:function(a){return this.decorate("qs",r.groupIndex(a),{type:"group"})},_updatedFieldFlags:function(){var a=this._data.updated_fields;return c.isArray(a)?c.reduce(a,function(a,b){return a[b]=1,a},{}):{}},isForeign:function(){var a=this._getUserModel();return a?i.isForeign(a,m):!1},_getUserModel:function(){return k.findById(this._data.id)},addAvatar:function(a){this.add(this.buildAvatar(a),this.$el.find(".yj-hovercard-pic"))},addDynamicElements:function(a){if(this.addAvatar(a),this.$(".yj-chat-button").click(c.partial(this._openChat,a)),a&&!this._isSuspendedOrDeleted(a)){var b=this.$(".yj-hovercard-action-buttons");if(this._isProfileUpdate()||this._isProfilePhotoUpdate())b.append(this._createViewProfileButton(a)),b.append(this._createUpdateProfileButton());else if(this._canFollow(a)){var d=new e({model:a,inHovercard:!0});this.add(d,b)}}},_isSuspendedOrDeleted:function(a){return"suspended"===a.state||"deleted"===a.state},_openChat:function(a){var b=yam.ui.chatManager;if(b&&m.getUserSetting("enable_chat"))b.handleContact(a);else{l.trigger("/ui/tooltip/hide");var c=new g,d=c.get("recipients");d.add(h.fromOriginalModel(a)),f.openComposeLightbox(c,"hovercard")}return!1},_createViewProfileButton:function(a){return b(this._buttonTemplate({buttonText:p.t("view_their_profile"),url:r.userIndex(a),buttonClass:"yj-btn-alt"}))},_createUpdateProfileButton:function(){var a,c;return this._isProfilePhotoUpdate()?(a=p.t("update_your_profile_photo"),c=q.base("/account/basics")):(a=p.t("update_your_profile"),c=q.base("/account/profile_info")),b(this._buttonTemplate({buttonText:a,url:c,buttonClass:"yj-hovercard-right-action-btn"}))},_canFollow:function(a){return!(i.isCurrentUser(a,m)||i.isForeign(a,m))}})}),define("stache!common-ui/lib/ui/hovercards/hovercard_myuser",["mustache"],function(a){var b='<div class="yj-hovercard-main-details yj-clearfix">\n  <div class="yj-hovercard-pic"></div>\n  <div class="yj-hovercard--main-details yj-hovercard-details">\n    <p class="yj-hovercard-title">\n      <a class="yj-hovercard-title-link" href="{{webUrl}}" title="">{{fullName}}</a>\n    </p>\n    {{#showJobTitle}}\n    <p class="yj-hovercard-subtitle">\n      <span class="yj-hovercard-info-title">{{jobTitleLabel}}:</span>\n      <span class="yj-hovercard-jobtitle">{{jobTitle}}</span>\n    </p>\n    {{/showJobTitle}}\n  </div>\n</div>\n<div class="yj-hovercard--details yj-hovercard--self-details">\n  {{#emailAddress}}\n  <p class="yj-hovercard-emailaddress">\n    <span class="yj-hovercard-info-title">{{emailTitle}}:</span>\n    <span class="yj-hovercard-email">{{emailAddress}}</span>\n  </p>\n  {{/emailAddress}}\n  {{#showWorkPhone}}\n  <p class="yj-hovercard-phonenumber yj-hovercard-editable">\n    <span class="yj-hovercard-info-title">{{workPhoneTitle}}:</span>\n    <span class="yj-hovercard-work-phone">{{workPhone}}</span>\n  </p>\n  {{/showWorkPhone}}\n  {{#showMobilePhone}}\n  <p class="yj-hovercard-phonenumber">\n    <span class="yj-hovercard-info-title">{{mobilePhoneTitle}}:</span>\n    <span class="yj-hovercard-mobile-phone">{{mobilePhone}}</span>\n  </p>\n  {{/showMobilePhone}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/hovercards/hovercard_myuser",["require","underscore","common-ui/lib/ui/hovercards/hovercard_user","common-ui/lib/ui/shared/inline_edit","core/lib/namespace","backbone","core/lib/session","core/lib/tr","core/lib/yammer_api","models/helpers/user","html!./hovercard_myuser"],function(a){var b=a("underscore"),c=a("common-ui/lib/ui/hovercards/hovercard_user"),d=a("common-ui/lib/ui/shared/inline_edit"),e=a("core/lib/namespace"),f=a("backbone"),g=a("core/lib/session"),h=a("core/lib/tr"),i=a("core/lib/yammer_api"),j=a("models/helpers/user");return c.extend({className:c.prototype.className+" yj-hovercard-myhovercard",events:{mouseenter:"_onMouseEnter",mouseleave:"_onMouseLeave"},template:a("html!./hovercard_myuser"),accessibilityLabel:h.t("user_hovercard"),getTemplateContent:function(a){var d=c.prototype.getTemplateContent.apply(this,arguments);return b.extend(d,{emailTitle:h.t("email"),jobTitleLabel:h.t("job_title"),jobTitle:a.get("job_title"),workPhone:j.getWorkPhoneNumber(a),mobilePhone:j.getMobilePhoneNumber(a),showJobTitle:this._showProfileField("enable_job_title"),showWorkPhone:this._showProfileField("enable_work_phone"),showMobilePhone:this._showProfileField("enable_mobile_phone")})},_showProfileField:function(a){return e.val(g.getCurrentNetwork(),"profile_fields_config."+a)},getLocalResource:g.getCurrentUser.bind(g),addDynamicElements:function(a){this._mouseOver=!0,this.addAvatar(a),this.addInlineEdit(this.$(".yj-hovercard-jobtitle"),"job_title",h.t("job_title"),h.t("edit_job_title")),this.addInlineEdit(this.$(".yj-hovercard-work-phone"),"work_telephone",h.t("work_number"),h.t("edit_work_number")),this.addInlineEdit(this.$(".yj-hovercard-mobile-phone"),"mobile_telephone",h.t("mobile_number"),h.t("edit_mobile_number"))},addInlineEdit:function(a,c,e,g){var h=this.$(a),j=this.getLocalResource(),k=new d({type:"editable",maxLength:255,fieldLabel:e,editLabel:g});k.options.text=h.text(),k.$el.addClass(h.attr("class")),k.render(),h.replaceWith(k.$el),k.on("change",function(a){if(a){var b={id:j.id};b[c]=a.value,i.updateUser(b).then(function(a){j.update(a)})}}),k.on("focus",function(){f.trigger("/ui/tooltip/lock")}),k.on("blur",b.bind(function(){f.trigger("/ui/tooltip/unlock"),this._mouseOver||f.trigger("/ui/tooltip/hide")},this)),this.add(k,a)},_onMouseEnter:function(){this._mouseOver=!0},_onMouseLeave:function(){this._mouseOver=!1}})}),define("stache!common-ui/lib/ui/shared/button",["mustache"],function(a){var b='{{#icon}}<span class="yamicon {{icon}}"></span>{{/icon}}{{#altText}}<span class="yk-acc-hidden">{{altText}}</span>{{/altText}}{{labelText}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/button",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./button"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("html!./button");return b.extend({mixins:[c],tagName:"button",className:"yj-btn",template:d,defaults:{icon:"",altText:"",labelText:""},initialize:function(a){this.enabled=!0,this.selected=!1,this.renderDisabled=a.renderDisabled},getTemplateData:function(){return this.options},render:function(){return this.renderDisabled&&this.disable(),this},enable:function(){this.enabled=!0,this.$el.removeClass("yj-btn-disabled"),"disabled"in this.$el[0]&&this.$el.prop("disabled",!1)},disable:function(){this.enabled=!1,this.$el.addClass("yj-btn-disabled"),"disabled"in this.$el[0]&&this.$el.prop("disabled",!0)},select:function(){this.selected=!0,this.$el.addClass("yj-btn-selected")},deselect:function(){this.selected=!1,this.$el.removeClass("yj-btn-selected")}})}),define("stache!common-ui/lib/ui/hovercards/hovercard_pending_user",["mustache"],function(a){var b='<div class="yj-hovercard-main yj-clearfix">\n  <div class="yj-hovercard-pic"></div>\n  <div class="yj-hovercard-details">\n    <p class="yj-hovercard-title">\n      <span class="yamicon yamicon-message yamicon-x-small yj-hovercard-pendinguser-presence"></span><a class="yj-hovercard-title-link" href="{{webUrl}}" title="">{{fullName}}</a>\n    </p>\n    <p class="yj-hovercard-subtitle"><span class="yj-hovercard-jobtitle">{{jobTitle}}</span></p>\n    {{#networkHTML}}<p>{{{networkHTML}}}</p>{{/networkHTML}}\n    <p>\n      {{#emailAddress}}\n        <span class="yj-hovercard-info-title">{{emailTitle}}:</span>\n        <span class="yj-hovercard-email">{{emailAddress}}</span>\n      {{/emailAddress}}\n      {{#workPhone}}<div>\n        <span class="yj-hovercard-info-title">{{workPhoneTitle}}:</span>\n        <span class="yj-hovercard-work-phone">{{workPhone}}</span>\n      </div>{{/workPhone}}\n      {{#mobilePhone}}<div>\n        <span class="yj-hovercard-info-title">{{mobilePhoneTitle}}:</span>\n        <span class="yj-hovercard-mobile-phone">{{mobilePhone}}</span>\n      </div>{{/mobilePhone}}\n    </p>\n    <div class="yj-pending-user">\n    <p>\n      <span class="yj-pending-user-text">{{pendingText}}</span>\n    </p>\n    </div>\n  </div>\n</div>\n<div class="yj-hovercard-action-buttons yj-clearfix">{{{pmHTML}}}</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/hovercards/hovercard_pending_user",["require","underscore","common-ui/lib/ui/hovercards/hovercard_base","backbone","core/lib/session","common-ui/lib/ui/shared/button","core/lib/string_helper","core/lib/tr","core/lib/yammer_request","models/helpers/user","core/lib/urls","html!./hovercard_pending_user"],function(a){var b=a("underscore"),c=a("common-ui/lib/ui/hovercards/hovercard_base"),d=a("backbone"),e=a("core/lib/session"),f=a("common-ui/lib/ui/shared/button"),g=a("core/lib/string_helper"),h=a("core/lib/tr"),i=a("core/lib/yammer_request"),j=a("models/helpers/user"),k=a("core/lib/urls");return c.extend({_resourceModel:"user",_apiMethodName:"getUser",template:a("html!./hovercard_pending_user"),_buttonTemplate:'<a href="{{url}}" class="yj-btn {{#leftButton}}yj-btn-alt{{/leftButton}}{{#rightButton}}yj-hovercard-right-action-btn{{/rightButton}}">                          {{buttonText}}                        </a>',_phoneTemplate:'<span class="yj-hovercard-info-title">{{title}}:</span>                       <span class="yj-hovercard-{{type}}-phone">{{number}}</span>',accessibilityLabel:h.t("user_hovercard"),getTemplateContent:function(a){var b,c={fullName:g.truncate(a.get("full_name"),24),webUrl:k.userIndex(a,e),status:j.getPresenceStatus(a,e),pendingText:h.t("this_coworker_not_on_yammer_yet")},d={},f="yj-hovercard-highlight-text";return a&&a.id!=e.getCurrentUser().id&&j.isInactive(a)?(c.jobTitle=h.t("former_member"),c):(a.get("email")&&!a.get("has_fake_email")&&(c.emailTitle=h.t("email"),c.emailAddress=g.truncate(a.get("email"),80)),c.workPhone=g.truncate(j.getWorkPhoneNumber(a),80),c.mobilePhone=g.truncate(j.getMobilePhoneNumber(a),80),c.workPhoneTitle=h.t("work_number"),c.mobilePhoneTitle=h.t("mobile_number"),b=a.get("job_title")?g.truncate(a.get("job_title"),75):"",c.jobTitle=b,d.job_title?c.updatedJobTitle=f:c.updatedJobTitle="",a.get("canonical_network_name")&&(c.networkHTML='<span class="yj-hovercard-info-title">'+h.t("network")+":</span> "+a.get("canonical_network_name")),c)},addAvatar:function(a){this.add(this.buildAvatar(a),".yj-hovercard-pic")},addDynamicElements:function(a){var c,g=this.$(".yj-hovercard-action-buttons"),j=this;this.addAvatar(a),c=new f({labelText:h.t("invite")
}),g.append(c.render().el),this.add(c,".yj-hovercard-action-buttons"),c.$el.on("click",b.bind(function(){i.send({url:k.networkIndex(e.getCurrentNetwork())+"/invitations/emails.js",type:"POST",data:{addresses:j.getLocalResource().get("email"),autofollow:!0,invite_section:"user_hovercard_button",invite_source:"user_hovercard"},success:function(a){if(a.error)d.trigger("/ui/alert/show","error",a.error);else{var b,c=j.getLocalResource();b=c&&c.get("full_name")?c.get("full_name"):this.data.addresses,d.trigger("/ui/alert/show","notice",h.t("you_have_successfully_invited_username",{username:b}))}},error:function(){d.trigger("/ui/alert/show","error",h.t("there_was_an_error"))}})},this))}})}),define("common-ui/lib/ui/shared/face_pile_item",["require","components/avatar/index","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews"],function(a){var b=a("components/avatar/index"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews");return c.extend({mixins:[d,e],tagName:"li",className:"yj-face-item",initialize:function(a){this.add(new b(a))}})}),define("common-ui/lib/ui/shared/face_pile",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","common-ui/lib/ui/shared/face_pile_item"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("common-ui/lib/ui/shared/face_pile_item");return c.extend({mixins:[d,e],tagName:"ul",className:"yj-face-pile",initialize:function(a){b.each(this.collection,function(b){this.add(new f({model:b,withHovercard:a.withHovercard,hideFromAccessibility:a.hideFromAccessibility}))},this)}})}),define("models/lib/helper/external_groups_response_helper",["require","backbone","core/lib/session","collections/groups","collections/group_memberships","core/lib/uri_helper"],function(a){function b(a,b){var c=!1,d=a?a.split("?"):[];if(2===d.length){var e=d[0],f=g.objectify(d[1]);"/threads/inGroup"===e&&"in_group"===f.type&&f.feedId===b.toString()&&(c=!0)}return c}var c=a("backbone"),d=a("core/lib/session"),e=a("collections/groups"),f=a("collections/group_memberships"),g=a("core/lib/uri_helper");return{acceptGroupMembershipInUI:function(a){var g=e.get(a),h=d.getCurrentUser();g&&g.set({member:!0});var i={user_id:h.id,group_id:a},j=f.findWhere(i);j?j.set({invited:!1}):(i.pending=!1,i.type="group_membership",f.add(i));var k=c.history.fragment;b(k,a)&&c.history.loadUrl(k)},rejectGroupMembershipInUI:function(a){var e={user_id:d.getCurrentUser().id,group_id:a},g=f.findWhere(e);g&&g.destroy();var h=c.history.fragment;b(h,a)&&yam.router.navigate("/threads/index",{trigger:!0})}}}),define("common-ui/lib/ui/shared/follow_group_button",["require","underscore","backbone","common-ui/lib/ui/shared/follow_button","collections/group_memberships","collections/groups","core/lib/session","core/lib/tr","models/lib/helper/external_groups_response_helper","core/lib/yammer_api","core/lib/report","models/helpers/user","models/helpers/group"],function(a){var b=a("underscore"),c=a("backbone"),d=a("common-ui/lib/ui/shared/follow_button"),e=a("collections/group_memberships"),f=a("collections/groups"),g=a("core/lib/session"),h=a("core/lib/tr"),i=a("models/lib/helper/external_groups_response_helper"),j=a("core/lib/yammer_api"),k=a("core/lib/report"),l=a("models/helpers/user"),m=a("models/helpers/group");return d.extend({strings:{follow:h.t("join"),unfollow:h.t("leave"),following:h.t("joined"),pending:h.t("pending")},attributes:{"data-qaid":"join_leave_button"},initialize:function(a){b.bindAll(this,"handleLeaveGroup","handleJoinGroup","failureCallback"),a.followText&&(this.strings.follow=a.followText),d.prototype.initialize.call(this,a),e.on("add",this.onGroupMembershipCreate,this),e.on("remove",this.onGroupMembershipDestroy,this)},initFollowingState:function(){this.options.following=l.isMemberOf(g.getCurrentUser(),f.get(this.model.get("id"))),this.options.following&&this.options.following.get("pending")&&this.setFollowing("pending")},onGroupMembershipCreate:function(a){a.get("group_id")===this.model.get("id")&&(a.get("pending")?this.setFollowing("pending"):this.setFollowing(!0),this.options.showHideEl&&this.options.showHideEl.length?this.options.showHideEl.fadeOut("slow",this.updateButtonState.bind(this)):this.updateButtonState())},onGroupMembershipDestroy:function(a){a.get("group_id")===this.model.get("id")&&(this.setFollowing(!1),this.updateButtonState(),this.options.showHideEl&&this.options.showHideEl.length&&this.options.showHideEl.fadeIn("slow"))},getSuccessMessage:function(){return h.t("you_have_joined_the_name_group",{name:m.getFullName(this.model)})},getPendingMessage:function(){return h.t("you_have_requested_to_join_the_name_group",{name:m.getFullName(this.model)})},getButtonClassName:function(){var a=this.elementClassName;return a+="pending"===this.isFollowing()?" yj-follow-btn-pending yj-btn yj-btn-alt yj-btn-disabled":this.isFollowing()?" yj-btn yj-btn-alt yj-unfollow-button":" yj-follow-button yj-btn"},getButtonText:function(){return"pending"===this.isFollowing()?this.strings.pending:this.strings[this.isFollowing()?"following":"follow"]},getButtonQaid:function(){return"pending"===this.isFollowing()?"pending_group_button":this.isFollowing()?"leave_group_button":"join_group_button"},handleClick:function(a){if(a.preventDefault(),"pending"!==this.isFollowing()){var b={group_id:this.model.get("id"),id:this.model.get("id")};if(this.options.inHovercard&&(b.bfr_source="hovercard"),this.toggleLoading(!0),this.isFollowing()){var c=!0;m.isPrivateOrRestricted(this.model)&&(c=this._getLeaveConfirmation()),c&&(this.options.inHeader&&k.event("follow_group_button_leave",{source:"header"}),j.leaveGroup(b).then(this.handleLeaveGroup,this.failureCallback))}else this.options.inHeader&&k.event("follow_group_button_join",{source:"header"}),j.joinGroup(b).then(this.handleJoinGroup,this.failureCallback)}},handleLeaveGroup:function(){if(m.isForeign(this.model,g))i.rejectGroupMembershipInUI(this.model.get("id"));else{var a={user_id:g.getCurrentUser().id,group_id:this.model.get("id")},b=e.findWhere(a);b&&b.destroy()}this.toggleLoading(!1)},handleJoinGroup:function(){var a,b={user_id:g.getCurrentUser().id,group_id:this.model.get("id")},d=this.model.get("privacy");this.toggleLoading(!1),"private"===d||"restricted"===d?(b.pending=!0,c.trigger("/ui/alert/show","notice",this.getPendingMessage())):(l.getGroupMemberships(g.getCurrentUser()).length||c.trigger("taskListComplete","join_a_group"),this.options.inHeader||c.trigger("/ui/alert/show","notice",this.getSuccessMessage())),a=e.findWhere(b),a||e.add(b)},_getLeaveConfirmation:function(){return window.confirm(h.t("are_you_sure_you_want_to_leave_this_group"))}})}),define("models/helpers/external_group",["require","underscore","core/lib/tr","models/helpers/group"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("models/helpers/group");return{getParticipatingNetworksList:function(a,e){var f=this.getForeignNetworkNames(a),g=b.flatten([d.getNetworkName(a,e),f]);return g.length>2?c.t("network_and_count_others",{networkname:g[0],count:g.length-1}):c.tlist(g)},getForeignNetworkNames:function(a){var c=a.get("network_id");return b.chain(a.get("participating_networks")).filter(function(a){return a.id!==c}).pluck("name").value()}}}),define("stache!common-ui/lib/ui/hovercards/hovercard_group",["mustache"],function(a){var b='<div class="yj-hovercard--group">\n  <div class="yj-hovercard--group-pic">{{{avatar}}}</div>\n  <div class="yj-hovercard--group-details">\n    <p class="yj-hovercard--group-title">\n      {{^webUrl}}{{groupName}}{{/webUrl}}\n      {{#webUrl}}<a class="yj-hovercard--group-title-link" href="{{webUrl}}" title="">{{groupName}}</a>{{/webUrl}}\n    </p>\n    {{#foreign}}<div class="foreign-network-name">{{/foreign}}\n      <p class="yj-hovercard--group-subtitle">\n        {{#groupIcon}}\n          <span class="yamicon yamicon-{{groupIcon}} yamicon-small">\n            <span class="yj-acc-hidden">{{groupIconAltText}}</span>\n          </span>\n        {{/groupIcon}}\n        {{#privacyIcon}}\n          <span class="yamicon yamicon-{{privacyIcon}} yj-dark-gray">\n            <span class="yj-acc-hidden">{{privacyIconAltText}}</span>\n          </span>\n        {{/privacyIcon}}\n        {{privacy}}\n      </p>\n    {{#foreign}}</div>{{/foreign}}\n  </div>\n</div>\n<div class="yj-hovercard-groups-sub-details">\n  <p class="yj-hovercard-description">{{description}}</p>\n  {{#related}}<div class="yj-hovercard-section"><span class="yj-hovercard--related-groups-label">{{relatedLabel}}</span> {{{related}}}</div>{{/related}}\n  </div>\n  <div class="yj-clear"></div>\n  <div class="yj-hovercard-action-buttons yj-clearfix"></div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/hovercards/hovercard_group",["require","jquery","models/group","collections/groups","common-ui/lib/ui/hovercards/hovercard_base","common-ui/lib/ui/shared/face_pile","common-ui/lib/ui/shared/follow_group_button","core/lib/string_helper","core/lib/tr","core/lib/yammer_uri","models/lib/orm-models","models/helpers/external_group","models/helpers/group","core/lib/session","core/lib/urls","models/network","html!./hovercard_group"],function(a){var b=a("jquery"),c=a("models/group"),d=a("collections/groups"),e=a("common-ui/lib/ui/hovercards/hovercard_base"),f=a("common-ui/lib/ui/shared/face_pile"),g=a("common-ui/lib/ui/shared/follow_group_button"),h=a("core/lib/string_helper"),i=a("core/lib/tr"),j=a("core/lib/yammer_uri"),k=a("models/lib/orm-models"),l=a("models/helpers/external_group"),m=a("models/helpers/group"),n=a("core/lib/session"),o=a("core/lib/urls"),p=a("models/network");return e.extend({_resourceModel:"group",_apiMethodName:"getGroup",template:a("html!./hovercard_group"),accessibilityLabel:i.t("group_hovercard"),getLocalResource:function(){return this._isAllCompanyGroup()?c.ALL_COMPANY():e.prototype.getLocalResource.apply(this,arguments)},getRequestParams:function(){return{id:this._data.id,include_featured_users:!0,include_related_groups:!0}},getTemplateContent:function(a){return this._isAllCompanyGroup()?this._getCompanyContent():this._getGroupContent(a)},getTemplateContentOnError:function(a){var b;return this._isForeignGroup()?b=this._getFlexternalTooltipContent():this._isXmessResponse(a)&&(b=this._getXmessTooltipContent()),b&&this.$el.addClass("yj-no-action-buttons"),b},_isForeignGroup:function(){var a=this._getGroupModel();return a?m.isForeign(a,n):!1},_getFlexternalTooltipContent:function(){var a=this._getTooltipContent();return a.foreign=!0,a.privacy=this._getNetworkName(),a.privacyIcon="network",a.privacyIconAltText=i.t("other_network_icon_alttext"),delete a.webUrl,a},_getTooltipContent:function(){var a=this._tooltipOpts.target,b=a.attr("href")||a.find("a").attr("href");return{groupName:this._getGroupName(),avatar:'<a title="" href="'+b+'" tabindex="-1" aria-hidden="true"><img class="yj-avatar--thumb" src="'+j.cdn("assets/images/group_profile_medium.gif")+'" alt="" /></a>',privacyIcon:"lock",webUrl:b}},_getGroupName:function(){var a=this._getGroupModel();if(a)return a.get("full_name")},_getNetworkName:function(){var a=this._getNetworkModel();return a?a.getPlainBody():void 0},_getNetworkModel:function(){var a=this._getGroupModel();if(a)return k.Network().findById(a.get("network_id"))},_getGroupModel:function(){var a=this._data.id;if(null!=a)return d.get(a)},_isXmessResponse:function(a){return 403==a.status},_getXmessTooltipContent:function(){var a=this._getTooltipContent();return a.privacy=i.t("private_group"),a},_getGroupContent:function(a){var b,c=m.isDeleted(a),d=m.isForeign(a,n),e=m.isExternal(a),f=null,g=null;d&&!e?(b=this._getNetworkName(),f="network"):e?(b=l.getParticipatingNetworksList(a,p),f="network"):b=c?i.t("deleted_group"):m.isPrivate(a)?i.t("private_group"):i.t("public_group"),m.isPrivate(a)&&(g="lock-MSFT");var k,q,r,s=[],t=a.get("related_groups");if(t){for(k=0;3>k;k++)if(q=t.at(k)){var u=this.decorate("qs",o.groupIndex(q),{type:"related_group"});s.push('<a href="'+u+'">'+q.get("full_name")+"</a>")}r=t.length-3,r>0&&s.push(i.t("and_number_more",{number:r}))}var v=this.decorate("qs",j.app()+"/#/threads/inGroup?type=in_group&feedId="+a.get("id"));return{groupName:h.truncate(a.get("full_name"),45),webUrl:d&&!e?null:v,privacy:b,privacyIcon:f,groupIcon:g,description:c?null:h.truncate(a.get("description"),70),related:s.length?s.join(", "):null,relatedLabel:i.t("related_groups")}},_getCompanyContent:function(){var a=c.ALL_COMPANY(),b=this.decorate("qs",j.app()+"/#/threads/company?type=general");return{groupName:h.truncate(a.get("full_name"),45),webUrl:b,avatar:'<a title="" href="'+b+'" tabindex="-1" aria-hidden="true"><img class="yj-avatar--thumb" src="'+j.cdn("assets/images/company_group_profile.png")+'" alt="" /></a>',privacy:i.t("public_group"),description:h.truncate(a.get("description"),90)}},addAvatar:function(a){this.add(this.buildAvatar(a),".yj-hovercard--group-pic")},addDynamicElements:function(a){var c=this.$(".yj-hovercard-action-buttons");if(this._isAllCompanyGroup()||this.addAvatar(a),a&&!m.isDeleted(a)){var d=a.get("stats"),e=a.get("featured_users");if(d&&e){e.each(function(a){a.set({web_url:this.decorate("qs",o.userIndex(a,n),{type:"user"})})},this);var h;h=b('<div class="yj-hovercard-members yj-hovercard-section yj-online-list yj-hovercard-info-title">'+i.t("count_members",{count:d.members})+"</div>"),this.$(".yj-hovercard-description").after(h);var j=new f({collection:a.get("featured_users").models,withHovercard:!1});this.add(j,".yj-hovercard-members")}if(this._isAllCompanyGroup()){var k=b('<button disabled class="yj-btn yj-btn-disabled"><span class="yamicon yamicon-x-small yamicon-checkmark yj-green"></span> '+i.t("joined")+"</button>");c.append(k)}else{var l;if(this._isForeignGroup())return;l=new g({model:a,inHovercard:!0}),c.append(l.render().el),this.add(l,".yj-hovercard-action-buttons")}}},isForeign:function(){var a=this._getGroupModel();return a?m.isForeign(a,n)||m.isExternal(a):!1},_isAllCompanyGroup:function(){var a=this._getGroupModel();return a?m.isAllCompany(a):m.isAllCompany(this._data)}})}),define("stache!common-ui/lib/ui/hovercards/hovercard_group_description",["mustache"],function(a){var b='<div class="yj-hovercard-group-description yj-hovercard-main yj-clearfix">\n  <div class="yj-hovercard-details">\n    <p class="yj-hovercard-title yj-hovercard-group-description--title">\n      {{title}}\n    </p>\n    <p class="yj-hovercard-group-description--text">\n      {{^show_edit}}\n        {{description}}\n      {{/show_edit}}\n      {{#show_edit}}\n        <span class="yj-hovercard-description">{{edit_label}}</span>\n      {{/show_edit}}\n    </p>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/hovercards/hovercard_group_description",[],function(){}),define("common-ui/lib/ui/hovercards/hovercard_group_description",["require","underscore","collections/groups","common-ui/lib/ui/hovercards/hovercard_base","common-ui/lib/ui/shared/inline_edit","backbone","core/lib/tr","models/helpers/group","core/lib/session","html!./hovercard_group_description","css!common-ui/lib/ui/hovercards/hovercard_group_description"],function(a){var b=a("underscore"),c=a("collections/groups"),d=a("common-ui/lib/ui/hovercards/hovercard_base"),e=a("common-ui/lib/ui/shared/inline_edit"),f=a("backbone"),g=a("core/lib/tr"),h=a("models/helpers/group"),i=a("core/lib/session"),j=a("html!./hovercard_group_description");return a("css!common-ui/lib/ui/hovercards/hovercard_group_description"),d.extend({_resourceModel:"group",events:{mouseenter:"_onMouseEnter",mouseleave:"_onMouseLeave"},template:j,accessibilityLabel:g.t("group_info_hovercard"),getLocalResource:function(){return c.get(this._data.id)},getTemplateContent:function(a){return{title:g.t("group_description_header"),description:a.get("description"),show_edit:h.isEditableByCurrentUser(a),edit_label:g.t("edit_group_description")}},addDynamicElements:function(){this._mouseOver=!0,this._addInlineEdit(this.$(".yj-hovercard-description"),"description",g.t("group_description_form_label"),g.t("edit_group_description"))},isForeign:function(){var a=c.get(this._data.id);return a?h.isForeign(a,i):!1},_addInlineEdit:function(a,c,d,g){var h=this.$(a),i=this.getLocalResource(),j=new e({text:i.get("description"),type:"editable",maxLength:150,fieldLabel:d,editLabel:g,editType:"textarea"});j.$el.addClass(h.attr("class")),j.render(),h.replaceWith(j.$el),j.on("change",function(a){a&&i.save(c,a.value,{patch:!0})}),j.on("focus",function(){f.trigger("/ui/tooltip/lock")}),j.on("blur",b.bind(function(){f.trigger("/ui/tooltip/unlock"),this._mouseOver||f.trigger("/ui/tooltip/hide")},this)),this.add(j,a)},_onMouseEnter:function(){this._mouseOver=!0},_onMouseLeave:function(){this._mouseOver=!1}})}),define("stache!common-ui/lib/ui/hovercards/hovercard_page",["mustache"],function(a){var b='<div class="yj-hovercard-main yj-clearfix">\n  <div class="yj-hovercard-pic">\n    <a class="yamicon yamicon-old-note yj-preview" href="{{webUrl}}" tabindex="-1" aria-hidden="true"></a>\n  </div>\n  <div class="yj-hovercard-details">\n    <p class="yj-hovercard-title">\n      <a class="yj-hovercard-title-link yj-preview" href="{{webUrl}}" title="">{{name}}</a>\n    </p>\n    <p class="yj-hovercard-subtitle">{{{group}}}</p>\n    <p>{{description}}</p>\n  </div>\n</div>\n<div class="yj-hovercard-action-buttons yj-clearfix">\n  <a class="yj-btn yj-btn-alt" href="{{webUrl}}">{{goTo}}</a>\n  <button class="yj-btn yj-preview">{{preview}}</button>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/hovercards/hovercard_page",["require","jquery","common-ui/lib/ui/hovercards/hovercard_base","common-ui/lib/ui/shared/face_pile","collections/groups","models/attachment","core/lib/model_helper","core/lib/namespace","backbone","core/lib/report","core/lib/session","core/lib/string_helper","core/lib/tr","core/lib/yammer_uri","models/helpers/network","core/lib/urls","html!./hovercard_page"],function(a){var b=a("jquery"),c=a("common-ui/lib/ui/hovercards/hovercard_base"),d=a("common-ui/lib/ui/shared/face_pile"),e=a("collections/groups"),f=a("models/attachment"),g=a("core/lib/model_helper"),h=a("core/lib/namespace"),i=a("backbone"),j=a("core/lib/report"),k=a("core/lib/session"),l=a("core/lib/string_helper"),m=a("core/lib/tr"),n=a("core/lib/yammer_uri"),o=a("models/helpers/network"),p=a("core/lib/urls");return c.extend({_resourceModel:"page",_apiMethodName:"getNote",template:a("html!./hovercard_page"),accessibilityLabel:m.t("note_hovercard"),getLocalResource:function(){var a=c.prototype.getLocalResource.apply(this,arguments);return a&&a.featured_users?a:!1},getRequestParams:function(){return{note_id:this._data.id,include_featured_users:!0}},getTemplateContent:function(a){var b,c,d,f,h={webUrl:a.web_url,name:a.title,description:l.truncate(a.description,70),preview:m.t("preview_2"),goTo:m.t("go_to_note"),iconUrl:n.cdn("assets/images/pages/page_icon.png?_=2")};return a.group_id?(d=yam.backbone.isBackboneModel("yam.model.Group")?e.get(a.group_id):g.objectForReference({id:a.group_id,type:"group"}),d&&(b=d.get("full_name"),c=p.groupIndex(d))):(b=o.getCompanyGroupName(k.getCurrentNetwork()),c=n.app()+"/groups/company"),b&&c&&(f='<a class="yj-hovercard-group-link" href="'+c+'" title="'+b+'">'+l.truncate(b,40)+"</a>",h.group=m.t("posted_in_group",{group:f})),h},addDynamicElements:function(a){var c=this.$(".yj-hovercard-action-buttons");this.$(".yj-preview").click(function(b){return i.trigger("/ui/tooltip/hide"),b.preventDefault(),f.create(a),i.trigger("/ui/fancy-lightbox/open",{attachmentId:a.id}),!1});var e=a.featured_users,g=0|h.val(a,"stats.followers");if(e&&e.length){this.$(".yj-hovercard-details").append('<div class="yj-hovercard-followers yj-hovercard-section yj-online-list yj-hovercard-info-title">'+m.t("followers_qty",{qty:g})+"</div>");var k=new d({collection:e,withHovercard:!1});this.add(k,".yj-hovercard-followers")}b.merge(c.find("a"),c.find("button")).click(function(){j.event("hovercard_cta_click",{type:"note",label:b.trim(b(this).text())})})}})}),define("stache!common-ui/lib/ui/hovercards/hovercard_file",["mustache"],function(a){var b='<div class="yj-hovercard-main yj-clearfix">\n  <div class="yj-hovercard-pic">\n    <a class="{{#thumbUrl}}yj-hovercard-thumb{{/thumbUrl}}{{^thumbUrl}}yj-hovercard-icon{{/thumbUrl}} {{#preview}}yj-preview{{/preview}}"\n       href="{{webUrl}}" aria-hidden="true" tabindex="-1">\n      {{#thumbUrl}}\n        <img class="yj-hovercard-thumb-img" src="{{thumbUrl}}"/>\n      {{/thumbUrl}}\n      {{^thumbUrl}}\n        {{{svgIcon}}}\n      {{/thumbUrl}}\n    </a>\n  </div>\n  <div class="yj-hovercard-details">\n    <p class="yj-hovercard-title">\n      <a class="yj-hovercard-title-link {{#preview}}yj-preview{{/preview}}" href="{{webUrl}}" title="">{{name}}</a>\n    </p>\n    <p class="yj-hovercard-subtitle">{{{group}}}</p>\n    <p>{{description}}</p>\n  </div>\n</div>\n<div class="yj-hovercard-action-buttons yj-clearfix">\n  <a class="yj-btn yj-btn-alt yj-goto-btn {{ctaType}}" href="{{webUrl}}">{{goTo}}</a>\n  {{#preview}}\n    <button class="yj-btn yj-preview">{{preview}}</button>\n  {{/preview}}\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/hovercards/hovercard_file",["require","jquery","underscore","common-ui/lib/ui/hovercards/hovercard_base","common-ui/lib/ui/shared/face_pile","feeds/lib/ui/attachments/yamio_preview","collections/groups","core/lib/model_helper","core/lib/namespace","core/lib/report","core/lib/session","core/lib/string_helper","core/lib/tr","core/lib/yammer_uri","backbone","core/lib/filename_helper","common-ui/lib/helper/svg_icon","models/helpers/user","models/helpers/network","core/lib/urls","html!./hovercard_file"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/hovercards/hovercard_base"),e=a("common-ui/lib/ui/shared/face_pile"),f=a("feeds/lib/ui/attachments/yamio_preview"),g=a("collections/groups"),h=a("core/lib/model_helper"),i=a("core/lib/namespace"),j=a("core/lib/report"),k=a("core/lib/session"),l=a("core/lib/string_helper"),m=a("core/lib/tr"),n=a("core/lib/yammer_uri"),o=a("backbone"),p=a("core/lib/filename_helper"),q=a("common-ui/lib/helper/svg_icon"),r=a("models/helpers/user"),s=a("models/helpers/network"),t=a("core/lib/urls");return d.extend({_resourceModel:"uploaded_file",_apiMethodName:"getUploadedFile",template:a("html!./hovercard_file"),accessibilityLabel:m.t("file_hovercard"),getLocalResource:function(){var a=d.prototype.getLocalResource.apply(this,arguments);return a&&a.featured_users?a:!1},getRequestParams:function(){return{id:this._data.id,include_featured_users:!0}},processPayload:function(a){var b,d,e,f;if(a&&(f=a.files),f)for(b=0,d=f.length;d>b;++b)e=f[b],e.is_reference=!1,h.getModelByType(e.type).save(e),c.some(e.featured_users,function(a){return a.id===k.getCurrentUser().id})&&r.followFile(k.getCurrentUser(),e.id)},getTemplateContent:function(a){var b,c,d,e,f={webUrl:t.fileIndex(a),name:a.get("name"),goTo:m.t("go_to_file_2"),ctaType:""},h=p.getFileIconClass(a.name),j={width:50,height:50};a.group_id?(d=g.get(a.group_id),d&&(b=d.get("full_name"),c=t.groupIndex(d))):(b=s.getCompanyGroupName(k.getCurrentNetwork()),c=n.app()+"/groups/company"),b&&c&&(e='<a class="yj-hovercard-group-link" href="'+c+'" title="'+b+'">'+l.truncate(b,40)+"</a>",f.group=m.t("posted_in_group",{group:e}));var o=i.val(a,"latest_version.thumbnail_url"),r=i.val(a,"content_class");r&&"Image"==r?f.thumbUrl=o:f.svgIcon=q("docicon-big-"+h,j);var u=a.preview_url;return u&&(f.preview=m.t("preview_2")),f},addDynamicElements:function(a){var c=this.$(".yj-hovercard-action-buttons");this.$(".yj-preview").click(function(b){o.trigger("/ui/tooltip/hide"),f.showOverlayForAttachment(a),b.preventDefault()});var d=a.featured_users,g=0|i.val(a,"stats.followers");if(d&&d.length){var h=b('<div class="yj-hovercard-followers yj-hovercard-section yj-online-list yj-hovercard-info-title">'+m.t("followers_qty",{qty:g})+"</div>");this.$(".yj-hovercard-details").append(h);var k=new e({collection:d,withHovercard:!1});this.add(k,".yj-hovercard-followers")}b.merge(c.find("a"),c.find("button")).click(function(){j.event("hovercard_cta_click",{type:"uploaded_file",label:b.trim(b(this).text())})})}})}),define("stache!common-ui/lib/ui/shared/mobile_install",["mustache"],function(a){var b='<h3>{{message}}</h3><form id="phone_install_form" action="{{action}}"><select name="phone_country_code" id="phone_country_code">{{#codes}}<option value="{{code}}"{{#selected}}selected{{/selected}}>{{country}} (+{{code}})</option>{{/codes}}</select><input id="phone_number" maxlength="18" name="phone_number" placeholder="{{placeholder}}" title="{{placeholder}}" type="tel" value="" data-watermarked="true"><button type="submit" class="yj-btn yj-btn-tertiary yj-phone-submit"><span>{{buttonText}}</span></button></form><p class="sms-rates">{{dataRatesText}}</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/shared/mobile_install",[],function(){}),define("common-ui/lib/ui/shared/mobile_install",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/session","core/lib/tr","core/lib/yammer_request","html!./mobile_install","css!./mobile_install"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("backbone"),f=a("core/lib/session"),g=a("core/lib/tr"),h=a("core/lib/yammer_request"),i=a("html!./mobile_install");a("css!./mobile_install");var j={Algeria:213,Andorra:376,Angola:244,Anguilla:1264,"Antigua & Barbuda":1268,"Antilles (Dutch)":599,Argentina:54,Armenia:374,Aruba:297,"Ascension Island":247,Australia:61,Austria:43,Azerbaijan:994,Bahamas:1242,Bahrain:973,Bangladesh:880,Barbados:1246,Belarus:375,Belgium:32,Belize:501,Benin:229,Bermuda:1441,Bhutan:975,Bolivia:591,"Bosnia Herzegovina":387,Botswana:267,Brazil:55,Brunei:673,Bulgaria:359,"Burkina Faso":226,Burundi:257,Cambodia:855,Cameroon:237,Canada:1,"Cape Verde Islands":238,"Cayman Islands":1345,"Central African Republic":236,Chile:56,China:86,Colombia:57,Comoros:269,Congo:242,"Cook Islands":682,"Costa Rica":506,Croatia:385,Cuba:53,Cyprus:357,"Czech Republic":42,Denmark:45,"Diego Garcia":2463,Djibouti:253,Dominica:1809,"Dominican Republic":1809,Ecuador:593,Egypt:20,Eire:353,"El Salvador":503,"Equatorial Guinea":240,Eritrea:291,Estonia:372,Ethiopia:251,"Falkland Islands":500,"Faroe Islands":298,Fiji:679,Finland:358,France:33,"French Guiana":594,"French Polynesia":689,Gabon:241,Gambia:220,Georgia:7880,Germany:49,Ghana:233,Gibraltar:350,Greece:30,Greenland:299,Grenada:1473,Guadeloupe:590,Guam:671,Guatemala:502,Guinea:224,"Guinea - Bissau":245,Guyana:592,Haiti:509,Honduras:504,"Hong Kong":852,Hungary:36,Iceland:354,India:91,Indonesia:62,Iran:98,Iraq:964,Israel:972,Italy:39,"Ivory Coast":225,Jamaica:1876,Japan:81,Jordan:962,Kazakhstan:7,Kenya:254,Kiribati:686,"Korea North":850,"Korea South":82,Kuwait:965,Kyrgyzstan:996,Laos:856,Latvia:371,Lebanon:961,Lesotho:266,Liberia:231,Libya:218,Liechtenstein:417,Lithuania:370,Luxembourg:352,Macao:853,Macedonia:389,Madagascar:261,Malawi:265,Malaysia:60,Maldives:960,Mali:223,Malta:356,"Marshall Islands":692,Martinique:596,Mauritania:222,Mayotte:269,Mexico:52,Micronesia:691,Moldova:373,Monaco:377,Mongolia:976,Montserrat:1664,Morocco:212,Mozambique:258,Myanmar:95,Namibia:264,Nauru:674,Nepal:977,Netherlands:31,"New Caledonia":687,"New Zealand":64,Nicaragua:505,Niger:227,Nigeria:234,Niue:683,"Norfolk Islands":672,"Northern Marianas":670,Norway:47,Oman:968,Pakistan:92,Palau:680,Panama:507,"Papua New Guinea":675,Paraguay:595,Peru:51,Philippines:63,Poland:48,Portugal:351,"Puerto Rico":1787,Qatar:974,Reunion:262,Romania:40,Russia:7,Rwanda:250,"San Marino":378,"Sao Tome & Principe":239,"Saudi Arabia":966,Senegal:221,Serbia:381,Seychelles:248,"Sierra Leone":232,Singapore:65,"Slovak Republic":421,Slovenia:386,"Solomon Islands":677,Somalia:252,"South Africa":27,Spain:34,"Sri Lanka":94,"St. Helena":290,"St. Kitts":1869,"St. Lucia":1758,Sudan:249,Suriname:597,Swaziland:268,Sweden:46,Switzerland:41,Syria:963,Taiwan:886,Tajikstan:7,Thailand:66,Togo:228,Tonga:676,"Trinidad & Tobago":1868,Tunisia:216,Turkey:90,Turkmenistan:993,"Turks & Caicos Islands":1649,Tuvalu:688,Uganda:256,Ukraine:380,"United Arab Emirates":971,"United Kingdom":44,"United States":1,Uruguay:598,Uzbekistan:7,Vanuatu:678,"Vatican City":379,Venezuela:58,Vietnam:84,"Virgin Islands - British":1284,"Virgin Islands - US":1340,"Wallis & Futuna":681,"Yemen (North)":969,"Yemen (South)":967,Yugoslavia:381,Zaire:243,Zambia:260,Zimbabwe:263};return c.extend({mixins:[d],id:"mobileInstall",className:"yj-mobile-install",template:i,getTemplateData:function(){return{action:"",message:g.t("stay_connected_to_company_conversations",{company:f.getCurrentNetwork().name||""}),placeholder:g.t("enter_your_phone_number"),buttonText:g.t("text_me_the_app"),dataRatesText:g.t("your_carriers_standard_message_and_data_rates_may_apply"),codes:b.map(j,function(a,b){return{country:b,code:a,selected:1==a}})}},events:{"click .yj-phone-submit":"handleSubmit","keyup #phone_number":"handleBadNumber"},handleBadNumber:function(){var a=this.$el.find("#phone_number"),b=a.val();null!==b.match(/[^0-9|\s|-]/)?a.addClass("yj-error"):a.removeClass("yj-error")},destroy:function(){this.remove()},handleSubmit:function(a){a.preventDefault(),a.stopPropagation(),h.send({method:"POST",dataType:"json",url:"/sms",data:{phone_country_code:this.$el.find("#phone_country_code").val(),phone_number:this.$el.find("#phone_number").val(),source:"ticker_hovercard"},success:this.handleMobileSuccess,failure:this.handleMobileFailure,error:this.handleMobileError})},handleMobileFailure:function(){e.trigger("/ui/alert/show","error",g.t("there_was_an_error_submitting_your_number_please_try_again"))},handleMobileError:function(a){if(a.responseText){var b=JSON.parse(a.responseText);b.error&&e.trigger("/ui/alert/show","error",b.error)}},handleMobileSuccess:function(a){a.notice&&e.trigger("/ui/alert/show","notice",a.notice),e.trigger("/ui/lightbox/close")}})}),define("workfeed/lib/app/app_directory_oauth_dialog",["require","core/lib/ctor","backbone","core/lib/tr","core/lib/yammer_request"],function(a){var b=a("core/lib/ctor"),c=a("backbone"),d=a("core/lib/tr"),e=a("core/lib/yammer_request");return b(null,{init:function(a){var b=this,f=800,g=480,h=screen.width/2-f/2,i=screen.height/2-g/2,j=window.open(a,"oauth_popup","width="+f+",height="+g+",top="+i+",left="+h);j.window.popup=!0,j.window.decline=function(){j.close()},j.window.accept=function(a){a+="&allow=Allow",e.send({url:a,type:"POST",contentType:"application/json; charset=utf-8",success:function(a){j.close(),b.navigateToApp(a.link)},error:function(){j.close(),c.trigger("/ui/alert/show","error",d.t("installing_this_app_was_unsuccessful"))}})}},navigateToApp:function(a){window.location.href=a}})}),define("stache!common-ui/lib/ui/notifications/action_button",["mustache"],function(a){var b='<span class="{{iconClassName}}"></span> <span class="yj-label">{{text}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/notifications/action_button",[],function(){}),define("common-ui/lib/ui/notifications/action_button",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/ui/general/lightbox_manager","common-ui/lib/ui/shared/mobile_install","backbone","core/lib/tr","workfeed/lib/app/app_directory_oauth_dialog","models/helpers/message","core/lib/yammer_request","html!./action_button","css!./action_button"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("common-ui/lib/ui/general/lightbox_manager"),f=a("common-ui/lib/ui/shared/mobile_install"),g=a("backbone"),h=a("core/lib/tr"),i=a("workfeed/lib/app/app_directory_oauth_dialog"),j=a("models/helpers/message"),k=a("core/lib/yammer_request"),l=a("html!./action_button");
return a("css!./action_button"),c.extend({mixins:[d],tagName:"a",attributes:{role:"button"},className:"yj-notification-action yj-btn",template:l,initialize:function(a){this.data=a.data,this.actionIndex=a.actionIndex},getTemplateData:function(){return this.prepTemplateData(this.data)},render:function(){return this.prepElementAttributes(this.data),this},prepElementAttributes:function(a){switch(this.$el.attr("action-index",this.actionIndex),a.decoration){case"plus":this.$el.addClass("yj-notification-action-plus");break;case"minus":this.$el.addClass("yj-notification-action-minus yj-btn-alt");break;case"secondary":this.$el.addClass("yj-notification-action-alt yj-btn-alt");break;case"thumbs-up":this.$el.addClass("yj-notification-action-thumbs-up")}"disabled"===a.action.type&&this.$el.addClass("yj-btn-disabled"),"redirect"===a.action.type?this.$el.attr("href",a.action.url):this.$el.attr("href","javascript://")},prepTemplateData:function(a){var b="yj-notification-action--icon yamicon",c="yamicon-xxx-small";switch("checked"===a.action.type&&(b+=" yamicon-checkmark yj-green"),a.decoration){case"thumbs-up":b+=" yamicon-like",c="yamicon-xx-small";break;case"plus":b+=" yamicon-plus";break;case"minus":b+=" yamicon-dash";break;case"checked":b+=" yamicon-checkmark yj-green";break;case"secondary":b+=" yamicon-dash"}return{iconClassName:b+" "+c,text:a.label}},onButtonClick:function(){var a=this.data.action;if("redirect"!==a.type&&"disabled"!==a.type&&"mobile"!==a.type&&"oauth"!==a.type)k.send({success:this._onActionSuccess.bind(this),error:this._onActionFailure.bind(this),url:a.url,method:a.method,data:a.body,dataType:"text"});else if("mobile"===a.type)g.trigger("/ui/tooltip/hide"),e.openComponent(new f({}),"yj-mobile-install-lightbox",void 0,{title:h.t("get_the_yammer_mobile_app"),overlayClose:!0});else if("oauth"===a.type){g.trigger("/ui/tooltip/hide");var b=a.url,c=this.appDirectoryId;new i(b,c)}},_onActionSuccess:function(){var a=this._getActionMessageText(this.data.messages.success);g.trigger("/ui/alert/show","notice",a),this.$el.parent().parent().trigger("actionSuccess",[this.data])},_onActionFailure:function(){var a=this._getActionMessageText(this.data.messages.failure);g.trigger("/ui/alert/show","error",a)},_getActionMessageText:function(a){var c;if(a.key){var d=a.key,e=b.omit(this.data.messages.success,"key");c=j.translateFromKey(d,e,{nameOnly:!0})}else c=a;return c}})}),define("stache!common-ui/lib/ui/hovercards/hovercard_client",["mustache"],function(a){var b='<div class="yj-hovercard-main yj-clearfix">\n{{#heading}}<div class="yj-hovercard-heading">{{{heading}}}</div>{{/heading}}\n{{#iconUrl}}\n<div class="yj-hovercard-pic">\n  <a class="yj-hovercard-icon" href="{{webUrl}}" aria-hidden="true" tabindex="-1">\n    <img class="yj-hovercard-icon-img" src="{{iconUrl}}" alt="">\n  </a>\n</div>\n{{/iconUrl}}\n<div class="yj-hovercard-details">\n  <p class="yj-hovercard-title">\n    <a class="yj-hovercard-title-link" href="{{webUrl}}" title="">{{title}}</a>\n  </p>\n  <p>{{createDate}}</p>\n  {{#webUrl}}\n    <p class="yj-hovercard-subtitle"><a href="{{webUrl}}">{{shortWebUrl}}</a></p>\n  {{/webUrl}}\n  <p>{{{message}}}</p>\n</div>\n</div>\n<div class="yj-hovercard-action-buttons yj-clearfix">\n  <span class="hidden-placeholder" style="display:none">{{goTo}}</span>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/hovercards/hovercard_client",["require","jquery","underscore","common-ui/lib/ui/hovercards/hovercard_base","common-ui/lib/ui/notifications/action_button","core/lib/date_helper","core/lib/model_helper","core/lib/string_helper","core/lib/tr","core/lib/yammer_uri","core/lib/urls","html!./hovercard_client"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/hovercards/hovercard_base"),e=a("common-ui/lib/ui/notifications/action_button"),f=a("core/lib/date_helper"),g=a("core/lib/model_helper"),h=a("core/lib/string_helper"),i=a("core/lib/tr"),j=a("core/lib/yammer_uri"),k=a("core/lib/urls");return d.extend({template:a("html!./hovercard_client"),accessibilityLabel:i.t("activity_hovercard"),getLocalResource:function(){return!0},getTemplateContent:function(){var a=this._data,b=a.content;if(!b)return!1;var d,e,l,m,n,o,p,q,r=a.target;r&&(d=yam.backbone.isBackboneModel(r.type)?yam.backbone.getBackboneCollectionInstance(r.type).get(r.id):g.objectForReference({id:r.id,type:r.type}),d&&(e=d.full_name||d.name,l=d.image,m=d.description,n=k.indexForModel(d),o=d.object_type,p=d.is_first_party,q=d.type&&"open_graph_object"==d.type));var s,t,u=p?d.site_name||h.truncate(b.name,24):h.truncate(b.name,24);s=p&&""===d.site_name?i.t("type",{type:o?h.capitalize(o):"Page"}):p?i.t("type_on_name",{type:o?h.capitalize(o):"Page",name:u}):i.t("type_in_name",{type:o?h.capitalize(o):"Page",name:u}),t=p&&q&&!l?null:l||b.icon_url;var v=n||b.url,w={title:e?h.truncate(e,24):u,webUrl:v,ogo:!(!d||!d.id),shortWebUrl:h.truncate(v,36),iconUrl:t,target:s};d&&d.id&&(w.webUrl=j.app("graph/"+d.id)),m?w.message=h.truncate(c.escape(m),70):e||(w.message=b.message);var x=b.heading;return x&&(w.heading=x),a.created_at&&(w.createDate=i.t("updated_ago",{ago:f.formatAgo(new Date(a.created_at).getTime())})),w},addDynamicElements:function(){var a,c=this._data.actions,d=[];if(c)for(var f=0,g=c.length;g>f;++f)a=new e({data:c[f],id:"staticHovercardButton_"+f,actionIndex:f,appDirectoryId:this._data.id}),d.push(a),this.add(a,".yj-hovercard-action-buttons");this.$el.delegate(".yj-notification-action","click",function(a){var c=b(this),e=c.attr("action-index");d[e].onButtonClick(a,c)})}})}),define("stache!common-ui/lib/ui/hovercards/hovercard_guide",["mustache"],function(a){var b='<div class="yj-hovercard-main yj-clearfix">\n  <div class="yj-hovercard-pic"></div>\n  <div class="yj-hovercard-details">\n    <p class="yj-hovercard-title">{{title}}</p>\n    <p>\n      <strong>{{textPrefix}}:</strong> {{text}}\n    </p>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/hovercards/hovercard_guide",["require","components/avatar/index","models/guide","common-ui/lib/ui/hovercards/hovercard_base","core/lib/tr","html!./hovercard_guide"],function(a){var b=a("components/avatar/index"),c=a("models/guide"),d=a("common-ui/lib/ui/hovercards/hovercard_base"),e=a("core/lib/tr");return d.extend({_resourceModel:"guide",_apiMethodName:"getGuide",template:a("html!./hovercard_guide"),accessibilityLabel:e.t("guide_hovercard"),getLocalResource:function(){return c.findFirst()},getTemplateContent:function(){return{title:"Yammer",textPrefix:e.t("tip"),text:e.t("hover_over_a_coworkers_profile_photo_to_see_more_about")}},buildAvatar:function(a){return new b({model:a,askForPhoto:!1,withHovercard:!1,className:"yj-avatar no-border",hideFromAccessibility:!0})},addAvatar:function(a){this.add(this.buildAvatar(a),".yj-hovercard-pic")},addDynamicElements:function(a){this.addAvatar(a)}})}),define("common-ui/lib/ui/hovercards/hovercard_manager",["require","jquery","underscore","backbone","common-ui/lib/ui/hovercards/hovercard_user","common-ui/lib/ui/hovercards/hovercard_myuser","common-ui/lib/ui/hovercards/hovercard_pending_user","common-ui/lib/ui/hovercards/hovercard_group","common-ui/lib/ui/hovercards/hovercard_group_description","common-ui/lib/ui/hovercards/hovercard_page","common-ui/lib/ui/hovercards/hovercard_file","common-ui/lib/ui/hovercards/hovercard_client","common-ui/lib/ui/hovercards/hovercard_guide","core/lib/log","core/lib/session","models/user","common-ui/lib/ui/shared/tooltip"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("common-ui/lib/ui/hovercards/hovercard_user"),f=a("common-ui/lib/ui/hovercards/hovercard_myuser"),g=a("common-ui/lib/ui/hovercards/hovercard_pending_user"),h=a("common-ui/lib/ui/hovercards/hovercard_group"),i=a("common-ui/lib/ui/hovercards/hovercard_group_description"),j=a("common-ui/lib/ui/hovercards/hovercard_page"),k=a("common-ui/lib/ui/hovercards/hovercard_file"),l=a("common-ui/lib/ui/hovercards/hovercard_client"),m=a("common-ui/lib/ui/hovercards/hovercard_guide"),n=a("core/lib/log"),o=a("core/lib/session"),p=a("models/user"),q=a("common-ui/lib/ui/shared/tooltip"),r=function(){this._hovercards=[],this.listenTo(d,"/ui/hovercard/remove",this.remove),this.listenTo(d,"/ui/hovercard/add",this.add),this.listenTo(d,"/ui/hovercard/build",this.build),this.listenTo(d,"/ui/hovercard/show",this.show)};return c.extend(r.prototype,d.Events,{stop:function(){this._hovercards.forEach(function(a){q.hideAndRemoveTooltip(a)}),this._hovercards.length=0,this.stopListening()},getHovercardType:function(a){var b,c=a.type;switch(c){case"user":var d=a.id===o.getCurrentUser().id,q=p.findById(a.id),r=q&&"pending"===q.get("state");b=d?new f:r?new g:new e;break;case"guide":b=new m;break;case"group":b=new h;break;case"group_description":b=new i;break;case"page":b=new j;break;case"uploaded_file":b=new k;break;case"client":a.id&&(b=new l);break;case"tag":case"topic":case"network":break;default:n.warn("Unknown hovercard type - "+c)}return b},add:function(a,c){if("object"!=typeof c||arguments.length>2)throw"Deprecated arguments passed to Hovercard!";if(!b("html").hasClass("no-hovercards")){var d=this.getHovercardType(c);if(d){a.attr("title","");var e={className:"yj-hovercard yj-hovercard-no-action-buttons yj-balloon "+(c.className||""),contentClassName:"yj-balloon-content",align:"left",orientation:c.orientation||"top",delay:c.delay||500,arrowPadding:0,validHTML:!0,stayVisible:!0,arrowHTML:'<div class="yj-balloon-arrow-border"></div><div class="yj-balloon-arrow"></div>',hideTime:0,fadeTime:200,target:a,fixed:c.fixed||!1,forceModal:c.forceModal||!1,spinnerDelay:c.spinnerDelay||2e3,closeButton:{icon:"yj-hovecard--close-button yamicon yamicon-x yamicon-xx-small yj-dark-gray-light"},showOnFocus:!1,showOnClick:!!c.showOnClick,treatAsDialog:!0,accessibilityLabel:d.accessibilityLabel};e.text=function(){return d.buildHovercard(e,c)},this._hovercards.push(q.addTooltip(e.target,e.text,e))}}},build:function(a,d,e){var f=300;e=e||{},a.find(d).each(c.bind(function(a,d){var g=b(d),h=c.extend({id:g.data("resource-id"),type:g.data("resource-model")||"user",delay:g.data("delay")||f,orientation:g.data("orientation")},e);this.add(g,h)},this))},show:function(a){var b={id:a.data("resource-id"),type:a.data("resource-model")||"user",orientation:a.data("orientation"),fixed:!0,forceModal:!0};this.add(a,b)},remove:function(a){q.hideAndRemoveTooltip(a)}}),r}),define("feeds/lib/ui/shared/network_switcher",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/session","core/lib/report","models/helpers/network","models/lib/events","models/network"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/session"),f=a("core/lib/report"),g=a("models/helpers/network"),h=a("models/lib/events");return a("models/network"),d.extend({el:"#uni-networks-title",events:{"click .nav-toggle-menu .nav-list-link":"_trackClick"},initialize:function(){this.listenTo(h,"Network/save",this.onNetworkSave.bind(this)),e.getCurrentNetwork().listen(),this.initialized=!0},onNetworkSave:function(a){this._updateMessageCounts(a),this._renderGlobalNetworkBadge(),this.$el.removeClass("yj-loading")},_hasUnseen:function(){for(var a=yam.model.Network.all(),b=0;b<a.length;++b){var c=a[b];if(!g.isCurrent(c,e)&&g.getUnseen(c))return!0}return!1},_updateMessageCounts:function(a){var b=g.getUnseenCount(a),c=this.$('.uni-network-count[data-network-id="'+a.id+'"]');c.closest("li").hasClass("uni-current-network")||(b>0?c.text(100>b?b:"99+"):c.text(""))},_renderGlobalNetworkBadge:function(){var a=c.reduce(yam.model.Network.all(),function(a,b){return g.isCurrent(b,e)?a:a+g.getUnseenCount(b)},0);a>0?(this.$el.addClass("has-alerts"),this.$(".uni-network-count").show()):this.$el.removeClass("has-alerts")},_trackClick:function(a){f.event("nav_networks_menu_link",{trigger:b(a.currentTarget).data("qaid")})}})}),define("css!common-ui/lib/ui/shared/scroller",[],function(){}),define("common-ui/lib/ui/shared/scroller",["require","jquery","underscore","common-ui/lib/helper/environment","css!./scroller"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/helper/environment");a("css!./scroller");var e;return function(a,b){e=function(e,f,g,h,i){g=c.isUndefined(g)?5:g,i=i||{};var j,k,l,m,n=d.isOlderIE(),o=!1,p=c.uniqueId("yj-scroller-"),q=i.throttle||0,r={setup:function(b,c,d){r.enable(),b&&(f=b),c&&(g=c),d&&(h=d),r.wrap(),j=e.closest(".yj-scroller-viewport"),k=j.find(".yj-scroller").css("height",f),l=a("<div class='yj-mockscroll'><div class='yj-mockscroll-bar' /></div>").appendTo(j),m=j.find(".yj-scroller-content").width(h||j.width()||""),i.viewportClass&&j.addClass(i.viewportClass),r.top=k.scrollTop.bind(k),r.bindEvents(),i.alwaysShow?(r.calculate(),r.show()):r.addClasses()},unsetup:function(){r.disabled||(r.disable(),r.bindEvents(!1),j.find(".yj-mockscroll").remove(),r.unwrap())},updateHeight:function(a){f=a,k.css("height",f)},updateWidth:function(a){h=a,m.css("width",h)},wrap:function(){r.unwrap(),e=a(e).wrap('<div class="yj-scroller-viewport" data-yj-scroller="'+p+'" />').wrap('<div class="yj-scroller" data-yj-scroller="'+p+'" />').wrap('<div class="yj-scroller-content" data-yj-scroller="'+p+'" />')},unwrap:function(){for(;e.parent().attr("data-yj-scroller")===p;)e.unwrap()},bindEvents:function(a){a=a===b?!0:a;var c="bind",d="addEventListener",e="attachEvent";a||(c="unbind",d="removeEventListener",e="detachEvent"),j[c]({mouseover:r.mouseover,mouseout:r.mouseout,mousedown:r.mousedown,domchange:r.calculate,touchmove:r.calculate}),i.useWheel?window.addEventListener?k[0][d]("wheel",r.wheel,!1):document[e]("onmousewheel",r.wheel):window.addEventListener?(k[0][d]("DOMMouseScroll",r.wheel,!1),k[0][d]("mousewheel",r.wheel,!1)):document[e]("onmousewheel",r.wheel),l[c]({mousedown:r.scrollbarMousedown})},hide:function(a){a=a===b?"slow":a,l.stop(!0,!0).removeClass("is-visible"),delete r.visible},show:function(){o||(r.canScroll||i.alwaysShow)&&(l.stop(!0,!0).addClass("is-visible"),r.visible=!0)},disable:function(){r.hide(),o=!0},enable:function(){o=!1},scrollCallbacks:[],timeout:null,scroll:function(a){if(!(o||n&&r.scrolling)){r.calculate(a);for(var b=0;b<r.scrollCallbacks.length;b++)r.scrollCallbacks[b](a);n&&(r.scrolling=!0,setTimeout(function(){delete r.scrolling},100))}},wheel:c.throttle(function(a){if(r.visible&&!o&&(!n||!r.out)){a=a||window.event;var b=0;if(a.wheelDelta&&(b=-a.wheelDelta/120),a.deltaY&&(b=a.deltaY/40),a.detail&&(b=a.detail/3),setTimeout(function(){k.scrollTop(k.scrollTop()+40*b),r.scroll()},0),!i.scrollThrough||!r.atTop&&!r.atBottom)return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}},q),calculate:function(){r.addClasses();var a=i.fixedScrollBarHeight||Math.max(1/(r._hiddenHeight+100)*100*r._viewportHeight,10),b=r.canScroll||!1;return(r.canScroll||i.alwaysShow)&&l.css({top:r.atBottom?"auto":r._scrollTop/r._hiddenHeight*(r._viewportHeight-a-2*g)+g,bottom:r.atBottom?0:"auto",height:a}),b&&!r.canScroll&&r.hide("fast"),k.parent().scrollLeft(0),a},addClasses:function(){r.calculateProperties(),j.toggleClass("yj-scroller-can-scroll",r.canScroll).toggleClass("yj-scroller-at-bottom",r.atBottom).toggleClass("yj-scroller-at-top",r.atTop)},calculateProperties:function(){r._elemHeight=e.height(),r._viewportHeight=j.height(),r._scrollTop=k.scrollTop(),r._hiddenHeight=Math.max(r._elemHeight-r._viewportHeight,1),r.canScroll=r._hiddenHeight>1+(i.minScroll||0),r.atTop=r._scrollTop<=0,r.atBottom=r._scrollTop>=r._hiddenHeight},uncalculate:function(a){var b=Math.max(e.height()-j.height(),1),c=Math.max(1/(b+100)*100*j.height(),10),d=b*((a-g-c/2)/(j.height()-c-2*g));k.scrollTop(d),r.calculate()},mouseover:function(){r.out=!1,o||(r.timeout&&clearTimeout(r.timeout),r.calculate(),r.show())},mouseout:function(b){i.alwaysShow||(r.out=!0,r.dragBar||a(b.relatedTarget||b.target).parents().is(".yj-scroller-viewport")||(r.timeout=setTimeout(r.hide,100)))},mousedown:function(){a(document.body).bind("mouseup.yj-scroller",function(){j.scrollLeft(0),a(document.body).unbind(".yj-scroller")})},scrollToTop:function(){k.animate({scrollTop:0},"fast")},scrollToBottom:function(){k.scrollTop(m.height())},onScroll:function(a){r.scrollCallbacks.push(a)},scrollbarMousedown:function(b){r.dragBar=b.pageY,a(document.body).bind({"mouseleave.yj-scroller":r.scrollbarMouseup,"mouseup.yj-scroller":r.scrollbarMouseup,"mousemove.yj-scroller":r.barScroll,"selectstart.yj-scroller":function(a){a.preventDefault()}})},scrollbarMouseup:function(b){delete r.dragBar,a(document.body).unbind(".yj-scroller"),r.mouseout(b)},barScroll:c.throttle(function(a){null!=r.dragBar&&r.uncalculate(a.pageY-j.offset().top)},q)};return r.setup(),r}}(b),e}),define("feeds/lib/ui/groups/group_navigation_height_helper",[],function(){"use strict";function a(a,b,c){var d=e(a,b,c)-h;return Math.floor(d/i)}function b(a){var b=a-h-k-j;return Math.max(f(b),m)}function c(a,b,c){var e=d(a,b,c)-h;return Math.max(f(e),m)}function d(a,b,c){var d=a;if(c>0){var e=Math.min(c,l);d-=i*e,d-=h+k}return d}function e(a,b,c){var e=a,f=b*i+h;return e-=Math.min(f,d(a,b,c)),e-=k}function f(a){return a>0?Math.floor(a/i):0}function g(a){return a>=h+i*m}var h=32,i=28,j=86,k=8,l=3,m=6;return{getMaxExternalGroupsToShow:a,getMaxInternalGroupsToShowWithBanner:b,getMaxInternalGroupsToShowWithExternalGroups:c,isLargeEnoughToShowMinimunNumberOfRows:g}}),define("common-ui/lib/ui/general/fixed_sidebar_decorator",["require","jquery","underscore","core/lib/backbone_base_view","backbone","common-ui/lib/helper/environment","common-ui/lib/ui/shared/scroller","core/lib/treatment","feeds/lib/ui/groups/group_navigation_height_helper"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("backbone"),f=a("common-ui/lib/helper/environment"),g=a("common-ui/lib/ui/shared/scroller"),h=a("core/lib/treatment"),i=a("feeds/lib/ui/groups/group_navigation_height_helper"),j=d.extend({el:".yj-nav-home-menu",initialize:function(a){this.$el.addClass("yj-nav-fixed"),this.$masthead=b("#header-container"),this.$accountSection=this.$(".yj-nav-menu--docked-content"),this.$groupActionsSection=this.$(".yj-nav-menu--group-action-area"),this.$navFixedHeader=this.$(".yj-nav-menu--fixed-header"),this.$navFixedContent=this.$(".yj-nav-menu--fixed-content"),this.$navScrollContent=this.$(".yj-nav-scroll-content"),this._globalNav=a.globalNav,c.bindAll(this,"recalculateDimensions"),this.startFixedSidebar(),this.setupSuiteNavMastheadListeners(),b(window).on("resize.stickyNav",c.debounce(this.recalculateDimensions,100)),this._layoutGlobalNav()},startFixedSidebar:function(){this.setupMockScroll(),this.triggerMockScrollDomChange()},setupSuiteNavMastheadListeners:function(){var a=this;e.on("/ui/masthead/load/finish",function(){c.defer(function(){a.recalculateDimensions()})}),e.on("/ui/masthead/fallback",function(){a.$navFixedContent.get(0).style.top="",a.recalculateDimensions()})},_layoutGlobalNav:function(){if(this._globalNav){var a=this._getMockScrollHeight(),b=!this._actionsShouldBeOutsideScroll();this._globalNav.reLayout(a,b)}},_getMockScrollHeight:function(){var a=this._getGroupNavigationAndActionsHeight();if(this._actionsShouldBeOutsideScroll()){var b=this.$groupActionsSection.outerHeight(!0);a-=b}return a},_actionsShouldBeOutsideScroll:function(){var a=!1,b=this.$groupActionsSection.outerHeight(!0),c=this._getGroupNavigationAndActionsHeight()-b;return a=i.isLargeEnoughToShowMinimunNumberOfRows(c)},_getGroupNavigationAndActionsHeight:function(){var a=this.$accountSection.outerHeight(!0),c=this.$navFixedHeader.outerHeight(!0),d=b(window).height()-this._getMastheadHeight()-a-c;return d},_getMastheadHeight:function(){return this.$masthead.hasClass("is-docked-suite-nav")?0:this.$masthead.height()},setupMockScroll:function(){var a=this._getMockScrollHeight(),b=this.$navFixedContent.width();this.updateNavPosition();var c={scrollThrough:!1,minScroll:10,viewportClass:"yj-nav-menu--scroller-viewport",throttle:h.treatment("left_nav_scroll_throttle")?50:0};this.mockScroll=g(this.$navScrollContent,a,0,b,c)},triggerMockScrollDomChange:function(){this.$navScrollContent&&this.$navScrollContent.trigger("domchange")},recalculateDimensions:function(){this.updateMockScrollDimensions(),this.setMinHeight(),this.updateNavPosition(),this.triggerMockScrollDomChange(),this._layoutGlobalNav()},updateNavPosition:function(){this.$navFixedContent.css({top:this._getMastheadHeight()})},updateMockScrollDimensions:function(){this.mockScroll&&(this.mockScroll.updateHeight(this._getMockScrollHeight()),this.mockScroll.updateWidth(this.$navFixedContent.width()))},setMinHeight:function(){this.$el.css("min-height",b(window).height())},remove:function(){return this.mockScroll&&this.mockScroll.unsetup(),b(window).off(".stickyNav"),d.prototype.remove.call(this)}},{checkForNonStickyDevices:function(){b("body").toggleClass("non-sticky",f.isIOS())}});return j.checkForNonStickyDevices(),j}),define("workfeed/lib/modules/character_counter",["require","jquery"],function(a){var b=a("jquery");return{init:function(a){if(a=a||{},a.textarea&&a.count&&a.max&&(this._$textarea=a.textarea,a.textarea instanceof b||(this._$textarea=b(a.textarea)),0!==this._$textarea.length)){this._negCls=a.negClass||"neg",this._$count=b(a.count),this._max=a.max,this._buildCountString=a.buildCountString||function(a){return a.toString()};var c=b(a.topLevel);this._$topLevel=c.length>0?c:this._$count.parent(),this._bind()}},_bind:function(){this._$textarea.keyup(this._keyup.bind(this)),this._updateCount(this._$textarea.val().length)},_keyup:function(a){var c=b(a.target).val().length;this._updateCount(c)},_updateCount:function(a){var b=this._$topLevel;this._max-a<this._max?b.removeClass("yj-hide"):b.addClass("yj-hide");var c=this._max-a;this._$count.html(this._buildCountString(c)),0>c?this._$count.addClass(this._negCls):this._$count.removeClass(this._negCls)}}}),define("workfeed/lib/modules/file_uploader",["require","jquery","underscore","core/lib/log","core/lib/util/authenticity_token","backbone","core/lib/session","core/lib/tr","core/lib/yammer_api","core/lib/yammer_uri","core/lib/yammer_config","core/lib/report","mustache"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/log"),e=a("core/lib/util/authenticity_token"),f=a("backbone"),g=a("core/lib/session"),h=a("core/lib/tr"),i=a("core/lib/yammer_api"),j=a("core/lib/yammer_uri"),k=a("core/lib/yammer_config"),l=a("core/lib/report"),m=a("mustache"),n=/\.(gif|jpe?g|png|tiff)$/i;return function(){var a=function(a){if(a.container instanceof b||(a.container=b(a.container)),a.file instanceof b||(a.file=b(a.file)),a.thumbnail instanceof b||(a.thumbnail=b(a.thumbnail)),a.hiddenMugshotIdField instanceof b||(a.hiddenMugshotIdField=b(a.hiddenMugshotIdField)),a.saveButtonToDisable instanceof b||(a.saveButtonToDisable=b(a.saveButtonToDisable)),this._container=a.container,this._file=a.file,this._thumbnail=a.thumbnail,this._dimensions=a.dimensions||"large",this._updateViaApiMethod=a.updateViaApiMethod,this._additionalApiParams=a.apiParams,this._hidePreviewOverlay=a.hidePreviewOverlay||!1,this._generateMugshotColor=a.generateMugshotColor||!1,this._hoverButtonOnThumbnail=a.hoverButtonOnThumbnail||!1,this._allowUpscale=void 0===a.allowUpscale?!0:a.allowUpscale,a.oauthToken)this._oauthToken=a.oauthToken;else{var c=this;yam.ready(function(){c._oauthToken=g.getCurrentUser().web_oauth_access_token})}a.hiddenMugshotIdField&&(this._hiddenMugshotIdField=a.hiddenMugshotIdField),a.onMugshotUploaded&&"function"==typeof a.onMugshotUploaded&&(this._onMugshotUploaded=a.onMugshotUploaded),a.saveButtonToDisable&&(this._saveButtonToDisable=a.saveButtonToDisable),this.init()},o=h.t("an_unknown_error_occurred_your_image_may_have_been_too");return a.prototype={_createIframe:function(){var a="file-uploader-iframe-"+c.uniqueId("yamjs");this.$iframe=b(m.render(this.iframeTemplate,{id:a})).appendTo(document.body),this.$iframe.load(this._parseMugshotResponse.bind(this))},_createForm:function(){this.$form=b(m.render(this.formTemplate,{oauthToken:this._oauthToken,csrfToken:e.get(),includeColorFlag:this._generateMugshotColor})),this.$form.attr("action",k.config().mugshotHost+"/images/"),this.$form.appendTo(document.body)},_submit:function(){var a=this._file.val();if(a){if(!a.match(n))return f.trigger("/ui/alert/show","error",h.t("invalid_file_type_please_upload_an_image_that_is_in")),void this._file.val(null);this.removeThumbnailHoverButton(),this._$previewOverlay&&this._$previewOverlay.css("display","none"),this.loading();var c=b("<div></div>");c.insertAfter(this._file),this._createIframe(),this._createForm();var d=document.activeElement==this._file[0];this._file.appendTo(this.$form),this.$form.get(0).target=this.$iframe.attr("id"),this.$form.submit(),this._file.insertBefore(c),c.remove(),d&&this._file.focus()}},_parseMugshotResponse:function(){var a,c,e=this,g=this._parse();g&&g.image_id?(a=j.mugshot("images",this._getDimensionsPixels(),g.image_id),this._allowUpscale||(a+="?allow_upscale=false"),this._updateViaApiMethod?(c={mugshot_id:g.image_id},g.image_color&&(c.mugshot_color=g.image_color,g.image_color.match(/^#[0-9a-f]{6}$/i)||l.event("mugshot_color_error",{source:"file_uploader API method",color:g.image_color})),this._additionalApiParams&&b.extend(c,this._additionalApiParams),i[this._updateViaApiMethod]&&"function"==typeof i[this._updateViaApiMethod]?i[this._updateViaApiMethod](c).then(function(){e._swap(a),e._hoverButtonOnThumbnail&&e.removeThumbnailHoverButton(),e._onMugshotUploaded&&e._onMugshotUploaded(g.image_id,a,g.image_color),e._cleanupFileOverlay()},function(){f.trigger("/ui/alert/show","error",o),e.addThumbnailHoverButton()}):d.log('FileUploader -- Could not find yammerApi method "'+this._updateViaApiMethod+'".')):(this._swap(a),this._hiddenMugshotIdField?this._hiddenMugshotIdField.val(g.image_id):d.log("FileUploader - Manual form submission required, but no hiddenMugshotIdField defined."),this._onMugshotUploaded&&this._onMugshotUploaded(g.image_id,a,g.image_color))):(f.trigger("/ui/alert/show","error",o),this.loading(),e.addThumbnailHoverButton()),this._cleanup()},_cleanup:function(){this.$form.remove(),this.$iframe.remove(),this.removeThumbnailHoverButton()},_cleanupFileOverlay:function(){this._file.remove()},_parse:function(){var a,b=this.$iframe.get(0),c=b.contentDocument?b.contentDocument:window.frames[b.id].document;if(c.body&&(a=c.body.innerHTML,c.body.firstChild&&"PRE"==c.body.firstChild.nodeName.toUpperCase()&&(c.body.normalize(),a=c.body.firstChild.firstChild.nodeValue)),a)try{a=JSON.parse(a)}catch(a){}else a={};return a},_parseResponse:function(a){return a&&a.mugshot_url},_swap:function(a){var b=this;if(!this._thumbnail)return void d.log("FileUploader - no thumbnail img field defined.");this._thumbnail.find("img").attr("src",a);var c=this._thumbnail.find(".mugshot-no-photo-container");c.length&&(c.hide(),this._thumbnail.find("img").show()),setTimeout(function(){b._$previewOverlay&&b._$previewOverlay.css("display","block"),b.loading()},2e3)},_getDimensionsPixels:function(){switch(this._dimensions){case"client_application_small_icon":return"16x16";case"small":return"48x48";case"medium":case"client_application_large_icon":return"72x72";case"nue_big_profile":return"128x128";case"group_thumbnail":return"81x81";case"group_settings":return"104x104";case"client_application_screenshot":return"547x347";case"client_application_banner_image":return"690x275";case"network_masthead":return"1200x56";case"network_masthead_preview":return"769x35";case"network_logo":return"x100";case"network_masthead_logo":return"160x100";default:return"96x96"}},loading:function(){var a=this._thumbnail,b="wf-loading-c-mugshot",c=a.find("img");a.toggleClass(b),a.hasClass(b)?(c.css("visibility","hidden"),this.disableButton()):(c.css("visibility","visible"),this.enableButton())},disableButton:function(){this._saveButtonToDisable&&(this._saveButtonToDisable.hasClass("yj-btn-disabled")||(this._saveButtonToDisable.addClass("yj-btn-disabled"),this._saveButtonToDisable.attr("disabled",!0),this._disabledButtonByMugshot=!0))},enableButton:function(){this._saveButtonToDisable&&this._disabledButtonByMugshot&&(this._saveButtonToDisable.removeClass("yj-btn-disabled"),this._saveButtonToDisable.attr("disabled",!1),this._disabledButtonByMugshot=!1)},addThumbnailHoverButton:function(){if(this._hoverButtonOnThumbnail&&this._thumbnail){var a=this._thumbnail.find(".yj-mugshot-hover-div");a&&a.remove(),this._hoverButton||(this._hoverButton=b('<div class="yj-mugshot-hover-div" data-qaid="upload_mugshot_button"><span class="yj-mugshot-hover-btn">'+h.t("add_image")+"</span></div>"),this._thumbnail.append(this._hoverButton))}},removeThumbnailHoverButton:function(){this._hoverButton&&(this._container.unbind("mouseenter mouseleave"),this._hoverButton.remove())},addPreviewOverlay:function(){this._updateViaApiMethod||(this._$previewOverlay=b('<span class="yj-mugshot-preview">'+h.t("unsaved")+"</span>"),this._thumbnail.append(this._$previewOverlay))},init:function(){this._file.change(this._submit.bind(this)),this.addThumbnailHoverButton(),this._hidePreviewOverlay||this.addPreviewOverlay()},formTemplate:'<form method="post" enctype="multipart/form-data"><input name="include_color" type="hidden" value="{{includeColorFlag}}" /><input name="oauth_token" type="hidden" value="{{oauthToken}}" /><input name="csrf_token" type="hidden" value="{{csrfToken}}" /></form>',iframeTemplate:'<iframe src="javascript:false;" name="{{id}}" id="{{id}}" style="width:0;height:0;"></iframe>'},a}()}),define("workfeed/lib/modules/observe_field",["require","jquery","common-ui/lib/ui/accessibility/screenreader_announcer"],function(a){var b=a("jquery"),c=a("common-ui/lib/ui/accessibility/screenreader_announcer"),d="wf-loading",e={frequency:700,_timer:null,_bind:function(){this._field.bind("keyup.observeField",this._startTimer.bind(this)),this._field.bind("change.observeField",this._startTimer.bind(this))},_unbind:function(){this._field.unbind("keyup.observeField"),this._field.unbind("change.observeField")},_request:function(){this.validateFunction&&(this._spinner(1),this.validateFunction(this._field.val()).then(this._handleSuccess.bind(this),this._handleFailure.bind(this)))},_handleSuccess:function(a){this._spinner(0),b(this.update).html('<span class="yj-valid">'+a+"</span>"),this._field.attr("aria-invalid",!1),c.announceText(a),this._validate()},_handleFailure:function(a){this._spinner(0),b(this.update).html('<span class="yj-invalid">'+a+"</span>"),this._field.attr("aria-invalid",!0),c.announceText(a),this._validate()},_startTimer:function(){var a=this._val,b=this._val=this._field.val();if(b!==a){"undefined"!=typeof this._timer&&this._resetTimer();var c=this;this._timer=window.setTimeout(function(){c._request()},this.frequency),this._spinner(1),this._validate()}},_resetTimer:function(){window.clearTimeout(this._timer),this._spinner(0)},_spinner:function(a){var c=this.update;this.spinner&&(b(this.update).html(""),c[a?"addClass":"removeClass"](d))},_validate:function(){if(this.validate&&this.submit){var a=this.submit,c=this.update,d=c;a.closest("form").length>0&&(d=a.closest("form")),d.find(".yj-valid").length&&!d.find(".yj-invalid").length?(a.removeClass("yj-btn-disabled"),"disabled"in a[0]&&(a[0].disabled=!1),b(".field-status").val("valid")):(a.addClass("yj-btn-disabled"),"disabled"in a[0]&&(a[0].disabled=!0),b(".field-status").val("invalid"))}this.onAjaxComplete&&this.onAjaxComplete.call()},destroy:function(){this._unbind()}};return function(a,c){a instanceof b||(a=b(a)),this.update instanceof b||(this.update=b(this.update)),this.submit instanceof b||(this.submit=b(this.submit)),b.extend(this,e,c),this._field=a,this._bind()}}),define("common-ui/lib/helper/name_validator",["require","jquery","core/lib/tr","core/lib/yammer_api"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/tr"),d=a("core/lib/yammer_api");return{validateGroupName:function(a){return a?d.validateGroupName({name:a}).then(function(){
return c.t("name_is_available")},this._onValidateGroupNameError.bind(this)):b.Deferred().reject(c.t("name_is_required"))},_onValidateGroupNameError:function(a){var b=a.responseJSON;switch(b&&b.response.error_code){case"blank_name":return c.t("name_is_required");case"name_taken_in_network":case"permalink_taken_in_network":return c.t("name_is_in_use");case"numerical_permalink":return c.t("name_must_contain_at_least_one_letter");default:return c.t("that_name_is_not_allowed")}},validateExternalNetworkName:function(a){return a?d.validateExternalNetworkName({name:a}).then(function(){return c.t("name_is_available")},this._onValidateExternalNetworkNameError.bind(this)):b.Deferred().reject(c.t("name_is_required"))},_onValidateExternalNetworkNameError:function(a){var b=a.responseJSON;switch(b&&b.response.error_code){case"blank_name":return c.t("name_is_required");case"name_taken":return c.t("name_has_already_been_taken");case"invalid_character_name":return c.t("name_can_contain_letters_and_numbers_only");default:return c.t("that_name_is_not_allowed")}}}}),define("stache!common-ui/lib/ui/groups/create_en_form",["mustache"],function(a){var b='  <div class="edit">\n    <div class=\'yj-mugshot-form-container\'>\n      <label for="image" class="yj-mugshot-label">{{networkImageLabel}}</label>\n      <div class="mugshot-container yj-mugshot-thumb-left">\n        <img src="{{networkImage}}" class="default-photo" alt="{{networkImageLabel}}">\n      </div>\n      <input class="file-input yj-mugshot-form-file-margin" id="image" name="image" type="file">\n    </div>\n  <form accept-charset="UTF-8" action="{{networkFormPath}}" method="post" enctype="multipart/form-data" id="new_network" class="new_network">\n    <input name="utf8" type="hidden" value="✓">\n    <input name="authenticity_token" type="hidden" value="{{csrf}}">\n    <input id="group_id" name="group_id" type="hidden"></input>\n    <input id="network_mugshot_id" name="network[mugshot_id]" class="hidden_mugshot_id" type="hidden">\n    <table role="presentation" cellspacing="0" cellpadding="0" >\n      <tr>\n        <th role="presentation" class="gc-col-one gc-td-override"><label for="new_network_name" class="label">{{networkNameLabel}}</label></th>\n        <td class="gc-col-two gc-td-override">\n          <input aria-required="true" class="wider" id="new_network_name" name="network[name]" maxLength="150" type="text">\n          <input type="hidden" class="field-status" value="invalid">\n        </td>\n        <td  id="network_name_status" class="gc-col-three gc-td-override response">\n        </td>\n      </tr>\n      <tr>\n        <th role="presentation" class="gc-overridefix"><label for="network_description_entry" class="label">{{networkDescriptionLabel}}</label></th>\n        <td colspan="2" class=" gc-dtwocols gc-overridefix" >\n          <textarea class="wider" id="network_description_entry" name="network[description]"></textarea>\n          <span id="network-count" class="char-count">{{{remainingCharacterCount}}}</span>\n          <ul class="help" style="display:none;">\n            <li>{{networkDescriptionExplanation}}</li>\n            <li>{{maxCharactersInfo}}</li>\n          </ul>\n        </td>\n      </tr>\n    </table>\n    <div class="faux-hr">&nbsp;</div>\n    <p><strong>{{permissionsLabel}}</strong></p>\n    <ul class="radiolist">\n      <li>\n        <input class="toggle-enabled radiolist--input" id="network_anyone_can_invite_true" name="network[anyone_can_invite]" type="radio" value="true" {{#isOpen}}checked="checked"{{/isOpen}}>\n        <img src="{{unlockedImage}}" class="radiolist--icon" alt="">\n        <label for="network_anyone_can_invite_true" class="radiolist--label"><strong>{{openInviteLabel}}</strong> - <small>{{openInviteInfo}}</small></label>\n      </li>\n      <li>\n        <input class="toggle-enabled radiolist--input" id="network_anyone_can_invite_false" name="network[anyone_can_invite]" type="radio" value="false" {{^isOpen}}checked="checked"{{/isOpen}}>\n        <img src="{{lockedImage}}" class="radiolist--icon" alt="">\n        <label for="network_anyone_can_invite_false" class="radiolist--label"><strong>{{closedInviteLabel}}</strong> - <small>{{closedInviteInfo}}</small></label>\n      </li>\n      <li>\n        <input class="radiolist--input invite-checkbox" id="inherit_parent_domains" name="inherit_parent_domains"  type="checkbox" value="true">\n        <label class="radiolist--label" for="inherit_parent_domains">{{allowNetworkMembersInfo}}</label>\n      </li>\n    </ul>\n    <div class="form-buttons">\n      <button id="submit_new_network_form" class="yj-btn" type="submit"><span>{{createNetworkButtonLabel}}</span></button>\n    </div>\n  </form>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/groups/create_en_form",[],function(){}),define("common-ui/lib/ui/groups/create_en_form",["require","core/lib/util/authenticity_token","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","workfeed/lib/modules/character_counter","workfeed/lib/modules/file_uploader","workfeed/lib/modules/observe_field","common-ui/lib/helper/name_validator","core/lib/session","core/lib/tr","core/lib/urls","core/lib/yammer_uri","html!./create_en_form","css!./create_en_form"],function(a){"use strict";var b=a("core/lib/util/authenticity_token"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("workfeed/lib/modules/character_counter"),f=a("workfeed/lib/modules/file_uploader"),g=a("workfeed/lib/modules/observe_field"),h=a("common-ui/lib/helper/name_validator"),i=a("core/lib/session"),j=a("core/lib/tr"),k=a("core/lib/urls"),l=a("core/lib/yammer_uri"),m=a("html!./create_en_form");return a("css!./create_en_form"),d.extend({mixins:[c],className:"community-lightbox yj-lightbox-content",id:"community-lightbox-container",template:m,events:{"submit #new_network":"_handleENOnSubmit"},defaults:{isOpen:!0,descriptionMaxCharsLength:150},getTemplateData:function(){return{unlockedImage:l.cdn("assets/images/icon-unlocked-green.png"),lockedImage:l.cdn("assets/images/icon-locked-red.png"),csrf:b.get(),permissionsLabel:j.t("create_en_permissions_label"),networkImageLabel:j.t("create_en_network_image_label"),networkImage:"/mugshot/images/48x48/network_avatar.png",networkFormPath:k.networks(),networkNameLabel:j.t("create_en_network_name_label"),networkDescriptionLabel:j.t("create_en_network_desc_label"),networkDescriptioninfo:j.t("create_en_network_description_info"),remainingCharacterCount:this._buildDescriptionCountText(this.options.descriptionMaxCharsLength),maxCharactersInfo:j.t("max_character_info"),isOpen:this.options.isOpen,openInviteLabel:j.t("create_en_open_invite_label"),closedInviteLabel:j.t("create_en_closed_invite_label"),openInviteInfo:j.t("create_en_open_invite_info"),closedInviteInfo:j.t("create_en_closed_invite_info"),allowNetworkMembersInfo:j.t("create_en_allow_network_members_info",{networkName:i.getCurrentNetwork().name}),createNetworkButtonLabel:j.t("create_en_create_network")}},render:function(){return this._initFieldNameValidation(),this._initFormSubmissionValidation(),this._initNetworkDescCounter(),this._initPhotoUploader(),this},_buildDescriptionCountText:function(a){return j.t("remaining_character_count",{span:'<span class="count">{$0}</span>',count:a})},_initFieldNameValidation:function(){var a=this.$("#new_network_name"),b=this.$("#network_name_status"),c=this.$("#submit_new_network_form");this.validateNetworkName=new g(a,{validateFunction:function(a){return h.validateExternalNetworkName(a)},update:b,submit:c,spinner:!0,validate:!0})},_initFormSubmissionValidation:function(){var a=this.$("#new_network");this._disableCreateNetworkButton(),a.on("submit",this._handleENOnSubmit.bind(this))},_initNetworkDescCounter:function(){var a=this.$(".char-count");e.init({textarea:this.$("#network_description_entry"),max:this.options.descriptionMaxCharsLength,count:a,buildCountString:this._buildDescriptionCountText,topLevel:a,negClass:"yj-invalid"})},_initPhotoUploader:function(){this.networkLightboxPhotoUploader=new f({container:this.$(".yj-mugshot-form-container"),file:this.$(".yj-mugshot-form-container .file-input"),thumbnail:this.$(".yj-mugshot-form-container .mugshot-container"),dimensions:"small",autoUpdateUserMugshot:!1,hiddenMugshotIdField:this.$(".new_network .hidden_mugshot_id"),saveButtonToDisable:this.$("#submit_new_network_form")})},_handleENOnSubmit:function(){this._disableCreateNetworkButton()},_disableCreateNetworkButton:function(){var a=this.$("#submit_new_network_form");a.addClass("yj-btn-disabled"),a.attr("disabled","disabled")}})}),define("stache!common-ui/lib/ui/groups/group_privacy_controls",["mustache"],function(a){var b='{{#showWhoCanViewContent}}\n<fieldset class="settings public-private-toggle">\n  <legend>{{translations.whoCanViewContent}}</legend>\n  <div class="dl">\n    <label>\n      <div class="dt">\n        <input class="radio toggle-enabled" id="group_private_false" name="group[private]"\n          type="radio" value="0" {{^isPrivate}}checked{{/isPrivate}}>\n      </div>\n      <div class="dd">\n        <span class="label">\n          <strong>{{translations.publicContent}}</strong>\n          <span>{{translations.anyoneInThisNetworkContent}}</span>\n        </span>\n      </div>\n    </label>\n\n    <label>\n      <div class="dt">\n        <input class="radio toggle-enabled" id="group_private_true" name="group[private]"\n          type="radio" value="1" {{#isPrivate}}checked{{/isPrivate}}>\n      </div>\n      <div class="dd">\n        <span class="label">\n          <strong>{{translations.privateContent}}</strong>\n          <span>{{translations.onlyApprovedMembers}}</span>\n        </span>\n      </div>\n    </label>\n\n    <div id="list-in-directory-wrap" class="{{^isPrivate}}yj-hide{{/isPrivate}}">\n      <label>\n        <div class="dt indent">\n          <input type="checkbox" class="checkbox" id="group_show_in_directory" {{#showInDirectory}}checked{{/showInDirectory}}>\n        </div>\n        <div class="dd last">\n          <span class="plain">{{translations.listInGroupDirectory}}</span>\n        </div>\n      </label>\n    </div>\n    {{#showInDirectory}}<input type="hidden" name="group[show_in_directory]" value="1">{{/showInDirectory}}\n    {{^showInDirectory}}<input type="hidden" name="group[show_in_directory]" value="0">{{/showInDirectory}}\n  </div>\n</fieldset>\n{{/showWhoCanViewContent}}\n{{#extendedOptions}}\n<fieldset class="settings add-members">\n  <legend>{{translations.whoCanJoinThisGroup}}</legend>\n  <div class="dl">\n    <label>\n      <div class="dt">\n        <input class="radio toggle-enabled" id="group_moderated_false" name="group[moderated]" type="radio"\n          value="false" {{^isModerated}}checked{{/isModerated}}>\n      </div>\n      <div class="dd">\n        <span id="group_add_members_label" class="normal label">\n          {{translations.groupAddMembers}}\n        </span>\n      </div>\n    </label>\n    <label>\n      <div class="dt">\n        <input class="radio toggle-enabled" id="group_moderated_true" name="group[moderated]" type="radio"\n          value="true" {{#isModerated}}checked{{/isModerated}}>\n      </div>\n      <div class="dd last">\n        <span class="normal">\n          {{translations.onlyThoseApprovedByAdmin}}\n        </span>\n      </div>\n    </label>\n  </div>\n</fieldset>\n{{/extendedOptions}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/groups/group_privacy_controls",["require","underscore","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/tr","html!common-ui/lib/ui/groups/group_privacy_controls"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("core/lib/tr"),f=a("html!common-ui/lib/ui/groups/group_privacy_controls"),g=e.t("anyone_approved_by_a_group_member"),h=e.t("anyone_in_this_network_setting_describing_who_can_add_members");return d.extend({id:"GroupPrivacyControls",className:"yj-group-privacy-controls",template:f,mixins:[c],defaults:{isPrivate:!1,isPublic:!0,isModerated:!1,showInDirectory:!0,extendedOptions:!0,showWhoCanViewContent:!0},events:{"click #group_private_false":"_clickPublicRadio","click #group_private_true":"_clickPrivateRadio","click #group_show_in_directory":"_toggleIsShownInDirectory"},getTemplateData:function(){return b.extend({},this.options,{translations:{groupAddMembers:this._getAddMembersLabel(),whoCanViewContent:e.t("who_can_view_content"),publicContent:e.t("public"),anyoneInThisNetworkContent:e.t("anyone_in_this_network"),privateContent:e.t("private"),onlyApprovedMembers:e.t("only_approved_members"),listInGroupDirectory:e.t("list_in_group_directory"),whoCanJoinThisGroup:e.t("who_can_join_this_group"),onlyThoseApprovedByAdmin:e.t("only_those_approved_by_an_admin")}})},isShownInDirectory:function(){return this.$("#group_show_in_directory").is(":checked")},isGroupModerated:function(){return this.$("#group_moderated_true").is(":checked")},isPrivate:function(){return this.options.isPrivate},isShowingWhoCanViewContent:function(){return this.options.showWhoCanViewContent},_getAddMembersLabel:function(){return this.options.isPrivate?g:h},_clickPublicRadio:function(){this.options.isPrivate=!1,this._showPublicRadioOptions(),this._triggerComponentResized()},_clickPrivateRadio:function(){this.options.isPrivate=!0,this._showPrivateRadioOptions(),this._triggerComponentResized()},_showPublicRadioOptions:function(){this.$("#list-in-directory-wrap").addClass("yj-hide"),this._setAddMembersLabelText(h)},_showPrivateRadioOptions:function(){this.$("#list-in-directory-wrap").removeClass("yj-hide"),this._setAddMembersLabelText(g)},_setAddMembersLabelText:function(a){this.$("#group_add_members_label").text(a)},_triggerComponentResized:function(){this.trigger("componentResized")},_toggleIsShownInDirectory:function(){var a=this.$("input[name=group\\[show_in_directory\\]]");this.options.showInDirectory=this.$("#group_show_in_directory").is(":checked"),this.options.showInDirectory?a.val(1):a.val(0)}})}),define("stache!common-ui/lib/ui/shared/tag_list",["mustache"],function(a){var b="{{{items}}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/shared/tag_list",[],function(){}),define("common-ui/lib/ui/shared/tag_list",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/string_helper","core/lib/tr","mustache","components/network_label/index","models/user","common-ui/lib/ui/shared/type_ahead","common-ui/lib/ui/accessibility/screenreader_announcer","core/lib/session","html!./tag_list","css!./tag_list"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("backbone"),g=a("core/lib/string_helper"),h=a("core/lib/tr"),i=a("mustache"),j=a("components/network_label/index"),k=a("models/user"),l=a("common-ui/lib/ui/shared/type_ahead"),m=a("common-ui/lib/ui/accessibility/screenreader_announcer"),n=a("core/lib/session"),o=a("html!./tag_list");return a("css!./tag_list"),d.extend({mixins:[e],tagName:"ol",template:o,className:"yj-tag-list",defaults:{truncateNameLength:27,itemTemplate:"linkTemplate",linkTemplate:'{{#items}}<li class="yj-tag {{tagClassName}}" data-tag-id="{{id}}"><a title="{{{truncTitle}}}" href="{{web_url}}">{{#iconClassName}}<span class="yj-tag--icon yamicon yamicon-{{iconClassName}} yj-tag-{{iconClassName}} yj-inline-icon yj-blue"></span>{{/iconClassName}}<span class="yj-acc-hidden">{{labelText}}: </span><span class="yj-tag-name">{{{truncName}}}</span></a><a class="yj-tag-remove yamicon yamicon-{{xIconClassName}}" href="javascript://" role="button" data-speechtip="{{removeLabelTextShort}}"><span class="yj-acc-hidden">{{removeLabelText}}: {{truncName}}</span></a></li>{{/items}}',spanTemplate:'{{#items}}<li class="yj-tag {{tagClassName}}" data-tag-id="{{id}}">{{#iconClassName}}<span class="yj-tag--icon yamicon yamicon-{{iconClassName}} yj-tag-{{iconClassName}} yj-inline-icon yj-blue"></span>{{/iconClassName}}<span class="yj-acc-hidden">{{labelText}}: </span><span class="yj-tag-name" title="{{{truncTitle}}}">{{{truncName}}}</span><a class="yj-tag-remove yamicon yamicon-{{xIconClassName}}" href="javascript://" role="button" data-speechtip="{{removeLabelTextShort}}"><span class="yj-acc-hidden">{{removeLabelText}}: {{truncName}}</span></a></li>{{/items}}',userTemplate:'{{#items}}<li class="{{yj_tag}} {{tagClassName}}" data-tag-id="{{id}}">{{#iconClassName}}<span class="yamicon yamicon-{{iconClassName}} yj-tag-{{iconClassName}} yj-inline-icon yj-blue {{iconPrivateClass}}"></span>{{/iconClassName}}<span class="yj-acc-hidden">{{labelText}}: </span><span class="{{yj_tag_name}}" title="{{truncTitle}}">{{{truncName}}}</span><a class="yj-tag-remove yamicon yamicon-{{xIconClassName}}" href="javascript://" role="button" data-speechtip="{{removeLabelTextShort}}"><span class="yj-acc-hidden">{{removeLabelText}}: {{truncName}}</span></a></li>{{/items}}'},tagsByType:{topic:"",user:"",domain:"",group:"",invalid:"invalid-tag"},iconsByType:{topic:"tag",user:"user",domain:"user",group:"group",invalid:"danger"},rd_iconsByType:{topic:"rd_tag",user:"user",domain:"user",group:"rd_groups",invalid:"danger"},labelByType:{topic:h.t("topic"),user:h.t("user"),domain:h.t("domain"),group:h.t("group"),invalid:""},removeLabelByType:{topic:h.t("remove_topic"),user:h.t("remove_user"),domain:h.t("remove_domain"),group:h.t("remove_group"),invalid:h.t("remove")},events:{click:"_handleClick"},initialize:function(a){a=c.extend({},this.defaults,a),this.id=a.id,this.truncateNameLength=a.truncateNameLength,this.removeHandler=a.removeHandler,this.itemTemplate=a.itemTemplate,this.linkTemplate=a.linkTemplate,this.spanTemplate=a.spanTemplate,this.userTemplate=a.userTemplate,this.settings=a.settings,this.tags=a.tags||[],this._initTagIndex()},getTemplateData:function(){return{items:this._renderTags(this.tags)}},_getRemovedMessageByType:function(a,b){var c;switch(a){case"topic":c=h.t("topic_name_removed",{name:b});break;case"user":c=h.t("user_name_removed",{name:b});break;case"domain":c=h.t("domain_name_removed",{name:b});break;case"group":c=h.t("group_name_removed",{name:b});break;case"invalid":c=h.t("item_name_removed",{name:b})}return c},_getAddedMessageByType:function(a,b){var c;switch(a){case"topic":c=h.t("topic_name_added",{name:b});break;case"user":c=h.t("user_name_added",{name:b});break;case"domain":c=h.t("domain_name_added",{name:b});break;case"group":c=h.t("group_name_added",{name:b});break;case"invalid":c=h.t("item_name_added",{name:b})}return c},_initTagIndex:function(){var a=[];this.tagIndex={};for(var b=0,d=this.tags.length;d>b;b++)void 0===this.tagIndex[this.tags[b].id]?this.tagIndex[this.tags[b].id]=b:a.push(b);c.each(a,function(a){this.tags.splice(a,1)},this)},_renderTags:function(a){this.truncateNameLength=17;var b,d,e,f=this.truncateNameLength,j=f?c.clone(a):a,k="userTemplate"===this.itemTemplate?"full_name":"name";for(d=0;d<j.length;d++)e=j[d],e.iconClassName=this.getIconClassName(e),e.tagClassName=this._getTagClassName(e),e.xIconClassName="x",e.iconPrivateClass=this.getIconPrivateClass(e),"user"===e.type||"domain"===e.type?(e.yj_tag_name="yj-tag-name-modern",e.yj_tag="yj-tag-modern"):(e.yj_tag_name="yj-tag-name",e.yj_tag="yj-tag"),b=c.isFunction(e.get)?e.get(k):e[k]||e.name,f?(e.truncName=g.truncate(b,f),e.truncTitle=g.truncate(b,500)):e.truncName=e.truncTitle=b,"user"===e.type&&(e.truncName=this._getUserNameWithNetworkName(e.truncName,e)),e.labelText=this.labelByType[e.type],e.removeLabelText=this.removeLabelByType[e.type],e.removeLabelTextShort=h.t("remove");return i.render(this[this.itemTemplate],{items:j})},_getUserNameWithNetworkName:function(a,b){var c=a,d=new k(b),e=new j({model:d});return c+e.render().$el.html()},_getTagClassName:function(a){var b=[this.tagsByType[a.type]];return this._isItemDeletable(a)||b.push("yj-no-delete"),b.join(" ")},_isItemDeletable:function(a){return a.network_id===n.getCurrentNetwork().id},getIconClassName:function(a){var b=this.rd_iconsByType[a.type];return"user"!==a.type&&"domain"!==a.type||(b=""),b},getIconPrivateClass:function(){return""},isEmpty:function(){return 0===this.tags.length},clear:function(){this.tags=[],this.tagIndex={},this.$el.empty()},diff:function(a){if(this.tags.length!==a.length)return!0;for(var b=0,c=a.length;c>b;b++){var d=a[b].id;if(void 0===this.tagIndex[d])return!0}return!1},getTagIds:function(){return c(this.tags).chain().filter(function(a){return"email"!=a.type&&a.type!=l.MODEL_DOMAIN}).map(function(a){return a.id}).value()},getTagIdsByType:function(){var a={};return c(this.tags).chain().filter(function(a){return"email"!=a.type&&a.type!=l.MODEL_DOMAIN}).each(function(b){var c=a[b.type]||(a[b.type]=[]);c.push(b.id)}),a},getTagById:function(a){return c.findWhere(this.tags,{id:a})},setTagProperties:function(a,b){var d=this.getTagById(a);return c.extend(d,b)},markTagsAsFailedByEmail:function(a){c.each(this.getTagIdsByEmails(a),function(a){this.markTagAsFailed(a)},this)},getTagIdsByEmails:function(a){return c.chain(this.tags).filter(function(b){return c.contains(a,b.email)}).pluck("id").value()},getTagAddresses:function(){return c(this.tags).chain().filter(function(a){return"email"==a.type||a.type==l.MODEL_DOMAIN}).map(function(a){return a.name}).value()},_handleClick:function(a){var c,d,e=b(a.target),g=this;if(e.hasClass("yj-tag-remove")){a.preventDefault(),c=e.closest("li"),c.addClass("yj-loading"),d=c.attr("data-tag-id");var h=function(a){g.removeTagIndex(d),c.removeClass("yj-loading"),void 0!==a?c.fadeOut(a,function(){c.remove()}):c.remove()};this.removeHandler&&"function"==typeof this.removeHandler?this.removeHandler(d,h):h("fast"),f.trigger("/ui/publisher/removedTag",d)}},addTagIndex:function(a){this.tagIndex[a.id]=this.tags.push(a)-1;var b="userTemplate"===this.itemTemplate?"full_name":"name",c=a[b]||a.name,d=this._getAddedMessageByType(a.type,c);d&&m.announceText(d,"assertive")},removeTagIndex:function(a){var b=this.tagIndex[a];if(null!=b){var c=this.tags[b],d="userTemplate"===this.itemTemplate?"full_name":"name",e=c[d]||c.name,f=this._getRemovedMessageByType(c.type,e);f&&m.announceText(f,"assertive"),this.tags.splice(b,1),this.tagIndex={};for(var g=0,h=this.tags.length;h>g;g++)this.tagIndex[this.tags[g].id]=g}},removeTagElement:function(a){var b=this.$el.find("[data-tag-id='"+a+"']");b.length>0&&b.remove(),f.trigger("/ui/publisher/removedTag",a)},markTagAsFailed:function(a){this.$el.find("[data-tag-id='"+a+"']").addClass("is-failed"),this.setTagProperties(a,{failed:!0})},hasNoFailedTags:function(){return!c.some(this.tags,function(a){return a.failed})},contains:function(a){return void 0!==this.tagIndex[a]},containsName:function(a){for(var b=0,c=this.tags.length;c>b;b++)if(this.tags[b].name===a)return!0;return!1},updateTags:function(a){this.clear(),this.tags=a,this._initTagIndex()},addTags:function(a){var b=[];c.isArray(a)||(a=[a]);for(var d=0,e=a.length;e>d;d++)void 0===this.tagIndex[a[d].id]&&(this.addTagIndex(a[d]),a[d].name=c.escape(a[d].name),b.push(a[d]),f.trigger("/ui/publisher/addedTag",a[d].id));this.$el.append(this._renderTags(b))},removeTag:function(a){this.removeTagIndex(a.id)},removeLast:function(){var a=this.$el.find("li").last(),b=a.attr("data-tag-id");this.removeTagIndex(b),a.remove(),f.trigger("/ui/publisher/removedTag",b)}})}),define("css!common-ui/lib/ui/shared/type_ahead_tag_list",[],function(){}),define("common-ui/lib/ui/shared/type_ahead_tag_list",["require","jquery","underscore","core/lib/backbone_legacy_integration","common-ui/lib/ui/shared/tag_list","common-ui/lib/ui/shared/type_ahead","core/lib/util/email_extractor","core/lib/string_helper","common-ui/lib/helper/environment","jquery-watermark","css!./type_ahead_tag_list"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_legacy_integration"),e=a("common-ui/lib/ui/shared/tag_list"),f=a("common-ui/lib/ui/shared/type_ahead"),g=a("core/lib/util/email_extractor"),h=a("core/lib/string_helper"),i=a("common-ui/lib/helper/environment");return a("jquery-watermark"),a("css!./type_ahead_tag_list"),d.extend({defaults:{emptyWatermark:"",filledWatermark:"",hintMessage:void 0,excludeEmails:!1,emailsOnly:!1,allowNonCanonicalEmails:!1,displayNonCanonicalEmails:!1,excludePendingUsers:!1,typeAheadOpts:{},typeAheadMaxResults:6,typeAheadEarlyResultsForUsers:4,typeAheadMaxInternalUsers:void 0,typeAheadMaxExternalUsers:void 0,typeAheadEarlyResultsForEmails:2,typeAheadWidth:260,entryFieldMaxWidth:455,truncNameLength:22,inputType:"text",inline:!0,displayInput:!0},events:{"click   .yj-tag-remove":"handleTagRemoveClick","click   .yj-bubbles":"handleEntryContainerClick","focus   .yj-bubble-field":"handleEntryFieldFocus","blur    .yj-bubble-field":"handleEntryFieldBlur","keydown .yj-bubble-field":"handleEntryFieldKeydown"},id:"typeAheadTagList",className:"yj-bubbles-container",template:'      {{#displayInput}}      <div class="yj-bubbles">        <label><span class="yj-acc-hidden yj-bubble-field-label"></span>          <input type="{{inputType}}" class="yj-bubble-field" wrap="off" />        </label>      </div>      {{/displayInput}}    ',initialize:function(a){this.options=c.defaults({},a,this.defaults),this.exclusions=this.options.exclusions,delete this.options.exclusions,c.bindAll(this,"handleEntrySelect","handleNoSelect","_resizeEntryField","_addEntriesAsAcceptableEmails","_addEntriesAsUnacceptableEmails"),this.tagList=this._createTagList(),this.extractor=this._createEmailExtractor(f.getDomains())},remove:function(){this._destroyTypeAhead()},show:function(){this.$el.show()},hide:function(){this.$el.hide()},render:function(){this.renderTemplate(this.options),this.createSubElements(),this._attachTypeAhead(),this._attachTagList(),this._setWatermarkForEntryField(),this._updateEntryField()},createSubElements:function(){this.$entryContainer=this.$(".yj-bubbles"),this.$entryField=this.$(".yj-bubble-field"),this.$entryFieldLabel=this.$(".yj-bubble-field-label")},_createTagList:function(){return new e({itemTemplate:"userTemplate",className:"yj-tag-list-lg"})},_attachTagList:function(){this.prepend(this.tagList,".yj-bubbles")},_attachTypeAhead:function(){var a={inline:this.options.inline,onSelect:this.handleEntrySelect,onNoSelection:this.handleNoSelect,width:this.options.typeAheadWidth,allowWide:!1,maxResults:this.options.typeAheadMaxResults,maxInternalUsers:this.options.typeAheadMaxInternalUsers,maxExternalUsers:this.options.typeAheadMaxExternalUsers,triggerStrings:{},hintMessage:this.options.hintMessage,excludeEmails:this.options.excludeEmails,completableModels:this.options.emailsOnly?[f.MODEL_DOMAIN]:this.options.excludePendingUsers?[f.MODEL_DOMAIN,f.MODEL_USER]:[f.MODEL_DOMAIN,f.MODEL_USER,f.MODEL_PENDINGUSER]};this.exclusions&&(a.excludes=this._formatExclusionsForTypeAhead(this.exclusions)),a.triggerStrings[f.MODEL_USER]=["@"],this.options.emailsOnly||(a.earlyModelResults={},a.earlyModelResults[f.MODEL_DOMAIN]=this.options.typeAheadEarlyResultsForEmails,a.earlyModelResults[f.MODEL_USER]=this.options.typeAheadEarlyResultsForUsers),this.options.typeAheadOpts&&c.extend(a,this.options.typeAheadOpts),f.registerField(this.$entryField,a)},_destroyTypeAhead:function(){f.removeField(this.$entryField)},_createEmailExtractor:function(a){var b;if(!this.options.allowNonCanonicalEmails){var d=c.map(a,function(a){return h.escapeRegExp(a.name)}),e=new RegExp("@("+d.join("|")+")$");b=function(a){return e.test(a)}}return new g({filter:b})},addEntries:function(a){c.isArray(a)||(a=[a]),a=c.compact(a),0!==a.length&&(this.tagList.addTags(a),this.addExclusions(c.pluck(a,"id")),this._resetEntryField(),this._updateEntryField(),c.each(a,function(a){this.trigger("addedEntry",a)},this))},removeEntry:function(a){this.tagList.removeTagIndex(a),this.tagList.removeTagElement(a),this._removeExclusion(a),this._updateEntryField(),this.trigger("removedEntry",a)},markEntriesAsFailedByEmail:function(a){this.tagList.markTagsAsFailedByEmail(a)},hasNoFailedEntries:function(){return this.tagList.hasNoFailedTags()},hasNoEntries:function(){return this.tagList.isEmpty()},val:function(){return this.tagList.tags},content:function(){return this.$entryField.val()},clear:function(){this._clearTags(),this._clearExclusions(),this._updateEntryField(),this.trigger("removedEntry"),f.deactivate()},_createEntryFromUser:function(a,b){return a.truncName=h.truncate(a.full_name||a.name||"",this.options.truncNameLength),a.canonical=b,a},_createEntryFromEmail:function(a,b){return b||this.options.displayNonCanonicalEmails?{id:a.replace("@",""),name:a,canonical:b,type:b?"domain":"invalid"}:void 0},_createEntryFromAcceptableEmail:function(a){return this._createEntryFromEmail(a,!0)},_createEntryFromUnacceptableEmail:function(a){return this._createEntryFromEmail(a,!1)},handleNoSelect:function(a){this._addEntriesFromString(a),this._focusOnEntryField()},handleEntrySelect:function(a){this.addEntries(this._createEntryFromUser(a,!0)),this._focusOnEntryField()},handleEntryContainerClick:function(a){a.stopPropagation(),a.preventDefault(),this._focusOnEntryField()},handleEntryFieldFocus:function(){this._updateEntryField()},handleEntryFieldBlur:function(){this._addEntriesFromString(this.content())},handleEntryFieldKeydown:function(a){switch(a.which){case 8:this.content()||this.hasNoEntries()||this.handleDeleteKey(a),c.defer(this._resizeEntryField);break;case 13:break;case 37:case 38:case 39:case 40:break;default:c.defer(this._resizeEntryField)}},handleDeleteKey:function(a){a.stopPropagation(),a.preventDefault();var b=c.last(this.tagList.tags).id;this.tagList.removeLast(),this.removeEntry(b),this._focusOnEntryField()},handleTagRemoveClick:function(a){var c=b(a.target).closest("li").attr("data-tag-id");this.removeEntry(c),this._focusOnEntryField()},_addEntriesFromString:function(a){var b=this.extractor.extractEmails(a);this._addEntriesAsAcceptableEmails(b.accepted),this._addEntriesAsUnacceptableEmails(b.rejected)},_addEntriesAsAcceptableEmails:function(a){var b=c.uniq(a.sort()),d=c.map(b,this._createEntryFromAcceptableEmail,this);this.addEntries(d)},_addEntriesAsUnacceptableEmails:function(a){var b=c.uniq(a.sort()),d=c.map(b,this._createEntryFromUnacceptableEmail,this);this.addEntries(d)},_resizeEntryContainer:function(){this.$entryContainer.trigger("resize")},_resizeEntryField:function(){var a=this.content();""===a&&(a=this._getWatermarkForEntryField());var b=Math.max(this._sizeOfString(a),10),c=this.hasNoEntries()?"100%":b;this.$entryField.width(c),this._resizeEntryContainer();try{f.positionElement()}catch(a){}},_sizeOfString:function(a){var c=b("<span/>",{text:a,css:{position:"absolute",visibility:"hidden"}}).appendTo(b("body")),d=c.width(),e=5;return c.remove(),i.isOlderIE()&&(e=30),d+e},_entryFieldVal:function(){return this.$entryField.val()},_resetEntryField:function(){this.$entryField.val("").attr("size",1)},_updateEntryField:function(){this._setWatermarkForEntryField(),this._resizeEntryField()},_getWatermarkForEntryField:function(){return this.hasNoEntries()?this.options.emptyWatermark:this.options.filledWatermark},_setWatermarkForEntryField:function(a){a=null!=a?a:this._getWatermarkForEntryField(),this.$entryField.watermark(a),this.$entryFieldLabel.text(a)},_focusOnEntryField:function(){this.$entryField.focus()},addExclusions:function(a){this.exclusions=this.exclusions||[],c.isArray(a)?this.exclusions.push.apply(this.exclusions,a):this.exclusions.push(a),f.exclude(this.$entryField,this._formatExclusionsForTypeAhead(this.exclusions))},_removeExclusion:function(a){if(this.exclusions){var b=c.indexOf(this.exclusions,a);b>-1&&(this.exclusions.splice(b,1),f.exclude(this.$entryField,this._formatExclusionsForTypeAhead(this.exclusions)))}},_formatExclusionsForTypeAhead:function(a){var b={};return b[f.MODEL_USER]=c.map(a,function(a){return a.toString()}),b},_clearTags:function(){this.tagList.clear()},_clearExclusions:function(){
this.exclusions=[],f.exclude(this.$entryField,{})}})}),define("stache!common-ui/lib/ui/groups/members_error_reporter",["mustache"],function(a){var b="{{message}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/groups/members_error_reporter",[],function(){}),define("common-ui/lib/ui/groups/members_error_reporter",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_show_hide","html!./members_error_reporter","css!./members_error_reporter"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_show_hide"),e=a("html!./members_error_reporter");return a("css!./members_error_reporter"),b.extend({mixins:[c,d],className:"yj-members-error-reporter",template:e,initialize:function(a){a.message?this.showMessage(a.message):this.hide()},getTemplateData:function(){return{message:this._message}},showMessage:function(a){this._message=a,this.render(),this.show()}})}),define("stache!common-ui/lib/ui/groups/create_group_form",["mustache"],function(a){var b='<form accept-charset="UTF-8" action="{{groupFormPath}}" method="post" enctype="multipart/form-data" data-qaid="form">\n  <input name="utf8" type="hidden" value="✓">\n  <input name="authenticity_token" type="hidden" value="{{csrf}}">\n  <input id="section" name="section" type="hidden" value="group_creation_lightbox">\n  {{#isExternal}}\n  <input type="hidden" name="group[external]" value="true">\n  {{/isExternal}}\n\n  <fieldset class="group-info">\n    <div class="dl group-info--field">\n      <label>\n        <div class="dt yj-create-group--field-label-container">\n          <span class="yj-create-group-form--label">{{groupNameLabel}}</span>\n        </div>\n        <div class="dd group-info--field-input">\n          <div class="group-name">\n            <input id="group_name_entry" class="yj-create-group-form--name-input" name="group[name]" type="text" aria-required="true"/>\n          </div>\n          <div class="yj-create-group-form--name-status"></div>\n        </div>\n      </label>\n    </div>\n\n    <div class="dl no-bottom-margin group-info--field">\n      <div class="dt yj-create-group--field-label-container">\n        <span class="yj-create-group-form--label group-info--members-label">{{groupMembersLabel}}</span>\n        {{#isExternal}}\n          <span class="group-info--external-members-info">\n            <span class="yamicon yamicon-network group-info--external-members-info-icon"></span>\n            <span class="group-info--external-members-info-text">{{externalMembersInfo}}</span>\n          </span>\n        {{/isExternal}}\n      </div>\n      <div class="dd group-add-member-container group-add-lightbox group-info--field-input">\n        <GroupMembersTypeAhead/>\n        <MembersErrorReporter/>\n      </div>\n      <input type="hidden" id="notify" name="notify" value="false" />\n      <input type="hidden" id="email-invites" name="invites[emails][addresses]" value="" />\n    </div>\n  </fieldset>\n\n  <div class="settings group-privacy">\n    <GroupPrivacyControls/>\n  </div>\n\n  <div class="yj-create-group-form--buttons-container">\n    <button class="yj-btn yj-create-group-form--submit-button" type="submit" data-qaid="submit-button"><span>{{createGroupButtonLabel}}</span></button>\n  </div>\n</form>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/groups/create_group_form",[],function(){}),define("common-ui/lib/ui/groups/create_group_form",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/location_helper","common-ui/lib/helper/name_validator","backbone","core/lib/report","core/lib/tr","core/lib/session","core/lib/urls","core/lib/yammer_api","core/lib/util/authenticity_token","collections/groups","collections/group_memberships","common-ui/lib/ui/groups/group_privacy_controls","workfeed/lib/modules/observe_field","common-ui/lib/ui/shared/type_ahead_tag_list","common-ui/lib/ui/groups/members_error_reporter","common-ui/lib/ui/accessibility/screenreader_announcer","common-ui/lib/ui/accessibility/focus_helper","html!./create_group_form","css!./create_group_form"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/location_helper"),g=a("common-ui/lib/helper/name_validator"),h=a("backbone"),i=a("core/lib/report"),j=a("core/lib/tr"),k=a("core/lib/session"),l=a("core/lib/urls"),m=a("core/lib/yammer_api"),n=a("core/lib/util/authenticity_token"),o=a("collections/groups"),p=a("collections/group_memberships"),q=a("common-ui/lib/ui/groups/group_privacy_controls"),r=a("workfeed/lib/modules/observe_field"),s=a("common-ui/lib/ui/shared/type_ahead_tag_list"),t=a("common-ui/lib/ui/groups/members_error_reporter"),u=a("common-ui/lib/ui/accessibility/screenreader_announcer"),v=a("common-ui/lib/ui/accessibility/focus_helper"),w="create_group_error_flexternal_disabled_in_recipients_network",x={recipient_not_invitable:w},y=a("html!./create_group_form");return a("css!./create_group_form"),c.extend({mixins:[d,e],className:"community-lightbox yj-create-group-form",id:"community-lightbox-container",template:y,views:{GroupPrivacyControls:"_getGroupPrivacyControls",GroupMembersTypeAhead:"_getGroupMembersTypeAhead",MembersErrorReporter:"_getMembersErrorReporter"},events:{"submit form":"_handleGroupOnSubmit"},getTemplateData:function(){return{csrf:n.get(),groupFormPath:l.groups(),groupNameLabel:this._nameLabel,groupMembersLabel:this._groupMembersLabel,createGroupButtonLabel:j.t("create_ig_button_label"),isExternal:this.options.isExternal,externalMembersInfo:j.t("external_group_members_info")}},initialize:function(){this._nameLabel=j.t("create_ig_group_name_label"),this._groupMembersLabel=j.t("create_ig_group_members_label"),this.options.groupType&&(this._nameLabel=this.options.groupType.createGroupNameLabel,this._groupMembersLabel=this.options.groupType.createGroupMembersLabel)},render:function(){return this._initFieldNameValidation(),this._disableCreateGroupButton(),this},getGroupName:function(){return this.$(".yj-create-group-form--name-input").val()},setGroupName:function(a){var b=this.$(".yj-create-group-form--name-input");b.val(a),b.trigger("change")},_initFieldNameValidation:function(){var a=this.$(".yj-create-group-form--name-input"),b=this.$(".yj-create-group-form--name-status"),c=this.$(".yj-create-group-form--submit-button");this.validateGroupName=new r(a,{validateFunction:function(a){return g.validateGroupName(a)},update:b,spinner:!0,submit:c,validate:!0})},_getGroupPrivacyControls:function(){return this.privacyControls=new q({isPrivate:!1,showInDirectory:!0,extendedOptions:!1}),this.privacyControls.on("componentResized",function(){this.options.onResize&&this.options.onResize()}),this.privacyControls},_getGroupMembersTypeAhead:function(){var a={emptyWatermark:"+ "+j.t("add_people_to_this_group_by_name_or_email"),emailsOnly:!1,inline:!1};return this.options.isExternal&&(a.typeAheadMaxInternalUsers=3,a.typeAheadMaxExternalUsers=3,a.typeAheadOpts={allowForeignUsers:!0,allowForeignEmails:!0,showTopRankingsOnce:!0,hintMessage:null,selectFirst:!1}),this.typeAhead=new s(a),this.listenTo(this.typeAhead,"removedEntry",function(){this.typeAhead.hasNoFailedEntries()&&(this._errorReporter.hide(),this._enableCreateGroupButton())}),this.typeAhead},_getMembersErrorReporter:function(){return this._errorReporter=new t,this._errorReporter},_handleGroupOnSubmit:function(){return this._disableCreateGroupButton(),u.announceText(j.t("creating_group")),this._errorReporter.hide(),m.createGroup(this._getFormData()).done(b.bind(function(a){o.add(a),p.add({user_id:k.getCurrentUser().id,group_id:a.id});var b=k.getCurrentUser();b.group_memberships.push(a),this.options.groupType&&this.options.groupType.value?(i.event("group_creation_group_type",{group_id:a.id,group_type:this.options.groupType.value}),window.setTimeout(function(){f.assign(a.web_url)},1100)):f.assign(a.web_url)},this)).fail(b.bind(function(a){var b=a.responseJSON;400===a.status&&b&&b.data?(this.typeAhead.markEntriesAsFailedByEmail(b.data),this._errorReporter.showMessage(this._getErrorMessage(b.code)),this.options.onResize&&this.options.onResize()):h.trigger("/ui/alert/show","error",j.t("there_was_an_error"))},this)),!1},_getFormData:function(){var a={name:this.$(".yj-create-group-form--name-input").val(),external:this.options.isExternal,notify:!0,invites:this._getInvitesData()};return b.extend(a,{show_in_directory:this.privacyControls.isShownInDirectory(),group_moderated_true:this.privacyControls.isGroupModerated(),private:this.privacyControls.isPrivate(),showWhoCanViewContent:this.privacyControls.isShowingWhoCanViewContent()})},_getInvitesData:function(){var a=[],c=[];return b.each(this.typeAhead.val(),function(b){b.id.indexOf("@")>0?c.push(b.id):a.push(b.id)}),{user_ids:a.join(","),emails:c.join(",")}},_disableCreateGroupButton:function(){var a=this.$(".yj-create-group-form--submit-button");v.notifyRemoval(a),a.addClass("yj-btn-disabled").attr("disabled","disabled")},_enableCreateGroupButton:function(){this.$(".yj-create-group-form--submit-button").removeClass("yj-btn-disabled").removeAttr("disabled")},_getErrorMessage:function(a){var b=x[a];return b||(b=w),j.t(b)}})}),define("stache!common-ui/lib/ui/groups/create_group_tabs",["mustache"],function(a){var b='{{#showNetwork}}\n<div id="community-creation-double" class="yj-clearfix {{openTab}}-bg">\n  <a href="javascript://" role="button" id="group-tab" class="yj-clearfix{{#openGroupTab}} yj-acc-selected{{/openGroupTab}}{{^openGroupTab}} unselected-tab{{/openGroupTab}}">\n    <span class="yamicon yamicon-group yamicon-large yj-blue creation-selector-icon"></span>\n    <div class="creation-selector-text">\n      <h3 role="presentation">{{internalGroupTabTitle}}\n        <span class="yj-acc-hidden"> {{tab}}</span>\n        <span class="yj-acc-selectedstate"> {{selected}}</span>\n      </h3>\n      <p>{{internalGroupTabSubtitle}}</p>\n    </div>\n  </a>\n  <a href="javascript://" role="button" id="network-tab" class="yj-clearfix{{#openNetworkTab}} yj-acc-selected{{/openNetworkTab}}{{^openNetworkTab}} unselected-tab{{/openNetworkTab}}">\n    <span class="yamicon yamicon-network yamicon-x-large yj-blue creation-selector-icon"></span>\n    <div class="creation-selector-text">\n      <h3 role="presentation">{{externalNetworkTabLabel}}\n        <span class="yj-acc-hidden"> {{tab}}</span>\n        <span class="yj-acc-selectedstate"> {{selected}}</span>\n      </h3>\n      <p>{{enTabSubtitle}}</p>\n    </div>\n  </a>\n</div>\n{{/showNetwork}}\n{{^showNetwork}}\n<div id="community-creation-double" class="yj-clearfix single-bg">\n  <div id="group-tab-single" class="yj-clearfix">\n    <span class="yamicon yamicon-group yamicon-large yj-blue creation-selector-icon"></span>\n    <div class="creation-selector-text">\n      <p><strong>{{internalGroupTabTitle}}</strong> {{internalGroupTabSubtitle}}</p>\n    </div>\n  </div>\n</div>\n{{/showNetwork}}\n<div id="groups-creation-container" class="groups-creation" {{^openGroupTab}} style="display:none"{{/openGroupTab}}>\n  <CreateGroupForm/>\n</div>\n{{#showNetwork}}\n<div id="networks-creation-container" class="groups-creation" {{^openNetworkTab}} style="display:none"{{/openNetworkTab}}>\n  <CreateExtNetworkFrom/>\n</div>\n{{/showNetwork}}';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/groups/create_group_tabs",["require","jquery","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","common-ui/lib/ui/groups/create_en_form","common-ui/lib/ui/groups/create_group_form","core/lib/backbone_with_subviews","core/lib/session","html!./create_group_tabs","core/lib/tr"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("common-ui/lib/ui/groups/create_en_form"),f=a("common-ui/lib/ui/groups/create_group_form"),g=a("core/lib/backbone_with_subviews"),h=a("core/lib/session"),i=a("html!./create_group_tabs"),j=a("core/lib/tr");return d.extend({mixins:[c,g],className:"community-lightbox yj-lightbox-content",id:"community-lightbox-container",template:i,defaults:{openTab:"group"},events:{"click #group-tab":"switchToGroup","click #network-tab":"switchToEN"},views:{CreateGroupForm:"_createGroupForm",CreateExtNetworkFrom:"_createExtNetworkForm"},initialize:function(){var a=h.getCurrentUser().can_create_new_network,b=h.getCurrentNetwork().community;this.showNetwork=a&&!b},getTemplateData:function(){return{showNetwork:this.showNetwork,openTab:this.options.openTab,openGroupTab:"group"===this.options.openTab,openNetworkTab:"network"===this.options.openTab,internalGroupTabTitle:j.t("create_ig_tab_title"),externalNetworkTabLabel:j.t("create_en_tab_title"),internalGroupTabSubtitle:j.t("create_ig_subtitle"),enTabSubtitle:j.t("create_en_subtitle"),tab:j.t("tab"),selected:j.t("selected")}},render:function(){return this.$tabSelectionButtons=this.$("#community-creation-double"),this.$networkWrapper=this.$("#networks-creation-container"),this.$groupWrapper=this.$("#groups-creation-container"),this},switchToGroup:function(){var a=this;this._fadeOutTab(this.network,function(){a._switchTabSelectionButtonsTo(a.group),a._fadeInTab(a.group,function(){a._focusOnTab(a.group),a._copyFieldContentTo(a.group)}),a._onTabSwap()})},switchToEN:function(){var a=this;this._fadeOutTab(this.group,function(){a._switchTabSelectionButtonsTo(a.network),a._fadeInTab(a.network,function(){a._focusOnTab(a.network),a._copyFieldContentTo(a.network)}),a._onTabSwap()})},_switchTabSelectionButtonsTo:function(a){this._isGroup(a)?(this.$tabSelectionButtons.removeClass("network-bg").addClass("group-bg"),this.$("#network-tab").addClass("unselected-tab").removeClass("yj-acc-selected"),this.$("#group-tab").removeClass("unselected-tab").addClass("yj-acc-selected")):(this.$tabSelectionButtons.removeClass("group-bg").addClass("network-bg"),this.$("#group-tab").addClass("unselected-tab").removeClass("yj-acc-selected"),this.$("#network-tab").removeClass("unselected-tab").addClass("yj-acc-selected"))},_fadeOutTab:function(a,b){this._isGroup(a)?this.$groupWrapper.fadeOut("fast",b):this.$networkWrapper.fadeOut("fast",b)},_fadeInTab:function(a,b){this._isGroup(a)?this.$groupWrapper.fadeIn("fast",b):this.$networkWrapper.fadeIn("fast",b),b()},_focusOnTab:function(a){this._isGroup(a)?b("#group_name_entry").focus():b("#new_network_name").focus()},_copyFieldContentTo:function(a){var b=this.$("#group_name_entry"),c=this.$("#new_network_name");this._isGroup(a)?""!==c.val()&&b.val(c.val()).trigger("change"):""!==b.val()&&c.val(b.val()).trigger("change")},_isGroup:function(a){return a==this.group},_isEN:function(a){return a==this.network},_createGroupForm:function(){return this.group=new f({groupType:this.options.groupType,onResize:this.options.onResize}),this.group},_createExtNetworkForm:function(){return this.network=new e,this.network},_onTabSwap:function(){this.options.onResize&&this.options.onResize()}})}),define("stache!common-ui/lib/ui/groups/create_group_tabs_future",["mustache"],function(a){var b='{{#showExternal}}\n<div class="yj-create-group-tabs--tab-container">\n  <a href="#" role="button" id="group-tab" class="{{#openInternalTab}}is-active yj-acc-selected {{/openInternalTab}}yj-create-group-tabs--tab">\n    <div class="yj-create-group-tabs--tab-icon">{{{internalIcon}}}</div>\n    <div class="yj-create-group-tabs--tab-text">\n      <h3 role="presentation" class="yj-create-group-tabs--tab-text-title">{{internalTabTitle}}\n        <span class="yj-acc-hidden"> {{tab}}</span>\n        <span class="yj-acc-selectedstate"> {{selected}}</span>\n      </h3>\n      <p class="yj-create-group-tabs--tab-text-subtitle">{{internalTabSubtitle}}</p>\n    </div>\n  </a>\n  <a href="#" role="button" id="network-tab" class="yj-clearfix{{#openExternalTab}} is-active yj-acc-selected{{/openExternalTab}} yj-create-group-tabs--tab">\n    <div class="yj-create-group-tabs--tab-icon">{{{externalIcon}}}</div>\n    <div class="yj-create-group-tabs--tab-text">\n      <h3 role="presentation" class="yj-create-group-tabs--tab-text-title">{{externalTabTitle}}\n        <span class="yj-acc-hidden"> {{tab}}</span>\n        <span class="yj-acc-selectedstate"> {{selected}}</span>\n      </h3>\n      <p class="yj-create-group-tabs--tab-text-subtitle">{{externalTabSubtitle}}</p>\n    </div>\n  </a>\n</div>\n{{/showExternal}}\n{{^showExternal}}\n<div class="yj-clearfix">\n  <div id="group-tab-single" class="yj-create-group-tabs--tab is-active">\n    <div class="yj-create-group-tabs--tab-icon">{{{internalIcon}}}</div>\n    <div class="yj-create-group-tabs--tab-text">\n      <p class="yj-create-group-tabs--tab-text-subtitle"><strong>{{internalTabTitle}}</strong> {{internalTabSubtitle}}</p>\n    </div>\n  </div>\n</div>\n{{/showExternal}}\n<div class="yj-create-group-tabs--group-container yj-create-group-tabs--internal-group-container groups-creation" {{^openInternalTab}} style="display:none"{{/openInternalTab}}>\n  <InternalGroupForm/>\n</div>\n{{#showExternal}}\n<div class="yj-create-group-tabs--group-container yj-create-group-tabs--external-group-container groups-creation" {{^openExternalTab}} style="display:none"{{/openExternalTab}}>\n  <ExternalGroupFrom/>\n</div>\n{{/showExternal}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/groups/create_group_tabs_future",[],function(){}),define("common-ui/lib/ui/groups/create_group_tabs_future",["require","jquery","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","core/lib/session","core/lib/tr","models/helpers/network","common-ui/lib/helper/svg_icon","common-ui/lib/ui/groups/create_group_form","html!./create_group_tabs_future","css!./create_group_tabs_future"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/session"),g=a("core/lib/tr"),h=a("models/helpers/network"),i=a("common-ui/lib/helper/svg_icon"),j=a("common-ui/lib/ui/groups/create_group_form"),k=a("html!./create_group_tabs_future"),l={internal:{active:"group-of-3-blue",inactive:"group-of-3-grey"},external:{active:"network-shaded-blue",inactive:"network-shaded-grey"}},m={width:32,height:32};return a("css!./create_group_tabs_future"),d.extend({defaults:{openTab:"internal"},className:"yj-create-group-tabs community-lightbox yj-lightbox-content",template:k,mixins:[c,e],events:{"click #group-tab":"switchToInternal","click #network-tab":"switchToExternal"},views:{InternalGroupForm:"_getInternalGroupForm",ExternalGroupFrom:"_getExternalGroupForm"},getTemplateData:function(){var a=this.options.openTab;return{showExternal:this._shouldShowExternalGroup(),openInternalTab:"internal"===a,internalIcon:this._getTabIcon("internal",a),openExternalTab:"external"===a,externalIcon:this._getTabIcon("external",a),internalTabTitle:g.t("create_ig_tab_title"),externalTabTitle:g.t("create_eg_title"),internalTabSubtitle:g.t("create_ig_subtitle"),externalTabSubtitle:g.t("create_eg_subtitle"),tab:g.t("tab"),selected:g.t("selected")}},render:function(){return this.$networkWrapper=this.$(".yj-create-group-tabs--external-group-container"),this.$groupWrapper=this.$(".yj-create-group-tabs--internal-group-container"),this},switchToInternal:function(a){a.preventDefault();var b=this;this._fadeOutTab(this.externalGroup,function(){b._switchTabSelectionButtonsTo(b.internalGroup),b._fadeInTab(b.internalGroup,function(){b._focusOnTab(b.internalGroup),b._copyFieldContentTo(b.internalGroup)}),b._onTabSwap()})},switchToExternal:function(a){a.preventDefault();var b=this;this._fadeOutTab(this.internalGroup,function(){b._switchTabSelectionButtonsTo(b.externalGroup),b._fadeInTab(b.externalGroup,function(){b._focusOnTab(b.externalGroup),b._copyFieldContentTo(b.externalGroup)}),b._onTabSwap()})},_getTabIcon:function(a,b){var c=a===b?"active":"inactive";return i(l[a][c],m)},_shouldShowExternalGroup:function(){var a=f.getCurrentNetwork(),b=h.isExternalMessagingEnabled(a),c=a.community;return b&&!c},_switchTabSelectionButtonsTo:function(a){this._isInternal(a)?(this.$("#network-tab").removeClass("is-active").removeClass("yj-acc-selected"),this.$("#network-tab .yj-create-group-tabs--tab-icon").html(i(l.external.inactive,m)),this.$("#group-tab").addClass("is-active").addClass("yj-acc-selected"),this.$("#group-tab .yj-create-group-tabs--tab-icon").html(i(l.internal.active,m))):(this.$("#group-tab").removeClass("is-active").removeClass("yj-acc-selected"),this.$("#group-tab .yj-create-group-tabs--tab-icon").html(i(l.internal.inactive,m)),this.$("#network-tab").addClass("is-active").addClass("yj-acc-selected"),this.$("#network-tab .yj-create-group-tabs--tab-icon").html(i(l.external.active,m)))},_fadeOutTab:function(a,b){this._isInternal(a)?this.$groupWrapper.fadeOut("fast",b):this.$networkWrapper.fadeOut("fast",b)},_fadeInTab:function(a,b){this._isInternal(a)?this.$groupWrapper.fadeIn("fast",b):this.$networkWrapper.fadeIn("fast",b),b()},_focusOnTab:function(a){this._isInternal(a)?b("#group_name_entry").focus():b("#new_network_name").focus()},_copyFieldContentTo:function(a){this._isInternal(a)?""!==this.externalGroup.getGroupName()&&this.internalGroup.setGroupName(this.externalGroup.getGroupName()):""!==this.internalGroup.getGroupName()&&this.externalGroup.setGroupName(this.internalGroup.getGroupName())},_isInternal:function(a){return a==this.internalGroup},_isExternal:function(a){return a==this.externalGroup},_getInternalGroupForm:function(){return this.internalGroup=new j({groupType:this.options.groupType,onResize:this.options.onResize}),this.internalGroup},_getExternalGroupForm:function(){return this.externalGroup=new j({onResize:this.options.onResize,isExternal:!0}),this.externalGroup},_onTabSwap:function(){this.options.onResize&&this.options.onResize()}})}),define("stache!components/create_group_chooser/src/create_group_chooser",["mustache"],function(a){var b='<div class="yj-create-group-chooser-content {{version}}">\n  {{#groups}}\n  <label class="yj-create-group-chooser--item yj-create-group-chooser--item-{{value}} {{version}}" for="yj-create-group-chooser--radio-{{value}}">\n    <div class="yj-create-group-chooser--radio-control">\n      <input id="yj-create-group-chooser--radio-{{value}}" class="yj-create-group-chooser--radio" type="radio" name="group_type" value="{{value}}">\n    </div>\n\n    <div class="yj-create-group-chooser--info">\n      <div class="yj-create-group-chooser--info-title">{{title}}</div>\n      <div class="yj-create-group-chooser--info-desc">{{description}}</div>\n    </div>\n  </label>\n  {{/groups}}\n\n  <div class="yj-create-group-chooser--button-container">\n    <button type="submit" class="yj-create-group-chooser--next yj-btn {{version}}" disabled>{{next}}</button>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/create_group_chooser/src/create_group_chooser",[],function(){}),define("components/create_group_chooser/src/create_group_chooser",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","core/lib/tr","common-ui/lib/helper/ui","html!./create_group_chooser","css!./create_group_chooser"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/tr"),f=a("common-ui/lib/helper/ui"),g=a("html!./create_group_chooser");a("css!./create_group_chooser");var h=c.extend({mixins:[b,d],className:"yj-create-group-chooser",template:g,initialize:function(){this._groupType=null,this._version=this.options.version,this._onGroupChosen=this.options.onGroupChosen},getTemplateData:function(){return{groups:this._getGroups,version:1===this._version?"is-v1":"is-v2",next:e.t("next_to_group_creator")}},events:{"change .yj-create-group-chooser--item":"_chooseGroup","click .yj-create-group-chooser--next":"_handleNextButton"},_getGroups:function(){return[h.Groups.PROJECT,h.Groups.TEAM,h.Groups.EXPERTISE,h.Groups.OTHER]},_chooseGroup:function(a){var b=a.target||a.srcElement;switch(b.value){case h.Groups.PROJECT.value:this._groupType=h.Groups.PROJECT;break;case h.Groups.TEAM.value:this._groupType=h.Groups.TEAM;break;case h.Groups.EXPERTISE.value:this._groupType=h.Groups.EXPERTISE;break;case h.Groups.OTHER.value:this._groupType=h.Groups.OTHER}this._groupType&&(this._selectItemGroup(this._groupType),f.enableButton(this.$(".yj-create-group-chooser--next")))},_selectItemGroup:function(a){this.$(".yj-create-group-chooser--item").removeClass("yj-create-group-chooser--item-selected"),this.$(".yj-create-group-chooser--item-"+a.value).addClass("yj-create-group-chooser--item-selected")},_handleNextButton:function(){this._onGroupChosen&&this._onGroupChosen(this._groupType)}},{Groups:{PROJECT:{title:e.t("project_group_label"),description:e.t("make_plans_ask_questions_and_share_updates_on_an_event_launch_or_project"),createGroupNameLabel:e.t("create_ig_project_group_name_label"),createGroupMembersLabel:e.t("create_ig_project_group_members_label"),lightboxTitle:e.t("create_project_group"),value:"project"},TEAM:{title:e.t("team_group_label"),description:e.t("collaborate_and_converse_with_your_immediate_coworkers_or_dept"),createGroupNameLabel:e.t("create_ig_team_group_name_label"),createGroupMembersLabel:e.t("create_ig_team_group_members_label"),lightboxTitle:e.t("create_team_group"),value:"team"},EXPERTISE:{title:e.t("question_and_answer_group_label"),description:e.t("answer_frequently_asked_questions_share_best_practices_and_updates"),createGroupNameLabel:e.t("create_ig_question_answer_group_name_label"),createGroupMembersLabel:e.t("create_ig_group_members_label"),lightboxTitle:e.t("create_question_answer_group"),value:"expertise"},OTHER:{title:e.t("other_group_label"),description:e.t("discuss_a_shared_interest_hobby_skill"),createGroupNameLabel:e.t("create_ig_group_name_label"),createGroupMembersLabel:e.t("create_ig_group_members_label"),lightboxTitle:e.t("create_new_group"),value:"other"}}});return h}),define("components/create_group_chooser/index",["require","./src/create_group_chooser"],function(a){"use strict";var b=a("./src/create_group_chooser");return b}),define("stache!components/create_group/src/create_group",["mustache"],function(a){var b="{{#inGroupPickerExperiment}}\n  {{#isChoosingGroup}}\n    <CreateGroupChooser />\n  {{/isChoosingGroup}}\n\n  {{^isChoosingGroup}}\n    <CreateGroupTabs />\n  {{/isChoosingGroup}}\n{{/inGroupPickerExperiment}}\n\n{{^inGroupPickerExperiment}}\n  <CreateGroupTabs />\n{{/inGroupPickerExperiment}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("components/create_group/src/create_group",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","common-ui/lib/ui/groups/create_group_tabs","common-ui/lib/ui/groups/create_group_tabs_future","components/create_group_chooser/index","core/lib/backbone_with_subviews","backbone","core/lib/session","core/lib/tr","core/lib/treatment","models/helpers/network","html!./create_group"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("common-ui/lib/ui/groups/create_group_tabs"),e=a("common-ui/lib/ui/groups/create_group_tabs_future"),f=a("components/create_group_chooser/index"),g=a("core/lib/backbone_with_subviews"),h=a("backbone"),i=a("core/lib/session"),j=a("core/lib/tr"),k=a("core/lib/treatment"),l=a("models/helpers/network"),m=a("html!./create_group");return c.extend({mixins:[b,g],className:"yj-create-group",template:m,getTemplateData:function(){return{inGroupPickerExperiment:this._canUserChooseGroup,isChoosingGroup:this._isChoosingGroup}},views:{CreateGroupChooser:"_getCreateGroupChooser",CreateGroupTabs:"_getCreateGroupTabsByVersion"},initialize:function(){this._version=this.options.version||1,this._openTabType=this.options.openTabType,this._canUserChooseGroup=this._canChooseGroup(),this._isChoosingGroup=!0,this._createGroupTabs=null,this._groupType=null},onLightboxLoaded:function(){this._setInitFocus(),this._setLightboxTitle()},_setInitFocus:function(){if(1===this._version){var a="group"===this._openTabType;a?this.$("#group_name_entry").focus():this.$("#new_network_name").focus()}else this.$("#group_name_entry").focus()},_setLightboxTitle:function(){this._canUserChooseGroup&&h.trigger("/ui/lightbox/setTitle",j.t("whats_this_group_for"))},_canChooseGroup:function(){var a=i.getCurrentUser(),b=i.getCurrentNetwork(),c=1===this._version?a.can_create_new_network:!1,d=2===this._version?l.isExternalMessagingEnabled(b):!1;return!d&&!c&&k.treatment("group_type_picker_v2")},_switchToCreateGroupTabs:function(a){this._groupType=a,this._isChoosingGroup=!1,this.render(),h.trigger("/ui/lightbox/resize"),h.trigger("/ui/lightbox/setTitle",a.lightboxTitle),this._setInitFocus()},_getCreateGroupChooser:function(){return new f({version:this._version,onGroupChosen:this._switchToCreateGroupTabs.bind(this)})},_getCreateGroupTabsByVersion:function(){var a={};return a.onResize=function(){h.trigger("/ui/lightbox/resize")},this._openTabType&&(a.openTab=this._openTabType),this._groupType&&(a.groupType=this._groupType),1===this._version?this._createGroupTabs=new d(a):2===this._version&&(this._createGroupTabs=new e(a)),this._createGroupTabs}})}),define("components/create_group/index",["require","./src/create_group"],function(a){"use strict";return a("./src/create_group")}),define("workfeed/lib/app/group_and_en_lightbox",["require","jquery","underscore","core/lib/jam/component2","components/create_group/index","core/lib/ctor","common-ui/lib/ui/general/lightbox_manager","backbone","core/lib/tr","core/lib/report"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/jam/component2"),e=a("components/create_group/index"),f=a("core/lib/ctor"),g=a("common-ui/lib/ui/general/lightbox_manager"),h=a("backbone"),i=a("core/lib/tr"),j=a("core/lib/report");return f("yam.workfeed.GroupAndENLightboxComponent",d,{_triggers:[],tabsName:{group:"group",external_network:"external_network"},onLoad:function(){h.on("/ui/lightbox/group_and_en/register_trigger",this.registerTrigger,this)},onDestroy:function(){h.off("/ui/lightbox/group_and_en/register_trigger",this.registerTrigger,this)},registerTrigger:function(a,d){var e=this;c(b(a)).each(function(a){b(a).off("click.registerTrigger"),b(a).on("click.registerTrigger",function(){return e._open(d),!1})})},_open:function(a){var b,c;this._isGroup(a)?(b="group",c=i.t("create_a_new_group")):(b="network",c=i.t("create_a_new_network"),"external_network"==a&&j.event("nav_networks_menu_link",{trigger:"create_external_network_link"}));var d={version:1,openTabType:b};this._createGroup=new e(d),g.openComponent(this._createGroup,"yj-create-lightbox-group",void 0,{title:c,onOpen:function(){},onComplete:this._createGroup.onLightboxLoaded.bind(this._createGroup),onClosed:this._onClosed.bind(this),overlayClose:!1,width:null,transition:"elastic"})},_onComplete:function(a){this._setInitFocus(a)},_onClosed:function(){},_close:function(){h.trigger("/ui/lightbox/close")},_isGroup:function(a){return a==this.tabsName.group}})}),define("common-ui/lib/ui/groups/create_group_lightbox",["require","core/lib/backbone_base_class","jquery","underscore","backbone","core/lib/tr","components/create_group/index","common-ui/lib/ui/general/lightbox_manager"],function(a){"use strict";var b=a("core/lib/backbone_base_class"),c=a("jquery"),d=a("underscore"),e=a("backbone"),f=a("core/lib/tr"),g=a("components/create_group/index"),h=a("common-ui/lib/ui/general/lightbox_manager");return b.extend({initialize:function(){this.listenTo(e,"/ui/lightbox/create_group/register_trigger",this.registerTrigger)},registerTrigger:function(a,b){d.each(c(a),function(a){
c(a).off("click.registerTrigger"),c(a).on("click.registerTrigger",d.bind(function(){this._open(b)},this))},this)},_open:function(a){var b={version:2,openTabType:a};this._createGroup=new g(b),h.openComponent(this._createGroup,"yj-create-lightbox-group",void 0,{title:f.t("create_a_new_group"),onOpen:function(){},onComplete:this._createGroup.onLightboxLoaded.bind(this._createGroup),onClosed:this._onClosed.bind(this),overlayClose:!1,width:null,transition:"elastic"})},_onClosed:function(){this._createGroup&&this._createGroup.remove()}})}),define("stache!common-ui/lib/ui/groups/create_en_tabs",["mustache"],function(a){var b='<div id="community-creation-double" class="yj-clearfix single-bg">\n  <div id="group-tab-single" class="yj-clearfix">\n    <span class="yamicon yamicon-network yamicon-large yj-blue creation-selector-icon"></span>\n    <div class="creation-selector-text">\n      <p><strong>{{title}}</strong> {{subtitle}}</p>\n    </div>\n  </div>\n</div>\n\n<div id="networks-creation-container" class="groups-creation">\n  <CreateEnFrom/>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/groups/create_en_tabs",["require","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_subviews","core/lib/backbone_with_auto_render","common-ui/lib/ui/groups/create_en_form","html!./create_en_tabs"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/backbone_with_auto_render"),f=a("common-ui/lib/ui/groups/create_en_form"),g=a("html!./create_en_tabs");return c.extend({mixins:[e,d],className:"community-lightbox yj-lightbox-content",id:"community-lightbox-container",template:g,views:{CreateEnFrom:"_getEnForm"},getTemplateData:function(){return{title:b.t("create_en_tab_title"),subtitle:b.t("create_en_subtitle")}},_getEnForm:function(){return new f}})}),define("common-ui/lib/ui/groups/create_en_lightbox",["require","core/lib/backbone_base_class","jquery","underscore","backbone","core/lib/tr","common-ui/lib/ui/groups/create_en_tabs","common-ui/lib/ui/general/lightbox_manager"],function(a){"use strict";var b=a("core/lib/backbone_base_class"),c=a("jquery"),d=a("underscore"),e=a("backbone"),f=a("core/lib/tr"),g=a("common-ui/lib/ui/groups/create_en_tabs"),h=a("common-ui/lib/ui/general/lightbox_manager");return b.extend({initialize:function(){this.listenTo(e,"/ui/lightbox/create_en/register_trigger",this.registerTrigger)},registerTrigger:function(a){d.each(c(a),function(a){c(a).off("click.registerTrigger"),c(a).on("click.registerTrigger",d.bind(function(){this._open()},this))},this)},_open:function(){this.createEnTabs=new g({openTab:"network",onResize:function(){e.trigger("/ui/lightbox/resize")}}),h.openComponent(this.createEnTabs,"yj-create-lightbox-group",void 0,{title:f.t("create_a_new_network"),onOpen:function(){},onComplete:this._onComplete.bind(this),onClosed:this._onClosed.bind(this),overlayClose:!1,width:null,transition:"elastic"})},_onComplete:function(){c("#new_network_name").focus()},_onClosed:function(){this.createEnTabs.remove()}})}),define("feeds/lib/ui/shared/group_membership_handler",["require","jquery","underscore","core/lib/jam/component2","core/lib/ctor","core/lib/log","backbone","core/lib/tr","core/lib/session","collections/groups","collections/group_memberships","collections/group_ranks"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/jam/component2"),e=a("core/lib/ctor"),f=a("core/lib/log"),g=a("backbone"),h=a("core/lib/tr"),i=a("core/lib/session"),j=a("collections/groups"),k=a("collections/group_memberships"),l=a("collections/group_ranks");return e(null,d,{id:"groupMembershipHandler",target:".yj-group-nav-list:first",baseAction:"threads",_delayNotification:!1,_highlightJoinedGroup:!1,_hideHighlightTimeout:5e3,itemTemplate:'      {{#groups}}      <li class="yj-nav-menu--group-item {{#highlight}}new-group{{/highlight}}" data-group-id="{{id}}" title="{{title}}">        <a href="{{baseUrl}}/#/{{baseAction}}/inGroup?type=in_group&amp;feedId={{id}}"            class="yj-nav-menu--group-item-link yj-counted">          <span class="yj-nav-menu--group-item-text">{{full_name}}</span>          <span class="badge hide"></span>        </a>      </li>      {{/groups}}    ',onLoad:function(){this.$el=b(this.target),this._joinedGroups=[],k.on("add",this._handleJoinGroup,this),k.on("remove",this._handleLeaveGroup,this),g.on("/ui/groupNav/showJoinedGroup",this._handleDelayedShow,this),g.on("/ui/groupNav/delayNotification",this._handleDelayJoinNotification,this)},createElement:function(){},onTemplating:function(a){return a.model={groups:this._joinedGroups},a},onDestroy:function(){g.off("/ui/groupNav/showJoinedGroup",this._handleDelayedShow,this),g.off("/ui/groupNav/delayNotification",this._handleDelayJoinNotification,this),k.off("add",this._handleJoinGroup),k.off("remove",this._handleLeaveGroup)},getJoinedGroups:function(){return this._joinedGroups},clearJoinedGroups:function(){return this._joinedGroups=[]},_handleJoinGroup:function(a){if(!a.get("pending")){var b=j.get(a.get("group_id"));return b?void this._showNotification(b):(f.warn("Group is not found in the ORM. Getting from API","Group Id:",a.get("group_id")),void this._saveGroup(a.get?a.get("group_id"):a.group_id,c.bind(function(a){this._showNotification(a)},this)))}},_showNotification:function(a){this._delayNotification?this._addJoinedGroup(a):this.showJoinedGroup([a])},_addJoinedGroup:function(a){this._joinedGroups.push(a)},_handleLeaveGroup:function(a){var b=a.get?a.get("group_id"):a.group_id,d=j.get(b);return d?void(i.getCurrentUser().id==(a.get?a.get("user_id"):a.user_id)&&this.removeGroup(d)):(f.warn("Group is not found in the ORM.","Group Id:",b),void this._saveGroup(b,c.bind(function(a){this.removeGroup(a)},this)))},_saveGroup:function(a,b,c){var d=j.add({id:a});d.fetch({success:function(a){b&&b(a)},error:function(){throw c&&c(),new Error("Could not fetch backbone group.")}})},_handleDelayedShow:function(a){return this._joinedGroups&&0!==this._joinedGroups.length?(a=a||{},a.highlight&&(this._highlightJoinedGroup=!0),a.showTooltip&&(this._showTooltip=!0),void this.showJoinedGroup(this._joinedGroups)):!1},_handleShowTooltip:function(){var a=this;g.trigger("/ui/tooltip/add",{target:a.$el.find(".new-group"),orientation:"right",fixed:!0,delay:200,width:200,text:function(){return h.t("you_have_added_count_new_groups",{count:a._joinedGroups.length})},tooltipSize:"small"}),window.setTimeout(function(){g.trigger("/ui/tooltip/hide")},5e3)},_handleDelayJoinNotification:function(){this._delayNotification=!0},showJoinedGroup:function(a){var b=this;a=this._filterExistingGroup(a),c.each(a,function(a){l.add({group_id:a.get?a.get("id"):a.id,external:a.get?a.get("external"):a.external,rank:0})}),this._showTooltip&&this._handleShowTooltip(),b._highlightJoinedGroup&&this._fadeJoinedGroupHighlight(this._hideHighlightTimeout),this._afterShowJoinedGroup()},_fadeJoinedGroupHighlight:function(a){window.setTimeout(c.bind(function(){this.$el.find(".new-group").removeClass("new-group")},this),a)},removeGroup:function(a){c.each(this._joinedGroups,function(b,c){b&&(b.get?b.get("id"):b.id)==a.id&&this._joinedGroups.splice(c,1)},this),this._isInGroupNav(a.get?a.get("id"):a.id)&&this._removeFromGroupNav(a.get?a.get("id"):a.id)},_filterExistingGroup:function(a){return c.each(a,function(b,d){var e=c.isFunction(b.get)?b.get("id"):b.id;void 0!==e&&this._isInGroupNav(e)&&a.splice(d,1)},this),a},_getGroupNavIds:function(){var a=[];return a=l.map(function(a){return a.get("group_id")})},_isInGroupNav:function(a){var b=this._getGroupNavIds();return-1!==c.indexOf(b,a)},_removeFromGroupNav:function(a){var b=l.findWhere({group_id:a});l.remove(b)},_afterShowJoinedGroup:function(){this.clearJoinedGroups(),this._delayNotification=!1,this._highlightJoinedGroup=!1,this._showTooltip=!1}})}),define("stache!components/global_nav/src/global_nav",["mustache"],function(a){var b='<div class="yj-nav-menu--fixed-content yk-row">\n  <div class="yj-nav-menu--fixed-header yk-col-sm-5 yk-col-md-6 yk-col-lg-7">\n    <div id="yj-nav-menu--top-nav" class="yj-nav-menu--top-nav">\n      <HeaderNavigationView key="header_nav" />\n    </div>\n  </div>\n\n  <div class="yj-nav-menu--groups">\n    <GroupNavigationView key="group_nav" />\n  </div>\n\n  <div class="yj-nav-menu--docked-content yk-col-sm-5 yk-col-md-6 yk-col-lg-7">\n    <h2 class="yj-acc-hidden">\n      <span>{{nav_user_accessibility_label}}</span>\n    </h2>\n    <NavUserView key="nav_user" />\n  </div>\n</div>\n\n<GroupBrowseLightboxView key="group_browse_lightbox" />\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/suite_nav/src/office365_shell",["require","jquery","core/lib/backbone_base_class","backbone","core/lib/yammer_request","core/lib/util/authenticity_token","core/lib/location_helper","core/lib/namespace"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_base_class"),d=a("backbone"),e=a("core/lib/yammer_request"),f=a("core/lib/util/authenticity_token"),g=a("core/lib/location_helper"),h=a("core/lib/namespace"),i=c.extend({initialize:function(a){this.onDataChanged=a.onDataChanged,this.renderOpts={disableDelayLoad:!0,top:"suite-nav"},this._exposeLogoutMethodNamespace()},renderShell:function(a){d.trigger("/ui/masthead/load/finish",this._getNavHeight(a)),O365Shell.SetData(a),O365Shell.Render(this.renderOpts,function(){}),this._fixShellHeight(a),this._addDataChangedHandler()},_addDataChangedHandler:function(){O365Shell.OnDataChanged&&O365Shell.OnDataChanged(function(){this.onDataChanged()})},_getNavHeight:function(a){return a.Dimensions.Top},_isFallBackShell:function(a){var b=JSON.parse(a.ClientData);return b.IsFallbackShell},_fixShellHeight:function(a){var c=this._getNavHeight(a),d=this._isFallBackShell(a);d&&c&&b("#"+this.renderOpts.top).height(c)},_exposeLogoutMethodNamespace:function(){h.ns("yam.ui.o365NavMenuActions",{logout:function(a){e.send({type:"POST",url:"/logout",data:{_method:"delete",authenticity_token:f.get()},complete:function(){a&&g.assign(a)}})}})}});return i}),define("components/suite_nav/src/element_hider",["require","core/lib/backbone_base_view","backbone"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("backbone"),d="yj-acc-hidden",e=b.extend({listenForSuiteNavLoad:function(){c.on("/ui/masthead/load/finish",this.hide,this),c.on("/ui/masthead/fallback",this.show,this)},show:function(){this.$el.removeClass(d)},hide:function(){this.$el.addClass(d)}});return e}),define("components/suite_nav/src/asset_cache",["require","core/lib/backbone_base_class","core/lib/i18n","core/lib/adapters/store_adapter"],function(a){"use strict";var b=a("core/lib/backbone_base_class"),c=a("core/lib/i18n"),d=a("core/lib/adapters/store_adapter"),e="suite-nav-data",f="suite-nav-urls",g=b.extend({cacheAssets:function(a,b){this.cachedShellData=a.shell_data,this.cachedUrls={expiry:b,shell_js:a.shell_js,shell_css:a.shell_css},d.set(e,this.cachedShellData),d.set(f,this.cachedUrls)},purge:function(){d.remove(e),d.remove(f)},isValid:function(){return this.cachedShellData=d.get(e),this.cachedUrls=d.get(f),this.isPopulated()&&this.isNotExpired()&&!this.changedLocale()},isPopulated:function(){return this.cachedUrls&&this.cachedShellData},isNotExpired:function(){return this.cachedUrls&&Date.now()<this.cachedUrls.expiry},changedLocale:function(){var a=c.getLocale(),b=d.get("locale");return a&&b&&a!==b},getUrls:function(){return this.cachedUrls=d.get(f),this.cachedUrls},getData:function(){return this.cachedShellData=d.get(e),this.cachedShellData},getHeight:function(){var a=this.cachedUrls&&this.cachedUrls.Dimensions;return a&&a.Top}});return g}),define("core/lib/util/timer",["require","core/lib/backbone_base_class"],function(a){"use strict";var b=a("core/lib/backbone_base_class");return b.extend({initialize:function(){this.startTimer()},startTimer:function(){this._startTime=this._getCurrentTime()},timeSinceStart:function(){var a=this._getCurrentTime()-this._startTime;return a},_getCurrentTime:function(){return Date.now()}})}),define("components/suite_nav/src/reporter",["require","core/lib/backbone_base_class","core/lib/report","core/lib/util/timer"],function(a){"use strict";var b=a("core/lib/backbone_base_class"),c=a("core/lib/report"),d=a("core/lib/util/timer"),e=b.extend({initialize:function(){this.timer=new d},reportLoadSuccess:function(a){this._reportDiagnosticEvent("success",a)},reportLoadError:function(a){this._reportDiagnosticEvent("error",a)},_reportDiagnosticEvent:function(a,b){var d=this.timer.timeSinceStart();c.event("suite_nav_diagnostics",{type:a,time_elapsed:d,label:b})}});return e}),define("components/suite_nav/src/suite_nav",["require","jquery","underscore","backbone","core/lib/session","core/lib/adapters/store_adapter","core/lib/yammer_request","./office365_shell","./element_hider","./asset_cache","./reporter","core/lib/i18n"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/session"),f=a("core/lib/adapters/store_adapter"),g=a("core/lib/yammer_request"),h=a("./office365_shell"),i=a("./element_hider"),j=a("./asset_cache"),k=a("./reporter"),l=a("core/lib/i18n"),m=3;return{run:function(a){this.polarisHost=a&&a.polarisHost;var c=new i({el:"#help-menu-item"}),d=new i({el:"#logout-menu-item"});c.listenForSuiteNavLoad(),d.listenForSuiteNavLoad(),this.assetCache=new j,this.assetTargetEl=b("head")[0],this.office365Shell=new h({onDataChanged:this.renderFromFreshAssets.bind(this)}),this.reporter=new k,this.startRender()},startRender:function(){this.assetCache.isValid()?this.renderFromCachedAssets():this.renderFromFreshAssets()},getCacheExpiryFromXHR:function(a){var b=a.getResponseHeader("cache-control"),c=b?b.match(/max-age=([\d]+)/):null,d=Date.now()+1e3*(c?parseInt(c[1],10):3600);return d},cacheFetchedAssets:function(a,b,c){this.fetchedAssets=!0;var d=this.getCacheExpiryFromXHR(c);try{this.assetCache.cacheAssets(a,d)}catch(a){this.reporter.reportLoadError("could not cache assets in localStorage")}},getPolarisUrl:function(){return this.polarisHost+"suite_nav.json"},renderFromFreshAssets:function(){var a=e.getCurrentUser().web_oauth_access_token,b={type:"post",url:this.getPolarisUrl(),data:{locale:"en-US",user_token:a},error:this.onPolarisError.bind(this),success:this.onPolarisSuccess.bind(this)},c=l.getLocale();f.set("locale",c),b.data.locale=c,g.send(b)},onPolarisSuccess:function(a,b,c){this.cacheFetchedAssets(a,b,c),this.renderFromCachedAssets()},onPolarisError:function(a){this.reporter.reportLoadError("polaris request returned an error ["+a.status+"]"),this.fallbackToMasthead()},renderFromCachedAssets:function(){var a=this.assetCache.getUrls();this.totalAssets=a.shell_js.length+a.shell_css.length,this.assetsLoaded=0,c.each(a.shell_js,this.loadScript,this),c.each(a.shell_css,this.appendLinkTag,this),this.failAfterTimeout()},failAfterTimeout:function(){setTimeout(c.bind(function(){this.assetsLoaded!==this.totalAssets&&(this.fetchedAssets?(this.reporter.reportLoadError("new assets failed to load"),this.fallbackToMasthead()):this.renderFromFreshAssets())},this),15e3)},fallbackToMasthead:function(){this.assetCache&&this.assetCache.purge(),d.trigger("/ui/masthead/fallback")},loadScript:function(a){b.ajax({url:a,dataType:"script",success:this.addRenderHandler.bind(this),error:this.onScriptLoadError.bind(this),timeout:this.onScriptLoadTimeout.bind(this)})},onScriptLoadError:function(){this.reporter.reportLoadError("getScript failed"),this.retry()},onScriptLoadTimeout:function(){this.reporter.reportLoadError("getScript timed out"),this.retry()},appendLinkTag:function(a){var b=document.createElement("link");b.href=a,b.rel="stylesheet",b.type="text/css",this.assetTargetEl.appendChild(b),this.addRenderHandler()},retry:function(){return this.assetsLoaded=0,this.retriesCount||(this.retriesCount=0),this.retriesCount++,this.retriesCount===m?this.fallbackToMasthead():void this.renderFromFreshAssets()},addRenderHandler:function(){if(!(++this.assetsLoaded<this.totalAssets)){var a=this.assetCache.getData();this.reporter.reportLoadSuccess("loaded successfully"),this.office365Shell.renderShell(a),setTimeout(this.updateAssetsForNextRender.bind(this),1e4)}},updateAssetsForNextRender:function(){var a=e.getCurrentUser().web_oauth_access_token,b=l.getLocale()||"en-US",c={type:"post",url:this.getPolarisUrl(),data:{locale:b,user_token:a},success:this.cacheFetchedAssets.bind(this)};g.send(c)},exists:function(){return b("#suite-nav").length>0}}}),define("css!common-ui/lib/ui/keyboard/keyboard_selection_manager",[],function(){}),define("common-ui/lib/ui/keyboard/keyboard_selection_manager",["require","jquery","backbone","components/suite_nav/src/suite_nav","css!common-ui/lib/ui/keyboard/keyboard_selection_manager"],function(a){var b=a("jquery"),c=a("backbone"),d=a("components/suite_nav/src/suite_nav");a("css!common-ui/lib/ui/keyboard/keyboard_selection_manager");var e='<div class="yj-kbdSelectionPointer zindex-t1"><span class="yamicon yamicon-right-arrow yj-blue"></span></div>',f=[".yj-feed-messages .yj-thread-list-item",".yj-inbox-list--messages .yj-inbox-list-item-preview",".yj-inbox-list--messages .yj-inbox-list-item"].join(","),g={init:function(){c.on("/ui/reflow/animate /feed/threads/redraw /ui/reflow/vertical",function(){this.moveArrow()},g),c.on("routeChange",function(){b(".yj-kbdSelectionPointer").remove()},g),c.on("/ui/reflow/animate /feed/threads/redraw",function(){b(".yj-kbdSelectionPointer").remove(),b(".yj-kbdSelected").removeClass("yj-kbdSelected")},g),b(document.body).on("focusin.keyboard_selection_manager",g.onFocusChange)},uninit:function(){c.off("/ui/reflow/animate /feed/threads/redraw /ui/reflow/vertical",null,g),c.off("routeChange",null,g),b(document.body).off("focusin.keyboard_selection_manager")},onFocusChange:function(){var a=g.getCurrent();if(a.length){var c=b(document.activeElement).closest(f);c.length&&c[0]!==a[0]&&(a.removeClass("yj-kbdSelected"),c.addClass("yj-kbdSelected"),g.moveArrow())}},getCurrent:function(){return b(".yj-kbdSelected")},moveArrow:function(){var a=b("body"),c=b(".yj-kbdSelected"),f=b(".yj-kbdSelectionPointer");if(c.is("*")){f.is("*")||(a.append(e),f=b(".yj-kbdSelectionPointer"));var g=c.offset();c.hasClass("yj-after-unseen")&&(g.top+=20),d.exists()?g.top+=32:g.top+=24,f.css({top:g.top,left:g.left-20})}},navigateDirection:function(a){var c=g.getCurrent(),d=c,e="next"===a?1:-1,h=b(f);if(h.length){var i=d[0]?b.inArray(d[0],h):-1,j=i+e;if(!(0>j||j>=h.length)){c.removeClass("yj-kbdSelected");var k=b(h[j]).addClass("yj-kbdSelected");k.find(".yj-acc-placeholder").first().focus();var l=b("html"),m=k.offset();m&&(m.top-=200,l.velocity("scroll",{offset:m.top,easing:"ease-out"},200)),g.moveArrow()}}}};return g}),define("common-ui/lib/ui/keyboard/keyboard_shortcut_recognizer",["require","underscore","jquery","core/lib/treatment"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/treatment"),e={13:8629,37:8592,38:8593,39:8594,40:8595,27:27},f=300,g={_handleInput:function(a){if(d.treatment("keyboard_ctrlalt")){if(a.metaKey||a.altKey&&!a.ctrlKey)return!0}else if(a.metaKey||a.ctrlKey||a.altKey)return!0;var e=a.target,g=e.nodeName.toLowerCase(),h=String.fromCharCode(a.keyCode?a.keyCode:a.charCode);if((13===a.keyCode||8629===a.keyCode)&&(c(a.target).hasClass("yj-btn")||"button"===g||"a"===g))return!0;if(d.treatment("keyboard_ctrlalt")){if(("textarea"===g||"input"===g)&&!a.ctrlKey)return!0}else if("textarea"===g||"input"===g)return!0;return this._sequenceTimeout&&clearTimeout(this._sequenceTimeout),d.treatment("keyboard_ctrlalt")&&a.ctrlKey&&!a.altKey&&(this._sequence+="^"),this._sequence+=h,this._commands[this._sequence]?(this._callback(this._commands[this._sequence]),this._sequence="",!1):(this._sequenceTimeout=setTimeout(b.bind(function(){this._sequence=""},this),f),d.treatment("keyboard_ctrlalt")?this._prefixes[this._sequence]?!1:(this._sequence="",!0):!0)},_generatePrefixes:function(a){var c={};return b.each(a,function(a){for(var b=0;b<a.sequence.length;b++)c[a.sequence.substr(0,b+1)]=!0}),c},_generateCommandMap:function(a){var c={};return b.each(a,function(a){c[a.sequence]=a.command}),c},init:function(a,g){this._commands=this._generateCommandMap(a),this._callback=g,this._sequence="",d.treatment("keyboard_ctrlalt")?(f=1e3,this._prefixes=this._generatePrefixes(a),c(document).off("keypress.shortcuts"),c(document).on("keypress.shortcuts",this._handleInput.bind(this)),c(document).off("keydown.shortcuts"),c(document).on("keydown.shortcuts",b.bind(function(a){if(e[a.keyCode])a.keyCode=e[a.keyCode];else{if(!(a.keyCode>=65&&a.keyCode<=90))return;a.keyCode=a.keyCode+32}return this._handleInput(a)},this))):(c(document).off("keypress.shortcuts"),c(document).on("keypress.shortcuts",this._handleInput.bind(this)),c(document).off("keydown.shortcuts"),c(document).on("keydown.shortcuts",b.bind(function(a){return e[a.keyCode]?(a.keyCode=e[a.keyCode],this._handleInput(a)):void 0},this)))},disable:function(){c(document).off(".shortcuts")}};return g}),define("css!common-ui/lib/ui/keyboard/keyboard_shortcut_lightbox",[],function(){}),define("stache!common-ui/lib/ui/keyboard/keyboard_shortcut_lightbox",["mustache"],function(a){var b='<div class="yj-kbd-help">\n  <div class="yj-kbd-help--table yj-clearfix">\n  {{#columns}}\n    <div class="yj-kbd-help--column">\n      {{#categories}}\n      <h2 class="yj-kbd-help--category">{{title}}</h2>\n        {{#shortcuts}}\n        <div>\n          <span class="yj-kbd-help--sequence">\n            {{#keys}}\n            <span class="yj-kbd-help--key">{{.}}</span>\n            {{/keys}}\n          </span>\n          <span class="yj-kbd-help--label">\n            {{title}}\n          </span>\n        </div>\n        {{/shortcuts}}\n      {{/categories}}\n    </div>\n  {{/columns}}\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/keyboard/keyboard_shortcut_lightbox",["require","underscore","jquery","backbone","core/lib/tr","core/lib/treatment","css!common-ui/lib/ui/keyboard/keyboard_shortcut_lightbox","html!./keyboard_shortcut_lightbox"],function(a){var b=a("underscore"),c=a("jquery"),d=a("backbone"),e=a("core/lib/tr"),f=a("core/lib/treatment"),g=3;a("css!common-ui/lib/ui/keyboard/keyboard_shortcut_lightbox");var h={_groupByField:function(a,c){var d=[],e={};return b.each(a,function(a){if(a[c])if(e[a[c]])e[a[c]].items.push(a);else{var b={value:a[c],items:[a]};d.push(b),e[a[c]]=b}}),d},template:a("html!./keyboard_shortcut_lightbox"),_render:function(a){for(var c=this._groupByField(a,"group"),d=b.map(c,function(a){var c=a.value,d=a.items;return{title:c,shortcuts:b.map(d,function(a){var b=a.sequence.split("");return"^"===b[0]&&(b[0]="Ctrl+"),{keys:b,title:a.title}})}}),e=[],f=0;g>f;f++){var h=Math.floor(d.length*f/g),i=Math.floor(d.length*(f+1)/g);e.push({categories:d.slice(h,i)})}return this.template({columns:e})},_instructions:function(a){var d=c('<div class="yj-kbd-help" />'),e=this._groupByField(a,"group");return b.each(e,function(a){var e=a.value,f=a.items;if(e){var g=c("<table role='presentation'><tr><th colspan='2' role='heading' aria-level='2'>"+b.escape(e)+"</th></tr></table>");b.each(f,function(a){g.append("<tr><td class='shortcut'>"+a.sequence+"</td><td>"+b.escape(a.title)+"</td></tr>")}),d.append(g)}}),d.append(c('<br style="clear:both" />')),d},toggleLightbox:function(a){if(c(".yj-kbd-help").is(":visible"))return void d.trigger("/ui/lightbox/close");var b=f.treatment("keyboardshortcuts2")?this._render(a):this._instructions(a);d.trigger("/ui/lightbox/open",{html:b,title:e.t("keyboard_shortcuts")})}};return h}),define("common-ui/lib/ui/keyboard/keyboard_shortcuts",["require","underscore","jquery","backbone","core/lib/session","core/lib/tr","core/lib/treatment","core/lib/report","./keyboard_selection_manager","./keyboard_shortcut_recognizer","./keyboard_shortcut_lightbox"],function(a){var b=a("underscore"),c=a("jquery"),d=a("backbone"),e=a("core/lib/session"),f=a("core/lib/tr"),g=a("core/lib/treatment"),h=a("core/lib/report"),i=a("./keyboard_selection_manager"),j=a("./keyboard_shortcut_recognizer"),k=a("./keyboard_shortcut_lightbox"),l=b.extend({_goTo:function(a){window.location="/"+e.getCurrentNetwork().permalink+a},_commands:[{sequence:"/",title:f.t("search"),command:"go_search",group:f.t("site_wide")},{sequence:".",title:f.t("refresh_feed"),command:"refresh_feed",group:f.t("feed")},{sequence:"?",title:f.t("show_keyboard_shortcuts"),command:"show_keyboard_shortcuts",group:f.t("site_wide")},{sequence:"c",title:f.t("compose_a_message"),command:"compose",group:f.t("feed")},{sequence:"gh",title:f.t("go_to_home"),command:"go_home",group:f.t("site_navigation")},{sequence:"gi",title:f.t("go_to_inbox"),command:"go_inbox",group:f.t("site_navigation")},{sequence:"gm",title:f.t("go_to_inbox"),command:"go_inbox"},{sequence:"gc",title:f.t("go_to_all_company"),command:"go_all_company",group:f.t("site_navigation")},{sequence:"gn",title:f.t("open_notifications"),command:"go_notifications",group:f.t("site_navigation")},{sequence:"k",title:f.t("navigate_up"),command:"nav_prev",group:f.t("site_wide")},{sequence:"j",title:f.t("navigate_down"),command:"nav_next",group:f.t("site_wide")},{sequence:"↵",title:f.t("expand_item"),command:"item_expand",group:f.t("messages")},{sequence:"r",title:f.t("reply_to_current_message"),command:"item_reply",group:f.t("feed")},{sequence:"+",title:f.t("like_current_message"),command:"item_toggle_like",group:f.t("feed")},{sequence:"t",title:f.t("add_topic"),command:"item_add_topic",group:f.t("feed")},{sequence:"u",title:g.usePriorityCopy()?f.t("mark_as_priority"):f.t("mark_as_unread"),command:"item_toggle_unread",group:f.t("inbox_message")},{sequence:"y",title:f.t("remove_from_inbox"),command:"item_unfollow",group:f.t("inbox_message")}],_newCommands:[{sequence:"m",title:"Previous Reply",command:"nav_prev_reply",group:f.t("feed")},{sequence:"n",title:"Next Reply",command:"nav_next_reply",group:f.t("feed")},{sequence:"ak",title:"Previous Attachment",command:"nav_prev_attachment",group:f.t("feed")},{sequence:"aj",title:"Next Attachment",command:"nav_next_attachment",group:f.t("feed")},{sequence:"l",title:f.t("expand_item"),command:"item_expand",group:f.t("messages")},{sequence:"go",title:"Go to Online Now",command:"chat_list",group:"Online Now"},{sequence:"^,",title:"Previous Chat Window",command:"chat_prev",group:"Online Now"},{sequence:"^.",title:"Next Chat Window",command:"chat_next",group:"Online Now"},{sequence:"gj",title:"Go to Next group",command:"group_next",group:f.t("site_wide")},{sequence:"gk",title:"Go to Previous group",command:"group_prev",group:f.t("site_wide")},{sequence:"gu",title:"Go to Next group with unread items",command:"group_next_unread",group:f.t("site_wide")}],_deprecatedCommands:["gm","↵"],_oldCommandBindings:{go_search:function(){return c("#search").focus().select(),!1},refresh_feed:function(){d.trigger("/feed/threads/redraw")},show_keyboard_shortcuts:function(){k.toggleLightbox(this._commands)},compose:function(){return c(".yj-global-thread-starter-publisher .publisher-placeholder").click(),!1},go_home:function(){this._goTo("/#/home")},go_inbox:function(){this._goTo("/#/inbox/index")},go_all_company:function(){this._goTo("/#/threads/company?type=general")},go_notifications:function(){c(".yj-notifications-menu").click()},nav_prev:function(){i.navigateDirection("prev")},nav_next:function(){i.navigateDirection("next")},item_expand:function(){var a=i.getCurrent();if(0!==a.length){var b=a.click().find(".yj-thread-list-item--older-replies-link:visible");if(0!==b.length)return b.click(),!1}},item_reply:function(){return i.getCurrent().find(".yj-reply").click(),!1},item_toggle_like:function(){i.getCurrent().find(".yj-like").first().click(),i.moveArrow()},item_add_topic:function(){var a=i.getCurrent();return a.trigger({type:"addTopic",active:!0}),setTimeout(function(){a.find(".yj-add-topic").focus()},10),!1},item_toggle_unread:function(){this.trigger("markAsUnread")},item_unfollow:function(){this.trigger("removeFromInbox")}},_newCommandBindings:{refresh_feed:function(){d.trigger("/feed/threads/redraw")},show_keyboard_shortcuts:function(){k.toggleLightbox(this._commands)},compose:function(){return c(".yj-global-thread-starter-publisher .publisher-placeholder").click(),!1}},_performCommand:function(a){h.event("keyboard_command",{command:a}),g.treatment("keyboardshortcuts2")?this._newCommandBindings[a]?this._newCommandBindings[a].apply(this):this.trigger(a):this._oldCommandBindings[a].apply(this)},disable:function(){j.disable()},init:function(){g.treatment("keyboardshortcuts2")?(this._commands=this._commands.concat(this._newCommands),b.each(this._deprecatedCommands,function(a){var c=b.findWhere(this._commands,{sequence:a}),d=this._commands.indexOf(c);this._commands.splice(d,1)},this),c(document.body).addClass("keyboardshortcuts2")):i.init(),j.init(this._commands,this._performCommand.bind(this))}},d.Events);return d.on("/keyboard/shortcuts",b.once(function(){l.init()})),l}),define("workfeed/lib/app/global_search",["require","underscore","core/lib/backbone_base_view","core/lib/report","common-ui/lib/ui/shared/type_ahead","core/lib/location_helper","core/lib/urls","core/lib/yammer_uri","core/lib/uri_helper","common-ui/lib/ui/keyboard/keyboard_shortcuts"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/report"),e=a("common-ui/lib/ui/shared/type_ahead"),f=a("core/lib/location_helper"),g=a("core/lib/urls"),h=a("core/lib/yammer_uri"),i=a("core/lib/uri_helper"),j=a("common-ui/lib/ui/keyboard/keyboard_shortcuts"),k={"max 7":{},"max 8":{},"max 9":{},"max 10":{}},l=k["max 7"],m=k["max 8"],n=k["max 9"],o=k["max 10"];l[e.MODEL_USER]=3,l[e.MODEL_GROUP]=2,l[e.MODEL_FILE]=1,l[e.MODEL_PAGE]=1,l[e.MODEL_TOPIC]=0,l[e.MODEL_OGO]=0,m[e.MODEL_USER]=3,m[e.MODEL_GROUP]=2,m[e.MODEL_FILE]=1,m[e.MODEL_PAGE]=1,m[e.MODEL_TOPIC]=0,m[e.MODEL_OGO]=1,n[e.MODEL_USER]=3,n[e.MODEL_GROUP]=2,n[e.MODEL_FILE]=1,n[e.MODEL_PAGE]=1,n[e.MODEL_TOPIC]=0,n[e.MODEL_OGO]=2,o[e.MODEL_USER]=3,o[e.MODEL_GROUP]=2,o[e.MODEL_FILE]=1,o[e.MODEL_PAGE]=1,o[e.MODEL_TOPIC]=1,o[e.MODEL_OGO]=2;var p={hintMessage:"",styles:"search",inline:!0,allowNoMatch:!0,width:361,headerTruncationLength:14,completableModels:[e.MODEL_USER,e.MODEL_PENDINGUSER,e.MODEL_GROUP,e.MODEL_FILE,e.MODEL_PAGE,e.MODEL_TOPIC,e.MODEL_OGO],noResultsAction:!0,earlyModelResults:k["max 10"],maxResults:10,selectFirst:!1,truncate:!0,noResultsMessage:"",customClassName:"search-peopletagger",allowForeignUsers:!0,additionalOption:function(){return e.defaultAdditionalOption()}};return c.extend({id:"search",tagName:"input",className:"yj-nav-menu--search-input yk-form-control",attributes:function(){return{type:"text",name:"search",maxlength:"500","aria-autocomplete":"list","aria-haspopup":"true",placeholder:this.options.placeholder}},events:{click:"_clickHandler"},initialize:function(){p.onSelect=this.onSelect.bind(this),p.onNoSelection=this.additionalSearch.bind(this),p.onEnter=this.additionalSearch.bind(this),p.onAdditional=this.additionalSearch.bind(this),p.getSearchText=this.getSearchText.bind(this),this._registerTypeAhead(p),this._setupResponsiveResults(),this.listenTo(j,"go_search",this._goSearch.bind(this))},_registerTypeAhead:function(a){e.registerField(this.$el,a)},_setupResponsiveResults:function(){this._setupMaxResults(),this._debouncedSetupMaxResults=b.debounce(this._setupMaxResults.bind(this),100),$(window).on("resize.globalSearch",b.bind(function(){this.$el.is(":focus")&&e.hide(),this._debouncedSetupMaxResults()},this))},_setupMaxResults:function(){var a=$(window).height(),b={};660>a?b={maxResults:7,earlyModelResults:k["max 7"]}:a>=660&&720>a?b={maxResults:8,earlyModelResults:k["max 8"]}:a>=720&&780>a?b={maxResults:9,earlyModelResults:k["max 9"]}:a>=780&&(b={maxResults:10,earlyModelResults:k["max 10"]}),e.updateField(this.$el,b)},remove:function(){return $(window).off("resize.globalSearch"),c.prototype.remove.call(this)},onSelect:function(a){
var c,d=this.$el.val().length,h="number"==typeof a.index?a.index:0;c=g.indexForModel(a),c+=c.indexOf("?")>=0?"&":"?",c+=i.paramify({trk_event:"search_ac",trk_model:a.type,trk_len:d,trk_pos:h}),f.assign(c),b.defer(function(){e.activate.apply(e)})},getSearchText:function(){return this._formatSearchText(this.$el.val())},additionalSearch:function(){f.assign(h.app("/#/Threads/Search?search="+window.encodeURIComponent(this._formatSearchText(this.$el.val()))))},val:function(){return this.$el.val.apply(this.$el,arguments)},_formatSearchText:function(a){return a.replace(/ +(?= )/g,"").trim()},_clickHandler:function(){d.event("global_search_start")},_goSearch:function(){this.$el.focus()}})}),define("models/lib/client/realtime_notifications_client",["require","underscore","models/lib/client/base_realtime_client","core/lib/yammer_uri","core/lib/ctor","backbone","core/lib/session"],function(a){var b=a("underscore"),c=a("models/lib/client/base_realtime_client"),d=a("core/lib/yammer_uri"),e=a("core/lib/ctor"),f=a("backbone"),g=a("core/lib/session");return e(null,c,{THROTTLE_PERIOD:5e3,NOTIFICATIONS_COUNTS_UNREAD_API:d.api("/streams/notifications/counts/unread"),init:function(a){c.prototype.init.call(this,a),this._userId=a.user_id,this._sendRequestOptions={success:this._success.bind(this),error:this._error.bind(this)},this.sendRequest=b.throttle(this.sendRequest,void 0===a.THROTTLE_PERIOD?this.THROTTLE_PERIOD:a.THROTTLE_PERIOD)},onProcessFirstRestData:function(a){this._success(a)},onRealtimeData:function(){this.sendRequest(this._sendRequestOptions)},getUrl:function(){return this.NOTIFICATIONS_COUNTS_UNREAD_API},_success:function(a){g.getCurrentNetwork().update({unseen_notification_count:a.count})},_error:function(a){f.trigger("/message/error",a)},getChannels:function(){var a=["/users/"+this._userId+"/current"];return a}})}),define("stache!components/header_navigation/src/header_navigation",["mustache"],function(a){var b='<div class="yk-row">\n  <div class="yk-col-sm-5 yk-col-md-6 yk-col-lg-7">\n    <h2 class="yj-acc-hidden">\n      <span>{{nav_accessibility_label}}</span>\n    </h2>\n    <ul class="yj-nav-menu--primary-actions">\n\n      <li class="yj-nav-menu--primary-actions-item yj-nav-menu--primary-actions-home yj-header-menu-item" data-qaid="home_button">\n        <a href="{{home_url}}" class="yj-nav-menu--primary-actions-link" title="{{home_label}}" data-speechtip>\n          <span class="yj-nav-menu--primary-actions-icon yamicon yamicon-rd_home yk-yamicon-m"></span>\n          <span class=\'yj-acc-hidden\'>{{home_label}}</span>\n        </a>\n      </li>\n\n      <li class="yj-nav-menu--primary-actions-item yj-nav-menu--primary-actions-inbox yj-header-menu-item" data-qaid="inbox_button" title="{{inbox_label}}">\n        <a href="{{inbox_url}}" class="yj-nav-menu--primary-actions-link yj-nav-menu--primary-actions-inbox-link" data-speechtip="{{inbox_label}}">\n          <span class="yj-nav-menu--primary-actions-icon yamicon yamicon-rd_inbox yk-yamicon-m"></span>\n          <span class=\'yj-acc-hidden\'>{{inbox_label}}</span>\n          <span class="unread-count yk-badge is-hidden"></span>\n        </a>\n      </li>\n\n      <li id="notifications-jewel" class="yj-nav-menu--primary-actions-item yj-nav-menu--primary-actions-notifications yj-header-menu-item" data-qaid="notifications_button" title="{{notifications_label}}">\n        <a href="{{notifications_url}}" class="yj-nav-menu--primary-actions-link yj-nav-menu--primary-actions-notifications-link" data-speechtip="{{notifications_label}}">\n          <span class="yj-header-navigation--jewel-text yj-acc-hidden">{{notifications_label}}</span>\n          <span class="yj-header-navigation--jewel-badge is-hidden" data-qaid="notifications_unread_count_label"></span>\n          <span class="yj-nav-menu--primary-actions-icon yamicon yamicon-rd_notifications yk-yamicon-m"></span>\n        </a>\n      </li>\n\n      <li id="actions-list" class="yj-nav-menu--primary-actions-item yj-nav-menu--primary-actions-drop-down actions">\n        <a href="javascript://" class="yj-nav-menu--primary-actions-link yj-nav-menu--primary-actions-ellipsis-link yj-simple-click-menu-trigger" data-qaid="ellipsis_menu_button" aria-haspopup="true" role="button" data-speechtip>\n          <span class="yj-nav-menu--primary-actions-icon yamicon yamicon-ellipsis yk-yamicon-m"></span>\n          <span class="yj-header-navigation--jewel-text yj-acc-hidden">{{more_label}}</span>\n        </a>\n        <ul class="yj-click-menu yj-nav-menu--primary-actions-drop-down-list">\n\n          {{#can_invite}}\n          <li class="yj-nav-menu--primary-actions-drop-down-item">\n            <a href="{{invite_url}}" class="yj-nav-menu--drop-down-invite yj-nav-menu--primary-actions-drop-link" data-qaid="ellipsis_menu_invite_link">\n              <span class="yj-nav-menu--drop-down-icon yamicon yamicon-rd_invite_user yk-yamicon-m"></span>\n              <strong>{{invite_label}}</strong>\n            </a>\n          </li>\n          {{/can_invite}}\n\n          <li class="yj-nav-menu--primary-actions-drop-down-item">\n            <a href="{{groups_url}}" class="yj-nav-menu--drop-down-groups yj-nav-menu--primary-actions-drop-link" data-qaid="ellipsis_menu_group_link">\n              <span class="yj-nav-menu--drop-down-icon yamicon yamicon-rd_groups yk-yamicon-m"></span>\n              <strong>{{groups_label}}</strong>\n            </a>\n          </li>\n          <li class="yj-nav-menu--primary-actions-drop-down-item">\n            <a href="{{users_url}}" class="yj-nav-menu--drop-down-users yj-nav-menu--primary-actions-drop-link" data-qaid="ellipsis_menu_people_link">\n              <span class="yj-nav-menu--drop-down-icon yamicon yamicon-rd_people yk-yamicon-m"></span>\n              <strong>{{users_label}}</strong>\n            </a>\n          </li>\n          <li class="yj-nav-menu--primary-actions-drop-down-item">\n            <a href="{{files_url}}" class="yj-nav-menu--drop-down-files yj-nav-menu--primary-actions-drop-link" data-qaid="ellipsis_menu_files_link">\n              <span class="yj-nav-menu--drop-down-icon yamicon yamicon-rd_attach yk-yamicon-m"></span>\n              <strong>{{files_label}}</strong>\n            </a>\n          </li>\n          <li class="yj-nav-menu--primary-actions-drop-down-item">\n            <a href="{{apps_url}}" class="yj-nav-menu--drop-down-apps yj-nav-menu--primary-actions-drop-link" data-qaid="ellipsis_menu_apps_link">\n              <span class="yj-nav-menu--drop-down-icon yamicon yamicon-rd_apps yk-yamicon-m"></span>\n              <strong>{{apps_label}}</strong>\n            </a>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </div>\n</div>\n<div class="yk-row">\n  <div class="yk-col-sm-5 yk-col-md-6 yk-col-lg-7">\n    <div class="yj-nav-menu--search" role="search">\n      <h2 class="yj-acc-hidden">\n        <label class="yj-acc-hidden" for="search">{{redesign_search_placeholder}}</label>\n      </h2>\n      <GlobalSearchView data-placeholder="{{redesign_search_placeholder}}" />\n      <span class="yj-nav-menu--search-icon yamicon yamicon-rd_search yk-yamicon-m yj-dark-gray-light"></span>\n    </div>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/header_navigation/src/header_navigation",[],function(){}),define("components/header_navigation/src/header_navigation",["require","underscore","backbone","models/lib/events","models/lib/helper/feed_factory","models/lib/orm-models","core/lib/session","core/lib/tr","core/lib/treatment","core/lib/yammer_uri","common-ui/lib/ui/keyboard/keyboard_shortcuts","core/lib/location_helper","models/helpers/user","models/helpers/network","core/lib/urls","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","workfeed/lib/app/global_search","models/lib/client/realtime_notifications_client","html!./header_navigation","css!./header_navigation"],function(a){"use strict";var b=a("underscore"),c=a("backbone"),d=a("models/lib/events"),e=a("models/lib/helper/feed_factory"),f=a("models/lib/orm-models"),g=a("core/lib/session"),h=a("core/lib/tr"),i=a("core/lib/treatment"),j=a("core/lib/yammer_uri"),k=a("common-ui/lib/ui/keyboard/keyboard_shortcuts"),l=a("core/lib/location_helper"),m=a("models/helpers/user"),n=a("models/helpers/network"),o=a("core/lib/urls"),p=a("core/lib/backbone_base_view"),q=a("core/lib/backbone_with_auto_render"),r=a("core/lib/backbone_with_subviews"),s=a("workfeed/lib/app/global_search"),t=a("models/lib/client/realtime_notifications_client"),u=a("html!./header_navigation");a("css!./header_navigation");var v={nav_accessibility_label:h.t("redesign_nav_accessibility_label"),home_label:h.t("header_nav_home"),inbox_label:h.t("header_nav_inbox"),search_placeholder:h.t("header_nav_search_placeholder"),redesign_search_placeholder:h.t("redesign_header_nav_search_placeholder"),invite_label:h.t("header_nav_invite"),more_label:h.t("header_nav_more"),groups_label:h.t("header_nav_groups"),users_label:h.t("header_nav_users"),files_label:h.t("header_nav_files"),apps_label:h.t("header_nav_apps"),settings_label:h.t("header_nav_settings"),admin_label:h.t("header_nav_admin"),client_apps_label:h.t("header_nav_client_apps"),help_label:h.t("header_nav_help"),logout_label:h.t("header_nav_logout")},w=p.extend({mixins:[q,r],className:"yj-header-navigation",template:u,views:{GlobalSearchView:"_getGlobalSearch"},initialize:function(){this.user=g.getCurrentUser(),this.network=g.getCurrentNetwork(),this.inboxUnreadFeed=e.findOrCreate("inboxUnread"),this.listenTo(d,"Feed/"+this.inboxUnreadFeed.id+"/update",this._updateInboxCount),this.listenToOnce(c,"initialRoute",this._onViewChanged),this.listenTo(c,"routeChange",this._onViewChanged),this.listenTo(c,"/ui/nav/activeViewChange",this._activateTab.bind(this)),this.listenTo(k,"go_home",this._goHome),this.listenTo(k,"go_inbox",this._goInbox),this.listenTo(k,"go_notifications",this._goNotifications),this.realtimeNotificationsClient=new t({user_id:this.user.id})},render:function(){return this.realtimeNotificationsClient.start(),this._updateInboxCount(),this._updateNotificationsCount(),this},getTemplateData:function(){return v.redesign_search_placeholder=h.t("redesign_header_nav_search_placeholder"),i.usePriorityCopy()&&(v.inbox_label=h.t("header_nav_priority_conversations")),b.extend({is_admin:m.isAdmin(this.user),can_invite:m.isAdmin(this.user)||!n.isModerated(this.network),home_url:j.app("/#/home"),inbox_url:j.app("/#/inbox/index"),notifications_url:j.app("/#/notifications/index",{type:"notifications"}),search_url:j.app("/search"),invite_url:j.app("/#/invitations/by_email",{from:"nav"}),groups_url:o.groups(),users_url:j.app("/users",{from:"nav"}),files_url:j.app("/files",{from:"nav"}),apps_url:j.app("/apps",{from:"nav"}),settings_url:j.app("/account/profile_info",{from:"nav"}),admin_url:j.app("/admin",{from:"nav"}),client_apps_url:j.app("/client_applications",{from:"nav"}),help_url:"http://community.office365.com/en-us/wikis/yammer/default.aspx",logout_url:j.app("/logout",{from:"nav"})},v)},_getGlobalSearch:function(a,b){return new s({placeholder:b("placeholder")})},_updateInboxCount:function(){var a=this.$(".yj-nav-menu--primary-actions-inbox .yk-badge"),b=this.inboxUnreadFeed.getUnseenCount();b>0?a.text(b).removeClass("is-hidden"):a.text("").addClass("is-hidden")},_updateNotificationsCount:function(){f.Count().getCounter("notifications",function(a){this._updateNotificationsWithCount(a)}.bind(this))},_updateNotificationsWithCount:function(a){var b=this.$("#notifications-jewel .yj-header-navigation--jewel-badge");a>0?b.text(a).removeClass("is-hidden"):b.text("").addClass("is-hidden")},_onViewChanged:function(a){var b=a.headerNavigationTab;"threadsShow"!==a.id&&this._activateTab(b)},_activateTab:function(a){this.$(".yj-nav-menu--primary-actions-item").removeClass("is-active"),this.$(".yj-nav-menu--primary-actions-"+a).addClass("is-active")},_goHome:function(){l.assign(j.app("/#/home"))},_goInbox:function(){l.assign(j.app("/#/inbox/index"))},_goNotifications:function(){this.$(".yj-nav-menu--primary-actions-notifications-link").click()}});return w}),define("components/header_navigation/index",["require","./src/header_navigation"],function(a){"use strict";var b=a("./src/header_navigation");return b}),define("stache!feeds/lib/ui/groups/group_navigation",["mustache"],function(a){var b="<InternalGroupsView/>\n{{#showExternalGroups}}\n<ExternalGroupsView/>\n{{/showExternalGroups}}\n{{#showExternalGroupsBanner}}\n<ExternalGroupsBanner/>\n{{/showExternalGroupsBanner}}\n<GroupNavigationActions>\n";return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/groups/external_groups_more_info",["mustache"],function(a){var b='<div class="yj-external-groups-more-info--header">\n  <div class="yj-external-groups-more-info--header-title">{{title}}</div>\n  <div class="yj-external-groups-more-info--header-text">{{titleDescription}}</div>\n  <div class="yj-external-groups-more-info--header-icon-area">\n    {{{titleIcon}}}\n  </div>\n</div>\n<div class="yj-external-groups-more-info--subsection">\n  <div class="yj-external-groups-more-info--subsection-title-area">\n    <span class="yamicon yamicon-rd_timesave yj-external-groups-more-info--icon"></span>\n    <span class="yj-external-groups-more-info--subsection-title">{{saveTimeSectionTitle}}</span>\n  </div>\n  <div class="yj-external-groups-more-info--subsection-text">{{saveTimeSectionText}}</div>\n</div>\n<div class="yj-external-groups-more-info--subsection">\n  <div class="yj-external-groups-more-info--subsection-title-area">\n    <span class="yamicon yamicon-rd_groups yj-external-groups-more-info--icon"></span>\n    <span class="yj-external-groups-more-info--subsection-title">{{betterTeamsSectionTitle}}</span>\n  </div>\n  <div class="yj-external-groups-more-info--subsection-text">{{betterTeamsSectionText}}</div>\n</div>\n<div class="yj-external-groups-more-info--subsection">\n  <div class="yj-external-groups-more-info--subsection-title-area">\n    <span class="yamicon yamicon-rd_shield yj-external-groups-more-info--icon"></span>\n    <span class="yj-external-groups-more-info--subsection-title">{{privacySectionTitle}}</span>\n  </div>\n  <div class="yj-external-groups-more-info--subsection-text">{{privacySectionText}}</div>\n</div>\n<div class="yj-external-groups-more-info--actions">\n  <button class="yj-external-group-more-info--button yj-external-groups-more-info--create-group-action">{{createExternalGroupButtonLabel}}</button>\n  <button class="yj-external-group-more-info--button yj-external-groups-more-info--close-action">{{stopShowingInfoButtonLabel}}</button>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/groups/external_groups_more_info",[],function(){}),define("feeds/lib/ui/groups/external_groups_more_info",["require","underscore","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","backbone","core/lib/tr","common-ui/lib/helper/svg_icon","html!./external_groups_more_info","css!./external_groups_more_info"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("backbone"),f=a("core/lib/tr"),g=a("common-ui/lib/helper/svg_icon"),h=a("html!./external_groups_more_info");return a("css!./external_groups_more_info"),d.extend({mixins:[c],template:h,className:"yj-external-groups-more-info",events:{"click .yj-external-groups-more-info--create-group-action":"_close","click .yj-external-groups-more-info--close-action":"_close"},getTemplateData:function(){return b.extend({titleIcon:g("network-clouds",{width:110,height:72})},this._getStrings())},onComplete:function(){e.trigger("/ui/lightbox/create_group/register_trigger",".yj-external-groups-more-info--create-group-action","external")},_getStrings:function(){return{title:f.t("external_groups_more_info_title"),titleDescription:f.t("external_groups_more_info_title_desc"),saveTimeSectionTitle:f.t("external_groups_more_info_save_time_title"),saveTimeSectionText:f.t("external_groups_more_info_save_time_text"),betterTeamsSectionTitle:f.t("external_groups_more_info_better_teams_title"),betterTeamsSectionText:f.t("external_groups_more_info_better_teams_text"),privacySectionTitle:f.t("external_groups_more_info_privacy_title"),privacySectionText:f.t("external_groups_more_info_privacy_text"),createExternalGroupButtonLabel:f.t("external_groups_more_info_create_group"),stopShowingInfoButtonLabel:f.t("external_groups_more_info_stop_showing")}},_close:function(){this.trigger("close")}})}),define("stache!feeds/lib/ui/groups/external_groups_banner",["mustache"],function(a){var b='<div class="yj-external-groups-banner--header">\n  <div class="yj-external-groups-banner--network-icon yamicon yamicon-network big-network-icon"></div>\n  <div class="yj-external-groups-banner--title">{{title}}</div>\n  <button class="yj-external-groups-banner--close-button unstyle-button-as-span" data-speechtip>\n    <span class="yj-external-groups-banner--close-icon yamicon yamicon-x yamicon-xx-small"></span>\n    <span class="yj-acc-hidden">{{closeAltText}}<span>\n  </button>\n</div>\n<div class="yj-external-groups-banner--body">\n  <p class="yj-external-groups-banner--body-message">{{{message}}}</p>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/groups/external_groups_banner",[],function(){}),define("feeds/lib/ui/groups/external_groups_banner",["require","underscore","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","collections/banners","core/lib/tr","feeds/lib/ui/groups/external_groups_more_info","components/simple_lightbox/index","html!feeds/lib/ui/groups/external_groups_banner","css!feeds/lib/ui/groups/external_groups_banner"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("collections/banners"),f=a("core/lib/tr"),g=a("feeds/lib/ui/groups/external_groups_more_info"),h=a("components/simple_lightbox/index"),i=a("html!feeds/lib/ui/groups/external_groups_banner");a("css!feeds/lib/ui/groups/external_groups_banner");var j="external-group-banner";return d.extend({mixins:[c],events:{"click .yj-external-groups-banner--close-button":"_handleClose","click .yj-external-groups-banner--learn-more":"_handleLearnMore"},template:i,className:"yj-nav-menu--external-groups-banner",initialize:function(a){this.model=a.model||e.getOrFetch(j),this.listenTo(this.model,"change",this.render)},getTemplateData:function(){return{title:f.t("external_groups"),message:f.t("external_groups_banner_text",{link:'<a href="javascript://" class="yj-external-groups-banner--learn-more">{$0}</a>'}),closeAltText:f.t("close")}},render:function(){return this._isHidden()?this.$el.addClass("yj-hidden"):this.$el.removeClass("yj-hidden"),this},remove:function(){return this.lightbox&&this.lightbox.remove(),d.prototype.remove.call(this)},_isHidden:function(){return null!=this.model.isOptedOut()?this.model.isOptedOut():!0},_handleClose:function(){this.model.optOut()},_handleLearnMore:function(a){a.preventDefault();var c=new g;this.lightbox=new h({component:c,onComplete:b.bind(c.onComplete,c)}),this.lightbox.show()}},{BANNER_NAME:j})}),define("stache!feeds/lib/ui/groups/group_navigation_headed_group_list",["mustache"],function(a){var b='<GroupHeaderView/>\n<ul class="yj-nav-list yj-group-nav-list yj-nav-menu--group-list">\n{{#groups}}\n<GroupNavigationItemView key="{{.}}" />\n{{/groups}}\n{{#showAllCompany}}\n<AllCompanyNavigationItemView key="general" />\n{{/showAllCompany}}\n{{#showMoreGroups}}\n<li class="yj-nav-menu--group-item" title="{{getMoreGroupsTitle}}">\n  <a href="javascript://" class="yj-nav-menu--group-item-link yj-nav-menu--show-all-groups-link"\n  role="button">\n    <span class="yj-nav-menu--group-item-text">{{getMoreGroupsText}}</span>\n  </a>\n</li>\n{{/showMoreGroups}}\n</ul>';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/groups/groups_header",["mustache"],function(a){var b='<h4 class="yj-nav-menu--group-header-link" role="heading" aria-level="2">\n  <a href="{{url}}" class="yj-nav-menu--group-header-link suggested-groups-lightbox" title="{{title}}" data-qaid="suggested_groups_link">\n    {{^externalGroupsRestyleEnabled}}<span class="yamicon yamicon-rd_groups yk-yamicon-m"></span>{{/externalGroupsRestyleEnabled}}\n    <strong>{{label}}</strong>\n  </a>\n</h4>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/groups/groups_header",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!./groups_header"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("html!./groups_header");return c.extend({mixins:[d,e],template:f,tagName:"div",className:"yj-nav-menu--group-header",getTemplateData:function(){var a=b.extend({},this.options);return a.externalGroupsRestyleEnabled=!0,a}})}),define("stache!feeds/lib/ui/groups/group_navigation_item",["mustache"],function(a){var b='<span title="{{title}}">\n  <a href="{{url}}" class="yj-nav-menu--group-item-link">\n    <span class="yj-nav-menu--group-item-text">\n      <span class="yj-nav-menu--group-item-text-group">{{model.full_name}}</span><NetworkLabel/>\n    </span>\n  <span class="yj-acc-selectedstate"></span>\n  <GroupActivityView key="activity" />\n  </a>\n</span>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/groups/group_activity/group_activity",[],function(){}),define("stache!feeds/lib/ui/groups/group_activity/group_activity_avatars",["mustache"],function(a){var b='{{#users}}\n  <AvatarView key="{{.}}" />\n{{/users}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/groups/group_activity/group_activity_avatars",[],function(){}),define("css!feeds/lib/ui/groups/group_activity/slide_avatar",[],function(){}),define("stache!feeds/lib/ui/groups/group_activity/slide_avatar",["mustache"],function(a){var b='<img class="yj-slide-avatar--avatar" src="{{url}}"></img>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/groups/group_activity/slide_avatar",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","css!./slide_avatar","html!./slide_avatar"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render");return a("css!./slide_avatar"),b.extend({mixins:[c],template:a("html!./slide_avatar"),tagName:"li",className:"yj-slide-avatar",getTemplateData:function(){return{url:this.options.url}}})}),define("feeds/lib/ui/groups/group_activity/group_activity_avatars",["require","core/lib/backbone_base_view","html!./group_activity_avatars","css!./group_activity_avatars","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./slide_avatar"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("html!./group_activity_avatars");a("css!./group_activity_avatars");var d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("./slide_avatar");return b.extend({mixins:[d,e],defaults:{avatarWidth:21,slideVelocity:500,persistTime:4e3},template:c,tagName:"ul",className:"yj-group-activity-avatars",views:{AvatarView:"_getAvatar"},initialize:function(a){var b=(a.slideVelocity/1e3).toString()+"s";this.$el.css("margin-left",this.options.containerWidth+"px"),this.$el.css("transition","margin-left "+b+" ease")},getTemplateData:function(){return{users:this.options.users}},_getAvatar:function(a){return new f({url:a})},slide:function(){var a=this,b=this.$el,c=this.options.avatarWidth*this.options.users.length+6,d=this.options.containerWidth-c+"px";setTimeout(function(){b.css("margin-left",d)},0),setTimeout(function(){b.css("margin-left",a.options.containerWidth+"px")},this.options.persistTime)}})}),define("stache!feeds/lib/ui/groups/group_activity/highlighted_badge",["mustache"],function(a){var b='<div class="yj-highlighted-badge--arrow"></div>\n<div class="yj-highlighted-badge--main"><div class="yj-highlighted-badge--count"><div class="yj-highlighted-badge--new-count">{{newCount}}</div>\n{{#hasAnimationSupport}}\n  <div class="yj-highlighted-badge--counter">{{#prevCount}}{{prevCount}}{{/prevCount}}</div>\n{{/hasAnimationSupport}}\n{{^hasAnimationSupport}}\n  <div class="yj-highlighted-badge--counter">{{newCount}}</div>\n{{/hasAnimationSupport}}\n</div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/groups/group_activity/highlighted_badge",[],function(){}),define("feeds/lib/ui/groups/group_activity/highlighted_badge",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/helper/environment","html!./highlighted_badge","css!./highlighted_badge"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("common-ui/lib/helper/environment"),e=a("html!./highlighted_badge");return a("css!./highlighted_badge"),b.extend({mixins:[c],template:e,className:"yj-highlighted-badge",defaults:{persistTime:6e3,fadeInOutTime:250},getTemplateData:function(){return{prevCount:this.options.prevCount,newCount:this.options.newCount,hasAnimationSupport:d.hasAnimationSupport()}},initialize:function(){var a=(this.options.fadeInOutTime/1e3).toString()+"s";this.$el.css("transition","all "+a+" ease")},show:function(){var a=this.$el,b=a.find("."+this.className+"--main"),c=a.find("."+this.className+"--arrow");a.css("opacity","1"),setTimeout(function(){c.hide(),b.css("width","0"),a.css("right","8px")},this.options.persistTime)}})}),define("css!feeds/lib/ui/groups/group_activity/group_activity_slider",[],function(){}),define("stache!feeds/lib/ui/groups/group_activity/group_activity_slider",["mustache"],function(a){var b='<div class="yj-group-activity-slider--avatars"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/groups/group_activity/group_activity_slider",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./group_activity_avatars","./highlighted_badge","css!./group_activity_slider","html!./group_activity_slider"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./group_activity_avatars"),f=a("./highlighted_badge");return a("css!./group_activity_slider"),b.extend({mixins:[c,d],defaults:{removeDelay:1e4,avatarsContainerWidth:160},className:"yj-group-activity-slider",template:a("html!./group_activity_slider"),render:function(){var a,b,c=this.$(".yj-group-activity-slider--avatars");return c.css("width",this.options.avatarsContainerWidth),a=new f({prevCount:this.options.prevCount,newCount:this.options.newCount}),b=new e({containerWidth:this.options.avatarsContainerWidth,users:this.options.users.slice(0,5)}),this.$el.append(a.render().el),this.$(".yj-group-activity-slider--avatars").html(b.render().el),a.show(),b.slide(),setTimeout(this.remove.bind(this),this.options.removeDelay),this}})}),define("feeds/lib/ui/groups/group_activity/group_activity_helper",["require","underscore","core/lib/yammer_api","core/lib/session","core/lib/report","core/lib/treatment","core/lib/util/hydrant_helper"],function(a){"use strict";function b(a){var b=f.pluck(a.messages,"sender_id");b=f.uniq(b),b=e(b);var c=f.where(a.references,{type:"user"});try{if(0===b.length||0===c.length)throw new Error("Navatars mugshot issue: could not get sender IDs and/or user references")}catch(a){i.error({message:a.message},a)}return f.chain(b).map(function(a){return f.findWhere(c,{id:a})}).filter(function(a){return a&&a.mugshot_url}).map(function(a){return a.mugshot_url}).value()}function c(a){var b=f.first(a.threads)||{},c=f.pluck(b.messages,"sender_id");c=f.uniq(c),c=e(c);var d=a.reference_data&&a.reference_data.users;try{if(0===c.length||!d)throw new Error("Navatars mugshot issue: could not get sender IDs and/or user references")}catch(a){i.exception.add({message:a.message},a)}var g=a.url_templates&&a.url_templates.user_mugshot;return c.map(function(a){var b=d[a];return k.generateUrl(g,{width:48,height:48,mugshot_id:b&&b.mugshot_id})})}function d(a){return j.treatment("perf_hydrant_web_all_feeds")?c(a):b(a)}function e(a){var b=h.getCurrentUser(),c=b.id;return f.reject(a,function(a){return a===c})}var f=a("underscore"),g=a("core/lib/yammer_api"),h=a("core/lib/session"),i=a("core/lib/report"),j=a("core/lib/treatment"),k=a("core/lib/util/hydrant_helper");return{fetchMugshotUrlsInGroup:function(a){return g.getMugshotsInGroup(f.defaults(a,{exclude_own_messages_from_unseen:!0})).then(d)},fetchMugshotUrlsInAllCompany:function(a){return g.getMugshotsInAllCompany(f.defaults(a,{exclude_own_messages_from_unseen:!0})).then(d)},getMugshotUrlFromOrm:function(a){var b=[],c=a.getThreads(),d=f.first(c),e=d.getLastMessage(),g=e.getSender(),i=g.getUser(),j=h.getCurrentUser();return j.id!==i.id&&b.push(i.get("mugshot_url")),b}}}),define("stache!feeds/lib/ui/groups/group_activity/unseen_thread_count",["mustache"],function(a){var b='{{#displayed_unseen_count}}\n	<span data-qaid="group-unread-threads-count" class="yj-unseen-thread-count--count yk-badge">{{displayed_unseen_count}}</span>\n{{/displayed_unseen_count}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/groups/group_activity/unseen_thread_count",[],function(){}),define("feeds/lib/ui/groups/group_activity/unseen_thread_count",["require","core/lib/backbone_base_view","html!./unseen_thread_count","css!./unseen_thread_count"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("html!./unseen_thread_count");return a("css!./unseen_thread_count"),b.extend({defaults:{badgeLimit:20,slideClear:!1},className:"yj-unseen-thread-count",template:c,render:function(){var a=this.model.getUnseenCount();if(this.options.slideClear&&this.previousCount>0&&0>=a)this._slideAndClear();else{var b=this.template({displayed_unseen_count:this._formatCountString(a)});this.$el.html(b)}return this.previousCount=a,this},_formatCountString:function(a){var b;return a&&(b=a>this.options.badgeLimit?this.options.badgeLimit+"+":a),0>a&&(b=""),b},_slideAndClear:function(){this.$el.find(".yj-unseen-thread-count--count").velocity({width:"0",padding:"0"},{duration:200,easing:"linear",complete:function(){$(this).remove()}})}})}),define("feeds/lib/ui/groups/group_activity/group_activity",["require","models/lib/events","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","css!./group_activity","./group_activity_slider","./group_activity_helper","./unseen_thread_count","models/helpers/group"],function(a){"use strict";var b=a("models/lib/events"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render");a("css!./group_activity");var f=a("./group_activity_slider"),g=a("./group_activity_helper"),h=a("./unseen_thread_count"),i=a("models/helpers/group");return d.extend({mixins:[e],className:"yj-group-activity",defaults:{maxCountToAnimate:20},prevCount:null,initialSwitch:!0,removeDelay:1e4,badge:null,initialize:function(){this.badge=new h({model:this.model}),this.$el.append(this.badge.render().el),this._update=c.debounce(this._update),this._showActivitySlider=c.debounce(this._showActivitySlider,this.removeDelay,!0),this.listenTo(b,"Feed/"+this.model.id+"/update",this._update),this.model.feedCounter&&this.model.feedCounter.on("update",this._update,this)},_update:function(){var a=this.model.getUnseenCount();this._shouldAnimate()?this._prepActivitySlider(a,this.prevCount):this._updateBadge(),a>=0&&(this.prevCount=a,this.initialSwitch=!1)},_shouldAnimate:function(){return!this.initialSwitch&&this.model.getUnseenCount()<=this.options.maxCountToAnimate&&this.model.getUnseenCount()-this.prevCount>0},_prepActivitySlider:function(a,b){
var c=a-b;if(this.model.isRealtimeConnected()){var d=g.getMugshotUrlFromOrm(this.model);this._animateCount(a,b,d)}else i.isAllCompany(this.model)?g.fetchMugshotUrlsInAllCompany({limit:c}).then(this._animateCount.bind(this,a,b)):g.fetchMugshotUrlsInGroup({group_id:this.model.getGroupId(),limit:c}).then(this._animateCount.bind(this,a,b))},_animateCount:function(a,b,c){this._showActivitySlider(a,b,c),this._updateBadge()},_updateBadge:function(){return this.badge.render()},_showActivitySlider:function(a,b,c){if(c.length){var d=new f({users:c,newCount:a,prevCount:b,removeDelay:this.removeDelay});this.$el.append(d.el),d.render()}}})}),define("models/lib/model/helper/report_feed_events",["require","underscore","core/lib/session","core/lib/report","core/lib/log","models/lib/model/helper/top_groups","collections/groups","models/group","models/helpers/user"],function(a){"use strict";function b(a){var b=h.getIndexForGroup(a)+1||null,c=h.getUnviewedIndexForGroup(a)+1||null,d=h.getUnviewedCountForGroup(a),f=null,g=e.getCurrentUser(),j=i.get(a);return g&&j&&k.isMemberOf(e.getCurrentUser(),j)&&(f=1),{group_nav_rank:b,group_unviewed_rank:c,unviewed_thread_count:d,is_joined_group:f}}function c(a){var b=a.from_group_id;return"general"===a.from_group_type&&(b=j.ALL_COMPANY().get("id")),{from_group_nav_rank:h.getIndexForGroup(b)+1||null,from_group_unviewed_count:h.getUnviewedCountForGroup(b)}}var d=a("underscore"),e=a("core/lib/session"),f=a("core/lib/report"),g=a("core/lib/log"),h=a("models/lib/model/helper/top_groups"),i=a("collections/groups"),j=a("models/group"),k=a("models/helpers/user");return{reportFeedEvent:function(a,e,i,k){var l=h.getTopGroups().length,m=h.getTopUnviewedGroups().length;i=d.isNumber(i)||!d.isNaN(Number(i))?Number(i):i,i=i||null;var n={feed_type:e,feed_id:i,num_nav_groups:l,num_unviewed_groups:m};switch(e){case"group":case"in_group":n=d.extend(n,b(i));break;case"general":var o=j.ALL_COMPANY().get("id");n=d.extend(n,b(o))}k&&"from_group_id"in k&&"from_group_type"in k&&(k=d.extend(k,c(k))),g.log("reportFeedEvents: ",a,e,i,"\n",k,n,"\n",JSON.stringify(n)),f.event(a,d.extend(n,k))}}}),define("css!feeds/lib/ui/groups/group_navigation_item",[],function(){}),define("feeds/lib/ui/groups/group_navigation_item",["require","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!./group_navigation_item","./group_activity/group_activity","models/lib/model/helper/report_feed_events","core/lib/uri_helper","models/group","models/lib/helper/feed_factory","components/network_label/index","core/lib/tr","core/lib/location_helper","core/lib/urls","models/helpers/group","css!./group_navigation_item"],function(a){"use strict";var b=a("backbone"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("html!./group_navigation_item"),g=a("./group_activity/group_activity"),h=a("models/lib/model/helper/report_feed_events"),i=a("core/lib/uri_helper"),j=a("models/group"),k=a("models/lib/helper/feed_factory"),l=a("components/network_label/index"),m=a("core/lib/tr"),n=a("core/lib/location_helper"),o=a("core/lib/urls"),p=a("models/helpers/group");return a("css!./group_navigation_item"),c.extend({mixins:[d,e],template:f,tagName:"li",className:"yj-nav-menu--group-item",groupFeed:null,events:{"click .yj-nav-menu--group-item-link":"_groupClickHandler"},getTemplateData:function(){var a=this.model.toJSON();return{model:a,style:this.badgeStyle,title:m.t("leftnav_group_title",{groupname:a.full_name}),url:o.groupIndex(a)}},views:{GroupActivityView:"_getGroupActivity",NetworkLabel:"_getNetworkLabel"},_groupClickHandler:function(a){if(this._isCurrentGroup($(a.currentTarget).attr("href")))return a.preventDefault(),!1;var b=p.isAllCompany(this.model);h.reportFeedEvent("feed_link_click",b?"general":"group",b?null:this.model.get("id"),{link_type:"left_nav_click"})},_isCurrentGroup:function(a){return 0===n.href().indexOf(a)},_getGroupActivity:function(){return new g({model:this.groupFeed})},_getNetworkLabel:function(){return new l({model:this.model})},_getGuaranteedGroupFeed:function(){return this.model.get("id")==j.ALL_COMPANY().id?k.findOrCreate("general"):k.findOrCreate("group",this.model.get("id"))},initialize:function(){var a="COMPANY_GROUP_ID",c=this.model.get("id");p.isAllCompany(this.model)&&(c="all",this.$el.addClass("all-company-list-item")),this.$el.attr("data-group-id",c),this.groupFeed=this._getGuaranteedGroupFeed(),this.options.focusEvent&&this.listenTo(this.options.focusEvent,"changeTo",this._onFocusEvent);var d=yam.router;d&&(this.listenTo(d,"route",function(b,c){var d;if("company"===b)d=a;else if("group"===b)d=parseInt(i.objectify(c[0]).feedId,10);else{var e=["groupInfo","groupFiles","groupNotes"];e.indexOf(b)>=0&&c.length>0&&(d="company"===c[0]?a:parseInt(c[0]))}this._setSelectedItem(d)}),this.listenToOnce(b,"initialRoute",function(b){var c;"threadsCompany"===b.id?c=a:"threadsInGroup"===b.id?c=b.groupId:"infoInGroup"!==b.id&&"listInGroup"!==b.id||(c="company"===b.groupId?a:parseInt(b.groupId)),this._setSelectedItem(c)}))},_setSelectedItem:function(a){a===this.model.get("id")?this.$el.addClass("yj-selected"):(this.$el.removeClass("yj-selected"),this.$el.children().blur())},_onFocusEvent:function(a){this.model.get("id")===a.groupId&&this.$el.find(".yj-nav-menu--group-item-link").focus()}})}),define("css!feeds/lib/ui/groups/group_navigation",[],function(){}),define("feeds/lib/ui/groups/group_navigation_headed_group_list",["require","underscore","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!./group_navigation_headed_group_list","models/lib/orm-models","feeds/lib/ui/groups/groups_header","./group_navigation_item","core/lib/tr","core/lib/urls","core/lib/report","css!./group_navigation"],function(a){"use strict";var b=a("underscore"),c=a("backbone"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("html!./group_navigation_headed_group_list"),h=a("models/lib/orm-models"),i=a("feeds/lib/ui/groups/groups_header"),j=a("./group_navigation_item"),k=a("core/lib/tr"),l=a("core/lib/urls"),m=a("core/lib/report");return a("css!./group_navigation"),d.extend({mixins:[e,f],defaults:{header:k.t("groups"),numberOfGroupRowsToShow:20,showAllCompany:!0,limitGroupNumber:!0,eventType:null},events:{"click .yj-nav-menu--show-all-groups-link":"_showAllGroups"},template:g,tagName:"li",className:"yj-nav-menu--headed-group-list",getTemplateData:function(){var a=this.options.groups.pluck("group_id"),c=0,d=!1;if(this.options.limitGroupNumber){var e=this._numberOfGroupRowsToShow;this.options.showAllCompany&&e--,a.length>e&&e--,a=b.first(a,e),this._visibleGroupCount=a.length,c=this.options.groups.length>e?this.options.groups.length-e:0,d=c>0}return{groups:a,header:this.options.header,showAllCompany:this.options.showAllCompany,showMoreGroups:d,getMoreGroupsText:k.t("get_more_groups_text",{count:c}),getMoreGroupsTitle:k.t("get_more_groups_title")}},views:{GroupHeaderView:"_addGroupsHeader",GroupNavigationItemView:"_getGroupNavigationItem",AllCompanyNavigationItemView:"_getAllCompanyNavigationItem"},updateNumberOfGroupsToShow:function(a){this._numberOfGroupRowsToShow=a,this.render()},_getGroupNavigationItem:function(a){return new j({model:h.Groups().get(a),focusEvent:this._focusEvent})},_getAllCompanyNavigationItem:function(){return new j({model:h.Group().ALL_COMPANY()})},_addGroupsHeader:function(){return new i({label:this.options.header,title:k.t("see_more_groups"),url:l.groupsSuggested(),createTitle:k.t("create_new_collaboration_space"),createLabel:k.t("create_group"),createIcon:"yamicon-circle-add",createClass:"group-lightbox"})},_showAllGroups:function(a){a.preventDefault(),m.event("left_nav_more_groups_clicked",{type:this.options.eventType}),this.options.limitGroupNumber=!1,this.render();var b=this.options.groups.at(this._visibleGroupCount).get("group_id");this._focusEvent.trigger("changeTo",{groupId:b})},initialize:function(a){this._numberOfGroupRowsToShow=a.numberOfGroupRowsToShow,this.listenTo(this.options.groups,"add remove reset sort",this.render),this._focusEvent=b.extend({},c.Events)}})}),define("stache!feeds/lib/ui/groups/group_navigation_action",["mustache"],function(a){var b='<a href="{{url}}" class="yj-nav-menu--group-actions-link {{linkClass}}" title="{{title}}" {{#qaid}}data-qaid="{{qaid}}"{{/qaid}} {{#role}}role="{{role}}"{{/role}}>\n  <span class="yk-yamicon-s yamicon {{icon}}"></span>{{label}}\n</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/groups/group_navigation_action",[],function(){}),define("feeds/lib/ui/groups/group_navigation_action",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./group_navigation_action","css!./group_navigation_action"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("html!./group_navigation_action");return a("css!./group_navigation_action"),b.extend({mixins:[c],template:d,tagName:"li",getTemplateData:function(){return this.options},initialize:function(){this.$el.addClass(this.options.containerClass)}})}),define("stache!feeds/lib/ui/groups/group_navigation_action_area",["mustache"],function(a){var b='<ul class="yj-nav-list">\n<CreateGroupActionView/>\n<DiscoverGroupsActionView/>\n</ul>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/groups/group_navigation_action_area",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./group_navigation_action","html!./group_navigation_action_area","core/lib/tr","core/lib/urls"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./group_navigation_action"),f=a("html!./group_navigation_action_area"),g=a("core/lib/tr"),h=a("core/lib/urls");return b.extend({mixins:[c,d],template:f,className:"yj-nav-menu--group-action-area external_groups_v1",views:{DiscoverGroupsActionView:"_getDiscoverGroupsAction",CreateGroupActionView:"_getCreateGroupAction"},defaults:{hidden:!1},initialize:function(a){a.hidden&&this.hide()},show:function(){this.$el.removeClass("yj-hidden")},hide:function(){this.$el.addClass("yj-hidden")},_getCreateGroupAction:function(){var a=g.t("create_new_group_description");return new e({label:a,title:g.t("create_new_collaboration_space"),url:"javascript://",role:"button",icon:"yamicon-rd_add",containerClass:"yj-nav-menu--group-actions-create",linkClass:"group-lightbox",qaid:"group_nav_create_group"})},_getDiscoverGroupsAction:function(){var a=g.t("discover_more_groups"),b="yamicon-rd_groups";return new e({label:a,title:g.t("see_more_groups"),url:h.groupsSuggested(),icon:b,containerClass:"yj-nav-menu--group-actions-browse",linkClass:"suggested-groups-lightbox",qaid:"group_nav_discover_more_groups"})}})}),define("feeds/lib/ui/groups/group_navigation",["require","backbone","core/lib/backbone_base_view","collections/banners","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!./group_navigation","feeds/lib/ui/groups/external_groups_banner","feeds/lib/ui/groups/group_navigation_headed_group_list","feeds/lib/ui/groups/group_navigation_action_area","feeds/lib/ui/groups/group_navigation_height_helper","core/lib/session","core/lib/tr","core/lib/treatment","models/helpers/network","css!./group_navigation"],function(a){"use strict";var b=a("backbone"),c=a("core/lib/backbone_base_view"),d=a("collections/banners"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("html!./group_navigation"),h=a("feeds/lib/ui/groups/external_groups_banner"),i=a("feeds/lib/ui/groups/group_navigation_headed_group_list"),j=a("feeds/lib/ui/groups/group_navigation_action_area"),k=a("feeds/lib/ui/groups/group_navigation_height_helper"),l=a("core/lib/session"),m=a("core/lib/tr"),n=a("core/lib/treatment"),o=a("models/helpers/network");a("css!./group_navigation");var p=368;return c.extend({mixins:[e,f],defaults:{heightAvailable:p,standardMaxNumberGroupsToShow:20,showActions:!1},template:g,tagName:"ul",className:"yj-nav-menu--group-navigation",views:{InternalGroupsView:"_getInternalGroupsView",ExternalGroupsView:"_getExternalGroupsView",ExternalGroupsBanner:"_getExternalGroupsBanner",GroupNavigationActions:"_getGroupNavigationActionArea"},initialize:function(){this._internalGroups=new b.Collection,this._externalGroups=new b.Collection,this._heightAvailable=this.options.heightAvailable,this._showActions=this.options.showActions,this._externalGroupsBannerModel=d.getOrFetch(h.BANNER_NAME),this._splitUpCollection(),this.listenTo(this.collection,"add remove reset sort",function(){this._updateGroupLists(),this.render()}),this.listenTo(this._externalGroupsBannerModel,"change:opted_out",function(a){null!=a.isOptedOut()&&(this._updateGroupLists(),this.render())}),this.$el.addClass("external_groups_v1")},getTemplateData:function(){return{showExternalGroups:this._shouldShowExternalGroups(),showExternalGroupsBanner:this._shouldIncludeExternalGroupsBanner()}},updateHeightAvailable:function(a){this._heightAvailable=a,this._updateMaxGroups()},_updateGroupLists:function(){this._splitUpCollection(!0),this._updateMaxGroups()},_updateMaxGroups:function(){this._externalGroupList&&this._externalGroupList.updateNumberOfGroupsToShow(this._getMaxExternalGroups()),this._internalGroupList&&this._internalGroupList.updateNumberOfGroupsToShow(this._getMaxInternalGroups())},_getMaxInternalGroups:function(){var a=this.options.standardMaxNumberGroupsToShow;return this._shouldMakeSpaceForExternalGroupsBanner()&&(a=k.getMaxInternalGroupsToShowWithBanner(this._heightAvailable)),a},_getMaxExternalGroups:function(){return k.getMaxExternalGroupsToShow(this._heightAvailable,this._internalGroups.length+1,this._externalGroups.length)},_shouldIncludeExternalGroupsBanner:function(){var a=l.getCurrentNetwork(),b=n.treatment("create_external_group_v1"),c=o.isExternalMessagingEnabled(a),d=!a.community,e=null!=this._externalGroupsBannerModel.isOptedOut()?this._externalGroupsBannerModel.isOptedOut():!0;return b&&c&&d&&!e&&0===this._externalGroups.size()},_shouldMakeSpaceForExternalGroupsBanner:function(){return this._shouldIncludeExternalGroupsBanner()&&!this._externalGroupsBannerModel.isOptedOut()},_shouldShowExternalGroups:function(){return this._externalGroups.size()>0},_splitUpCollection:function(a){a=a||!1,this._internalGroups.reset(this.collection.where({external:!1}),{silent:a}),this._externalGroups.reset(this.collection.where({external:!0}),{silent:a}),this._externalGroups.length>0&&this._optOutOfExternalGroupsBanner()},_optOutOfExternalGroupsBanner:function(){this._externalGroupsBannerModel&&this._externalGroupsBannerModel.isOptedOut()===!1&&this._externalGroupsBannerModel.optOut()},_getGroupNavigationActionArea:function(){return this._actionArea=new j({hidden:!this._showActions}),this._actionArea},showActions:function(){this._showActions=!0,this._refreshActionArea()},hideActions:function(){this._showActions=!1,this._refreshActionArea()},_refreshActionArea:function(){this._showActions?this._actionArea&&this._actionArea.show():this._actionArea&&this._actionArea.hide()},_getInternalGroupsView:function(){var a=l.getCurrentNetwork().name,b=m.t("network_groups",{network:a});return this._internalGroupList=new i({header:b,groups:this._internalGroups,numberOfGroupRowsToShow:this._getMaxInternalGroups(),eventType:"internal"}),this._internalGroupList},_getExternalGroupsView:function(){return this._externalGroupList=new i({groups:this._externalGroups,header:m.t("external_groups"),showAllCompany:!1,numberOfGroupRowsToShow:this._getMaxExternalGroups(),eventType:"external"}),this._externalGroupList},_getExternalGroupsBanner:function(){return new h({model:this._externalGroupsBannerModel})}})}),define("stache!feeds/lib/ui/groups/group_navigation_wrapper",["mustache"],function(a){var b='<div class="yj-nav-scroll-content">\r\n  <GroupNavigationView key="menu" />\r\n</div>\r\n<GroupNavigationActions/>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/groups/group_navigation_wrapper",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","collections/group_ranks","./group_navigation","feeds/lib/ui/groups/group_navigation_action_area","html!./group_navigation_wrapper"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("collections/group_ranks"),f=a("./group_navigation"),g=a("feeds/lib/ui/groups/group_navigation_action_area"),h=a("html!./group_navigation_wrapper");return b.extend({mixins:[c,d],template:h,tagName:"div",className:"yj-group-navigation-wrapper",views:{GroupNavigationView:"_getGroupNavigation",GroupNavigationActions:"_getGroupNavigationActions"},defaults:{actionsInsideScroll:!1},initialize:function(a){this._heightForGroupNav=a.heightForGroups||this.$el.outerHeight(),this._actionsInsideScroll=a.actionsInsideScroll},reLayout:function(a,b){this._heightForGroupNav=a,this._actionsInsideScroll=b,this._groupNavigation&&(this._updateGroupActionLocation(),this._groupNavigation.updateHeightAvailable(this._heightForGroupNav))},_updateGroupActionLocation:function(){this._actionsInsideScroll?(this._groupNavActions&&this._groupNavActions.hide(),this._groupNavigation&&this._groupNavigation.showActions()):(this._groupNavActions&&this._groupNavActions.show(),this._groupNavigation&&this._groupNavigation.hideActions())},_getGroupNavigation:function(){return this._groupNavigation=new f({collection:e,showActions:this._actionsInsideScroll}),this._groupNavigation},_getGroupNavigationActions:function(){return this._groupNavActions=new g({hidden:this._actionsInsideScroll}),this._groupNavActions}})}),define("stache!feeds/lib/ui/groups/group_browse_lightbox",["mustache"],function(a){var b='<div id="suggested-groups-lightbox" class="yj-lightbox-content" data-title="{{title}}">\n  <div class="groups-grid"></div>\n  <div class="button-bar">\n    <button class="yj-btn close-lightbox">{{closeLabel}}</button>\n    <a href="{{url}}" class="load-more-groups">{{moreLabel}}</a>\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/groups/group_browse_lightbox",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!./group_browse_lightbox"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("html!./group_browse_lightbox");return b.extend({mixins:[c,d],template:e,className:"colorbox-wrap",getTemplateData:function(){return this.options}})}),define("stache!components/global_nav/src/nav_user",["mustache"],function(a){var b='<div class="yj-nav-menu--user-info-item" data-qaid="user_avatar">\n  <a href="{{user_profile}}" aria-hidden="true" class="yk-avatar yk-avatar--s" tabindex="-1" title="{{view_profile_label}}">\n    <img data-qaid="default_thumbnail" src="{{user_mugshot}}" title="View Profile" />\n  </a>\n</div>\n\n<div class="yj-nav-menu--user-info-item yj-nav-menu--user-name-container">\n  <a href="{{user_profile}}" class="yj-nav-menu--user-name" data-qaid="user_name_link" title="{{user_name}}">{{user_name}}</a>\n  <span class="yj-nav-menu--current-network" title="{{current_network}}">{{current_network}}</span>\n</div>\n\n<div class="yj-nav-menu--user-info-item">\n  <NavUserDropdownView />\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!components/global_nav/src/nav_user_dropdown",["mustache"],function(a){var b='<a href="javascript:void(0);" title="{{settings_label}}" class="yj-nav-menu--user-settings-link yj-simple-click-menu-trigger" role="button" data-attach-menu="true" data-position-menu="top" aria-haspopup="true" data-speechtip>\n  <span class="yamicon yamicon-rd_gear yk-yamicon-m">\n    <span class="yj-acc-hidden">{{settings_label}}</span>\n  </span>\n</a>\n\n<ul class="yj-nav-menu--user-settings-menu yj-click-menu">\n  {{#items}}\n  {{^disabled}}\n  <li class="yj-nav-menu--user-settings-menu-item">\n    <a href="{{url}}" class="yj-nav-menu--user-settings-menu-link" data-qaid="{{qaid}}" {{attr}}>\n      <span class="yamicon yk-yamicon-m {{yamicon}}"></span>\n      <strong>{{text}}</strong>\n    </a>\n  </li>\n  {{/disabled}}\n  {{/items}}\n\n  {{#show_pending_requests}}\n    <PendingRequestsView />\n  {{/show_pending_requests}}\n\n  {{#show_network_invitations}}\n    <NetworkInvitesView />\n  {{/show_network_invitations}}\n\n  <NetworksMenuView />\n\n  {{#logout_enabled}}\n    <li class="yj-nav-menu--user-settings-menu-item nav-separate">\n      <a href="{{logoutUrl}}" class="yj-nav-menu--user-settings-menu-link yj-nav-menu--user-settings-log-out" title="{{logout_label}}" rel="nofollow" data-method="delete" data-qaid="ellipsis_menu_logout_link">\n        <span class="yamicon yamicon-rd_sign_out yk-yamicon-m"></span>\n        <span class="yj-nav-menu--user-settings-menu-text">{{logout_label}}</span>\n      </a>\n    </li>\n  {{/logout_enabled}}\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/sidebar/network_invitations",[],function(){}),define("stache!workfeed/lib/app/sidebar/network_invitations",["mustache"],function(a){var b='<a class="yj-network-invite--link yj-requests-action" href="{{invitationsUrl}}">\n  <span class="yamicon yamicon-rd_inbox yk-yamicon-s"></span>\n  <span class="yj-nav-menu--user-settings-menu-text">{{pending_invites}}</span>\n  <span class="uni-network-count yk-badge" data-qaid="unread_count">{{inviteCount}}</span>\n</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/network_invitations",["require","core/lib/tr","core/lib/urls","core/lib/session","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/report","css!./network_invitations","html!./network_invitations"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/urls"),d=a("core/lib/session"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("core/lib/report");a("css!./network_invitations");var h=e.extend({className:"yj-network-invite",tagName:"li",mixins:[f],template:a("html!./network_invitations"),events:{"click .yj-requests-notice .yj-requests-action":"_trackClick"},getTemplateData:function(){var a=d.getCurrentUser(),e=a.get("pending_network_invitations_count")||0;return{hasInvitations:e>0,inviteCount:e,invitationsUrl:c.pendingInvitations(),invitationsMessage:b.t("you_have_count_pending_invitations",{count:e}),pending_invites:b.t("pending_network_invites")}},_trackClick:function(){g.event("rr_home_pending_network_invitations")}});return h}),define("css!workfeed/lib/app/sidebar/pending_requests",[],function(){}),define("stache!workfeed/lib/app/sidebar/pending_requests",["mustache"],function(a){var b='<a class="yj-pending-requests--link yj-requests-action" href="{{invitationsUrl}}">\n  <span class="yamicon yamicon-rd_inbox yk-yamicon-s"></span>\n  <span class="yj-nav-menu--user-settings-menu-text">{{pendingInvitesText}}</span>\n  {{#hasInvitations}}<span class="uni-network-count yk-badge" data-qaid="unread_count">{{inviteCount}}</span>{{/hasInvitations}}\n</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/pending_requests",["require","core/lib/tr","core/lib/urls","core/lib/report","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","css!./pending_requests","html!./pending_requests"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/urls"),d=a("core/lib/report"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render");a("css!./pending_requests");var g=e.extend({className:"yj-pending-requests",tagName:"li",mixins:[f],template:a("html!./pending_requests"),events:{"click .yj-pending-requests .yj-requests-action":"_trackClick"},pendingInvitationsCount:0,getTemplateData:function(){return{hasInvitations:!1,inviteCount:this.pendingInvitationsCount,invitationsUrl:c.pendingRequests(),pendingInvitesText:b.t("pending_requests")}},_trackClick:function(){d.event("pending_requests")}});return g}),define("stache!workfeed/lib/app/components/networks_menu",["mustache"],function(a){var b='<div class="yj-nav-menu--network-settings-menu-wrap">\n  <ul class="yj-nav-menu--network-settings-menu-scroll-content">\n  {{#networks}}\n  <li class="{{#is_current}}uni-current-network{{/is_current}} nav-home-network yj-clearfix"\n    data-qaid="{{#is_primary}}home_{{/is_primary}}network_row" data-yj-network-id="{{id}}">\n    <a href="{{web_url}}" class="yj-nav-menu--network-settings-menu-link" title="{{name}}" data-qaid="network_row_link">\n      <span class="yamicon yamicon-rd_network yk-yamicon-m"></span>\n      <span class="yj-nav-menu--user-settings-menu-text">{{name}}</span>\n      <span class="uni-network-count yk-badge" data-qaid="unread_count" data-network-id="{{id}}"></span>\n    </a>\n  </li>\n  {{/networks}}\n\n  {{#can_browse_external_networks}}\n  <li class="uni-menu-action">\n    <a href="{{browse_external_networks_url}}" class="yj-nav-menu--network-settings-menu-link" data-qaid="browse_external_networks_link">\n      <span class="yamicon yamicon-rd_search yk-yamicon-m"></span>\n      <span class="yj-nav-menu--user-settings-menu-text">{{browse_external_networks_label}}</span>\n    </a>\n  </li>\n  {{/can_browse_external_networks}}\n\n  {{#can_create_new_network}}\n  <li class="uni-list-disable-redirect uni-list-last uni-menu-action network-lightbox yj-clearfix">\n    <a href="{{create_new_network_url}}" class="yj-nav-menu--network-settings-menu-link" data-qaid="create_external_network_link">\n      <span class="yamicon yamicon-rd_add yk-yamicon-m"></span>\n      <span class="yj-nav-menu--user-settings-menu-text">{{create_new_network_label}}</span>\n    </a>\n  </li>\n  {{/can_create_new_network}}\n  </ul>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/components/networks_menu",[],function(){}),define("workfeed/lib/app/components/networks_menu",["require","underscore","core/lib/tr","core/lib/yammer_uri","core/lib/session","core/lib/report","common-ui/lib/ui/shared/scroller","models/helpers/network","core/lib/urls","models/lib/events","models/network","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./networks_menu","css!./networks_menu"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/yammer_uri"),e=a("core/lib/session"),f=a("core/lib/report"),g=a("common-ui/lib/ui/shared/scroller"),h=a("models/helpers/network"),i=a("core/lib/urls"),j=a("models/lib/events");a("models/network");var k=a("core/lib/backbone_base_view"),l=a("core/lib/backbone_with_auto_render"),m=a("html!./networks_menu");a("css!./networks_menu");var n={networks_label:c.t("networks"),home_label:c.t("home"),browse_external_networks_label:c.t("networks_browse_external"),create_new_network_label:c.t("networks_create_new")},o=k.extend({mixins:[l],template:m,id:"uni-networks-title",tagName:"li",className:"yj-nav-menu--network nav-toggle-trigger nav-networks-title nav-separate",attributes:{"data-qaid":"networks_toggle"},events:{"click .nav-toggle-menu .nav-list-link":"_trackClick"},initialize:function(){this.currentUser=e.getCurrentUser(),this.currentNetwork=e.getCurrentNetwork(),this.allNetworks=this._getAllNetworks(),this.listenTo(j,"Network/update",this._onNetworkSaved),this.currentNetwork.listen()},getTemplateData:function(){var a=this.currentUser.get("can_browse_external_networks"),c=this.currentUser.get("can_create_new_network");return b.extend({networks:this.allNetworks,can_browse_external_networks:a,can_create_new_network:c,my_networks_url:d.app("communities/mine"),browse_external_networks_url:d.app("communities"),create_new_network_url:"javascript://"},n)},_getAllNetworks:function(){return b.chain(e.getAllNetworks()).map(function(a){var c=i.networkIndex(a);return c&&c.lastIndexOf("/")!==c.length&&(c+="/"),b.extend({},a,{web_url:c})}).sortBy(function(a){return a.is_primary?"":a.name.toLowerCase()}).value()},render:function(){return this.networkList=this.$(".yj-nav-menu--network-settings-menu-wrap"),this.allNetworks.length>7&&(this.scroller=g(this.networkList,180,0,200,{alwaysShow:!0,fixedScrollBarHeight:45})),this},_onNetworkSaved:function(a){this._updateNetworkCount(a),this._updateGlobalCount()},_hasUnseenMessagesInNonCurrentNetwork:function(){return b.any(e.getAllNetworks(),function(a){return!h.isCurrent(a,e)&&h.hasUnseen(a)})},_updateNetworkCount:function(a){var b=h.getUnseenCount(a),c=this.$('.uni-network-count[data-network-id="'+a.id+'"]');c.closest("li").hasClass("uni-current-network")===!1&&(b>0?c.text(100>b?b:"99+"):c.empty())},_updateGlobalCount:function(){this._hasUnseenMessagesInNonCurrentNetwork()?this.trigger("hasNetworkCount",!0):this.trigger("hasNetworkCount",!1)},_trackClick:function(a){f.event("nav_networks_menu_link",{trigger:$(a.currentTarget).data("qaid")})}});return o}),define("css!components/global_nav/src/nav_user_dropdown",[],function(){}),define("components/global_nav/src/nav_user_dropdown",["require","underscore","core/lib/tr","core/lib/session","core/lib/yammer_uri","core/lib/urls","core/lib/report","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!components/global_nav/src/nav_user_dropdown","models/helpers/user","components/suite_nav/src/suite_nav","workfeed/lib/app/sidebar/network_invitations","workfeed/lib/app/sidebar/pending_requests","workfeed/lib/app/components/networks_menu","models/network","css!./nav_user_dropdown"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("core/lib/yammer_uri"),f=a("core/lib/urls"),g=a("core/lib/report"),h=a("backbone"),i=a("core/lib/backbone_base_view"),j=a("core/lib/backbone_with_auto_render"),k=a("core/lib/backbone_with_subviews"),l=a("html!components/global_nav/src/nav_user_dropdown"),m=a("models/helpers/user"),n=a("components/suite_nav/src/suite_nav"),o=a("workfeed/lib/app/sidebar/network_invitations"),p=a("workfeed/lib/app/sidebar/pending_requests"),q=a("workfeed/lib/app/components/networks_menu");a("models/network"),a("css!./nav_user_dropdown");var r={profile_label:c.t("global_nav_view_profile"),settings_label:c.t("global_nav_edit_settings"),admin_label:c.t("header_nav_admin"),help_label:c.t("global_nav_get_support"),logout_label:c.t("header_nav_logout")};return i.extend({mixins:[j,k],template:l,views:{PendingRequestsView:"_addPendingRequests",NetworksMenuView:"_addNetworksMenu",NetworkInvitesView:"_addNetworkInvites"},events:{"click .yj-nav-menu--user-settings-menu-link":"_logEvent"},initialize:function(){this.user=d.getCurrentUser(),this.items=[{url:f.userIndex(this.user,d),text:r.profile_label,yamicon:"yamicon-rd_profile",qaid:"nav_menu_profile_link"},{url:e.app("/account/profile_info",{from:"nav"}),text:r.settings_label,yamicon:"yamicon-rd_gear",qaid:"ellipsis_menu_edit_profile_link"},{url:e.app("/admin",{from:"nav"}),text:r.admin_label,yamicon:"yamicon-rd_admin",qaid:"nav_admin_menu_button",disabled:!m.isAdmin(this.user)},{url:f.help(),text:r.help_label,yamicon:"yamicon-rd_help",qaid:"ellipsis_menu_help_link",attr:'target="_blank" data-keep-open-on-click="false"'}],this.logoutEnabled=!n.exists(),this.logoutUrl=e.app("/logout",{from:"nav"}),this._setupEventListeners()},getTemplateData:function(){return b.extend({items:this.items,logoutUrl:this.logoutUrl,show_pending_requests:m.isVerifiedAdmin(this.user)&&m.isAdmin(this.user),show_network_invitations:this.user.get("pending_network_invitations_count")||0,logout_enabled:this.logoutEnabled},r)},remove:function(){return h.off("/ui/masthead/fallback",null,this),
i.prototype.remove.call(this)},_setupEventListeners:function(){h.on("/ui/masthead/fallback",function(){this.logoutEnabled=!0,this.render()},this)},_addNetworksMenu:function(){var a=new q;return this.listenTo(a,"hasNetworkCount",this._updateNetworkCountIndicator.bind(this)),a},_addPendingRequests:function(){return new p},_addNetworkInvites:function(){return new o},_updateNetworkCountIndicator:function(a){var b=this.$(".yj-nav-menu--user-settings-link");a?b.addClass("has-network-count"):b.removeClass("has-network-count")},_logEvent:function(a){g.event("ellipsis_menu",{source:$(a.currentTarget).data("qaid")})}})}),define("css!components/global_nav/src/nav_user",[],function(){}),define("components/global_nav/src/nav_user",["require","underscore","core/lib/tr","core/lib/session","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!components/global_nav/src/nav_user","models/helpers/avatar","core/lib/urls","./nav_user_dropdown","css!./nav_user"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("core/lib/backbone_with_subviews"),h=a("html!components/global_nav/src/nav_user"),i=a("models/helpers/avatar"),j=a("core/lib/urls"),k=a("./nav_user_dropdown");a("css!./nav_user");var l={view_profile_label:c.t("view_profile")};return e.extend({mixins:[f,g],template:h,className:"yj-nav-menu--user yk-clearfix",views:{NavUserDropdownView:"_addNavUserDropdown"},initialize:function(){this.user=d.getCurrentUser()},getTemplateData:function(){return b.extend({user_name:this.user.get("full_name"),user_profile:j.userIndex(this.user,d),user_mugshot:i.getAvatarUrl(this.user,48,48,!0),current_network:d.getCurrentNetwork().getPlainBody()},l)},_addNavUserDropdown:function(){return new k}})}),define("css!components/global_nav/src/global_nav",[],function(){}),define("components/global_nav/src/global_nav",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!components/global_nav/src/global_nav","components/header_navigation/index","feeds/lib/ui/groups/group_navigation_wrapper","feeds/lib/ui/groups/group_browse_lightbox","./nav_user","core/lib/urls","core/lib/tr","css!./global_nav"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("html!components/global_nav/src/global_nav"),f=a("components/header_navigation/index"),g=a("feeds/lib/ui/groups/group_navigation_wrapper"),h=a("feeds/lib/ui/groups/group_browse_lightbox"),i=a("./nav_user"),j=a("core/lib/urls"),k=a("core/lib/tr");a("css!./global_nav");var l={nav_user_accessibility_label:k.t("redesign_nav_user_accessibility_label")};return b.extend({mixins:[c,d],template:e,className:"yj-nav-menu yj-nav-home-menu yj-nav-menu-yamjs",attributes:{"data-qaid":"left_nav",role:"navigation"},views:{HeaderNavigationView:"_addHeaderNavigation",GroupBrowseLightboxView:"_addGroupBrowseLightbox",GroupNavigationView:"_addGroupNavigation",NavUserView:"_addNavUser"},getTemplateData:function(){return l},reLayout:function(a,b){this._groupNavigation&&this._groupNavigation.reLayout(a,b)},_addHeaderNavigation:function(){return new f},_addGroupBrowseLightbox:function(){return new h({closeLabel:k.t("done"),title:k.t("click_on_groups_that_interest_you"),moreLabel:k.t("view_more_groups"),url:j.groupsSuggested()})},_addGroupNavigation:function(){return this._groupNavigation=new g,this._groupNavigation},_addNavUser:function(){return new i}})}),define("components/global_nav/index",["require","./src/global_nav"],function(a){"use strict";var b=a("./src/global_nav");return b}),define("feeds/lib/ui/shared/group_navigator",["require","core/lib/backbone_legacy_integration","core/lib/treatment","backbone","common-ui/lib/ui/general/fixed_sidebar_decorator","workfeed/lib/app/group_and_en_lightbox","common-ui/lib/ui/groups/create_group_lightbox","common-ui/lib/ui/groups/create_en_lightbox","feeds/lib/ui/shared/group_membership_handler","components/global_nav/index"],function(a){"use strict";var b=a("core/lib/backbone_legacy_integration"),c=a("core/lib/treatment"),d=a("backbone"),e=a("common-ui/lib/ui/general/fixed_sidebar_decorator"),f=a("workfeed/lib/app/group_and_en_lightbox"),g=a("common-ui/lib/ui/groups/create_group_lightbox"),h=a("common-ui/lib/ui/groups/create_en_lightbox"),i=a("feeds/lib/ui/shared/group_membership_handler"),j=a("components/global_nav/index");return b.extend({el:".yj-group-nav-list",initLightboxes:function(){d.trigger("/ui/lightbox/group_and_en/register_trigger",".group-lightbox","group"),d.trigger("/ui/lightbox/group_and_en/register_trigger",".network-lightbox","external_network")},initNewLightboxes:function(){d.trigger("/ui/lightbox/create_group/register_trigger",".group-lightbox"),d.trigger("/ui/lightbox/create_en/register_trigger",".network-lightbox")},initialize:function(a){var b,d=a.target;this._leftNav=new j,d.append(this._leftNav.render().el),new e({globalNav:this._leftNav}),b=d.find(".yj-group-nav-list:first"),0!==b.length&&(this.membershipHandler=new i({target:b})),c.treatment("create_external_group_v1")?(new g,new h,this.initNewLightboxes()):(new f,this.initLightboxes())}})}),define("feeds/lib/ui/attachments/o365_client",["require","jquery","core/lib/backbone_base_view"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_base_view");return c.extend({tagName:"iframe",attributes:function(){return{"data-qaid":"o365_client",src:this.options.url}},events:{load:"_onLoad"},initialize:function(){this._subscriptions=[]},subscribe:function(a,b,c){this._subscriptions.push({messageId:a,callback:b,context:c})},_onLoad:function(a){var c=a.target.contentWindow,d=this._subscriptions,e=function(a){var b=a.originalEvent;if(b.source==c){var e,f;try{e=JSON.parse(b.data),f=e.MessageId}catch(a){return}var g,h,i;for(g=0,h=d.length;h>g;g++)i=d[g],f===i.messageId&&i.callback.call(i.context,e)}};b(window).on("message",e),this._onMessage=e},remove:function(){b(window).off("message",this._onMessage),c.prototype.remove.call(this)}})}),define("stache!feeds/lib/ui/attachments/attachment_viewer_file",["mustache"],function(a){var b='{{#showActions}}\n<div class="yj-vertical-align-tallest-element"></div>\n<div class="yj-file-details">\n  <a href="{{download_url}}" title="{{downloadLabel}}">\n    <img src="{{large_icon_url}}" alt="">\n  </a>\n  <span class="yj-no-preview-information">\n    <a href="{{download_url}}">{{noPreviewLabel}}</a>\n  </span>\n</div>\n{{/showActions}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/attachment_viewer_file",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/attachments/o365_client","core/lib/tr","core/lib/session","models/helpers/attachment","html!./attachment_viewer_file"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("feeds/lib/ui/attachments/o365_client"),h=a("core/lib/tr"),i=a("core/lib/session"),j=a("models/helpers/attachment"),k=a("html!./attachment_viewer_file");return c.extend({mixins:[d,e,f],template:k,className:function(){return this.model.preview_url?"yj-attachment-file":"yj-attachment-file-no-preview"},initialize:function(a){var b=this.model.preview_url;this.showActions=!0,j.isNote(this.model)&&j.isForeign(this.model,i)&&(b=this.model.api_preview_url,this.showActions=!1),this.attachPoint=a.attachPoint,b&&this.replaceContent(b)},getTemplateData:function(){var a=b.pick(this.model,"download_url","large_icon_url");return a.showActions=this.showActions,a.downloadLabel=h.t("click_to_download"),a.noPreviewLabel=h.t("no_preview_available_click_to_download"),a},replaceContent:function(a){var b=new g({url:a});b.subscribe("UI_Close",function(){this.trigger("closeViewer")},this),b.subscribe("UI_Edit",function(a){this.trigger("edit",{sendTime:a.SendTime})},this);var c=this._o365Client;c&&(c.destroy(),this.empty()),this.append(b),this._o365Client=b}})}),define("stache!feeds/lib/ui/attachments/attachment_viewer_image",["mustache"],function(a){var b='<div class="yj-vertical-align-tallest-element"></div>\n<img src="{{preview_url}}" alt="">\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/attachment_viewer_image",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./attachment_viewer_image"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("html!./attachment_viewer_image");return c.extend({mixins:[d],className:"yj-attachment-image",template:e,initialize:function(a){this.options=b.extend({},this.options,a),this.attachPoint=this.options.attachPoint},getTemplateData:function(){var a=this.model.preview_url,b=this.model&&this.model.versions;return b&&b.length&&(a+="?"+b[b.length-1].id),{preview_url:a}},render:function(){this.model.style&&this.$el.attr("style",this.model.style);var a=this.$("img"),b=this;return this.$el.addClass("yj-loading"),a.one("load",function(){b._onImageLoaded.call(b)}),this},_onImageLoaded:function(){this.$el.removeClass("yj-loading")}})}),define("stache!feeds/lib/ui/attachments/attachment_viewer_toolbar",["mustache"],function(a){var b='<div class="yj-fl">\n  <span class="yj-attachment-name{{#readonly}} yj-attachment-name--read-only{{/readonly}}" id="yj-attachment-name">\n    <span>{{name}}</span>\n    {{#in_sequence}}\n    <span class="yj-attachment-count">{{sequence_text}}</span>\n    {{/in_sequence}}\n  </span>\n  {{#readonly}}\n  <span class="yj-attachment--read-only">\n    <i class="yamicon yamicon-empty-circle-italic"></i> {{read_only_text}}\n  </span>\n  {{/readonly}}\n</div>\n<div class="yj-fr">\n  <div class="yj-vertical-align-tallest-element"></div>\n {{#is_editable}}\n    {{^edit_disabled}}<a href="{{edit_url}}" class="yj-action yj-edit-action" target="_blank">{{/edit_disabled}}\n    {{#edit_disabled}}<a href="javascript://" class="yj-action yj-edit-action yj-action-disabled" data-tooltip="{{edit_disabled}}">{{/edit_disabled}}\n      {{edit_file_text}}\n    </a>\n  {{/is_editable}}\n  {{#is_shareable}}\n    <a class="yj-action yj-share sprite-parent" href="javascript://">\n      {{share_text}}\n    </a>\n  {{/is_shareable}}\n  {{#is_downloadable}}\n    <a class="yj-action sprite-parent" href="{{download_url}}">\n      {{download_text}}\n    </a>\n  {{/is_downloadable}}\n  {{#is_url_available}}\n    <a class="yj-action sprite-parent yj-go-to-action" href="{{web_url}}">\n      {{#is_note}}{{go_to_note_text}}{{/is_note}}\n      {{^is_note}}{{go_to_file_text}}{{/is_note}}\n    </a>\n  {{/is_url_available}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/attachment_viewer_toolbar",["require","underscore","jquery","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","feeds/lib/ui/publisher/global/publisher_helper","backbone","core/lib/session","core/lib/tr","models/helpers/attachment","collections/groups","collections/group_memberships","models/helpers/file","core/lib/urls","models/helpers/group","html!./attachment_viewer_toolbar","models/attachment","common-ui/lib/ui/general/lightbox_manager"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("feeds/lib/ui/publisher/global/publisher_helper"),g=a("backbone"),h=a("core/lib/session"),i=a("core/lib/tr"),j=a("models/helpers/attachment"),k=a("collections/groups"),l=a("collections/group_memberships"),m=a("models/helpers/file"),n=a("core/lib/urls"),o=a("models/helpers/group"),p=a("html!./attachment_viewer_toolbar"),q={pm:"attachment_in_pm_tooltip",official:"attachment_official_tooltip"};return a("models/attachment"),a("common-ui/lib/ui/general/lightbox_manager"),d.extend({mixins:[e],className:"yj-attachment-toolbar yj-clearfix",template:p,events:{"click .yj-share":"openShare","click .yj-edit-action":"onEdit"},getTemplateData:function(){var a=this.options.model,b=yam.model.Attachment.findOrCreate(a),c=j.getMessages(b)[0],d=k.get(b.group_id),e=c&&c.isPrivate()&&!d,f=h.getCurrentUser(),g=j.isForeign(b,h),p=j.isOwnedByUser(b,f),q=e&&(j.isPrivate(b)||d&&o.isPrivate(d)),r=!g&&!(j.isPrivate(b)||d&&o.isPrivate(d));return a.sequence_total>1&&(a.in_sequence=!0,a.sequence_text=i.t("sequence_of_sequence_total",{sequence:a.sequence,sequence_total:a.sequence_total})),a.is_pending?a:(q?a.is_url_available=!1:p?a.is_url_available=!0:g?a.is_url_available=!1:a.is_url_available=!0,a.is_shareable=r,a.is_note=j.isNote(b),a.is_downloadable=!!b.download_url,a.is_editable=j.isEditable(b,h),a.is_editable&&(c&&c.isDirectMessage()?a.edit_disabled="pm":b.official?a.edit_disabled="official":a.edit_url=a.web_url+"/edit"),a.readonly=m.isReadOnly(b,h,l),a.edit_file_text=i.t("edit_file"),a.share_text=i.t("share_2"),a.download_text=i.t("download"),a.go_to_note_text=i.t("go_to_note_2"),a.go_to_file_text=i.t("go_to_file_3"),a.read_only_text=a.is_note?i.t("note_read_only"):i.t("file_read_only"),m.isFile(a)?a.web_url=n.fileIndex(a):m.isPage(a)&&(a.web_url=n.noteIndex(a)),a)},render:function(){return this._addTooltips(),this},_addTooltips:function(){var a,b=this,d=this.$el.find("[data-tooltip]");d.each(function(d,e){a=i.t(q[c(e).attr("data-tooltip")]),b._createTooltip(e,a)})},_createTooltip:function(a,b){var d={target:c(a),text:b,delay:400,fadeTime:0};g.trigger("/ui/tooltip/add",d)},onEdit:function(a){c(a.target).hasClass("yj-action-disabled")||this.trigger("forceClose")},onPreview:function(){this.trigger("preview")},_openPublisherShareLightbox:function(a){var c=b.extend({source:"preview_bar"},a.model,b.omit(a,"model"));f.openShareLightbox(c)},openShare:function(a){a.preventDefault();var b=this.model,c={model:b,id:b.id};"uploaded_file"===b.type||"uploaded_file"===b.real_type?(c.title=i.t("share_this_file_2"),c.type="attachment"):"page"===b.type||"page"===b.real_type?(c.title=i.t("share_this_note"),c.type="page",c.id=b.real_id||b.id):b.object_name&&(c.title=i.t("share_this_object_name",{object_name:b.object_name})),this._openPublisherShareLightbox(c)}})}),define("feeds/lib/ui/attachments/attachment_viewer_video",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","common-ui/lib/ui/general/video","core/lib/yammer_api"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("common-ui/lib/ui/general/video"),g=a("core/lib/yammer_api");return c.extend({mixins:[d,e],className:"yj-attachment-video",initialize:function(a){this.attachPoint=a.attachPoint,this.attachment=a.model,this._getUrl()},_getUrl:function(){var a=this.attachment,c=this;g.getVideoStreamingPath({file_id:a.id,version_id:a.versionId}).then(function(d){var e;try{e=JSON.parse(d).signed_url}catch(a){e=d.signed_url?d.signed_url:d}b.extend(a,{signed_url:e}),c._initVideo()})},_initVideo:function(){var a=new f({el:this.el,attachment:this.attachment,videoOpts:{autostart:!0}});a.render(),this.append(a)}})}),define("models/lib/helper/message/message_action_mixin",["require","jquery","underscore","core/lib/report","core/lib/string_helper"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/report"),e=a("core/lib/string_helper");return{observeMessageDomEvents:function(){var a=this.$el||this.$element;a.bind("click."+this.getId(),this.onMessageDomEvents.bind(this))},onMessageDomEvents:function(a){var c,d,f=b(a.target),g={follow:!0,reply:!0,like:!0,openReplyForm:!0,submitReply:!0,expandBody:!0,collapseBody:!0,addTopic:!0,email:!0,reportSpam:!0,bookmark:!0,followThreadInInbox:!0,deleteMessage:!0,mute:!0,share:!0,joinGroup:!0,translate:!0,untranslate:!0,revokeAccess:!0};if(f.is("a")||(f=f.closest("a")),f.parents("[data-message-id]:first").length){c=f.parents("[data-message-id]:first").attr("data-message-id");var h=f.get(0),i=h.className.replace(/yj-/g,"");i+=h.target?" "+h.target:"",i=i.split(" ");for(var j=0,k=i.length;k>j;j++)if(d=e.camelize(i[j]),g.hasOwnProperty(d))return a.preventDefault(),void this.getMessageListItem(c)[d](f)}},reportAction:function(a){try{var b;b=1===a.length&&""===a[0]?"more":c.find(a,function(a){return"yj-view-thread"===a})?"view-thread":a[0];var e=["follow-thread-in-inbox","view-thread","add-topic","bookmark","email","delete-message"];c.find(e,function(a){return b===a})&&c.defer(function(){d.event("message_action",{method:b})})}catch(a){}}}}),define("feeds/lib/ui/feeds/thread_share_summary",["require","underscore","jquery","core/lib/jam/component","models/lib/helper/feed_factory","backbone","core/lib/tr","feeds/lib/ui/shared/excerpt","common-ui/lib/ui/shared/scroller"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/jam/component"),e=a("models/lib/helper/feed_factory"),f=a("backbone"),g=a("core/lib/tr"),h=a("feeds/lib/ui/shared/excerpt"),i=a("common-ui/lib/ui/shared/scroller");return d.extend({id:"threadShareSummary",data:{loadingConversations:g.t("loading_shared_conversations")},template:['<div class="yj-thread-share-summary">','<div class="yj-thread-shares"> ','  <div class="yj-spinner"><span class="yj-inline-spinner"></span>{{ loadingConversations }}</div>',"</div>",'<p class="yj-thread-share-summary-close"><button class="yj-btn">{{closeButtonText}}</button></p>',"</div>"].join(""),prepViewData:function(){return{closeButtonText:g.t("close")}},observeDomEvents:function(){this.$element.find(".yj-thread-share-summary-close").click(function(){f.trigger("/ui/lightbox/close")})},subscribeToData:function(){this.feed=e.findOrCreate("sharing",this.thread_id),this.feed.fetch().then(this.renderMessages.bind(this))},renderMessages:function(){var a=this.feed.getMessages(),d=this.$element.find(".yj-thread-shares");this.$element.find(".yj-spinner").hide(),b(a).each(function(a){a.isThreadStarter()&&h.generateMessageExcerpt(a.id,this.handleExcerpt.bind(this))},this),d.height()>=340?i(d,340,5):d.wrap("<div class = 'yj-scroller-viewport' />"),this.$element.find(".yj-thread-share-excerpt-container a").click(function(){f.trigger("/ui/lightbox/close")}),this.$element.find(".yj-thread-shares").append(c("<div class='yj-threadshare-warning' />").text(g.t("you_can_only_see_shares_to_groups_you_can_access"))),this.$element.trigger("resize")},handleExcerpt:function(a){var b=c(a);b.find(".expand-body").replaceWith("<span>&hellip;</span>"),b.find(".yj-thumbnail img").load(function(){b.trigger("resize")}),this.$element.find(".yj-thread-shares").append(b)},destroy:function(){this.feed.destroy()}})}),define("feeds/lib/ui/attachments/praise_helper",["require","underscore","core/lib/tr","models/lib/orm-models","components/hovercard_link/index"],function(a){var b=a("underscore"),c=a("core/lib/tr"),d=a("models/lib/orm-models"),e=a("components/hovercard_link/index");return{getPraiseMessageBody:function(a){var f=b.map(a,function(a){var b,c=d.User().findById(a);return c?(b=new e({model:c}),b.render().el.innerHTML):void 0});return c.t("praised_praisee_title",{praisee:c.tlist(f)})},getAlt:function(a){return this.ALT_MAP[a]},ICON_SPRITE_OFFESTS:{star:0,thumbsup:46,trophy:92,checkeredflag:138,lightbulb:184,graduationcap:230,money:276,ace:322,glasses:368,heart:414,doublerainbow:460,coffee:506,pie:552,diamond:598,monocle:644,ninja:690,gift:736,shamehat:782,crazygoat:828},ALT_MAP:{star:c.t("star_badge"),thumbsup:c.t("thumbs_up_badge"),trophy:c.t("trophy_badge"),checkeredflag:c.t("checkered_flag_badge"),lightbulb:c.t("light_bulb_badge"),graduationcap:c.t("graduation_cap_badge"),money:c.t("bag_of_money_badge"),ace:c.t("ace_badge"),glasses:c.t("glasses_badge"),heart:c.t("heart_badge"),doublerainbow:c.t("double_rainbow_badge"),coffee:c.t("coffee_badge"),pie:c.t("pie_badge"),diamond:c.t("diamond_badge"),monocle:c.t("monocle_badge"),ninja:c.t("ninja_badge"),gift:c.t("gift_badge"),shamehat:c.t("shamehat_badge"),crazygoat:c.t("crazy_goat_badge")}}}),define("feeds/lib/helper/message_header_helper",["require","jquery","underscore","backbone","feeds/lib/ui/shared/subscription_list_lightbox","core/lib/tr"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("feeds/lib/ui/shared/subscription_list_lightbox"),f=a("core/lib/tr");return{addTooltip:function(a){a.find(".yj-to-label-wrap .yj-status-icon").each(function(a,c){var e=b(c);d.trigger("/ui/tooltip/add",{target:e,text:e.data("desc")})})},addOthersLightBoxListener:function(a,b){a.find(".yj-message-others").first().click(c.bind(function(a){a.preventDefault(),a.stopPropagation(),new e({load:function(){this.loadItems(b.data.getNotifiedUsers())},settings:{title:f.t("people_who_were_sent_this_message"),open:!0}})},this))}}}),define("css!feeds/lib/ui/messages/message_likes",[],function(){}),define("stache!feeds/lib/ui/messages/message_likes",["mustache"],function(a){var b='<span class="yj-likes-text yj-message-likes--text">{{{text}}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_likes_other",["mustache"],function(a){var b='<a class="yj-message-likes--others-link" href="javascript://">{{others}}</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/messages/message_likes",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","components/hovercard_link/index","models/user","backbone","core/lib/session","core/lib/tr","feeds/lib/ui/shared/subscription_list_lightbox","css!./message_likes","html!./message_likes","html!./message_likes_other"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("components/hovercard_link/index"),f=a("models/user"),g=a("backbone"),h=a("core/lib/session"),i=a("core/lib/tr"),j=a("feeds/lib/ui/shared/subscription_list_lightbox");return a("css!./message_likes"),c.extend({mixins:[d],tagName:"p",className:"yj-message-likes yj-liked-by",template:a("html!./message_likes"),otherLikesTemplate:a("html!./message_likes_other"),events:{"click .yj-message-likes--icon":"onLikeClick","click .yj-message-likes--others-link":"onShowOtherLikes"},initialize:function(a){this.options=b.extend({},this.options,a)},onLikeClick:function(){this.trigger("toggleLike")},onShowOtherLikes:function(){this.showOtherLikes()},showOtherLikes:function(){new j({data:{message_id:this.model.id},settings:{title:i.t("people_who_like_this_message"),dataRequest:"getUsersWhoLikedMessage",open:!0},paginate:!0})},render:function(){return this.options.otherClassNames&&this.$el.addClass(this.options.otherClassNames),this.$likesText=this.$(".yj-likes-text"),this.$likesButton=this.$(".yamicon-like"),this.model&&this.model.getLikes().length>0?this.$el.show():this.$el.hide(),g.trigger("/ui/reflow/animate"),this},getTemplateData:function(){var a=h.getCurrentUser(),b=this.model,c=b.getLikes()||[],d=b.liked_by?b.liked_by.count:0,e=c.length>4?3:4,f={},g=d<c.length?c.length:d;return f.text=this._buildLikesText(a,e,g,c),f.title=b.isLikedBy(a)?i.t("stop_liking_this_message"):f.title=i.t("like_this_message"),f.yamiconIcon="yamicon-rd_like",f},_buildLikesText:function(a,c,d,e){var f,g=b.reject(e,function(b){return b.get("user_id")===a.id}),h=g.length!==e.length;return f=0===d?"":1===d&&h?this._buildOnlyCurrentUserText():1!==d||h?2===d&&h?this._buildCurrentUserWithOneOtherText(g):h?this._buildCurrentUserWithMultipleOthersText(g,c,d):this._buildMultipleOtherUsersText(g,c,d):this._buildSingleOtherUserText(g)},_buildOnlyCurrentUserText:function(){return i.t("current_user_likes_message")},_buildCurrentUserWithOneOtherText:function(a){var b=a.length>0?this._buildHovercardLink(a[0]):this._buildOtherText(1);return i.t("current_user_and_one_other_like_message",{other_user:b})},_buildSingleOtherUserText:function(a){var b=a.length>0?this._buildHovercardLink(a[0]):this._buildOtherText(1);return i.t("other_user_likes_message",{other_user:b})},_buildCurrentUserWithMultipleOthersText:function(a,b,c){var d=this._buildLikeList(a,b-1,c-1);return i.t("current_user_and_multiple_others_like_message",{other_users:d})},_buildMultipleOtherUsersText:function(a,b,c){var d=this._buildLikeList(a,b,c);return i.t("multiple_other_users_like_message",{other_users:d})},_buildLikeList:function(a,c,d){var e=b.first(a,c),f=b.map(e,this._buildHovercardLink),g=d-e.length;if(g>0){var h=this._buildOtherText(g);f.push(this.otherLikesTemplate({others:h}))}return i.tlist(f)},_buildOtherText:function(a){return i.t("count_others",{count:a})},_buildHovercardLink:function(a){var b=new f({id:a.get("user_id"),name:a.get("name"),network_id:a.get("network_id"),web_url:a.get("permalink")}),c=new e({model:b});return c.render().el.innerHTML}})}),define("core/lib/inbox_follow_delegate",["require","underscore","core/lib/backbone_base_class","core/lib/tr","core/lib/treatment","models/lib/events","backbone"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_class"),d=a("core/lib/tr"),e=a("core/lib/treatment"),f=a("models/lib/events"),g=a("backbone");return c.extend({initialize:function(a){this.model=a.model,this._isSyncing=!1,b.bindAll(this,"_onInboxFollowCreate","_onInboxFollowDestroy"),this.listenTo(f,"InboxFollow/create",this._onInboxFollowCreate),this.listenTo(f,"InboxFollow/destroy",this._onInboxFollowDestroy)},remove:function(){this.stopListening(),this.off()},toggleFollow:function(){this.model.isFollowedInInbox()?this.unfollow():this.follow()},follow:function(){this._sendRequest("follow",{successMessage:e.usePriorityCopy()?d.t("marked_as_priority_updates_will_now_appear_under_priority_conversation"):d.t("following_conversation_new_replies_will_now_appear_in_your_yammer"),errorMessage:e.usePriorityCopy()?d.t("there_was_an_error_marking_the_conversation_as_priority"):d.t("there_was_an_error_adding_the_message_to_your_inbox"),requestMethod:this.model.followInInbox})},unfollow:function(){var a,b;e.usePriorityCopy()?this.model.direct_message?(a=d.t("unfollowed_this_direct_message"),b=d.t("there_was_an_error_unfollowing_this_direct_message")):(a=d.t("removed_from_priority_updates_will_no_longer_appear_under_priority_conversations"),b=d.t("there_was_an_error_removing_the_conversation_from_priority")):(a=d.t("stopped_following_conversation_new_replies_will_no_longer_appear_in"),b=d.t("there_was_an_error_removing_the_message_from_your_inbox")),this._sendRequest("unfollow",{successMessage:a,errorMessage:b,requestMethod:this.model.unfollowInInbox})},_sendRequest:function(a,b){if(!this._isSyncing){var c=this;this._isSyncing=!0,b.requestMethod.call(this.model,{success:function(){g.trigger("/ui/alert/show","notice",b.successMessage)},error:function(){g.trigger("/ui/alert/show","error",b.errorMessage),c.trigger(a+"/error")},complete:function(){c._isSyncing=!1}})}},_onInboxFollowCreate:function(a){a.thread_id===this.model.id&&this.trigger("follow")},_onInboxFollowDestroy:function(a){a.thread_id===this.model.id&&this.trigger("unfollow")}})}),define("stache!common-ui/lib/ui/shared/tiny_follow_button_follow",["mustache"],function(a){var b='<span><span aria-hidden="true">{{text}}</span><span class="yj-acc-hidden">{{altText}}</span></span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/shared/tiny_follow_button_unfollow",["mustache"],function(a){var b='<span><span class="yamicon yamicon-checkmark yj-green yamicon-xxx-small"></span></span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/tiny_follow_button",["require","common-ui/lib/ui/shared/follow_button","core/lib/session","core/lib/tr","models/helpers/user","html!./tiny_follow_button_follow","html!./tiny_follow_button_unfollow"],function(a){var b=a("common-ui/lib/ui/shared/follow_button"),c=a("core/lib/session"),d=a("core/lib/tr"),e=a("models/helpers/user"),f=a("html!./tiny_follow_button_follow"),g=a("html!./tiny_follow_button_unfollow");return b.extend({tagName:"a",attributes:{href:"javascript://",role:"button"},defaults:{followTemplate:f,unfollowTemplate:g},initialize:function(){b.prototype.initialize.call(this);var a=e.getFollowing(c.getCurrentUser(),this.model.type);this.listenTo(a,"add push",this.onSubscriptionCreated),this.listenTo(a,"remove reset",this.onSubscriptionDestroyed)},initFollowingState:function(){this.options.following=e.isFollowing(c.getCurrentUser(),this.model.type,this.model.id)},getTemplateData:function(){var a=b.prototype.getTemplateData.call(this);return a.altText=d.t("follow_user",{user:this.model.full_name}),a},updateButtonState:function(){this.$el.removeClass("yj-btn yj-btn-alt yj-btn-tiny yj-follow-button-tiny-following"),b.prototype.updateButtonState.call(this)},getButtonClassName:function(){var a=this.options.elementClassName||"";return a+=this.isFollowing()?" yj-follow-button-tiny yj-follow-button-tiny-following":" yj-btn yj-btn-alt yj-btn-tiny yj-follow-button-tiny"},getButtonText:function(){return this.isFollowing()?"":this.strings.follow},getTooltipText:function(){var a=this.model.full_name||this.model.name;return this.isFollowing()?"":d.t("follow_name",{name:a})},handleClick:function(a){a.preventDefault(),this.isFollowing()||this.isLoading()||b.prototype.handleClick.apply(this,arguments)},handleSubscribe:function(){b.prototype.handleSubscribe.call(this),this.$el.css("display","inline-block").delay(3e3).hide(0,this.clearInlineStyle.bind(this))},onSubscriptionCreated:function(a){a.id===this.model.id&&(this.initFollowingState(),this.updateButtonState())},onSubscriptionDestroyed:function(a){a.id===this.model.id&&(this.initFollowingState(),this.updateButtonState(),this.$el.show(this.clearInlineStyle.bind(this)))},clearInlineStyle:function(){this.$el.css("display","")},remove:function(){this.stopListening()}})}),define("css!feeds/lib/ui/attachments/deleted_attachment_view",[],function(){}),define("stache!feeds/lib/ui/attachments/deleted_attachment_view",["mustache"],function(a){var b='{{{deletedIcon}}}\n<div class="yj-deleted-attachment-view--content yj-excerpt-content">\n  {{message}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/deleted_attachment_view",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","common-ui/lib/helper/svg_icon","css!./deleted_attachment_view","html!./deleted_attachment_view"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("common-ui/lib/helper/svg_icon");return a("css!./deleted_attachment_view"),b.extend({mixins:[c],className:"yj-deleted-attachment-view yj-yamio-preview yj-excerpt-deleted-attachment yj-clearfix",template:a("html!./deleted_attachment_view"),getTemplateData:function(){var a=this.model;return{id:a.id,message:this._createMessage(a.real_type),deletedIcon:e("docicon-big-delete",{classList:"yj-deleted-attachment-view--icon",width:60,height:60})}},_createMessage:function(a){switch(a){case"uploaded_file":return d.t("the_attached_file_has_been_deleted");case"page":return d.t("the_attached_note_has_been_deleted")}return d.t("the_attachment_has_been_deleted")}})}),define("stache!feeds/lib/ui/attachments/ogo_web_video_player_youTubeTemplate",["mustache"],function(a){var b='<div class="yj-ogo-attachment--content-embedded-video">\n  <iframe title="YouTube video player" width="{{width}}" height="{{height}}"\n          src="https://www.youtube.com/embed/{{id}}?rel=0&autoplay=1&wmode=transparent" frameborder="0"\n          allowfullscreen></iframe>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/attachments/ogo_web_video_player_vimeoTemplate",["mustache"],function(a){var b='<div class="yj-ogo-attachment--content-embedded-video">\n  <iframe src="https://player.vimeo.com/video/{{id}}?autoplay=1&wmode=transparent" width="{{width}}" height="{{height}}"\n          frameborder="0" {{#minWidth}}style="min-width: {{minWidth}}"{{/minWidth}}>\n</div>\n';
return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/ogo_web_video_player",["require","core/lib/uri_helper","html!./ogo_web_video_player_youTubeTemplate","html!./ogo_web_video_player_vimeoTemplate"],function(a){"use strict";var b=a("core/lib/uri_helper"),c={play:function(a){var b=a.$container,c=a.attachment;b.hasClass("yj-video")||(b.addClass("yj-video"),b.html(this._getVideoTemplate(c)))},_getVideoTemplate:function(a){var c,d,e,f,g,h=b.parse(a.web_url);if(this._isYouTube(h))d=this._getYouTubeId(a.web_url),c=this._youTubeTemplate,e="100%",g="100%";else{if(!this._isVimeo(h))throw new Error('Cannot embed video for "'+a.web_url+'".');d=h.path.match(/^\/(\d+)$/)[1],c=this._vimeoTemplate,e="100%",g="100%",f=void 0}return c({id:d,width:e,height:g,minWidth:f})},_youTubeTemplate:a("html!./ogo_web_video_player_youTubeTemplate"),_vimeoTemplate:a("html!./ogo_web_video_player_vimeoTemplate"),_isYouTube:function(a){return a.host.match(/youtube.com$/)&&"/watch"===a.path||a.host.match(/youtu.be$/)},_getYouTubeId:function(a){var b=/(?:.be\/|\/watch\?v=|\/(?=p\/))([\w\/\-]+)/;return a.match(b)[1]},_isVimeo:function(a){return a.host.match(/vimeo.com$/)}};return c}),define("common-ui/lib/ui/general/actions/open_graph_object_detail",["require","common-ui/lib/ui/general/actions/attachment_detail","core/lib/tr","core/lib/urls"],function(a){var b=a("common-ui/lib/ui/general/actions/attachment_detail"),c=a("core/lib/tr"),d=a("core/lib/urls");return b.extend({data_resource_model:"open_graph_object",title:c.t("view_page"),word:c.t("go_to_page"),initialize:function(a){b.prototype.initialize.apply(this,arguments),this.url=d.ogoIndex({id:a.file.record_id})}})}),define("common-ui/lib/ui/general/actions/share_open_graph_object",["require","common-ui/lib/ui/general/actions/share_file","core/lib/tr"],function(a){var b=a("common-ui/lib/ui/general/actions/share_file"),c=a("core/lib/tr"),d=b.extend({modelType:"open_graph_object",altWord:c.t("share_this_link")});return d}),define("stache!feeds/lib/ui/attachments/ogo_attachment_view",["mustache"],function(a){var b='<div class="yj-ogo-attachment--content yj-open-graph-contents yj-clearfix {{^hasThumbnail}}has-no-thumbnail yj-open-graph-no-image{{/hasThumbnail}}">\n  {{#hasThumbnail}}\n  <div class="yj-ogo-attachment--thumbnail yj-thumbnail">\n    <div class="yj-ogo-attachment--thumbnail-img-container yj-img-container" style="background-image: url({{thumbnailUrl}})">\n      <a href="{{webUrl}}" target="_blank" rel="nofollow noreferrer" tabindex="-1" aria-hidden="true"></a>\n      <img class="yj-ogo-attachment--thumbnail-img" src="{{thumbnailUrl}}" alt="{{name}}" />\n      {{#video}}<div class="yj-play-button">{{{playIconSvg}}}{{! HTML from svg_helper }}</div>{{/video}}\n    </div>\n  </div>\n  {{/hasThumbnail}}\n  <div class="yj-ogo-attachment--text-container">\n    <h6 class="yj-ogo-attachment--subtitle yj-subtitle" role="presentation"><span>{{host}}</span></h6>\n    <h5 class="yj-ogo-attachment--title yj-title" role="presentation">\n      <a href="{{webUrl}}" class="yj-ogo-attachment--title-link" target="_blank" rel="nofollow noreferrer">{{name}}</a>\n    </h5>\n    {{#description}}\n    <p class="yj-ogo-attachment--description yj-description"><span>{{description}}</span></p>\n    {{/description}}\n  </div>\n</div>\n<div class="yj-ogo-attachment--actions"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/ogo_attachment_view",["require","underscore","core/lib/backbone_legacy_integration","common-ui/lib/ui/general/hover_bar","feeds/lib/ui/attachments/ogo_web_video_player","core/lib/string_helper","core/lib/uri_helper","core/lib/yammer_uri","common-ui/lib/ui/general/actions/open_graph_object_detail","common-ui/lib/ui/general/actions/share_open_graph_object","common-ui/lib/ui/general/actions/follow","core/lib/secure_opener","core/lib/yammer_api","models/helpers/attachment","common-ui/lib/ui/keyboard/navigable_element_adaptor","collections/groups","models/helpers/group","common-ui/lib/helper/svg_icon","html!./ogo_attachment_view"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_legacy_integration"),d=a("common-ui/lib/ui/general/hover_bar"),e=a("feeds/lib/ui/attachments/ogo_web_video_player"),f=a("core/lib/string_helper"),g=a("core/lib/uri_helper"),h=a("core/lib/yammer_uri"),i=a("common-ui/lib/ui/general/actions/open_graph_object_detail"),j=a("common-ui/lib/ui/general/actions/share_open_graph_object"),k=a("common-ui/lib/ui/general/actions/follow"),l=a("core/lib/secure_opener"),m=a("core/lib/yammer_api"),n=a("models/helpers/attachment"),o=a("common-ui/lib/ui/keyboard/navigable_element_adaptor"),p=a("collections/groups"),q=a("models/helpers/group"),r=a("common-ui/lib/helper/svg_icon");return c.extend({className:function(){var a="yj-ogo-attachment yj-open-graph-object ymodule-instance";return a+=" yj-yamio-preview yj-yamio-click yj-want-focuswithin",n.isVideoOgo(this.model)&&(a+=" yj-video yj-video-preview"),a},events:{"click .yj-ogo-attachment--content":"_onClick"},template:a("html!./ogo_attachment_view"),initialize:function(a){this._createHoverbar(),a.navigator&&(this.navigableElementAdaptor=new o({navigator:a.navigator,model:this.model,rootElement:this.$el,focusTarget:"a:not([tabindex=-1])"}),this.isNavigable=!0)},_createHoverbar:function(){this.hoverbar=new d({actions:this._getHoverbarActions()}),this.add(this.hoverbar,".yj-ogo-attachment--actions")},render:function(){var a=this._getTemplateData();return this.renderTemplate(a),this},remove:function(){this.navigableElementAdaptor&&this.navigableElementAdaptor.stop()},_getTemplateData:function(){var a=this._getDisplayConstants(),b=a.titleLineLength,c=a.descriptionCharCount,d=this.model.web_url;try{d=decodeURI(d)}catch(a){}return{hasThumbnail:!!this.model.thumbnail_url,thumbnailUrl:this._getThumbnailUrl(),host:this.model.host_url||g.parse(d).host,webUrl:d,video:n.isVideoOgo(this.model),thirdParty:this.model.client_application_icon,objectType:this.model.object_type,name:f.truncate(this.model.name||d,b),description:f.truncate(this.model.description,c),playIconSvg:r("play_video",{width:30,height:30})}},_getThumbnailUrl:function(){return this.model.client_application_icon||this.model.thumbnail_url},_getHoverbarActions:function(){var a=p.get(this.model.group_id),b=new i({file:this.model}),c=new j({file:this.model}),d=new k({file:this.model,data:{type:"open_graph_object",id:this.model.id}}),e=n.isPrivate(this.model)||a&&q.isPrivate(a);return e?[d,b]:[d,c,b]},_getDisplayConstants:function(){var a=b.first(n.getMessages(this.model)).isThreadStarter();return a?{titleLineLength:88,descriptionCharCount:145,thumbnailDims:{w:100,h:100}}:{titleLineLength:88,descriptionCharCount:80,thumbnailDims:{w:75,h:75}}},_onClick:function(a){var b=this.$(".yj-ogo-attachment--title-link").attr("href");m.recordOpenGraphClick({url:b}),a.preventDefault(),a.stopPropagation(),n.isVideoOgo(this.model)?this._playVideo():n.isThirdPartyOgo(this.model)?this._goToYammerOpenGraphPage():this._goToExternalLink(b)},_playVideo:function(){this.$el.addClass("yj-video-on"),e.play({attachment:this.model,$container:this.$(".yj-ogo-attachment--content")}),this.hoverbar.remove()},_goToYammerOpenGraphPage:function(){window.location=h.app("graph/"+this.model.record_id)},_goToExternalLink:function(a){l.open(a,"_blank")}})}),define("stache!feeds/lib/ui/attachments/page_inline_view_follow",["mustache"],function(a){var b='<span><span class="yamicon yamicon-plus"></span>{{text}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/attachments/page_inline_view_unfollow",["mustache"],function(a){var b='<span><span class="yamicon yamicon-dash"></span>{{mouseoverText}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/attachments/page_inline_view",[],function(){}),define("stache!feeds/lib/ui/attachments/page_inline_view",["mustache"],function(a){var b='<div class="yj-page-inline-view yj-yamio-preview yj-yamio-click yj-want-focuswithin">\n  <div class="yj-page-inline-view--thumbnail yj-thumbnail" aria-hidden="true">\n    <div class="yj-page-inline-view--icon">\n      {{{svgIcon}}}{{! generated HTML }}\n    </div>\n  </div>\n  <div class="yj-page-inline-view--content yj-yamio-content">\n    <div class="yj-yamio-inner">\n      {{#subtitle}}\n        <h6 class="yj-page-inline-view--content--subtitle yj-subtitle" role="presentation">\n          {{{subtitle}}}\n        </h6>\n      {{/subtitle}}\n      {{#title}}\n        <a href="javascript://" role="button" class="yj-page-inline-view--name yj-name">\n          {{title}} {{#isDraft}}(Draft){{/isDraft}}\n        </a>\n      {{/title}}\n      {{#description}}\n        <p class="yj-page-inline-view--description yj-description">{{description}}</p>\n      {{/description}}\n    </div>\n  </div>\n  {{#showActions}}\n  <div class="yj-page-inline-view--actions yj-actions">\n    <ul>\n      <li class="yj-page-inline-view--action-follow yj-action-follow">\n        {{^isForeign}}\n          <FollowButtonView key="followBtn" />\n        {{/isForeign}}\n      </li>\n      {{^isForeign}}\n      {{^isPrivate}}\n        <li class="yj-page-inline-view--action-share yj-share-file">\n          <a href="javascript://" role="button" title="{{shareLabel}}" class="yj-share-file">\n            <span class="yamicon yamicon-regular yamicon-rd_share"></span>\n            {{shareLabel}}\n          </a>\n        </li>\n      {{/isPrivate}}\n      {{/isForeign}}\n      <li class="yj-page-inline-view--goto yj-detail">\n        <a href="{{url}}" title="{{goToLabel}}" class="yj-detail">\n          <span class="yamicon yamicon-regular yamicon-rd_right_arrow"></span>\n          {{goToLabel}}\n        </a>\n      </li>\n    </ul>\n  </div>\n  {{/showActions}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/page_inline_view",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","backbone","core/lib/tr","core/lib/yammer_uri","common-ui/lib/helper/svg_icon","models/helpers/user","models/helpers/file","components/hovercard_link/index","collections/groups","models/group","models/attachment","models/helpers/attachment","feeds/lib/ui/publisher/global/publisher_helper","common-ui/lib/ui/shared/follow_button","common-ui/lib/ui/keyboard/navigable_element_adaptor","core/lib/urls","core/lib/session","feeds/lib/modules/attachments","html!./page_inline_view_follow","html!./page_inline_view_unfollow","css!./page_inline_view","html!./page_inline_view"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("backbone"),h=a("core/lib/tr"),i=a("core/lib/yammer_uri"),j=a("common-ui/lib/helper/svg_icon"),k=a("models/helpers/user"),l=a("models/helpers/file"),m=a("components/hovercard_link/index"),n=a("collections/groups"),o=a("models/group"),p=a("models/attachment"),q=a("models/helpers/attachment"),r=a("feeds/lib/ui/publisher/global/publisher_helper"),s=a("common-ui/lib/ui/shared/follow_button"),t=a("common-ui/lib/ui/keyboard/navigable_element_adaptor"),u=a("core/lib/urls"),v=a("core/lib/session");a("feeds/lib/modules/attachments");var w=a("html!./page_inline_view_follow"),x=a("html!./page_inline_view_unfollow");return a("css!./page_inline_view"),d.extend({mixins:[e,f],template:a("html!./page_inline_view"),className:"ymodule-instance",views:{FollowButtonView:"_getFollowButton"},events:{click:"_onClick"},initialize:function(a){if(a=c.extend({},this.defaults,a),this.model=a.model,b("body").hasClass("yj-touch")){var d=this.$el;d.append('<span class="yj-inline-icon yj-align-icon add-icon yj-hover-touch"></span>'),this.events["click.touch"]=function(a){a.preventDefault(),a.stopPropagation(),d.find(".yj-hover-touch").hide(),d.addClass("yj-highlight"),delete this.events["click.touch"],this.delegateEvents()},this.delegateEvents()}this.options.navigator&&(this.navigableElementAdaptor=new t({navigator:this.options.navigator,model:this.model,rootElement:this.$el,focusTarget:"a:first"}),this.isNavigable=!0)},getTemplateData:function(){var a,b,d=this.model,e=d.group_id?n.get(d.group_id):o.ALL_COMPANY(),f=d instanceof p,g=q.isForeign(d,v),k=f?!!d.draft:!!d.last_published_at,r=!this._isFullPageViewable(d),s=r?d.api_preview_url:u.noteIndex(d);if(!g&&e){b=new m({model:e});var t="&rsaquo;";a=e&&h.t("posted_in_container",{container:b.render().el.innerHTML+' <span aria-hidden="true">'+t+'</span> <a href="'+c.escape(u.groupIndex(e)+"/notes")+'">Notes</a>'})}var w={url:s,previewLabel:h.t("preview_2"),iconUrl:i.cdn("assets/images/pages/page_icon.png?_=2"),title:d.name,subtitle:a,description:d.description,isDraft:k,isPrivate:l.isPrivate(d),shareLabel:h.t("share_2"),goToLabel:k?h.t("edit_note"):h.t("go_to_note_2"),isForeign:g,showActions:this._areActionsShown(d),svgIcon:j("docicon-big-note",{width:60,height:60})};return w},_isFullPageViewable:function(a){var b=this._isCurrentUserMemberOfPagesGroup(a);return!q.isForeign(a,v)||b},_isCurrentUserMemberOfPagesGroup:function(a){var b=q.isForeign(a,v),c=!b&&!a.group_id,d=n.get(a.group_id);return c||d&&!!k.isMemberOf(v.getCurrentUser(),d)},_areActionsShown:function(a){var b=q.isOwnedByUser(a,v.getCurrentUser()),c=q.isForeign(a,v);return b||!c||this._isCurrentUserMemberOfPagesGroup(a)},remove:function(){return this.navigableElementAdaptor&&this.navigableElementAdaptor.stop(),d.prototype.remove.call(this)},_onClick:function(a){var b=this.model,d=b;if(!(b instanceof p)){var e=p.findFirst({real_id:b.id,real_type:b.type,type:"ymodule"}),f=function(){return new p(c.omit(b,"id","_repository","_keyName"))}();d=e||f}this._openLightBox(a,d)},_openLightBox:function(a,c){var d=b(a.target).closest(".yj-actions a, .yj-subtitle a",a.currentTarget)[0];if(!d){var e=c&&c.id?{attachmentId:c.id}:{attachment:c},f=b(a.target).parents("[data-thread-id]");return f.length>0&&(e.threadId=f.data("thread-id")),g.trigger("/ui/fancy-lightbox/open",e),!1}return b(d).hasClass("yj-share-file")?(r.openShareLightbox({type:"page",id:c.real_id,image:i.cdn("assets/images/pages/page_icon.png?_=2"),title:c.name,group_id:c.group_id||void 0,source:"actions_bar"}),!1):void 0},_getFollowButton:function(){var a=this.model,b=a instanceof p;return new s({model:{type:"page",id:b?a.real_id:a.id,name:a.name,declaredClass:"!danger!"},tagName:"a",className:"yj-action-follow",attributes:{href:"javascript://"},useButtonClassNames:!1,followTemplate:w,unfollowTemplate:x})}})}),define("css!feeds/lib/ui/attachments/praise_view",[],function(){}),define("stache!feeds/lib/ui/attachments/praise_view",["mustache"],function(a){var b='<figure class="yj-praise-view--icon">\n  {{{svgPraiseIcon}}}{{! HTML rendered from svgIcon}}\n</figure>\n<p class="yj-praise-view--title">{{{title}}}</p>\n<p class="yj-praise-view--comment">"{{{comment}}}"</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/praise_view",["require","underscore","backbone","core/lib/util/emoji_helper","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","feeds/lib/ui/attachments/praise_helper","common-ui/lib/helper/svg_icon","css!./praise_view","html!./praise_view"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/util/emoji_helper"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("feeds/lib/ui/attachments/praise_helper"),h=a("common-ui/lib/helper/svg_icon");return a("css!./praise_view"),e.extend({mixins:[f],className:"yj-praise-view ymodule-instance reloadable",template:a("html!./praise_view"),attributes:function(){return{"data-ymodule-instance":this.model.id,"data-praise-id":this.model.id,"data-qaid":"praise-section"}},getTemplateData:function(){var a=b.escape(this.model.comment),c=b.clone(this.model);return c=b.extend(c,{iconOffset:g.ICON_SPRITE_OFFESTS[this.model.icon],comment:d.parse(a),alt:g.getAlt(this.model.icon)}),c.svgPraiseIcon=h("praise-"+this.model.icon,{width:32,height:32}),c.title=this.options.title,c},render:function(){return c.trigger("/ui/hovercard/build",this.$el,".yj-hovercard-link"),this}})}),define("feeds/lib/ui/attachments/private_group_attachment_view",["require","core/lib/jam/component","components/hovercard_link/index","core/lib/tr","collections/groups","core/lib/urls","core/lib/yammer_uri"],function(a){var b=a("core/lib/jam/component"),c=a("components/hovercard_link/index"),d=a("core/lib/tr"),e=a("collections/groups"),f=a("core/lib/urls"),g=a("core/lib/yammer_uri");return b.extend({defaults:{id:"PrivateGroupAttachmentView"},template:'<div class="yj-excerpt-container yj-excerpt-private-group {{^groupMeta}}yj-excerpt-private {{/groupMeta}}yj-clearfix"><img class="yj-excerpt-icon" src="{{iconImage}}" alt=""><div class="yj-excerpt-content">{{message}}{{#groupMeta}}<p class="yj-excerpt-meta-content">{{userAction}} {{{groupLink}}}{{#locationLink}}<span class="yamicon yamicon-right-arrow yj-location-arrow"></span> {{{locationLink}}}{{/locationLink}}</p>{{/groupMeta}}</div></div>',init:function(a){this.data=a.model,b.prototype.init.call(this,{id:this.id})},prepViewData:function(a){var b=e.get(a.group_id);if(b){var d=new c({model:b});return{iconImage:g.cdn("assets/images/icons/private-group-attachment.png"),id:a.id,message:this._createMessage(a.real_type),groupMeta:!0,groupLink:d.render().el.innerHTML,locationLink:this._createLocationLink(a.real_type,b),userAction:this._createUserAction(a.real_type)}}return{id:a.id,message:this._createMessage(a.real_type)}},_createLocationLink:function(a,b){var c,e;return"page"===a?(c=f.groupIndex(b)+"/notes",e=d.t("notes")):(c=f.groupIndex(b)+"/uploaded_files",e=d.t("files")),'<a href="'+c+'">'+e+"</a>"},_createUserAction:function(a){return"uploaded_file"===a?d.t("uploaded_to"):d.t("posted_in")},_createMessage:function(a){var b;return b="page"===a?d.t("the_attached_note_is_in_a_private_group"):d.t("the_attached_file_is_in_a_private_group")}})}),define("feeds/lib/ui/attachments/private_graph_attachment_view",["require","feeds/lib/ui/attachments/private_group_attachment_view","core/lib/tr"],function(a){var b=a("feeds/lib/ui/attachments/private_group_attachment_view"),c=a("core/lib/tr");return b.extend({id:"PrivateGraphAttachmentView",init:function(a){b.prototype.init.call(this,a)},prepViewData:function(a){return{id:a.id,message:c.t("private_attachment_message"),groupMeta:!1,groupLink:"",locationLink:"",userAction:""}}})}),define("feeds/lib/ui/attachments/undefined_attachment_view",["require","core/lib/backbone_base_view"],function(a){var b=a("core/lib/backbone_base_view");return b.extend({className:"yj-undefined-attachment-view"})}),define("stache!feeds/lib/ui/attachments/ymodule_view_follow",["mustache"],function(a){var b='<span class="yj-show-follow"><span class="yamicon yamicon-plus"></span>{{text}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/attachments/ymodule_view_unfollow",["mustache"],function(a){var b='<span class="yamicon yamicon-dash"></span>{{mouseoverText}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/attachments/ymodule_view",[],function(){}),define("feeds/lib/ui/attachments/ymodule_view",["require","jquery","underscore","common-ui/lib/ui/shared/follow_button","core/lib/jam/component","backbone","core/lib/tr","core/lib/yammer_uri","core/lib/yammer_api","common-ui/lib/helper/html_truncator","mustache","html!./ymodule_view_follow","html!./ymodule_view_unfollow","css!./ymodule_view"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/shared/follow_button"),e=a("core/lib/jam/component"),f=a("backbone"),g=a("core/lib/tr"),h=a("core/lib/yammer_uri"),i=a("core/lib/yammer_api"),j=a("common-ui/lib/helper/html_truncator"),k=a("mustache"),l=a("html!./ymodule_view_follow"),m=a("html!./ymodule_view_unfollow");return a("css!./ymodule_view"),e.extend(new function(){this.init=function(a){a&&(a=a.model),this._object=a,e.prototype.init.call(this,{id:"YmoduleView"})},this.template='<div data-ymodule-instance="{{id}}" class="yj-ymodule-view ymodule-instance reloadable">{{{inline_html}}}</div>',this.createElement=function(){var e=this._object,f={inline_html:e.inline_html,id:e.id},g=b(k.render(this.template,f));if(e.inline_html||i.getAttachmentInlineHtml({ymodule_id:e.id}).then(function(b){g.html(b),a(g,e)}),a(g,e),"announcements"===e.ymodule.app_id){var h=".ymodule-instance-"+e.id+"-announcement-body",n=g.find(h),o=j.truncateWithLink(n.html());n.html(o)}if("page"===e.real_type){var p=new d({model:{type:"page",id:e.real_id,name:e.name},tagName:"a",className:"yj-action-follow",attributes:{href:"javascript://"},useButtonClassNames:!1,followTemplate:l,unfollowTemplate:m});g.find(".yj-actions ul").prepend(b('<li class="yj-action-follow"></li>').append(p.render().el))}var q=[/youtube.com\/watch/,/vimeo.com\/\d+/];return g.find(".yj-thumbnail a").each(function(){var a=b(this);c.each(q,function(b){var c=a.attr("href");c&&c.match(b)&&a.attr("data-action-onclick",'embedVideo(".container-2", "'+c+'");hide(".container-1");').append('<div class="yj-play-button"><div></div></div>')})}),g.find(".poll-icon").removeClass("poll-icon").addClass("yamicon yamicon-rd_poll"),this.$element=g},this.showEventOverlay=function(){var a={width:630,height:520,url:h.app()+"/events/"+this._object.id},b=this,c="<iframe src='{{url}}' style='overflow: hidden' scrolling='no'                     frameBorder='0' border='0'></iframe>",d=k.render(c,a);f.trigger("/ui/lightbox/open",{html:d,width:a.width,height:a.height,title:g.t("event"),onClosed:function(){yam.attachments.reloadInlineView(b._object.id,function(){b.observeDomEvents()})}})},this.observeDomEvents=function(){var a=this._object,c=this.$element,d=this;if(a.ymodule&&"events"===a.ymodule.app_id){var e=b("a",c);e.off("click"),e.on("click",function(a){d.showEventOverlay(a),a.preventDefault(),a.stopPropagation()})}if("page"===a.real_type){var g=b(".yj-page-inline-view",c);b("body").hasClass("yj-touch")&&(g.append('<span class="yamicon yamicon-inline yamicon-circle-add yj-hover-touch"></span>'),g.bind("click.touch",function(a){a.preventDefault(),a.stopPropagation(),g.find(".yj-hover-touch").hide(),g.addClass("yj-highlight"),g.unbind("click.touch")}));var h=a.id;c.on("click",function(a){var c=b(a.target).closest(".yj-actions a.yj-action-follow, .yj-actions a.yj-detail, .yj-subtitle a, .yj-actions a.yj-share-file",a.currentTarget)[0];if(!c){var d={attachmentId:h},e=b(a.target).parents("[data-thread-id]");return e.length>0&&(d.threadId=e.data("thread-id")),f.trigger("/ui/fancy-lightbox/open",d),!1}})}};var a=function(a,b){a.find("h6").attr("role","presentation"),a.find(".yj-thumbnail").attr("aria-hidden","true").find("a").attr("tabindex","-1"),a.find(".yj-name").wrap('<a href="javascript://"></a>'),a.find(".yj-yamio-preview").addClass("yj-want-focuswithin"),"polls"===b.ymodule.app_id&&(a.find("h4").attr("role","presentation"),a.find("table").attr("role","presentation"),a.find("a:not([href])").attr("href","javascript://"))}})}),define("feeds/lib/ui/attachments/attachment_view_factory",["require","feeds/lib/ui/attachments/deleted_attachment_view","feeds/lib/ui/attachments/ogo_attachment_view","feeds/lib/ui/attachments/page_inline_view","feeds/lib/ui/attachments/praise_view","feeds/lib/ui/attachments/private_graph_attachment_view","feeds/lib/ui/attachments/private_group_attachment_view","feeds/lib/ui/attachments/undefined_attachment_view","feeds/lib/ui/attachments/yamio_preview","feeds/lib/ui/attachments/ymodule_view","models/helpers/attachment"],function(a){var b=a("feeds/lib/ui/attachments/deleted_attachment_view"),c=a("feeds/lib/ui/attachments/ogo_attachment_view"),d=a("feeds/lib/ui/attachments/page_inline_view"),e=a("feeds/lib/ui/attachments/praise_view"),f=a("feeds/lib/ui/attachments/private_graph_attachment_view"),g=a("feeds/lib/ui/attachments/private_group_attachment_view"),h=a("feeds/lib/ui/attachments/undefined_attachment_view"),i=a("feeds/lib/ui/attachments/yamio_preview"),j=a("feeds/lib/ui/attachments/ymodule_view"),k=a("models/helpers/attachment"),l={display_as_file:i,page:d,ymodule:j,open_graph_object:c,praise:e,private_group_message_attachment:g,private_open_graph_object_attachment:f,deleted_message_attachment:b};return{pickView:function(a){var b=a.type;return k.isFile(a)||k.isUploadedFile(a)||k.isImage(a)?b="display_as_file":k.isNote(a)?b="page":k.isOgo(a)&&(b="open_graph_object"),l[b]||h},newInstance:function(a,b){b=b||{};var c=this.pickView(a);b.model=a;var d=new c(b);return d},supportedTypes:["image","uploaded_file","file","ymodule","open_graph_object","page","private_group_message_attachment","private_open_graph_object_attachment","deleted_message_attachment"]}}),define("css!components/image_gallery_spotlight/src/image_gallery_spotlight",[],function(){}),define("stache!components/image_gallery_spotlight/src/image_gallery_spotlight",["mustache"],function(a){var b='<figure class="yj-image-gallery-spotlight--container yj-want-focuswithin">\n  <a class="yj-image-gallery-spotlight--link" href="{{web_url}}" data-speechtip="{{speechtip}}">\n    <img class="yj-image-gallery-spotlight--image"\n    {{#scaled}}width="{{width}}" height="{{height}}" src="{{url}}"{{/scaled}}\n    alt="{{alt_text}}" title="{{name}}" data-qaid="image_attachments_spotlight_img" />\n  </a>\n  <HoverbarView key="hoverbar" />\n</figure>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/image_gallery_spotlight/src/image_gallery_spotlight",["require","jquery","underscore","backbone","core/lib/session","core/lib/yammer_uri","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/report","collections/groups","models/group","common-ui/lib/ui/general/hover_bar","common-ui/lib/ui/general/actions/attachment_detail","common-ui/lib/ui/general/actions/download","common-ui/lib/ui/general/actions/follow","common-ui/lib/ui/general/actions/share_file","common-ui/lib/ui/keyboard/navigable_element_adaptor","common-ui/lib/helper/ui","models/helpers/group","css!./image_gallery_spotlight","html!./image_gallery_spotlight"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/session"),f=a("core/lib/yammer_uri"),g=a("core/lib/backbone_base_view"),h=a("core/lib/backbone_with_auto_render"),i=a("core/lib/backbone_with_subviews"),j=a("core/lib/report"),k=a("collections/groups"),l=a("models/group"),m=a("common-ui/lib/ui/general/hover_bar"),n=a("common-ui/lib/ui/general/actions/attachment_detail"),o=a("common-ui/lib/ui/general/actions/download"),p=a("common-ui/lib/ui/general/actions/follow"),q=a("common-ui/lib/ui/general/actions/share_file"),r=a("common-ui/lib/ui/keyboard/navigable_element_adaptor"),s=a("common-ui/lib/helper/ui"),t=a("models/helpers/group");return a("css!./image_gallery_spotlight"),g.extend({mixins:[h,i],className:function(){var a=this.model.css_class||"";return"yj-image-gallery-spotlight "+a},attributes:{"data-qaid":"image-attachment-container"},template:a("html!./image_gallery_spotlight"),views:{HoverbarView:"_getHoverbarView"},events:{"click .yj-image-gallery-spotlight--container":"_handleClick"},initialize:function(){this.options.navigator&&(this.navigableElementAdaptor=new r({navigator:this.options.navigator,model:this.model,rootElement:this.$el,focusTarget:".yj-image-gallery-spotlight--link"}))},getTemplateData:function(){return this.model},render:function(){return this.$(".yj-image-gallery-spotlight--image").one("error",this._handleImageError.bind(this)).one("load",this._handleImageLoaded.bind(this)),this},remove:function(){return this.$(".yj-image-gallery-spotlight--image").off("error load"),this.navigableElementAdaptor&&this.navigableElementAdaptor.stop(),g.prototype.remove.call(this)},_handleClick:function(a){0===b(a.target).closest(".yj-hover-bar",this.$el).length&&(a.preventDefault(),this.trigger("click",this.model.id))},_getHoverbarView:function(){var a=this._getHoverbarMainAction(),b=this._getHoverbarMoreActions();return this.hoverbar=new m({actions:[a],moreMenuActions:b,model:this.model}),this._bindHoverbarEvents(),this.hoverbar},_bindHoverbarEvents:function(){var a="is-more-menu-open";this.listenTo(this.hoverbar,"moreMenuShown",function(){this.$el.addClass(a)}),this.listenTo(this.hoverbar,"moreMenuHidden",function(){this.$el.removeClass(a),b.browser.safari&&s.forceBrowserRepaint(),c.defer(function(){this.$(".yj-image-gallery-spotlight--container").scrollTop(0)}.bind(this))})},_getHoverbarMainAction:function(){return this._isForeign()||this._isInExternalGroup()||this._isPrivate()?this._instantiateHoverbarAction("download"):this._instantiateHoverbarAction("share")},_getHoverbarMoreActions:function(){return this._isPrivate()?[this._instantiateHoverbarAction("follow"),this._instantiateHoverbarAction("detail")]:this._isForeign()||this._isInExternalGroup()?[this._instantiateHoverbarAction("detail")]:this.isDirectMessage?[]:[this._instantiateHoverbarAction("follow"),this._instantiateHoverbarAction("download"),this._instantiateHoverbarAction("detail")]},_instantiateHoverbarAction:function(a){var b;switch(a){case"download":b=o;break;case"share":b=q;break;case"detail":b=n;break;case"follow":b=p}return new b({file:this.model})},_isForeign:function(){var a=e.getCurrentNetwork().id;return null!=this.model.network_id&&this.model.network_id!==a},_isInExternalGroup:function(){var a=this.model.group_id,b=a?k.get(a):l.ALL_COMPANY();return t.isExternal(b)},_isPrivate:function(){return"private"===this.model.privacy},_handleImageError:function(){try{throw new Error("ImageGallerySpotlight fileville image error")}catch(a){j.info({message:a.message},a)}this.$(".yj-image-gallery-spotlight--image").attr({width:"200",height:"200",src:f.cdn("assets/images/image_preview_default.png")})},_handleImageLoaded:function(){d.trigger("/gallery/spotlight/image/loaded",this.$el.find(".yj-image-gallery-spotlight--image"))}})}),define("components/image_gallery_spotlight/index",["require","./src/image_gallery_spotlight"],function(a){"use strict";return a("./src/image_gallery_spotlight")}),define("css!components/image_gallery_thumb/src/image_gallery_thumb",[],function(){}),define("stache!components/image_gallery_thumb/src/image_gallery_thumb",["mustache"],function(a){var b='<a class="yj-image-gallery-thumb--link" href="{{web_url}}" target="_blank"><img\n    data-speechtip="{{speechtip}}" alt="{{alt_text}}" title="{{name}}"\n    src="{{thumb_image}}" class="yj-image-gallery-thumb--image"\n/></a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/image_gallery_thumb/src/image_gallery_thumb",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/ui/keyboard/navigable_element_adaptor","core/lib/yammer_uri","css!./image_gallery_thumb","html!./image_gallery_thumb"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("common-ui/lib/ui/keyboard/navigable_element_adaptor"),f=a("core/lib/yammer_uri");return a("css!./image_gallery_thumb"),c.extend({mixins:[d],className:"yj-image-gallery-thumb",tagName:"li",template:a("html!./image_gallery_thumb"),attributes:{"data-qaid":"image_attachments_thumb"},events:{click:"_handleClick"},initialize:function(){this.options.navigator&&(this.navigableElementAdaptor=new e({navigator:this.options.navigator,model:this.model,rootElement:this.$el,focusTarget:".yj-image-gallery-thumb--link"}))},getTemplateData:function(){return b.extend(this.model,{thumb_image:this.model.thumbnail_url||this.model.large_icon_url})},render:function(){return this.$(".yj-image-gallery-thumb--image").one("error",this._handleImageError.bind(this)),this},remove:function(){return this.$(".yj-image-gallery-thumb--image").off(),this.navigableElementAdaptor&&this.navigableElementAdaptor.stop(),
c.prototype.remove.call(this)},_handleClick:function(a){a.preventDefault(),this.trigger("click",this.model.id)},_handleImageError:function(){this.$(".yj-image-gallery-thumb--image").attr({width:"60",height:"60",src:f.cdn("assets/images/image_preview_default_thumb.png")})}})}),define("components/image_gallery_thumb/index",["require","./src/image_gallery_thumb"],function(a){"use strict";return a("./src/image_gallery_thumb")}),define("css!components/image_gallery/src/image_gallery",[],function(){}),define("stache!components/image_gallery/src/image_gallery",["mustache"],function(a){var b='{{#has_spotlight_image}}<ImageGallerySpotlightView key="image-gallery-spotlight" />{{/has_spotlight_image}}\n<ul class="yj-image-gallery--thumbs-list">{{#thumbnails}}<ImageGalleryThumbView key="{{id}}" />{{/thumbnails}}</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/image_gallery/src/image_gallery",["require","underscore","core/lib/tr","backbone","core/lib/yammer_config","core/lib/uri_helper","core/lib/util/screen_helper","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/image_gallery_spotlight/index","components/image_gallery_thumb/index","css!./image_gallery","html!./image_gallery"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("backbone"),e=a("core/lib/yammer_config"),f=a("core/lib/uri_helper"),g=a("core/lib/util/screen_helper"),h=a("core/lib/backbone_base_view"),i=a("core/lib/backbone_with_auto_render"),j=a("core/lib/backbone_with_subviews"),k=a("components/image_gallery_spotlight/index"),l=a("components/image_gallery_thumb/index");a("css!./image_gallery");var m={threadStarter:{maxWidth:480,maxHeight:360,minWidth:200,minHeight:148},reply:{maxWidth:480,maxHeight:360,minWidth:200,minHeight:148}};return h.extend({mixins:[i,j],className:"yj-image-gallery",template:a("html!./image_gallery"),attributes:{"data-qaid":"image_attachments"},views:{ImageGallerySpotlightView:"_getImageGallerySpotlightView",ImageGalleryThumbView:"_getImageGalleryThumbView"},initialize:function(){var a=this.options.mode||"threadStarter";this._spotlightDimensions=m[a],this._spotlight=this._pickSpotlight(),this._thumbnails=this._spotlight?b.without(this.model,this._spotlight):this.model,this._prepareData()},addNavigableImageCandidates:function(){var a=this.options.attachmentNavigator.get("candidates"),b=[];this._spotlight&&b.push(this._spotlight),b=b.concat(this._thumbnails);var c=a.concat(b);this.options.attachmentNavigator.set("candidates",c)},getTemplateData:function(){return{has_spotlight_image:!!this._spotlight,thumbnails:this._thumbnails}},_prepareData:function(){this._spotlight&&b.extend(this._spotlight,{scaled:this._getScaledSpotlight(),css_class:this._getSpotlightCssClasses(),alt_text:this._getImageAltText(this._spotlight),speechtip:c.t("uploaded_image")}),b.each(this._thumbnails,function(a){b.extend(a,{speechtip:c.t("uploaded_image"),alt_text:this._getImageAltText(a)})},this)},_getSpotlightCssClasses:function(){var a=this._spotlight,b=[];return this._isShortImage(a)&&b.push("is-short"),this._isNarrowImage(a)&&b.push("is-narrow"),b.join(" ")},_getScaledSpotlight:function(){var a,b,c,d,e=this._spotlight,h=e.width,i=e.height;if(this._isBigImage(e)&&(a=this._spotlightDimensions.maxWidth/e.width,b=this._spotlightDimensions.maxHeight/e.height,c=Math.min(a,b),h=Math.round(e.width*c),i=Math.round(e.height*c)),"image/gif"===e.content_type)d=f.replaceParam(e.preview_url,{tracking:!1});else if(e.scaled_url){var j=g.getPixelRatio();d=e.scaled_url.replace("{{width}}",h*j).replace("{{height}}",i*j)}return{url:d,width:h,height:i}},_getImageAltText:function(a){return c.t("uploaded_image")+": "+(a.description||c.t("no_description_set"))},_pickSpotlight:function(){var a,c=this.model,d=b.chain(c).filter(function(a){return a.height&&a.width&&a.scaled_url}).tap(function(b){a=b}).find(this._isBigImage,this).value();return d=d?d:b.first(a),e.config().isEmbed?void 0:d},_isShortImage:function(a){return a.height<this._spotlightDimensions.minHeight},_isNarrowImage:function(a){return a.width<this._spotlightDimensions.minWidth},_isBigImage:function(a){return a.width>this._spotlightDimensions.maxWidth||a.height>this._spotlightDimensions.maxHeight},_getImageGallerySpotlightView:function(){var a=new k({model:this._spotlight,navigator:this.options.attachmentNavigator});return this._addClickListener(a),a},_getImageGalleryThumbView:function(a){var c=new l({model:b.findWhere(this._thumbnails,{id:parseInt(a,10)}),navigator:this.options.attachmentNavigator});return this._addClickListener(c),c},_addClickListener:function(a){this.listenTo(a,"click",b.bind(function(a){d.trigger("/ui/fancy-lightbox/open",{attachmentId:a,threadId:this.options.threadId})},this))}})}),define("components/image_gallery/index",["require","./src/image_gallery"],function(a){"use strict";return a("./src/image_gallery")}),define("css!feeds/lib/ui/messages/message_attachments",[],function(){}),define("stache!feeds/lib/ui/messages/message_attachments",["mustache"],function(a){var b='<div class="yj-message-attachments yj-attachments {{^has_attachments}}is-empty{{/has_attachments}}">\n  <div class="yj-message-attachments--container" data-qaid="poll-file-attachment" {{^show_simple_attachments}}role="list"{{/show_simple_attachments}}></div>\n\n  {{#show_simple_attachments}}\n    <ul class="yj-message-attachments--simple-list">\n    {{#simple_attachments}}\n      <li class="yj-message-attachments--simple">\n        <a href="{{web_url}}" class="yj-message-attachments--simple-link" data-attachment-id="{{id}}">\n          {{{icon_type}}}{{! HTML generated by svg_icon helper }}\n          <span class="yj-acc-hidden">{{icon_alt_text}}</span>\n          <span class="yj-message-attachments--simple-label yj-label">{{name}}</span>\n        </a>\n      </li>\n    {{/simple_attachments}}\n    </ul>\n  {{/show_simple_attachments}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/messages/message_attachments",["require","underscore","backbone","feeds/lib/ui/attachments/attachment_view_factory","core/lib/jam/component2","core/lib/ctor","core/lib/filename_helper","components/image_gallery/index","common-ui/lib/helper/svg_icon","models/helpers/attachment","core/lib/tr","css!./message_attachments","html!./message_attachments"],function(a){var b=a("underscore"),c=a("backbone"),d=a("feeds/lib/ui/attachments/attachment_view_factory"),e=a("core/lib/jam/component2"),f=a("core/lib/ctor"),g=a("core/lib/filename_helper"),h=a("components/image_gallery/index"),i=a("common-ui/lib/helper/svg_icon"),j=a("models/helpers/attachment"),k=a("core/lib/tr");return a("css!./message_attachments"),f(null,e,{template:a("html!./message_attachments"),onLoad:function(){var a,d=this.data.getAttachments();d=b.reject(d,function(a){return"praise"===a.type}),d=this.sort(d),this.has_attachments=d.length>0,this.settings&&"function"==typeof this.settings.hideAttachments&&(d=b.reject(d,this.settings.hideAttachments)),this.settings&&"function"==typeof this.settings.showSimpleAttachments&&(a=b.filter(d,this.settings.showSimpleAttachments),d=b.difference(d,a)),this.attachments=d,this.simpleAttachments=a,this.attachmentNavigator&&(b.extend(this,c.Events),this.listenTo(this.attachmentNavigator,"getCandidates",this._getAttachmentNavigationCandiates))},_getAttachmentNavigationCandiates:function(){var a=this._attachmentsByType(this.attachments),c=a.module.concat(a.file),d=b.filter(c,function(a){return-1!=this.navigableAttachments.indexOf(a)},this);this.attachmentNavigator.set("candidates",d),this.trigger("append_image_navigation_candiates")},destroy:function(){this.stopListening&&this.stopListening(),e.prototype.destroy.call(this)},sort:function(a){var c=1,d=function(a){return a.type&&"praise"===a.type?0:c++};return b.sortBy(a,d)},_getSimpleAttachmentIconType:function(a){var b=j.isNote(a)?"note":g.getFileIconClass(a.name);return i("docicon-big-"+b,{width:16,height:16,classList:"yj-message-attachments--simple-icon"})},_getSimpleAttachmentIconAltText:function(a){if(j.isNote(a))return k.t("item_type_note");var b=g.getFileIconClass(a.name);return g.getFileIconClassAltText(b)},_convertToSimpleAttachment:function(a){var b={id:a.id,web_url:a.web_url,icon_type:this._getSimpleAttachmentIconType(a),icon_alt_text:this._getSimpleAttachmentIconAltText(a),name:a.full_name||a.name};return b},onTemplating:function(a){if(this.simpleAttachments&&(a.model.show_simple_attachments=!0,a.model.simple_attachments=b.map(this.simpleAttachments,this._convertToSimpleAttachment,this)),this.attachments){var c=this._attachmentsByType(this.attachments);this._createAttachments(c.module,".yj-message-attachments--container"),this._createAttachments(c.file,".yj-message-attachments--container"),this._createImages({images:c.image,mode:this.mode,isDirectMessage:this.direct_message})}return a.model.has_attachments=this.has_attachments,a},_createImages:function(a){var b;a.images.length>0&&(b=this._instantiageImageAttachments({data:a.images,mode:a.mode,isDirectMessage:a.isDirectMessage,attachPoint:".yj-message-attachments--files",attachMethod:"before",threadId:this.data.getThread().id}),this.add("imageAttachments",b))},_instantiageImageAttachments:function(a){var c=new h(b.extend(a,{model:a.data}));return c},_createAttachments:function(a,b){if(!this.__rendered){var c;this.attachmentNavigator&&!this.navigableAttachments&&(this.navigableAttachments=[]);for(var e=0;e<a.length;e++)c=d.newInstance(a[e],{navigator:this.attachmentNavigator}),c.attachPoint=b,this.addTo("attachmentView",c),this.attachmentNavigator&&c.isNavigable&&this.navigableAttachments.push(a[e])}},_attachmentsByType:function(a){var b=j.groupByType(a),c=b.previewableImage,d=[].concat(b.file).concat(b.nonPreviewableImage),e=b.other;return 1!==c.length||j.isSpotlightImage(c[0])||(d=d.concat(c),c=[]),{file:d,image:c,module:e}}})}),define("stache!feeds/lib/ui/threads/thread_action_menu",["mustache"],function(a){var b='{{#showShare}}\n  <li class="yj-message-action-list-item">\n    <a href="javascript://" title="{{shareTooltip}}" class="yj-share yj-message-action">\n      <span class="yamicon yamicon-share yj-message-action-icon"></span>\n      {{shareLabel}}\n    </a>\n  </li>\n{{/showShare}}\n\n<li class="yj-message-action-list-item">\n  <a href="javascript://" title="{{followTooltip}}" class="yj-follow-thread-in-inbox yj-message-action">\n    <span class="yamicon yamicon-flag yj-message-action-icon"></span>\n    {{followLabel}}\n  </a>\n</li>\n\n{{#showConversation}}\n  <li class="yj-message-action-list-item yj-view-thread-list-item">\n    <a href="{{conversationUrl}}" class="yj-message-action yj-view-thread" title="{{conversationTooltip}}">\n      <span class="yamicon yamicon-arrow-chat yj-message-action-icon"></span>\n      {{conversationLabel}}\n    </a>\n  </li>\n{{/showConversation}}\n\n{{#showTopics}}\n  <li class="yj-message-action-list-item">\n    <a href="javascript://" title="{{topicsTooltip}}" class="yj-add-topic yj-message-action">\n      <span class="yamicon yamicon-add-tag yj-message-action-icon"></span>\n      {{topicsLabel}}\n    </a>\n  </li>\n{{/showTopics}}\n\n{{#showBookmark}}\n  <li class="yj-message-action-list-item yj-bookmark-list-item">\n    <a href="javascript://" title="{{bookmarkTooltip}}" class="yj-bookmark yj-message-action">\n      <span class="yamicon yamicon-bookmark yj-message-action-icon"></span>\n      {{bookmarkLabel}}\n    </a>\n  </li>\n{{/showBookmark}}\n\n<li class="yj-message-action-list-item">\n  <a href="javascript://" title="{{emailTooltip}}" class="yj-email yj-message-action">\n    <span class="yamicon yamicon-message-MSFT yj-message-action-icon"></span>\n    {{emailLabel}}\n  </a>\n</li>\n\n{{#showDelete}}\n  <li class="yj-message-action-list-item yj-delete-message-list-item">\n    <a href="javascript://" title="{{deleteTooltip}}" class="yj-delete-message yj-message-action">\n      <span class="yamicon yamicon-stop yj-message-action-icon"></span>\n      {{deleteLabel}}\n    </a>\n  </li>\n{{/showDelete}}\n\n{{#showSpam}}\n  <li class="yj-message-action-list-item yj-report-spam-list-item">\n    <a href="javascript://" title="{{spamLabel}}" class="yj-report-spam yj-message-action">\n      <span class="yamicon yamicon-spam yj-message-action-icon"></span>\n      {{spamLabel}}\n    </a>\n  </li>\n{{/showSpam}}\n\n{{#showMute}}\n  <li class="yj-message-action-list-item">\n    <a href="javascript://" title="{{muteLabel}}" class="yj-mute yj-message-action">\n      <span class="yamicon yamicon-big-x yj-message-action-icon"></span>\n      {{muteLabel}}\n    </a>\n  </li>\n{{/showMute}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/threads/thread_action_menu",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/session","core/lib/tr","core/lib/treatment","core/lib/yammer_uri","models/helpers/user","models/helpers/message","html!./thread_action_menu"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/session"),e=a("core/lib/tr"),f=a("core/lib/treatment"),g=a("core/lib/yammer_uri"),h=a("models/helpers/user"),i=a("models/helpers/message");return b.extend({mixins:[c],tagName:"ul",className:"yj-thread-action-menu yj-menu yj-menu-shadow yj-click-menu",defaults:{displayShareLink:!1,displayMuteLink:!1},template:a("html!./thread_action_menu"),initialize:function(a){this.displayShareLink=a.displayShareLink,this.displayMuteLink=a.displayMuteLink,this.message=a.message},render:function(){return this.$el.attr("data-yamjs-id","message-more-menu-"+this.message.id),this},getTemplateData:function(){var a=this.message.isDirectMessage(),b=this._getFollowText(),c=this._getBookmarkText(),f=this.message.isForeign();return{showShare:this.displayShareLink,shareTooltip:e.t("share_this_message"),shareLabel:e.t("share_share_this_message"),followTooltip:b.tooltip,followLabel:b.label,showConversation:!a,conversationTooltip:e.t("view_this_message_as_part_of_its_conversation"),conversationLabel:e.t("view_conversation_view_this_message_as_part_of_its_conversation"),conversationUrl:g.app("/#/Threads/show?threadId="+this.message.thread_id),showTopics:!(f||a),topicsTooltip:e.t("add_topics_to_this_message"),topicsLabel:e.t("add_topics_add_topics_to_this_message"),showBookmark:!(f||a),bookmarkTooltip:c.tooltip,bookmarkLabel:c.label,emailTooltip:e.t("email_this_message_to_me"),emailLabel:e.t("email_me"),showDelete:!a&&h.canDeleteMessage(d.getCurrentUser(),this.message),deleteTooltip:e.t("delete_this_message"),deleteLabel:e.t("delete_delete_this_message"),showSpam:this._showSpam(),spamLabel:e.t("report_this_message_as_spam"),showMute:this.displayMuteLink,muteLabel:e.t("hide_conversation")}},_getFollowText:function(){var a,b,c=this.message.isFollowedInInbox();return c?(a=f.usePriorityCopy()?e.t("remove_from_priority"):e.t("stop_following"),b=f.usePriorityCopy()?e.t("remove_from_priority_to_stop_seeing_updates_under_priority_conversations"):e.t("followed_conversation_click_to_stop_seeing_replies_in_your_yammer")):(a=f.usePriorityCopy()?e.t("mark_as_priority"):e.t("follow_in_inbox"),b=f.usePriorityCopy()?e.t("mark_this_conversation_as_priority_to_be_notified_of_new_replies"):e.t("follow_this_conversation_to_see_new_replies_in_your_yammer")),{label:a,tooltip:b}},_getBookmarkText:function(){var a,b,c=i.isBookmarked(this.message);return c?(a=e.t("unbookmark"),b=e.t("remove_this_message_from_bookmarks")):(a=e.t("bookmark"),b=e.t("bookmark_this_message")),{label:a,tooltip:b}},_showSpam:function(){var a=this.message.getSender(),b=a&&a.getUser();return b&&h.isForeign(b,d)}})}),define("css!feeds/lib/ui/shared/sticker",[],function(){}),define("stache!feeds/lib/ui/shared/sticker",["mustache"],function(a){var b="<img src='{{src}}' alt='{{stickerAltText}}' class='yj-sticker-{{permalink}} yj-sticker--image' />\n";return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/shared/stickers",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/util/screen_helper","core/lib/yammer_uri","css!./sticker.css","html!./sticker"],function(a){var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/util/screen_helper"),e=a("core/lib/yammer_uri");return a("css!./sticker.css"),c.extend({mixins:[b],template:a("html!./sticker"),getTemplateData:function(){return{src:this._getAssetUrl(),stickerAltText:this.options.name,permalink:this.options.permalink}},_getAssetUrl:function(){return e.cdn("assets/images/chat_stickers/"+this._getResolution()+"/"+this.options.permalink+".png")},_getResolution:function(){var a=d.getPixelRatio();return 2===a?"size_20":"size_10"}})}),define("stache!components/metabar/src/others_link",["mustache"],function(a){var b='<a class="yj-message-others" href="javascript://" role="button">{{others_count}}</a>';return a.parse(b),function(c){return a.render(b,c)}}),define("components/metabar/src/to_users_markup",["require","underscore","core/lib/tr","core/lib/session","components/hovercard_link/index","html!./others_link"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("components/hovercard_link/index"),f=a("html!./others_link"),g=14,h=function(a,c){var e=d.getCurrentUser().id,f=c.getThread().getInvitedUsers();return b.sortBy(a,function(a){return a.id===e?0:b.contains(f,a)?1:2})};return function(a){var d=[],i=h(a.getNotifiedUsers(),a),j=b.first(i,g),k=b.rest(i,g);return b.each(j,function(a){var b=new e({model:a});d.push(b.render().el.innerHTML)}),b.isEmpty(k)||d.push(f({others_count:c.t("count_others",{count:k.length})})),d}}),define("stache!components/metabar/src/metabar",["mustache"],function(a){var b="{{prefix}} {{{recipients}}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/metabar/src/metabar",[],function(){}),define("components/metabar/src/metabar",["require","underscore","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","./to_users_markup","html!./metabar","css!./metabar.css"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("./to_users_markup"),g=a("html!./metabar");a("css!./metabar.css");var h=d.extend({mixins:[e],template:g,className:"yj-metabar",getTemplateData:function(){var a=f(this.model);return{prefix:c.t("carbon_copy"),recipients:c.tlist(a)}}});return h.shouldRender=function(a){var c=!b.isEmpty(a.getNotifiedUsers()),d=a.isSystemMessage(),e=a.isDirectMessage()&&!a.isSharedMessage();return!e&&!d&&c},h}),define("components/metabar/index",["require","./src/metabar"],function(a){"use strict";var b=a("./src/metabar");return b}),define("core/lib/backbone_with_timers",["require","underscore"],function(a){"use strict";var b=a("underscore"),c={},d={},e=function(a){var c=b.rest(arguments);return a=a.bind(this),[a].concat(c)},f=function(){var a=setTimeout.apply(window,e.apply(this,arguments));j(this).push(a)},g=function(){var a=setInterval.apply(window,e.apply(this,arguments));k(this).push(a)},h=function(a){clearTimeout(a)},i=function(a){clearInterval(a)},j=function(a){return c[a.cid]||(c[a.cid]=[])},k=function(a){return d[a.cid]||(d[a.cid]=[])},l=function(a){b.each(j(a),h),delete c[a.cid]},m=function(a){b.each(k(a),i),delete d[a.cid]},n=function(a,c,d){return c.remove&&(c.remove=b.wrap(c.remove,o)),a.call(this,c,d)},o=function(a){return l(this),m(this),a.call(this)},p=function(){this.constructor.extend=b.wrap(this.constructor.extend,n),this.remove=b.wrap(this.remove,o),this.setTimeout=f,this.setInterval=g};return p}),define("css!components/message_timestamp/src/message_timestamp",[],function(){}),define("stache!components/message_timestamp/src/message_timestamp",["mustache"],function(a){var b="{{timeago}}";return a.parse(b),function(c){return a.render(b,c)}}),define("components/message_timestamp/src/message_timestamp",["require","underscore","core/lib/date_helper","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_timers","css!./message_timestamp","html!./message_timestamp"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/date_helper"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_timers");return a("css!./message_timestamp"),d.extend({mixins:[e,f],template:a("html!./message_timestamp"),className:function(){var a="yj-message-timestamp";return this.options.extendedClass&&(a+=" "+this.options.extendedClass),a},tagName:function(){return this.options.href?"a":"span"},attributes:function(){var a={title:c.formatDateTime(new Date(this.getTime()))};return this.options.href&&(a.href=this.options.href),a},getTemplateData:function(){return{timeago:c.formatAgo(this.getTime())}},render:function(){return this.updateAttributes(),this.startTimer(),this},updateAttributes:function(){var a=b.extend({},b.result(this,"attributes"));this.$el.attr(a)},startTimer:function(){var a=this.getTimerDelay();a>0&&this.setTimeout(this.render,a)},getTime:function(){return this.model.getTime()},getTimerDelay:function(){var a=b.now(),c=a-this.getTime(),d=1e3,e=60*d,f=60*e,g=24*f;return e>c?2*d:f>c?30*d:g>c?5*e:null}})}),define("components/message_timestamp/index",["require","./src/message_timestamp"],function(a){"use strict";return a("./src/message_timestamp")}),define("feeds/lib/ui/messages/message_list_item_commands",["require","core/lib/backbone_base_class","common-ui/lib/ui/keyboard/keyboard_shortcuts"],function(a){var b=a("core/lib/backbone_base_class"),c=a("common-ui/lib/ui/keyboard/keyboard_shortcuts"),d={noNextItem:"No next attachment.",noPrevItem:"No previous attachment.",noItems:"No attachments."};return b.extend({initialize:function(){this.listenTo(this.options.navigator,"change:current",this._observeMessageCommands)},stop:function(){this.stopListening()},_observeMessageCommands:function(){var a=this.options.navigator.getCurrent()===this.options.model||this.options.attachmentNavigator.getCurrent();this.stopListening(c),a&&(this.listenTo(c,"item_reply",this._reply),this.listenTo(c,"item_toggle_like",this._like),this.listenTo(c,"item_add_topic",this._addTopic),this.listenTo(c,"nav_prev_attachment",this._navPrevAttachment),this.listenTo(c,"nav_next_attachment",this._navNextAttachment))},_reply:function(){this.options.messageListItem.reply()},_like:function(){this.options.messageListItem.like()},_addTopic:function(){this.options.messageListItem.addTopic()},_navNextAttachment:function(){this.options.attachmentNavigator.navNext({errorStrings:d})},_navPrevAttachment:function(){this.options.attachmentNavigator.navPrev({errorStrings:d})}})}),define("common-ui/lib/ui/keyboard/linear_navigator",["require","underscore","backbone","common-ui/lib/ui/accessibility/screenreader_announcer"],function(a){var b=a("underscore"),c=a("backbone"),d=a("common-ui/lib/ui/accessibility/screenreader_announcer");return c.Model.extend({initialize:function(a){this.options=b.extend({},a),this.options.parent&&(this.listenTo(this.options.parent,"change:current",this._parentSelectionChange),this.listenTo(this.options.parent,"change:localCurrent",this._parentLocalSelectionChange))},stop:function(){this.setCurrent(null),this.stopListening()},navPrev:function(a){this._navDelta(-1,a)},navNext:function(a){this._navDelta(1,a)},setCurrent:function(a){this.set("current",a),this.set("localCurrent",a),a&&this.options.parent&&this.options.parent._onChildNavigated(this.options.model)},getCurrent:function(){return this.get("current")},_getNextInDirection:function(a,b){var c=this.get("current"),d=0;c||(c=this.get("localCurrent"),c&&0>b&&(d=1));var e=a.indexOf(c),f=-1==e?0:e+b+d;return a[f]},_navDelta:function(a,b){this.trigger("getCandidates");var c=this.get("candidates");if(this.set("candidates",null),c&&c.length){var e=this._getNextInDirection(c,a);e?(this.setCurrent(e),this.trigger("updatedByCommand")):0>a?d.announceText(b.errorStrings.noPrevItem):d.announceText(b.errorStrings.noNextItem)}else d.announceText(b.errorStrings.noItems)},_parentLocalSelectionChange:function(){this.options.parent.get("localCurrent")!=this.options.model&&this.setCurrent(null)},_parentSelectionChange:function(){this.options.parent.get("current")&&this.setCurrent(null)},_onChildNavigated:function(a){this.set("current",null),this.set("localCurrent",a),this.options.parent&&this.options.parent._onChildNavigated(this.options.model)}})}),define("core/lib/message_business_layer",["require","core/lib/yammer_api","models/lib/orm-models","models/lib/helper/feed_factory"],function(a){function b(a,b,f){c.deleteMessage({id:a}).then(function(){var c=d.Message().findById(a).getThread();if(c.areAllMessagesAvailableLocally())c.deleteMessage(a),b();else{d.Message().findById(a).destroy();var f=c.getServerUpdates();e.findOrCreate("thread",c.id).fetch().then(function(){c.server_updates=f,b()})}},f)}var c=a("core/lib/yammer_api"),d=a("models/lib/orm-models"),e=a("models/lib/helper/feed_factory");return{deleteMessage:b}}),define("css!feeds/lib/ui/messages/message_list_item",[],function(){}),define("stache!feeds/lib/ui/messages/message_list_item",["mustache"],function(a){var b='<{{elementType}} class="{{className}} yj-message-list-item" data-yamjs-id="{{domId}}" data-message-id="{{messageId}}">\n  <div class="yj-message-list-item--message-container yj-message-container">\n    <div class="yj-message-list-item--avatar-container"></div>\n    <div class="yj-message-list-item--body yj-message-body"></div>\n    <div class="yj-message-list-item--attachment-container"></div>\n  </div>\n</{{elementType}}>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_body",["mustache"],function(a){var b='<div class="yj-message-list-item--body-content {{^messageBody}}is-empty-message{{/messageBody}}">\n  <div class="yj-message-list-item--byline-container">\n    <span class="yj-message-list-item--body-byline">\n      <span class="yj-message-list-item--body-byline-user-link">{{{userLink}}}</span>\n      {{#canShowFollowButton}}\n        <span class="yj-message-list-item--byline-follow-container"></span>\n      {{/canShowFollowButton}}\n      {{#isReplyTo}}\n        <a class="yj-message-list-item--in-reply-to yj-in-reply-to yj-tooltip-link" href="{{ replyTo.messageURL }}" data-yamjs-id="in-reply-to-{{ replyTo.id }}">{{ replyTo.label }}</a>\n        {{{ replyTo.hovercardLink }}}\n      {{/isReplyTo}}\n      {{#isDirectRecipient}}\n        {{directRecipient.label}} {{{directRecipient.userLink}}}\n      {{/isDirectRecipient}}\n    </span>\n    <div class="yj-message-list-item--inline-attributes">\n      <span class="yj-message-list-item--inline-attributes-dash" aria-hidden="true">&ndash;</span>\n    </div>\n  </div>\n\n  {{#hasTitle}}\n    {{#isAnnouncement}}\n      <div class="yj-message-list-item--body-title-container">\n        <span class="yamicon yamicon-rd_announcement" aria-hidden="true"></span><span class="yj-acc-hidden">{{announcementAltText}}</span><span class="yj-message-list-item--body-title yj-message-title">{{messageTitle}}{{#isNotification}}:&nbsp;{{/isNotification}}</span>\n      </div>\n    {{/isAnnouncement}}\n    {{^isAnnouncement}}\n      <span class="yj-message-list-item--body-title yj-message-title">{{messageTitle}}{{#isNotification}}:&nbsp;{{/isNotification}}</span>\n    {{/isAnnouncement}}\n  {{/hasTitle}}\n\n  {{#isPraise}}\n    <div class="yj-message-list-item--praise-content"></div>\n  {{/isPraise}}\n  {{^isPraise}}\n    <span class="yj-message-list-item--body-message yj-message" data-qaid="message-text" lang="{{language}}">{{{messageBody}}}</span>\n  {{/isPraise}}\n\n  <div class="yj-message-list-item--body-translated-label yj-message-translated-label">\n    <span class="yj-message-list-item--body-translated-icon translated-icon yj-inline-icon"></span><span>{{translatedFromLabel}}</span>\n  </div>\n\n  {{#isPraise}}\n    <div class="yj-message-list-item--praise-content"></div>\n  {{/isPraise}}\n\n  <span class="yj-message-list-item--metabar"></span>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_actions",["mustache"],function(a){var b='<ul class="yj-message-list-item--action-list yj-actions">\n{{#actions}}\n  {{! Raw output because they already come rendered from `_renderActions` }}\n  {{{.}}}\n{{/actions}}\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_reply",["mustache"],function(a){var b='<li class="yj-message-list-item--action-list-item yj-message-action-list-item yj-reply-list-item">\n  <a role="button" href="javascript://" class="yj-message-list-item--action-list-link yj-reply yj-message-action" title="{{replyToolTip}}">\n    <span class="yj-message-list-item--action-list-icon yamicon yamicon-regular yamicon-rd_reply"></span>\n    <span aria-hidden="true" class="yj-message-list-item--action-list-label">{{replyText}}</span>\n    <span class="yj-acc-hidden"> {{replyAltText}}</span>\n  </a>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_like",["mustache"],function(a){var b='<li class="yj-message-list-item--action-list-item yj-message-action-list-item yj-like-list-item">\n  <a role="button" href="javascript://" title="{{likeToolTip}}" class="yj-message-list-item--action-list-link yj-message-list-item--action-like yj-like">\n    <span class="yj-message-list-item--action-list-icon yamicon yamicon-regular yamicon-rd_like"></span>\n    <span class="yj-message-list-item--action-list-label" aria-hidden="true">{{likeText}}</span>\n    <span class="yj-message-list-item--action-list-acc yj-acc-hidden"> {{likeAltText}}</span>\n  </a>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_share",["mustache"],function(a){var b='<li class="yj-message-list-item--action-list-item yj-message-action-list-item yj-share-list-item">\n  <a role="button" href="javascript://" title="{{shareToolTip}}" class="yj-message-list-item--action-list-link yj-share">\n    <span class="yj-message-list-item--action-list-icon yamicon yamicon-regular yamicon-rd_share"></span>\n    <span aria-hidden="true" class="yj-message-list-item--action-list-label">{{shareText}}</span>\n    <span class="yj-acc-hidden"> {{shareAltText}}</span>\n  </a>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_join",["mustache"],function(a){var b='<li class="yj-message-list-item--action-list-item yj-message-action-list-item yj-join-list-item">\n  <a role="button" href="javascript://" title="{{joinToolTip}}"\n    class="yj-message-list-item--action-list-link yj-join-group yj-join-group-action"\n    data-group-id="{{joinGroupId}}" data-group-name="{{joinGroupName}}">\n    <span class="yj-message-list-item--action-list-label">{{joinText}}</span>\n  </a>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_translate",["mustache"],function(a){var b='<li class="yj-message-list-item--action-list-item yj-message-action-list-item yj-translate-list-item" style="{{translateStyle}}">\n  <span class="yj-message-list-item--translate-spinner yj-inline-spinner"></span>\n  <a role="button" href="javascript://" title="{{translateToolTip}}"\n    class="yj-message-list-item--action-list-link yj-message-list-item--translate-link yj-translate">\n    <span class="yj-message-list-item--action-list-label">{{translateText}}</span>\n  </a>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_untranslate",["mustache"],function(a){var b='<li class="yj-message-list-item--action-list-item yj-message-action-list-item yj-untranslate-list-item" style="{{untranslateStyle}}">\n  <a role="button" href="javascript://" title="{{untranslateToolTip}}"\n    class="yj-message-list-item--action-list-link yj-message-list-item--untranslate-link yj-untranslate">\n    <span class="yj-message-list-item--action-list-label">{{untranslateText}}</span>\n  </a>\n</li>\n';
return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_revoke",["mustache"],function(a){var b='<li class="yj-message-list-item--action-list-item yj-message-action-list-item yj-revokeAccess-list-item">\n  <a role="button" href="javascript://" title="{{revokeToolTip}}" class="yj-message-list-item--action-list-link revokeAccess">\n    <span class="yj-message-list-item--action-list-label">{{revokeText}}</span>\n  </a>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_more",["mustache"],function(a){var b='<li class="yj-message-list-item--action-list-item yj-message-list-item--more-menu-trigger\n  yj-message-action-list-item yj-more-menu-trigger">\n  <a class="yj-message-list-item--action-list-link yj-message-list-item--more-menu yj-click-menu-trigger"\n    role="button" aria-haspopup="true" href="javascript://" title="{{moreToolTip}}"\n    data-speechtip \n    data-attach-menu="true" data-overflow-element="yj-message-list-item--message-container">\n      <span class="yj-message-list-item--action-list-icon yj-message-list-item--action-list-icon--alt yamicon yamicon-ellipsis" aria-hidden="true" title="{{moreText}}"></span>\n    <span class="yj-acc-hidden"> {{moreAltText}}</span>\n  </a>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_loading",["mustache"],function(a){var b='<li class="yj-message-list-item--action-list-item yj-loading-list-item yk-hide">\n  <span class="yk-small-spinner"></span>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/messages/message_list_item_embed_more",["mustache"],function(a){var b='<li class="yj-message-list-item--action-list-item yj-message-action-list-item yj-more-list-item">\n  <a href="{{url}}" target="_blank" class="yj-message-list-item--action-list-link yj-more" title="{{moreToolTip}}">\n    <span class="yj-message-list-item--action-list-label">{{moreText}}</span>\n  </a>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/messages/message_list_item",["require","backbone","underscore","jquery","mustache","feeds/lib/ui/attachments/praise_helper","models/helpers/attachment","feeds/lib/helper/i18n_helper","feeds/lib/helper/message_header_helper","models/helpers/message","feeds/lib/ui/publisher/global/publisher_helper","core/lib/report","core/lib/session","core/lib/tr","core/lib/i18n","core/lib/treatment","common-ui/lib/helper/ui","models/helpers/user","models/helpers/group","core/lib/yammer_api","core/lib/yammer_config","common-ui/lib/ui/accessibility/accessibility_util","common-ui/lib/ui/accessibility/screenreader_announcer","models/lib/orm-models","core/lib/jam/component","feeds/lib/ui/messages/message_likes","core/lib/inbox_follow_delegate","components/avatar/index","common-ui/lib/ui/shared/tiny_follow_button","feeds/lib/ui/shared/excerpt","feeds/lib/ui/messages/message_attachments","feeds/lib/ui/threads/thread_action_menu","feeds/lib/ui/shared/stickers","components/metabar/index","components/message_timestamp/index","common-ui/lib/ui/keyboard/navigable_element_adaptor","feeds/lib/ui/messages/message_list_item_commands","common-ui/lib/ui/keyboard/linear_navigator","feeds/lib/ui/attachments/praise_view","components/hovercard_link/index","core/lib/urls","core/lib/message_business_layer","models/lib/events","css!./message_list_item","html!./message_list_item","html!./message_list_item_body","html!./message_list_item_actions","html!./message_list_item_reply","html!./message_list_item_like","html!./message_list_item_share","html!./message_list_item_join","html!./message_list_item_translate","html!./message_list_item_untranslate","html!./message_list_item_revoke","html!./message_list_item_more","html!./message_list_item_loading","html!./message_list_item_embed_more"],function(a){var b=a("backbone"),c=a("underscore"),d=a("jquery"),e=a("mustache"),f=a("feeds/lib/ui/attachments/praise_helper"),g=a("models/helpers/attachment"),h=a("feeds/lib/helper/i18n_helper"),i=a("feeds/lib/helper/message_header_helper"),j=a("models/helpers/message"),k=a("feeds/lib/ui/publisher/global/publisher_helper"),l=a("core/lib/report"),m=a("core/lib/session"),n=a("core/lib/tr"),o=a("core/lib/i18n"),p=a("core/lib/treatment"),q=a("common-ui/lib/helper/ui"),r=a("models/helpers/user"),s=a("models/helpers/group"),t=a("core/lib/yammer_api"),u=a("core/lib/yammer_config"),v=a("common-ui/lib/ui/accessibility/accessibility_util"),w=a("common-ui/lib/ui/accessibility/screenreader_announcer"),x=a("models/lib/orm-models"),y=a("core/lib/jam/component"),z=a("feeds/lib/ui/messages/message_likes"),A=a("core/lib/inbox_follow_delegate"),B=a("components/avatar/index"),C=a("common-ui/lib/ui/shared/tiny_follow_button"),D=a("feeds/lib/ui/shared/excerpt"),E=a("feeds/lib/ui/messages/message_attachments"),F=a("feeds/lib/ui/threads/thread_action_menu"),G=a("feeds/lib/ui/shared/stickers"),H=a("components/metabar/index"),I=a("components/message_timestamp/index"),J=a("common-ui/lib/ui/keyboard/navigable_element_adaptor"),K=a("feeds/lib/ui/messages/message_list_item_commands"),L=a("common-ui/lib/ui/keyboard/linear_navigator"),M=a("feeds/lib/ui/attachments/praise_view"),N=a("components/hovercard_link/index"),O=a("core/lib/urls"),P=a("core/lib/message_business_layer"),Q=a("models/lib/events");a("css!./message_list_item");var R={NOT_TRANSLATED:{className:"is-not-translated",val:0},TRANSLATING:{className:"is-translating",val:1},TRANSLATED:{className:"is-translated",val:2}},S="praise",T="polls",U=function(a,b){var d=new N(c.extend({model:a},b));return d.render().el.innerHTML};return y.extend({init:function(a,e,f){c.extend(this,b.Events),this.showUnreadIndicator=e&&e.showUnreadIndicator,this.showUnviewedIndicator=this.showUnreadIndicator?!1:e&&e.isOcularSupportedFeed,this._likeInProgress=!1,this._appMessageType=!1,this._showMuteAction=!(!e||!e.showMuteAction),this._feed=e&&e.feed,this._hideFollowButton=e&&e.hideFollowButton,this.data=a,this.data.isForeign()&&(this.displayShareLink=!1),y.prototype.init.call(this,d.extend({},this.defaults,e),f),this._inboxFollowDelegate=new A({model:this.data.getThread()}),this.renderOptions={},this.showUnviewedIndicator||this.updateUnseen(),this.detectAppMessage(),p.treatment("keyboardshortcuts2")&&this._initializeNavigation(e)},_initializeNavigation:function(a){if(a&&a.navigator){this.navigator=a.navigator;var b=this.data.isThreadStarter()?this.data.getThread():this.data;this.attachmentNavigator=new L({parent:this.navigator,model:b}),this.commands=new K({navigator:this.navigator,model:b,messageListItem:this,attachmentNavigator:this.attachmentNavigator})}},defaults:{manuallyRender:!0,settings:{elementType:"li",elementClassName:"yj-message-list-item",idPrefix:"messageListItem"},display:"streaming"},isUnviewed:function(){return c.isNumber(this.lastViewedMessageId)?this.data.id>this.lastViewedMessageId:!1},isUnseen:function(){return this._unseen},updateUnseen:function(a){if("boolean"==typeof a)this._unseen=a;else{var b=this._feed;this._unseen=b&&!b.hasKeyType("thread")?b.isUnseen(this.data):!1}},toggleUnseen:function(a){this.showUnviewedIndicator||this.updateUnseen(a),(this.showUnviewedIndicator?this.isUnviewed():this.isUnseen())?this.markUnread():this.markRead()},detectAppMessage:function(){for(var a,b=this.data.attachments||[],c=!1,d=0,e=b.length;e>d;d++)if(a=b[d],a.type===S)c=S;else if("ymodule"===a.type&&a.ymodule&&a.ymodule.app_id===T){c=T;break}this._appMessageType=c},getMessage:function(){return this.data},applyRenderOptions:function(){var a=this.$element;if(a){var b=this.renderOptions,c={"yj-first-message":b.first,"yj-last-unseen is-last-unseen":b.lastUnseen,"yj-after-unseen is-after-unseen":b.firstSeen,"yj-unread is-unread":this.showUnreadIndicator?this.isUnseen():!1,"is-unviewed":this.showUnviewedIndicator?this.isUnviewed():!1};q.batchClassToggle(a,c),this.checkAddReadLine()}},checkAddReadLine:function(){!this.$readLine&&this.renderOptions.firstSeen&&(this.$readLine=j.buildUnseenLine(),this.$element.prepend(this.$readLine))},createInlinePrivateIcon:function(){},createPrivateIcon:function(){},followThreadInInbox:function(){this._inboxFollowDelegate.toggleFollow()},createElement:function(){this.$readLine=null;var b=a("html!./message_list_item");this.$element=d(b({elementType:this.settings.elementType,className:this.settings.elementClassName,domId:this.getDomId(),messageId:this.data.id})),this.$messageContainer=this.$element.find(".yj-message-list-item--message-container"),this._addContents(),this.createPrivateIcon(),this._addAccessibilityHeading(),this.data.isSystemMessage()&&this.$element.addClass("yj-system-message"),this.data.isReplyToThreadStarter()&&this.$element.addClass("is-reply-to-thread-starter"),this.data.getPraise()&&this.$element.addClass("yj-ymodule-attached"),this.updateTranslationStatus(),this.addPostRenderOptions()},_addContents:function(){this._addAvatar(),this._addBody(),this._addActions(),this._addLikes()},_addAvatar:function(){this.$element.find(".yj-message-list-item--avatar-container").append(this.buildAvatar())},_addBody:function(){this.$messageContainer.find(".yj-message-list-item--body").append(this.buildBody())},_addMetabar:function(a){var b=a.find(".yj-message-list-item--metabar");this.metabar=new H({model:this.data}),b.append(this.metabar.render().$el),i.addOthersLightBoxListener(a,this)},_addActions:function(){this.$actions=this.buildActions(),this._anyActions(this.$actions)&&this.$messageContainer.append(this.$actions)},_anyActions:function(a){return a&&a.children().length>0},_addAttributes:function(a){var b;b=a.find(".yj-message-list-item--inline-attributes"),b.append(this.buildAttributes())},_addLikes:function(){this.$messageContainer.append(this.buildLikes())},_addAccessibilityHeading:function(){var a=this.$element.find(".yj-message-list-item--body-byline"),b=["<div>",'<{{tag}} class="yj-acc-hidden">','{{#newReplyAltText}}<span class="yj-message-list-item--unreadreplyalttext">{{newReplyAltText}}: </span>{{/newReplyAltText}}',"<span>{{summaryText}}</span>","</{{tag}}>",'{{#usePlaceholder}}<div tabindex="-1" class="yj-acc-placeholder yj-acc-hidden"/>{{/usePlaceholder}}',"</div>"].join(""),f={tag:this.data.isThreadStarter()?"h3":"h4",newReplyAltText:this.data.isThreadStarter()||!this.isUnseen()?null:n.t("new_reply"),summaryText:a.text().replace(/\s+/g," "),usePlaceholder:p.treatment("keyboardshortcuts2")},g=d(e.render(b,f));if(p.treatment("keyboardshortcuts2")){var h=['<div style="display:none">,',"{{timeText}}","{{#attachmentText}}, {{attachmentText}}{{/attachmentText}}",".","</div>"].join(""),i=this.data.attachments.length?n.t("count_attachments",{count:this.data.attachments.length}):"",j=this.$messageContainer.find(".yj-message-list-item--time"),k={timeText:j.text(),attachmentText:i},l=d(e.render(h,k));g.append(l);var m=this.$messageContainer.find(".yj-message-list-item--body-message"),o=m.find(".remaining-body");o[0]&&(m=o);var q=g.find(".yj-acc-hidden"),r=[q,l,m],s=c.map(r,function(a){return a[0]?v.getOrAssignElementId(a[0]):""},this).join(" "),t=g.find(".yj-acc-placeholder");t.attr({"aria-labelledby":s,role:"button",title:" "})}g.prependTo(this.$messageContainer)},buildHovercards:function(){b.trigger("/ui/hovercard/build",this.$element,".yammer-object, .yj-hovercard-link")},mute:function(){},addPostRenderOptions:function(){this.buildReplyToolTipSettings(),this.applyRenderOptions(),this.canShowFollowButton()&&this.buildFollowButton(),this.isPraise()&&this.buildPraiseContent(),this.buildAttachments(),this.buildUnreadTooltip(),this.buildHovercards(),this.initNavigation()},initNavigation:function(){this.navigator&&(this.navigableElementAdaptor=new J({navigator:this.navigator,model:this.data.isThreadStarter()?this.data.getThread():this.data,rootElement:this.$element,focusTarget:this.$element.find(".yj-acc-placeholder")}))},canShowFollowButton:function(){if(this._hideFollowButton)return!1;var a=this.data.findSender();return this.data.isThreadStarter()&&!this.data.isForeign()&&a.id!=m.getCurrentUser().id&&"suspended"!==a.state&&"deleted"!==a.state&&"guide"!==a.type&&!r.isForeign(a,m)&&!this._isEmbed()},_isEmbed:function(){return u.config().isEmbed},buildAvatar:function(a){var b=this.data.findSender();return this.avatar=new B({model:b,withHovercard:a&&"undefined"!=typeof a.withHovercard?a.withHovercard:!0,hideFromAccessibility:!0}),this.avatar.render().$el.addClass("yj-message-list-item--avatar"),this.avatar.$el},buildFollowButton:function(){this.followButton=new C({model:this.data.findSender(),inAvatar:!0,elementClassName:"yj-message-list-item--byline-follow"}),this.updateFollowingState(this.followButton.isFollowing()),this.followButton.on("following",this.updateFollowingState.bind(this)),this.addChild(this.followButton,".yj-message-list-item--byline-follow-container")},updateFollowingState:function(a){this.$element.find(".yj-message-list-item--byline-follow-container").toggleClass("is-not-following",a)},buildPraiseContent:function(){var a=new M({model:this.data.getPraise(),title:this.getMessageBody()});this.addChild(a,".yj-message-list-item--praise-content")},bodyTemplate:a("html!./message_list_item_body"),buildBody:function(){function a(a){return a===j}var b,e,f,g,j="announcement",k=this.data,l=k.findSender(),o=k.getThread()||{},p=U(l),q={},s={},t=k.getRepliedToMessage(),u=k.getDirectRecipient();t&&(g=t.findSender(),q={id:k.id,messageURL:O.thread(o),label:n.t("in_reply_to"),hovercardLink:U(g,{extendedClass:"yj-message-list-item--in-reply-to-user"})}),u&&(s={label:n.t("to_as_in_user_name_1_to_user_name_2").toLowerCase(),userLink:U(u)}),e=k.title,f=this.getMessageBody();var v={userLink:p,isReplyTo:!!t,replyTo:q,isDirectRecipient:u&&t,directRecipient:s,isAnnouncement:a(k.message_type),announcementAltText:n.t("announcement")+":",hasTitle:!!e,messageTitle:e,isNotification:"notificationListItemMessage"===this.defaults.settings.idPrefix,language:k.getLanguage(),messageBody:f,translatedFromLabel:k.getLanguageName()?n.t("translated_from_language",{language:c.escape(k.getLanguageName())}):n.t("translated"),canShowFollowButton:this.canShowFollowButton(),followLabel:n.t("follow"),isPraise:this.isPraise()};if(b=d(this.bodyTemplate(v)),this.isAReply()&&r.isForeign(l,m)&&this._addReplyForeignIcon(l,b),"shared_message_id"in k&&D.generateMessageExcerpt(k.shared_message_id,function(a){b.append(a)}),i.addTooltip(b),!k.isSystemMessage()){var w=k.getTextDirection();k.title&&h.addDirectionSupportToElement(b.find(".yj-message-title"),w),h.addDirectionSupportToElement(b.find(".yj-message"),w)}return this._addAttributes(b),H.shouldRender(this.data)&&this._addMetabar(b),b},_addReplyForeignIcon:function(a,b){this.$element.addClass("yj-message-list-item--foreign-network-reply");var c,f=yam.model.Network.findById(a.network_id);null!=f&&(c=f.name);var g='<span class="yamicon yamicon-network yj-message-list-item--foreign-reply-indicator" title="{{domain}}"><span class="yj-acc-hidden">{{alttext}}</span></span>',h=e.render(g,{domain:c,alttext:n.t("other_network_reply_icon_alttext")});d(h).insertBefore(b.find(".yj-message-list-item--byline-container"))},_isDirectMessage:function(){return this.data.isDirectMessage()},getRepliedToMessageTooltipText:function(a,b){var d,e=b.system_message?" ":": ",f=b.getPlainBody()||"";return f?f=f.replace(/\n/g," ").replace(/  /g," "):(d=g.filterByType(b.getAttachments(),["file","image","note","link"]),d&&d.length&&(f=[],c.each(d,function(a){f.push(a.name)}),f=f.join(" "))),a+e+f},appType:function(){},getMessageBody:function(){var a,b=this.data,c=b.getPraise(),d=b.getSticker();if(c)a=this.praiseMessageBody(c);else if(d){var e=new G(d).render();a=e.$el.html()}else a=this._appMessageType?"":this.shouldSuppressMessageTruncation()?b.getHtmlBodyExpandedWithoutCCs():b.getHtmlBodyWithoutCCs();return a},shouldSuppressMessageTruncation:function(){return this.parent.suppressMessageTruncation||this.data.isTranslated()||this.parent.options&&this.parent.options.suppressMessageTruncation},praiseMessageBody:function(a){return f.getPraiseMessageBody(a.praised_user_ids)},isAReply:function(){var a=this.data;return!a.isThreadStarter()&&(a.isReplyToThreadStarter()||a.getRepliedToMessage())},buildReplyToolTipSettings:function(){var a,c=this.data.getRepliedToMessage();if(c){a=c.findSender();var e={target:this.$element.find("[data-yamjs-id=in-reply-to-"+this.data.id+"]")};if(e.target.length){e.delay=200,e.text=this.getRepliedToMessageTooltipText.bind(this,r.getUserName(a),c),e.tooltipSize="wide";var f=this.inReplyToTooltipSettings;f&&d.extend(e,f),b.trigger("/ui/tooltip/add",e)}}},buildAttachments:function(){if(this.messageAttachments&&(this.removeChild(this.messageAttachments),this.messageAttachments.destroy()),this.hasAttachments()){var a=new E({data:this.data,mode:this.getAttachmentsRenderMode(),isReply:this.isAReply(),settings:this.attachmentSettings,attachmentNavigator:this.attachmentNavigator},this);a&&this.addChild(a,".yj-message-list-item--attachment-container"),this.messageAttachments=a}},hasAttachments:function(){return c.some(this.data.getAttachments(),function(a){return"message"!==a.type})},isPraise:function(){return this.isAReply()?void 0:!!this.data.getPraise()},getAttachmentsRenderMode:function(){return this.isAReply()?"reply":"threadStarter"},getMessageTimestampView:function(){return this._timestamp?this._timestamp:new I({model:this.data,href:O.thread(this.data.getThread()),extendedClass:"yj-message-list-item--time"}).render()},buildAttributes:function(){var a,b=[],f=this.data;if(b.push('<p class="yj-message-list-item--attributes yj-attributes">'),f.client_type&&"Web"!==f.client_type){var g=c.escape(f.client_type),h=c.escape(f.client_url);h+="?ref=inbox_link",b.push(e.render(' {{from}} <a href="{{clientURL}}" title="{{title}}" class="yj-message-list-item--client yj-client" target="_blank">{{clientType}}</a>',{from:n.t("from"),clientURL:h,title:n.t("learn_more_about_the_clienttype_app",{clientType:g}),clientType:g}))}return this.showUnviewedIndicator&&b.push('<span data-qaid="message-unviewed-indicator" class="yj-message-list-item--unviewed-indicator"></span>'),b.push("</p>"),a=d(b.join("")),this._timestamp=this.getMessageTimestampView(),a.prepend(this._timestamp.el),this.createInlinePrivateIcon(a),a},buildUnreadMark:function(){return this.$unreadMark||(this.$unreadMark=d('<div class="yj-message-list-item--unread-mark"><span class="yj-acc-hidden">New</span></div>')),this.$unreadMark},markUnread:function(){this.rendered?this.showUnviewedIndicator?this.$element.addClass("is-unviewed"):this.$element.addClass("yj-unread is-unread"):this.renderAsUnread=!0},markRead:function(){this.$element&&(this.showUnviewedIndicator?this.$element.removeClass("is-unviewed"):this.$element.removeClass("yj-unread is-unread"))},buildActions:function(){var a=this._getActionTemplates(),b=this._renderActions(a);return b},_actionsTemplate:a("html!./message_list_item_actions"),_replyTemplate:a("html!./message_list_item_reply"),_likeTemplate:a("html!./message_list_item_like"),_shareTemplate:a("html!./message_list_item_share"),_joinTemplate:a("html!./message_list_item_join"),_translateTemplate:a("html!./message_list_item_translate"),_untranslateTemplate:a("html!./message_list_item_untranslate"),_revokeTemplate:a("html!./message_list_item_revoke"),_moreTemplate:a("html!./message_list_item_more"),_loadingTemplate:a("html!./message_list_item_loading"),_embedMoreTemplate:a("html!./message_list_item_embed_more"),_getActionTemplates:function(){var a=[],b=this.shouldHideSystemActions(),c=this.data.isForeign(),d=this.data.getGroup(),e=d&&s.isExternal(d),f=this.attachmentSettings&&this.attachmentSettings.hideActionsThatOpenModals,g=(p.treatment("external_message_sharing_v1")||!e&&!c)&&!b&&!this._isDirectMessage()&&!this._isEmbed()&&!f;return b?this._canRevokeMessage()&&a.push(this._revokeTemplate):(a.push(this._likeTemplate),a.push(this._replyTemplate)),g&&a.push(this._shareTemplate),this.data.canBeTranslated()&&(a.push(this._translateTemplate),a.push(this._untranslateTemplate)),b||f||a.push(this._getMoreMenuTemplate()),b||a.push(this._loadingTemplate),a},_renderActions:function(a){var b=this._getActionTemplateData(),e=c.map(a,function(a){return a(b)});return d(this._actionsTemplate({actions:e}))},_getActionTemplateData:function(){var a=this.data,b=a.getGroup(),d={replyText:n.t("reply"),replyToolTip:n.t("reply_to_this_message"),likeText:a.isLikedBy(m.getCurrentUser())?n.t("unlike_stop_liking_this_message"):n.t("like_like_this_message"),likeToolTip:a.isLikedBy(m.getCurrentUser())?n.t("stop_liking_this_message"):n.t("like_this_message"),shareText:n.t("share_share_this_message"),shareToolTip:n.t("share_this_message"),joinText:n.t("join_group"),joinToolTip:n.t("join_this_group"),translateText:n.t("translate"),translateToolTip:n.t("translate_into_your_language"),untranslateText:n.t("show_original_text"),untranslateToolTip:n.t("show_in_the_original_language"),joinGroupId:a.group_id,joinGroupName:b?b.get("full_name"):"",replyAltText:n.t("reply_to_this_message"),likeAltText:a.isLikedBy(m.getCurrentUser())?n.t("unlike_this_message"):n.t("like_this_message"),shareAltText:n.t("share_this_message"),revokeText:n.t("remove_participants"),revokeToolTip:n.t("remove_participants_2")};return this._isEmbed()?c.extend(d,{moreToolTip:n.t("view_this_conversation_at_yammercom"),moreText:n.t("view_conversation"),url:O.message(this.data)}):c.extend(d,{moreText:n.t("more_view_more_message_options"),moreToolTip:n.t("view_more_message_options"),moreAltText:n.t("more_message_options")}),d},_getMoreMenuTemplate:function(){return this._isEmbed()?this._embedMoreTemplate:this._moreTemplate},shouldHideSystemActions:function(){var a=this.data.isSystemMessage()||this.data.isGuideMessage();return a&&!this.data.isThreadStarter()},_canRevokeMessage:function(){var a=this.data;return this.isAddedParticipantMsg()&&a.isRevokable()&&r.canRevokeMessage(m.getCurrentUser(),a)},showMuteInActions:function(){return this._showMuteAction},createClickMenu:function(){return this.actionMenu=new F({message:this.data,displayShareLink:this.displayShareLink,displayMuteLink:this.showMuteInActions()}).render(),this.actionMenu.$el.addClass("yj-message-list-item--action-menu"),this.actionMenu.$el},hasViewThreadLink:function(){return!!this.$element.find(".yj-actions .yj-view-thread").length},buildLikes:function(){return this.likes=new z({model:this.data,otherClassNames:this.settings.elementClassName+"-likes"}),this.likes.on("toggleLike",this.like,this),this.likes.render().$el.addClass("yj-message-list-item--likes"),this.$likesElement=this.likes.$el,this.$likesElement},showActionSpinner:function(){this.$actions.find(".yj-loading-list-item").removeClass("yk-hide")},hideActionSpinner:function(){this.$actions.find(".yj-loading-list-item").addClass("yk-hide")},buildUnreadTooltip:function(){if(!this.showUnviewedIndicator&&this.showUnreadIndicator){var a=this.isUnseen();if(a&&!this.$element.hasClass("yj-thread-starter")){var c=this.$element,d="left",e={target:c,text:n.t("unread_message_item_indicator_text"),tooltipColor:"blue",tooltipSize:"small",orientation:d,targetRange:{xmax:8},delay:700,showOnFocus:!1};b.trigger("/ui/tooltip/add",e)}}},rebuildLikes:function(){return this.likes&&this.likes.remove&&(this.likes.remove(),this.likes=null),this.buildLikes()},handleLike:function(){var a,b,c,d=this.data,e=m.getCurrentUser();d.isLikedBy(e)?(a=n.t("unlike_stop_liking_this_message"),b=n.t("stop_liking_this_message"),c=n.t("you_like_this_message")):(a=n.t("like_like_this_message"),b=n.t("like_this_message"),c=n.t("you_no_longer_like_this_message")),this.$element.find(".yj-message-list-item--action-like:first").children(".yj-message-list-item--action-list-label").text(a).attr("title",b).end().children(".yj-message-list-item--action-list-acc").text(b),this.likes.render(),w.announceText(c)},areLikesVisible:function(){return this.hasLikes()},hasLikes:function(){return this.data.liked_by&&this.data.liked_by.count>0},like:function(){if(!this._likeInProgress){this._likeInProgress=!0,this.$element.addClass("is-like-inprogress");var a=c.bind(function(){this._likeInProgress=!1,this.$element.removeClass("is-like-inprogress")},this),b=this.data;b.isLikedBy(m.getCurrentUser())?b.unlike({success:a}):b.like({success:a}),this.handleLike()}},_openMessagePublisherSharer:function(){k.openConversationShareLightbox({sharedMessageId:this.data.id},"message_actions")},share:function(){this._openMessagePublisherSharer()},addTopic:function(){this.$element.trigger({type:"addTopic",message:this})},deleteMessage:function(){var a=this.data,c=n.t("are_you_sure_you_want_to_delete_this_message");if(window.confirm(c)===!0){var d=a.isThreadStarter();d&&this.showActionSpinner(),P.deleteMessage(a.id,function(){b.trigger("/ui/alert/show","notice",n.t("the_message_has_been_deleted")),this.triggerDeleteEvent(d),b.trigger("/ui/reflow/animate")}.bind(this))}},triggerDeleteEvent:function(a){this.$element.trigger({type:"deleteMessage",message:this,isThreadStarter:a})},bookmark:function(){var a,b,c=this.data.id,d=this.$element.find(".yj-bookmark");this._isBookmarking||(j.isBookmarked(this.data)?(j.unbookmark(this.data),t.unbookmarkMessage({message_id:c}).then(this.handleBookmark.bind(this)),a=n.t("bookmark"),b=n.t("bookmark_this_message")):(j.bookmark(this.data),t.bookmarkMessage({message_id:c}).then(this.handleBookmark.bind(this)),a=n.t("unbookmark"),b=n.t("remove_this_message_from_bookmarks")),d.text(a).addClass("yj-disabled").attr("title",b),this._isBookmarking=!0)},getFollow:function(){return this.data.isFollowedInInbox()},email:function(){var a=this.data;t.emailMessage({message_id:a.id}),b.trigger("/ui/alert/show","notice",n.t("the_message_has_been_emailed_to_you"))},reportSpam:function(){t.markMessageAsSpam({data:{id:this.data.id},success:function(){b.trigger("/ui/alert/show","notice",n.t("top_spammers_successfully_marked_message_as_spam"))},error:function(){b.trigger("/ui/alert/show","error",n.t("top_spammers_failed_marking_message_as_spam"))}})},handleBookmark:function(){var a;j.isBookmarked(this.data)?a=n.t("the_message_has_been_bookmarked"):(a=n.t("the_bookmark_was_removed"),b.trigger("/message/unbookmarked/"+this.data.thread_id)),this._isBookmarking=!1,this.$element.find(".yj-bookmark").removeClass("yj-disabled"),b.trigger("/ui/alert/show","notice",a)},follow:function(){var a=this.data;t.subscribeToTarget({target_type:a.sender_type,target_id:a.sender_id}).then(function(){b.trigger("/ui/alert/show","notice",n.t("you_are_now_following_name",{name:c.escape(a.findSender().full_name)})),r.followUser(m.getCurrentUser(),a.sender_id)})},expandBody:function(){this.$element.find(".remaining-body").show(),this.$element.find(".expand-body").hide(),this.$element.find(".collapse-body").show(),this.$element.find(".truncated-body").hide(),this.$element.trigger("resize")},collapseBody:function(){this.$element.find(".remaining-body").hide(),this.$element.find(".expand-body").show(),this.$element.find(".collapse-body").hide(),this.$element.find(".truncated-body").show();var a=d("html, body");this.$element.offset().top<d(window).scrollTop()&&a.animate({scrollTop:this.$element.offset().top},"fast"),this.$element.trigger("resize")},fadeAndDestroy:function(){this.$element.fadeOut("slow",this.destroy.bind(this))},runEffect:function(a){switch(a){case"newMessage":this.$element.addClass("yj-new-message").show("blind").removeClass("yj-new-message")}},destroy:function(){this.followButton&&this.followButton.off("following");var a=[this.likes,this.avatar,this.followButton,this.actionMenu,this.metabar,this._inboxFollowDelegate,this._timestamp];c.chain(a).filter(function(a){return!(!a||!a.remove)}).invoke("remove"),this.listener&&this.listener.stopListening(),this.attachmentNavigator&&this.attachmentNavigator.stop(),this.navigableElementAdaptor&&this.navigableElementAdaptor.stop(),this.commands&&this.commands.stop(),this.$readLine=null,y.prototype.destroy.call(this)},translate:function(){if(!this.data.isTranslating()){l.event("translate",{from:this.data.language,to:x.Message().toBingLocale(o.getLocale()),reply:this.isAReply()});var a=this.data.getThread();a.translate().fail(function(){b.trigger("/ui/alert/show","error",n.t("oops_were_having_trouble_translating_right_now_please_wait_a"))})}},untranslate:function(){this.data.getThread().untranslate()},onRevoked:function(a){var b=this.data;b.getThread().id===a&&b.isSystemMessage()&&"added_participant"===b.getSystemMessageType()&&(r.canRevokeMessage(m.getCurrentUser(),b)&&b.isRevokable()||this.$element.find(".yj-revokeAccess-list-item").remove())},revokeAccess:function(){if(window.confirm(n.t("are_you_sure_you_want_to_remove_those_people_from"))){var a=this.data.getThread(),b=this.data.notified_user_ids;a.removeParticipants(b,this.onRevokeSuccess.bind(this),this.onRevokeFail.bind(this))}},onRevokeSuccess:function(){var a=this.data.getThread().id;b.trigger("/feed/threads/participants/removed",a),b.trigger("/ui/alert/show","notice",n.t("those_people_have_been_removed_from_the_conversation"))},onRevokeFail:function(a){var d;d=c.isString(a)&&"users_already_removed"===a?n.t("those_people_were_already_removed_from_the_conversation"):n.t("an_error_occurred_removing_those_people_please_wait_a_moment"),b.trigger("/ui/alert/show","error",d)},isAddedParticipantMsg:function(){return this.data.isSystemMessage()&&"added_participant"===this.data.getSystemMessageType()},subscribeToData:function(){this.listenTo(b,"/feed/threads/participants/removed",this.onRevoked.bind(this)),this.listenTo(Q,"Message/"+this.data.id+"/update",this.onMessageUpdate.bind(this))},unsubscribeData:function(){this.stopListening(b,"/feed/threads/participants/removed"),this.stopListening(Q)},getTranslationStatus:function(){return this._translationStatus},onMessageUpdate:function(){this.$element&&this.data.getTranslationStatus()!=this.getTranslationStatus()&&(this.rerenderMessageBody(),this.updateTranslationStatus(),this.data.canBeTranslated()&&this.data.isTranslated()&&this.colorFlash())},rerenderMessageBody:function(){var a=this.$element.find(".yj-message-list-item--body-message"),b=this.buildBody().find(".yj-message-list-item--body-message");a.replaceWith(b),this.buildHovercards()},updateTranslationStatus:function(){var a,b,d=c.map(R,function(a){return a.className}),e=this.data,f=this.$element;e.isNotTranslated()||!e.canBeTranslated()?a="NOT_TRANSLATED":e.isTranslating()?a="TRANSLATING":e.isTranslated()&&(a="TRANSLATED"),b=R[a],this._translationStatus=b.val,f.removeClass(d.join(" ")),f.addClass(b.className)},colorFlash:function(){var a=this.isAReply()?"#f3f5f8":"#ffffff",b=this.isAReply()?"#dde9f5":"#e7f0fe",c=this.$element.find(".yj-message");c.css({"background-color":a}).animate({"background-color":b},500,"linear").animate({"background-color":a},500,"linear")}})}),define("stache!feeds/lib/ui/publisher/global/privacy_tooltip",["mustache"],function(a){var b="{{! `text` contains a link }}\n{{{text}}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/publisher/global/privacy_tooltip_link",["mustache"],function(a){var b='<a href="{{url}}" class="yj-global-privacy-tooltip--lightbox-link" target="_blank">{$0}</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/privacy_tooltip",[],function(){}),define("feeds/lib/ui/publisher/global/privacy_tooltip",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","models/message_backbone","backbone","models/recipient","feeds/lib/ui/publisher/global/privacy_list","core/lib/tr","common-ui/lib/helper/environment","core/lib/yammer_uri","core/lib/yammer_config","models/helpers/group","html!./privacy_tooltip","html!./privacy_tooltip_link","css!./privacy_tooltip"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_legacy_subviews"),g=a("core/lib/backbone_with_subviews"),h=a("models/message_backbone"),i=a("backbone"),j=a("models/recipient"),k=a("feeds/lib/ui/publisher/global/privacy_list"),l=a("core/lib/tr"),m=a("common-ui/lib/helper/environment"),n=a("core/lib/yammer_uri"),o=a("core/lib/yammer_config"),p=a("models/helpers/group"),q=a("html!./privacy_tooltip"),r=a("html!./privacy_tooltip_link");
a("css!./privacy_tooltip");var s=j.TYPE,t=function(){return!0};return d.extend({mixins:[e,f,g],defaults:function(){return{recipientFilter:t}},className:"yj-global-privacy-tooltip",template:q,events:{click:"_showPrivacyList"},initialize:function(a){if(!(this.model instanceof h))throw new Error("PrivacyTooltip must be given a yam.backbone.model.Message model");this._target=a.target,this._recipientFilter=a.recipientFilter,this._setupListeners(),this._createChildren()},getTemplateData:function(){var a={link:r({url:this._shouldShowPrivacyList()?"javascript://":this._getThreadUrl()})},b=this._getGroup();return b&&c.extend(a,{group_name:p.getFullName(b)}),{text:l.t(this._getMessageKey(),a)}},render:function(){return this._shouldShowPrivacyList()&&this.$el.addClass("yj-global-privacy-tooltip--link-mode"),this},attachTo:function(a){var b=c.bind(function(){return this.render().$el.clone(!0)},this);return i.trigger("/ui/tooltip/add",{target:a,text:b,validHTML:!0,delay:200,tooltipSize:"small",stayVisible:!0}),m.isIE()&&this._blurTextboxes(),this},getText:function(){var a=this.$el.text();return a.replace(/\s{2,}/g," ")},_setupListeners:function(){this.listenTo(this.model.get("allRecipients"),"change add remove reset",this.render)},_createChildren:function(){this._privacyList=new k({model:this.model}),this.add(this._privacyList,".warning-list")},_showPrivacyList:function(a){this._shouldShowPrivacyList()&&(a.preventDefault(),a.stopPropagation(),this._privacyList.show())},_hasForeignRecipients:function(){var a=c.filter(this.model.getForeignUsers(),this._recipientFilter),b=this._getGroup(),d=b&&b.isForeign();return!c.isEmpty(a)||d||this._isMessageInExternalGroup()},_hasExternalRecipients:function(){var a=this.model.isForeign(),b=!!this._getGroup(),d=c.filter(this.model.getInvitedUsers(),this._recipientFilter);return!a&&b&&!c.isEmpty(d)},_getMessageKey:function(){return this._hasForeignRecipients()&&this._hasExternalRecipients()?"privacy_tooltip_external_xmess":this._hasForeignRecipients()?"privacy_tooltip_external":this._hasExternalRecipients()?"privacy_tooltip_xmess":"privacy_tooltip_private_group"},_getGroup:function(){var a=[s.PRIVATE_GROUP];return this.model.isForeign()&&a.push(s.PUBLIC_GROUP),this.model.findRecipient({type:a})},_isMessageInExternalGroup:function(){var a=this.model.getGroup();return a&&p.isExternal(a)},_blurTextboxes:function(){var a,d=function(){a=b(document.activeElement),a.length>0&&c.contains(["INPUT","TEXTAREA"],a.prop("tagName"))&&(a.blur(),i.off("/ui/tooltip/visible",d),i.on("/ui/tooltip/hidden",e))},e=function(){i.off("/ui/tooltip/hidden",e),a.length>0&&a.focus(),i.on("/ui/tooltip/visible",d)};i.on("/ui/tooltip/visible",d)},_shouldShowPrivacyList:function(){return!o.config().isEmbed},_getThreadUrl:function(){var a=this.model.getThread();return n.app("/#/Threads/show?threadId="+a.get("id"))}})}),define("css!feeds/lib/ui/shared/privacy_icon",[],function(){}),define("stache!feeds/lib/ui/shared/privacy_icon",["mustache"],function(a){var b='{{^privateOnly}}\n  {{#foreign}}\n    <span class="yamicon yamicon-network" />\n  {{/foreign}}\n  {{^foreign}}\n    {{#padlock}}\n      <span class="yamicon yamicon-lock-MSFT" />\n    {{/padlock}}\n    {{#invitedUsersCount}}\n      <span class="yj-xmess-privacy-icon-invited-count" aria-hidden="true">+{{ invitedUsersCount }}</span>\n    {{/invitedUsersCount}}\n  {{/foreign}}\n{{/privateOnly}}\n{{#privateOnly}}\n  <span class="yamicon yamicon-lock-MSFT"></span>\n{{/privateOnly}}\n<span class="yj-acc-hidden">{{ alternateText }}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/shared/privacy_icon",["require","core/lib/backbone_legacy_integration","core/lib/tr","models/message_backbone","models/recipient","feeds/lib/ui/publisher/global/privacy_tooltip","feeds/lib/ui/publisher/global/privacy_list","models/helpers/group","css!./privacy_icon","html!./privacy_icon"],function(a){"use strict";var b=a("core/lib/backbone_legacy_integration"),c=a("core/lib/tr"),d=a("models/message_backbone"),e=a("models/recipient"),f=a("feeds/lib/ui/publisher/global/privacy_tooltip"),g=a("feeds/lib/ui/publisher/global/privacy_list"),h=a("models/helpers/group");a("css!./privacy_icon");var i=e.TYPE;return b.extend({events:{click:"_showExternalUserList"},tagName:"a",className:"yj-xmess-privacy-icon",attributes:{href:"javascript://",role:"button","data-speechtip":""},template:a("html!./privacy_icon"),initialize:function(a){var b=a.model;if(this.privateOnly=!!a.privateOnly,b instanceof yam.model.Message&&(b=d.fromOriginalModel(b)),null==b)throw new Error("PrivacyIcon must be given a message model");this.model=b,this._createChildren(),this._setupListeners()},render:function(){var a=this.model.getInvitedUsers(),b=this.model.getForeignUsers(),d=this.model.isForeign(),e=this.model.getGroup(),f=e&&h.isExternal(e),g=f||d||b.length>0,j=f||a.length||b.length,k=this.model.findRecipient({type:i.PRIVATE_GROUP}),l=k&&!j,m=(l||a.length>0)&&!f,n="";g?n=c.t("privacy_icon_network_alttext"):m&&(n=a.length?c.t("privacy_icon_padlock_count_alttext",{count:a.length}):c.t("privacy_icon_padlock_alttext")),this.renderTemplate({padlock:m,foreign:g,invitedUsersCount:a.length,alternateText:n,privateOnly:this.privateOnly});var o=!1;return o=this.privateOnly||j||d,o?(this._setLimitedOrPrivate(j||d),this._tooltip.attachTo(this.$el),this.$el.addClass("is-visible")):this.$el.addClass("is-hidden"),this},_createChildren:function(){this._tooltip=new f({model:this.model,concise:!0}),this.add(this._tooltip,".warning-tooltip"),this._privacyList=new g({model:this.model})},_setupListeners:function(){this.listenTo(this.model.get("allRecipients"),"reset",this.render)},_setLimitedOrPrivate:function(a){this.$el.removeClass("is-limited is-private"),a?this.$el.addClass("is-limited"):this.$el.addClass("is-private")},_showExternalUserList:function(a){a.preventDefault(),a.stopPropagation(),this._privacyList.show()}})}),define("stache!feeds/lib/ui/publisher/global/educational_popup_recipient",["mustache"],function(a){var b='<div class="popup-body">\n  <span class="yj-acc-hidden">{{noticePrefix}}</span>\n  <h3 role="presentation" class="popup-title">{{title}}</h3>\n  <p class="popup-message">{{{message}}}</p>\n  <img src="{{image}}" srcset="{{srcset}}" alt=""/>\n</div>\n<button class="popup-close unstyle-button-as-span" data-speechtip><span class="yamicon yamicon-x"></span><span class="yj-acc-hidden">{{closeAltText}}<span></button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/publisher/global/educational_popup_thread_starter",["mustache"],function(a){var b='<div class="divider">\n  <div class="yamicon yamicon-network big-network-icon"></div>\n  <div class="popup-body">\n    <span class="yj-acc-hidden">{{noticePrefix}}</span>\n    <h3 role="presentation" class="popup-title">{{title}}</h3>\n    <p class="popup-message">{{{message}}}</p>\n  </div>\n</div>\n<button data-qaid="close-button" class="popup-close unstyle-button-as-span" data-speechtip><span class="yamicon yamicon-x"></span><span class="yj-acc-hidden">{{closeAltText}}<span></button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/external_educational_popup",[],function(){}),define("feeds/lib/ui/publisher/global/external_educational_popup",["require","underscore","core/lib/report","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/session","core/lib/tr","collections/banners","core/lib/yammer_uri","core/lib/external_messaging_state","html!./educational_popup_recipient","html!./educational_popup_thread_starter","css!./external_educational_popup"],function(a){var b=a("underscore"),c=a("core/lib/report"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/session"),g=a("core/lib/tr"),h=a("collections/banners"),i=a("core/lib/yammer_uri"),j=a("core/lib/external_messaging_state"),k=a("html!./educational_popup_recipient"),l=a("html!./educational_popup_thread_starter");a("css!./external_educational_popup");var m=d.extend({mixins:[e],className:"external-educational-popup",attributes:{"data-qaid":"external-educational-popup"},events:{"click .popup-close":"_onClickClose"},initialize:function(a){this._configure(a.mode)},getTemplateData:function(){var a={link:'<a href="http://go.microsoft.com/fwlink/?LinkId=525656" target="_blank">{$0}</a>'},b={title:g.t(this._config.title,a),message:g.t(this._config.message,a),noticePrefix:g.t("notice_prefix"),closeAltText:g.t("notice_dismiss")};return this._hasImage()&&(b.image=this._getImage(),b.srcset=this._getImageSrcset()),b},show:function(){this._alreadyShown()||(this.$el.show(),this._flagShown(),this._reportShown())},hide:function(){this.$el.hide()},_configure:function(a){if(!s(a))throw new Error("RecipientInputPopup: Invalid mode option: "+a);this._mode=a,this._config=p[a],this.template=this._config.template,this.$el.addClass(this._config.className)},_alreadyShown:function(){return u(this._config.bannerName)},_flagShown:function(){v(this._config.bannerName)},_reportShown:function(){this._reportEvent(this._config.bannerName+"-shown")},_reportEvent:function(a){c.event(this._sanitiseEventName(a),{user_id:f.getCurrentUser().id,network_id:f.getCurrentNetwork().id})},_sanitiseEventName:function(a){return a.split("-").join("_")},_hasImage:function(){return!!this._config.image},_getImage:function(){var a=i.cdn("assets/images/external-users/");return a+this._config.image},_getImageSrcset:function(){var a=i.cdn("assets/images/external-users/");return b.map(this._config.srcset,function(b,c){return a+b+" "+c}).join(", ")},_onClickClose:function(a){return a.preventDefault(),a.stopPropagation(),this._optOutOfBanner(),this._reportClosed(),this.remove(),!1},_optOutOfBanner:function(){x(this._config.bannerName)},_reportClosed:function(){this._reportEvent(this._config.bannerName+"-closed")}}),n={RECIPIENT_WITH_GROUP:"recipientWithGroup",RECIPIENT_WITHOUT_GROUP:"recipientWithoutGroup",THREAD_STARTER:"threadStarter",THREAD_STARTER_IN_EXTERNAL_GROUP:"threadStarterInExternalGroup"},o={RECIPIENT:"educational-popup-recipient",THREAD_STARTER:"educational-popup-thread-starter"},p=b.object([[n.RECIPIENT_WITH_GROUP,{bannerName:o.RECIPIENT,className:"educational-popup-recipient",template:k,title:"new_include_people_from_other_networks",message:"now_you_can_add_people_to_the_conversation",image:"external-user-recipient-popup.gif",srcset:{"1x":"external-user-recipient-popup.gif","2x":"external-user-recipient-popup-2x.gif"}}],[n.RECIPIENT_WITHOUT_GROUP,{bannerName:o.RECIPIENT,className:"educational-popup-recipient",template:k,title:"new_include_people_from_other_networks",message:"now_you_can_add_people_to_the_conversation",image:"external-user-recipient-popup-nogroup.gif",srcset:{"1x":"external-user-recipient-popup-nogroup.gif","2x":"external-user-recipient-popup-nogroup-2x.gif"}}],[n.THREAD_STARTER,{bannerName:o.THREAD_STARTER,className:"educational-popup-thread-starter",template:l,title:"this_conversation_includes_people_who_are_not_members",message:"they_can_see_this_post_its_replies_and_any_attached"}],[n.THREAD_STARTER_IN_EXTERNAL_GROUP,{bannerName:o.THREAD_STARTER,className:"educational-popup-thread-starter",template:l,title:"this_conversation_includes_people_who_are_not_members",message:"they_can_see_this_group"}]]),q=b.object([[o.RECIPIENT,!1],[o.THREAD_STARTER,!1]]),r=function(a){if(!s(a))return!1;var b=p[a].bannerName;return t(b)?!1:u(b)?!1:!w(b)},s=function(a){return!(!a||!b.has(p,a))},t=function(a){var b=f.getCurrentNetwork();switch(b.external_messaging_state){case j.ENABLED:return!1;case j.INBOUND_ONLY:if(a===o.THREAD_STARTER)return!1}return!0},u=function(a){return q[a]===!0},v=function(a){q[a]=!0},w=function(a){return h.isOptedOut(a)},x=function(a){h.getOrFetch(a).optOut()},y=function(){q=b.object([[o.RECIPIENT,!1],[o.THREAD_STARTER,!1]])};return m.MODE=n,m.canShowForMode=r,m.resetShown=y,m}),define("css!feeds/lib/ui/messages/thread_starter",[],function(){}),define("stache!feeds/lib/ui/messages/thread_starter_icon_container",["mustache"],function(a){var b='<div class="yj-thread-starter--icon-container">\n  <div class="close-button"></div>\n  <div class="privacy-icon"></div>\n  <div class="thread-starter-popup-container"></div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/messages/thread_starter",["require","jquery","backbone","collections/group_memberships","collections/groups","feeds/lib/ui/messages/message_list_item","feeds/lib/ui/shared/privacy_icon","feeds/lib/ui/publisher/global/external_educational_popup","core/lib/session","core/lib/tr","core/lib/yammer_request","core/lib/yammer_uri","models/helpers/user","models/helpers/group","css!./thread_starter","html!./thread_starter_icon_container"],function(a){var b=a("jquery"),c=a("backbone"),d=a("collections/group_memberships"),e=a("collections/groups"),f=a("feeds/lib/ui/messages/message_list_item"),g=a("feeds/lib/ui/shared/privacy_icon"),h=a("feeds/lib/ui/publisher/global/external_educational_popup"),i=a("core/lib/session"),j=a("core/lib/tr"),k=a("core/lib/yammer_request"),l=a("core/lib/yammer_uri"),m=a("models/helpers/user"),n=a("models/helpers/group");return a("css!./thread_starter"),f.extend({defaults:{manuallyRender:!0,settings:{elementType:"div",elementClassName:"yj-thread-starter",idPrefix:"threadStarter"},display:"threaded",displayShareLink:!1},reply:function(){this.$element.trigger({type:"openReplyForm",message:this})},mute:function(){this.data.getThread().mute()},joinGroup:function(a){var b=a,f=b.attr("data-group-id"),g=b.attr("data-group-name"),h={group_id:f,bfr_source:"home_page",bfr_section:"group_discovery_threadstarter",bfr_event:"group_joined"},o=this;b.hasClass("yj-join-group-action")?k.send({url:"/api/v1/group_memberships.json",data:h,type:"post",complete:function(){var a=e.get(f);if(a&&n.isPrivateOrRestricted(a))c.trigger("/ui/alert/show","notice",j.t("you_have_requested_to_join_the_group_group",{group:g}));else{var h={user_id:i.getCurrentUser().id,group_id:f};c.trigger("/ui/alert/show","notice",j.t("you_have_joined_the_group_group",{group:g})),d.add(h)}m.getGroupMemberships(i.getCurrentUser()).length||c.trigger("taskListComplete","join_a_group"),b.removeClass("yj-join-group-action").attr("title","view group").text(j.t("view_group")),o.displayShareLink=!0}}):window.location=encodeURI(l.app()+"/#/threads/inGroup?type=in_group&feedId="+f)},iconContainerTemplate:a("html!./thread_starter_icon_container"),_getIconContainer:function(){var a=this.$element.find(".yj-message-container"),c=a.find(".yj-thread-starter--icon-container");return c.length||(c=b(this.iconContainerTemplate()),a.prepend(c)),c},createInlinePrivateIcon:function(a){var b=this.data.getThread(),c=b.getInvitedUsers()||b.getForeignUsers();if(this.data.isPrivateGroupMessage()&&!c){var d=new g({model:this.data,privateOnly:!0});a.add(d.render().$el)}},createPrivateIcon:function(){var a=new g({model:this.data});this.addChild(a,".privacy-icon");var b=this._getIconContainer();b.find(".privacy-icon").append(a.render().$el);var c=a.model.getForeignUsers(),d=a.model.getGroup(),e=d&&n.isExternal(d);(c.length||e)&&this.createEducationalPopup()},createEducationalPopup:function(){var a=this._getEducationalPopupMode();if(h.canShowForMode(a)){var b=new h({mode:a});b.prependToTarget=!0,this.addChild(b,".thread-starter-popup-container"),b.render().show()}},_getEducationalPopupMode:function(){var a=this.data.getGroup();return a&&n.isExternal(a)?h.MODE.THREAD_STARTER_IN_EXTERNAL_GROUP:h.MODE.THREAD_STARTER}})}),define("css!feeds/lib/ui/messages/thread_reply_list_item",[],function(){}),define("feeds/lib/ui/messages/thread_reply_list_item",["require","jquery","feeds/lib/ui/messages/message_list_item","css!./thread_reply_list_item"],function(a){var b=a("jquery"),c=a("feeds/lib/ui/messages/message_list_item");return a("css!./thread_reply_list_item"),c.extend({init:function(a,d,e){this.thread=d,c.prototype.init.call(this,a,b.extend({},this.defaults,e),d)},defaults:{manuallyRender:!0,settings:{elementType:"li",elementClassName:"yj-thread-reply-list-item",idPrefix:"threadReplyListItem"},display:"threaded"},reply:function(){this.$element.trigger({type:"openReplyForm",message:this})},isAReply:function(){return!0}})}),define("feeds/lib/ui/threads/future/thread_delegate",["require","underscore","backbone","core/lib/ctor","models/lib/helper/assured_delivery_experiments","models/lib/events","models/thread","models/message"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/ctor"),e=a("models/lib/helper/assured_delivery_experiments"),f=a("models/lib/events");a("models/thread"),a("models/message");var g=d(null,{init:function(a){b.bindAll(this,"_handleAfterProcess","_handleMessageDestroy","_handleThreadUpdate"),this.thread=a.thread,this.feed=a.feed,this._cachedReplies=!1,this._messageIds=b.pluck(this.getReplies(),"id"),b.extend(this,c.Events),this.listenTo(f,"Thread/update",this._handleThreadUpdate),this.listenTo(f,"Message/destroy",this._handleMessageDestroy),this.listenTo(this.feed,"onAfterProcess",this._handleAfterProcess)},getId:function(){return this.thread.id},getTopics:function(){return this.thread.getTopics()},isUnseen:function(){return this.feed.isUnseen(this.thread)},markAsRead:function(){return this.thread.markAsRead()},markAsViewed:function(a,b,c,d){this.thread.markAsViewed({immediate:b||!1,log:{feed_type:this.feed.getLogSource(),feed_view:this.feed.getLogFeedView(),action_type:a,action_info:c,feed_id:this.feed.getGroupId()||d,thread_state:this.thread.viewedState.getState()}}),this.thread.getAllFeeds().forEach(function(a){a.isInbox()||a.setUnseenCountFor(this.thread,0)},this)},getShareCount:function(){return this.thread.getShareCount()},getThreadStarter:function(){return this.thread.getThreadStarter()},getThread:function(){return this.thread},getReplies:function(){return this._cachedReplies===!1&&(this._cachedReplies=b.sortBy(this.thread.getReplies(),"id")),this._cachedReplies},fetch:function(a){var c=b.defaults(a.data||{},{threaded:!1}),d=b.bind(function(a){this.trigger("sync"),a&&a()},this);this.trigger("request"),this.feed.fetchThread(this.thread.id,c).then(b.wrap(a.success,d),b.wrap(a.error,d))},fetchOlder:function(a){a.data=b.defaults(a.data||{},{older_than:this._getOldestLocalReplyId()}),this.fetch(a)},destroy:function(){this.stopListening()},getUnseenCount:function(){return this.feed.getUnseenCountFor(this.thread)},getTotalReplyCount:function(){var a=this.thread.getReplyCount2();return isNaN(a)?this._getLocalReplyCount():a},hasOlderAvailable:function(){return this._getOldestReplyId()!=this._getOldestLocalReplyId()},_getOldestReplyId:function(){return this.thread.stats.first_reply_id||this._getOldestLocalReplyId()},_getOldestLocalReplyId:function(){return b.first(this._messageIds)},_getNewestLocalReplyId:function(){return b.last(this._messageIds)},_getLocalReplyCount:function(){return this._messageIds.length},getMessageIndex:function(a){var c=b.indexOf(this._messageIds,a.id);return-1!=c?c:this._messageIds.length},_handleMessageDestroy:function(a){a.thread_id===this.thread.id&&this.trigger("message:destroy",a)},_handleThreadUpdate:function(a){a.id===this.thread.id&&this.trigger("thread:update",a)},_handleAfterProcess:function(a){var c;c=e.newerRealtimeTreatment(this.feed)?a.getFullMessages():a.getMessages();var d=b.chain(c).where({thread_id:this.thread.id}).pluck("id").without(this.thread.thread_starter_id).difference(this._messageIds).value(),f=b.chain(d).map(yam.model.Message.findById,yam.model.Message).compact().value();f.length>0&&(d=d.concat(this._messageIds),this._messageIds=b.sortBy(d,function(a){return a}),this._cachedReplies=!1,b.each(f,function(a){this.trigger("add:message",a)},this))},clearRepliesCache:function(){this._cachedReplies=!1},doesThreadExist:function(){return this.thread.getServerUpdates()>0}});return b.extend(g.prototype,c.Events),g}),define("stache!feeds/lib/ui/publisher/global/reply_notice",["mustache"],function(a){var b='<div class="notice-target">{{targetLabel}}</div>\n<button class="notice-reset unstyle-button-as-span" data-speechtip>\n  <span class="yamicon yamicon-x"></span>\n  <span class="yj-acc-hidden">{{resetLabel}}</span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/reply_notice",[],function(){}),define("feeds/lib/ui/publisher/global/reply_notice",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_show_hide","models/helpers/user","core/lib/tr","html!./reply_notice","css!./reply_notice"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_show_hide"),e=a("models/helpers/user"),f=a("core/lib/tr"),g=a("html!./reply_notice");return a("css!./reply_notice"),b.extend({mixins:[c,d],events:{"click .notice-reset":"_onClickReset"},className:"yj-global-reply-notice",template:g,initialize:function(){this._setupListeners()},getTemplateData:function(){var a=this.model,b=this.model.get("original");if(null==a||null==b)return{};var c=a.get("sender"),d=b.get("sender");return null==c||null==d?{}:{resetLabel:f.t("reply_to_original_poster"),targetLabel:f.t("user_replying_to_user",{user1:e.getFullName(c),user2:e.getFullName(d)})}},render:function(){return this.$resetButton=this.$(".notice-reset"),this},enable:function(){return this.$resetButton&&this.$resetButton.prop("disabled",!1),this},disable:function(){return this.$resetButton&&this.$resetButton.prop("disabled",!0),this},_setupListeners:function(){this.listenTo(this.model,"change:original",this.render)},_onClickReset:function(){this.trigger("reset")}})}),define("stache!feeds/lib/ui/publisher/global/reply_publisher",["mustache"],function(a){var b='<div class="publisher-reply"></div>\n<div class="publisher-relative">\n  <div class="publisher-main">\n    <div class="publisher-body"></div>\n    <div class="publisher-recipients"></div>\n    <div class="publisher-educational-popup"></div>\n  </div>\n  <div class="publisher-warning"></div>\n  <div class="publisher-actions">\n    <div class="publisher-file"></div>\n    <div class="publisher-submit"></div>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/reply_publisher",[],function(){}),define("feeds/lib/ui/publisher/global/reply_publisher",["require","underscore","backbone","core/lib/session","core/lib/tr","models/message_backbone","common-ui/lib/ui/shared/type_ahead","feeds/lib/ui/publisher/global/reply_notice","feeds/lib/ui/publisher/global/body_editor","feeds/lib/ui/publisher/global/recipient_selector_with_more","feeds/lib/ui/publisher/global/base_publisher","feeds/lib/ui/publisher/global/privacy_warning","common-ui/lib/ui/accessibility/screenreader_announcer","html!./reply_publisher","css!./reply_publisher"],function(a){"use strict";var b=a("underscore"),c=a("backbone"),d=a("core/lib/session"),e=a("core/lib/tr"),f=a("models/message_backbone"),g=a("common-ui/lib/ui/shared/type_ahead"),h=a("feeds/lib/ui/publisher/global/reply_notice"),i=a("feeds/lib/ui/publisher/global/body_editor"),j=a("feeds/lib/ui/publisher/global/recipient_selector_with_more"),k=a("feeds/lib/ui/publisher/global/base_publisher"),l=a("feeds/lib/ui/publisher/global/privacy_warning"),m=a("common-ui/lib/ui/accessibility/screenreader_announcer"),n=a("html!./reply_publisher"),o=f.TYPE,p={submit:{}};return a("css!./reply_publisher"),k.extend({defaults:function(){var a=b.object([[o.EMPTY,e.t("new_reply_2")],[o.ALL_COMPANY,e.t("new_reply_2")],[o.ALL_COMPANY_WITH_EXTERNAL,e.t("new_reply_2")],[o.PUBLIC_GROUP,e.t("new_reply_2")],[o.PUBLIC_GROUP_WITH_EXTERNAL,e.t("new_reply_2")],[o.PRIVATE_GROUP,e.t("new_reply_2")],[o.PRIVATE_GROUP_WITH_EXTERNAL,e.t("new_reply_2")],[o.PRIVATE_MESSAGE,e.t("new_reply_2")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,e.t("new_reply_2")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,e.t("new_reply_2")]]),c=b.object([[o.ALL_COMPANY,e.t("your_reply_has_been_posted")],[o.ALL_COMPANY_WITH_EXTERNAL,e.t("your_reply_has_been_posted")],[o.PUBLIC_GROUP,e.t("your_reply_has_been_posted")],[o.PUBLIC_GROUP_WITH_EXTERNAL,e.t("your_reply_has_been_posted")],[o.PRIVATE_GROUP,e.t("your_reply_has_been_posted")],[o.PRIVATE_GROUP_WITH_EXTERNAL,e.t("your_reply_has_been_posted")],[o.PRIVATE_MESSAGE,e.t("your_reply_has_been_posted")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,e.t("your_reply_has_been_posted")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,e.t("your_reply_has_been_posted")]]),d=b.object([[o.ALL_COMPANY,e.t("your_reply_could_not_be_posted")],[o.ALL_COMPANY_WITH_EXTERNAL,e.t("your_reply_could_not_be_posted")],[o.PUBLIC_GROUP,e.t("your_reply_could_not_be_posted")],[o.PUBLIC_GROUP_WITH_EXTERNAL,e.t("your_reply_could_not_be_posted")],[o.PRIVATE_GROUP,e.t("your_reply_could_not_be_posted")],[o.PRIVATE_GROUP_WITH_EXTERNAL,e.t("your_reply_could_not_be_posted")],[o.PRIVATE_MESSAGE,e.t("your_reply_could_not_be_posted")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,e.t("your_reply_could_not_be_posted")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,e.t("your_reply_could_not_be_posted")]]),f=b.object([[o.EMPTY,e.t("notify_additional_people")],[o.ALL_COMPANY,e.t("notify_additional_people")],[o.ALL_COMPANY_WITH_EXTERNAL,e.t("notify_additional_people")],[o.PUBLIC_GROUP,e.t("notify_additional_people")],[o.PUBLIC_GROUP_WITH_EXTERNAL,e.t("notify_additional_people")],[o.PRIVATE_GROUP,e.t("notify_additional_people")],[o.PRIVATE_GROUP_WITH_EXTERNAL,e.t("notify_more_people_2")],[o.PRIVATE_MESSAGE,e.t("notify_more_people_2")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,e.t("notify_more_people_2")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,e.t("notify_more_people_2")]]),g={placeholders:f},h=b.object([[o.EMPTY,e.t("post")],[o.ALL_COMPANY,e.t("post")],[o.ALL_COMPANY_WITH_EXTERNAL,e.t("post")],[o.PUBLIC_GROUP,e.t("post")],[o.PUBLIC_GROUP_WITH_EXTERNAL,e.t("post")],[o.PRIVATE_GROUP,e.t("post")],[o.PRIVATE_GROUP_WITH_EXTERNAL,e.t("post")],[o.PRIVATE_MESSAGE,e.t("post")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,e.t("post")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,e.t("post")]]),i={titles:a,successes:c,errors:d,selector:g,submit:h};return{icons:p,strings:i,allowAttachments:!0,showAlert:!1,inLightbox:!1,logType:"yam.ui.publisher.global.ReplyPublisher",logSource:"default"}},className:"yj-global-publisher yj-global-reply-publisher yj-clearfix",template:n,initialize:function(){k.prototype.initialize.apply(this,arguments),this._threadStarter=this.model.get("original")},replyTo:function(a){if(!this.model.isBeingSubmitted()){null==a&&(a=this._threadStarter);var b=this.model.get("original"),c=b&&b.get("id");return a.id!==c&&this.model.set("original",a),this._replyNotice.show(),this}},_setupListeners:function(){k.prototype._setupListeners.call(this),this.listenTo(this._replyNotice,"reset",this._onResetNotice)},_createModel:function(){return new f({sender:d.getCurrentUser()})},_getEditorModel:function(){return this.model},_getEditorClass:function(){return i},_getSelectorClass:function(){return j},_getSelectorOptions:function(){return{allowExternalEmails:!0,allowForeignEmails:!0,typeaheadModels:[g.MODEL_USER,g.MODEL_PENDINGUSER,g.MODEL_DOMAIN]}},_getDropdownDirection:function(){return this._inLightbox?"up":"down"},_requiresGroup:function(){return!1},_createOther:function(){this._createReplyArea(),this._createWarningArea()},_createReplyArea:function(){this._replyNotice=new h({model:this.model}),this.add(this._replyNotice,".publisher-reply")},_onResetNotice:function(){this.replyTo(this._threadStarter),this.focus(),m.announceText(e.t("replying_to_original_poster")),this._replyNotice.hide(),c.trigger("/ui/lightbox/resize")},_createWarningArea:function(){this._privacyWarning=new l({model:this.model,inLightbox:this._inLightbox}),this.add(this._privacyWarning,".publisher-warning")}})}),define("css!feeds/lib/ui/publisher/global/file_drag_drop_area",[],function(){}),define("feeds/lib/ui/publisher/global/file_drag_drop_area",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/file_upload_button","core/lib/report","core/lib/session","core/lib/string_helper","core/lib/tr","common-ui/lib/helper/environment","css!feeds/lib/ui/publisher/global/file_drag_drop_area"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("feeds/lib/ui/publisher/global/file_upload_button"),h=a("core/lib/report"),i=a("core/lib/session"),j=a("core/lib/string_helper"),k=a("core/lib/tr"),l=a("common-ui/lib/helper/environment");a("css!feeds/lib/ui/publisher/global/file_drag_drop_area");var m={main:null},n={main:k.t("drop_your_files_here")};return d.extend({mixins:[e,f],defaults:{icons:m,strings:n},events:{dragenter:"_onDragEnterArea",dragleave:"_onDragLeaveArea",drop:"_onDropArea"},className:"yj-global-file-drag-drop-area",initialize:function(a){if(this._icons=a.icons,this._strings=a.strings,!(l.isIE()&&l.isIE().version<11)){if(!this._allowAttachments())return void this.stopListening();this._createChildren(),this._setupListeners()}},remove:function(){return this._removeListeners(),d.prototype.remove.call(this)},enable:function(){return this._button.enable(),this},disable:function(){return this._button.disable(),this},reset:function(){null==this._drag&&(this._drag={}),clearTimeout(this._drag.timeout),this._drag.doc=0,this._drag.area=0,this._drag.timeout=null,this.$el.removeClass("drag-enter drag-over")},_createChildren:function(){this._button=new g({collection:this.model.get("files"),icons:this._icons,strings:this._strings,hideFromAccessibility:!0}),this.add(this._button)},_setupListeners:function(){c.bindAll(this,"reset","_onDragEnterDocument","_onDragLeaveDocument","_onDragOverDocument","_onDropDocument"),this.reset(),b(window.document).on("dragenter",this._onDragEnterDocument).on("dragleave",this._onDragLeaveDocument).on("dragover",this._onDragOverDocument).on("drop",this._onDropDocument)},_removeListeners:function(){b(window.document).off("dragenter",this._onDragEnterDocument).off("dragleave",this._onDragLeaveDocument).off("dragover",this._onDragOverDocument).off("drop",this._onDropDocument)},_allowAttachments:function(){var a=i.getCurrentUser(),b=a&&a.web_preferences,c=b&&b.network_settings;return c?j.convertStringyBoolean(c.allow_attachments):!0},_onDragEnterArea:function(){0===this._drag.area&&this.$el.addClass("drag-over"),this._drag.area++},_onDragLeaveArea:function(){this._drag.area--,0===this._drag.area&&this.$el.removeClass("drag-over")},_onDropArea:function(){h.event("file_dropped"),this.trigger("drop")},_onDragEnterDocument:function(){0===this._drag.doc&&(this.$el.addClass("drag-enter"),this._button.refresh()),this._drag.doc++},_onDragLeaveDocument:function(){this._drag.doc--,0===this._drag.doc&&this.$el.removeClass("drag-enter")},_onDragOverDocument:function(){clearTimeout(this._drag.timeout),this._drag.timeout=setTimeout(this.reset,1e3)},_onDropDocument:function(){this.reset()}})}),define("stache!feeds/lib/ui/publisher/global/reply_publisher_with_placeholder",["mustache"],function(a){var b='<div class="publisher-fake">\n  <a class="publisher-placeholder" href="javascript://" role="button">\n    <span class="publisher--placeholder-container">{{placeholder}}</span>\n  </a>\n  {{#allowAttachments}}\n    <button class="unstyle-button-as-span publisher-fake-button">\n      <span class="publisher-fake-icon yamicon yamicon-paperclip">\n        <span class="yj-acc-hidden">{{paperclipAltText}}</span>\n      </span>\n    </button>\n  {{/allowAttachments}}\n</div>\n<div class="publisher-real"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/reply_publisher_with_placeholder",[],function(){}),define("feeds/lib/ui/publisher/global/reply_publisher_with_placeholder",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","models/message_backbone","feeds/lib/ui/publisher/global/reply_publisher","feeds/lib/ui/publisher/global/file_drag_drop_area","feeds/lib/ui/publisher/global/external_educational_popup","backbone","core/lib/report","core/lib/session","core/lib/string_helper","core/lib/tr","common-ui/lib/ui/accessibility/focus_helper","html!./reply_publisher_with_placeholder","css!./reply_publisher_with_placeholder"],function(a){
var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("models/message_backbone"),h=a("feeds/lib/ui/publisher/global/reply_publisher"),i=a("feeds/lib/ui/publisher/global/file_drag_drop_area"),j=a("feeds/lib/ui/publisher/global/external_educational_popup"),k=a("backbone"),l=a("core/lib/report"),m=a("core/lib/session"),n=a("core/lib/string_helper"),o=a("core/lib/tr"),p=a("common-ui/lib/ui/accessibility/focus_helper"),q=a("html!./reply_publisher_with_placeholder");return a("css!./reply_publisher_with_placeholder"),c.extend({mixins:[d,e,f],defaults:function(){var a=o.t("write_a_reply"),b=o.t("add_file"),c={placeholder:a,paperclipAltText:b};return{strings:c,allowAttachments:!0}},events:{"click .publisher-fake":"_onClickFake","click .publisher-fake-button":"_onClickFakeButton"},className:"yj-global-reply-publisher-with-placeholder style-paperclip",template:q,initialize:function(a){this._strings=a.strings,this._showAlert=a.showAlert,this._inLightbox=a.inLightbox,this._logType=a.logType,this._logSource=a.logSource,this._allowAttachments=this._areAttachmentsAllowed(a),this._popupMode=j.MODE.RECIPIENT_WITHOUT_GROUP,this.model=a.model||new g,this._createChildren(),this._setupListeners()},getTemplateData:function(){return{placeholder:o.t("write_a_reply_no_ellipsis"),paperclipAltText:this._strings.paperclipAltText,allowAttachments:this._allowAttachments}},render:function(){return this.$placeholder=this.$(".publisher-placeholder"),this},replyTo:function(){return this._getPublisher().replyTo.apply(this._getPublisher(),arguments),this.open(),this},open:function(){return this.swap(!0),this},close:function(){return this.swap(!1),open||this._hideEducationalPopup(),this},swap:function(a){return this.$el.is(".yj-open")&&!a&&p.notifyRemoval(this.$el),this.$el.toggleClass("yj-open",a),this.trigger(a?"open":"close"),this._getPublisher().toggle(a),k.trigger("/ui/lightbox/resize"),this},isOpen:function(){return this.$el.hasClass("yj-open")},enable:function(){return this._getPublisher().enable(),this},disable:function(){return this._getPublisher().disable(),this},focus:function(){return this._getPublisher().focus(),this},blur:function(){return this._getPublisher().blur(),this},reset:function(){return this._getPublisher().reset(),this.close(),this},isResettable:function(){return this._getPublisher().isResettable()},_updatePlaceholder:function(a){this._strings.placeholder=a,this.$el.find(".publisher--placeholder-container").text(a)},_areAttachmentsAllowed:function(a){var b=a.allowAttachments,c=this._userAttachmentSetting();return b&&c},_userAttachmentSetting:function(){var a=m.getCurrentUser(),b=a&&a.web_preferences,c=b&&b.network_settings;return c?n.convertStringyBoolean(c.allow_attachments):!0},_createChildren:function(){this._allowAttachments&&this._addDragDropArea(),this._addEducationalPopup()},_createPublisher:function(a){return new h(a)},_addPublisher:function(){var a={model:this.model,showAlert:this._showAlert,inLightbox:this._inLightbox,logType:this._logType,logSource:this._logSource,allowAttachments:this._allowAttachments};this._publisher=this._createPublisher(a),this.add(this._publisher,".publisher-real"),this.render(),this.listenTo(this._getPublisher(),"change:title",this._notifyParent.bind(this,"change:title"))},_addDragDropArea:function(){this._dragdrop=new i({model:this.model}),this.add(this._dragdrop)},_addEducationalPopup:function(){this._canShowEducationalPopup()&&(this._recipientPopup=new j({mode:this._popupMode}),this.add(this._recipientPopup,".publisher-educational-popup"))},_canShowEducationalPopup:function(){return j.canShowForMode(this._popupMode)},_setupListeners:function(){b.bindAll(this,"_openFileMenu"),this.listenTo(this.model,"change:state",this._onChangeState),this.listenTo(this,"show",this._notifyPublisher.bind(this,"show")),this.listenTo(this,"hide",this._notifyPublisher.bind(this,"hide")),this._allowAttachments&&this.listenTo(this._dragdrop,"drop",this._fileDropped)},_showEducationalPopup:function(){this._recipientPopup&&this._recipientPopup.show()},_hideEducationalPopup:function(){this._recipientPopup&&this._recipientPopup.hide()},_fileDropped:function(){this.replyTo(this.model.get("original"))},_onClickFake:function(a){a&&(a.preventDefault(),a.stopPropagation()),this.replyTo(null),this._showEducationalPopup(),l.event("smallabs_social_routing_cta_reply_focus")},_openFileMenu:function(){this._getPublisher().openFileMenu()},_onClickFakeButton:function(a){a.preventDefault(),a.stopPropagation(),this._onClickFake(),this._openFileMenu()},_onChangeState:function(){this.model.hasBeenSubmitted()&&(this.trigger("change:title",""),this.close())},_notifyPublisher:function(){this._getPublisher().trigger.apply(this._getPublisher(),arguments)},_notifyParent:function(){this.trigger.apply(this,arguments)},_getPublisher:function(){return!this._publisher&&this._addPublisher(),this._publisher}})}),define("stache!feeds/lib/ui/publisher/global/reply_publisher_with_avatar",["mustache"],function(a){var b='<div class="publisher-avatar"></div>\n<div class="publisher-container"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/reply_publisher_with_avatar",[],function(){}),define("feeds/lib/ui/publisher/global/reply_publisher_with_avatar",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","components/avatar/index","feeds/lib/ui/publisher/global/reply_publisher_with_placeholder","core/lib/session","html!./reply_publisher_with_avatar","css!./reply_publisher_with_avatar"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("components/avatar/index"),g=a("feeds/lib/ui/publisher/global/reply_publisher_with_placeholder"),h=a("core/lib/session"),i=a("html!./reply_publisher_with_avatar");return a("css!./reply_publisher_with_avatar"),b.extend({mixins:[c,d,e],className:"yj-global-reply-publisher-with-avatar",template:i,initialize:function(a){this._strings=a.strings,this._showAlert=a.showAlert,this._inLightbox=a.inLightbox,this._logType=a.logType,this._logSource=a.logSource,this._allowAttachments=a.allowAttachments,this._createChildren(),this._setupListeners()},open:function(){return this._publisher.open(),this},close:function(){return this._publisher.close(),this},swap:function(a){return this._publisher.swap(a),this},replyTo:function(){return this._publisher.replyTo.apply(this._publisher,arguments),this},isOpen:function(){return this._publisher.isOpen()},enable:function(){return this._publisher.enable(),this},disable:function(){return this._publisher.disable(),this},focus:function(){return this._publisher.focus(),this},blur:function(){return this._publisher.blur(),this},reset:function(){return this._publisher.reset(),this},isResettable:function(){return this._publisher.isResettable()},_createChildren:function(){this._avatar=new f({model:h.getCurrentUser(),withHovercard:!1,hideFromAccessibility:!0}),this._publisher=new g({model:this.model,strings:this._strings,showAlert:this._showAlert,inLightbox:this._inLightbox,logType:this._logType,logSource:this._logSource,allowAttachments:this._allowAttachments}),this.add(this._avatar,".publisher-avatar"),this.add(this._publisher,".publisher-container")},_setupListeners:function(){this.listenTo(this,"show",this._notifyPublisher.bind(this,"show")),this.listenTo(this,"hide",this._notifyPublisher.bind(this,"hide")),this.listenTo(this._publisher,"open",this._notifyParent.bind(this,"open")),this.listenTo(this._publisher,"close",this._notifyParent.bind(this,"close")),this.listenTo(this._publisher,"change:title",this._notifyParent.bind(this,"change:title"))},_notifyPublisher:function(){this._publisher.trigger.apply(this._publisher,arguments)},_notifyParent:function(){this.trigger.apply(this,arguments)}})}),define("css!feeds/lib/ui/threads/topics",[],function(){}),define("stache!feeds/lib/ui/threads/topics",["mustache"],function(a){var b='<h2 class="yj-conversation--topics-header" role="presentation">\n  <span role="heading" aria-level="2">{{label}}</span>\n  <a class="yj-conversation--topics-header-done-editing yj-edit yj-see-all-link" href="javascript://" role="button">{{edit}}</a>\n</h2>\n<div class="yj-tag-list-container"></div>\n<div class="yj-add-form" style="display:none">\n  <label><span class="yj-acc-hidden"> {{addTopic}} </span>\n    <input data-yamjs-id="{{addTopicId}}" class="yj-add-topic yj-inactive" placeholder="+ {{add}}" type="text" />\n  </label>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/threads/topics",["require","jquery","underscore","core/lib/backbone_legacy_integration","backbone","core/lib/tr","core/lib/yammer_api","models/thread","common-ui/lib/ui/shared/tag_list","common-ui/lib/ui/shared/type_ahead","css!./topics","html!./topics"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_legacy_integration"),e=a("backbone"),f=a("core/lib/tr"),g=a("core/lib/yammer_api");a("models/thread");var h=a("common-ui/lib/ui/shared/tag_list"),i=a("common-ui/lib/ui/shared/type_ahead");return a("css!./topics"),d.extend({className:"yj-conversation--topics",initialize:function(a){a=c.extend({},this.defaults,a),c.bindAll(this,"addSuccessCallback","addFailureCallback"),this.target=a.target,this.attachPoint=a.attachPoint,this.attachMethod=a.attachMethod,this.isEditing=a.isEditing,this.settings=a.settings,this.options=a,this.tagList=new h(c.extend(a.tagSettings,{removeHandler:this.handleRemoveClick.bind(this),tags:c.uniq(this.options.data.topics,!1,function(a){return a.id})})),this.add(this.tagList,a.tagSettings.tagTarget)},defaults:{settings:{label:f.t("topics"),editClassName:"yj-editable",addTopicId:"topics-add",addTopicLabel:""},tagSettings:{tagTarget:".yj-tag-list-container",removeHandler:this.handleRemoveClick,truncateNameLength:27},isEditing:!1,removeSuccess:!1,removeFailure:!1,addSuccess:!1,addFailure:!1,editModeIfNone:!1,addTopicCall:!1,removeTopicCall:!1},strings:{edit:f.t("edit_2"),addTopic:f.t("add_topic_2"),add:f.t("add"),doneEditing:f.t("done_editing")},template:a("html!./topics"),events:{"click .yj-edit":"handleEditClick","keyup .yj-add-topic":"handleKeyup","focus .yj-add-topic":"setSearchActive","blur .yj-add-topic":"setSearchActive","click .yj-add-btn":"createTopic"},addTopics:function(a){if(!a)throw new Error("BaseTopics:addTopics() - topic is null");"#"==a.name.substring(0,1)&&(a.name=a.name.substring(1,a.name.length)),this.tagList.addTags(a),this.$edit.show(),this.isVisible()||this.show(),this.addTopicToOrm(a)},removeTopicFromOrm:function(a){var b=yam.model.Thread.findById(this.options.data.threadId);b&&(b.topics=c.reject(b.topics,function(b){return b.id===parseInt(a,10)}))},addTopicToOrm:function(a){var b=yam.model.Thread.findById(this.options.data.id);void 0!==b&&(b.addTopic({type:a.type,id:a.id}),yam.model.Topic.create(a))},diffTopics:function(a){return this.tagList.diff(a)},getTopics:function(){return this.tagList.tags},updateTopics:function(a){return this.diffTopics(a)?(this.tagList.updateTags(a),this.tagList.render(),this.render()):!1},render:function(){return this.renderTemplate(this.prepViewData()),this.$edit=this.$(".yj-edit"),this.$search=this.$(".yj-add-topic"),this.$add=this.$(".yj-add-btn"),this.options.editModeIfNone&&this.tagList.isEmpty()&&this.handleEditClick(),this},createTypeAhead:function(){var a={onSelect:this.handleTopicSelect.bind(this),completableModels:[i.MODEL_TOPIC],insertionMode:!1,includeTopics:!0,showNoMatches:!1,selectFirst:!1,allowNoMatch:!0,hintMessage:f.t("type_to_search_for_topics"),onNoSelection:this.createTopic.bind(this),customClassName:"topics-tagger "+this.settings.addTopicId};this.typeAheadOps&&c.extend(a,this.typeAheadOps);var b=this;c.defer(function(){b.$search.each(function(){i.registerField(this,a)})})},createTopic:function(){if(!this.topicsDisabled){var a=this.$search.not(".yj-inactive");a.is("*")||(a=this.$search),a.attr("disabled","disabled"),a.blur(),a.addClass("yj-loading"),this.addTopicByName(a.val())}},remove:function(){this.$search&&this.$search.each(function(){i.removeField(this)})},setSearchActive:function(a){"focus"==a.type||"focusin"==a.type?this.$search.removeClass("yj-inactive"):this.$search.addClass("yj-inactive")},handleKeyup:function(){this.$search.val()?(this.$add.removeClass("yj-btn-disabled"),this.$add[0].disabled=!1):(this.$add.addClass("yj-btn-disabled"),this.$add[0].disabled=!0)},handleEditClick:function(){var a=this;this.toggleEditMode(function(){a.$search.focus()})},handleRemoveClick:function(a,c){b.contains(this.tagList.$el[0],document.activeElement)&&this.$search.focus(),this.removeTopicRequest(a,c)},toggleEditMode:function(a){a="function"==typeof a?a:function(){},this.settings&&this.settings.editClassName&&this.tagList.$el.toggleClass(this.settings.editClassName),this.isEditing=this.isTagListEditing(),this.$edit.text(this.isEditing?this.strings.doneEditing:this.strings.edit),this.$(".yj-add-form").toggle(),this.isEditing&&this.createTypeAhead(),this.showHideEdit()},isTagListEditing:function(){return this.settings&&this.settings.editClassName?this.tagList.$el.hasClass(this.settings.editClassName):!1},showHideEdit:function(){this.options.editModeIfNone&&this.tagList.isEmpty()?this.$edit.hide():this.$edit.show()},showEditForm:function(a){this.toggleEditMode(a)},handleTopicSelect:function(a){this.$search.val(a.name),this.disableSearchField(),this.addTopicById(a.id)},addTopicById:function(a){var b=c.extend({topic_id:a},c.pick(this.options.data,"thread_id","note_id","file_id","itemId","threadId"));this.tagList.contains(name)?(e.trigger("/ui/alert/show","error",f.t("that_topic_has_already_been_added")),this.resetSearchField()):this.addTopicRequest(b)},addTopicByName:function(a){var b=c.extend({topic:a},c.pick(this.options.data,"thread_id","note_id","file_id","itemId","threadId"));return a&&""!==a.replace(/\s/g,"")&&a!==this.settings.addTopicLabel?void(this.tagList.containsName(a)?(e.trigger("/ui/alert/show","error",f.t("that_topic_has_already_been_added")),this.resetSearchField()):this.addTopicRequest(b)):void this.resetSearchField()},addTopicRequest:function(a){var b=this.options.addTopicCall||g.addThreadTopic;a.threadId&&!a.thread_id&&(a.thread_id=a.threadId,delete a.threadId),b(a).then(this.addSuccessCallback,this.addFailureCallback)},removeTopicRequest:function(a,b){var c=this,d=function(a){"function"==typeof c.options.removeSuccess&&c.options.removeSuccess(a),b.call(c.tagList,"fast"),c.showHideEdit()},e=function(a){"function"==typeof c.options.removeFailure&&c.options.removeFailure(a),b.call(c.tagList,"fast"),c.showHideEdit()},f=this.options.removeTopicCall||g.removeThreadTopic;f({thread_id:this.options.data.threadId,topic_id:a}).then(d,e),this.removeTopicFromOrm(a)},addToTopicIndex:function(a){this.tagList.addTags(a)},removeFromTopicIndex:function(a,b){this.tagList.removeTag(b)},addSuccessCallback:function(a){"function"==typeof this.options.addSuccess&&this.options.addSuccess(a),this.addTopics(a),this.resetSearchField(!0),this.$search.first().focus()},addFailureCallback:function(a){"function"==typeof this.options.addFailure&&this.options.addFailure(a),this.resetSearchField(!0),this.$search.first().focus()},disableSearchField:function(){var a=this.$search.not(".yj-inactive");a.attr("disabled","disabled"),a.addClass("yj-loading")},resetSearchField:function(){this.$search.removeClass("yj-loading"),this.$search.val(""),this.$search.blur(),this.$search.removeAttr("disabled"),this.$search.addClass("yj-inactive"),this.$add.addClass("yj-btn-disabled"),this.$add[0].disabled=!0,this.showHideEdit()},prepViewData:function(){return{addTopicId:this.settings.addTopicId,addTopicLabel:this.settings.addTopicLabel,label:this.settings.label,edit:this.strings.edit,addTopic:f.t("add_topic_2"),add:f.t("add"),doneEditing:this.strings.doneEditing}},isTopicsVisible:function(){return this.isEditing||!this.tagList.isEmpty()}})}),define("css!feeds/lib/ui/threads/topics_inline",[],function(){}),define("stache!feeds/lib/ui/threads/topics_inline",["mustache"],function(a){var b='{{! We want to float the "Edit Topics" button right so that it takes up space and doesn\'t end up overlapping\n    with tags. But this only works if it comes before the rest of the content - but that\'s not the\n    tab order we want. So fix here is to have *two* instances: an initial span that\'s floated right just\n    to occupy space and is visibility:hidden via CSS; and a second instance that is positioned\n    absolutely to the same point on the screen which comes afterwards - giveing us the desired tab order. }}\n<span class="yj-topics-inline--edit-spacer yj-edit">{{edit}}</span>\n<div class="yj-topics-container yj-clearfix">\n  <div class="yj-add-form">\n    <label><span class="yj-acc-hidden">{{addTopicLabel}}</span>\n      <input data-yamjs-id="{{addTopicId}}" class="yj-add-topic yj-inactive" type="text" placeholder="{{addTopicLabel}}" />\n    </label>\n    <button class="yj-add-btn yj-btn yj-btn-alt yj-btn-disabled" disabled>{{add}}</button>\n  </div>\n</div>\n<a class="yj-topics-inline--edit yj-edit" href="javascript://" role="button">{{edit}}</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/threads/topics_inline",["require","underscore","core/lib/tr","feeds/lib/ui/threads/topics","css!./topics_inline","html!./topics_inline"],function(a){var b=a("underscore"),c=a("core/lib/tr"),d=a("feeds/lib/ui/threads/topics");return a("css!./topics_inline"),d.extend({className:"yj-thread-topics yj-topics-inline yj-want-focuswithin",defaults:{settings:{label:c.t("topics"),editClassName:"yj-editable",hideOnEmpty:!0,addTopicLabel:c.t("add_topic_3"),addTopicId:"add-topics-inline"},tagSettings:{tagTarget:".yj-topics-container",prependToTarget:!0,truncateNameLength:45},isEditing:!1},strings:{edit:c.t("edit_topics"),doneEditing:c.t("done")},template:a("html!./topics_inline"),initialize:function(a){d.prototype.initialize.call(this,b.extend(a,this.defaults))},render:function(){return d.prototype.render.apply(this),this.options.data.topics.length<1&&this.hide(),this.$addForm=this.$(".yj-add-form"),this.$add=this.$(".yj-add-btn"),this},toggleEditMode:function(a,b){d.prototype.toggleEditMode.call(this,a),this.isEditing?this.$el.addClass(this.settings.editClassName):this.$el.removeClass(this.settings.editClassName),this.isEditing?(this.$addForm.css("display","inline").show(),this.show(),this.$search.show(1,a)):this.tagList.isEmpty()&&!b?this.hide():this.$search.hide(),this.trigger("edit",this.isEditing)},show:function(){this.$el.show(),this.trigger("shown")},hide:function(){this.$el.hide(),this.trigger("hidden")}})}),define("stache!components/group_callout/src/group_callout_join_link",["mustache"],function(a){var b='{{#canJoin}}<a role="button" href="javascript://" class="yj-btn yj-btn-alt yj-btn-tiny yj-groupcallout-join-link--link" title="{{joinTitle}}">{{joinLabel}}</a>{{/canJoin}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/group_callout/src/group_callout_join_link",[],function(){}),define("components/group_callout/src/group_callout_join_link",["require","underscore","core/lib/tr","backbone","core/lib/session","core/lib/yammer_api","models/helpers/user","models/helpers/group","common-ui/lib/ui/accessibility/focus_helper","collections/group_memberships","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./group_callout_join_link","css!./group_callout_join_link"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("backbone"),e=a("core/lib/session"),f=a("core/lib/yammer_api"),g=a("models/helpers/user"),h=a("models/helpers/group"),i=a("common-ui/lib/ui/accessibility/focus_helper"),j=a("collections/group_memberships"),k=a("core/lib/backbone_base_view"),l=a("core/lib/backbone_with_auto_render"),m=a("html!./group_callout_join_link");return a("css!./group_callout_join_link"),k.extend({mixins:[l],tagName:"span",className:"yj-groupcallout-join-link",template:m,events:{"click .yj-groupcallout-join-link--link":"_onClick"},initialize:function(){b.bindAll(this,"_joinGroupSuccess","_joinGroupFailure"),this.listenTo(j,"add remove",this._onGroupMembershipChange,this)},getTemplateData:function(){return{canJoin:!this._isMember(),joinLabel:c.t("join"),joinTitle:c.t("join_group")}},_isMember:function(){return g.isMemberOf(e.getCurrentUser(),this.model)},_onClick:function(a){a.preventDefault(),f.joinGroup({group_id:this.model.get("id"),bfr_source:"group_callout_join_link"}).then(this._joinGroupSuccess,this._joinGroupFailure)},_joinGroupSuccess:function(){var a=this.model.get("privacy"),b="private"===a||"restricted"===a,c=b?this._getPendingJoinMessage():this._getJoinMessage(),f={user_id:e.getCurrentUser().id,group_id:this.model.get("id"),pending:b};j.add(f),d.trigger("/ui/alert/show","notice",c)},_joinGroupFailure:function(){d.trigger("/ui/alert/show","error",c.t("there_was_an_error_joining_this_group")),this.render()},_onGroupMembershipChange:function(a){a.get("group_id")===this.model.get("id")&&(this._isMember()&&i.notifyRemoval(this.$el),this.render())},_getPendingJoinMessage:function(){return c.t("you_have_requested_to_join_the_name_group",{name:h.getFullName(this.model)})},_getJoinMessage:function(){return c.t("you_have_joined_the_name_group",{name:h.getFullName(this.model)})}})}),define("stache!components/group_callout/src/group_callout",["mustache"],function(a){var b='{{#showGroupLink}}\n<div class="yj-group-callout--link-container" {{#color}}style="color:{{color}};"{{/color}}>\n  <a href="{{{webUrl}}}" class="yj-group-callout--link" data-resource-id="{{resourceId}}" data-resource-model="group"><span class="yj-group-callout--icon yamicon yamicon-rd_groups"></span> <span class="yj-group-callout--name">{{ name }}<NetworkLabel/></span></a>{{#showJoinLink}} <JoinLink />{{/showJoinLink}}\n</div>\n{{/showGroupLink}}\n{{#showGroupLabel}}\n<div class="yj-group-callout--label">\n  <strong><span class="yj-group-callout--icon yamicon yamicon-rd_groups"></span> <span class="yj-group-callout--name">{{name}}<NetworkLabel/></span></strong>\n</div>\n{{/showGroupLabel}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/group_callout/src/group_callout",[],function(){}),define("components/group_callout/src/group_callout",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./group_callout_join_link","components/network_label/index","core/lib/tr","backbone","collections/groups","models/group","models/lib/orm-models","models/lib/model/helper/report_feed_events","models/helpers/group","core/lib/urls","core/lib/session","html!./group_callout","css!./group_callout"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./group_callout_join_link"),f=a("components/network_label/index"),g=a("core/lib/tr"),h=a("backbone"),i=a("collections/groups"),j=a("models/group"),k=a("models/lib/orm-models"),l=a("models/lib/model/helper/report_feed_events"),m=a("models/helpers/group"),n=a("core/lib/urls"),o=a("core/lib/session"),p=a("html!./group_callout");return a("css!./group_callout"),b.extend({mixins:[c,d],className:"yj-group-callout",template:p,views:{JoinLink:"_getJoinLink",NetworkLabel:"_getNetworkLabel"},events:{"click .yj-group-callout--link":"_onClick"},_getJoinLink:function(){return new e({model:this.model.getGroup()})},_getNetworkLabel:function(){return new f(this.options)},render:function(){return this._addHovercard(),this},getTemplateData:function(){var a;return a=this._isPrivateGroupShare()?this._getPrivateGroupShareTemplateData():this._isForeignAllCompanyMessage()?this._getForeignAllCompanyMessageTemplateData():this._getGroupTemplateData()},_isPrivateGroupShare:function(){var a=i.get(this.model.group_id);return!a&&this.model.group_id},_isForeignAllCompanyMessage:function(){return this.model.isForeign()&&m.isAllCompany(this.model.getGroup())},_getPrivateGroupShareTemplateData:function(){var a=m.isForeign(this.model,o);return{showGroupLabel:!0,name:g.t("a_private_group"),foreign:a}},_getForeignAllCompanyMessageTemplateData:function(){var a=j.ALL_COMPANY(),b=k.Network().findById(this.model.network_id);return{showGroupLabel:!0,name:a.get("full_name"),network:b.getPlainBody(),foreign:!0}},_getGroupTemplateData:function(){var a=this.model.getGroup(),b=m.isAllCompany(a),c=m.isForeign(this.model,o),d=k.Network().findById(this.model.network_id);return{showGroupLink:!0,showJoinLink:!b&&!c,webUrl:n.groupIndex(a),resourceId:a.get("id"),name:m.getFullName(a),color:this._getGroupColor(),network:d&&d.getPlainBody(),foreign:c}},_getGroupColor:function(){var a=this.model.getGroup();return a?m.getGroupColor(a):""},_onClick:function(){l.reportFeedEvent("feed_link_click",this.model.getGroup()?"group":"general",this.model.get("group_id"),{link_type:"group_callout_link"})},_addHovercard:function(){h.trigger("/ui/hovercard/build",this.$el,".yj-group-callout--link")}})}),define("components/group_callout/index",["require","./src/group_callout"],function(a){"use strict";var b=a("./src/group_callout");return b}),define("feeds/lib/ui/threads/future/thread_list_item_commands",["require","core/lib/backbone_base_class","common-ui/lib/ui/keyboard/keyboard_shortcuts"],function(a){var b=a("core/lib/backbone_base_class"),c=a("common-ui/lib/ui/keyboard/keyboard_shortcuts"),d={noNextItem:"No next reply.",noPrevItem:"No previous reply.",noItems:"No replies."};return b.extend({initialize:function(){this.listenTo(this.options.threadNavigator,"change:localCurrent",this._observeThreadCommands)},stop:function(){this.stopListening()},_observeThreadCommands:function(){this.stopListening(c),this.options.threadNavigator.get("localCurrent")===this.options.model&&(this.listenTo(c,"item_expand",this._handleItemExpand),this.listenTo(c,"nav_next_reply",this._navNextReply),this.listenTo(c,"nav_prev_reply",this._navPrevReply))},_handleItemExpand:function(){this.options.threadListItem.showOlderReplies(),this.options.threadListItem.showNewerReplies()},_navNextReply:function(){this.options.replyNavigator.navNext({errorStrings:d})},_navPrevReply:function(){this.options.replyNavigator.navPrev({errorStrings:d})}})}),define("css!feeds/lib/ui/threads/future/thread_list_item",[],function(){}),define("stache!feeds/lib/ui/threads/future/thread_list_item",["mustache"],function(a){var b='<div class="yj-thread-list-item--replies-container yj-thread-replies-container">\n  <div class="yj-thread-list-item--shares-topics-container is-empty">\n    <a href="javascript://" role="button" class="yj-thread-list-item--shares-link yj-show-thread-shares">\n      <span class="yj-thread-list-item--shares-link-icon yamicon yamicon-rd_share"></span>\n      <span class="yj-thread-list-item--shares-text"></span>\n    </a>\n  </div>\n  <div data-qaid="show-older-replies-container" class="yj-thread-list-item--show-replies yj-show-replies-container {{#isOcularSupportedFeed}}is-ocular-supported{{/isOcularSupportedFeed}}">\n    <a data-qaid="show-older-replies-link" class="yj-thread-list-item--older-replies-link yj-show-older-replies" href="javascript://" role="button" style="display:block">\n      <span class="yamicon yamicon-rd_more_replies yj-thread-list-item--older-replies-icon"></span>\n      <span class="yj-thread-list-item--older-replies-text"></span>{{#isOcularSupportedFeed}}<span data-qaid="show-older-unviewed-indicator" class="yj-thread-list-item--unviewed-replies"></span>{{/isOcularSupportedFeed}}\n    </a>\n  </div>\n  <ul class="yj-thread-list-item--replies yj-thread-replies is-unread"></ul>\n  <div data-qaid="show-newer-replies-container" class="yj-thread-list-item--show-replies yj-show-replies-container is-unread {{#isOcularSupportedFeed}}is-ocular-supported{{/isOcularSupportedFeed}}">\n    <a data-qaid="show-newer-replies-link" class="yj-thread-list-item--newer-replies-link yj-show-newer-replies yj-unread" href="javascript://" role="button">\n      <span class="yamicon yamicon-rd_more_replies yj-thread-list-item--newer-replies-icon"></span>\n      <span class="yj-thread-list-item--newer-replies-text"></span>{{#isOcularSupportedFeed}}<span data-qaid="show-newer-unviewed-indicator" class="yj-thread-list-item--unviewed-replies"></span>{{/isOcularSupportedFeed}}\n    </a>\n  </div>\n  <div class="yj-thread-list-item--reply-publisher"></div>\n  {{#read_only}}\n  <div class="yj-thread-list-item--read-only-warning-bar" data-qaid="read_only_warning">\n    {{read_only_warning}}\n  </div>\n  {{/read_only}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/threads/future/thread_list_item",["require","jquery","underscore","core/lib/backbone_legacy_integration","mustache","models/message_backbone","common-ui/lib/ui/general/lightbox_manager","models/message","feeds/lib/ui/feeds/thread_share_summary","feeds/lib/ui/messages/thread_starter","feeds/lib/ui/messages/thread_reply_list_item","feeds/lib/ui/threads/future/thread_delegate","feeds/lib/ui/publisher/global/reply_publisher_with_avatar","models/helpers/message","backbone","feeds/lib/ui/threads/topics_inline","core/lib/session","core/lib/tr","core/lib/yammer_api","components/group_callout/index","core/lib/treatment","common-ui/lib/ui/keyboard/linear_navigator","feeds/lib/ui/threads/future/thread_list_item_commands","common-ui/lib/ui/keyboard/navigable_element_adaptor","common-ui/lib/ui/accessibility/focus_helper","css!./thread_list_item","html!./thread_list_item"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_legacy_integration"),e=a("mustache"),f=a("models/message_backbone"),g=a("common-ui/lib/ui/general/lightbox_manager"),h=a("models/message"),i=a("feeds/lib/ui/feeds/thread_share_summary"),j=a("feeds/lib/ui/messages/thread_starter"),k=a("feeds/lib/ui/messages/thread_reply_list_item"),l=a("feeds/lib/ui/threads/future/thread_delegate"),m=a("feeds/lib/ui/publisher/global/reply_publisher_with_avatar"),n=a("models/helpers/message"),o=a("backbone"),p=a("feeds/lib/ui/threads/topics_inline"),q=a("core/lib/session"),r=a("core/lib/tr"),s=a("core/lib/yammer_api"),t=a("components/group_callout/index"),u=a("core/lib/treatment"),v=a("common-ui/lib/ui/keyboard/linear_navigator"),w=a("feeds/lib/ui/threads/future/thread_list_item_commands"),x=a("common-ui/lib/ui/keyboard/navigable_element_adaptor"),y=a("common-ui/lib/ui/accessibility/focus_helper");return a("css!./thread_list_item"),d.extend({tagName:"li",className:"yj-thread-list-item",template:a("html!./thread_list_item"),mutedTemplate:['<div class="yj-thread-muted yj-thread-list-item--muted-message">','{{message}} <a class="yj-btn yj-btn-alt yj-undo-mute" href="javascript://">{{undo}}</a>',"</div>"].join(""),events:{addTopic:"handleAddTopic",openReplyForm:"handleOpenReplyForm",deleteMessage:"handleDeleteMessage",submitted:"handleReplySubmitted","click .yj-publisher-opener":"handleOpenReplyForm","click .yj-undo-mute":"handleUndoMute","click a":"handleAnyAction"},initialize:function(a){this.options=this._defaultOptions(a||{}),this.feedId=a.feedId;var b=a.showMuteAction;this._showMuteAction=void 0===b?!0:b,this._delegate=new l(a),this.data=a.thread,this.thread=a.thread,this.feedModel=a.feed,this.settings=a.settings,this.messages={},this.renderOptions={read_only_warning:r.t("read_only_warning"),isOcularSupportedFeed:this.options.isOcularSupportedFeed},u.treatment("keyboardshortcuts2")&&(this._initializeNavigation(),this.commands=new w({threadNavigator:this.threadNavigator,model:this.thread,replyNavigator:this.replyNavigator,threadListItem:this})),this._renderedReplyIds=[],this.options.isOcularSupportedFeed&&(this.lastViewedMessageId=a.lastViewedMessageId),this._addThreadStarter(),this._addGroupCallout(),
this._addThreadTopics(),this.thread.isReadOnly()?this.renderOptions.read_only=!0:this._addReplyForm(),this.options.isOcularSupportedFeed&&(this._checkAndAddUnviewedIndicator(),this.listenTo(this.thread.viewedState.futureViewedStateModel,"change",this._checkAndRemoveUnviewedIndicator)),this.listenTo(this._delegate,{"add:message":this._handleReplyAdded,"thread:update":this._handleThreadUpdate,request:c.partial(this._setOlderRepliesLoading,!0),sync:c.partial(this._setOlderRepliesLoading,!1)},this),this.listenTo(o,"/message/unbookmarked/"+this._delegate.getId(),function(){this.feedModel.hasKeyType("bookmarks")&&this.remove()}),this.setLastSeenMessageId(a.lastSeenMessageId||0),this._initialRender=c.once(this._initialRender)},_defaultOptions:function(a){return c.defaults(a||{},{minRepliesToShow:2,maxRepliesToShow:20,unfoldRepliesToUnseen:!1,suppressMessageTruncation:!1,showGroupCallout:!1})},_initialRender:function(){this.renderTemplate(this.renderOptions),this.$el.attr("data-thread-id",this._delegate.getId()),this.$el.attr("data-qaid","thread"),this.$repliesContainer=this.$(".yj-thread-list-item--replies-container"),this.$repliesList=this.$(".yj-thread-list-item--replies"),this.$showShareSpan=this.$(".yj-thread-list-item--shares-text"),this.$showShareAltSpan=this.$(".yj-thread-list-item--shares-alt"),this.$showShareLink=this.$(".yj-thread-list-item--shares-link"),this.$showOlderLink=this.$(".yj-thread-list-item--older-replies-link").last(),this.$olderContainer=this.$showOlderLink.closest(".yj-thread-list-item--show-replies"),this.$showNewerLink=this.$(".yj-thread-list-item--newer-replies-link"),this.$newerContainer=this.$showNewerLink.closest(".yj-thread-list-item--show-replies"),this.$el.toggleClass("yj-thread-list-item-extended",this._canFollowSender(this._delegate.getThreadStarter().findSender()))},render:function(){return this._initialRender(),this.$repliesList.children().detach(),this._renderedReplyIds=[],c.chain(this._delegate.getReplies()).last(this._getInitialReplyCountToRender()).each(this._addReplyListItem,this),this._updateUnfoldNewerLink(),this._updateUnfoldOlderLink(),this._updateUnseen(),this},handleAnyAction:function(a){var b=((a||{}).currentTarget||{}).className;c.defer(this._checkMarkAsViewed.bind(this,"click",!0,b))},scrolledIn:function(a){this._scrolledInParts=this._scrolledInParts||{top:!1,bottom:!1},this._scrolledInParts[a]=!0,this._checkMarkAsViewedIfScrolledIn()},_checkMarkAsViewedIfScrolledIn:function(){this._scrolledInParts.top&&this._scrolledInParts.bottom&&this._checkMarkAsViewed("scroll")},_checkMarkAsViewed:function(a,b,c){var d=this.getNewerReplyCount();0>=d&&this._markAsViewed(a,b,c)},_markAsViewed:function(a,b,c){this._delegate.markAsViewed(a,b,c,this.feedId),this.options.isOcularSupportedFeed&&this._removeUnviewedIndicator()},_checkAndRemoveUnviewedIndicator:function(){this.thread.isViewed()&&this._removeUnviewedIndicator()},remove:function(){if(c.invoke(this.messages,"destroy"),this.messages={},this.stopListening(this._delegate),this._delegate.destroy(),this.replyForm&&this.replyForm.model){var a=this.replyForm.model.getThread();a.cleanup()}this.replyNavigator&&this.replyNavigator.stop(),this.shareNavPlaceholder&&this.shareNavPlaceholder.stop(),this.olderNavPlaceholder&&this.olderNavPlaceholder.stop(),this.newerNavPlaceholder&&this.newerNavPlaceholder.stop(),this.commands&&this.commands.stop()},_getInitialReplyCountToRender:function(){var a=this._delegate.getUnseenCount();return this.options.unfoldRepliesToUnseen&&a?Math.min(a+1,this.options.maxRepliesToShow):this.options.minRepliesToShow},_addThreadStarter:function(){var a=this._delegate.getThreadStarter();this.threadStarter=new j(a,{attachmentSettings:c.result(this.settings,"attachments"),feed:this.feedModel,showMuteAction:this._showMuteAction,navigator:this.threadNavigator,hideFollowButton:this.options.showGroupCallout,isOcularSupportedFeed:this.options.isOcularSupportedFeed,lastViewedMessageId:this.lastViewedMessageId},this),this.messages[a.id]=this.threadStarter,this.prepend(this.threadStarter)},_addGroupCallout:function(){this.options.showGroupCallout&&this.prepend(new t({model:this._delegate.getThreadStarter()}))},_addThreadTopics:function(){this.threadTopics=new p({data:{threadId:this._delegate.getId(),topics:this._delegate.getTopics()},attributes:{"data-qaid":"topics-container-section"}},this),this.append(this.threadTopics,".yj-thread-list-item--shares-topics-container"),this.listenTo(this.threadTopics,"shown hidden edit",this._updateSharesThreadContainer)},_updateSharesThreadContainer:function(a){var c=!!Math.max(b(".yj-tag",this.threadTopics.$el).length,this._delegate.getTopics().length),d=!!this._delegate.getShareCount();this.$(".yj-thread-list-item--shares-topics-container").toggleClass("is-empty",!(c||d||a)).toggleClass("is-editing",!!a)},_addReplyForm:function(){var a=this.feedModel,b=f.fromOriginalModel(c.extend(this.threadStarter.data,{getFeed:function(){return a}})),d=new f({original:b,feed:b.getFeed(),thread:b.getThread(),sender:q.getCurrentUser()});this.replyForm=new m({model:d,allowAttachments:!0,logSource:b.getFeed().getLogSource()}),this.append(this.replyForm,".yj-thread-list-item--reply-publisher")},_addReplyListItem:function(a){var b=c.sortedIndex(this._renderedReplyIds,a.id),d=this.$repliesList,e=this.messages[a.id];e||(e=new k(a,this,{attachmentSettings:c.result(this.settings,"attachments"),feed:this.feedModel,isOcularSupportedFeed:this.options.isOcularSupportedFeed,lastViewedMessageId:this.lastViewedMessageId,navigator:this.replyNavigator}),this.messages[a.id]=e,e.render()),this.options.isOcularSupportedFeed||e.toggleUnseen(this._isMessageUnseen(a)),0===b?d.prepend(e.$element):b>=this._getRenderedReplyCount()?d.append(e.$element):e.$element.insertBefore(d.children()[b]),this._renderedReplyIds.splice(b,0,a.id)},_shouldReplyBeRendered:function(a){var b=a.sender_id==q.getCurrentUser().id,c=0===this._getRenderedReplyCount()||a.id>this.getNewestRenderedReplyId();return b&&c},_handleReplyAdded:function(a){var b,d,e,f=this.getNewestRenderedReplyId();this._shouldReplyBeRendered(a)&&(b=this._delegate.getReplies(),d=c.pluck(b,"id"),e=c.indexOf(d,f),c.chain(b).rest(e+1).each(this._addReplyListItem,this)),!f||a.id>f?this._updateUnfoldNewerLink():this._updateUnfoldOlderLink()},getNewerReplyCount:function(){var a=c.pluck(this._delegate.getReplies(),"id"),b=this._renderedReplyIds,d=b[b.length-1];return 0===a.length||b.length==a.length?0:0===b.length?this._delegate.getTotalReplyCount():a.length-c.indexOf(a,d)-1},_getOlderReplyCount:function(){var a=this._getRenderedReplyCount(),b=this.getNewerReplyCount(),c=this._delegate.getTotalReplyCount();return Math.max(0,c-a-b)},_getRenderedReplyCount:function(){return this._renderedReplyIds.length},getNewestRenderedReplyId:function(){return c.last(this._renderedReplyIds)||0},_getOldestRenderedReplyId:function(){return c.first(this._renderedReplyIds)},_getOlderUnseenReplyCount:function(){var a=this._delegate.getUnseenCount()-this._renderedReplyIds.length-this.getNewerReplyCount()-1;return Math.max(a,0)},_updateUnfoldOlderLink:function(){var a,b=this._getOlderReplyCount(),c=this._getOlderUnseenReplyCount();u.treatment("tow_self_sufficient_groups_phase1")?(a=b?r.t("show_count_previous_replies",{count:b}):"",a+=b>0&&c>0?" ("+r.t("count_new",{count:c})+")":""):(a=b?r.t("show_count_older_replies",{count:b}):"",a+=b>0&&c>0?" ("+r.t("count_unread",{count:c})+")":""),this.$(".yj-thread-list-item--older-replies-text").text(a).toggle(b>0),0>=c&&y.notifyRemoval(this.$olderContainer),this.$showOlderLink.toggleClass("yj-unread",c>0).parent().toggleClass("is-unread",c>0),this.$olderContainer.toggle(b>0),this._updateShares(),this._removeNewTooltip(this.$olderContainer),c&&this._addNewTooltip(this.$olderContainer)},_updateShares:function(){var a=this._delegate.getShareCount(),b=a>0?r.t("count_shares",{count:a}):"",c=b;this.$showShareSpan.text(b),this.$showShareAltSpan.text(c),this.$showShareLink.toggle(a>0),this._updateSharesThreadContainer()},_updateUnfoldNewerLink:function(){var a=this.getNewerReplyCount(),b=a?r.t("show_count_newer_replies",{count:a}):"";this.$(".yj-thread-list-item--newer-replies-text").text(b).toggle(a>0),a||y.notifyRemoval(this.$newerContainer),this.$newerContainer.toggle(!!a),this._removeNewTooltip(this.$newerContainer),this._addNewTooltip(this.$newerContainer)},_addNewTooltip:function(a){if(!this.options.isOcularSupportedFeed){var b={target:a,text:r.t("new_2"),tooltipColor:"blue",tooltipSize:"small",targetRange:{xmax:8},orientation:"left",delay:700,cursor:"help",showOnFocus:!1};delete b.cursor,o.trigger("/ui/tooltip/add",b)}},_removeNewTooltip:function(a){this.options.isOcularSupportedFeed||o.trigger("/ui/tooltip/remove",{target:a})},showOlderReplies:function(){this._delegate.hasOlderAvailable()?this._delegate.fetchOlder({success:this._handleFetchOlderSuccess.bind(this)}):this._handleFetchOlderSuccess()},_handleTranslated:function(a){c.each(a,this._addReplyListItem,this),this._updateUnfoldOlderLink()},_handleFetchOlderSuccess:function(){var a=this._delegate.getReplies(),b=c.pluck(a,"id"),d=this._getOldestRenderedReplyId(),e=c.indexOf(b,d);a=c.chain(a).first(e).last(this.options.maxRepliesToShow).value(),this._translateReplies(a).then(this._handleTranslated.bind(this,a)),this._delegate.markAsRead()},showNewerReplies:function(){var a=this._delegate.getReplies(),b=c.pluck(a,"id"),d=this.getNewestRenderedReplyId(),e=c.indexOf(b,d);c.chain(this._delegate.getReplies()).rest(e+1).each(this._addReplyListItem,this),this._updateUnfoldNewerLink(),this._delegate.markAsRead()},_setOlderRepliesLoading:function(a){a=a!==!1,this.$showOlderLink.toggleClass("is-loading",a)},_handleReplySubmitted:function(){this._delegate.markAsRead()},handleMuteThread:function(){this._muted=!0,this.$el.addClass("yj-thread-item-muted is-muted").append(e.to_html(this.mutedTemplate,{message:r.t("this_message_will_no_longer_appear_unless_someone_mentions_or"),undo:r.t("undo")}))},handleUndoMute:function(){s.unmuteThread({thread_id:this._delegate.getId()}).then(this.unmute.bind(this))},unmute:function(){this.$el.removeClass("yj-thread-item-muted is-muted").find(".yj-thread-list-item--muted-message").remove(),this.$(".yj-close").hide(),this._muted=!1},_handleThreadUpdate:function(a){var b;this.threadTopics&&(b=this.threadTopics.updateTopics(a.getTopics()),b&&this.threadTopics.show())},handleAddTopic:function(){var a=this;if(this.threadTopics.showEditForm(),this.threadTopics.isEditing){var c=function(){setTimeout(function(){a.threadTopics.$search.focus()},20),b(document).unbind("click.ClickMenu")};b(document).bind("click.ClickMenu",c),u.treatment("keyboardshortcuts2")&&(b(".yj-click-menu:visible")[0]||c())}},refreshView:function(){this.empty(),this._addThreadStarter(),this._addReplyForm(),this._addThreadTopics(),this._delegate.clearRepliesCache(),this.render()},handleDeleteMessage:function(a){if(a.stopPropagation&&a.stopPropagation(),a.isThreadStarter)this._delegate.doesThreadExist()?this.refreshView():(this.$el.removeClass("yj-thread-list-item"),this.$el.trigger({type:"deleteThread",thread:this}));else{var b=a.message;delete this.messages[b.data.id],b.fadeAndDestroy()}},showThreadShares:function(){g.openComponent(new i({thread_id:this._delegate.getId()}),"yj-share-lightbox",void 0,{title:r.t("this_conversation_has_been_shared_count_times",{count:this._delegate.getShareCount()}),overlayClose:!0,scrolling:!1})},getChildComponentsWithTimestamps:function(){return this.messages},_canFollowSender:function(a){return a.id!=q.getCurrentUser().id&&"suspended"!==a.state&&"deleted"!==a.state},setRenderOptions:function(a){this.renderOptions=a,this.applyRenderOptions()},applyRenderOptions:function(){if(!this.options.isOcularSupportedFeed){var a=this.renderOptions||{};this.$el.toggleClass("yj-first-message",a.first).toggleClass("yj-last-unseen is-last-unseen",a.lastUnseen).toggleClass("yj-after-unseen is-after-unseen",a.firstSeen).toggleClass("is-last-thread",a.lastThreadIndex),this.checkAddReadLine()}},_checkAndAddUnviewedIndicator:function(){var a=this.feedModel.isGroup()||this.feedModel.isAllCompany();a&&!this.thread.isViewed()&&this.$el.addClass("is-unviewed").removeClass("was-unviewed")},_removeUnviewedIndicator:function(){this.$el.hasClass("is-unviewed")&&this.$el.removeClass("is-unviewed").addClass("was-unviewed")},checkAddReadLine:function(){this.renderOptions.firstSeen?(this.$readLine||(this.$readLine=n.buildUnseenLine()),this.$el.prepend(this.$readLine)):this.$readLine&&this.$readLine.remove()},handleOpenReplyForm:function(a){var b=this.feedModel,d=a.message||this.threadStarter;d=f.fromOriginalModel(c.extend(d.data,{getFeed:function(){return b}})),this.replyForm.replyTo(d)},_translateReplies:function(a){var c=b.Deferred();return this._delegate.getThreadStarter().isTranslated()?h.translateMessages(a).always(function(){c.resolve()}):c.resolve(),c},_updateItemUnseen:function(a){var b=a.getMessage(),c=this._isMessageUnseen(b);a.toggleUnseen(c)},_updateUnseen:function(){this._updateItemUnseen(this.threadStarter),c.each(this.replies,this._updateItemUnseen,this)},setLastSeenMessageId:function(a){this._lastSeenMessageId=a},_isMessageUnseen:function(a){return this.options.isOcularSupportedFeed?a.id>this.lastViewedMessageId:a.id>this._lastSeenMessageId},getThreadListItem:function(){return this},getMessageListItem:function(a){return this.messages[a]},getId:function(){return this.cid},_initializeNavigation:function(){this.options.threadNavigator&&(this.threadNavigator=this.options.threadNavigator,this.replyNavigator=new v({parent:this.threadNavigator,model:this.thread}),this.listenTo(this.replyNavigator,"getCandidates",this._getReplyNavigationCandidates))},_getReplyNavigationCandidates:function(){var a=this._delegate.getReplies(),b=c.map(this._renderedReplyIds,function(b){return c.findWhere(a,{id:b})}),d=[];this._delegate.getShareCount()&&(this.shareNavPlaceholder||(this.shareNavPlaceholder=new x({navigator:this.replyNavigator,rootElement:this.$(".yj-thread-list-item--shares-topics-container"),focusTarget:this.$showShareLink})),d.push(this.shareNavPlaceholder)),this._getOlderReplyCount()&&(this.olderNavPlaceholder||(this.olderNavPlaceholder=new x({navigator:this.replyNavigator,rootElement:this.$olderContainer,focusTarget:this.$showOlderLink})),d.push(this.olderNavPlaceholder)),d=d.concat(b),this.getNewerReplyCount()&&(this.newerNavPlaceholder||(this.newerNavPlaceholder=new x({navigator:this.replyNavigator,rootElement:this.$newerContainer,focusTarget:this.$showNewerLink})),d.push(this.newerNavPlaceholder)),this.replyNavigator.set("candidates",d)}})}),define("feeds/lib/helper/threads_helper",["require","jquery","underscore"],function(a){var b=a("jquery"),c=a("underscore");return{observeThreadDomEvents:function(){var a=this.$el||this.$element;a.bind("click."+this.getId(),c.bind(function(a){var c,d,e=b(a.target);e.parents("[data-thread-id]:first").length&&(c=e.parents("[data-thread-id]:first").attr("data-thread-id"),e.hasClass("yj-show-thread-shares")||e.parent().hasClass("yj-show-thread-shares")?d="showThreadShares":e.hasClass("yj-show-older-replies")||e.parent().hasClass("yj-show-older-replies")?d="showOlderReplies":(e.hasClass("yj-show-newer-replies")||e.parent().hasClass("yj-show-newer-replies"))&&(d="showNewerReplies"),void 0!==d&&this.getThreadListItem(c)[d]())},this))}}}),define("feeds/lib/ui/threads/future/thread_list_commands",["require","core/lib/backbone_base_class","common-ui/lib/ui/keyboard/keyboard_shortcuts"],function(a){var b=a("core/lib/backbone_base_class"),c=a("common-ui/lib/ui/keyboard/keyboard_shortcuts"),d={noNextItem:"No next item.",noPrevItem:"No previous item.",noItems:"No items."};return b.extend({initialize:function(){this.listenTo(c,"nav_next",this._navNextThread),this.listenTo(c,"nav_prev",this._navPrevThread)},stop:function(){this.stopListening()},_navNextThread:function(){this.options.navigator.navNext({errorStrings:d})},_navPrevThread:function(){this.options.navigator.navPrev({errorStrings:d})}})}),define("feeds/lib/ui/threads/future/thread_detail",["require","jquery","underscore","core/lib/backbone_legacy_integration","models/lib/helper/message/message_action_mixin","components/suite_nav/src/suite_nav","feeds/lib/ui/threads/future/thread_list_item","feeds/lib/helper/threads_helper","core/lib/treatment","common-ui/lib/ui/keyboard/linear_navigator","feeds/lib/ui/threads/future/thread_list_commands","common-ui/lib/helper/ui"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_legacy_integration"),e=a("models/lib/helper/message/message_action_mixin"),f=a("components/suite_nav/src/suite_nav"),g=a("feeds/lib/ui/threads/future/thread_list_item"),h=a("feeds/lib/helper/threads_helper"),i=a("core/lib/treatment"),j=a("common-ui/lib/ui/keyboard/linear_navigator"),k=a("feeds/lib/ui/threads/future/thread_list_commands"),l=a("common-ui/lib/helper/ui");return d.extend({tagName:"div",className:"yj-thread-detail",initialize:function(a){this.options=c.extend({},this.options,a),this.thread=this.options.thread,this.feed=this.options.feed,this.threadListItemSettings=this.options.threadListItemSettings,this.minRepliesToShow=this.options.minRepliesToShow,i.treatment("keyboardshortcuts2")&&(this.threadNavigator=new j),this._addThreadListItem(this.thread,this.feed),i.treatment("keyboardshortcuts2")&&(this.listenTo(this.threadNavigator,"getCandidates",this._getThreadNavigationCandidates),this.commands=new k({navigator:this.threadNavigator})),c.extend(this,e,h),this.observeMessageDomEvents(),this.observeThreadDomEvents()},_getThreadNavigationCandidates:function(){var a=[this.thread];this.threadNavigator.set("candidates",a)},render:function(){if(this.options.logReadToggleOrigin){var a={source:"inbox_conversation_view"},d=yam.router.getPreviousRoute();d&&(a.from_feed=d),this.thread.markAsRead({log_data:a})}else this.thread.markAsRead();return this.thread.markAsViewed({immediate:!0,log:{feed_type:this.feed.getLogSource(),action_type:"open",action_info:"view_conversation",feed_id:this.feed.getGroupId(),thread_state:this.thread.viewedState.getState()}}),b.browser.safari&&f.exists()&&c.defer(l.forceBrowserRepaint),this},remove:function(){this.threadNavigator&&this.threadNavigator.stop(),this.commands&&this.commands.stop()},_addThreadListItem:function(a,b){var c=g.prototype.className;c+=" yj-conversation-detail is-detail-view",this._threadListItem=new g({tagName:"div",className:c,thread:a,feed:b,lastSeenMessageId:b.getLocalLastSeenMessageId(),minRepliesToShow:this.minRepliesToShow,unfoldRepliesToUnseen:!0,settings:this.threadListItemSettings,suppressMessageTruncation:!0,showGroupCallout:this._shouldShowGroupCallout(),showMuteAction:!1,threadNavigator:this.threadNavigator}),this.append(this._threadListItem)},getId:function(){return this._threadListItem.getId()},getThreadListItem:function(){return this._threadListItem},getMessageListItem:function(a){return this._threadListItem.getMessageListItem(a)},_shouldShowGroupCallout:function(){var a=this.thread.getThreadStarter().isDirectMessage();return!a}})}),define("stache!feeds/lib/ui/attachments/attachment_viewer",["mustache"],function(a){var b='<div>\n  <div class="yj-attachment-viewer--overlay yj-attachment-viewer-overlay"></div>\n  <div class="yj-attachment-viewer--content yj-attachment">\n    <div class="yj-attachment-viewer--arrows yj-content-lightbox-arrows">\n      <a role="button" href="javascript://" class="yj-attachment-viewer--previous yj-previous content-lightbox-left-arrow-icon" title="{{previous}}" data-speechtip>\n        <div class="yj-click-area">\n          <span class="yj-acc-hidden">{{previousItem}}</span>\n        </div>\n      </a>\n      <a role="button" href="javascript://" class="yj-attachment-viewer--next yj-next content-lightbox-right-arrow-icon" title="{{next}}" data-speechtip>\n        <div class="yj-click-area">\n          <span class="yj-acc-hidden">{{nextItem}}</span>\n        </div>\n      </a>\n    </div>\n  </div>\n  <div class="yj-attachment-viewer--conversation"></div>\n  <a role="button" href="javascript://" class="yj-attachment-viewer--close-button yj-close-button yamicon-x yamicon" data-speechtip>\n    <span class="yj-acc-hidden">{{close}}</span>\n  </a>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/attachments/attachment_viewer",["require","jquery","underscore","backbone","feeds/lib/ui/attachments/attachment_viewer_file","feeds/lib/ui/attachments/attachment_viewer_image","feeds/lib/ui/attachments/attachment_viewer_toolbar","feeds/lib/ui/attachments/attachment_viewer_video","core/lib/jam/component2","feeds/lib/ui/publisher/global/publisher_errors","feeds/lib/modules/video_encoding_progress","core/lib/ctor","feeds/lib/ui/threads/future/thread_detail","feeds/lib/ui/util/title_updater","core/lib/tr","core/lib/uri_helper","models/attachment","models/thread","core/lib/location_helper","models/helpers/attachment","html!./attachment_viewer"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("feeds/lib/ui/attachments/attachment_viewer_file"),f=a("feeds/lib/ui/attachments/attachment_viewer_image"),g=a("feeds/lib/ui/attachments/attachment_viewer_toolbar"),h=a("feeds/lib/ui/attachments/attachment_viewer_video"),i=a("core/lib/jam/component2"),j=a("feeds/lib/ui/publisher/global/publisher_errors"),k=a("feeds/lib/modules/video_encoding_progress"),l=a("core/lib/ctor"),m=a("feeds/lib/ui/threads/future/thread_detail"),n=a("feeds/lib/ui/util/title_updater"),o=a("core/lib/tr"),p=a("core/lib/uri_helper"),q=a("models/attachment"),r=a("models/thread"),s=a("core/lib/location_helper"),t=a("models/helpers/attachment");return l("yam.ui.attachments.AttachmentViewer",i,{cssClass:"yj-attachment-viewer",template:a("html!./attachment_viewer"),events:{click:"_onClick","click .yj-attachment-viewer--previous":"_previousAttachment","click .yj-attachment-viewer--next":"_nextAttachment","click .yj-attachment-viewer--close-button":"_closeViewer","click .yj-attachment-viewer--conversation a":"_onThreadLinkClick","click .yj-attachment-image img":"_nextAttachment"},_routeName:"fancy-lightbox",_reEnableDocumentScrolling:function(){b("html").removeClass("no-scroll")},onLoad:function(){this._listener=c.extend({},d.Events),this._bindContexts(),this._registerOriginalRoute(),this.loadAttachment(this.attachmentId,this.threadId),this._checkPublisherContentsBeforeFeedRouteChange(),this._destroyOnFeedRouteChange(),b("body").on("keydown",this._onKeydown),b("html").addClass("no-hovercards"),this._disableDocumentScrolling()},_disableDocumentScrolling:function(){var a=b(document).scrollTop();b("html").addClass("no-scroll"),b(document).scrollTop(a)},_bindContexts:function(){c.bindAll(this,"_closeViewer","_forceClose","_isAttachmentSupported","_onKeydown","_onBeforeFeedRouteChange","_onFeedRouteChange","_onClick","_onEdit","_onThreadLoad","_setThreadDetailHeight","_showThreadReplies")},onTemplating:function(a){return a.model.attachments=this.attachments,c.extend(a.model,{previous:o.t("previous"),previousItem:o.t("previous_item"),next:o.t("next"),nextItem:o.t("next_item"),close:o.t("close")}),a},loadAttachment:function(a,b){var d,e,f;if(this._attachments&&(e=c.find(this._attachments,function(b){return b.id===a}),d=c.indexOf(this._attachments,e)),d>-1)this.setAttachmentIndex(d);else{if(this.attachment=q.findById(a),b&&(this.thread=r.findById(b)),!this.attachment)return this.fail("Cannot find attachment#"+this.attachmentId);this.thread||(f=t.getMessages(this.attachment),f.length&&(this.thread=f[0].getThread())),this.updateAttachment(this.attachment),this.thread&&(this.feedModel=this._getFeedModel(),this.feedModel?this._fillThreadGaps({success:this._onThreadLoad,error:this._onThreadError}):delete this.thread)}},_getFeedModel:function(){var a;return this.thread.isFullThread()&&(a=this.thread.getAnyFeed()),a},_getThreadId:function(){return this.thread&&this.thread.id},_isThreadForeign:function(){return this.thread&&this.thread.isForeign()},_fillThreadGaps:function(a){var b=this.thread,c=this.feedModel,d=-1;!function e(){var f=b.getMessages(),g=d!=f.length,h={};return f.length>1&&(h.older_than=b.oldestReply().id),b.repliesMissing()?g?(c.fetchThread(b.id,h).then(e,a.error),void(d=f.length)):(b.server_updates=f.length-1,a.success()):a.success()}()},_getFocusedElement:function(){return window.document.activeElement},_onKeydown:function(a){var b=this._getFocusedElement();if("TEXTAREA"!=b.tagName&&!this._isEditing())switch(a.which){case 37:case 38:this._previousAttachment();break;case 39:case 40:this._nextAttachment();break;case 27:this._closeViewer()}},_onThreadLoad:function(){this._attachments=this._flattenSupportedAttachments(),this.addFutureThreadDetail(),this._attachmentIndex=c.chain(this._attachments).pluck("id").indexOf(this.attachmentId).value()||0,this.setAttachmentIndex(this._attachmentIndex)},_flattenSupportedAttachments:function(){return c.reduce(this.thread.getMessages(),function(a,b){return a.concat(c.filter(b.attachments,this._isAttachmentSupported))},[],this)},_isAttachmentSupported:function(a){return null!=this.getContentViewerClass(a)},_onThreadError:function(a){yam.log.warn("AttachmentViewer error loading thread",a)},_onEdit:function(a,b){var c=this._attachments[this._attachmentIndex],d=b&&b.sendTime,e=p.replaceParam(c.edit_url,"sendTime",d);this.attachmentView.replaceContent(e),this.attachmentView.render(),this.$el.addClass("yj-attachment-viewer-edit is-editing"),this._editing=!0},_isUsingRouting:function(){return this._usingRouting=this._usingRouting||yam.router,this._usingRouting},_isEditing:function(){return this._editing},_navigateToFeed:function(){this._isUsingRouting()&&this._originalFragment&&yam.router.navigate(this._originalFragment)},_onBeforeFeedRouteChange:function(a){this._publisherIsOpenAndContainsText()&&!j.showUnsavedWarningDialog()&&a.preventRouteChange()},_checkPublisherContentsBeforeFeedRouteChange:function(){this._isUsingRouting()&&yam.router.on("before-route",this._onBeforeFeedRouteChange)},_registerOriginalRoute:function(){this._isUsingRouting()&&(this._originalFragment=d.history.fragment)},_onFeedRouteChange:function(){this.destroy()},_destroyOnFeedRouteChange:function(){this._isUsingRouting()&&yam.router.on("route",this._onFeedRouteChange)},_stopListeningToFeedRouteChanges:function(){this._isUsingRouting()&&(yam.router.off("before-route",this._onBeforeFeedRouteChange),yam.router.off("route",this._onFeedRouteChange))},_onThreadLinkClick:function(a){var d,e=b(a.target),f=c.pluck(this._attachments,"id");"A"!=e.prop("tagName")&&(e=e.parents("a")),d=e.data("attachment-id"),d?(a.preventDefault(),this.setAttachmentIndex(c.indexOf(f,d))):e.hasClass("yj-message-list-item--time")&&(a.preventDefault(),this.destroy(),s.assign(e.attr("href")))},onAttach:function(){this.threadDetail&&this._setupThreadDetail(),this.setAttachmentIndex(this._attachmentIndex),this.attached=!0,b('[role="dialog"]').attr("aria-describedby","yj-attachment-name")},_onClick:function(a){var c=b(a.target);this._isEditing()||!c.hasClass("yj-attachment")&&!c.hasClass("yj-attachment-viewer-overlay")||this._closeViewer()},onDestroy:function(){this._listener&&this._listener.stopListening(),this._stopListeningToFeedRouteChanges(),b("body").off("keydown",this._onKeydown),b("html").removeClass("no-hovercards"),this._reEnableDocumentScrolling()},onRendered:function(){this.thread||this.$el.addClass("yj-no-thread"),this.updateNavigation()},scrollToLastReply:function(){var a=this.$el.find(".yj-thread-list-item .yj-thread-reply-list-item:last-child")[0];a&&a.scrollIntoView()},addFutureThreadDetail:function(){if(!this.threadDetail){var a=new m({feed:this.feedModel,thread:this.thread,minRepliesToShow:this.thread.getReplies().length,threadListItemSettings:{attachments:{hideAttachments:function(a){return"ymodule"!==a.type||t.isNote(a)?!1:!(!c.isUndefined(a.ymodule)&&"page"!==a.object_type)},showSimpleAttachments:function(a){return t.isFile(a)||t.isImage(a)||t.isNote(a)},hideActionsThatOpenModals:!0},editor:{typeaheadPosition:"below-publisher",maxResults:2},inReplyToTooltipSettings:{align:"right"}}});a.suppressMessageTruncation=!1,a.attachPoint=".yj-attachment-viewer--conversation",this.add("threadDetail",a),this.attached&&this._setupThreadDetail()}},_setThreadDetailHeight:function(){var a=this._getThreadDetailElement(),b=a.parent().height(),c=a.height(),d=this._getReplyForm().$el.outerHeight();if(b){var e=b-d;e!==c&&a.height(e)}},_getThreadDetailElement:function(){return this.threadDetail.getThreadListItem().$el},_getReplyForm:function(){return this.threadDetail.getThreadListItem().replyForm},_setupThreadDetail:function(){var a=this._getThreadDetailElement(),b=this,c=this._getReplyForm();a.get(0).scrollHeight>a.get(0).parentNode.offsetHeight&&(c.$el.addClass("yj-fixed-publisher"),c.$el.appendTo(a.parent()),this._setThreadDetailHeight(),this._listenForResizes()),this._listener.listenTo(this.feedModel,"onAfterProcess",function(){b.scrollToLastReply()}),this._getReplyForm().on("submitted",this._showThreadReplies)},_showThreadReplies:function(){this.thread&&b(".page-content [data-thread-id="+this._getThreadId()+"] .yj-thread-replies-container").show()},_listenForResizes:function(){d.on("/ui/lightbox/resize",this._setThreadDetailHeight)},_stopListeningForResizes:function(){d.off("/ui/lightbox/resize",this._setThreadDetailHeight)},setAttachmentIndex:function(a){var b,c=this._attachments;c&&(a>=c.length?a=0:0>a&&(a=c.length-1),b=c[a],this.$el&&b&&(this.updateAttachment(b),this._attachmentIndex=a))},getContentViewerClass:function(a){return a=a||{},a.image?f:a.file||a.ymodule&&"page"==a.real_type||"page"===a.type?a.transcoded||a.status===k.EncodingStatus.ENCODED?h:e:void this.log("unsupported attachment",a)},updateAttachment:function(a){var b,c=this.getContentViewerClass(a),d=q.findById(a.id);c&&(d&&(a=d,b=t.getMessages(a),a.message_id=b.length?b[0].id:null),this.attachment=a,this.attachmentId=a.id,this.updateToolbar(a),this.updateThreadDetail(a),this.updateUrl(a),this.updatePageTitle(a),this.attachmentView?this.attachmentView.model.id!=a.id&&this.replace(this.attachmentView,this._createAttachmentView(c,a)):this.add("attachmentView",this._createAttachmentView(c,a)),this.updateNavigation(a))},_createAttachmentView:function(a,b){var c=new a({model:b,attachPoint:".yj-attachment-viewer--content"});return c.on("closeViewer",this._closeViewer),c.on("edit",this._onEdit),c},updateToolbar:function(a){var b;a.sequence=c.chain(this._attachments).pluck("id").indexOf(a.id).value()+1,a.sequence_total=this._attachments?c.size(this._attachments):null,b=new g({model:a}),this.toolbar?this.replace(this.toolbar,b):this.add("toolbar",b),this.toolbar.on("edit",this._onEdit),this.toolbar.on("forceClose",this._forceClose)},updateThreadDetail:function(a){var b,d,e,f;this.threadDetail&&a&&(f=t.getMessages(a),e=f.length?f[0].id:null,this._lastSelectedMessageId=a.message_id,d=this._getThreadDetailElement(),b=d.find("[data-message-id="+e+"]"),b.length&&c.defer(c.bind(function(){d.stop(!0,!0).animate({scrollTop:~~b.position().top+d.scrollTop()})},this)))},updateNavigation:function(){var a=this._attachments&&this._attachments.length>1;this.$el&&(this.$el.find(".yj-attachment-viewer--previous")[a?"show":"hide"](),this.$el.find(".yj-attachment-viewer--next")[a?"show":"hide"]())},_getTitleForAttachment:function(a){return a.image||a.file?a.full_name||a.name:a.name},updatePageTitle:function(a){this._originalTitle=this._originalTitle||n.title,n.setTitle(this._getTitleForAttachment(a))},updateUrl:function(a){this._isUsingRouting()&&yam.router.navigate(this._getFragment(a),{replace:!0})},_getFragment:function(a){var b=t.isNote(a),c=a.real_id,d="/"+(b?"notes":"uploaded_files")+"/"+(b&&c?c:a.id),e=[],f=this._getThreadId();return f&&e.push("threadId="+f),this._isThreadForeign()&&e.push("isForeign=true"),e.length&&(d+="?"+e.join("&")),d},_nextAttachment:function(){this._attachments&&1!=this._attachments.length&&this.setAttachmentIndex(this._attachmentIndex+1)},_previousAttachment:function(){
this._attachments&&1!=this._attachments.length&&this.setAttachmentIndex(this._attachmentIndex-1)},_publisherIsOpenAndContainsText:function(){var a;return this.threadDetail?(a=this._getReplyForm(),!a.isResettable()):!1},_closeViewer:function(){return b("#yj-colorbox").is(":visible")?!1:this._publisherIsOpenAndContainsText()&&!j.showUnsavedWarningDialog()?!1:(this._forceClose(),!1)},_forceClose:function(){n.setTitle(this._originalTitle),this._navigateToFeed(),this._stopListeningForResizes(),this.destroy()}})}),define("feeds/lib/ui/attachments/simple_attachment_viewer",["require","jquery","feeds/lib/ui/attachments/attachment_viewer","core/lib/ctor"],function(a){var b=a("jquery"),c=a("feeds/lib/ui/attachments/attachment_viewer"),d=a("core/lib/ctor");return d(null,c,{onLoad:function(){this._bindContexts(),this.attachment&&(this.updateAttachment(this.attachment),this._destroyOnFeedRouteChange(),b("body").on("keydown",this._onKeydown),this._disableDocumentScrolling())}})}),define("feeds/lib/ui/attachments/attachment_viewer_factory",["require","feeds/lib/ui/attachments/attachment_viewer","feeds/lib/ui/attachments/simple_attachment_viewer","core/lib/namespace","models/helpers/attachment","models/attachment","models/thread"],function(a){var b=a("feeds/lib/ui/attachments/attachment_viewer"),c=a("feeds/lib/ui/attachments/simple_attachment_viewer"),d=a("core/lib/namespace"),e=a("models/helpers/attachment");return a("models/attachment"),a("models/thread"),d.ns("yam.ui.attachments"),yam.ui.attachments.AttachmentViewer.factory=function(a){if(!a.attachment&&a.attachmentId&&(a.attachment=yam.model.Attachment.findById(a.attachmentId)),!a.thread&&a.threadId&&(a.thread=yam.model.Thread.findById(a.threadId)),a.attachment)return a.simple||!a.thread&&!e.getMessages(a.attachment).length?new c(a):new b(a);if("uploaded_file"===a.type||"page"===a.type)return a.attachment=a.instance,new c(a);throw new Error("Attachment not found for AttachmentViewer.factory")}}),define("feeds/lib/ui/attachments/fancy_lightbox_manager",["require","jquery","core/lib/ctor","backbone","feeds/lib/ui/attachments/attachment_viewer_factory","common-ui/lib/ui/shared/modal"],function(a){var b=a("jquery"),c=a("core/lib/ctor"),d=a("backbone");a("feeds/lib/ui/attachments/attachment_viewer_factory");var e=a("common-ui/lib/ui/shared/modal");return c("yam.ui.attachments.FancyLightboxManager",{init:function(){d.on("/ui/fancy-lightbox/open",this._openFancyLightbox,this)},destroy:function(){d.off("/ui/fancy-lightbox/open",this._openFancyLightbox,this)},_openFancyLightbox:function(a){var c,f;this._currentFancyLightbox?this._currentFancyLightbox.loadAttachment(a.attachmentId,a.threadId):(c=yam.ui.attachments.AttachmentViewer.factory(a),f=new e({component:c}),b("body").append(f.$el),f.render(),d.trigger("/ui/fancy-lightbox/opened"),this._currentFancyLightbox=c,f.on("destroy",this._onFancyLightboxDestroyed.bind(this))),b("html").addClass("yj-fancy-lightbox")},_onFancyLightboxDestroyed:function(){this._currentFancyLightbox=void 0,b("html").removeClass("yj-fancy-lightbox")}})}),define("workfeed/lib/app/add_enhanced_tooltip",["require","jquery","core/lib/namespace","backbone"],function(a){var b=a("jquery"),c=a("core/lib/namespace"),d=a("backbone");return c.ns("yam.workfeed"),yam.workfeed.addEnhancedTooltips=function(a){var c=".yj-enhanced-tooltip",e=a?b(a).find(c):b(c);e.each(function(){var a,c=b(this),e=c.attr("position"),f={orientation:e,validHTML:!0};c.attr("tooltip-content-id")?a=b("#"+c.attr("tooltip-content-id")).html():(a=c.attr("title"),c.attr("title","")),c.attr("tooltip-stay-visible")&&(f.delay=200,f.stayVisible=!0),c.hasClass("sidebar-thumb")&&(f.delay=0,f.fadeTime=0,f.tooltipSize="small"),f.target=c,f.text=a,d.trigger("/ui/tooltip/add",f)})},yam.workfeed.addEnhancedTooltips}),define("workfeed/lib/modules/link_to_helper",["require","jquery","core/lib/util/authenticity_token","core/lib/ctor","mustache"],function(a){var b=a("jquery"),c=a("core/lib/util/authenticity_token"),d=a("core/lib/ctor"),e=a("mustache");return d("yam.workfeed.LinkToHelper",{init:function(){b(document).on("click","a[data-method]",function(a){a.preventDefault();var d=b(a.target).closest("a"),f=d.attr("href"),g=d.attr("data-method"),h='            <form method="POST" action="{{action}}" style="display:none;">              <input type="hidden" name="authenticity_token" value="{{token}}" />              <input type="hidden" name="_method" value="{{method}}" />            </form>';h=e.render(h,{action:f,method:g,token:c.get()}),b(h).appendTo(d.parent()).submit()})}})}),define("workfeed/lib/init_ui",["require","jquery","underscore","collections/group_memberships","collections/groups","core/lib/namespace","backbone","core/lib/session","core/lib/string_helper","core/lib/tr","core/lib/yammer_request","core/lib/yammer_api","common-ui/lib/helper/environment","models/helpers/user","jquery-watermark"],function(a){var b=a("jquery"),c=a("underscore"),d=a("collections/group_memberships"),e=a("collections/groups"),f=a("core/lib/namespace"),g=a("backbone"),h=a("core/lib/session"),i=a("core/lib/string_helper"),j=a("core/lib/tr"),k=a("core/lib/yammer_request"),l=a("core/lib/yammer_api"),m=a("common-ui/lib/helper/environment"),n=a("models/helpers/user");a("jquery-watermark");var o={init:function(){b(document).on("click",".join-links-container .join-group",o.joinGroup),b(document).on("click",".join-links-container .join-private-group",o.joinPrivateGroup),b(document).on("click",".join-links-container .leave",o.leaveGroup)},_doJoinGroup:function(a){var b=c.pick(a,"group_id","bfr_source","bfr_section","bfr_event");l.joinGroup(b).then(function(){var b,f=a.group_id,g={user_id:h.getCurrentUser().id,group_id:f};d.add(g);var i=e.get(f);i&&(b=i.get("full_name")),c.isFunction(a.success)&&a.success(b)},function(){g.trigger("/ui/alert/show","error",j.t("there_was_an_error_joining_this_group"))})},joinGroup:function(){var a=b(this),c=parseInt(a.data("group-id"),10),d=a.data("source"),e=a.data("section"),f="group_joined",h=b("#leave_group_"+c+"_link");return b("#join_group_"+c+", #leave_group_"+c).toggle(),h.addClass("yj-click-transition").mouseleave(function(){h.removeClass("yj-click-transition")}),o._doJoinGroup({group_id:c,bfr_source:d,bfr_section:e,bfr_event:f,success:function(a){a=a||"",g.trigger("/ui/alert/show","notice",j.t("you_have_joined_the_name_group",{name:a}))}}),b(".join-links-inline-header").show(),!1},joinPrivateGroup:function(){var a=b(this),c=a.data("group-id"),d=i.convertStringyBoolean(a.data("is-global-admin"));return d?b("#join_group_"+c+", #leave_group_"+c).toggle():b("#join_group_"+c+", #pending_group_"+c).toggle(),o._doJoinGroup({group_id:c,success:function(){g.trigger("/ui/alert/show","notice",j.t("you_have_requested_to_join_this_group"))}}),!1},leaveGroup:function(){var a=b(this),c=a.data("confirm-message"),e=parseInt(a.data("group-id"),10),f=a.data("source"),i="group_left";return window.confirm(c)&&(b("#join_group_"+e+", #leave_group_"+e).toggle(),l.leaveGroup({group_id:e,bfr_source:f,bfr_section:f,bfr_event:i}).then(function(){var a={user_id:h.getCurrentUser().id,group_id:e};g.trigger("/ui/alert/show","notice",j.t("you_have_left_this_group"));var c=d.findWhere(a);c&&c.destroy();var f=b(".yj-mugshot-form-group");f.length&&(f.find("input").remove(),f.find(".yj-mugshot-hover-div").remove(),f.unbind("mouseenter mouseleave"));var i=b(".yj-group-header-facepile-container .members-count"),k=parseInt(i,10);!isNaN(k)&&k>0&&i.text(k-1);var l=b(".yj-group-description");l.length&&l.hasClass("yj-inline-edit")&&(l.find("a").remove(),l.removeClass("yj-inline-edit")),b(".join-links-inline-header").hide()},function(){g.trigger("/ui/alert/show","error",j.t("there_was_an_error_leaving_this_group"))})),!1}},p={init:function(){var a=this;b(".follow-links-container .follow").click(this.follow.bind(this)),b(".follow-links-container .unfollow").click(this.unfollow.bind(this)),b(".follow-links-container .follow, .follow-links-container .unfollow").each(function(){var c=b(this).data("target-type").toLowerCase(),d=n.getFollowing(h.getCurrentUser(),c);d.on("add",a.onFollow,a),d.on("remove",a.onUnfollow,a)})},follow:function(a){var c=b(a.target),d=c.hasClass("toggle-action-button")?c:c.closest(".toggle-action-button"),e=parseInt(d.attr("data-target-id"),10),f=d.attr("data-target-type"),i=d.attr("data-permalink");k.send({url:"/"+i+"/subscribe?norjs=true&target_id="+e+"&target_type="+f,type:"post",success:function(a){g.trigger("/ui/alert/show","notice",a.notice)},error:function(a){var b=JSON.parse(a.responseText),c=b.error;c&&g.trigger("/ui/alert/show","error",c)}}),n.follow(h.getCurrentUser(),f.toLowerCase(),e);var j=b(".follow-unfollow-"+e+" .yj-btn-alt");j.addClass("yj-click-transition").mouseleave(function(){j.removeClass("yj-click-transition")})},unfollow:function(a){var c=b(a.target),d=c.hasClass("toggle-action-button")?c:c.closest(".toggle-action-button"),e=d.attr("data-permalink"),f=parseInt(d.attr("data-target-id")),g=d.attr("data-target-type");k.send({url:"/"+e+"/subscriptions?norjs=true&target_id="+f+"&target_type="+g,type:"delete"}),n.unfollow(h.getCurrentUser(),g.toLowerCase(),f)},onFollow:function(a){this.updateButtonState(a.id)},onUnfollow:function(a){this.updateButtonState(a.id,!0)},updateButtonState:function(a,c){b(".follow-unfollow-"+a).hide(),c?b(".follow-unfollow-"+a+".follow").show():b(".follow-unfollow-"+a+".unfollow").show()}},q=function(){g.trigger("/ui/hovercard/build",b("body"),".yj-hovercard-link")};return f.ns("yam.workfeed.actionButtonHelper",{init:function(){b(function(a){setTimeout(function(){q(),o.init(),p.init(),a(".water-marked").each(function(){a(this).watermark(a(this).attr("title"))}),m.isOlderIE()&&a("input:radio").click(function(){this.blur(),this.focus()})},0)})}}),yam.workfeed.actionButtonHelper}),define("common-ui/lib/ui/accessibility/focuswithin",["require","jquery","underscore"],function(a){var b,c=a("jquery"),d=a("underscore"),e=c(),f=document.body,g=function(a){return c(a).parents().addBack().filter(".yj-want-focuswithin")},h=function(a,b){a.each(function(){c(this).triggerHandler(b)})},i=function(a){if(a&&a.reset)return c(f).off(".yj-acc-focuswithin"),void(e=c());var i;c(f).on("mousedown.yj-acc-focuswithin",function(a){i=g(a.target)}),c(f).on("mouseup.yj-acc-focuswithin",function(){i=void 0}),c(f).on("focusin.yj-acc-focuswithin",function(a){var c=g(a.target);if(!c.is(i)){b=!0;var d=e.not(c);d.removeClass("yj-focuswithin"),h(d,"yj-focusleave");var f=c.not(e);f.addClass("yj-focuswithin"),h(f,"yj-focusenter"),e=c}}),c(f).on("focusout.yj-acc-focuswithin",function(){b=!1,d.defer(function(){!b&&e&&(e.removeClass("yj-focuswithin"),h(e,"yj-focusleave"),e=c())})})};return i}),define("common-ui/lib/ui/accessibility/heading_navigation",["require","jquery","underscore","common-ui/lib/ui/accessibility/traversal_util"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/accessibility/traversal_util"),e=function(a,e){var f=b(a);f.addClass("x-current-focused-element");var g=b("body, h2, [role=heading][aria-level=2], .x-current-focused-element").toArray();f.removeClass("x-current-focused-element");var h,i=c.indexOf(g,a),j=i;for(e&&(j=(j+g.length-1)%g.length);j=(e?j+g.length-1:j+1)%g.length,j!==i;){h=g[j];var k=h.getAttribute(k);if((!k||"heading"===k)&&d.isVisible(h)){var l=d.findNextTabbable(h);if(l&&l!=a)return l}}return null},f=function(){b(document.body).on("keydown.yj-acc-keyboard",function(a){if(117===a.which&&(a.altKey||a.ctrlKey)){var b=e(document.activeElement,a.shiftKey);return b.focus(),!1}})};return f.spec={_handleHeadingNavigation:e},f}),define("common-ui/lib/ui/accessibility/speechtips",["require","jquery","underscore","core/lib/tr","core/lib/report"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/tr"),e=a("core/lib/report"),f=5,g=8,h=d.t("speechtips_show_command"),i=d.t("speechtips_hide_command"),j=d.t("speechactions_show_command"),k=d.t("speechactions_hide_command"),l={},m=[],n=function(a){a&&(this.left=a.left,this.top=a.top,this.width=a.width,this.height=a.height)};l.SimpleRect=n,n.prototype.right=function(){return this.left+this.width},n.prototype.bottom=function(){return this.top+this.height},n.prototype.clone=function(){return new n(this)};var o=function(a){var b=a.offset();return new n({left:b.left,top:b.top,width:a.outerWidth(),height:a.outerHeight()})};l.measureItem=o;var p=function(a,b){return a.right()>b.left&&a.left<b.right()&&a.bottom()>b.top&&a.top<b.bottom()};l.rectsOverlap=p;var q=function(a,b){return c.find(b,function(b){return p(a,b)})};l.findFirstOverlapping=q;var r=function(a){var b=a.attr("data-speechtip");if(!b&&(b=a.attr("aria-label"),!b&&(b=a.text().trim(),!b))){var c=a.find("img[alt]");c&&(b=c.prop("alt"))}return b.trim()},s=function(a){var c=b('<div class="yj-speechtips-label" />'),d=b('<div class="yj-speechtips-arrow" />'),e=r(a);return c.text(e),d.prependTo(c),c};l.createLabelForItem=s;var t=function(){return 0===jQuery(this).parents().addBack().filter("[aria-hidden=true]").length};l.isThisAriaVisible=t;var u=function(){var a=b('<div class="yj-speechtips-windowsizer" />').appendTo(document.body),c=new n({left:window.pageXOffset,top:window.pageYOffset,width:a.width(),height:a.height()});return a.remove(),c};l.getWindowBounds=u;var v=function(a){var c={items:[],itemPositions:[]},d={},e=["[data-speechtip]"].concat(m).join(",");return b(e).filter(":visible").filter(t).each(function(){var e=b(this),f=o(e);if(p(f,a)){var g=r(e),h=e[0].className.trim().split(/\s+/).sort().join(),i=g+":"+h;i in d||(d[i]=!0,c.items.push(e),c.itemPositions.push(f))}}),c};l.getCandidateItemsAndPositions=v;var w=function(a){var d=b('<div class="yj-speechtips-measuringwell" />').appendTo(document.body),e=c.map(a,function(a){a.appendTo(d);var b=o(a);return a.remove(),b});return d.remove(),e};l.measureLabels=w;var x=function(a,b,d){var e=[];return c.each(a,function(c,g){var h=b[g];c.left=h.left+(h.width-c.width)/2,c.left=Math.min(c.left,d.right()-c.width),c.left=Math.max(c.left,d.left);for(var i,j=c.clone(),k=c.top=h.bottom()+f;j.top=k,i=q(j,e),i;)k=i.bottom()+f;k+c.height>d.bottom()&&(k=null);for(var l=h.top-c.height-f;j.top=l,i=q(j,e),i;)l=i.top-c.height-f;if(l<d.top&&(l=null),l||k)if(l&&k){var m=h.top-l-c.height,n=k-h.bottom();c.top=n>m?l:k}else c.top=l||k;else c=a[g]=null;c&&e.push(c)}),0!==e.length};l.layoutLabels=x;var y=function(a,b,d){c.each(a,function(a,c){var e=b[c],f=d[c];if(e){a.css({left:e.left+"px",top:e.top+"px"}).appendTo(document.body);var h=f.left-e.left+f.width/2-1;h=Math.max(h,g),h=Math.min(h,e.width-1-g),a.find(".yj-speechtips-arrow").addClass(e.top<f.top?"yj-speechtips-arrow-down":"yj-speechtips-arrow-up").css({display:"block",left:h+"px"})}})};l.positionLabels=y;var z=function(){var a=u(),b=v(a),d=c.map(b.items,s),e=w(d);return x(e,b.itemPositions,a)?(y(d,e,b.itemPositions),!0):!1};l.showSpeechTips=z;var A,B,C="click.yj-speechtips mousedown.yj-speechtips keypress.yj-speechtips down.yj-speechtips",D="scroll.yj-speechtips resize.yj-speechtips",E=!1,F=!1,G=function(){b(".yj-speechtips-label").remove(),b(document.body).off(C),b(window).off(D),A.text(h),E=!1},H=function(){z()&&(b(document.body).on(C,function(a){a.target!==A[0]&&G()}),b(window).on(D,G),A.text(i),E=!0)},I=function(a){return e.event("speechtips",{command:E?"hide_tips":"show_tips"}),E?G(a):H(a),!1},J=function(){var a=b(document.body);a.hasClass("yj-acc-showactions")?(a.removeClass("yj-acc-showactions"),B.text(j),e.event("speechtips",{command:"hide_actions"})):(a.addClass("yj-acc-showactions"),B.text(k),e.event("speechtips",{command:"show_actions"}))},K=function(a){-1===m.indexOf(a)&&m.push(a)},L=function(){b(function(){if(!F){var a=b("<div id='yj-speech-commands-container'><button id='yj-speechtips-button' tabindex='-1' /><button id='yj-toggleactions-button' tabindex='-1' /></div>").appendTo(document.body);A=a.find("#yj-speechtips-button").text(h).on("click",I),B=a.find("#yj-toggleactions-button").text(j).on("click",J),F=!0}})},M=function(){b("#yj-speech-commands-container").remove(),A=null,B=null,F=!1};return l.resetSpeechTips=M,{_internals:l,init:L,addSelector:K}}),define("models/lib/client/realtime_actions_client",["require","underscore","models/lib/client/base_realtime_client","core/lib/ctor","models/lib/helper/feed_factory","core/lib/log","models/lib/orm-models","core/lib/session"],function(a){var b=a("underscore"),c=a("models/lib/client/base_realtime_client"),d=a("core/lib/ctor"),e=a("models/lib/helper/feed_factory"),f=a("core/lib/log"),g=a("models/lib/orm-models"),h=a("core/lib/session");return d(null,c,{init:function(a){c.prototype.init.call(this,a),this.supportedActions=["markAsRead","markAsUnread","followInInbox","unfollowInInbox","notifications"],this.unreadFeed=e.findOrCreate("inboxUnread"),this.requestFunction=null},onRealtimeData:function(a){var c=a&&a.data,d=g.Thread();if(c){f.log("Realtime action:",JSON.stringify(c));var e=c.action,i=c.threadId;if(-1==b.indexOf(this.supportedActions,e))return;if("notifications"===e)h.getCurrentNetwork()&&h.getCurrentNetwork().update({unseen_notification_count:0});else{var j=d.findById(i);if(j)this.applyAction(j,e);else{if("markAsRead"===e||"unfollowInInbox"===e)return;f.log("Resolving thread:",i),this.unreadFeed.fetchThread(i,{threaded:"extended"}).then(b.bind(function(){var a=d.findById(i);a&&this.applyAction(a,e)},this))}}}},applyAction:function(a,b){if(a){if("markAsRead"===b&&(a.isSeen()||!a.isFollowedInInbox())||"markAsUnread"===b&&this.unreadFeed.isUnseen(a)&&!a.isSeen()||"followInInbox"===b&&a.isFollowedInInbox()||"unfollowInInbox"===b&&!a.isFollowedInInbox())return;a[b].call(a,{fromRealtime:!0})}},getUrl:function(){return"mock_url"},getChannels:function(){return["/users/"+h.getCurrentUser().id+"/actions"]}})}),define("workfeed/lib/simple_click_menu",["require","jquery","common-ui/lib/ui/accessibility/menu_accessibility","core/lib/namespace","backbone","core/lib/report"],function(a){var b=a("jquery"),c=a("common-ui/lib/ui/accessibility/menu_accessibility"),d=a("core/lib/namespace"),e=a("backbone"),f=a("core/lib/report");return d.ns("yam.workfeed"),yam.workfeed.SimpleClickMenu={bindClickMenu:function(){function a(){g.trigger("menuClose"),g.css("display","none"),g.off("click."+h),d.removeClass("yj-open is-open").css("position",i),b(document).unbind("mousedown."+h),c.afterMenuDone(g[0])}var d,g,h,i,j=function(a,b,c){return!(b>a||a>c)},k=function(a,c){var d=b(c),e=d.offset();return j(a.pageX,e.left,e.left+d.outerWidth())&&j(a.pageY,e.top,e.top+d.outerHeight())};e.on("/ui/simpleclickmenu/close",function(){a()}),b(document).on("click",".yj-simple-click-menu-trigger",function(e){d=b(e.target).hasClass("yj-simple-click-menu-trigger")?b(e.target):b(e.target).parents(".yj-simple-click-menu-trigger:first"),g=d.find(".yj-click-menu"),h="ClickMenuTracker",i=d.css("position")||"static",d.data("qaid")&&f.event("simple_click_menu",{trigger:d.data("qaid"),page_title:document.title});var j=e.currentTarget;if("a"===j.nodeName.toLowerCase()&&j.href&&j.href.match(/^http/)){if(void 0!==e.metaKey?e.metaKey:e.ctrlKey)return;e.preventDefault()}else e.preventDefault();d[0].id&&(h+=d[0].id),g.length||(g=d.siblings(".yj-click-menu")),"block"!==g.css("display")?(d.addClass("yj-open is-open").css("position","relative"),g.css("display","block"),b(document).bind("mousedown."+h,function(c){(!k(c,g)&&!k(c,d)||b(c.target).hasClass("yj-message-action")||b(c.target).closest("div").siblings(".yj-message-action").length)&&a(c)}),d.bind("close."+h,function(){a()}),g.one("click."+h,function(c){"true"!==b(c.currentTarget).attr("data-keep-open-on-click")&&a(c)}),c.afterMenuShow(g[0],a),g.trigger("menuOpen")):"true"===d.attr("data-keep-open-on-click")&&b(e.target).closest(".yj-click-menu").length||a(e)})}}}),define("stache!feeds/lib/ui/feeds/spinner",["mustache"],function(a){var b='<div class="yj-spinner-loading">{{text}}</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/feeds/spinner",[],function(){}),define("feeds/lib/ui/feeds/menu_spinner",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","html!./spinner","css!./spinner"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("html!./spinner");return a("css!./spinner"),b.extend({mixins:[c],id:"spinner",className:"yj-spinner-loading-container",template:e,defaults:{text:d.t("loading")},getTemplateData:function(){return this.options},show:function(){this.$el.show()},hide:function(){this.$el.hide()}})}),define("models/lib/helper/notifications_callbacks",["require","models/lib/helper/external_groups_response_helper"],function(a){"use strict";function b(a){return g[a.decoration]}function c(a,b){var c;return f[a]&&f[a].actions&&(c=f[a].actions[b]),c}function d(a){var b;return f[a]&&(b=f[a].onShow),b}var e=a("models/lib/helper/external_groups_response_helper"),f={"external-group-invite":{actions:{positive:function(a){var b=a.message_data.group_id;e.acceptGroupMembershipInUI(b)},negative:function(a){var b=a.message_data.group_id;e.rejectGroupMembershipInUI(b)}}}},g={plus:"positive",minus:"negative"};return{runActionSuccessCallback:function(a,d,e){var f=c(a,b(d));f&&f(e)},runShowNotificationCallback:function(a,b){var c=d(a);c&&c(b)}}}),define("common-ui/lib/ui/shared/tiny_follow_group_button",["require","underscore","backbone","core/lib/session","common-ui/lib/ui/shared/tiny_follow_button","core/lib/tr","collections/group_memberships","collections/groups","core/lib/yammer_api","models/helpers/user"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/session"),e=a("common-ui/lib/ui/shared/tiny_follow_button"),f=a("core/lib/tr"),g=a("collections/group_memberships"),h=a("collections/groups"),i=a("core/lib/yammer_api"),j=a("models/helpers/user");return e.extend({strings:{follow:f.t("join"),unfollow:f.t("leave"),following:f.t("joined"),pending:f.t("pending")},initialize:function(){b.bindAll(this,"handleJoinGroup","failureCallback"),e.prototype.initialize.call(this),g.on("add",this.onGroupMembershipCreate,this),g.on("remove",this.onGroupMembershipDestroy,this)},remove:function(){g.off("add",this.onGroupMembershipCreate),g.off("remove",this.onGroupMembershipDestroy),e.prototype.remove.apply(this,arguments)},initFollowingState:function(){this.options.following=j.isMemberOf(d.getCurrentUser(),h.get(this.model)),this.options.following&&this.options.following.pending&&this.setFollowing("pending")},onGroupMembershipCreate:function(a){a.get("group_id")===this.model.id&&(this.initFollowingState(),this.updateButtonState())},onGroupMembershipDestroy:function(a){a.get("group_id")===this.model.id&&(this.initFollowingState(),this.updateButtonState(),this.$el.show(this.clearInlineStyle.bind(this)))},getTooltipText:function(){var a=this.model.get("full_name")||this.model.get("name");return this.isFollowing()?"":f.t("join_name",{name:a})},getSuccessMessage:function(){return f.t("you_have_joined_the_name_group",{name:this.model.get("full_name")})},handleClick:function(a){if(a.preventDefault(),!this.isFollowing()&&!this.isLoading()){var b={group_id:this.model.id,id:this.model.id};this.options.inNotification&&(b.bfr_source="notification"),this.toggleLoading(!0),i.joinGroup(b).then(this.handleJoinGroup,this.failureCallback)}},handleJoinGroup:function(){var a,b={user_id:d.getCurrentUser().id,group_id:this.model.id};this.toggleLoading(!1),"private"===this.model.privacy||"restricted"===this.model.privacy?(b.pending=!0,c.trigger("/ui/alert/show","notice",f.t("you_have_requested_to_join_the_group_group",{group:this.model.full_name}),!0)):(j.getGroupMemberships(d.getCurrentUser()).length||c.trigger("taskListComplete","join_a_group"),c.trigger("/ui/alert/show","notice",this.getSuccessMessage())),a=g.findWhere(b),a||g.add(b),this.$el.css("display","inline-block").delay(3e3).hide(0,this.clearInlineStyle.bind(this))}})}),define("stache!common-ui/lib/ui/notifications/notification_group",["mustache"],function(a){var b='<div class="yj-avatar-container">\n  <div class="yj-avatar-placeholder">\n    <AvatarView />\n  </div>\n  <div class="yj-follow">\n    <FollowButtonView />\n  </div>\n</div>\n<ul class="yj-user-info-container">\n  <li class="yj-notification-user-name"><a href="{{webUrl}}">{{name}}</a></li>\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/notifications/notification_group",[],function(){}),define("common-ui/lib/ui/notifications/notification_group",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/avatar/index","common-ui/lib/ui/shared/tiny_follow_group_button","core/lib/yammer_uri","core/lib/urls","html!./notification_group","css!./notification_group"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("components/avatar/index"),f=a("common-ui/lib/ui/shared/tiny_follow_group_button"),g=a("core/lib/yammer_uri"),h=a("core/lib/urls"),i=a("html!./notification_group");return a("css!./notification_group"),b.extend({mixins:[c,d],className:"yj-notification-group yj-notification-user yj-notification-user-extended",template:i,views:{AvatarView:"_getAvatar",FollowButtonView:"_getFollowButton"},_getAvatar:function(){return new e({model:this.model,withHovercard:!1})},_getFollowButton:function(){return new f({model:this.model,inNotification:!0})},getTemplateData:function(){return{name:this.model.get("full_name"),webUrl:g.makeAbsoluteUrl(h.groupIndex(this.model))}}})}),define("css!feeds/lib/ui/messages/notification_list_item_message",[],function(){}),define("feeds/lib/ui/messages/notification_list_item_message",["require","jquery","feeds/lib/ui/messages/message_list_item","css!./notification_list_item_message"],function(a){var b=a("jquery"),c=a("feeds/lib/ui/messages/message_list_item");return a("css!./notification_list_item_message"),c.extend({init:function(a,d,e){this.notification=d,c.prototype.init.call(this,a,b.extend(this.defaults,e),d)},defaults:{manuallyRender:!0,settings:{elementType:"li",elementClassName:"yj-notification-list-item-message yj-thread-reply-list-item",idPrefix:"notificationListItemMessage"},display:"threaded"},buildActions:function(){return null},getAttachmentsRenderMode:function(){return"reply"}})}),define("stache!common-ui/lib/ui/notifications/notification_user",["mustache"],function(a){var b='<div class="yj-avatar-container">\n  <div class="yj-avatar-placeholder">\n    <AvatarView />\n  </div>\n  <div class="yj-follow">\n    <FollowButtonView />\n  </div>\n</div>\n<ul class="yj-user-info-container">\n  <li class="yj-notification-user-name"><a href="{{webUrl}}">{{name}}</a></li>\n  {{#jobTitle}}<li class="yj-notification-user-title">{{jobTitle}}</li>{{/jobTitle}}\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/notifications/notification_user",[],function(){}),define("common-ui/lib/ui/notifications/notification_user",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/avatar/index","common-ui/lib/ui/shared/tiny_follow_button","core/lib/string_helper","models/helpers/user","core/lib/yammer_uri","core/lib/urls","html!./notification_user","css!./notification_user"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("components/avatar/index"),f=a("common-ui/lib/ui/shared/tiny_follow_button"),g=a("core/lib/string_helper"),h=a("models/helpers/user"),i=a("core/lib/yammer_uri"),j=a("core/lib/urls"),k=a("html!./notification_user");return a("css!./notification_user"),b.extend({mixins:[c,d],className:"yj-notification-user yj-notification-user-extended",template:k,views:{AvatarView:"_getAvatar",FollowButtonView:"_getFollowButton"},_getAvatar:function(){return new e({model:this.model,withHovercard:!1,askForPhoto:!1,hideFromAccessibility:!0})},_getFollowButton:function(){return new f({model:this.model,inAvatar:!0})},getTemplateData:function(){return{name:h.getUserName(this.model),webUrl:i.makeAbsoluteUrl(j.userIndex(this.model)),jobTitle:g.truncate(this.model.job_title,64)}}})}),define("common-ui/lib/ui/shared/suggestion_queue_consumer",["require","jquery","underscore","core/lib/ctor"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/ctor");return d(null,{init:function(a,b){this._queues=a,this._fallbacks=b},refill:function(){var a=new b.Deferred;return this._refill(function(){a.resolve.apply(a,arguments)},function(){a.reject.apply(a,arguments)}),a.promise()},_refill:function(a,d){b.when.apply(null,c.invoke(this._queues,"refill")).then(a,d)},consumeQuantities:function(a,b){b=c.defaults({},b,{useFallbacks:!1,excludedIds:[]});var d=[],e={};return c.each(a,function(a,f){var g=b.useFallbacks?this._fallbacks[f]:null;c.times(a,function(){var a,c=this._queues[f].remove(b);"resolved"===c.state()&&c.done(function(b){null!=b&&(a=b)}),null!=a?d.push(a):null!=g&&(null==e[g]&&(e[g]=0),e[g]++)},this)},this),c.isEmpty(e)||d.push.apply(d,this.consumeQuantities(e,c.defaults({useFallbacks:!1},b))),d},consumeSlots:function(a,b){return b=c.defaults({},b,{useFallbacks:!1,excludedIds:[]}),c.map(a,function(a){var d,e=c.keys(a)[0],f=c.values(a)[0];return null==f&&(d=c.object([e],[1]),f=this.consumeQuantities(d,b).pop()),c.object([e],[f])},this)}})}),define("css!common-ui/lib/ui/shared/suggestions",[],function(){}),define("stache!common-ui/lib/ui/shared/suggestions",["mustache"],function(a){var b='<h2 class="yj-suggested-list--header">\n    <a data-qaid="suggested-see-all" href="javascript://" role="button" class="yj-suggested-list--header-link">\n      {{title}}\n    </a>\n  </h2>\n<ul class="yj-suggested-list--items"></ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/shared/suggestions_item",["mustache"],function(a){var b='<li class="yj-suggestions-item" data-sug-id="{{id}}" data-sug-type="{{type}}"\n    data-sug-name="{{name}}" data-sug-fullname="{{full_name}}" data-sug-state="{{state}}"\n    data-sug-pool="{{pool}}" data-sug-strategy="{{strategy}}">\n  <div class="img">\n    <div class="yj-avatar-placeholder"></div>\n  </div>\n  <div class="description">\n    <div class="name yj-suggested-list--name">\n      {{#web_url}}<a class="yj-suggestion-link" href="{{web_url}}">{{/web_url}}\n        {{trunc_full_name}}\n      {{#web_url}}</a>{{/web_url}}\n    </div>\n    <div class="position">\n      {{#isGroup}}\n        {{numMembers}} {{members}}\n      {{/isGroup}}\n      {{^isGroup}}\n        {{trunc_job_title}}\n      {{/isGroup}}\n    </div>\n    <a href="javascript://" class="yj-sug-follow yj-btn yj-btn-alt yj-btn-small" role="button" data-action="followSuggestion">{{button}}</a>\n\n    <div class="yj-suggestion-list--dropdown yj-sugg-close" data-content-id="yj-sugg-{{id}}" {{#menu}}data-attach-menu="true" data-position-menu="right"{{/menu}}>\n      <a href="javascript://" role="button" aria-haspopup="true" class="yj-suggestion-action yj-suggestion-list--anchor yj-menu-shadow-top yj-sug-menu {{#menu}}yj-simple-click-menu-trigger{{/menu}}" data-action="openSuggestionMenu" data-qaid="ellipsis_menu_button" data-speechtip>\n        <span class="yj-sugg-dropdown--menu-icon yamicon yamicon-ellipsis yk-yamicon-m"></span>\n        <span class="yj-suggestions--menu-alt-text {{^menu}}yj-sug-remove{{/menu}} yj-acc-hidden">{{menuAltText}}</span>\n      </a>\n      {{#menu}}\n        <ul data-yamjs-id="yj-sugg-{{id}}" class="yj-suggestion-list--dropdown-list yj-click-menu yj-click-menu-content yj-menu-shadow">\n          {{#menus}}\n          <li>\n            <a href="javascript://" data-qaid="remove-suggestion-link" class="yj-sug-remove yj-suggestion-list--dropdown-remove" data-action="removeSuggestion" data-remove-reason="{{reason}}">\n              {{text}}\n            </a>\n          </li>\n          {{/menus}}\n        </ul>\n      {{/menu}}\n    </div>\n  </div>\n</li>\n';
return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/suggestions",["require","underscore","jquery","core/lib/backbone_legacy_integration","common-ui/lib/ui/shared/suggestion_queue_consumer","core/lib/log","core/lib/i18n","collections/group_memberships","core/lib/namespace","backbone","core/lib/string_helper","core/lib/tr","core/lib/yammer_api","core/lib/report","core/lib/session","models/helpers/user","css!./suggestions","html!./suggestions","html!./suggestions_item"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/backbone_legacy_integration"),e=a("common-ui/lib/ui/shared/suggestion_queue_consumer"),f=a("core/lib/log"),g=a("core/lib/i18n"),h=a("collections/group_memberships"),i=a("core/lib/namespace"),j=a("backbone"),k=a("core/lib/string_helper"),l=a("core/lib/tr"),m=a("core/lib/yammer_api"),n=a("core/lib/report"),o=a("core/lib/session"),p=a("models/helpers/user");return a("css!./suggestions"),d.extend({events:{click:"_onClick"},initialize:function(a){if(this.queues=a.queues,this.consumer=new e(this.queues,this.fallbacks),this._initSuggestionSlots(),"yam.model.GroupMembership"===this.modelType)h.on("add",this._onCreateSubscription,this);else{var b=p.getFollowing(o.getCurrentUser(),"user");this.listenTo(b,"add push",this._onCreateSubscription)}this.$el.hide()},render:function(){this.empty(),this.renderTemplate({title:this.title,seeAll:l.t("see_all")});var a=this.getSuggestions();return a.length>0?(this.$("ul").html(this._renderSuggestions(a)),b.each(a,function(a,b){var c=this._createAvatar(a.suggested);this.append(c,"li:nth-child("+(b+1)+") .yj-avatar-placeholder")},this),this.$el.show()):this.$el.is(":visible")&&(this.$el.slideUp(),j.trigger("/ui/reflow/vertical")),this},remove:function(){this.stopListening(),"yam.model.GroupMembership"===this.modelType&&h.off("add",this._onCreateSubscription)},refresh:function(){this.slots=this._fillSuggestionSlots(),this.render()},getSuggestions:function(){return b.compact(b.map(this.slots,function(a){return b.values(a)[0]}))},requestSuggestions:function(){c.when(this.consumer.refill()).then(this._onRequestSuccess.bind(this),this._onRequestError.bind(this))},_buttonText:function(){return l.t("follow")},_onRequestNoop:function(){},_onRequestSuccess:function(){this.refresh()},_onRequestError:function(a){f.log("Request failed:",a)},_onClick:function(a){var b=c(a.target),d=b.closest("[data-action]"),e=b.closest("[data-sug-id]"),f=d.data("action"),g=d.data("remove-reason"),h=b.hasClass("yj-see-all-link"),i=b.hasClass("yj-suggestion-link"),j=c("group-suggestions"==a.currentTarget.id);return null==this[f]?void(h&&j?n.event("rr_home_suggested_groups",{event_action:"see-all"}):i&&j&&n.event("rr_home_suggested_groups",{event_action:"group-name-navigate",group_id:e.attr("data-sug-id")})):(a.preventDefault(),a.stopPropagation(),void this[f](e,g))},followSuggestion:function(a){var b=this._infoFromSuggestionElement(a),c=this._followCallbacks(a,b),d=c.success,e=c.error;this.optimistic&&(d({}),d=function(){}),m[this.followEndpoint](this._followParams(b)).then(d,e)},removeSuggestion:function(a,b){var c=this._infoFromSuggestionElement(a),d=this._removeCallbacks(a,c),e=d.success,f=d.error;this.optimistic&&(e(),e=function(){}),m[this.removeEndpoint](this._removeParams(c,b)).then(e,f)},_initSuggestionSlots:function(){this.slots=b.map(this.initialSuggestionSlots,function(a){return b.object([a],[])},this)},_fillSuggestionSlots:function(){return this.consumer.consumeSlots(this.slots,{useFallbacks:!0,excludedIds:this.excludedIds})},_isSameSuggestion:function(a,b){return null!=a.id&&a.id===b.id||a.name===b.name},_emptySuggestionSlot:function(a){b.each(this.slots,function(c){var d=b.keys(c)[0],e=b.values(c)[0];null!=e&&this._isSameSuggestion(e.suggested,a)&&(c[d]=void 0)},this)},_cleanupQueues:function(a){b.each(this.queues,function(b){b.cleanup(function(b){return this._isSameSuggestion(b.suggested,a)},this)},this)},_createSubscription:function(a){return yam.backbone.isBackboneModel(this.modelType)?void yam.backbone.getBackboneCollectionInstance(this.modelType).add(this._infoToModel(a)):i.ns(this.modelType).create(this._infoToModel(a))},_onCreateSubscription:function(a){var b=this._modelToInfo(a);this._emptySuggestionSlot(b),this._cleanupQueues(b);var c=this._findSuggestionElement(b);c.length>0&&this._replaceSuggestionElement(c)},_destroySubscription:function(a){null!=a&&a.destroy()},_renderSuggestions:function(a){return this._logSuggestions(a),b.reduce(a,function(a,b){return a+this._renderSuggestion(b)},"",this)},_renderSuggestion:function(a){var c=a.suggested,d=a.pool,e=a.strategy,f="group"===c.type,h=f?c.stats.members:0;return b.extend(c,{full_name:c.full_name||c.display_name||"",trunc_full_name:k.truncate(c.full_name||c.display_name||"",64),trunc_job_title:k.truncate(c.job_title,64),isGroup:f,numMembers:h,members:l.t("group_members_label").toLowerCase(),pool:d,strategy:e,menus:this._getMenuForSuggestion(c),menu:null!=this.menus&&this.menus.length>0,button:this._buttonText(),menuAltText:l.t("actions"),inEnglish:"en"===g.getShortLocale()}),this.itemTemplate(c)},_getMenuForSuggestion:function(a){var b=a.type===this.type&&"pending"!==a.state;return b?[this.menus[0]]:this.menus},_findSuggestionElement:function(a){return a.id?this.$el.find("[data-sug-id="+a.id+"]"):this.$el.find('[data-sug-name="'+a.name+'"]')},_replaceSuggestionElement:function(a){var b=this;this._hideSuggestionElement(a,function(){b.refresh()})},_hideSuggestionElement:function(a,b,d){null!=a&&a.fadeTo("slow",0,function(){"function"==typeof b&&b(),c(this).remove(),"function"==typeof d&&d()})},_infoFromSuggestionElement:function(a){return{id:a.data("sug-id"),name:a.data("sug-name"),full_name:a.data("sug-fullname"),state:a.data("sug-state"),pool:a.data("sug-pool"),strategy:a.data("sug-strategy")}},_alertText:function(a){j.trigger("/ui/alert/show","notice",a,!0)},className:"yj-suggested-list",template:a("html!./suggestions"),itemTemplate:a("html!./suggestions_item")})}),define("common-ui/lib/ui/shared/user_suggestions",["require","underscore","core/lib/session","common-ui/lib/ui/shared/suggestions","core/lib/tr","core/lib/yammer_api","components/avatar/index","core/lib/report","models/helpers/user"],function(a){var b=a("underscore"),c=a("core/lib/session"),d=a("common-ui/lib/ui/shared/suggestions"),e=a("core/lib/tr"),f=a("core/lib/yammer_api"),g=a("components/avatar/index"),h=a("core/lib/report"),i=a("models/helpers/user"),j=d.extend({type:"user",followEndpoint:"acceptUserSuggestion",removeEndpoint:"declineUserSuggestion",initialSuggestionSlots:["active","pending"],fallbacks:{active:"pending",pending:"active"},optimistic:!0,title:e.t("suggested_people"),removeText:e.t("remove_suggestion"),menuAltText:e.t("actions"),menus:[{reason:"remove_suggestion",text:e.t("remove_suggestion")},{reason:"mailing_list",text:e.t("this_is_a_mailing_list")},{reason:"non_employee",text:e.t("they_dont_work_here")}],_infoToModel:function(a){return{follower_id:c.getCurrentUser().id,follower_type:"user",followed_id:+a.id,followed_type:"user"}},_modelToInfo:function(a){return{id:a.id,type:"user"}},_followCallbacks:function(a,b){var c,d=this;return{success:function(){c=d._createSubscription(b),d._alertFollowSuccess(b)},error:function(a){d._onRequestError(a),d._destroySubscription(c)}}},_followParams:function(a){return h.event("rr_home_suggested_users",{event_action:"follow"}),{id:a.id,invite_section:"home_page",invite_source:"invite_suggestions",bfr_source:"suggestions"}},_removeCallbacks:function(a,b){var c=this;return{success:function(){c._emptySuggestionSlot(b),c._replaceSuggestionElement(a)},error:function(a){c._onRequestError(a)}}},_removeParams:function(a,b){return h.event("rr_home_suggested_users",{event_action:b}),{id:a.id,reason:b}},_logSuggestions:function(a){var c=this._onRequestNoop.bind(this),d=this._onRequestError.bind(this);f.logUserSuggestions({events:b.map(a,this._eventRepresentation)}).then(c,d)},_eventRepresentation:function(a){var b=a.suggested;return{suggestion_suggested:{type:"suggestion",suggested_user_id:b.id,weight:a.weight}}},_alertFollowSuccess:function(a){this._alertText(e.t("you_are_now_following_name_2",{name:a.full_name}))},_createAvatar:function(a){return new g({model:a,withHovercard:!1,badge:null,hideFromAccessibility:!0})},_createSubscription:function(a){i.followUser(c.getCurrentUser(),a.id)}});return j}),define("css!common-ui/lib/ui/shared/user_suggestions_in_notifications",[],function(){}),define("stache!common-ui/lib/ui/shared/user_suggestions_in_notifications",["mustache"],function(a){var b='<li class="yj-notification-user yj-notification-user-extended yj-component" data-sug-id="{{id}}" data-sug-type="{{type}}"\n    data-sug-name="{{name}}" data-sug-fullname="{{full_name}}" data-sug-state="{{state}}"\n    data-sug-pool="{{pool}}" data-sug-strategy="{{strategy}}">\n  <div class="yj-avatar-container">\n    <div class="yj-avatar-placeholder"></div>\n    <div class="yj-follow">\n      <a href="javascript://" class="yj-btn yj-btn-alt yj-btn-tiny yj-follow-button-tiny yj-component yam-ui-shared-tiny-follow-button" data-action="followSuggestion" role="button">\n        {{#inEnglish}}<span>{{button}}</span>{{/inEnglish}}{{^inEnglish}}<b>+</b>{{/inEnglish}}\n      </a>\n    </div>\n  </div>\n  <ul>\n    <li class="yj-notification-user-name">\n      {{#web_url}}<a class="yj-suggestion-link" href="{{web_url}}">{{/web_url}}\n        {{trunc_full_name}}\n      {{#web_url}}</a>{{/web_url}}\n    </li>\n    <li class="yj-notification-user-title">\n      {{trunc_job_title}}\n    </li>\n  </ul>\n  <a href="javascript://" role="button" class="yj-sug-remove yj-close-link" title="{{remove}}" data-action="removeSuggestion" data-remove-reason="remove_suggestion">\n    <span class="yamicon yamicon-x yamicon-xx-small"></span>\n  </a>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/user_suggestions_in_notifications",["require","core/lib/tr","common-ui/lib/ui/shared/user_suggestions","css!./user_suggestions_in_notifications","html!./user_suggestions_in_notifications"],function(a){var b=a("core/lib/tr"),c=a("common-ui/lib/ui/shared/user_suggestions");a("css!./user_suggestions_in_notifications");var d=c.extend({initialSuggestionSlots:["active","pending","active"],title:b.t("you_might_be_missing_updates_follow_your_coworkers_to_tap"),className:"yj-user-suggestions-notification yj-suggestions yj-suggestions-container",template:'      <div class="yj-notification-item-content">{{title}}</div>      <ul class="yj-notification-item-avatars"></ul>    ',itemTemplate:a("html!./user_suggestions_in_notifications"),_followParams:function(a){return{id:a.id,section:"home_page",source:"notification_suggestions"}}});return d}),define("css!feeds/lib/ui/notifications/notification_list_item",[],function(){}),define("feeds/lib/ui/notifications/notification_list_item",["require","underscore","jquery","mustache","common-ui/lib/ui/notifications/action_button","feeds/lib/ui/attachments/attachment_view_factory","models/lib/helper/message/message_action_mixin","models/helpers/message","models/lib/helper/notifications_callbacks","common-ui/lib/ui/notifications/notification_group","feeds/lib/ui/messages/notification_list_item_message","common-ui/lib/ui/notifications/notification_user","components/message_timestamp/index","core/lib/model_helper","core/lib/jam/component","collections/groups","backbone","core/lib/session","core/lib/urls","core/lib/tr","common-ui/lib/ui/shared/user_suggestions_in_notifications","common-ui/lib/ui/shared/suggestions","models/helpers/message","models/user","models/message","css!./notification_list_item"],function(a){var b=a("underscore"),c=a("jquery"),d=a("mustache"),e=a("common-ui/lib/ui/notifications/action_button"),f=a("feeds/lib/ui/attachments/attachment_view_factory"),g=a("models/lib/helper/message/message_action_mixin"),h=a("models/helpers/message"),i=a("models/lib/helper/notifications_callbacks"),j=a("common-ui/lib/ui/notifications/notification_group"),k=a("feeds/lib/ui/messages/notification_list_item_message"),l=a("common-ui/lib/ui/notifications/notification_user"),m=a("components/message_timestamp/index"),n=a("core/lib/model_helper"),o=a("core/lib/jam/component"),p=a("collections/groups"),q=a("backbone"),r=a("core/lib/session"),s=a("core/lib/urls"),t=a("core/lib/tr"),u=a("common-ui/lib/ui/shared/user_suggestions_in_notifications");return a("common-ui/lib/ui/shared/suggestions"),a("models/helpers/message"),a("models/user"),a("models/message"),a("css!./notification_list_item"),o.extend({init:function(a,b){this.data=a.data,a.id=a.data.id,this.messages={},this.avatars={},this.actions=[],o.prototype.init.call(this,c.extend(this.defaults,a),b),c.extend(this,g),this.renderOptions={}},defaults:{settings:{elementType:"li",idPrefix:"notificationListItem"}},template:'<{{tag}} class="yj-notification-item {{#unseen}}yj-unread{{/unseen}}"       data-notification-id="{{id}}" data-notification-category="{{category}}" data-qaid="notification_item">    </{{tag}}>',createElement:function(){this.$element=c(d.render(this.template,{tag:this.settings.elementType,id:this.data.id,unseen:this.data.unseen,category:this.data.category})),this.$element.append(this.buildIcon()).append(this.buildContent()),this.appendBody(),this.$element.find(".yj-notification-item-thread-link").prepend(this.buildAttributes()),q.trigger("/ui/hovercard/build",this.$element,".yammer-object, .yj-hovercard-link"),this.applyRenderOptions(),this.$element.click(this._onClick.bind(this)),i.runShowNotificationCallback(this.data.category,this.data)},applyRenderOptions:function(){var a=this.$element;if(a){var b=this.renderOptions;this.toggleClass(b.lastUnseen,a,"yj-last-unseen"),this.toggleClass(b.firstSeen,a,"yj-after-unseen"),this.toggleClass(b.first,a,"yj-first-notification"),this.toggleClass(b.last,a,"yj-last-notification"),this.checkAddReadLine()}},toggleClass:function(a,b,c){b[a?"addClass":"removeClass"](c)},appendBody:function(){for(var a=this.data.getGroupedObjects(),b=[],c=0,d=f.supportedTypes.length;d>c;c++){var e=f.supportedTypes[c];e in a&&(b.push.apply(b,a[e]),delete a[e])}this.$element.append(this.buildMessages(a.message)).append(this.buildAvatars(a.user)).append(this.buildAvatars(a.group)).append(this.buildSuggestions()).append(this.buildAttachments(b)).append(this.buildActions())},observeDomEvents:function(){this.$element.find(".yj-notification-item-actions").bind("actionSuccess",this.onActionSuccess.bind(this)),this.$element.find(".yj-notification-item-thread-link").click(function(){c(".yj-nav-menu .yj-selected").removeClass("yj-selected")})},onActionSuccess:function(a,b){this.$element.find(".yj-notification-item-actions").animate({height:"toggle"},500),i.runActionSuccessCallback(this.data.category,b,this.data)},buildIcon:function(){var a=this.data.icon_name,b='<span class="yj-notification-item-icon"><img alt="" src="'+this.data.icon+'"></span>';"like"===a&&(a="rd_like");var c='<span class="yamicon yamicon-med yamicon-'+a+'"></span>';return a?c:b},buildContent:function(){return d.render('<div class="yj-notification-item-content">{{{ body }}}</div>',{body:this.data.getHtmlBody()})},buildMessages:function(a){var d,e=0,f=a?a.length:0,g=null,h=yam.model.Message;if(f>0){var i=s.networkIndex(r.getCurrentNetwork())+"/#/Threads/show?threadId="+h.findById(a[e].id).thread_id,j="ul";"li"!==this.settings.elementType&&(j="div"),g=c('        <div class="yj-notification-list-item--messages-wrapper">           <'+j+' class="yj-notification-list-item--messages yj-thread-replies"></'+j+'>           <div class="yj-notification-item-thread-link"><a href="'+i+'">'+t.t("view_conversation_2")+' <span aria-hidden="true">&raquo;</span></a></div>        </div>'),d=g.children().first(),b(a).chain().sortBy(function(a){var b=h.findById(a.id);return a._message=b,b.getTime()}).each(function(a){d.append(this.buildMessage(a._message))},this)}return g},buildAvatars:function(a){var b,d=0,e=a?a.length:0,f=null;if(e>0)for(f=c('<div class="yj-notification-item-avatars"></div>'),b=f.children().first();e>d;d++)d>0&&d%3===0&&f.append('<div class="yj-notification-user-row-start"></div>'),f.append(this.buildAvatar(a[d]));return f},buildSuggestions:function(){if("new-follower"===this.data.category&&this.firstInCategory&&yam.suggestions){var a=new u({queues:{active:yam.suggestions.activeUsers,pending:yam.suggestions.pendingUsers},excludedIds:b.pluck(this.data.objects,"id")});a.requestSuggestions(),this.$element.append(a.$el)}},buildAttachments:function(a){var d=b.map(a,n.objectForReference),e=c('<div class="yj-notification-item-attached-objects"></div>');return b.each(d,function(a){var b=f.newInstance(a);e.append(b.render())}),e},buildActions:function(){var a,b=0,d=this.data.actions.length,e=null;if(d>0){e=c('<div class="yj-notification-item-actions"><div class="yj-notification-item-actions-wrap"></div></div>');for(var f=e.children().first();d>b;b++)a=this.getButtonForAction(this.data.actions[b],b),this.actions.push(a),f.append(a.render().$el)}return e},buildAttributes:function(){var a=['<div class="yj-notification-attributes">'],b=this.data;b.unseen&&a.push('<span class="yj-notification-list-item--new-indicator"><span class="yj-notification-list-item--new-indicator-icon yamicon yamicon-dot"></span>'+t.t("unread_notification")+"</span>"),a.push("</div>"),this._notificationTime=this.buildNotificationTime(b);var d=c(a.join(""));return this._notificationTime&&d.append(this._notificationTime.el),d},isUnseen:function(){return this.data.unseen},buildNotificationTime:function(a){var b=a.getTime();return b?this._notificationTime?this._notificationTime:new m({model:a,extendedClass:"yj-notification-list-item--time"}).render():null},getButtonForAction:function(a,b){return new e({data:this._getLabelledAction(a),id:this.data.id+"_"+b,actionIndex:b},this)},_getLabelledAction:function(a){return a.label=h.translateFromKey(a.label),a},buildAvatar:function(a){var b,c=a.id;return b="group"===a.type?new j({model:p.get(c)}):new l({model:yam.model.User.findById(c)}),this.avatars[c]=b,b.render(),b.$el},buildMessage:function(a){var b=new k(a,this,{});return b.settings.elementType=this.settings.elementType,this.messages[a.id]=b,b.render()},checkAddReadLine:function(){!this.$readLine&&this.renderOptions.lastUnseen&&(this.$readLine=h.buildUnseenLine(),this.$element.append(this.$readLine))},markRead:function(){this.$element.find(".yj-notification-list-item--new-indicator").remove()},getTime:function(){return this.data.getTime()},_onClick:function(a){var b=c(a.target),d=b.closest("a");if(d.length)if(d.hasClass("yj-notification-action")){var e=Number(d.attr("action-index"));isNaN(e)||this.actions[e].onButtonClick(a,b)}else if(b.closest(".yj-notification-item-avatars").length){var f=Number(d.attr("user-id")),g=this.avatars[f];g&&g.onButtonClick(a,b)}else b.closest(".yj-notification-list-item--messages-wrapper").length&&this.onMessageDomEvents(a)},getMessageListItem:function(a){return this.messages[a]},callOnEach:function(a,b,c){for(var d in a)a.hasOwnProperty(d)&&"function"==typeof a[d][b]&&a[d][b](c)},destroy:function(){var a=function(a){a.destroy&&a.destroy()||a.remove&&a.remove()};this._notificationTime&&this._notificationTime.remove(),b.each(this.messages,a),b.each(this.avatars,a),b.each(this.actions,a),this.$readLine=a=this.messages=this.avatars=this.actions=null,o.prototype.destroy.call(this)}})}),define("css!feeds/lib/ui/notifications/notification_menu",[],function(){}),define("feeds/lib/ui/notifications/notification_menu",["require","jquery","underscore","core/lib/jam/component","feeds/lib/ui/feeds/menu_spinner","feeds/lib/ui/notifications/notification_list_item","core/lib/session","core/lib/string_helper","core/lib/tr","core/lib/uri_helper","core/lib/yammer_uri","core/lib/urls","Backbone","models/lib/events","models/count","models/stream","css!./notification_menu"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/jam/component"),e=a("feeds/lib/ui/feeds/menu_spinner"),f=a("feeds/lib/ui/notifications/notification_list_item"),g=a("core/lib/session"),h=a("core/lib/string_helper"),i=a("core/lib/tr"),j=a("core/lib/uri_helper"),k=a("core/lib/yammer_uri"),l=a("core/lib/urls"),m=a("Backbone"),n=a("models/lib/events");return a("models/count"),a("models/stream"),a("css!./notification_menu"),d.extend({init:function(a,e){a=a||{},c.extend(a,m.Events),this.scroller=null,this.availableMenuHeight=0,this.unseenCount=0,this.unavailableHeight=80,this.minHeight=100,this.lightBg=b("#uni-header").length&&h.convertStringyBoolean(b("#uni-header").attr("data-light-bg")),this.data=a.data||{},this.actionIndex=a.actionIndex,this.notificationsFetchTimeLimit=5e3,this.menuNotifications=[],this.notificationComponents=[],this._awaitingNotificationData=!1,d.prototype.init.call(this,b.extend({},this.defaults,a),e)},template:'      <li id="notifications-jewel" class="yj-header-menu-item yj-nav-menu--primary-actions-item yj-nav-menu--primary-actions-notifications" data-yj-tabname="notifications" data-qaid="notifications_button" title="'+i.t("notifications")+'">        <a href="{{notificationsUrl}}" data-qaid="nav_notifications_menu_button" data-speechtip="'+i.t("notifications")+'" role="button" aria-haspopup="true"            class="yj-nav-menu--primary-actions-link yj-nav-menu--primary-actions-notifications-link link yj-notifications-menu yj-simple-click-menu-trigger yj-meta-dropdown">          <span class="yj-header-navigation--jewel-text yj-acc-hidden">'+i.t("notifications")+'</span>          <span class="yamicon yamicon-rd_notifications yk-yamicon-m"></span>          {{{templateCountsHtml}}}        </a>        <div style="display:none" class="yj-notifications-menu-contents parent-nohover yj-click-menu yj-feed-notifications" data-keep-open-on-click="true" data-acc-menu-interaction-style="popup" data-qaid="notifications_dropdown_panel">          <div class="yj-notification-menu-heading" role="heading" aria-level="2">'+i.t("notifications")+'</div>          <div class="yj-notifications-menu-top"></div>          <div class="yj-notifications-menu-items-wrap"><ul class="yj-notifications-menu-items"></ul></div>          <div class="yj-notifications-menu-none yj-message-list-notice" style="display: none;">'+i.t("you_have_no_notifications")+'</div>          <a class="yj-notifications-menu-see-all yj-btn yj-btn-alt" href="{{notificationsUrl}}">'+i.t("see_all_notifications")+' <span class="right-arrow"></span></a>        </div>      </li>    ',defaults:{id:"notificationsMenu",children:[{id:"notificationMenuSpinner",type:e,target:".yj-notifications-menu-top:first"}]},templateCountsHtml:'<span class="yj-header-navigation--jewel-badge is-hidden yj-notifications-indicator-count" data-qaid="notifications_unread_count_label"></span>',templateTextHtml:'<a href="javascript://" class="header-menu-link yj-notifications-indicator-text">'+i.t("notifications_notifications_dropdown")+' <small class="yj-arrow yj-down-arrow">&#9660;</small></a>',prepViewData:function(){return{notificationsUrl:l.networkIndex(g.getCurrentNetwork())+"/#/notifications/index?type=notifications",templateCountsHtml:this.templateCountsHtml,templateTextHtml:this.templateTextHtml}},afterRender:function(){var a=this;b("#header-jewels-notifications").hide(),this.$counter=this.$element.find(".yj-notifications-indicator-count"),this.$counterNumber=this.$counter,this.$menuButton=this.$element.children("a"),this.$menuContents=this.$element.find(".yj-notifications-menu-contents"),this.$menuItems=this.$element.find(".yj-notifications-menu-items"),this.$menuItemsWrap=this.$element.find(".yj-notifications-menu-items-wrap"),this.$seeAllLink=this.$element.find(".yj-notifications-menu-see-all"),this.$noNotifications=this.$element.find(".yj-notifications-menu-none"),m.trigger("/ui/fixedheader/menu/init",this,this.defaults.id,this.$menuItems,this.$menuItemsWrap),yam.model.Count.getCounter("notifications").on("update",function(b){b&&c.isNumber(b)?a.$counter.text(b).removeClass("is-hidden"):(a.$counter.text("").addClass("is-hidden"),a.$element.removeClass("yj-has-count"))})},_onClick:function(a){var c=b(a.target).closest("a"),d=c.attr("href");d&&d.indexOf("javascript")<0&&!c.attr("data-action-onclick")&&!c.attr("data-action-onsubmit")&&(a.metaKey||this.$menuButton.trigger("close"))},observeDomEvents:function(){this.$menuContents.bind("menuOpen",this.onMenuOpen.bind(this)),this.$menuContents.bind("menuClose",this.onMenuClose.bind(this)),this.$menuContents.click(this._onClick.bind(this))},showMenu:function(){this.$element.children("a").click()},onMenuOpen:function(){this.scroller&&this.scroller.updateHeight(0),this.$element.addClass("yj-open"),this.prepRenderMenu(),this.unseenCount=yam.model.Count.getCounter("notifications").getCount();var a=this.unseenCount||3;a>40&&(a=40);var b=this.getNotificationStreamRequestData({count:a,mark_seen:!0});this._awaitingNotificationData||this.feedModel.fetch({data:b}),this.clearNotifications(),this._menuInitialized=!0,this._viewNeedsUpdate=!1,this.startResizeListeners()},onMenuClose:function(){this.$element.removeClass("yj-open"),this.stopResizeListeners()},startResizeListeners:function(){m.on("/gallery/spotlight/image/loaded",this._handleImageLoaded,this)},stopResizeListeners:function(){m.off("/gallery/spotlight/image/loaded",this._handleImageLoaded,this)},triggerResize:function(){m.trigger("/ui/fixedheader/menu/render",this.defaults.id,this.getFooterHeight())},_handleImageLoaded:function(a){a&&a.closest(".yj-notification-item").length&&this.triggerResize()},clearNotifications:function(){this.menuNotifications=[],this.feedModel.destroyRollups(),g.getCurrentNetwork()&&g.getCurrentNetwork().update({unseen_notification_count:0})},prepRenderMenu:function(){for(var a=0,b=this.notificationComponents.length;b>a;a++)this.notificationComponents[a].destroy(),this.notificationComponents[a]=null;this.notificationComponents=[],this.$menuItems.empty(),this.$seeAllLink.hide(),this.$noNotifications.hide(),this.getChild("notificationMenuSpinner").show()},renderMenu:function(a){this.getChild("notificationMenuSpinner").hide();var b=this.createMenuItems();0===b&&(b=this.createMenuItems(!0)),0===b?this.$noNotifications.show():a.val("meta.older_available")&&this.$seeAllLink.show(),this.triggerResize()},createMenuItems:function(a){for(var b={},d=0,e=this.menuNotifications.length;e>d;d++){var g=this.menuNotifications[d];if(g&&(a||g.unseen)){var h=g.category;null==b[h]&&(b[h]=0),b[h]++;var i=new f({data:g,firstInCategory:1===b[h]});this.notificationComponents.push(i),this.$menuItems.append(i.render())}}return c.reduce(b,function(a,b){b+=a},0)},getFooterHeight:function(){var a=this.$element.find("a.yj-notifications-menu-see-all").filter(":visible");return a.outerHeight(!0)||0},subscribeToData:function(){this.subscribeToPeekNotifications()},subscribeToPeekNotifications:function(){var a=this.getNotificationStreamRequestData({uisource:"peek"}),c=k.api("streams/notifications?"+j.paramify(a));this.feedModel=yam.model.Stream.findOrCreate({url:c}),this.listenTo(this.feedModel,"onBeforeRequest",function(){this._awaitingNotificationData=!0}.bind(this)),this.listenTo(this.feedModel,"onAfterProcess",function(a){this._awaitingNotificationData=!1,this.renderMenu(a),b(document).trigger("notificationsSeen")}.bind(this)),this.listenTo(n,"RollupStreamDelivery/"+this.feedModel.id+"/create",this.onPeekRollupCreate)},unsubscribeData:function(){this.stopListening()},onPeekRollupCreate:function(a){this.menuNotifications.push(a)},getNotificationStreamRequestData:function(a){return a=a||{},a.inbox_supported_client=!0,a},destroy:function(){d.prototype.destroy.call(this),c.each(this,function(a,b){0===b.indexOf("$")&&delete this[b]}),c.each(this.notificationComponents,function(a){a.destroy()}),this.data=null,this.menuNotifications=null,this.notificationComponents=null}})}),define("common-ui/lib/ui/keyboard/group_navigation_commands",["require","underscore","core/lib/treatment","common-ui/lib/ui/keyboard/keyboard_shortcuts","models/lib/model/helper/top_groups","models/group","core/lib/location_helper","common-ui/lib/ui/accessibility/screenreader_announcer","core/lib/urls"],function(a){var b=a("underscore"),c=a("core/lib/treatment"),d=a("common-ui/lib/ui/keyboard/keyboard_shortcuts"),e=a("models/lib/model/helper/top_groups"),f=a("models/group"),g=a("core/lib/location_helper"),h=a("common-ui/lib/ui/accessibility/screenreader_announcer"),i=a("core/lib/urls"),j={group_next:"_goNextGroup",group_prev:"_goPreviousGroup",group_next_unread:"_goNextUnreadGroup",go_all_company:"_goAllCompany"};return{init:function(){this.groupId=-1,c.treatment("keyboardshortcuts2")&&b.each(j,function(a,b){d.on(b,this[a],this)},this)},uninit:function(){d.off(null,null,this)},setGroupView:function(a){this.groupId=a},setAllCompanyView:function(){this.groupId="allcompany"},setHomeView:function(){this.groupId="home"},clearView:function(){this.groupId=-1},_goNextOrPreviousGroup:function(a){var b;if(-1===this.groupId||"home"===this.groupId||"allcompany"===this.groupId)b=e.getTopGroups()[0];else{var c=e.getIndexForGroup(this.groupId);-1!=c&&(b=e.getTopGroups()[c+a],b===f.ALL_COMPANY()&&(b=null))}return b?g.assign(i.groupIndex(b)):h.announceText(1==a?"No next group":"No previous group"),!1},_goNextGroup:function(){this._goNextOrPreviousGroup(1)},_goPreviousGroup:function(){this._goNextOrPreviousGroup(-1)},_goNextUnreadGroup:function(){var a;a="allcompany"===this.groupId?e.getNextGroupFromAllCompany():"home"===this.groupId||-1===this.groupId?e.getNextGroupFromHome():e.getNextGroupFromGroup(this.groupId),a?g.assign(i.groupIndex(a)):h.announceText("No next group with unread items")},_goAllCompany:function(){g.assign(i.groupIndex(f.ALL_COMPANY()))}}}),define("workfeed/lib/modules/tab_arranger",["require","jquery","core/lib/namespace","core/lib/treatment","core/lib/tr"],function(a){var b=a("jquery"),c=a("core/lib/namespace"),d=a("core/lib/treatment"),e=a("core/lib/tr");c.ns("yam.workfeed"),yam.workfeed.tabArranger=function(a){var c=a||{},f=c.maxTabs||5,g=b(".yj-action-bar-tabs>ul"),h=b(".yj-action-bar-tabs>ul>li"),i=b('<ul class="yj-tab-dropdown yj-menu yj-menu-shadow yj-click-menu yj-click-menu-content" >'),j=b('<li class="yj-tab-more yj-filter-tab yj-click-menu-trigger" data-attach-menu="true">'),k=h.length<f+2,l=e.t("more_2")+' <small class="yj-down-arrow" aria-hidden="true">&#9660;</small>';d.treatment("tow_header_standardization")&&(l='<span class="yamicon yamicon-ellipsis yk-yamicon-m"></span>');var m=b('<a href="javascript://" class="yj-filter-tab-link" role="button" aria-haspopup="true">'+l+"</a>");h.each(function(a){var c=b(this);a!=f||k||(g.append(j),j.append(m).append(i)),f>a||k?c.show():(c.detach().show().appendTo(i),c.removeClass("yj-filter-tab"),c.addClass("yj-tab-dropdown-item"),c.find("a").removeClass("yj-filter-tab-link"),c.find("a").addClass("yj-tab-dropdown-link"))}),i.children("li:first").addClass("yj-first").end().children("li:last").addClass("yj-last")}}),define("css!common-ui/lib/ui/groups/group_search",[],function(){}),define("stache!common-ui/lib/ui/groups/group_search",["mustache"],function(a){var b='<label>\n  <span class="yj-group-search--yamicon yamicon yamicon-rd_search yk-yamicon-m yj-dark-gray-light"></span>\n  <span class="yj-acc-hidden">{{placeholder}}</span>\n  <input type="text" class="yj-group-search--input" data-qaid="group_search_field" maxlength="500">\n</label>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/groups/group_search",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/location_helper","core/lib/report","core/lib/tr","core/lib/uri_helper","core/lib/yammer_uri","jquery-watermark","css!./group_search","html!./group_search"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/location_helper"),f=a("core/lib/report"),g=a("core/lib/tr"),h=a("core/lib/uri_helper"),i=a("core/lib/yammer_uri");
a("jquery-watermark"),a("css!./group_search");var j=g.t("search_this_group"),k={search_source:"group"};return c.extend({mixins:[d],className:"yj-group-search",events:{"keydown input":"_keyHandler","click input":"_clickHandler"},template:a("html!./group_search"),initialize:function(a){this._searchParameters=b.extend(k,a.searchParameters)},getTemplateData:function(){return{placeholder:j}},render:function(){return this._setPlaceholder(),this},_setPlaceholder:function(){this.$el.find(".yj-group-search--input").watermark(j)},_keyHandler:function(a){var b;13===a.which&&(a.preventDefault(),b=this.$(".yj-group-search--input").val(),/\S/.test(b)&&this._performSearch({search:b}))},_performSearch:function(a){f.event("group_search_submit");var c=h.paramify(b.extend(this._searchParameters,a));yam.router?yam.router.navigate("/Threads/Search?"+c,{trigger:!0}):e.assign(i.app()+"/#/Threads/Search?"+c)},_clickHandler:function(){f.event("group_search_start")}})}),define("css!workfeed/lib/app/views/top_spammers/top_spammers",[],function(){}),define("stache!workfeed/lib/app/views/top_spammers/top_spammers",["mustache"],function(a){var b='<span class="yj-inline-spinner"></span>\n{{#hasSuccess}}\n  {{#isNetworkBlocked}}\n    <div class="yj-top-spammers">\n      <p class="yj-top-spammers--network-blocked">\n        {{network_blocked_text}}\n      </p>\n    </div>\n  {{/isNetworkBlocked}}\n  {{#hasSpammers}}\n    <table class="yj-top-spammers">\n      <thead>\n        <tr>\n          <th>{{full_name_title}}</th>\n          <th>{{reported_count_title}}</th>\n          <th>{{action_title}}</th>\n        </tr>\n      </thead>\n      <tbody>\n        {{#top_spammers}}\n          <tr class="yj-top-spammers--spammer {{getSpammerStateClass}}">\n            <td class="yj-top-spammers yj-top-spammers--name">\n              <a href="{{getProfileLink}}">{{full_name}}</a>\n            </td>\n            <td class="yj-top-spammers yj-top-spammers--count">\n              {{count}}\n            </td>\n            <td class="yj-top-spammers yj-top-spammers--action">\n              {{^isSuspended}}\n                <a href="#" role="button" data-user-id="{{id}}" class="yj-top-spammers--block" data-user-email="{{email}}">{{block_label}}</a>\n              {{/isSuspended}}\n              {{#isSuspended}}\n                <a href="#" role="button" data-user-id="{{id}}" class="yj-top-spammers--unblock" data-user-email="{{email}}">{{unblock_label}}</a>\n              {{/isSuspended}}\n            </td>\n          </tr>\n        {{/top_spammers}}\n      </tbody>\n    </table>\n  {{/hasSpammers}}\n  {{^hasSpammers}}\n    <div class="yj-top-spammers yj-top-spammers--no-spammers">\n      <p>\n        {{no_spammers_text}}\n      </p>\n    </div>\n  {{/hasSpammers}}\n{{/hasSuccess}}\n{{#hasError}}\n  <div class="yj-top-spammers yj-top-spammers--error-state">\n    <p>\n      {{{load_spammers_error_text}}}\n    </p>\n  </div>\n{{/hasError}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/top_spammers/index",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/tr","core/lib/backbone_with_auto_render","backbone","core/lib/yammer_api","core/lib/yammer_uri","css!./top_spammers","html!./top_spammers"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/tr"),f=a("core/lib/backbone_with_auto_render"),g=a("backbone"),h=a("core/lib/yammer_api"),i=a("core/lib/yammer_uri");a("css!./top_spammers");var j="success",k="error",l={full_name_title:e.t("top_spammers_full_name_title"),reported_count_title:e.t("top_spammers_reported_count_title"),action_title:e.t("top_spammers_action_title"),block_label:e.t("top_spammers_block_label"),unblock_label:e.t("top_spammers_unblock_label"),suspended_label:e.t("top_spammers_blocked_label"),no_spammers_text:e.t("top_spammers_no_spammers"),load_spammers_error_text:e.t("top_spammers_load_error",{link:{1:"#"}}),network_blocked_text:e.t("top_spammers_network_blocked"),getSpammerStateClass:function(){return"suspended"===this.state?"yj-top-spammers--suspended":""},isSuspended:function(){return"suspended"===this.state},hasSpammers:function(){return this.top_spammers&&this.top_spammers.length>0},hasSuccess:function(){return this.state===j},hasError:function(){return this.state===k},getProfileLink:function(){return i.app("users/"+this.name)},isNetworkBlocked:function(){return"blocked"===this.network_state}};return d.extend({mixins:[f],el:"#top-spammers",events:{"click .yj-top-spammers--action .yj-top-spammers--block":"_blockUser","click .yj-top-spammers--action .yj-top-spammers--unblock":"_unblockUser","click .yj-top-spammers--error-state a":"getTopSpammers"},template:a("html!./top_spammers"),initialize:function(){c.bindAll(this,"_getSpammersSuccess","_getSpammersError","_blockUser","_blockUserSuccess","_blockUserError","_unblockUser","_unblockUserSuccess","_unblockUserError"),this.render()},render:function(){this._addHovercards()},getTemplateData:function(){return c.extend({},this.templateData,l)},getTopSpammers:function(a){a&&a.preventDefault(),this._showSpinnerAndHideOthers(),h.getTopSpammers().then(this._getSpammersSuccess,this._getSpammersError)},_showSpinnerAndHideOthers:function(){this.$(".yj-top-spammers").remove(),this.$(".yj-inline-spinner").show()},_hideSpinner:function(){this.$(".yj-inline-spinner").hide()},_getSpammersSuccess:function(a){this.templateData=c.extend({},{state:j},a),this.render(),this._hideSpinner()},_getSpammersError:function(){this.templateData=c.extend({},{state:k}),this.render(),this._hideSpinner()},_blockUser:function(a){var c=b(a.target).data("user-id");h.blockSpammer({user_id:c}).then(this._blockUserSuccess,this._blockUserError)},_unblockUser:function(a){var c=b(a.target).data("user-id");h.unblockSpammer({user_id:c}).then(this._unblockUserSuccess,this._unblockUserError)},_informUserAndReload:function(a,b){this.getTopSpammers(),g.trigger("/ui/alert/show",a,e.t(b))},_blockUserSuccess:function(){this._informUserAndReload("notice","top_spammers_block_user_success")},_blockUserError:function(){this._informUserAndReload("error","top_spammers_block_user_error")},_unblockUserSuccess:function(){this._informUserAndReload("notice","top_spammers_unblock_user_success")},_unblockUserError:function(){this._informUserAndReload("error","top_spammers_unblock_user_error")},_addHovercards:function(){var a,d,e,f=this.$(".yj-top-spammers--spammer");c.each(f,function(c){e=b(c),d=e.find(".yj-top-spammers--name a"),a=e.find(".yj-top-spammers--action a").data("user-id"),g.trigger("/ui/hovercard/add",d,{id:a,type:"user",orientation:"bottom"})})}})}),define("workfeed/lib/app/bundles/global_ui_bundle",["require","jquery","common-ui/lib/ui/general/lightbox_manager","common-ui/lib/ui/general/flash_alert","common-ui/lib/ui/general/click_menu","common-ui/lib/ui/general/refresh_countdown","common-ui/lib/ui/general/refresh_treatment_meta_data","common-ui/lib/ui/hovercards/hovercard_manager","feeds/lib/ui/shared/network_switcher","feeds/lib/ui/shared/group_navigator","feeds/lib/ui/attachments/fancy_lightbox_manager","workfeed/lib/app/add_enhanced_tooltip","workfeed/lib/modules/link_to_helper","workfeed/lib/init_ui","common-ui/lib/ui/accessibility/focuswithin","common-ui/lib/ui/accessibility/heading_navigation","common-ui/lib/ui/accessibility/speechtips","models/lib/client/realtime_actions_client","workfeed/lib/simple_click_menu","feeds/lib/ui/notifications/notification_menu","common-ui/lib/ui/keyboard/group_navigation_commands","core/lib/treatment","workfeed/lib/modules/tab_arranger","common-ui/lib/ui/groups/group_search","workfeed/lib/app/views/top_spammers/index"],function(a){"use strict";var b=a("jquery"),c=a("common-ui/lib/ui/general/lightbox_manager"),d=a("common-ui/lib/ui/general/flash_alert"),e=a("common-ui/lib/ui/general/click_menu"),f=a("common-ui/lib/ui/general/refresh_countdown"),g=a("common-ui/lib/ui/general/refresh_treatment_meta_data"),h=a("common-ui/lib/ui/hovercards/hovercard_manager"),i=a("feeds/lib/ui/shared/network_switcher"),j=a("feeds/lib/ui/shared/group_navigator"),k=a("feeds/lib/ui/attachments/fancy_lightbox_manager"),l=a("workfeed/lib/app/add_enhanced_tooltip"),m=a("workfeed/lib/modules/link_to_helper"),n=a("workfeed/lib/init_ui"),o=a("common-ui/lib/ui/accessibility/focuswithin"),p=a("common-ui/lib/ui/accessibility/heading_navigation"),q=a("common-ui/lib/ui/accessibility/speechtips"),r=a("models/lib/client/realtime_actions_client"),s=a("workfeed/lib/simple_click_menu"),t=a("feeds/lib/ui/notifications/notification_menu"),u=a("common-ui/lib/ui/keyboard/group_navigation_commands"),v=a("core/lib/treatment");return a("workfeed/lib/modules/tab_arranger"),a("common-ui/lib/ui/groups/group_search"),a("workfeed/lib/app/views/top_spammers/index"),{run:function(){o(),p(),q.init(),u.init(),n.init(),b(function(){v.treatment("tow_header_standardization")&&b("body").addClass("tow-header-standardization");var a=b(".yj-left-nav-backbone");l(),new r({}).start(),new i,new d,new e,new f,new g,new k,new h,new m,0!==a.length&&new j({target:a}).render().el,b("body").append(new c({target:"body",id:"lightboxManager"}).render());var n="replaceWith",o=new t({target:"#notifications-jewel",replaceTarget:!0});b(o.target)[n](o.render()),s.bindClickMenu()})}}}),define("stache!components/masthead/src/masthead",["mustache"],function(a){var b='{{!\nThese styles depend on values that live in the model. Instead of trying to deal\nwith pseudoselectors and vendor prefixes inside the component, the styles live\nhere as part of the template. Even though the `style` tag lives outside of the\n`head`, browsers will still parse it.\n}}\n<style>\n  .yj-masthead--background {\n    background-color: #{{hex_color}};\n  }\n  {{#banner_url}}\n    .yj-masthead--banner {\n      background-image: url(\'{{{banner_url}}}\');\n    }\n    .yj-masthead--wrapper::before {\n      background: -webkit-linear-gradient(left, rgb({{rgb_color}}) 50%, rgba({{rgb_color}},0));\n      background: linear-gradient(to right, rgb({{rgb_color}}) 50%, rgba({{rgb_color}},0));\n    }\n    .yj-masthead--wrapper::after {\n      background: -webkit-linear-gradient(right, rgb({{rgb_color}}) 50%, rgba({{rgb_color}},0));\n      background: linear-gradient(to left, rgb({{rgb_color}}) 50%, rgba({{rgb_color}},0));\n    }\n    .yj-masthead--wrapper .before {\n      -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=1,startColorstr=\'#{{hex_color}}\', endColorstr=\'#00{{hex_color}}\')";\n    }\n    .yj-masthead--wrapper .after {\n      -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=1,startColorstr=\'#00{{hex_color}}\', endColorstr=\'#{{hex_color}}\')";\n    }\n  {{/banner_url}}\n</style>\n\n<div class="yj-masthead--background">\n  <div class="yj-masthead--banner {{#show_text}}yj-masthead--hide-banner{{/show_text}}" data-qaid="masthead_background_container">\n    <div class="yj-masthead--wrapper {{#show_text}}yj-masthead--show-text{{/show_text}} {{#is_dark}}is-dark{{/is_dark}}">\n      <!--[if lt IE 10]>\n        <div class="before"></div>\n        <div class="after"></div>\n      <![endif]-->\n      <div class="yj-masthead--inner">\n        <h1 class="yj-masthead--logo">\n          <a class="yj-masthead--link" href="{{networkUrl}}">\n            {{#show_text}}\n              <img class="yj-masthead--yammer-logo" src="{{yammer_logo_url}}" alt="{{name}}" />\n              {{name}}\n            {{/show_text}}\n            {{^show_text}}\n              {{#logo_url}}\n                <img class="yj-masthead--image" src="{{logo_url}}" alt="{{name}}" data-qaid="network_logo_image" />\n              {{/logo_url}}\n            {{/show_text}}\n          </a>\n        </h1>\n      </div>\n    </div>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/masthead/src/masthead",[],function(){}),define("components/masthead/src/masthead",["require","core/lib/session","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/urls","core/lib/yammer_uri","html!./masthead","css!./masthead"],function(a){"use strict";var b=a("core/lib/session"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/urls"),f=a("core/lib/yammer_uri"),g=a("html!./masthead");a("css!./masthead");var h=c.extend({mixins:[d],className:"yj-masthead zindex-t35",template:g,getTemplateData:function(){var a=b.getCurrentNetwork(),c=this._parseColor(a.masthead_color||"#000000"),d=!!a.masthead_is_dark,g=f.cdn("assets/images/yamlogo-masthead-darkbg.png"),h=f.cdn("assets/images/yamlogo-masthead-lightbg.png"),i=d?g:h,j=a.masthead_logo_visible&&a.masthead_logo_url,k=a.masthead_banner_visible&&a.masthead_banner_url,l=e.networkIndex(a);return l.lastIndexOf("/")!==l.length-1&&(l+="/"),{name:a.name,networkUrl:l,hex_color:this._getHexColor(c),rgb_color:this._getRgbColor(c),is_dark:d,yammer_logo_url:i,logo_url:j,banner_url:k,show_text:!j&&!k}},_parseColor:function(a){var b=a.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i)||[];return{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}},_getHexColor:function(a){return((1<<24)+(a.r<<16)+(a.g<<8)+a.b).toString(16).slice(1)},_getRgbColor:function(a){return a.r+","+a.g+","+a.b}});return h}),define("components/masthead/index",["require","./src/masthead"],function(a){"use strict";var b=a("./src/masthead");return b}),define("stache!components/alert_placeholders/src/alert_placeholders",["mustache"],function(a){var b='<div role="alert" id="yj-error-acc" class="yk-acc-hidden" style="display: none;">\n  {{error_label}}\n</div>\n<div id="yj-error" style="display: none;" class="yj-alert yj-error">\n  <span class="alert-icon yamicon yamicon-danger">\n    <span class="yk-acc-hidden">{{error_label}} </span>\n  </span>\n  <p class="alert-content"></p>\n  <a href="javascript://" role="button" class="alert-close yamicon yamicon-x">\n    <span class="yk-acc-hidden">{{close_label}}</span>\n  </a>\n</div>\n<div role="alert" id="yj-notice-acc" class="yk-acc-hidden" style="display: none;">\n  {{notice_label}}\n</div>\n<div id="yj-notice" style="display: none;" class="yj-alert yj-notice">\n  <span class="alert-icon yamicon yamicon-circle-check yj-green">\n    <span class="yk-acc-hidden">{{notice_label}} </span>\n  </span>\n  <p class="alert-content"></p>\n  <a href="javascript://" role="button" class="alert-close yamicon yamicon-x">\n    <span class="yk-acc-hidden">{{close_label}}</span>\n  </a>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/alert_placeholders/src/alert_placeholders",["require","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./alert_placeholders"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("html!./alert_placeholders"),f={error_label:b.t("alerts_error"),notice_label:b.t("alerts_notice"),close_label:b.t("close")},g=c.extend({mixins:[d],className:"zindex-t4",template:e,getTemplateData:function(){return f}});return g}),define("components/alert_placeholders/index",["require","./src/alert_placeholders"],function(a){"use strict";return a("./src/alert_placeholders")}),define("stache!components/admin/src/private_content_mode_banner",["mustache"],function(a){var b='<div class="yj-private-content-mode-banner-content">\n  <div class="yj-private-content-mode-banner-text">{{private_content_mode_label}}</div>\n  <button class="yj-btn yj-btn-alt yj-exit-private-content-mode-btn" type="button">{{stop_button_label}}</button>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/admin/src/private_content_mode_banner",[],function(){}),define("components/admin/src/private_content_mode_banner",["require","underscore","core/lib/tr","core/lib/session","backbone","core/lib/yammer_api","core/lib/location_helper","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./private_content_mode_banner","css!./private_content_mode_banner"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("backbone"),f=a("core/lib/yammer_api"),g=a("core/lib/location_helper"),h=a("core/lib/backbone_base_view"),i=a("core/lib/backbone_with_auto_render"),j=a("html!./private_content_mode_banner");a("css!./private_content_mode_banner");var k={private_content_mode_label:c.t("private_content_mode_banner_text"),stop_button_label:c.t("private_content_mode_stop_button")};return h.extend({mixins:[i],template:j,className:"yj-private-content-mode-banner",events:{"click .yj-exit-private-content-mode-btn":"_turnOff"},initialize:function(){$("body").addClass("private-content-mode"),$(window).trigger("resize.stickyNav"),this.user=d.getCurrentUser(),this.listenTo(e,"/ui/stop_private_content_mode",this.remove)},getTemplateData:function(){return b.extend({},k)},remove:function(){return $("body").removeClass("private-content-mode"),$(window).trigger("resize.stickyNav"),h.prototype.remove.call(this)},_turnOff:function(){f.setPrivateContentMode({enabled:!1}).then(this._onSuccess.bind(this),this._onError.bind(this))},_onSuccess:function(){e.trigger("/ui/alert/show","notice",c.t("private_content_mode_disabled")),g.reload()},_onError:function(){e.trigger("/ui/alert/error","error",c.t("there_was_an_error"))}})}),define("stache!workfeed/lib/app/components/skiplink",["mustache"],function(a){var b='<a href="{{screenreader_url}}">{{screenreader_label}}</a>\n<br/>\n<a href="javascript:void(0)" role="button">{{skiplink_label}}</a>\n<br/>\n<span aria-hidden="true">{{keyboard_label}}</span>\n<span class="yj-acc-hidden">{{keyboard_alt_label}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/components/skiplink",[],function(){}),define("workfeed/lib/app/components/skiplink",["require","jquery","underscore","core/lib/tr","common-ui/lib/ui/accessibility/traversal_util","common-ui/lib/ui/accessibility/menu_accessibility","common-ui/lib/ui/accessibility/lightbox_accessibility","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./skiplink","css!./skiplink"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/tr"),e=a("common-ui/lib/ui/accessibility/traversal_util"),f=a("common-ui/lib/ui/accessibility/menu_accessibility"),g=a("common-ui/lib/ui/accessibility/lightbox_accessibility"),h=a("core/lib/backbone_base_view"),i=a("core/lib/backbone_with_auto_render"),j=a("html!./skiplink");a("css!./skiplink");var k={screenreader_label:d.t("accessibility_screenreader_help"),skiplink_label:d.t("accessibility_skiplink"),keyboard_label:d.t("accessibility_keyboard"),keyboard_alt_label:d.t("accessibility_keyboard_alt")},l=h.extend({mixins:[i],template:j,className:"yj-skiplink yj-acc-hidden zindex-t4",events:{"focus a":"_onFocus","blur a":"_onBlur","click a":"_onClick"},getTemplateData:function(){return c.extend({screenreader_url:"http://office.microsoft.com/en-us/office365-sharepoint-online-enterprise-help/use-yammer-with-a-screen-reader-HA104164005.aspx"},k)},_onFocus:function(){f.isMenuPresent()||g.isModalPresent()||this.$el.removeClass("yj-acc-hidden")},_onBlur:function(){this.$el.addClass("yj-acc-hidden")},_onClick:function(){var a=b("*[role=main]")[0];a&&e.focusFirstTabbableWithin(a)}});return l}),define("workfeed/lib/modules/static_header",["require","jquery","core/lib/ctor","common-ui/lib/ui/shared/scroller","backbone"],function(a){var b=a("jquery"),c=a("core/lib/ctor"),d=a("common-ui/lib/ui/shared/scroller"),e=a("backbone"),f=16;c("yam.workfeed.staticheader.Menu",{init:function(a,b,c){this.componentInstance=a,this.$component=b,this.$menuContentsWrap=c,this.availableMenuHeight=null,this.$component.resize(this.attachScroller.bind(this))},handleRender:function(a,c){this.availableMenuHeight=this.calculateAvailableHeight(b(window),a,c),this.attachScroller()},calculateAvailableHeight:function(a,b,c){b=parseInt(b,10)||0,c=parseInt(c,10)||0;var d=this.$menuContentsWrap.offset().top-a.scrollTop(),e=a.height()-d-b-f;return e=Math.max(0,e),c&&c>e&&(e=c),e},attachScroller:function(){var a="scrollHide",b=this.$component.outerHeight();b>this.availableMenuHeight?(this.componentInstance.scroller||(this.componentInstance.scroller=d(this.$component,this.availableMenuHeight)),this.componentInstance.scroller.updateHeight(this.availableMenuHeight),this.componentInstance.scroller.calculate(),this.$menuContentsWrap.removeClass(a)):this.componentInstance.scroller&&(this.$menuContentsWrap.addClass(a),this.componentInstance.scroller.updateHeight(b)),this.componentInstance&&this.componentInstance.scroller&&this.componentInstance.scroller.scrollToTop()}});var g={};return yam.workfeed.staticheader.init=function(){e.on("/ui/fixedheader/menu/init",function(a,b,c,d){if(g[b])throw new Error("Static Header: duplicate node entry");g[b]=new yam.workfeed.staticheader.Menu(a,c,d)},this),e.on("/ui/fixedheader/menu/render",function(a,b,c){g[a].handleRender(b,c)},this)},yam.workfeed.staticheader}),define("workfeed/lib/header",["require","jquery","backbone","core/lib/session"],function(a){var b=a("jquery"),c=a("backbone"),d=a("core/lib/session");b(function(a){var b=a(document.body),e=a("[data-yj-component=header-navbar]").first(),f=a(".page-content"),g=function(){e.addClass("topnav-fixed"),f.addClass("pushed-down")};c.on("/ui/masthead/load/finish",function(){b.addClass("suite-nav suite-nav-sticky");var a=d.getCurrentNetwork().is_primary;b.toggleClass("primary-network",a),b.toggleClass("guest-network",!a),b.hasClass("fixed-header")&&g()}),c.on("/ui/masthead/fallback",function(){a("#suite-nav").remove(),b.removeClass("suite-nav suite-nav-sticky"),a("#masthead-container").show()})})}),define("workfeed/lib/app/bundles/header_bundle",["require","jquery","core/lib/session","components/masthead/index","components/alert_placeholders/index","components/admin/src/private_content_mode_banner","workfeed/lib/app/components/skiplink","workfeed/lib/modules/static_header","models/helpers/user","workfeed/lib/header"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/session"),d=a("components/masthead/index"),e=a("components/alert_placeholders/index"),f=a("components/admin/src/private_content_mode_banner"),g=a("workfeed/lib/app/components/skiplink"),h=a("workfeed/lib/modules/static_header"),i=a("models/helpers/user");return a("workfeed/lib/header"),{run:function(){this._initStaticHeader(),this._initSkiplink(),this._initAlerts(),this._initMasthead(),i.isSupervisorAdmin(c.getCurrentUser())&&this._initPrivateContentModeBanner()},_initStaticHeader:function(){h.init()},_initMasthead:function(){var a=new d;b("#masthead-container").replaceWith(a.render().$el)},_initPrivateContentModeBanner:function(){var a=new f;b("#header-container").append(a.render().$el)},_initSkiplink:function(){var a=new g;b("#skiplink-container").replaceWith(a.render().$el)},_initAlerts:function(){var a=new e,c=b("#alerts-container");c.is(":empty")&&c.replaceWith(a.render().$el)}}}),define("stache!components/browse_groups/src/browse_groups",["mustache"],function(a){var b='{{#showSpinner}}\n  <div class=\'yj-browse-groups--fetching\'>\n    <Spinner key="spinner" />\n  </div>\n{{/showSpinner}}\n\n{{^showSpinner}}\n  {{#hasCollection}}\n  <div class=\'yj-browse-groups--list\'>\n    {{#groups}}\n      <GroupView key="{{.}}" />\n    {{/groups}}\n\n    {{#mockGroups}}\n      <MockGroupView key="{{.}}" />\n    {{/mockGroups}}\n\n    <div class=\'yj-browse-groups--still-fetching\'>\n      {{#showSpinnerUntilSecondFetch}}\n        <Spinner key="spinner" />\n      {{/showSpinnerUntilSecondFetch}}\n    </div>\n  </div>\n  {{/hasCollection}}\n\n  {{^hasCollection}}\n    <NoSuggestionsView key="noSuggestions" />\n  {{/hasCollection}}\n{{/showSpinner}}';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!components/browse_groups/src/group",["mustache"],function(a){var b='<div class=\'yj-browse-groups--info\'>\n  <div class=\'yj-browse-groups--image\'>\n      <ImageView key="image" />\n  </div><DescriptionView key="description" />\n</div>\n\n<div class="yj-browse-groups--membership">\n  {{#isMember}}\n      <LeaveButtonView key="leave"/>\n  {{/isMember}}\n  {{^isMember}}\n    <JoinButtonView key="join"/>\n  {{/isMember}}\n</div>\n\n<DeclineButtonView key="decline" />\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!components/browse_groups/src/description",["mustache"],function(a){var b='<h3 class="yj-description-view--title" role="heading" aria-level="2">\n  <a href="{{ link }}">\n    {{name}}\n  </a>\n</h3>\n{{#description}}\n  <p class="yj-description-view--description">{{description}}</p>\n{{/description}}\n<p class="yj-description-view--members">{{members}}</p>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/browse_groups/src/description",[],function(){}),define("components/browse_groups/src/description",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","html!./description","backbone","core/lib/report","core/lib/urls","css!./description"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("html!./description"),f=a("backbone"),g=a("core/lib/report"),h=a("core/lib/urls");return a("css!./description"),b.extend({mixins:[c],className:"yj-browse-groups--description",template:e,events:{"click .yj-description-view--title":"_clickHandler"},_clickHandler:function(){g.event("group_suggestions_group_name_navigate",{group_id:this.model.get("id")}),f.trigger("/ui/lightbox/close")},getTemplateData:function(){return{name:this.model.get("full_name"),description:this.model.get("description"),members:d.t("count_members",{count:this.model.get("stats").members}),privacy:this.model.get("privacy"),link:h.groupIndex(this.model)}}})}),define("stache!components/browse_groups/src/join_button",["mustache"],function(a){var b="{{join}}";return a.parse(b),function(c){return a.render(b,c)}}),define("components/browse_groups/src/join_button",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","collections/group_memberships","backbone","core/lib/session","core/lib/tr","html!./join_button","css!./description"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("collections/group_memberships"),e=a("backbone"),f=a("core/lib/session"),g=a("core/lib/tr"),h=a("html!./join_button");return a("css!./description"),c.extend({mixins:[b],tagName:"button",className:"yj-browse-groups--join-group yj-btn",template:h,events:{click:"_clickHandlerJoin"},getTemplateData:function(){return{join:g.t("join")}},_clickHandlerJoin:function(){this.model.join({success:this._handleMembershipCreate.bind(this),error:this._handleMembershipError,data:{group_id:this.model.id,bfr_source:"suggested_groups_lightbox",bfr_section:"suggested_groups_lightbox",bfr_event:"group_joined"}});var a=g.t("you_have_joined_the_name_group",{name:this.model.get("full_name")});e.trigger("/ui/alert/show","notice",a)},_handleMembershipCreate:function(){var a={user_id:f.getCurrentUser().id,group_id:this.model.id};d.add(a),this.remove()},_handleMembershipError:function(){e.trigger("/ui/alert/show","error",g.t("there_was_an_error_joining_this_group"))}})}),define("stache!components/browse_groups/src/leave_button",["mustache"],function(a){var b='<div class="yj-browse-groups--joined-button">\n  <span class="yamicon yamicon-checkmark yj-green yamicon-xxx-small yamicon-inline"></span>\n  <a href="javascript://" class="yj-browse-groups--joined-button-text" role="button">{{joined}}</a>\n</div>\n<div  class="yj-browse-groups--leave-button">\n  <span class="yamicon yamicon-dash yamicon-xxx-small yamicon-inline"></span>\n  <a href="javascript://" class="yj-browse-groups--leave-button yj-browse-groups--leave-text" role="button">{{leave}}</a>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("components/browse_groups/src/leave_button",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","collections/group_memberships","backbone","core/lib/tr","html!./leave_button","core/lib/session","css!./description"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("collections/group_memberships"),e=a("backbone"),f=a("core/lib/tr"),g=a("html!./leave_button"),h=a("core/lib/session");return a("css!./description"),c.extend({mixins:[b],className:"yj-browse-groups--leave-group",template:g,events:{click:"_clickHandlerLeave"},getTemplateData:function(){return{joined:f.t("joined"),leave:f.t("leave")}},_clickHandlerLeave:function(){this.model.id&&(this.model.leave({success:this._handleMembershipDestroy.bind(this),error:this._handleMembershipError,data:{group_id:this.model.id}}),e.trigger("/ui/alert/show","notice",f.t("you_have_left_this_group")))},_handleMembershipDestroy:function(){var a={user_id:h.getCurrentUser().id,group_id:this.model.id},b=d.findWhere(a);b&&b.destroy()},_handleMembershipError:function(){e.trigger("/ui/alert/show","error",f.t("there_was_an_error_leaving_this_group"))}})}),define("stache!components/browse_groups/src/image",["mustache"],function(a){var b='<img alt="" src="{{image}}">';return a.parse(b),function(c){return a.render(b,c)}}),define("components/browse_groups/src/image",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./image"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("html!./image");return b.extend({mixins:[c],className:"yj-browse-groups--image",template:d,getTemplateData:function(){return{image:this.model.get("mugshot_url").replace("48x48","88x88")}}})}),define("stache!components/browse_groups/src/decline_button",["mustache"],function(a){var b='<span class="yamicon yamicon-x yamicon-xx-small">\n  <span class="yj-acc-hidden">{{ accTip }}</span>\n</span>';return a.parse(b),function(c){return a.render(b,c)}}),define("components/browse_groups/src/decline_button",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","backbone","html!./decline_button","core/lib/tr"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("backbone"),e=a("html!./decline_button"),f=a("core/lib/tr");return c.extend({mixins:[b],template:e,tagName:"button",className:"yj-browse-groups--remove unstyle-button-as-span",attributes:{"data-speechtip":""},events:{click:"_handleClick"},getTemplateData:function(){return{accTip:f.t("dismiss")}},_handleClick:function(){if(this.model.id){var a={data:{source:"suggested-groups-lightbox",section:"suggested-groups-lightbox",id:this.model.id},success:this._declineSuccess.bind(this),error:this._declineError};this.model.decline(a)}else this._declineSuccess()},_declineSuccess:function(){this.model.trigger("destroy",this.model)},_declineError:function(){d.trigger("/ui/alert/show","error",f.t("error_please_try_again_later"))}})}),define("css!components/browse_groups/src/group",[],function(){}),define("components/browse_groups/src/group",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!./group","./description","./join_button","./leave_button","./image","./decline_button","backbone","core/lib/urls","css!./group"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("html!./group"),g=a("./description"),h=a("./join_button"),i=a("./leave_button"),j=a("./image"),k=a("./decline_button"),l=a("backbone"),m=a("core/lib/urls");return a("css!./group"),c.extend({mixins:[d,e],className:"yj-browse-groups--group yj-want-focuswithin",template:f,views:{ImageView:"_getImageView",DescriptionView:"_getDescriptionView",JoinButtonView:"_getJoinView",LeaveButtonView:"_getLeaveView",DeclineButtonView:"_getDeclineButtonView"
},events:{"click .yj-browse-groups--membership":"_toggleView","click .yj-browse-groups--info":"_clickHandler"},_clickHandler:function(){window.location=m.groupIndex(this.model),l.trigger("/ui/lightbox/close")},initialize:function(){this.listenTo(this.model,"destroy",this.remove),this.isMember=!1},_getImageView:function(){return new j(this.options)},_getDescriptionView:function(){return new g(this.options)},getTemplateData:function(){var a=this.model.get("featured_users");return{link:m.groupIndex(this.model),isMember:this.isMember,hasUsers:a.length>0,users:b.map(a,function(a){return{id:a.id}})}},_toggleView:function(){this.isMember=!this.isMember,this.render()},_getLeaveView:function(){return new i({model:this.model})},_getJoinView:function(){return new h({model:this.model})},_getDeclineButtonView:function(){return new k({model:this.model})}})}),define("stache!components/browse_groups/src/mock_group",["mustache"],function(a){var b='<ImageView key="image"/>\n<MockCreateButtonView key="join"/>\n<DeclineButtonView key="decline" />';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!components/browse_groups/src/mock_create",["mustache"],function(a){var b='<div class="yj-browse-groups--mock-description">\n  {{#webURL}}\n    <h3 role="heading" aria-level="2">\n      <a href="{{ webURL }}"> {{name}} </a>\n    </h3>\n  {{/webURL}}\n  {{^webURL}}\n    <h3 role="heading" aria-level="2"> {{name}} </h3>\n  {{/webURL}}\n</div>\n<div class = \'yj-browse-groups--membership\'>\n{{#isCreated}}\n  <span class="yamicon yamicon-checkmark yj-green yamicon-xxx-small yamicon-inline"></span>\n  {{created}}\n{{/isCreated}}\n{{^isCreated}}\n  <button class="yj-sug-follow yj-btn yj-browse-groups--create-mock-group" data-action="createGroup">{{create}}</button>\n{{/isCreated}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/browse_groups/src/mock_create",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","collections/group_memberships","backbone","core/lib/session","core/lib/tr","html!./mock_create","css!./group"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("collections/group_memberships"),e=a("backbone"),f=a("core/lib/session"),g=a("core/lib/tr"),h=a("html!./mock_create");return a("css!./group"),b.extend({mixins:[c],className:"yj-browse-groups--mock-info",template:h,events:{"click .yj-browse-groups--create-mock-group":"_mockGroupCreate"},initialize:function(){this.isCreated=!1,this.web_url=""},getTemplateData:function(){return{isCreated:this.isCreated,create:g.t("create_group"),created:g.t("created"),name:this.model.get("full_name"),webURL:this.web_url}},_mockGroupCreate:function(){this.model.create({success:this._handleMembershipCreate.bind(this),error:this._handleMembershipError.bind(this),event_source:"suggested_groups_lightbox",event_action:"group_joined"}),this.isCreated=!0,this.render()},_handleMembershipCreate:function(a){var b={user_id:f.getCurrentUser().id,group_id:a.payload.group.id};this.web_url=a.redirect,d.add(b),this.render()},_handleMembershipError:function(){this.isCreated=!1,this.render(),e.trigger("/ui/alert/show","error",g.t("there_was_an_error_creating_this_group"))}})}),define("components/browse_groups/src/mock_group",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!./mock_group","./image","./mock_create","./decline_button","css!./group"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("html!./mock_group"),f=a("./image"),g=a("./mock_create"),h=a("./decline_button");return a("css!./group"),b.extend({mixins:[c,d],className:"yj-browse-groups--group yj-want-focuswithin",template:e,views:{ImageView:"_getImageView",MockCreateButtonView:"_mockCreateButtonView",DeclineButtonView:"_getDeclineButtonView"},initialize:function(){this.listenTo(this.model,"destroy",this.remove)},getTemplateData:function(){return{image:this.model.get("mugshot_url").replace("48x48","88x88")}},_getImageView:function(){return new f(this.options)},_mockCreateButtonView:function(){return new g({model:this.model})},_getDeclineButtonView:function(){return new h({model:this.model})}})}),define("stache!components/browse_groups/src/create_button",["mustache"],function(a){var b="{{create}}";return a.parse(b),function(c){return a.render(b,c)}}),define("components/browse_groups/src/create_button",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","html!./create_button","backbone"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("html!./create_button"),f=a("backbone");return b.extend({mixins:[c],className:"yj-btn",tagName:"button",template:e,getTemplateData:function(){return{create:d.t("create_new_group")}},render:function(){return f.trigger("/ui/lightbox/group_and_en/register_trigger",this.$el,"group"),this}})}),define("stache!components/browse_groups/src/no_suggestions",["mustache"],function(a){var b="<h2 class='yj-browse-groups--no-suggestions-info'>{{freshOut}}</h2>\n<div class='yj-browse-groups--create-button'>\n  <CreateButtonView key=\"create\" />\n</div>\n</div>\n<div class='yj-browse-groups--list yj-browse-groups--no-suggestions-image'>\n<div class='yj-browse-groups--no-suggestions-text'>\n  <h4 class='yj-browse-groups--no-suggestions-title'>{{groupsCommunication}}</h4>\n  <br>\n  <p>{{postFile}}</p>\n  <br>\n  <p>{{privacyChoice}}</p>\n</div>";return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/browse_groups/src/browse_groups",[],function(){}),define("components/browse_groups/src/no_suggestions",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./create_button","core/lib/tr","html!./no_suggestions","css!./browse_groups"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./create_button"),f=a("core/lib/tr"),g=a("html!./no_suggestions");return a("css!./browse_groups"),b.extend({mixins:[c,d],className:"yj-browse-groups--header",template:g,views:{CreateButtonView:"_getCreateButtonView"},getTemplateData:function(){return{freshOut:f.t("were_fresh_out_of_suggestions"),groupsCommunication:f.t("groups_make_communication_simple_fast_and_easy"),postFile:f.t("post_a_file_for_feedback_ask_a_question_or_share"),privacyChoice:f.t("you_can_make_your_group_open_to_others_or_private")}},_getCreateButtonView:function(){return new e}})}),define("components/browse_groups/src/browse_groups",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","html!./browse_groups","./group","./mock_group","./no_suggestions","common-ui/lib/ui/shared/spinner","core/lib/yammer_request","css!./browse_groups"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("html!./browse_groups"),g=a("./group"),h=a("./mock_group"),i=a("./no_suggestions"),j=a("common-ui/lib/ui/shared/spinner"),k=a("core/lib/yammer_request");return a("css!./browse_groups"),c.extend({mixins:[d,e],className:"yj-browse-groups",template:f,views:{GroupView:"_getGroupView",MockGroupView:"_getMockGroupView",NoSuggestionsView:"_getNoSuggestionsView",Spinner:"_getSpinner"},initialize:function(){this.showSpinner=!0,this.showSpinnerUntilSecondFetch=!0,this.listenToOnce(this.collection,"sync",this.onSync),this._fetchInitialSuggestedGroups()},onSync:function(){this.showSpinner=!1,this.render()},getTemplateData:function(){var a=this.collection.getMockGroups(),c=this.collection.getExistingGroups();return{showSpinner:this.showSpinner,showSpinnerUntilSecondFetch:this.showSpinnerUntilSecondFetch,hasCollection:this.collection.length,groups:b.pluck(c,"id"),mockGroups:b.pluck(a,"cid")}},_getGroupView:function(a){return new g({model:this.collection.get(a)})},_getMockGroupView:function(a){return new h({model:this.collection.get({cid:a})})},_getNoSuggestionsView:function(){return new i},_getSpinner:function(){return new j},_fetchInitialSuggestedGroups:function(){this.collection.fetch().done(this._fetchAllSuggestedGroups.bind(this))},_fetchAllSuggestedGroups:function(){this.collection.length>0?this.collection.fetch().done(this._hideSecondSpinner.bind(this),this._logSuggestedGroups):this._hideSecondSpinner()},_hideSecondSpinner:function(){this.showSpinnerUntilSecondFetch=!1,this.render()},_logSuggestedGroups:function(a){var c=[],d=[];b.each(a,function(a){a.suggested.id?c.push(a.suggested.id):d.push(a.suggested.name)}),k.send({url:"/group_suggestions/log_suggested",type:"get",data:{group_ids:c,group_permalinks:d}})}})}),define("css!components/browse_groups/src/button_bar",[],function(){}),define("stache!components/browse_groups/src/button_bar",["mustache"],function(a){var b='<button class="yj-browse-groups-button-bar--done yj-btn">{{ done }}</button>\n<a href="{{ viewMoreUrl }}" class="yj-browse-groups-button-bar--view-more">{{ viewMore }}</a>';return a.parse(b),function(c){return a.render(b,c)}}),define("components/browse_groups/src/button_bar",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","backbone","core/lib/tr","core/lib/report","core/lib/urls","css!./button_bar","html!./button_bar"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("backbone"),e=a("core/lib/tr"),f=a("core/lib/report"),g=a("core/lib/urls");return a("css!./button_bar"),c.extend({mixins:[b],template:a("html!./button_bar"),className:"yj-browse-groups-button-bar",events:{"click .yj-browse-groups-button-bar--view-more":"_viewMoreGroups","click .yj-browse-groups-button-bar--done":"_closeLightbox"},getTemplateData:function(){return{done:e.t("done"),viewMore:e.t("view_more_groups"),viewMoreUrl:g.groupsSuggested()}},_viewMoreGroups:function(){f.event("group_suggestions_view_more_groups",{source:"lightbox"})},_closeLightbox:function(a){a.preventDefault(),d.trigger("/ui/lightbox/close")}})}),define("models/suggested_group",["require","models/yammer_model","core/lib/yammer_api","core/lib/yammer_request","core/lib/yammer_uri"],function(a){"use strict";var b=a("models/yammer_model"),c=a("core/lib/yammer_api"),d=a("core/lib/yammer_request"),e=a("core/lib/yammer_uri");return b.extend({defaults:{type:"group"},join:function(a){return c.joinGroup(a.data).then(a.success,a.error)},leave:function(a){return c.leaveGroup(a.data).then(a.success,a.error)},decline:function(a){return c.declineGroupSuggestion(a.data).then(a.success,a.error)},create:function(a){return d.send({url:e.app()+"/groups/create_suggestion.json",data:{group:{name:this.get("full_name"),pool:this.get("pool"),strategy:this.get("strategy"),bfr_source:a.event_source,bfr_section:a.event_source,bfr_event:a.event_action}},type:"post",success:a.success,error:a.error})},isMockGroup:function(){return!this.id}},{})}),define("collections/suggested_groups",["require","underscore","collections/yammer_collection","models/suggested_group"],function(a){"use strict";function b(a){var b=[];if(a.extra_featured_users){for(var c=Math.min(a.extra_featured_users.length,f-1),d=0;c>d;d++)a.extra_featured_users[d]&&b.push(a.extra_featured_users[d]);a.featured_user&&b.push(a.featured_user)}return a.suggested.featured_users=b,a.suggested}var c=a("underscore"),d=a("collections/yammer_collection"),e=a("models/suggested_group"),f=4;return d.extend({model:e,url:function(){return 0===this.models.length?"/api/v1/group_suggestions.json?type=prankie_unshuffled&limit=4":"/api/v1/group_suggestions.json?type=prankie_unshuffled&limit=40"},parse:function(a){return c.map(a,b)},getExistingGroups:function(){return this.filter(function(a){return a.isMockGroup()?void 0:a})},getMockGroups:function(){return this.filter(function(a){return a.isMockGroup()?a:void 0})}})}),define("stache!components/browse_groups/src/suggested_groups_lightbox",["mustache"],function(a){var b='<div class="yj-suggested-groups-lightbox--groups-grid groups-grid ">\n  <BrowseGroups key="browse-groups" />\n</div>\n<ButtonBar key="button-bar" />';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/browse_groups/src/suggested_groups_lightbox",[],function(){}),define("components/browse_groups/src/suggested_groups_lightbox",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","./browse_groups","./button_bar","collections/suggested_groups","html!./suggested_groups_lightbox","css!./suggested_groups_lightbox"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("./browse_groups"),f=a("./button_bar"),g=a("collections/suggested_groups"),h=a("html!./suggested_groups_lightbox");return a("css!./suggested_groups_lightbox"),c.extend({mixins:[b,d],className:"yj-suggested-groups-lightbox",template:h,views:{BrowseGroups:"_getBrowseGroups",ButtonBar:"_getButtonBar"},_getBrowseGroups:function(){return new e({collection:new g})},_getButtonBar:function(){return new f}})}),define("components/browse_groups/index",["require","./src/suggested_groups_lightbox"],function(a){"use strict";var b=a("./src/suggested_groups_lightbox");return b}),define("workfeed/lib/app/bundles/nav_menu_bundle",["require","jquery","underscore","components/browse_groups/index","workfeed/lib/modules/file_uploader","common-ui/lib/ui/general/lightbox_manager","backbone","core/lib/session","core/lib/tr","core/lib/yammer_request","core/lib/report"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("components/browse_groups/index"),e=a("workfeed/lib/modules/file_uploader"),f=a("common-ui/lib/ui/general/lightbox_manager"),g=a("backbone"),h=a("core/lib/session"),i=a("core/lib/tr"),j=a("core/lib/yammer_request"),k=a("core/lib/report"),l=function(a){j.send({url:"/group_suggestions/"+a,type:"get"})};return{run:function(){b(c.bind(function(){new e({container:".yj-nav-user .upload-photo",file:".yj-nav-user .file-input",thumbnail:".yj-nav-user .upload-photo .mugshot-no-photo",dimensions:"nue_big_profile",updateViaApiMethod:"updateUser",apiParams:{id:h.getCurrentUser().id,experiment_source:"nue_steps"}}),b(".nav-list-link.following").click(function(a){var b=window.location.hash+window.location.search;b.toLowerCase().indexOf("/home?type=following")>=0&&(g.trigger("/feed/threads/redraw"),a.preventDefault())});var a=b(".yj-nav-menu .yj-selected:first");a.length&&a.is(":hidden")&&a.closest(".yj-nav-list").find(".yj-nav-more-link").trigger("click"),b(".yj-nav-menu .suggested-groups-lightbox").on("click",function(a){a.preventDefault(),l("log_open_lightbox"),g.trigger("/ui/groupNav/delayNotification"),f.openComponent(new d,"yj-suggested-groups-lightbox-container",void 0,{title:i.t("suggested_groups"),overlayClose:!0,scrolling:!1,width:735,onClosed:function(){g.trigger("/ui/groupNav/showJoinedGroup",{highlight:!0,showTooltip:!0}),k.event("group_suggestions_lightbox_close")}})})},this))}}}),define("models/lib/helper/inbox_manager",["require","jquery","underscore","core/lib/backbone_base_class","models/lib/helper/feed_factory","core/lib/report","models/lib/events","backbone"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_class"),e=a("models/lib/helper/feed_factory"),f=a("core/lib/report"),g=a("models/lib/events"),h=a("backbone"),i=d.extend({},{_models:{},_started:!1,inboxReady:new b.Deferred,MAX_THREADS:20,start:function(){if(!this._started){this._setupInboxFeeds();var a=this._models.unread;a.fetch().then(a.connectToRealtime.bind(a),this._reportFetchError.bind(this)).then(this._setAsInboxReady.bind(this),this._rejectInboxReady.bind(this)),this._started=!0}},stop:function(){this._started&&(this._listener.stopListening(),c.invoke(this._models,"unlisten"),this._hooks=null,this._started=!1)},getModels:c.memoize(function(){return{unread:this.getUnreadFeed(),read:this.getReadFeed(),all:this.getAllFeed()}}),getAllFeed:c.memoize(function(){return e.findOrCreate("inboxAll")}),getUnreadFeed:c.memoize(function(){return e.findOrCreate("inboxUnread")}),getReadFeed:c.memoize(function(){return e.findOrCreate("inboxRead")}),_reportFetchError:function(){f.info({message:"Initial fetch for inbox unread failed"})},_setAsInboxReady:function(){this.inboxReady.resolve(this.getModels())},_rejectInboxReady:function(){this.inboxReady.reject()},_setupInboxFeeds:function(){this._models=this.getModels(),this._listener=c.extend({},h.Events),this._setupUnreadFeed(),this._setupReadFeed()},_setupUnreadFeed:function(){this._listener.listenTo(g,"ThreadFeedDelivery/"+this._models.unread.id+"/save",this._onUnreadThreadSave.bind(this))},_onUnreadThreadSave:function(a){var b=this._models.unread,c=this._models.read,d=c.hasFirstPayload();b.isSeen(a)?(a.undeliver(b),d&&c.markSeen(a)):d&&a.undeliver(c)},_setupReadFeed:function(){this._listener.listenTo(g,"ThreadFeedDelivery/"+this._models.read.id+"/save",this._onReadThreadSave.bind(this))},_onReadThreadSave:function(a){var b=this._models.unread,c=this._models.read,d=b.hasFirstPayload();c.isUnseen(a)?(a.undeliver(c),d&&b.trigger("markUnseen",a)):d&&a.undeliver(b)}});return i}),define("workfeed/lib/app/forms",["require","jquery","core/lib/namespace","core/lib/tr"],function(a){var b=a("jquery"),c=a("core/lib/namespace"),d=a("core/lib/tr");return c.ns("yam.workfeed"),yam.workfeed.Forms=function(){var a=function(a){function d(a,b){if(a=a.length?a[0]:a,a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}}if(jQuery(a).data("initialized")!==!0){var f=jQuery(".yj-validate",a);if(f.length>0){jQuery(a).bind("submit",function(a){return e(this,a)});for(var g=0;g<f.length;g++)jQuery(a).css("position","relative"),c(f[g])}jQuery(".single-submit",a).each(function(){h(this)}),b(".initial-focus",a).each(function(){var a;this.focus(),b(this).data("watermarked")&&(a=b(this).attr("title"),b(this).val(a).css("color","#666").attr("placeholder",""),d(b(this),0),b(this).bind("keydown mousedown",function(){void 0!==b(this).attr("data-watermarked")&&b(this).val("").css("color","#000").removeAttr("data-watermarked")}).bind("blur",function(){""===b(this).val()&&b(this).val(b(this).attr("title")).css("color","#666").attr("data-watermarked",!0)})),b(this).data("autoFocus",!0).bind("blur",function(){b(this).data("autoFocus",!1)})}),b(a).data("initialized",!0)}},c=function(a){for(var b in n)jQuery(a).hasClass(b)&&jQuery(a).bind("blur."+b,{validationFunction:b},function(a){f(this,a.data.validationFunction)}).bind("focus."+b,function(){var a=jQuery(this);a.removeClass("yj-invalid").removeAttr("aria-invalid"),g(this.id),a.data("autoFocus")===!0&&a.data("firstFocusOccured")!==!0?a.data("firstFocusOccured",!0):a.data("autoFocus")===!0&&a.data("autoFocus",!1)})},e=function(a,b){return jQuery(".yj-validate",a).blur(),jQuery(".yj-invalid",a).length>0?(b&&b.stopImmediatePropagation(),jQuery(a).find(".yj-btn-disabled").removeClass("yj-btn-disabled"),!1):!0},f=function(a,c){g(a.id);var d=jQuery(a),e=n[c](a);if(e){if(d.val()||!d.data("autoFocus")){var f,h=b('<span class="yj-validation-error" id="'+a.id+'-validation-error"></span>');h.text(e),d.addClass("yj-invalid").removeClass("yj-valid").attr("aria-invalid","true"),f=d.siblings(".yj-error-container").length||d.nextAll("#pw-rules").find(".yj-error-container").length?d.nextAll("#pw-rules").length?d.nextAll("#pw-rules").find(".yj-error-container"):d.siblings(".yj-error-container"):d.siblings("label").length?d.siblings("label"):d.parents("tr:first").find("label"),f.find(".yj-validation-success-message").remove(),f.find(".yj-validation-error").empty();var i=d.siblings(".errors");i.length?i.empty():i=f,i.append(h).children("span").fadeIn(250)}}else d.addClass("yj-valid").removeClass("yj-invalid").attr("aria-invalid","false")},g=function(a){jQuery("#"+a+"-validation-error").fadeOut(250,function(){jQuery(this).hide().remove()})},h=function(a){jQuery(a).bind("click.singleSubmit",function(b){return jQuery(a).hasClass("yj-btn-disabled")?(b.stopPropagation(),!1):(jQuery(a).addClass("yj-btn-disabled"),!0)})},i=function(b){return a(b),e(b)},j=/^([A-Za-z0-9_\-\.\'\$\+\*\&])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]+)$/,k=/^([A-Za-z0-9_\-\.\'\$\+\*\&])+$/,l=/^[0-9]*$/,m=/^(\(?\+?[0-9]*\)?)?[0-9_xX\- \(\)]*$/,n={required:function(a){return a&&a.value&&jQuery.trim(a.value).length>0?!1:d.t("required_field")},range:function(){},numeric:function(a){return a&&a.value&&jQuery.trim(a.value).match(l)?!1:d.t("invalid_input")},email:function(a){return a&&a.value&&jQuery.trim(a.value).match(j)?!1:d.t("invalid_email")},noneRequiredEmail:function(a){return""===a.value||a.value===jQuery(a).attr("placeholder")||jQuery.trim(a.value).match(j)?!1:d.t("invalid_email")},partialEmail:function(a){return a&&a.value&&jQuery.trim(a.value).match(k)?!1:d.t("invalid_email")},noneRequiredPartialEmail:function(a){return""===a.value||jQuery.trim(a.value).match(k)?!1:d.t("invalid_email")},phoneNumber:function(a){return a&&a.value&&jQuery.trim(a.value).match(m)?!1:d.t("invalid_phone_number")},password:function(a){var b,c,e=a.value,f=!0,g=/[a-zA-Z]/g,h=/[a-z]/g,i=/[A-Z]/g,j=/[0-9]/g,k=/[^a-zA-Z0-9]/g,l=p.BANNED_PASSWORDS;if(e.length<(p.password_length||5))f=!1;else switch(p.password_complexity||1){case 1:f=!0;break;case 2:f=e.match(g)&&e.match(j);break;case 3:f=e.match(g)&&e.match(j)&&e.match(k);break;case 4:f=e.match(i)&&e.match(h)&&e.match(j)&&e.match(k)}if(f&&l)for(b=0,c=l.length;c>b;b++)if(e==l[b]){f=!1;break}return f?!1:d.t("invalid_password")},confirmPassword:function(a){return a.value===jQuery("#"+jQuery(a).data("confirm")).val()?!1:d.t("passwords_dont_match")}},o=function(){jQuery(".single-submit").removeClass("yj-btn-disabled")},p={};return{buildForm:a,validateForm:i,enableButtons:o,EMAIL_REGEX:j,setPasswordValidation:function(a){p=a}}}()}),define("core/lib/jam/backbone_history_with_before_events",["require","underscore","backbone"],function(a){var b=a("underscore"),c=a("backbone"),d=c.History.extend({_getFirstMatchingHandler:function(a){return b.find(this.handlers,function(b){return b.route.test(a)})},_getEventObject:function(){return function(){var a=function(){this.routeChangePrevented=!0};return{routeChangePrevented:!1,preventRouteChange:a}}()},fireBeforeRouteEvent:function(a,b){var c,d=this._getFirstMatchingHandler(a);if(d&&d.beforeCallback){c=this._getEventObject();var e=this._getFirstMatchingHandler(b);e&&e.name&&(c.currentRouteName=e.name),d.beforeCallback(c)}return c},_abortRouteChange:function(a,b){this.fragment=a,this.navigate(b,{replace:!0})},checkUrl:function(){var a=this.getFragment(),b=this.fragment;if(a===b&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),a===b)return!1;var c=this.fireBeforeRouteEvent(a,b);c&&c.routeChangePrevented?this._abortRouteChange(a,b):(this.iframe&&this.navigate(a),this.loadUrl())},addNameToLatestHandler:function(a){this.handlers[0].name=a},addBeforeRouteCallbackToLatestHandler:function(a){this.handlers[0].beforeCallback=a},getFragment:function(a,b){var d=c.History.prototype.getFragment.call(this,a,b);return this._usePushState||b||!this._wantsHashChange||""===d||"/"===d||(d="/"+d),d}});return c.history=new d,d}),define("core/lib/jam/backbone_router_with_before_events",["require","backbone","core/lib/jam/backbone_history_with_before_events"],function(a){var b=a("backbone");return a("core/lib/jam/backbone_history_with_before_events"),b.Router.extend({route:function(a,c,d){b.Router.prototype.route.call(this,a,c,d),b.history.addNameToLatestHandler(c),b.history.addBeforeRouteCallbackToLatestHandler(function(a){this.trigger("before-route",a)}.bind(this))}})}),define("workfeed/lib/app/routing/general_route_handler",["require","jquery","underscore","backbone","core/lib/backbone_base_view","core/lib/ctor","core/lib/log","core/lib/uri_helper","core/lib/report","core/lib/location_helper"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/backbone_base_view"),f=a("core/lib/ctor"),g=a("core/lib/log"),h=a("core/lib/uri_helper"),i=a("core/lib/report"),j=a("core/lib/location_helper"),k=/^[a-z0-9_\-]+$/i;return f(null,{navigationCount:0,navigationStart:0,isOriginalFeedLoad:null,_validParameters:{threadId:{type:"integer",fallback:-1},feedId:{type:"integer",fallback:-1},appId:{type:"integer",fallback:-1},groupId:{type:"id",fallback:-1},messageId:{type:"integer",fallback:-1},type:{type:"slug",fallback:"general"},page:{type:"integer",fallback:0},from:{type:"slug",fallback:0},view:{type:"string"},search:{type:"string"},tab:{type:"string"},search_inbox:{type:"integer"},search_group:{type:"integer"},search_source:{type:"string"},search_startdate:{type:"string"},search_enddate:{type:"string"},search_origin:{type:"string"},search_type:{type:"slug"},utf8:{type:"string"},flash_type:{type:"string"},flash_message:{type:"string"},noteId:{type:"integer"},endVersion:{type:"integer"},fileId:{type:"integer"},version:{type:"integer"},ogoId:{type:"integer"},letter:{type:"string"}},processParameter:function(a,b){var d,e=this._validParameters[b],f=!1,h=!e&&c.isString(b)&&0===b.indexOf("trk_");if(h)e={type:"string"};else if(!e)return g.warn('"'+b+'" is not a valid parameter for routes, it is being ignored'),void i.info({message:"general_route_handler_invalid_parameter",param_name:b,param_value:a,error_type:"unknown",request_path:j.hash()});if(!c.isNull(a)&&!c.isUndefined(a)){switch(e.type){case"slug":d=a,f=k.test(a);break;case"integer":d=parseInt(a,10),f=!c.isNaN(d);break;case"string":d=a,f=d.length>0;break;case"id":if(d=a,"company"===a){f=!0;break}var l=parseInt(a,10);isNaN(l)||(d=l,f=!0)}return f?d:(g.warn('"'+a+'" is not a valid value for "'+b+'" parameter, falling back to:',e.fallback),i.info({message:"general_route_handler_invalid_parameter",param_name:b,param_value:a,fallback_value:e.fallback,error_type:"invalid_"+e.type,request_path:j.pathname()+j.hash()}),e.fallback)}},_processParameters:function(a){var b={};return c.each(a,function(a,d){var e=this.processParameter(a,d);c.isUndefined(e)||(b[d]=e)},this),b},handleRoute:function(a,f,g){g=g||{},this.navigationCount++,this.isOriginalFeedLoad=!0,this.isFastSwitch()&&(this.navigationStart=window.performance.now()),f=this._processParameters(f),0!==window.scrollY&&(d.trigger("/ui/window/scrolledTop"),b(document).scrollTop(0));var h=this._view;h&&h.remove();var i=new a(c.extend(f,g));if(i instanceof e)try{b("#column-two").empty().append(i.render().$el)}catch(a){b("#column-two").empty().append(i.render().$el)}return d.trigger("routeChange",i),this._triggerInitialRouteEvent(i,f),this._view=i,i},getDefaultFragment:function(a,b,c){"Messages"===a&&"Search"===b&&(a="Threads");var d="/"+a+"/"+b;return c&&(d+="?"+h.paramify(c)),d},isFastSwitch:function(){return this.navigationCount>1},_triggerInitialRouteEvent:c.once(function(a,b){c.defer(function(){d.trigger("initialRoute",a,b)})})})}),define("core/lib/util/route_helper",[],function(){"use strict";var a=function(a,b){return a.toUpperCase()===b.toUpperCase()||""===a||""===b},b=function(){return yam.router?yam.router.getCurrentFragment():""},c=function(){return yam.router?yam.router.getFragment():""},d=function(d,e){var f=b();return function(){a(f,c())&&d.apply(e,arguments)}};return{executeInCurrentFragment:d}}),define("core/lib/routing/group_viewed_routing_helper",["require","models/lib/helper/feed_factory","core/lib/namespace","core/lib/yammer_api","core/lib/uri_helper","collections/groups","models/lib/model/helper/report_feed_events","models/helpers/group","core/lib/util/route_helper"],function(a){var b=a("models/lib/helper/feed_factory"),c=a("core/lib/namespace"),d=a("core/lib/yammer_api"),e=a("core/lib/uri_helper"),f=a("collections/groups"),g=a("models/lib/model/helper/report_feed_events"),h=a("models/helpers/group"),i=a("core/lib/util/route_helper"),j=i.executeInCurrentFragment,k={general:{unviewed:"generalUnviewed",all:"general"},group:{unviewed:"groupUnviewed",all:"group"}},l=function(a){var b=new $.Deferred,c=a.groupId;"general"===a.groupType&&(c="company");var d=h.fetch(c);return d.then(j(function(){m(a.view)?b.reject({view:r(a)?a.view:"all"}):p(b,a)}),j(u.bind(null,b,a))),b.then(o.bind(null,a)),b.promise()},m=function(a){return"all"===a||"unviewed"===a},n=function(a,c){var d=k[a.groupType][c],e=b.findOrCreate(d,a.groupId);return e},o=function(a,b){var c=n(a,b.view);c&&g.reportFeedEvent("landing_feed_choice",c.getLogSource(),c.getGroupId(),{feed_view:c.getLogFeedView()})},p=function(a,c){if(r(c)){var d=b.find(c.groupType,c.groupId);if(d&&d.isRealtimeConnected()){var e=d.getUnseenCount()>0;q(e,a,c)}else t(a,c)}else a.reject({view:"all"})},q=function(a,b,c){var d=a?"unviewed":"all";v(d,b,c)},r=function(a){if(s(a))return!0;var b=f.get(a.groupId);return h.isCurrentUserMember(b)},s=function(a){return"general"===a.groupType},t=function(a,e){var f=b.create(e.groupType,e.groupId);return d.getMessages({url:f.getUrl(),data:{limit:1}}).then(j(function(b){var d=c.val(b,"meta.unviewed_threads.threads"),f=d&&d.length>0;q(f,a,e)}),j(u.bind(null,a,e)))},u=function(a,b){v("all",a,b)},v=function(a,b,c){if("all"===a){var d=!s(c),f=d?"/threads/inGroup":"/threads/company";f=e.replaceParam(f,"type",d?"in_group":"general"),f=e.replaceParam(f,"feedId",d?c.groupId:void 0),f=e.replaceParam(f,"view",a),yam.router.navigate(f,{replace:!0})}b.resolve({view:a})};return{groupTypeKeys:k,getDefaultFeedView:l}}),define("core/lib/routing/inbox_routing_helper",["require","models/lib/helper/feed_factory","core/lib/util/route_helper","models/lib/model/helper/report_feed_events","models/lib/helper/inbox_manager"],function(a){var b=a("models/lib/helper/feed_factory"),c=a("core/lib/util/route_helper"),d=a("models/lib/model/helper/report_feed_events"),e=a("models/lib/helper/inbox_manager"),f=c.executeInCurrentFragment,g=function(){var a=new $.Deferred;return e.inboxReady.then(f(function(){var b=h();b.getUnseenCount()>0?j("unread",a):j("all",a)}),f(j.bind(null,"all",a))),a.then(i),a.promise()},h=function(){return b.find("inboxUnread")},i=function(a){var b=h();d.reportFeedEvent("landing_feed_choice",b.getLogSource(),null,{feed_view:a.view})},j=function(a,b){var c="/inbox/"+a;yam.router.navigate(c,{replace:!0}),b.resolve({view:a})};return{getDefaultFeedView:g}}),define("stache!workfeed/lib/app/views/groups/header",["mustache"],function(a){var b='<div class="page-header-container yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block">\n  <div class="page-header has-tabs">\n    <div class="header-content">\n      <div class="header-actions">\n        <a href="javascript://" class="yj-btn yj-btn-secondary yj-groups--create" role="button" title="{{create_group_label}}">{{create_group_label}}</a>\n      </div>\n      <div class="header-cell">\n        <h2>{{title_label}}</h2>\n        <p class="description">\n          {{{create_group_description}}}\n        </p>\n        <p class="description">\n          {{{external_network_description}}}\n        </p>\n      </div>\n    </div>\n    <div class="yj-action-bar-with-tabs">\n      <div class="yj-action-bar-tabs">\n      <ul class="yj-tabs">\n        <li class="yj-filter-tab{{#is_suggested}} yj-selected{{/is_suggested}}">\n          <a href="{{suggested_url}}" class="yj-filter-tab-link">{{suggested_label}}\n          <span class="yj-acc-hidden"> tab</span>\n          <span class="yj-acc-selectedstate"> selected</span></a>\n        </li>\n        <li class="yj-filter-tab{{#is_mine}} yj-selected{{/is_mine}}">\n          <a href="{{mine_url}}" class="yj-filter-tab-link">{{mine_label}}\n          <span class="yj-acc-hidden"> tab</span>\n          <span class="yj-acc-selectedstate"> selected</span></a>\n        </li>\n        <li class="yj-filter-tab{{#is_all}} yj-selected{{/is_all}}">\n          <a href="{{all_url}}" class="yj-filter-tab-link">{{all_label}}\n          <span class="yj-acc-hidden"> tab</span>\n          <span class="yj-acc-selectedstate"> selected</span></a>\n        </li>\n      </ul>\n      </div>\n    </div>\n  </div>\n</div>';
return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/groups/header",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","core/lib/urls","components/create_group/index","common-ui/lib/ui/general/lightbox_manager","html!./header"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g=a("core/lib/urls"),h=a("components/create_group/index"),i=a("common-ui/lib/ui/general/lightbox_manager"),j=a("html!./header"),k={title_label:f.t("groups_title"),create_group_label:f.t("groups_create_group_label"),create_group_description:f.t("groups_create_group_description",{link:'<a href="javascript://" class="yj-groups--create">{$0}</a>'}),suggest_groups_label:f.t("groups_suggest_groups_label"),suggested_label:f.t("groups_suggested_label"),mine_label:f.t("groups_mine_label"),all_label:f.t("groups_all_label")};return c.extend({className:"yj-groups--header",template:j,mixins:[d,e],events:{"click .yj-groups--create":"_createGroupHandler"},getTemplateData:function(){return b.extend({external_network_description:f.t("groups_external_network_description",{link:'<a href="'+g.networks()+'">{$0}</a>'}),suggested_url:g.groupsSuggested(),mine_url:g.groupsMine(),all_url:g.groups(),is_suggested:"suggested"===this.options.tab,is_mine:"mine"===this.options.tab,is_all:!this.options.tab},k)},_createGroupHandler:function(){var a={version:2};this._createGroup=new h(a),i.openComponent(this._createGroup,"yj-create-lightbox-group",void 0,{title:f.t("create_a_new_group"),onComplete:this._createGroup.onLightboxLoaded.bind(this._createGroup),overlayClose:!1,width:null,transition:"elastic"})}})}),define("stache!workfeed/lib/app/views/groups/suggested",["mustache"],function(a){var b='<div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block">\n  {{^loaded}}\n  <Spinner />\n  {{/loaded}}\n  {{#loaded}}\n  <form role="search" class="yj-groups--suggested-search-controls">\n    <span class="yj-groups--suggested-search-input-container">\n      <label>\n        <span class="yj-acc-hidden">{{search_description_label}}</span>\n        <input type="text" placeholder="{{search_description_label}}" class="yj-groups--suggested-search-input" value="{{search}}">\n      </label>\n    </span>\n    <button type="submit" class="yj-groups--suggested-search-submit yj-btn yj-btn-alt">\n      <span>{{search_label}}</span>\n    </button>\n    {{#search}}\n    <a href="{{suggested_url}}" class="yj-groups--suggested-search-back">{{go_back_label}}</a>\n    {{/search}}\n  </form>\n</span>\n  {{#items}}\n  <div class="yj-groups--suggested-item" data-qaid="suggested_groups_item">\n    <Avatar key={{id}} />\n    <div class="yj-groups--suggested-item-text-container">\n      {{^is_search_result}}\n      <div class="yj-close">\n        <a href="javascript://" role="button" class="yj-close-link yj-menu-shadow-top" title="{{decline_tip}}" data-id="{{id}}" data-qaid="suggested_groups_decline"><span class="yamicon yamicon-x"><span class="yj-acc-hidden">{{decline_tip}}</span></span>\n        </a>\n      </div>\n      {{/is_search_result}}\n      <a href="{{url}}" class="yj-groups--suggested-item-name" data-qaid="suggested_groups_name">{{name}}</a>\n      <div class="yj-groups--suggested-item-description">{{description}}</div>\n      <span class="yj-groups--suggested-item-membership" data-qaid="suggested_groups_members">\n        <span class="yamicon yamicon-user yamicon-inline yamicon-xxx-small yj-dark-gray"></span>{{members}}<span class="yj-acc-hidden"> member</span>\n      </span>\n    </div>\n    <div class="yj-groups--suggested-item-btn" data-qaid="suggested_groups_action"><FollowGroupButton key={{id}}/></div>\n  </div>\n  {{/items}}\n  {{^search}}\n  <MoreButton />\n  {{/search}}\n  {{/loaded}}\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/views/groups/suggested",[],function(){}),define("workfeed/lib/app/views/groups/suggested",["require","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","collections/groups","common-ui/lib/ui/shared/spinner","core/lib/yammer_api","models/helpers/group","components/avatar/index","common-ui/lib/ui/shared/follow_group_button","common-ui/lib/ui/shared/more_button","core/lib/urls","core/lib/tr","core/lib/uri_helper","core/lib/location_helper","core/lib/util/hydrant_helper","html!./suggested","css!./suggested"],function(a){"use strict";var b=a("backbone"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("collections/groups"),g=a("common-ui/lib/ui/shared/spinner"),h=a("core/lib/yammer_api"),i=a("models/helpers/group"),j=a("components/avatar/index"),k=a("common-ui/lib/ui/shared/follow_group_button"),l=a("common-ui/lib/ui/shared/more_button"),m=a("core/lib/urls"),n=a("core/lib/tr"),o=a("core/lib/uri_helper"),p=a("core/lib/location_helper"),q=a("core/lib/util/hydrant_helper"),r=a("html!./suggested");a("css!./suggested");var s=20,t=20;return c.extend({template:r,className:"yj-groups--suggested",mixins:[d,e],views:{Spinner:"_getSpinner",Avatar:"_getAvatar",FollowGroupButton:"_getFollowGroupButton",MoreButton:"_getMoreButton"},events:{"click .yj-close-link":"_handleDeleteSuggestion","submit .yj-groups--suggested-search-controls":"_handleSearch"},defaults:{show:s},getTemplateData:function(){if(!this._loaded)return{loaded:!1};var a=this;return{loaded:!0,search_description_label:n.t("groups_suggested_search_placeholder"),search_label:n.t("groups_suggested_search_label"),search:this.options.search||"",go_back_label:n.t("groups_suggested_search_back"),suggested_url:m.groupsSuggested(),items:this.collection.slice(0,this.options.show).map(function(b){var c=b.get("stats"),d=c&&c.members||0;return{id:b.id,name:i.getFullName(b),description:b.get("description"),members:d,url:m.groupIndex(b),is_search_result:!!a.options.search}})}},initialize:function(){this.collection=new b.Collection,this.listenTo(this.collection,"add remove reset",function(){this.render(),this._refreshMoreButton()}.bind(this)),this._fetch()},_getSpinner:function(){return new g},_getAvatar:function(a){var b=f.get(a);return new j({model:b,size:150})},_getFollowGroupButton:function(a){var b=f.get(a);return new k({model:b})},_getMoreButton:function(){return this._moreButton=new l({clickCallBack:this._showMoreSuggestions.bind(this),renderVisible:!0}),this._moreButton},_fetch:function(){return this.options.search?this._search():this._getSuggestions()},_search:function(){return h.searchGroupsV2({model_types:"groups",size:t,search:this.options.search||""}).then(function(a){return a.groups.map(function(b){return b=q.generateGroup(a,b),f.add(b)})}).then(function(a){this._loaded=!0,this.collection.reset(a)}.bind(this))},_getSuggestions:function(){return h.getGroupSuggestions({limit:50}).then(function(a){return a.map(function(a){return f.add(a.suggested)})}).then(function(a){this._loaded=!0,this.collection.add(a)}.bind(this))},_showMoreSuggestions:function(){this.options.show+=20,this.render(),this._refreshMoreButton()},_refreshMoreButton:function(){setTimeout(function(){this.options.show>this.collection.length?this._moreButton.hide():this._moreButton.show()}.bind(this),0)},_handleSearch:function(a){a.preventDefault();var b=$(".yj-groups--suggested-search-input",this.$el).val(),c=o.replaceParam(m.groupsSuggested(),"search",b);return p.replace(c),!1},_handleDeleteSuggestion:function(a){var b=$(a.currentTarget),c=b.data("id");h.declineGroupSuggestion({id:c}),this.collection.remove(c)}})}),define("stache!workfeed/lib/app/views/groups/alphabetic_nav",["mustache"],function(a){var b='<ul class="pagination horz-menu piped">\n  {{#letters}}\n  <li class="{{#selected}}selected{{/selected}} {{#is_all}}first{{/is_all}}">\n    <a href="javascript://" class="yj-groups--alphabetic-nav-letter" data-letter="{{letter}}" {{#is_all}} data-all="true"{{/is_all}}>{{letter}}<span class="yj-acc-hidden"> tab</span><span class="yj-acc-selectedstate"> selected</span></a>\n  </li>\n  {{/letters}}\n</ul>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/groups/alphabetic_nav",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","html!./alphabetic_nav"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("html!./alphabetic_nav"),f=[d.t("alphabetic_nav_all")].concat("ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""));return b.extend({template:e,className:"yj-groups--alphabetic-nav",mixins:[c],events:{"click .yj-groups--alphabetic-nav-letter":"_handleLetterClick"},getTemplateData:function(){var a=this.options.letter;return{letters:f.map(function(b,c){return{is_all:0===c,letter:b,selected:!a&&!c||a===b}})}},_handleLetterClick:function(a){a.preventDefault();var b=$(a.currentTarget).data("letter"),c=$(a.currentTarget).data("all");c?this.trigger("reset"):this.trigger("change",b)}})}),define("css!components/paginator/src/paginator",[],function(){}),define("stache!components/paginator/src/paginator",["mustache"],function(a){var b='{{#previous}}<a href="javascript://" role="button" class="previous">{{previousLabel}}</a>{{/previous}}\n{{#previousAndNext}} | {{/previousAndNext}}\n{{#next}}<a href="javascript://" role="button" class="next">{{nextLabel}}</a>{{/next}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/paginator/src/paginator",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","css!./paginator","html!./paginator"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=b.extend({mixins:[c],className:"yj-paginator",styles:a("css!./paginator"),template:a("html!./paginator"),events:{"click .previous":"_onPrevious","click .next":"_onNext"},initialize:function(){this._previous=!1,this._next=!1},getTemplateData:function(){return{previous:this._previous,next:this._next,previousAndNext:this._previous&&this._next,previousLabel:d.t("previous"),nextLabel:d.t("next")}},togglePrevious:function(a){this._previous=a,this.render()},toggleNext:function(a){this._next=a,this.render()},_onPrevious:function(){this.trigger("previous")},_onNext:function(){this.trigger("next")}});return e}),define("components/paginator/index",["require","./src/paginator"],function(a){"use strict";return a("./src/paginator")}),define("stache!components/groups_list/src/groups_list",["mustache"],function(a){var b='{{^loaded}}\n<Spinner />\n{{/loaded}}\n{{#loaded}}\n{{#has_results}}\n<table class="yj-groups-list--table">\n  <thead>\n    <tr class="yj-groups-list--header-row">\n      <th class="yj-groups-list--groups">{{groups_label}}</th>\n      <th class="yj-groups-list--members">{{members_label}}</th>\n      <th class="yj-groups-list--membership"></th>\n    </tr>\n  </thead>\n  <tbody>\n  {{#groups}}\n    <tr class="yj-groups-list--row" data-qaid="groups_list_row">\n      <td class="yj-groups-list--people">\n        <Avatar key="{{id}}"/>\n        <div class="yj-groups-list--name-title" data-qaid="groups_list_name">\n          <HovercardLink key="{{id}}"/>\n          {{#private}}<span class="yamicon-lock yamicon yamicon-xx-small yj-dark-gray"></span>{{/private}}\n          <div class="yj-groups-list--description">{{description}}</div>\n        </div>\n      </td>\n      <td class="yj-groups-list--members" data-qaid="groups_list_members">{{members_count}}</td>\n      <td class="yj-groups-list--membership" data-qaid="groups_list_action"><FollowGroupButton key={{id}}/></td>\n    </tr>\n  {{/groups}}\n  </tbody>\n</table>\n{{#paginated}}\n<Paginator />\n{{/paginated}}\n{{/has_results}}\n{{^has_results}}\n<div class="custom-notice">{{no_results_label}}</div>\n{{/has_results}}\n{{/loaded}}';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/groups_list/src/groups_list",[],function(){}),define("components/groups_list/src/groups_list",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","common-ui/lib/ui/shared/spinner","collections/groups","common-ui/lib/ui/shared/follow_group_button","components/avatar/index","components/hovercard_link/index","core/lib/tr","models/helpers/group","components/paginator/index","html!./groups_list","css!./groups_list.css"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("common-ui/lib/ui/shared/spinner"),f=a("collections/groups"),g=a("common-ui/lib/ui/shared/follow_group_button"),h=a("components/avatar/index"),i=a("components/hovercard_link/index"),j=a("core/lib/tr"),k=a("models/helpers/group"),l=a("components/paginator/index"),m=a("html!./groups_list");return a("css!./groups_list.css"),b.extend({mixins:[c,d],template:m,className:"yj-groups-list",views:{Spinner:"_getSpinner",Avatar:"_getAvatar",HovercardLink:"_getHovercardLink",FollowGroupButton:"_getFollowGroupButton",Paginator:"_getPaginator"},initialize:function(){if(this.options.page=parseInt(this.options.page,10)||1,!this.options.fetch)throw"Groups List requires a fetch function";this.options.fetch().then(this._handleGroups.bind(this))},getTemplateData:function(){if(!this.collection)return{loaded:!!this.collection};var a=this.collection.filter(this._applyFilters.bind(this)).map(function(a){var b=a.get("stats"),c=b&&b.members||0;return{id:a.get("id"),members_count:c,description:a.get("description"),private:k.isPrivate(a)}});return{loaded:!0,groups_label:j.t("user_groups_column_groups"),members_label:j.t("user_groups_column_members"),no_results_label:j.t("groups_list_no_results"),groups:a,has_results:!!a.length,paginated:!!this.options.pageSize}},_applyFilters:function(a){return this.options.letter?0===k.getFullName(a).toUpperCase().indexOf(this.options.letter):!0},_handleGroups:function(a){this.options.pageSize&&a.length>this.options.pageSize&&(a.pop(),this._moreResults=!0),this.collection=a.sort(function(a,b){return b.stats.members-a.stats.members}).map(f.add.bind(f)),this.render()},_getSpinner:function(){return new e},_getAvatar:function(a){return new h({model:f.get(a)})},_getHovercardLink:function(a){return new i({model:f.get(a)})},_getFollowGroupButton:function(a){return new g({model:f.get(a)})},_getPaginator:function(){return this._paginator=new l,this.listenTo(this._paginator,"previous",this._onPrevious),this.listenTo(this._paginator,"next",this._onNext),this._paginator.togglePrevious(this.options.page>1),this._paginator.toggleNext(this._moreResults),this._paginator},_onPrevious:function(){this.options.page=--this.options.page||1,this.trigger("paginate",this.options.page)},_onNext:function(){this.options.page++,this.trigger("paginate",this.options.page)}})}),define("components/groups_list/index",["require","./src/groups_list"],function(a){"use strict";return a("./src/groups_list")}),define("stache!workfeed/lib/app/views/groups/default",["mustache"],function(a){var b='<div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block">\n  <AlphabeticNav />\n  <GroupsList />\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/groups/mine",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./alphabetic_nav","components/groups_list/index","core/lib/uri_helper","core/lib/location_helper","core/lib/urls","models/helpers/user","core/lib/session","html!./default"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./alphabetic_nav"),f=a("components/groups_list/index"),g=a("core/lib/uri_helper"),h=a("core/lib/location_helper"),i=a("core/lib/urls"),j=a("models/helpers/user"),k=a("core/lib/session"),l=a("html!./default");return b.extend({template:l,className:"yj-groups--mine",mixins:[c,d],views:{AlphabeticNav:"_getAlphabeticNav",GroupsList:"_getGroupsList"},_getAlphabeticNav:function(){var a=new e(this.options);return this.listenTo(a,"change",this._changeLetter),this.listenTo(a,"reset",this._resetFilter),a},_getGroupsList:function(){return new f({fetch:j.getGroups.bind(null,k.getCurrentUser()),letter:this.options.letter})},_changeLetter:function(a){var b=g.replaceParam(i.groupsMine(),"letter",a);h.replace(b)},_resetFilter:function(){h.replace(i.groupsMine())}})}),define("workfeed/lib/app/views/groups/all",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./alphabetic_nav","components/groups_list/index","core/lib/yammer_api","core/lib/uri_helper","core/lib/location_helper","core/lib/urls","html!./default"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("./alphabetic_nav"),g=a("components/groups_list/index"),h=a("core/lib/yammer_api"),i=a("core/lib/uri_helper"),j=a("core/lib/location_helper"),k=a("core/lib/urls"),l=a("html!./default"),m=20;return c.extend({template:l,className:"yj-groups--all",mixins:[d,e],views:{AlphabeticNav:"_getAlphabeticNav",GroupsList:"_getGroupsList"},_getAlphabeticNav:function(){var a=new f(this.options);return this.listenTo(a,"change",this._changeLetter),this.listenTo(a,"reset",this._resetFilter),a},_getGroupsList:function(){var a=new g({fetch:h.getGroups.bind(null,b.extend({limit:m+1},b.pick(this.options,"letter","page"))),pageSize:m,page:this.options.page});return this.listenTo(a,"paginate",this._paginate.bind(this)),a},_changeLetter:function(a){var b=i.replaceParam(k.groups(),"letter",a);j.replace(b)},_resetFilter:function(){j.replace(k.groups())},_paginate:function(a){var b=i.replaceParam(k.groups(),"page",a);b=i.replaceParam(b,"letter",this.options.letter),j.replace(b)}})}),define("stache!workfeed/lib/app/views/groups/index",["mustache"],function(a){var b="<Header />\n{{#is_suggested}}\n<Suggested />\n{{/is_suggested}}\n{{#is_mine}}\n<MyGroups />\n{{/is_mine}}\n{{#is_all}}\n<AllGroups />\n{{/is_all}}";return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/groups/index",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./header","./suggested","./mine","./all","html!./index"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./header"),f=a("./suggested"),g=a("./mine"),h=a("./all"),i=a("html!./index");return b.extend({className:"yj-groups",template:i,mixins:[c,d],views:{Header:"_getHeader",Suggested:"_getSuggested",MyGroups:"_getMyGroups",AllGroups:"_getAllGroups"},getTemplateData:function(){return{is_all:!this.options.tab,is_mine:"mine"===this.options.tab,is_suggested:"suggested"===this.options.tab}},_getHeader:function(){return new e(this.options)},_getSuggested:function(){return new f(this.options)},_getMyGroups:function(){return new g(this.options)},_getAllGroups:function(){return new h(this.options)}})}),define("stache!workfeed/lib/app/header/external_group_responder",["mustache"],function(a){var b='<div class="yj-external-group-responder--text">\n  {{{repsonderText}}}\n</div>\n<div class="yj-external-group-responder--buttons-container">\n  <button class="yj-btn yj-external-group-responder--accept">{{accept}}</button>\n  <button class="yj-btn yj-external-group-responder--reject">{{reject}}</button>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/header/external_group_responder",[],function(){}),define("workfeed/lib/app/header/external_group_responder",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","components/network_label/index","backbone","core/lib/model_helper","common-ui/lib/ui/permalinks","core/lib/backbone_with_subviews","core/lib/tr","core/lib/yammer_api","models/lib/helper/external_groups_response_helper","html!./external_group_responder","css!./external_group_responder"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("components/network_label/index"),f=a("backbone"),g=a("core/lib/model_helper"),h=a("common-ui/lib/ui/permalinks"),i=a("core/lib/backbone_with_subviews"),j=a("core/lib/tr"),k=a("core/lib/yammer_api"),l=a("models/lib/helper/external_groups_response_helper"),m=a("html!./external_group_responder");return a("css!./external_group_responder"),c.extend({mixins:[d,i],events:{"click .yj-external-group-responder--accept":"_accept","click .yj-external-group-responder--reject":"_reject"},template:m,views:{NetworkLabel:"_getNetworkLabel"},className:"yj-external-group-responder",initialize:function(){var a=this.model.get("membership"),b=a?a.added_by_user_id:null;b&&(this._inviter=g.objectForReference({type:"user",id:b}))},getTemplateData:function(){var a=this._inviter?h(this._inviter):"";return{repsonderText:j.t("external_groups_responder_message",{span:'<span class="yj-external-group-responder--user-name">{$0}</span>',user:a}),accept:j.t("external_groups_responder_accept_label"),reject:j.t("external_groups_responder_reject_label")}},render:function(){return f.trigger("/ui/hovercard/build",this.$el,".yj-hovercard-link"),this},_getNetworkLabel:function(){return new e({model:this.model})},_accept:function(){this._disableButtons(),k.approveGroupMembership({group_id:this.model.get("id")}).then(b.bind(this._handleAcceptSuccess,this),b.bind(this._handleAcceptError,this))},_reject:function(){this._disableButtons(),k.denyGroupMembership({group_id:this.model.get("id")}).then(b.bind(this._handleRejectSuccess,this),b.bind(this._handleRejectError,this))},_handleAcceptSuccess:function(){l.acceptGroupMembershipInUI(this.model.get("id"))},_handleRejectSuccess:function(){l.rejectGroupMembershipInUI(this.model.get("id"))},_disableButtons:function(){this.$(".yj-external-group-responder--accept").addClass("yj-btn-disabled"),this.$(".yj-external-group-responder--reject").addClass("yj-btn-disabled")},_enableButtons:function(){this.$(".yj-external-group-responder--accept").removeClass("yj-btn-disabled"),this.$(".yj-external-group-responder--reject").removeClass("yj-btn-disabled")},_handleAcceptError:function(){f.trigger("/ui/alert/show","error",j.t("error_accepting_group")),this._enableButtons()},_handleRejectError:function(){f.trigger("/ui/alert/show","error",j.t("error_rejecting_group")),this._enableButtons()}})}),define("workfeed/lib/app/helpers/group_error_helper",["require","core/lib/location_helper","core/lib/session","core/lib/tr","core/lib/yammer_uri","models/helpers/user","models/helpers/group"],function(a){var b=a("core/lib/location_helper"),c=a("core/lib/session"),d=a("core/lib/tr"),e=a("core/lib/yammer_uri"),f=a("models/helpers/user"),g=a("models/helpers/group");return{_handles:{private:{notice:d.t("this_group_is_private_request_to_join_to_view_its")},foreign:{notice:d.t("only_members_of_the_parent_network_can_view_this_group")},not_found:{notice:d.t("that_group_was_not_found_redirecting"),redirect:"/groups"},deleted:{notice:d.t("this_group_has_been_deleted")},external:{},unknown:{notice:d.t("an_error_occurred"),redirect:"/"}},getErrorForGroup:function(a){var b=c.getCurrentUser();return null==a?"empty":g.isDeleted(a)?"deleted":g.isExternal(a)&&f.isInvitedToGroup(b,a.get("id"))?"external":g.isExternal(a)&&g.isCurrentUserMember(a)?null:g.isForeign(a,c)?"foreign":g.isVisibleByCurrentUser(a,c)?void 0:"private"},getErrorForStatus:function(a){switch(a){case 403:return"private";case 404:return"not_found";case 410:return"deleted";default:return"unknown"}},getNotice:function(a){return this._getHandle(a).notice},redirectIfNeeded:function(a){var c=this._getHandle(a).redirect;c&&b.assign(e.app(c))},_getHandle:function(a){return this._handles[a]||this._handles.unknown}}}),define("stache!workfeed/lib/app/header/group_error_notice",["mustache"],function(a){var b='{{#showResponder}}<ExternalGroupResponder key="external-group-responder"/>{{/showResponder}}\n{{^showResponder}}<div class="notice">{{noticeText}}</div>{{/showResponder}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/header/group_error_notice",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","workfeed/lib/app/header/external_group_responder","workfeed/lib/app/helpers/group_error_helper","html!./group_error_notice"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("workfeed/lib/app/header/external_group_responder"),f=a("workfeed/lib/app/helpers/group_error_helper"),g=a("html!./group_error_notice");return c.extend({mixins:[b,d],template:g,views:{ExternalGroupResponder:"_createExternalGroupResponder"},initialize:function(){f.redirectIfNeeded(this.options.error)},_createExternalGroupResponder:function(){return new e({model:this.options.group})},getTemplateData:function(){return{showResponder:this.options.group&&"external"===this.options.error,noticeText:this._getErrorText()}},_getErrorText:function(){return f.getNotice(this.options.error)}})}),define("stache!common-ui/lib/ui/groups/member_list_admin",["mustache"],function(a){var b='<ul class="yj-action-list">\n{{#is_admin}}\n  <li class="yj-selector-action yj-action-list-item" data-action="selector-method-preview" data-selector-menu-link="true">\n    <a href="javascript://" class="yj-action-list-link group-action-revoke-admin sprite-parent">\n      <div class="yj-action-list-item--icon">\n        <span class="yamicon yamicon-inline yamicon-remove-star"></span>\n      </div>\n      <div class="yj-action-list-item--text">\n        {{revokeAdmin}}\n      </div>\n    </a>\n  </li>\n{{/is_admin}}\n{{^is_admin}}\n  {{^is_external}}\n  <li class="yj-selector-action yj-action-list-item" data-action="selector-method-preview" data-selector-menu-link="true">\n    <a href="javascript://" class="yj-action-list-link group-action-make-admin sprite-parent">\n      <div class="yj-action-list-item--icon">\n        <span class="yamicon yamicon-inline yamicon-add-star"></span>\n      </div>\n      <div class="yj-action-list-item--text">\n        {{makeAdmin}}\n      </div>\n    </a>\n  </li>\n  {{/is_external}}\n{{/is_admin}}\n  <li class="yj-selector-action yj-action-list-item" data-action="selector-method-preview" data-selector-menu-link="true">\n    <a href="javascript://" class="yj-action-list-link group-action-remove-member sprite-parent">\n      <div class="yj-action-list-item--icon">\n        <span class="yamicon yamicon-inline yamicon-remove-user"></span>\n      </div>\n      <div class="yj-action-list-item--text">\n        {{removeFromGroup}}\n      </div>\n    </a>\n  </li>\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/groups/member_list_item",["mustache"],function(a){var b='<li class="member-row yj-clearfix{{#hidden}} yj-hidden{{/hidden}}">\n  <div class="member-thumb" data-id="{{id}}"><Avatar/></div>\n  <div class="member-info{{#pending}}{{#canAddMembers}} is-approvable{{/canAddMembers}}{{/pending}}{{#suggested}} is-suggested{{/suggested}}">\n    {{#url}}\n    <span class="username" title="{{name}}"><a class="yj-member-list-item--username-link" href="{{url}}" data-id="{{id}}"><span class="yj-member-list-item--username-text">{{name}}</span><NetworkLabel/></a></span>\n    {{/url}}\n    {{^url}}\n    <span class="username{{#is_domain}} is-domain{{/is_domain}}">{{name}}</span>\n    {{/url}}\n    <div class="member-title" title="{{title}}">\n        {{#is_admin}}\n          ({{{svgIconAdmin}}} {{adminText}})\n        {{/is_admin}}\n      {{title}}\n    </div>\n  </div>\n  {{#pending}}\n    <div class="member-actions" data-user-id="{{id}}" data-user-name="{{name}}" data-user-title="{{title}}"{{#is_suggested}} data-suggested="true"{{/is_suggested}}>\n      {{#canAddMembers}}\n        <a href="javascript://" class="yj-btn yj-btn-alt group-action-deny" role="button">{{denyText}}</a><a href="javascript://" class="yj-btn group-action-approve" role="button">{{approveText}}</a>\n      {{/canAddMembers}}\n    </div>\n  {{/pending}}\n  {{^pending}}\n    <div class="member-actions" data-user-id="{{id}}" data-user-name="{{name}}" data-user-title="{{title}}" data-type="{{type}}" data-is-admin="{{is_admin}}" data-is-external="{{is_external}}">\n      {{#suggested}}\n        <a href="javascript://" class="yj-btn yj-btn-small group-action-add-member" role="button">{{addText}}</a></div>\n      {{/suggested}}\n    </div>\n  {{/pending}}\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/groups/member_list_item",[],function(){}),define("common-ui/lib/ui/groups/member_list_item",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","core/lib/session","core/lib/yammer_uri","models/user","components/avatar/index","common-ui/lib/helper/svg_icon","components/network_label/index","feeds/lib/ui/shared/simple_menu","models/helpers/user","html!./member_list_admin","html!./member_list_item","css!./member_list_item"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g=a("core/lib/session"),h=a("core/lib/yammer_uri"),i=a("models/user"),j=a("components/avatar/index"),k=a("common-ui/lib/helper/svg_icon"),l=a("components/network_label/index"),m=a("feeds/lib/ui/shared/simple_menu"),n=a("models/helpers/user"),o=a("html!./member_list_admin"),p=a("html!./member_list_item");return a("css!./member_list_item"),c.extend({template:p,className:"yj-member-list-item external_groups_v1",mixins:[d,e],views:{Avatar:"_getAvatar",NetworkLabel:"_getNetworkLabel"},initialize:function(){this._isItemInInvitedState()&&(this.model.title=f.t("invited"))},render:function(){return this.model.showAdminMenu&&this._createAdminMenu(),this},getTemplateData:function(){var a={width:14,height:14},c=k("avatar-badge-admin",a);return b.extend({external_groups_v1:!0,is_external:this._isItemExternal(),is_domain:"domain"===this.model.type,is_suggested:"suggested"===this.model.group_member_state,svgIconAdmin:c},this.model,this._getStrings())},_createAdminMenu:function(){var a='<span class="yj-acc-hidden">'+f.t("actions")+"</span>",b='<a class="yj-member-list-item--menu-selector" href="javascript:void(0)" role="button" aria-haspopup="true" data-selector-menu-link="true" data-speechtip><span class="yamicon yamicon-rd_gear">'+a+"</span></a>",c={id:"groupAdminActions",className:"yj-selector-simple-menu",align:"right",button:b,menuContent:o({is_external:this._isItemExternal(),is_admin:"true"===this.$(".member-actions").attr("data-is-admin"),revokeAdmin:f.t("revoke_admin"),makeAdmin:f.t("make_admin"),removeFromGroup:f.t("remove_from_group")})};this.menu=new m(c,this),this.$(".member-actions").append(this.menu.render().$el)},_isItemInInvitedState:function(){return"invited"===this.model.group_member_state},_isItemExternal:function(){return"domain"===this.model.type?!0:n.isForeign(this.model,g)},_getAvatar:function(){return new j({model:this._getUserModel(),hideFromAccessibility:!0,withHovercard:!1,size:32})},_getNetworkLabel:function(){return new l({model:this._getUserModel()})},_getUserModel:function(){var a=this.model;return new i({id:a.id,type:a.type,full_name:a.name,web_url:h.app()+"/users/"+a.id,mugshot_url:a.thumbnail,network_id:a.network_id,network_name:a.network_name,email:a.email})},_getStrings:function(){return{adminText:f.t("admin"),
approveText:f.t("approve"),denyText:f.t("deny"),addText:f.t("add_to_group"),adminMenuAltText:f.t("actions")}}})}),define("stache!common-ui/lib/ui/groups/member_list_item_header",["mustache"],function(a){var b='<div class="sub-heading" title="{{name}}">{{name}}</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/groups/member_list_no_results",["mustache"],function(a){var b='<div class="yj-member-list-2--no-results">{{noResultsText}}</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/groups/member_list",[],function(){}),define("stache!common-ui/lib/ui/groups/member_list",["mustache"],function(a){var b='<div class="group-members-container">\n  <h1 class="yj-member-list-2--header" id="yj-simple-lightbox--title">\n    {{groupMembersTitle}} {{#showMembersCount}}(<span class="yj-member-list-2--count">{{groupMembersCount}}</span>){{/showMembersCount}}\n  </h1>\n  <div class="bubble-type-ahead yj-clearfix">\n    <span class="yamicon yamicon-rd_search yamicon-med yj-member-list-2--search-icon"></span>\n    <span class="yj-inline-spinner yj-member-list-2--search-spinner"></span>\n    <label><span class="yj-acc-hidden">{{hintMessage}}</span>\n      <input type="text" class="yj-group-ta-input" autocomplete="off" placeholder="{{hintMessage}}">\n    </label>\n    <a href="javascript://" role="button" class="yj-member-list-2--clear-search yj-search-icon" style="display:none;">\n      <span class="yamicon yamicon-x yamicon-xx-small"></span>\n    </a>\n  </div>\n  <div class="autocomplete-list-container yj-container" style="display:none;">\n    <div class="sub-heading" style="display:none;">{{memberTitle}}</div>\n    <ul class="autocomplete-list"></ul>\n    <div class="suggested-spacer"></div>\n    <div class="suggested-heading" style="display:none;">{{suggestedText}}</a></div>\n    <ul class="suggestion-list"></ul>\n    <div class="view-more suggested-more" style="display:none;"><a href="#" role="button" class="group-action-more">{{viewMore}}</a></div>\n    <div class="add-more" style="display:none;">\n      {{noPendingUsersText}}\n    </div>\n    <div class="spinner-container"><span class="yj-inline-spinner"></span></div>\n  </div>\n  <div class="y-alert y-alert-error" style="display:none;"></div>\n  <div class="member-list-container yj-container">\n    <div class="pending-member-list-container" style="display:none;">\n      <div class="sub-heading pending">{{pendingTitle}}</div>\n      <ul class="pending-member-list"></ul>\n    </div>\n    <div class="sub-heading" style="display:none;">\n      {{^isExternal}}{{memberTitle}}{{/isExternal}}\n      {{#isExternal}}{{currentNetworkName}}{{/isExternal}}\n    </div>\n    <ul class="member-list"></ul>\n    <div class="spinner-container"><span class="yj-inline-spinner"></span></div>\n    <div class="add-more" style="display:none;">\n      {{noPendingUsersText}}\n    </div>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/groups/member_list_admin_badge",["mustache"],function(a){var b='<span class="y-badge admin-badge">{{{svgIconAdmin}}} {{admin}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/groups/member_list",["require","jquery","underscore","core/lib/ctor","core/lib/jam/component2","core/lib/promise","common-ui/lib/ui/shared/scroll_watcher","collections/group_memberships","core/lib/namespace","backbone","core/lib/yammer_request","core/lib/yammer_uri","core/lib/yammer_api","core/lib/session","core/lib/tr","common-ui/lib/helper/svg_icon","common-ui/lib/ui/shared/autocompletion","common-ui/lib/ui/shared/autocompletion/autocomplete_models","collections/groups","common-ui/lib/ui/groups/member_list_item","core/lib/util/email_extractor","components/simple_lightbox/index","models/helpers/avatar","models/helpers/user","models/helpers/network","models/helpers/group","core/lib/urls","models/user","models/unknown","html!./member_list_item_header","html!./member_list_no_results","css!./member_list","html!./member_list","html!./member_list_admin","html!./member_list_admin_badge"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/ctor"),e=a("core/lib/jam/component2"),f=a("core/lib/promise"),g=a("common-ui/lib/ui/shared/scroll_watcher"),h=a("collections/group_memberships"),i=a("core/lib/namespace"),j=a("backbone"),k=a("core/lib/yammer_request"),l=a("core/lib/yammer_uri"),m=a("core/lib/yammer_api"),n=a("core/lib/session"),o=a("core/lib/tr"),p=a("common-ui/lib/helper/svg_icon"),q=a("common-ui/lib/ui/shared/autocompletion"),r=a("common-ui/lib/ui/shared/autocompletion/autocomplete_models"),s=a("collections/groups"),t=a("common-ui/lib/ui/groups/member_list_item"),u=a("core/lib/util/email_extractor"),v=a("components/simple_lightbox/index"),w=a("models/helpers/avatar"),x=a("models/helpers/user"),y=a("models/helpers/network"),z=a("models/helpers/group"),A=a("core/lib/urls"),B=a("models/user"),C=a("models/unknown"),D=a("html!./member_list_item_header"),E=a("html!./member_list_no_results");a("css!./member_list");var F=d("yam.ui.groups.MemberList",e,{id:"MemberList",cssClass:"external_groups_v1",hintMessage:o.t("search_group_members"),addText:o.t("cant_find_who_youre_looking_for"),addLinkText:o.t("add_them_to_this_network"),addMembersText:o.t("add_them_to_this_group"),pendingTitle:o.t("pending_members"),memberTitle:o.t("group_members"),suggestedText:o.t("suggested_people_for_this_group"),viewMoreText:o.t("view_more_results_from_this_network"),noResultsText:o.t("sorry_we_couldnt_find_that_group_member"),noPendingUsersText:o.t("member_list_no_pending_users_notice"),makeAdminUrl:"/group_members/make_admin",revokeAdminUrl:"/group_members/revoke_admin",addMemberUrl:"/group_members/add_member",noPhotoUrl:"/images/48x48/no_photo.png",autocompleteFetchSize:50,suggestionCount:50,adminList:[],groupMembersTitle:o.t("group_members_title"),showMembersCount:!0,events:{"keyup .yj-group-ta-input":"handleSearchKey","click .yj-member-list-2--clear-search":"handleAutocompleteClose","click .group-action-make-admin":"handleMakeAdmin","click .group-action-revoke-admin":"handleRevokeAdmin","click .group-action-remove-member":"handleRemoveMember","click .group-action-add-member":"handleAddMember","click .group-action-approve":"handleApproveMember","click .group-action-deny":"handleDenyMember","click .group-action-more":"handleViewMore"},template:a("html!./member_list"),adminMenuTemplate:a("html!./member_list_admin"),adminBadgeTemplate:a("html!./member_list_admin_badge"),onTemplating:function(a){if(a.model.addText=this.addText,a.model.addLinkText=this.addLinkText,a.model.hintMessage=this.hintMessage,a.model.noPendingUsersText=this.noPendingUsersText,z.canCurrentUserInviteMembers(this.group,n)&&(a.model.hintMessage=o.t("member_list_search_field_label")),a.model.pendingTitle=this.pendingTitle,a.model.memberTitle=this.memberTitle,a.model.isExternal=z.isExternal(this.group),a.model.currentNetworkName=n.getCurrentNetwork().name,a.model.viewMore=this.viewMoreText,a.model.suggestedText=this.suggestedText,a.model.addMembersText=this.addMembersText,a.model.groupMembersTitle=this.groupMembersTitle,this.showMembersCount){a.model.showMembersCount=this.showMembersCount;var b=this.group.get("stats");a.model.groupMembersCount=b?b.members:0}return a},onLoad:function(){"number"==typeof this.groupId&&(this.groupId=this.groupId.toString()),this.group=s.get(this.groupId),this._avatars=[],this._networkLabels=[],this._members=[]},destroy:function(){e.prototype.destroy.call(this)},onRendered:function(){this.$searchSpinner=this.$el.find(".yj-member-list-2--search-spinner"),this.$searchFieldIcon=this.$el.find(".yj-member-list-2--search-icon"),this.$alert=this.$el.find(".y-alert"),this.$spinner=this.$el.find(".spinner-container"),this.$memberList=this.$el.find(".member-list"),this.$suggestionList=this.$el.find(".suggestion-list"),this.$autocompleteClose=this.$el.find(".yj-member-list-2--clear-search"),this.$pendingTitle=this.$el.find(".pending"),this.$searchIcon=this.$el.find(".yamicon-search"),this.$searchField=this.$el.find(".yj-group-ta-input"),this.$autocompleteList=this.$el.find(".autocomplete-list"),this.$pendingMemberList=this.$el.find(".pending-member-list"),this.$memberListContainer=this.$el.find(".member-list-container"),this.$autocompleteListContainer=this.$el.find(".autocomplete-list-container"),this.$suggestionHeading=this.$autocompleteListContainer.find(".suggested-heading"),this.$autocompleteViewMore=this.$autocompleteListContainer.find(".view-more"),this.$memberViewMore=this.$memberListContainer.find(".view-more"),this.$autocompleteListHeading=this.$autocompleteListContainer.find(".sub-heading"),this.$pendingMemberListContainer=this.$el.find(".pending-member-list-container"),this.$pendingCount=b(".num-pending"),q.prefetch(),this.loadMemberList()},handleSearchKey:function(a){if(this._shouldRunSubmit(a))this.$(".group-action-add-member").trigger("click");else{var b=this.$searchField.val();b!==this.prefix&&(this.prefix=b,this.handleFilter(b))}},_shouldRunSubmit:function(a){var b=13===a.keyCode,c=this._isMultipleEmails("domain",this.$searchField.val()),d=1===this.$(".group-action-add-member").length;return b&&d&&c},_showSearchSpinner:function(){this.$searchFieldIcon.hide(),this.$searchSpinner.show()},_hideSearchSpinner:function(){this.$searchSpinner.hide(),this.$searchFieldIcon.show()},handleFilter:function(a){if(a){this.$(".bubble-type-ahead").removeClass("is-not-headed"),this.$memberListContainer.hide(),this.$alert.hide(),this.$autocompleteListContainer.show(),this._showSearchSpinner(),this.$autocompleteListContainer.addClass("is-loading"),this.$autocompleteClose.show(),this.$searchIcon.hide();var b={prefix:a,models:[r.USER.id],unoptimizeResults:!0};this.timeout&&window.clearTimeout(this.timeout),this.timeout=window.setTimeout(c.bind(function(){this.timeout=null,this.loadPromise=f.when("ac-cache","sug-cache").then(this,this.promiseResults),this.ajaxACPromise=f.when("ac-ajax","sug-cache").then(this,this.promiseResults),this.ajaxSugPromise=f.when("ac-cache","sug-ajax").then(this,this.promiseResults),this.ajaxBothPromise=f.when("ac-ajax","sug-ajax").then(this,this.promiseResults),q.noThrottleGet(c.extend({},b,{data:{presence:!0,userGroupIds:this.groupId},fetchSize:this.autocompleteFetchSize,filter:c.bind(function(a){return this.filterResults(a,this.userInGroupFilter,this.autocompleteFetchSize)},this),success:c.bind(function(a){this.loadPromise&&this.ajaxACPromise&&this.ajaxBothPromise&&this.ajaxSugPromise&&(this.loadPromise.getPromise().getConditions()["ac-cache"].isSatisfied()?(this.ajaxACPromise.satisfy("ac-ajax",a),this.ajaxBothPromise.satisfy("ac-ajax",a)):(this.loadPromise.satisfy("ac-cache",a),this.ajaxSugPromise.satisfy("ac-cache",a)))},this),error:c.bind(function(){this.loadPromise&&this.ajaxACPromise&&this.ajaxBothPromise&&this.ajaxSugPromise&&(this.loadPromise.getPromise().getConditions()["ac-cache"].isSatisfied()?(this.ajaxACPromise.satisfy("ac-ajax",{user:[]}),this.ajaxBothPromise.satisfy("ac-ajax",{user:[]})):(this.loadPromise.satisfy("ac-cache",{user:[]}),this.ajaxSugPromise.satisfy("ac-cache",{user:[]})))},this)})),this.canAddMembers?q.noThrottleGet(c.extend({},b,{data:{presence:!0,excludeUserGroupIds:this.groupId},fetchSize:this.suggestionCount,filter:c.bind(function(a){return this.filterResults(a,this.userNotInGroupFilter,this.suggestionCount)},this),success:c.bind(function(a){this.loadPromise&&this.ajaxACPromise&&this.ajaxBothPromise&&this.ajaxSugPromise&&(this.loadPromise.getPromise().getConditions()["sug-cache"].isSatisfied()?(this.ajaxSugPromise.satisfy("sug-ajax",a),this.ajaxBothPromise.satisfy("sug-ajax",a)):(this.loadPromise.satisfy("sug-cache",a),this.ajaxACPromise.satisfy("sug-cache",a)))},this),error:c.bind(function(){this.loadPromise&&this.ajaxACPromise&&this.ajaxBothPromise&&this.ajaxSugPromise&&(this.loadPromise.getPromise().getConditions()["ac-cache"].isSatisfied()?(this.ajaxSugPromise.satisfy("sug-ajax",{user:[]}),this.ajaxBothPromise.satisfy("sug-ajax",{user:[]})):(this.loadPromise.satisfy("sug-cache",{user:[]}),this.ajaxACPromise.satisfy("sug-cache",{user:[]})))},this)})):(this.loadPromise.satisfy("sug-cache",{user:[]}),this.ajaxACPromise.satisfy("sug-cache",{user:[]}),this.ajaxSugPromise.satisfy("sug-ajax",{user:[]}),this.ajaxBothPromise.satisfy("sug-ajax",{user:[]}))},this),200)}else this.handleAutocompleteClose()},_separateUserListByNetworks:function(a){return c.reduce(a,function(a,b){return a[b.network_id]||(a[b.network_id]=[]),a[b.network_id].push(b),a},{})},_getNetworksFromUserList:function(a){return c.reduce(a,function(a,b){return a[b.network_name]||(a[b.network_name]=b.network_id),a},{})},_sortUserListByNetworkName:function(a){var b=this._separateUserListByNetworks(a),d=this._getNetworksFromUserList(a),e=c.keys(d).sort(),f=c.reduce(e,function(a,e){var f=d[e];return c.union(a,b[f])},[]);return f},promiseResults:function(a){this.$autocompleteList.empty(),this.$suggestionList.empty(),this.$autocompleteListHeading.hide(),this._hideSearchSpinner(),this.$autocompleteListContainer.removeClass("is-loading"),this.$autocompleteListContainer.find(".add-more").hide();var b=i.val(a,"ac-ajax._data.user")||i.val(a,"ac-cache._data.user"),d=i.val(a,"sug-ajax._data.user")||i.val(a,"sug-cache._data.user"),e=function(a){return a.network_id=parseInt(a.network_id,10),a.network_name||(a.network_name=u.getDomainFromEmail(a.email)),a},f=function(a){if(!c.isEmpty(a.group_membership_objects)){var b=c.findWhere(a.group_membership_objects,{group_id:this.group.get("id")+""});if(b)switch(b.state){case"INVITED":a.group_member_state="invited"}}return a},g=function(a,b){return z.isModerated(a)&&!z.canCurrentUserAddMembers(a,n)&&Number(b.network_id)===a.get("network_id")},h=function(a,b){return!z.isExternal(a)&&x.isForeign(b,n)},j=function(a,b){var c=g(a,b)||h(a,b);return!c};if(b){b=c.map(b,e),b=c.map(b,f,this);var k=this._sortUserListByNetworkName(b),l=this.buildMemberList(k,{showAdminMenu:this.showAdminMenu,pending:!1});c.each(l,function(a){this.$autocompleteList.append(a)},this)}var m=0,o=0;d&&(d=d.filter(c.partial(j,this.group)).map(e),c.each(d,function(a){this.$suggestionList.append(this.renderUser(a,{suggested:!0,hidden:!1})),o++},this),m+=c.size(d));var p=this.$searchField.val();if(this.canAddMembers){var r=n.getCurrentNetwork(),s=z.isExternal(this.group)&&y.isExternalMessagingEnabled(r),t=r.community,v=this._isAllowedToInviteFromOutsideNetwork(),w=-1!==p.lastIndexOf("@"),A=w&&!t&&this._isMultipleEmails("domain",p),B=w&&t&&v,C=w&&s,D=[];if(A||B||C){var F={id:p,name:p,type:"domain"};D.push(F)}var G="";w&&(G=p.substring(p.indexOf("@")+1));var H=c.select(q.domainMatches,function(a){return 0===a.name.indexOf(G)});u.hasValidFirstHalfOfEmail(p+"@")&&(p=p.replace(/@.*/,""),c.each(H,function(a){var b=p+"@"+a.name,c={id:b,name:b,type:"domain"};D.push(c)},this)),D=c.filter(D,function(a){var e=!!c.findWhere(b,{email:a.name}),f=!!c.findWhere(d,{email:a.name});return!e&&!f}),c.each(D,function(a){this.$suggestionList.append(this.renderDomain(a,{suggested:!0,hidden:!1})),o++,m++},this)}this.$autocompleteViewMore.hide(),this.canAddMembers&&this.$autocompleteListContainer.find(".add-more").show(),0===m?this.$suggestionHeading.hide():this.$suggestionHeading.show(),b&&c.size(b)>0?this.$autocompleteListHeading.show():(!this.canAddMembers||!b||c.size(b)<=0)&&(this.$autocompleteListHeading.show(),this.$autocompleteList.append(E({noResultsText:this.noResultsText})))},handleAutocompleteClose:function(){this.$autocompleteListContainer.hide(),this.$autocompleteListHeading.hide(),this.$memberListContainer.show(),this.$autocompleteClose.hide(),this.$autocompleteList.empty(),this.$autocompleteViewMore.hide(),this.$suggestionList.empty(),this.$searchIcon.show(),this.$suggestionHeading.hide(),this.$searchField.val(""),this.pendingCount+this.suggestedCount===0?this.$(".bubble-type-ahead").addClass("is-not-headed"):this.$(".bubble-type-ahead").removeClass("is-not-headed")},filterResults:function(a,b,d){var e={},f=n.getCurrentNetwork().id;return c.each(a,function(a,g){"user"==g?(e[g]=c.filter(a,function(a){var c=null!=a.network_id&&a.network_id!=f;return c&&!z.isExternal(this.group)?!1:b.call(this,a)},this),e[g].sort(function(a,b){var c=b.ranking-a.ranking;return 0!==c?c:parseInt(a.id,10)-parseInt(b.id,10)}),e[g].length>d&&(e[g]=e[g].splice(0,d))):e[g]=[]},this),e},userInGroupFilter:function(a){var b,d={group_id:this.groupId,user_id:a.id},e=C.findFirst({lookup_id:"gmr_"+this.groupId+"_"+a.id,type:"groupMembershipRemoved"});return b=h.findWhere(d),b||(b=[]),c.contains(a.group_ids,this.groupId)&&"undefined"==typeof e||b.length>0},userNotInGroupFilter:function(a){var b,d={group_id:this.groupId,user_id:a.id},e=C.findFirst({lookup_id:"gmr_"+this.groupId+"_"+a.id,type:"groupMembershipRemoved"});return b=h.findWhere(d),b||(b=[]),!c.contains(a.group_ids,this.groupId)&&0===b.length||"undefined"!=typeof e},handleViewMore:function(a){var c=b(a.target);a.preventDefault(),c.closest(".yj-container").find(".yj-hidden").removeClass("yj-hidden").end().find(".add-more").show().end().find(".view-more").hide()},renderUser:function(a,b){var d,e=B.findById(a.id);e?d=e:(d=a,d.mugshot_url=d.photo||d.mugshot_url||d.thumbnail,d=B.create(d));var f={id:d.id,is_admin:c.contains(this.adminList,""+d.id),is_online:d.presence,presence_icon_alt_text:"online"==d.presence?o.t("online"):o.t("offline"),name:d.full_name||d.name||d.email,permalink:d.name,thumbnail:w.getDefaultAvatar(d),title:d.job_title||a.title,url:A.userIndex(d,n),email:d.email,network_id:d.network_id||a.network_id,network_name:d.network_name||a.network_name,group_member_state:a.group_member_state,type:"user"},g=d.presence;delete d.presence,d.update(d),d.update({presence:g});var h=new t({model:c.extend({},f,b)});return h.render().$el},renderDomain:function(a,b){var d=new t({model:c.extend({},a,b)});return d.render().$el},saveMembership:function(a){var b,c={user_id:a,group_id:this.groupId},d=C.findFirst({lookup_id:"gmr_"+this.groupId+"_"+a,type:"groupMembershipRemoved"});d&&d.destroy(),b=h.add(c)},saveRemovedMembership:function(a){var b,c={user_id:a,group_id:this.groupId};b=h.add(c),b&&b.destroy(),C.create({lookup_id:"gmr_"+this.groupId+"_"+a,type:"groupMembershipRemoved"})},handleMakeAdmin:function(a){var d;d=b(a.currentTarget);var e=d.closest(".member-row"),f=e.find(".member-actions"),g=f.attr("data-user-id"),h=f.attr("data-user-name"),i=f.attr("data-user-title");this.adminRequest(this.makeAdminUrl,g,c.bind(function(){d.html('<span class="yamicon yamicon-remove-star"></span> '+o.t("revoke_admin")).removeClass("group-action-make-admin").addClass("group-action-revoke-admin"),e.find(".member-title").html("("+p("avatar-badge-admin",{width:14,height:14})+o.t("admin")+") "+i),f.attr("data-is-admin",!0),j.trigger("/ui/alert/show","notice",o.t("name_is_now_an_admin",{name:h})),this.adminList=c.union(this.adminList,[g])},this))},handleRevokeAdmin:function(a){var d=b(a.target),e=d.closest(".member-row"),f=e.find(".member-actions"),g=f.attr("data-user-id"),h=f.attr("data-user-name"),i=f.attr("data-user-title");this.adminRequest(this.revokeAdminUrl,g,c.bind(function(){d.html('<span class="yamicon yamicon-add-star"></span> '+o.t("make_admin")).removeClass("group-action-revoke-admin").addClass("group-action-make-admin"),e.find(".member-title").text(i),f.attr("data-is-admin",!1),j.trigger("/ui/alert/show","notice",o.t("name_is_no_longer_an_admin",{name:h})),this.adminList=c.without(this.adminList,g)},this))},handleRemoveMember:function(a){var c=b(a.target),d=c.closest(".member-row"),e=d.find(".member-actions"),f=e.attr("data-user-id"),g=e.attr("data-user-name"),h=this;m.deleteGroupMembership({group_id:this.group.id,user_id:f}).then(function(){z.removeMember(this.group,f),d.fadeOut(function(){b(this).remove();var a=h.$memberList.find('[data-user-id="'+f+'"]').closest("li");a.length&&a.remove()}),j.trigger("/ui/alert/show","notice",o.t("name_has_been_removed_from_the_group",{name:g})),this.decrementCounter(),this.saveRemovedMembership(f)}.bind(this))},handleAddMember:function(a){var d=b(a.target),e=d.closest(".member-row"),f=e.find(".member-actions"),g=f.attr("data-user-id"),h=f.attr("data-user-name"),i=f.attr("data-type"),k={invite_source:"group_add_member",bfr_source:"group_add_member",group_id:this.groupId},l=this._isMultipleEmails(i,h);"user"===i?k.user_id=g:"domain"===i&&(l?k.emails=h:k.email=h);var n=c.bind(function(a,b,c){this.$autocompleteListContainer.removeClass("is-loading"),z.addMember(this.group,g),this.loadMemberList(),this.handleAutocompleteClose();var d;if(200===c.status)d=l?o.t("users_added_successfully"):o.t("name_is_already_a_member_of_the_group");else{var e=a.state||a.status;switch(e){case"suggested":d=o.t("name_has_been_suggested_to_the_group",{name:h});break;case"invited":d=o.t("name_has_been_invited_to_the_group",{name:h});break;default:d=o.t("name_has_been_added_to_the_group",{name:h})}}j.trigger("/ui/alert/show","notice",d),this.incrementCounter(),this.saveMembership(g)},this),p=c.bind(function(){var a;a=l?o.t("no_users_added_email_invalid"):o.t("there_was_an_error_adding_the_user_to_the_group"),j.trigger("/ui/alert/show","error",a),this.$autocompleteListContainer.removeClass("is-loading")},this);this.$autocompleteListContainer.addClass("is-loading"),m.createGroupMembership(k).then(n,p)},handleApproveMember:function(a){var d=b(a.target),e=d.closest(".member-row"),f=e.find(".member-actions"),g=f.attr("data-user-id"),h=f.attr("data-user-name"),i=f.attr("data-suggested");m.approveGroupMembership({user_id:g,group_id:this.groupId}).then(c.bind(function(){e.fadeOut(function(){b(this).remove()}),j.trigger("/ui/alert/show","notice",o.t("name_has_been_added_to_the_group",{name:h})),this.incrementCounter(),i?this.decrementSuggestedCounter():this.decrementPendingCounter(),this.saveMembership(g),this.loadMemberList()},this))},handleDenyMember:function(a){var d=b(a.target),e=d.closest(".member-row"),f=e.find(".member-actions"),g=f.attr("data-user-id"),h=f.attr("data-user-name"),i=f.attr("data-suggested");m.denyGroupMembership({user_id:g,group_id:this.groupId}).then(c.bind(function(){e.remove(),b(".pending-member-list .member-row").length<1&&this.$pendingMemberListContainer.hide(),j.trigger("/ui/alert/show","notice","Request from "+h+" has been denied."),i?this.decrementSuggestedCounter():this.decrementPendingCounter()},this))},adminRequest:function(a,b,c){k.send({type:"post",url:encodeURI(l.app())+a,dataType:"text",data:{user_id:b,group_id:this.groupId},success:function(a){c.call(this,a)}})},incrementCounter:function(){var a=this.memberCount;this.updateCounter(a>0?a+1:1)},decrementCounter:function(){var a=this.memberCount;this.updateCounter(a>0?a-1:0)},decrementPendingCounter:function(){var a=this.pendingCount;this.updatePendingCount(a>0?a-1:0)},decrementSuggestedCounter:function(){var a=this.suggestedCount;this.updatePendingCount(this.pendingCount,a>0?a-1:0)},updateCounter:function(a){this.memberCount=a,this.$memberCounter&&this.$memberCounter.length||(this.$memberCounter=b("#yj_cboxTitle .yj-count")),a&&a>0?this.$memberCounter.text(a).fadeIn():this.$memberCounter.fadeOut(),this.$(".yj-member-list-2--count").text(a)},updatePendingCount:function(a,b){var c=a+b;this.pendingCount=a,void 0!==b&&(this.suggestedCount=b),c&&c>0?this.$pendingCount.length>0&&this.$pendingCount.text(c):(this.$pendingCount.length>0&&this.$pendingCount.closest(".pending-requests").hide(),this.$pendingTitle.hide()),this.group.set("pending_requests_count",a),void 0!==b&&this.group.set("suggested_requests_count",b)},updatePendingCountFromUsers:function(a){var b=function(a){return"suggested"===a.group_member_state},d=c.reject(a,b).length,e=c.filter(a,b).length;this.updatePendingCount(d,e)},getNextPage:function(){this.$memberListContainer.addClass("loading"),k.send({url:encodeURI(l.app())+"/groups/"+encodeURIComponent(this.groupId)+"/get_members?page="+ ++this.memberPage,method:"GET",dataType:"json",success:c.bind(function(a){this.$memberListContainer.removeClass("loading");var b=c.map(a.users,function(a){return a.url=encodeURI(l.app())+"/users/"+a.id,a.type="user",a.network&&(a.network_id=a.network.id,a.network_name=a.network.name),a.group_member&&(a.group_member_state=a.group_member.state||a.group_member.status),a}),d=c.last(this._members),e=this.buildMemberList(b,{showAdminMenu:a.show_admin_menu,pending:!1},d.network_id);c.each(e,function(a){this.$memberList.append(a)},this),this._members=c.union(this._members,b),a.users.length>=50&&this.infiniteScroll.start()},this),error:this.handleMemberListFailure.bind(this)})},loadMemberList:function(){this._hRequest&&this._hRequest.abort(),this.$memberList.empty(),this.$pendingMemberList.empty(),this.$pendingMemberListContainer.hide(),this.$memberListContainer.addClass("loading"),this.$memberListContainer.find(".sub-heading").hide(),this.memberPage=1,this.infiniteScroll=new g({onReached:this.getNextPage.bind(this),$scrollableArea:this.$element.find(".member-list-container"),$contentArea:this.$element.find(".member-list")}),this._hRequest=k.send({url:encodeURI(l.app())+"/groups/"+encodeURIComponent(this.groupId)+"/get_members",method:"GET",dataType:"json",success:this.renderMemberList.bind(this),error:this.handleMemberListFailure.bind(this),complete:c.bind(function(){this.$memberListContainer.is(":visible")&&c.defer(c.bind(function(){this.$searchField.focus(),this.infiniteScroll.restart()},this))},this)})},handleMemberListFailure:function(){this.$memberListContainer.removeClass("loading"),this.$alert.text(o.t("could_not_load_the_members_list")).show()},buildMemberList:function(a,d,e){var f=[];return e=e||n.getCurrentNetwork().id,c.each(a,function(a){var c;if(a.network_id!==e){var g=b(D({name:a.network_name}));f.push(g),e=a.network_id}c="domain"===a.type?this.renderDomain(a,d):this.renderUser(a,d),f.push(c)},this),f},renderMemberList:function(a){this.$alert.hide(),this.$memberListContainer.removeClass("loading"),this.$memberListContainer.find(".add-more").show(),this.numMembers=a.total_members_count,this.showAdminMenu=a.show_admin_menu,this.adminList=c.chain(a.users).filter(function(a){return a.is_admin}).map(function(a){return""+a.id}).value();var b=c.map(a.users,function(a){return a.network&&(a.network_id=a.network.id,a.network_name=a.network.name),a.group_member&&(a.group_member_state=a.group_member.state||a.group_member.status),a.url=encodeURI(l.app())+"/users/"+a.id,a.type="user",a}),d=c.map(a.pending_users,function(a){return a.network&&(a.network_id=a.network.id,a.network_name=a.network.name),a.group_member&&(a.group_member_state=a.group_member.state||a.group_member.status),a.url=encodeURI(l.app())+"/users/"+a.id,a.type="user",a});if(a.self&&a.self.belong_to_group){a.self.is_online=!0,a.self.presence_icon_alt_text=o.t("online"),a.self.url=encodeURI(l.app())+"/users/"+a.self.permalink,a.self.type="user",a.self.network_id=n.getCurrentNetwork().id;var e=new t({model:c.extend({},a.self,{showAdminMenu:a.self.show_admin_menu,pending:!1})});this.$memberList.append(e.render().$el),a.self.is_admin&&(this.adminList=c.union(this.adminList,[""+a.self.id]))}this._members.push(a.self),this._members=c.union(this._members,b);var f=this.buildMemberList(b,{showAdminMenu:a.show_admin_menu,pending:!1});c.each(f,function(a){this.$memberList.append(a)},this),this.updateCounter(this.numMembers),this.canAddMembers=a.can_add_members,a.can_add_members?(c.each(d,function(b){var d="suggested"===b.group_member_state,e=z.canUserApproveMembers(this.group),f=d?e:a.can_add_members,g=new t({model:c.extend({},b,{canAddMembers:f,pending:!0})});this.$pendingMemberList.append(g.render().$el)},this),d&&d.length>0?(this.$memberListContainer.find(".sub-heading").show(),this.$pendingMemberListContainer.show(),this.updatePendingCountFromUsers(d)):this.$(".bubble-type-ahead").addClass("is-not-headed")):this.$(".bubble-type-ahead").addClass("is-not-headed")},_isAllowedToInviteFromOutsideNetwork:function(){var a=n.getCurrentUser(),b=n.getCurrentNetwork(),c=b.community;return!c||!y.isModerated(b)||x.isAdmin(a)},_isMultipleEmails:function(a,b){return"domain"===a&&b.match(/[,;]/)}});return F.showInLightbox=function(a){var b=new v({component:a,lbClass:"yj-member-list-2--lightbox",onComplete:c.bind(a.delegateEvents,a)});b.show()},yam.ui.groups.MemberList2=F,F}),define("stache!workfeed/lib/app/header/group_mugshot",["mustache"],function(a){var b='{{#upload_mugshot}}\n  <div class="edit-group yj-mugshot-form yj-mugshot-form-group yj-acc-fakefocus yj-want-focuswithin">\n    <label>\n      <div class="mugshot-container">\n        <img class="mugshot-img upload-photo yj-group-mugshot--mugshot-img" src="{{mugshot_url}}" alt="" title="{{mugshot_empty_title}}">\n      </div>\n      <input class="file-input" name="image" type="file" size="1" />\n    </label>\n  </div>\n{{/upload_mugshot}}\n{{^upload_mugshot}}\n  <a href="{{mugshot_url_fullsize}}" class="tightbox avatar" title="{{mugshot_title}}">\n    <img class="yj-group-mugshot--mugshot-img" src="{{mugshot_url}}" alt="{{group_name}}" title="{{mugshot_large_title}}">\n  </a>\n{{/upload_mugshot}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/header/group_mugshot",["require","core/lib/tr","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","workfeed/lib/modules/file_uploader","models/helpers/group","html!./group_mugshot","core/lib/treatment","core/lib/urls"],function(a){"use strict";var b=a("core/lib/tr"),c=a("backbone"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("workfeed/lib/modules/file_uploader"),g=a("models/helpers/group"),h=a("html!./group_mugshot"),i=a("core/lib/treatment"),j=a("core/lib/urls"),k=150,l=d.extend({mixins:[e],template:h,className:"thumbnail",attributes:{"data-qaid":"group_mugshot"},initialize:function(){this.listenTo(this.model,"change:mugshot_url_template",this.render),i.treatment("tow_group_header_color_customization")&&this.listenTo(c,"/ui/group/mugshotPreview",this._onMugshotPreview)},render:function(){var a=this.model;!g.hasMugshot(a)&&g.isCurrentUserAdmin(a)&&setTimeout(function(){new f({container:".edit-group.yj-mugshot-form",file:".edit-group.yj-mugshot-form .file-input",thumbnail:".edit-group.yj-mugshot-form .mugshot-container",dimensions:"group_thumbnail",updateViaApiMethod:"updateGroup",generateMugshotColor:!0,hoverButtonOnThumbnail:!0,apiParams:{id:a.get("id")},onMugshotUploaded:function(b,d,e){a.set("mugshot_id",b);var f=d.replace(/(images\/)(\d+)x(\d+)(.+)/,"$1{width}x{height}$4");a.set("mugshot_url",d),a.set("mugshot_url_template",f),e&&(a.set("color",e),c.trigger("/ui/group/setGroupColor",e,!0)),c.trigger("/ui/threads/inGroup/new_mugshot")}})},250)},getTemplateData:function(){var a=this.model;return{mugshot_url:j.groupMugshot(a,k),mugshot_url_fullsize:j.groupMugshotFullsize(a),mugshot_title:b.t("group_mugshot_title"),mugshot_large_title:b.t("group_mugshot_large_title"),mugshot_empty_title:b.t("group_mugshot_empty_title",{group:a.get("full_name")}),mugshot_empty_label:b.t("group_mugshot_empty_label"),group_name:a.get("full_name"),upload_mugshot:!g.hasMugshot(a)&&g.isCurrentUserAdmin(a)}},_onMugshotPreview:function(a){this.$el.find(".yj-group-mugshot--mugshot-img").attr("src",a)}});return l}),define("stache!workfeed/lib/app/header/group_type",["mustache"],function(a){var b='<span class="group-privacy group-type--tooltip">\n  {{#is_private}}\n    <span class="yamicon yamicon-lock-MSFT yamicon-xx-small yamicon-inline" data-qaid="lock_icon"></span>\n    <span class="yj-acc-hidden">{{private_group_label}}</span>\n  {{/is_private}}\n</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/header/group_type",[],function(){}),define("workfeed/lib/app/header/group_type",["require","backbone","core/lib/tr","core/lib/backbone_base_view","mustache","core/lib/backbone_with_auto_render","models/helpers/group","html!./group_type","css!./group_type.css"],function(a){
"use strict";var b=a("backbone"),c=a("core/lib/tr"),d=a("core/lib/backbone_base_view"),e=a("mustache"),f=a("core/lib/backbone_with_auto_render"),g=a("models/helpers/group"),h=a("html!./group_type");a("css!./group_type.css");var i=d.extend({mixins:[f],className:"type-inline-header",template:h,initialize:function(){this.listenTo(this.model,"change:privacy",this.render)},getTemplateData:function(){var a=this._getType();return{is_private:"private"===a,private_group_label:c.t("private_group_label")}},_getType:function(){var a,b=this.model;return a=g.isAllCompany(b)?"company":g.isRestricted(b)?"restricted":g.isPrivate(b)?"private":"public"},render:function(){var a,d,f=this._getType();return"company"===f?(a=c.t("company_group_tooltip_title"),d=c.t("company_group_tooltip_body")):"restricted"===f?(a=c.t("restricted_group_tooltip_title"),d=c.t("restricted_group_tooltip_body")):"private"===f?(a=c.t("private_group_tooltip_title"),d=c.t("private_group_tooltip_body")):(a=c.t("public_group_tooltip_title"),d=c.t("public_group_tooltip_body")),b.trigger("/ui/tooltip/add",{target:this.$(".group-privacy"),text:e.render("<h5>{{title}}</h5><p>{{body}}</p>",{title:a,body:d}),orientation:"right",validHTML:!0}),this}});return i}),define("stache!workfeed/lib/app/header/group_tabs",["mustache"],function(a){var b='<div class="filecollab-action-bar-with-tabs" role="navigation">\n  <div class="filecollab-action-bar-tabs {{#tow_group_color_customization}}tow-group-color-customization{{/tow_group_color_customization}}">\n    <ul class="yj-filecollab-tabs yj-group-tabs">\n      {{^joined_group}}\n        <li class="yj-filter-tab {{#conversations_selected}}yj-selected{{/conversations_selected}}">\n          <a href="{{conversations_url}}" class="yj-filter-tab-link yj-group-tabs--conversations-link" data-qaid="group-conversations-link">\n            {{conversations_label}}\n            <span class="yj-acc-hidden"> {{tab_label}}</span>\n            <span class="yj-acc-selectedstate"> {{selected_label}}</span>\n          </a>\n        </li>\n      {{/joined_group}}\n      {{#joined_group}}\n        <li class="yj-filter-tab {{#is_unviewed_selected}}yj-selected{{/is_unviewed_selected}} is-visible-docked">\n          <a href="{{unviewed_conversations_url}}" class="yj-filter-tab-link yj-group-tabs--unviewed-link" data-feed-type="unviewed" data-qaid="group-unread-conversations-link">\n            <span class="yj-group-tabs--full-label">{{unviewed_conversations_label}}</span>\n            <span class="yj-group-tabs--short-label">{{unviewed_label}}</span>\n            <UnseenThreadCountView key="unseen_thread_count"/>\n            <span class="yj-acc-hidden"> {{tab_label}}</span>\n            <span class="yj-acc-selectedstate"> {{selected_label}}</span>\n          </a>\n        </li>\n        <li class="yj-filter-tab {{#is_all_selected}}yj-selected{{/is_all_selected}} is-visible-docked">\n          <a href="{{all_conversations_url}}" class="yj-filter-tab-link yj-group-tabs--all-link" data-feed-type="all" data-qaid="group-all-conversations-link">\n            <span class="yj-group-tabs--full-label">{{all_conversations_label}}</span>\n            <span class="yj-group-tabs--short-label">{{all_label}}</span>\n            <span class="yj-acc-hidden"> {{tab_label}}</span>\n            <span class="yj-acc-selectedstate"> {{selected_label}}</span>\n          </a>\n        </li>\n      {{/joined_group}}\n\n      {{#show_files}}\n        <li class="yj-filter-tab {{#files_selected}}yj-selected{{/files_selected}}">\n          <a href="{{files_url}}" class="yj-filter-tab-link" id="yj-group-files-link">\n            {{files_label}}\n            <span class="yj-acc-hidden"> {{tab_label}}</span>\n            <span class="yj-acc-selectedstate"> {{selected_label}}</span>\n          </a>\n        </li>\n      {{/show_files}}\n      {{#show_notes}}\n        <li class="yj-filter-tab {{#notes_selected}}yj-selected{{/notes_selected}}">\n          <a href="{{notes_url}}" class="yj-filter-tab-link" id="yj-group-notes-link">\n            {{notes_label}}\n            <span class="yj-acc-hidden"> {{tab_label}}</span>\n            <span class="yj-acc-selectedstate"> {{selected_label}}</span>\n          </a>\n        </li>\n      {{/show_notes}}\n    </ul>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/header/group_tabs",[],function(){}),define("workfeed/lib/app/header/group_tabs",["require","underscore","core/lib/tr","core/lib/treatment","core/lib/location_helper","core/lib/session","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","feeds/lib/ui/groups/group_activity/unseen_thread_count","collections/group_memberships","models/lib/helper/feed_factory","core/lib/uri_helper","models/lib/model/helper/report_feed_events","models/helpers/user","models/helpers/group","core/lib/urls","html!./group_tabs","css!./group_tabs"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/treatment"),e=a("core/lib/location_helper"),f=a("core/lib/session"),g=a("core/lib/backbone_base_view"),h=a("core/lib/backbone_with_auto_render"),i=a("core/lib/backbone_with_subviews"),j=a("feeds/lib/ui/groups/group_activity/unseen_thread_count"),k=a("collections/group_memberships"),l=a("models/lib/helper/feed_factory"),m=a("core/lib/uri_helper"),n=a("models/lib/model/helper/report_feed_events"),o=a("models/helpers/user"),p=a("models/helpers/group"),q=a("core/lib/urls"),r=a("html!./group_tabs");a("css!./group_tabs");var s={conversations_label:c.t("group_tab_conversations_label"),unviewed_conversations_label:c.t("group_tab_unread_conversations_label"),unviewed_label:c.t("group_tab_unread_label"),all_conversations_label:c.t("group_tab_all_conversations_label"),all_label:c.t("group_tab_all_label"),files_label:c.t("group_tab_files_label"),notes_label:c.t("group_tab_notes_label"),tab_label:c.t("group_tab_label"),selected_label:c.t("group_tab_selected_label")},t=g.extend({mixins:[h,i],template:r,events:{"click .yj-filter-tab-link[data-feed-type]":"_logTabClickEvents","click .yj-filter-tab.yj-selected .yj-filter-tab-link":"_handleCurrentTabClick"},views:{UnseenThreadCountView:"_getUnseenThreadCount"},initialize:function(){this.listenTo(k,"add",this._onJoin),this.listenTo(k,"remove",this._onLeave),this.currentFeed=this._getCurrentFeed(),this.listenTo(this.currentFeed.feedCounter,"update",this._onFeedCountUpdate),this.listenTo(this.model,"change",b.debounce(this.render,100))},getTemplateData:function(){var a=this.model,g=f.getCurrentUser(),h=this._getConversationsUrl(),i=this._getConversationsUrl("unviewed"),j=this._getConversationsUrl("all"),k=q.groupMembers(a),l=q.groupFiles(a),m=q.groupNotes(a),n=e.href();d.treatment("tow_self_sufficient_groups_phase1")&&(s=b.extend(s,{unviewed_conversations_label:c.t("new_conversations")}));var p=b.extend({conversations_url:h,unviewed_conversations_url:i,all_conversations_url:j,joined_group:this._isJoined(),members_url:k,files_url:l,notes_url:m,is_unviewed_selected:this._isUnviewedSelected(),is_all_selected:this._isAllSelected(),conversations_selected:n.indexOf(h)>-1,files_selected:n===l,notes_selected:n===m,show_files:o.allowsFiles(g),show_notes:o.allowsNotes(g),tow_group_color_customization:d.treatment("tow_group_header_color_customization")},s);return p},_isJoined:function(){var a=this.model;return p.isCurrentUserMember(a)||p.isAllCompany(a)},_isUnviewedSelected:function(){return"unviewed"===this.options.view},_isAllSelected:function(){return"all"===this.options.view},_getConversationsUrl:function(a){var b=q.groupIndex(this.model);return a&&(b=m.replaceParam(b,"view",a)),b},_getCurrentFeed:function(){var a=this._isUnviewedSelected();return p.isAllCompany(this.model)?l.findOrCreate(a?"generalUnviewed":"general"):l.findOrCreate(a?"groupUnviewed":"group",this.model.get("id"))},_onJoin:function(a){this._handleMembershipChange(a,!0),this._clearUnreadCount()},_onLeave:function(a){this._handleMembershipChange(a,!1)},_handleMembershipChange:function(a,b){a.get("group_id")===this.model.get("id")&&a.get("user_id")===f.getCurrentUser().get("id")&&this.model.set({member:b}),this.render()},_clearUnreadCount:function(){var a=this.currentFeed.getLastSeenMessageId();this.currentFeed.feedCounter.markAllAsViewed(a)},_getUnseenThreadCount:function(){return this.unseenThreadCountView=new j({model:this._getCurrentFeed(),badgeLimit:80,slideClear:!0}),this.unseenThreadCountView},_onFeedCountUpdate:function(){this.unseenThreadCountView&&this.unseenThreadCountView.render()},_handleCurrentTabClick:function(){$("html").velocity("scroll",{offset:0})},_logTabClickEvents:function(a){var b,c=$(a.currentTarget).data("feed-type"),d=this.currentFeed;"unviewed"===c?b="unviewed_header_tab":"all"===c&&(b="all_header_tab"),b&&n.reportFeedEvent("feed_link_click",d.getLogSource(),d.getGroupId(),{link_type:b,feed_view:d.getLogFeedView()})}});return t}),define("workfeed/lib/app/helpers/layout",[],function(){return{twoColumnMainClass:"yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block"}}),define("stache!workfeed/lib/app/header/group_header_local_v2",["mustache"],function(a){var b='<div class="filecollab-group-header-basics">\n  <h2 class="yj-acc-hidden">{{group_accessible_header}}</h2>\n  <GroupMugshotView key="mugshot"/>\n\n  <div class="header-content">\n    <div class="header-cell-container">\n      <div class="header-cell">\n        <h2 data-qaid="group_name_label" role="presentation">\n          <span class="yj-group-header-local--group-name" title="{{name}}">{{name}}</span>\n          <GroupTypeView key="type"/>\n        </h2>\n\n        <div class="header-actions-container">\n          {{#show_join}}\n            <div class="join-links-container join-links-container-move-members">\n              <JoinLeaveButton key="join"/>\n            </div>\n          {{/show_join}}\n          <span class="yj-group-header-local--links">\n          {{#show_description}}\n            <a href="javascript://" class="yj-group-header-local--desc-link" title="{{group_description_label}}" role="button" data-resource-id="{{id}}" data-resource-model="group_description" data-delay="100" data-qaid="description_icon" data-speechtip>\n              <span class="yj-group-header-local--desc-icon yamicon yamicon-circle-italic yamicon-med"></span>\n              <span class="yj-acc-hidden">{{group_description_label}}</span>\n            </a>\n          {{/show_description}}\n          {{#show_settings}}\n            <a href="{{settings_url}}" class="yj-dark-gray yj-create-link" title="{{settings_title}}" data-qaid="settings_button" data-speechtip>\n              <span class="yamicon yamicon-settings yamicon-med">\n                <span class="yj-acc-hidden">{{settings_label}}</span>\n              </span>\n            </a>\n          {{/show_settings}}\n          </span>\n          {{#show_networks}}\n            <div class="header-external-label" title="{{networks}}">\n              <span class="yamicon yamicon-inline yamicon-network"></span><span class="header-external-label-text">{{networks}}</span>\n            </div>\n          {{/show_networks}}\n        </div>\n\n        {{#show_tabs}}\n          <GroupTabsView key="tabs"/>\n        {{/show_tabs}}\n      </div>\n    </div>\n  </div>\n\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/header/group_header_local_v2",[],function(){}),define("workfeed/lib/app/header/group_header_local_v2",["require","underscore","core/lib/tr","backbone","core/lib/session","models/network","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","common-ui/lib/ui/groups/member_list","common-ui/lib/ui/shared/follow_group_button","./group_mugshot","./group_type","./group_tabs","collections/groups","collections/group_memberships","models/helpers/external_group","workfeed/lib/app/helpers/layout","models/helpers/user","models/helpers/group","core/lib/urls","html!./group_header_local_v2","css!./group_header_local_v2"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("backbone"),e=a("core/lib/session"),f=a("models/network"),g=a("core/lib/backbone_base_view"),h=a("core/lib/backbone_with_auto_render"),i=a("core/lib/backbone_with_subviews"),j=a("common-ui/lib/ui/groups/member_list"),k=a("common-ui/lib/ui/shared/follow_group_button"),l=a("./group_mugshot"),m=a("./group_type"),n=a("./group_tabs"),o=a("collections/groups"),p=a("collections/group_memberships"),q=a("models/helpers/external_group"),r=a("workfeed/lib/app/helpers/layout"),s=a("models/helpers/user"),t=a("models/helpers/group"),u=a("core/lib/urls"),v=a("html!./group_header_local_v2");a("css!./group_header_local_v2");var w={settings_title:c.t("group_settings_title"),settings_label:c.t("group_settings_label"),group_description_label:c.t("group_description_header")},x=g.extend({mixins:[h,i],className:r.twoColumnMainClass+" page-header-local",template:v,views:{JoinLeaveButton:"_getJoinLeaveButton",GroupMugshotView:"_getGroupMugshot",GroupTypeView:"_getGroupType",GroupTabsView:"_getGroupTabs"},events:{"click .header-external-label":"_onNetworkListClick"},initialize:function(){this.listenTo(this.model,"change",b.debounce(this.render,100));var a=t.isModerated(this.model)?c.t("join_moderated_group"):c.t("join_group");b.extend(this.options,{followText:a,inHeader:!0}),p.on("add",this._onGroupMembershipCreate,this),p.on("remove",this._onGroupMembershipDestroy,this)},getTemplateData:function(){var a=this.model,c=u.groupSettings(a),d=a.get("full_name");return b.extend({id:a.get("id"),name:d,settings_url:c,show_join:!t.isAllCompany(a)&&t.isActive(a),show_description:this._hasDescriptionHovercard(),show_notices:!t.isAllCompany(a)&&this._isCurrentMember()&&!t.hasAdmin(a),show_settings:!t.isAllCompany(a)&&t.isEditableByCurrentUser(a),show_tabs:t.isVisibleByCurrentUser(a,e)&&!t.isDeleted(a),show_networks:t.isExternal(a)&&t.isVisibleByCurrentUser(a,e),networks:q.getParticipatingNetworksList(a,f),group_accessible_header:this._getAccessibleHeaderText(d)},w)},render:function(){this._addHovercard();var a=this._isCurrentMember();return(t.isAllCompany(this.model)||a&&!a.get("pending"))&&this._addColor(),this},remove:function(){return this._removeColor(),p.off("add",this._onGroupMembershipCreate),p.off("remove",this._onGroupMembershipDestroy),g.prototype.remove.call(this)},_addColor:function(){d.trigger("/ui/group/setHeaderJoin",!0)},_removeColor:function(){d.trigger("/ui/group/setHeaderJoin",!1)},_onGroupMembershipCreate:function(a){a.get("group_id")===this.model.get("id")&&(a.get("pending")||this._addColor())},_onGroupMembershipDestroy:function(a){a.get("group_id")===this.model.get("id")&&this._removeColor()},_addHovercard:function(){this._hasDescriptionHovercard()&&d.trigger("/ui/hovercard/build",this.$el,".yj-group-header-local--desc-link",{showOnClick:!0})},_getJoinLeaveButton:function(){return new k(this.options)},_getGroupMugshot:function(){return new l(this.options)},_getGroupType:function(){return new m(this.options)},_getGroupTabs:function(){return new n(this.options)},_isCurrentMember:function(){return s.isMemberOf(e.getCurrentUser(),o.get(this.model))},_hasDescriptionHovercard:function(){var a=this.model;return a.get("description")&&this._isCurrentMember()},_onNetworkListClick:function(a){a.preventDefault();var b=e.getCurrentNetwork(),c=new j({groupId:this.model.get("id"),permalink:this.model.get("name"),isCommunity:b.get("community")});j.showInLightbox(c)},_getAccessibleHeaderText:function(a){var b={groupname:a};return t.isDeleted(this.model)?c.t("group_header_accessible_heading_deleted",b):t.isExternal(this.model)&&t.isPrivate(this.model)?c.t("group_header_accessible_heading_external_private",b):t.isExternal(this.model)?c.t("group_header_accessible_heading_external",b):t.isPrivate(this.model)?c.t("group_header_accessible_heading_private",b):c.t("group_header_accessible_heading",b)}});return x}),define("stache!workfeed/lib/app/header/group_header_foreign",["mustache"],function(a){var b='<div class="filecollab-group-header-basics">\n  <GroupMugshotView key="mugshot"/>\n\n  <div class="header-content foreign-header-content">\n    <div class="header-cell-container">\n      <div class="header-cell">\n        <h2>\n          {{name}}\n        </h2>\n\n        {{#network_name}}\n          <div class="subhead">\n            <p class="network-name">\n              <span class="network-icon yamicon yamicon-inline yamicon-network">\n                <span class="yj-acc-hidden">\n                  {{other_network_label}}\n                </span>\n              </span>\n              {{network_name}}\n            </p>\n          </div>\n        {{/network_name}}\n      </div>\n    </div>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/header/group_header_foreign",["require","underscore","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./group_mugshot","html!./group_header_foreign"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("./group_mugshot"),h=a("html!./group_header_foreign"),i={other_network_label:c.t("other_network_icon_alttext")},j=d.extend({mixins:[e,f],template:h,views:{GroupMugshotView:"_getGroupMugshot"},initialize:function(){this.listenTo(this.model,"change",b.debounce(this.render,100))},getTemplateData:function(){var a=this.model;return b.extend({id:a.get("id"),name:a.get("full_name"),network_name:a.get("network_name")},i)},_getGroupMugshot:function(){return new g(this.options)}});return j}),define("stache!workfeed/lib/app/header/group_header",["mustache"],function(a){var b='  <div class="page-header-color-circle" style="background-color:{{color}}"></div>\n<div class="page-header profile has-tabs two-actions filecollab-page-header filecollab-move-members" role="region">\n  <GroupHeaderView key="header"/>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/header/group_header",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","underscore","core/lib/backbone_with_subviews","core/lib/session","core/lib/treatment","./group_header_local_v2","./group_header_foreign","workfeed/lib/app/helpers/layout","backbone","html!./group_header","models/helpers/group"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("underscore"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/session"),g=a("core/lib/treatment"),h=a("./group_header_local_v2"),i=a("./group_header_foreign"),j=a("workfeed/lib/app/helpers/layout"),k=a("backbone"),l=a("html!./group_header"),m=a("models/helpers/group"),n=28,o=b.extend({mixins:[c,e],template:l,className:j.twoColumnMainClass+" page-header-container",attributes:{"data-qaid":"page_header"},views:{GroupHeaderView:"_getGroupHeader"},_getGroupHeader:function(){var a=this._shouldShowLocalHeader()?h:i;return new a(this.options)},_shouldShowLocalHeader:function(){var a=m.isExternal(this.model),b=m.isForeign(this.model,f),c=m.isCurrentUserMember(this.model);return a?!b||c:!b},initialize:function(){this.listenTo(k,"/ui/group/setHeaderJoin",this._updateHeaderMembershipStatus),this.listenTo(k,"/ui/group/setGroupColor",this._updateHeaderColor),this.$el.addClass("sticky-group-header"),this.$el.addClass("yj-want-focuswithin"),g.treatment("tow_sticky_header_v2")&&(this.$suiteNav=$("#header-container"),this.$suiteNav.addClass("is-dockable-suite-nav"),this.$suiteNav.addClass("yj-want-focuswithin"));var a=this.model;(m.isCurrentUserMember(a)||m.isAllCompany(a))&&this.$el.addClass("assured-delivery-joined-group-header"),this.listenTo(a,"change:member",this._handleGroupMembershipChange),this._updateHeaderWidthOnResize(),this._setupStickyHeader()},_handleGroupMembershipChange:function(a,b){b?this.$el.addClass("assured-delivery-joined-group-header"):this.$el.removeClass("assured-delivery-joined-group-header")},_updateHeaderMembershipStatus:function(a){a?this.$el.addClass("joined"):this.$el.removeClass("joined")},_updateHeaderColor:function(a){this.$(".page-header-color-circle").css("background-color",a||"")},_updateHeaderWidthOnResize:function(){var a=$("#column-two");this._updateWidth=d.throttle(function(){this.$el.css("width",a.width())}.bind(this),100),$(window).on("resize",this._updateWidth),this._updateWidth()},_setupStickyHeader:function(){this._updateStickiness=d.throttle(function(){var a=$(window).scrollTop();a>120?(this.$el.addClass("yj-docked-group-header"),g.treatment("tow_sticky_header_v2")&&this._dockSuiteNav()):(this.$el.removeClass("yj-docked-group-header"),g.treatment("tow_sticky_header_v2")&&this._undockSuiteNav())}.bind(this),100),$(window).on("scroll",this._updateStickiness)},getTemplateData:function(){return{color:m.getGroupColor(this.model)}},_dockSuiteNav:function(){this.$suiteNav.addClass("is-docked-suite-nav");var a=this.$suiteNav.height();this.$el.css("transform","translateY(-"+(a+n)+"px)"),$(".yj-nav-menu--fixed-content").css("top",0),$(window).trigger("resize.stickyNav")},_undockSuiteNav:function(){this.$suiteNav.removeClass("is-docked-suite-nav");var a=this.$suiteNav.height();this.$el.css("transform",""),$(".yj-nav-menu--fixed-content").css("top",a),$(window).trigger("resize.stickyNav")},remove:function(){return $(window).off("resize",this._updateWidth).off("scroll",this._updateStickiness),g.treatment("tow_sticky_header_v2")&&(this._undockSuiteNav(),this.$suiteNav.removeClass("is-dockable-suite-nav"),this.$suiteNav.removeClass("yj-want-focuswithin")),b.prototype.remove.call(this)}});return o}),/* Copyright © 2011-2015 by Neil Jenkins. MIT Licensed. */
function(a,b){function c(a,b,c){this.root=this.currentNode=a,this.nodeType=b,this.filter=c}function d(a,b){for(var c=a.length;c--;)if(!b(a[c]))return!1;return!0}function e(a,b,c){if(a.nodeName!==b)return!1;for(var d in c)if(a.getAttribute(d)!==c[d])return!1;return!0}function f(a,b){return!g(a)&&a.nodeType===b.nodeType&&a.nodeName===b.nodeName&&a.className===b.className&&(!a.style&&!b.style||a.style.cssText===b.style.cssText)}function g(a){return a.nodeType===F&&!!fa[a.nodeName]}function h(a){return ea.test(a.nodeName)}function i(a){var b=a.nodeType;return(b===F||b===H)&&!h(a)&&d(a.childNodes,h)}function j(a){var b=a.nodeType;return!(b!==F&&b!==H||h(a)||i(a))}function k(a){var b=a.ownerDocument,d=new c(b.body,I,i,!1);return d.currentNode=a,d}function l(a){return k(a).previousNode()}function m(a){return k(a).nextNode()}function n(a,b,c){do if(e(a,b,c))return a;while(a=a.parentNode);return null}function o(a){var b,c,d,e,f,g=a.parentNode;return g&&a.nodeType===F?(b=o(g),b+=(b?">":"")+a.nodeName,(c=a.id)&&(b+="#"+c),(d=a.className.trim())&&(e=d.split(/\s\s*/),e.sort(),b+=".",b+=e.join(".")),(f=a.dir)&&(b+="[dir="+f+"]")):b=g?o(g):"",b}function p(a){var b=a.nodeType;return b===F?a.childNodes.length:a.length||0}function q(a){var b=a.parentNode;return b&&b.removeChild(a),a}function r(a,b){var c=a.parentNode;c&&c.replaceChild(b,a)}function s(a){for(var b=a.ownerDocument.createDocumentFragment(),c=a.childNodes,d=c?c.length:0;d--;)b.appendChild(a.firstChild);return b}function t(a,c,d,e){var f,g,h,i,j=a.createElement(c);if(d instanceof Array&&(e=d,d=null),d)for(f in d)g=d[f],g!==b&&j.setAttribute(f,d[f]);if(e)for(h=0,i=e.length;i>h;h+=1)j.appendChild(e[h]);return j}function u(a){var b,c,d=a.ownerDocument,e=a;if("BODY"===a.nodeName&&((c=a.firstChild)&&"BR"!==c.nodeName||(b=A(d).createDefaultBlock(),c?a.replaceChild(b,c):a.appendChild(b),a=b,b=null)),h(a)){for(c=a.firstChild;$&&c&&c.nodeType===G&&!c.data;)a.removeChild(c),c=a.firstChild;c||($?(b=d.createTextNode(O),A(d)._didAddZWS()):b=d.createTextNode(""))}else if(Z){for(;a.nodeType!==G&&!g(a);){if(c=a.firstChild,!c){b=d.createTextNode("");break}a=c}a.nodeType===G?/^ +$/.test(a.data)&&(a.data=""):g(a)&&a.parentNode.insertBefore(d.createTextNode(""),a)}else if(!a.querySelector("BR"))for(b=t(d,"BR");(c=a.lastElementChild)&&!h(c);)a=c;return b&&a.appendChild(b),e}function v(a){var b,c,d,e,f=a.childNodes,g=a.ownerDocument,i=null,k=A(g)._config;for(b=0,c=f.length;c>b;b+=1)d=f[b],e="BR"===d.nodeName,!e&&h(d)?(i||(i=t(g,k.blockTag,k.blockAttributes)),i.appendChild(d),b-=1,c-=1):(e||i)&&(i||(i=t(g,k.blockTag,k.blockAttributes)),u(i),e?a.replaceChild(i,d):(a.insertBefore(i,d),b+=1,c+=1),i=null),j(d)&&v(d);return i&&a.appendChild(u(i)),a}function w(a,b,c){var d,e,f,g=a.nodeType;if(g===G&&a!==c)return w(a.parentNode,a.splitText(b),c);if(g===F){if("number"==typeof b&&(b=b<a.childNodes.length?a.childNodes[b]:null),a===c)return b;for(d=a.parentNode,e=a.cloneNode(!1);b;)f=b.nextSibling,e.appendChild(b),b=f;return"OL"===a.nodeName&&n(a,"BLOCKQUOTE")&&(e.start=(+a.start||1)+a.childNodes.length-1),u(a),u(e),(f=a.nextSibling)?d.insertBefore(e,f):d.appendChild(e),w(d,e,c)}return b}function x(a,b){if(a.nodeType===F)for(var c,d,e,g=a.childNodes,i=g.length,j=[];i--;)if(c=g[i],d=i&&g[i-1],i&&h(c)&&f(c,d)&&!fa[c.nodeName])b.startContainer===c&&(b.startContainer=d,b.startOffset+=p(d)),b.endContainer===c&&(b.endContainer=d,b.endOffset+=p(d)),b.startContainer===a&&(b.startOffset>i?b.startOffset-=1:b.startOffset===i&&(b.startContainer=d,b.startOffset=p(d))),b.endContainer===a&&(b.endOffset>i?b.endOffset-=1:b.endOffset===i&&(b.endContainer=d,b.endOffset=p(d))),q(c),c.nodeType===G?d.appendData(c.data):j.push(s(c));else if(c.nodeType===F){for(e=j.length;e--;)c.appendChild(j.pop());x(c,b)}}function y(a,b,c){for(var d,e,f,g=b;1===g.parentNode.childNodes.length;)g=g.parentNode;q(g),e=a.childNodes.length,d=a.lastChild,d&&"BR"===d.nodeName&&(a.removeChild(d),e-=1),f={startContainer:a,startOffset:e,endContainer:a,endOffset:e},a.appendChild(s(b)),x(a,f),c.setStart(f.startContainer,f.startOffset),c.collapse(!0),V&&(d=a.lastChild)&&"BR"===d.nodeName&&a.removeChild(d)}function z(a){var b,c,d=a.previousSibling,e=a.firstChild,g=a.ownerDocument,h="LI"===a.nodeName;if(!h||e&&/^[OU]L$/.test(e.nodeName))if(d&&f(d,a)){if(!j(d)){if(!h)return;c=t(g,"DIV"),c.appendChild(s(d)),d.appendChild(c)}q(a),b=!j(a),d.appendChild(s(a)),b&&v(d),e&&z(e)}else h&&(d=t(g,"DIV"),a.insertBefore(d,e),u(d))}function A(a){for(var b,c=Qa.length;c--;)if(b=Qa[c],b._doc===a)return b;return null}function B(a,b){var c,d;a||(a={});for(c in b)d=b[c],a[c]=d&&d.constructor===Object?B(a[c],d):d;return a}function C(a,b){var c,d=a.defaultView,e=a.body;this._win=d,this._doc=a,this._body=e,this._events={},this._lastSelection=null,_&&this.addEventListener("beforedeactivate",this.getSelection),this._hasZWS=!1,this._lastAnchorNode=null,this._lastFocusNode=null,this._path="",this.addEventListener("keyup",this._updatePathOnEvent),this.addEventListener("mouseup",this._updatePathOnEvent),d.addEventListener("focus",this,!1),d.addEventListener("blur",this,!1),this._undoIndex=-1,this._undoStack=[],this._undoStackLength=0,this._isInUndoState=!1,this._ignoreChange=!1,aa?(c=new MutationObserver(this._docWasChanged.bind(this)),c.observe(e,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._mutation=c):this.addEventListener("keyup",this._keyUpDetectChange),this._awaitingPaste=!1,this.addEventListener(U?"beforecut":"cut",Na),this.addEventListener("copy",Oa),this.addEventListener(U?"beforepaste":"paste",Pa),this.addEventListener(V?"keypress":"keydown",wa),this._keyHandlers=Object.create(Aa),this.setConfig(b),U&&(d.Text.prototype.splitText=function(a){var b=this.ownerDocument.createTextNode(this.data.slice(a)),c=this.nextSibling,d=this.parentNode,e=this.length-a;return c?d.insertBefore(b,c):d.appendChild(b),e&&this.deleteData(a,e),b}),e.setAttribute("contenteditable","true");try{a.execCommand("enableObjectResizing",!1,"false"),a.execCommand("enableInlineTableEditing",!1,"false")}catch(a){}Qa.push(this),this.setHTML("")}function D(a,b,c){var d,e;for(d=b.firstChild;d;d=e){if(e=d.nextSibling,h(d)){if(d.nodeType===G||"BR"===d.nodeName||"IMG"===d.nodeName){c.appendChild(d);continue}}else if(i(d)){c.appendChild(a.createDefaultBlock([D(a,d,a._doc.createDocumentFragment())]));continue}D(a,d,c)}return c}var E=2,F=1,G=3,H=11,I=1,J=4,K=0,L=1,M=2,N=3,O="​",P=a.defaultView,Q=navigator.userAgent,R=/iP(?:ad|hone|od)/.test(Q),S=/Mac OS X/.test(Q),T=/Gecko\//.test(Q),U=/Trident\/[456]\./.test(Q),V=!!P.opera,W=/Edge\//.test(Q),X=!W&&/WebKit\//.test(Q),Y=S?"meta-":"ctrl-",Z=U||V,$=U||X,_=U,aa="undefined"!=typeof MutationObserver,ba=/[^ \t\r\n]/,ca=Array.prototype.indexOf;Object.create||(Object.create=function(a){var b=function(){};return b.prototype=a,new b});var da={1:1,2:2,3:4,8:128,9:256,11:1024};c.prototype.nextNode=function(){for(var a,b=this.currentNode,c=this.root,d=this.nodeType,e=this.filter;;){for(a=b.firstChild;!a&&b&&b!==c;)a=b.nextSibling,a||(b=b.parentNode);if(!a)return null;if(da[a.nodeType]&d&&e(a))return this.currentNode=a,a;b=a}},c.prototype.previousNode=function(){for(var a,b=this.currentNode,c=this.root,d=this.nodeType,e=this.filter;;){if(b===c)return null;if(a=b.previousSibling)for(;b=a.lastChild;)a=b;else a=b.parentNode;if(!a)return null;if(da[a.nodeType]&d&&e(a))return this.currentNode=a,a;b=a}},c.prototype.previousPONode=function(){for(var a,b=this.currentNode,c=this.root,d=this.nodeType,e=this.filter;;){for(a=b.lastChild;!a&&b&&b!==c;)a=b.previousSibling,a||(b=b.parentNode);if(!a)return null;if(da[a.nodeType]&d&&e(a))return this.currentNode=a,a;b=a}};var ea=/^(?:#text|A(?:BBR|CRONYM)?|B(?:R|D[IO])?|C(?:ITE|ODE)|D(?:ATA|EL|FN)|EM|FONT|HR|I(?:MG|NPUT|NS)?|KBD|Q|R(?:P|T|UBY)|S(?:AMP|MALL|PAN|TR(?:IKE|ONG)|U[BP])?|U|VAR|WBR)$/,fa={BR:1,IMG:1,INPUT:1},ga=function(a,b){for(var c=a.childNodes;b&&a.nodeType===F;)a=c[b-1],c=a.childNodes,b=c.length;return a},ha=function(a,b){if(a.nodeType===F){var c=a.childNodes;if(b<c.length)a=c[b];else{for(;a&&!a.nextSibling;)a=a.parentNode;a&&(a=a.nextSibling)}}return a},ia=function(a,b){var c,d,e,f,g=a.startContainer,h=a.startOffset,i=a.endContainer,j=a.endOffset;g.nodeType===G?(c=g.parentNode,d=c.childNodes,h===g.length?(h=ca.call(d,g)+1,a.collapsed&&(i=c,j=h)):(h&&(f=g.splitText(h),i===g?(j-=h,i=f):i===c&&(j+=1),g=f),h=ca.call(d,g)),g=c):d=g.childNodes,e=d.length,h===e?g.appendChild(b):g.insertBefore(b,d[h]),g===i&&(j+=d.length-e),a.setStart(g,h),a.setEnd(i,j)},ja=function(a,b){var c=a.startContainer,d=a.startOffset,e=a.endContainer,f=a.endOffset;b||(b=a.commonAncestorContainer),b.nodeType===G&&(b=b.parentNode);for(var g,h,i,j=w(e,f,b),k=w(c,d,b),l=b.ownerDocument.createDocumentFragment();k!==j;)g=k.nextSibling,l.appendChild(k),k=g;return c=b,d=j?ca.call(b.childNodes,j):b.childNodes.length,i=b.childNodes[d],h=i&&i.previousSibling,h&&h.nodeType===G&&i.nodeType===G&&(c=h,d=h.length,h.appendData(i.data),q(i)),a.setStart(c,d),a.collapse(!0),u(b),l},ka=function(a){oa(a);var b=a.startContainer,c=a.endContainer,d=(h(b)||i(b))&&(h(c)||i(c)),e=ja(a);na(a),d&&(b=pa(a),c=qa(a),b&&c&&b!==c&&y(b,c,a)),b&&u(b);var f=a.endContainer.ownerDocument.body,g=f.firstChild;return g&&"BR"!==g.nodeName?a.collapse(!1):(u(f),a.selectNodeContents(f.firstChild)),e},la=function(a,b){for(var c=!0,d=b.childNodes,e=d.length;e--;)if(!h(d[e])){c=!1;break}if(a.collapsed||ka(a),na(a),c)ia(a,b),a.collapse(!1);else{for(var f,g,k,o,p,q=a.startContainer,r=w(q,a.startOffset,n(q.parentNode,"BLOCKQUOTE")||q.ownerDocument.body),s=r.previousSibling,t=s,v=t.childNodes.length,x=r,y=0,A=r.parentNode;(f=t.lastChild)&&f.nodeType===F;){if("BR"===f.nodeName){v-=1;break}t=f,v=t.childNodes.length}for(;(f=x.firstChild)&&f.nodeType===F&&"BR"!==f.nodeName;)x=f;for(p=t.childNodes[v]||null;(f=b.firstChild)&&h(f);)t.insertBefore(f,p);for(;(f=b.lastChild)&&h(f);)x.insertBefore(f,x.firstChild),y+=1;for(g=b;g=m(g);)u(g);if(A.insertBefore(b,r),o=s.nextSibling,g=l(o),!/\S/.test(g.textContent))do A=g.parentNode,A.removeChild(g),g=A;while(A&&!A.lastChild&&"BODY"!==A.nodeName);if(s.parentNode||(s=o.previousSibling),t.parentNode||(t=s||o.parentNode,v=s?s.childNodes.length:0),j(o)&&z(o),k=r.previousSibling,g=i(r)?r:m(r),!/\S/.test(g.textContent))do A=g.parentNode,A.removeChild(g),g=A;while(A&&!A.lastChild&&"BODY"!==A.nodeName);r.parentNode||(r=k.nextSibling),y||(x=k,y=k.childNodes.length),r&&j(r)&&z(r),a.setStart(t,v),a.setEnd(x,y),na(a)}},ma=function(a,b,c){var d=b.ownerDocument.createRange();if(d.selectNode(b),c){var e=a.compareBoundaryPoints(N,d)>-1,f=a.compareBoundaryPoints(L,d)<1;return!e&&!f}var g=a.compareBoundaryPoints(K,d)<1,h=a.compareBoundaryPoints(M,d)>-1;return g&&h},na=function(a){for(var b,c=a.startContainer,d=a.startOffset,e=a.endContainer,f=a.endOffset;c.nodeType!==G&&(b=c.childNodes[d],b&&!g(b));)c=b,d=0;if(f)for(;e.nodeType!==G&&(b=e.childNodes[f-1],b&&!g(b));)e=b,f=p(e);else for(;e.nodeType!==G&&(b=e.firstChild,b&&!g(b));)e=b;a.collapsed?(a.setStart(e,f),a.setEnd(c,d)):(a.setStart(c,d),a.setEnd(e,f))},oa=function(a,b){var c,d=a.startContainer,e=a.startOffset,f=a.endContainer,g=a.endOffset;for(b||(b=a.commonAncestorContainer);d!==b&&!e;)c=d.parentNode,e=ca.call(c.childNodes,d),d=c;for(;f!==b&&g===p(f);)c=f.parentNode,g=ca.call(c.childNodes,f)+1,f=c;a.setStart(d,e),a.setEnd(f,g)},pa=function(a){var b,c=a.startContainer;return h(c)?b=l(c):i(c)?b=c:(b=ga(c,a.startOffset),b=m(b)),b&&ma(a,b,!0)?b:null},qa=function(a){var b,c,d=a.endContainer;if(h(d))b=l(d);else if(i(d))b=d;else{if(b=ha(d,a.endOffset),!b)for(b=d.ownerDocument.body;c=b.lastChild;)b=c;b=l(b)}return b&&ma(a,b,!0)?b:null},ra=new c(null,J|I,function(a){return a.nodeType===G?ba.test(a.data):"IMG"===a.nodeName}),sa=function(a){var b=a.startContainer,c=a.startOffset;if(ra.root=null,b.nodeType===G){if(c)return!1;ra.currentNode=b}else ra.currentNode=ha(b,c);return ra.root=pa(a),!ra.previousNode()},ta=function(a){var b,c=a.endContainer,d=a.endOffset;if(ra.root=null,c.nodeType===G){if(b=c.data.length,b&&b>d)return!1;ra.currentNode=c}else ra.currentNode=ga(c,d);return ra.root=qa(a),!ra.nextNode()},ua=function(a){var b,c=pa(a),d=qa(a);c&&d&&(b=c.parentNode,a.setStart(b,ca.call(b.childNodes,c)),b=d.parentNode,a.setEnd(b,ca.call(b.childNodes,d)+1))},va={8:"backspace",9:"tab",13:"enter",32:"space",33:"pageup",34:"pagedown",37:"left",39:"right",46:"delete",219:"[",221:"]"},wa=function(a){var b=a.keyCode,c=va[b],d="",e=this.getSelection();a.defaultPrevented||(c||(c=String.fromCharCode(b).toLowerCase(),/^[A-Za-z0-9]$/.test(c)||(c="")),V&&46===a.which&&(c="."),b>111&&124>b&&(c="f"+(b-111)),"backspace"!==c&&"delete"!==c&&(a.altKey&&(d+="alt-"),a.ctrlKey&&(d+="ctrl-"),a.metaKey&&(d+="meta-")),a.shiftKey&&(d+="shift-"),c=d+c,this._keyHandlers[c]?this._keyHandlers[c](this,a,e):1!==c.length||e.collapsed||(this.saveUndoState(e),ka(e),this._ensureBottomLine(),this.setSelection(e),this._updatePath(e,!0)))},xa=function(a){return function(b,c){c.preventDefault(),b[a]()}},ya=function(a,b){return b=b||null,function(c,d){d.preventDefault();var e=c.getSelection();c.hasFormat(a,null,e)?c.changeFormat(null,{tag:a},e):c.changeFormat({tag:a},b,e)}},za=function(a,b){try{b||(b=a.getSelection());var c,d=b.startContainer;for(d.nodeType===G&&(d=d.parentNode),c=d;h(c)&&(!c.textContent||c.textContent===O);)d=c,c=d.parentNode;d!==c&&(b.setStart(c,ca.call(c.childNodes,d)),b.collapse(!0),c.removeChild(d),i(c)||(c=l(c)),u(c),na(b)),"BODY"===d.nodeName&&(d=d.firstChild)&&"BR"===d.nodeName&&q(d),a._ensureBottomLine(),a.setSelection(b),a._updatePath(b,!0)}catch(b){a.didError(b)}},Aa={enter:function(a,b,c){var d,e,f;if(b.preventDefault(),a._recordUndoState(c),hb(c.startContainer),a._removeZWS(),a._getRangeAndRemoveBookmark(c),c.collapsed||ka(c),d=pa(c),!d||/^T[HD]$/.test(d.nodeName))return ia(c,a.createElement("BR")),c.collapse(!1),a.setSelection(c),void a._updatePath(c,!0);if((e=n(d,"LI"))&&(d=e),!d.textContent){if(n(d,"UL")||n(d,"OL"))return a.modifyBlocks(fb,c);if(n(d,"BLOCKQUOTE"))return a.modifyBlocks(_a,c)}for(f=Ya(a,d,c.startContainer,c.startOffset),Ua(d),Ja(d),u(d);f.nodeType===F;){var g,h=f.firstChild;if("A"===f.nodeName&&(!f.textContent||f.textContent===O)){h=a._doc.createTextNode(""),r(f,h),f=h;break}for(;h&&h.nodeType===G&&!h.data&&(g=h.nextSibling,g&&"BR"!==g.nodeName);)q(h),h=g;if(!h||"BR"===h.nodeName||h.nodeType===G&&!V)break;f=h}c=a._createRange(f,0),a.setSelection(c),a._updatePath(c,!0)},backspace:function(a,b,c){if(a._removeZWS(),a.saveUndoState(c),c.collapsed)if(sa(c)){b.preventDefault();var d,e=pa(c);if(!e)return;if(v(e.parentNode),d=l(e)){if(!d.isContentEditable)return void q(d);for(y(d,e,c),e=d.parentNode;e&&!e.nextSibling;)e=e.parentNode;e&&(e=e.nextSibling)&&z(e),a.setSelection(c)}else if(e){if(n(e,"UL")||n(e,"OL"))return a.modifyBlocks(fb,c);if(n(e,"BLOCKQUOTE"))return a.modifyBlocks($a,c);a.setSelection(c),a._updatePath(c,!0)}}else a.setSelection(c),setTimeout(function(){za(a)},0);else b.preventDefault(),ka(c),za(a,c)},delete:function(a,b,c){var d,e,f,g,h,i;if(a._removeZWS(),a.saveUndoState(c),c.collapsed)if(ta(c)){if(b.preventDefault(),d=pa(c),!d)return;if(v(d.parentNode),e=m(d)){if(!e.isContentEditable)return void q(e);for(y(d,e,c),e=d.parentNode;e&&!e.nextSibling;)e=e.parentNode;e&&(e=e.nextSibling)&&z(e),a.setSelection(c),a._updatePath(c,!0)}}else{if(f=c.cloneRange(),oa(c,a._body),g=c.endContainer,h=c.endOffset,g.nodeType===F&&(i=g.childNodes[h],i&&"IMG"===i.nodeName))return b.preventDefault(),q(i),na(c),void za(a,c);a.setSelection(f),setTimeout(function(){za(a)},0)}else b.preventDefault(),ka(c),za(a,c)},tab:function(a,b,c){var d,e;if(a._removeZWS(),c.collapsed&&sa(c))for(d=pa(c);e=d.parentNode;){if("UL"===e.nodeName||"OL"===e.nodeName){d.previousSibling&&(b.preventDefault(),a.modifyBlocks(eb,c));break}d=e}},"shift-tab":function(a,b,c){if(a._removeZWS(),c.collapsed&&sa(c)){var d=c.startContainer;(n(d,"UL")||n(d,"OL"))&&(b.preventDefault(),a.modifyBlocks(fb,c))}},space:function(a,b,c){var d,e;a._recordUndoState(c),hb(c.startContainer),a._getRangeAndRemoveBookmark(c),d=c.endContainer,e=d.parentNode,c.collapsed&&"A"===e.nodeName&&!d.nextSibling&&c.endOffset===p(d)&&c.setStartAfter(e),a.setSelection(c)},left:function(a){a._removeZWS()},right:function(a){a._removeZWS()}};S&&T&&(Aa["meta-left"]=function(a,b){b.preventDefault();var c=Ta(a);c&&c.modify&&c.modify("move","backward","lineboundary")},Aa["meta-right"]=function(a,b){b.preventDefault();var c=Ta(a);c&&c.modify&&c.modify("move","forward","lineboundary")}),S||(Aa.pageup=function(a){a.moveCursorToStart()},Aa.pagedown=function(a){a.moveCursorToEnd()}),Aa[Y+"b"]=ya("B"),Aa[Y+"i"]=ya("I"),Aa[Y+"u"]=ya("U"),Aa[Y+"shift-7"]=ya("S"),Aa[Y+"shift-5"]=ya("SUB",{tag:"SUP"}),Aa[Y+"shift-6"]=ya("SUP",{tag:"SUB"}),Aa[Y+"shift-8"]=xa("makeUnorderedList"),Aa[Y+"shift-9"]=xa("makeOrderedList"),Aa[Y+"["]=xa("decreaseQuoteLevel"),Aa[Y+"]"]=xa("increaseQuoteLevel"),Aa[Y+"y"]=xa("redo"),Aa[Y+"z"]=xa("undo"),Aa[Y+"shift-z"]=xa("redo");var Ba={1:10,2:13,3:16,4:18,5:24,6:32,7:48},Ca={backgroundColor:{regexp:ba,replace:function(a,b){return t(a,"SPAN",{class:"highlight",style:"background-color:"+b})}},color:{regexp:ba,replace:function(a,b){return t(a,"SPAN",{class:"colour",style:"color:"+b})}},fontWeight:{regexp:/^bold/i,replace:function(a){return t(a,"B")}},fontStyle:{regexp:/^italic/i,replace:function(a){return t(a,"I")}},fontFamily:{regexp:ba,replace:function(a,b){return t(a,"SPAN",{class:"font",style:"font-family:"+b})}},fontSize:{regexp:ba,replace:function(a,b){return t(a,"SPAN",{class:"size",style:"font-size:"+b})}}},Da=function(a){return function(b,c){var d=t(b.ownerDocument,a);return c.replaceChild(d,b),d.appendChild(s(b)),d}},Ea={SPAN:function(a,b){var c,d,e,f,g,h,i=a.style,j=a.ownerDocument;for(c in Ca)d=Ca[c],e=i[c],e&&d.regexp.test(e)&&(h=d.replace(j,e),f&&f.appendChild(h),f=h,g||(g=h));return g&&(f.appendChild(s(a)),b.replaceChild(g,a)),f||a},STRONG:Da("B"),EM:Da("I"),STRIKE:Da("S"),FONT:function(a,b){var c,d,e,f,g,h=a.face,i=a.size,j=a.color,k=a.ownerDocument;return h&&(c=t(k,"SPAN",{class:"font",style:"font-family:"+h}),g=c,f=c),i&&(d=t(k,"SPAN",{class:"size",style:"font-size:"+Ba[i]+"px"}),g||(g=d),f&&f.appendChild(d),f=d),j&&/^#?([\dA-F]{3}){1,2}$/i.test(j)&&("#"!==j.charAt(0)&&(j="#"+j),e=t(k,"SPAN",{class:"colour",style:"color:"+j}),g||(g=e),f&&f.appendChild(e),f=e),g||(g=f=t(k,"SPAN")),b.replaceChild(g,a),f.appendChild(s(a)),f},TT:function(a,b){var c=t(a.ownerDocument,"SPAN",{class:"font",style:'font-family:menlo,consolas,"courier new",monospace'});return b.replaceChild(c,a),c.appendChild(s(a)),c}},Fa=/^(?:A(?:DDRESS|RTICLE|SIDE|UDIO)|BLOCKQUOTE|CAPTION|D(?:[DLT]|IV)|F(?:IGURE|IGCAPTION|OOTER)|H[1-6]|HEADER|L(?:ABEL|EGEND|I)|O(?:L|UTPUT)|P(?:RE)?|SECTION|T(?:ABLE|BODY|D|FOOT|H|HEAD|R)|UL)$/,Ga=/^(?:HEAD|META|STYLE)/,Ha=new c(null,J|I,function(){return!0}),Ia=function a(b){var c,d,e,f,g,i,j,k,l,m,n,o,p=b.childNodes;for(c=b;h(c);)c=c.parentNode;for(Ha.root=c,d=0,e=p.length;e>d;d+=1)if(f=p[d],g=f.nodeName,i=f.nodeType,j=Ea[g],i===F){if(k=f.childNodes.length,j)f=j(f,b);else{if(Ga.test(g)){b.removeChild(f),d-=1,e-=1;continue}if(!Fa.test(g)&&!h(f)){d-=1,e+=k-1,b.replaceChild(s(f),f);continue}}k&&a(f)}else{if(i===G){if(n=f.data,l=!ba.test(n.charAt(0)),m=!ba.test(n.charAt(n.length-1)),!l&&!m)continue;if(l){for(Ha.currentNode=f;(o=Ha.previousPONode())&&(g=o.nodeName,!("IMG"===g||"#text"===g&&/\S/.test(o.data)));)if(!h(o)){o=null;break}o||(n=n.replace(/^\s+/g,""))}if(m){for(Ha.currentNode=f;(o=Ha.nextNode())&&!("IMG"===g||"#text"===g&&/\S/.test(o.data));)if(!h(o)){o=null;break}o||(n=n.replace(/^\s+/g,""))}if(n){f.data=n;continue}}b.removeChild(f),d-=1,e-=1}return b},Ja=function a(b){for(var c,d=b.childNodes,e=d.length;e--;)c=d[e],c.nodeType!==F||g(c)?c.nodeType!==G||c.data||b.removeChild(c):(a(c),h(c)&&!c.firstChild&&b.removeChild(c))},Ka=function(a){return a.nodeType===F?"BR"===a.nodeName:ba.test(a.data)},La=function(a){for(var b,d=a.parentNode;h(d);)d=d.parentNode;return b=new c(d,I|J,Ka),b.currentNode=a,!!b.nextNode()},Ma=function(a){var b,c,d,e=a.querySelectorAll("BR"),f=[],g=e.length;for(b=0;g>b;b+=1)f[b]=La(e[b]);for(;g--;)c=e[g],d=c.parentNode,d&&(f[g]?h(d)||v(d):q(c))},Na=function(a){var b=a.clipboardData,c=this.getSelection(),d=this.createElement("div"),e=this._body,f=this;this.saveUndoState(c),!W&&b?(oa(c,e),d.appendChild(ka(c,e)),b.setData("text/html",d.innerHTML),b.setData("text/plain",d.innerText||d.textContent),a.preventDefault()):setTimeout(function(){try{f._ensureBottomLine()}catch(a){f.didError(a)}},0),this.setSelection(c)},Oa=function(a){var b=a.clipboardData,c=this.getSelection(),d=this.createElement("div");!W&&b&&(d.appendChild(c.cloneContents()),b.setData("text/html",d.innerHTML),b.setData("text/plain",d.innerText||d.textContent),a.preventDefault())},Pa=function(a){var b,c,d,e,f,g=a.clipboardData,h=g&&g.items,i=!1,j=!1,k=null,l=this;if(!W&&h){for(a.preventDefault(),b=h.length;b--;){if(c=h[b],d=c.type,"text/html"===d)return void c.getAsString(function(a){l.insertHTML(a,!0)});"text/plain"===d&&(k=c),/^image\/.*/.test(d)&&(j=!0)}return void(j?(this.fireEvent("dragover",{dataTransfer:g,preventDefault:function(){i=!0}}),i&&this.fireEvent("drop",{dataTransfer:g})):k&&c.getAsString(function(a){l.insertPlainText(a,!0)}))}if(e=g&&g.types,!W&&e&&(ca.call(e,"text/html")>-1||!T&&ca.call(e,"text/plain")>-1&&ca.call(e,"text/rtf")<0))return a.preventDefault(),void((f=g.getData("text/html"))?this.insertHTML(f,!0):(f=g.getData("text/plain"))&&this.insertPlainText(f,!0));this._awaitingPaste=!0;var m=this._body,n=this.getSelection(),o=n.startContainer,p=n.startOffset,r=n.endContainer,s=n.endOffset,t=pa(n),u=this.createElement("DIV",{style:"position: absolute; overflow: hidden; top:"+(m.scrollTop+(t?t.getBoundingClientRect().top:0))+"px; right: 150%; width: 1px; height: 1px;"});m.appendChild(u),n.selectNodeContents(u),this.setSelection(n),setTimeout(function(){try{l._awaitingPaste=!1;for(var a,b,c="",d=u;u=d;)d=u.nextSibling,q(u),a=u.firstChild,a&&a===u.lastChild&&"DIV"===a.nodeName&&(u=a),c+=u.innerHTML;b=l._createRange(o,p,r,s),l.setSelection(b),c&&l.insertHTML(c,!0)}catch(a){l.didError(a)}},0)},Qa=[],Ra=C.prototype;Ra.setConfig=function(a){return a=B({blockTag:"DIV",blockAttributes:null,tagAttributes:{blockquote:null,ul:null,ol:null,li:null}},a),a.blockTag=a.blockTag.toUpperCase(),this._config=a,this},Ra.createElement=function(a,b,c){return t(this._doc,a,b,c)},Ra.createDefaultBlock=function(a){var b=this._config;return u(this.createElement(b.blockTag,b.blockAttributes,a))},Ra.didError=function(a){console.log(a)},Ra.getDocument=function(){return this._doc};var Sa={focus:1,blur:1,pathChange:1,select:1,input:1,undoStateChange:1};Ra.fireEvent=function(a,b){var c,d,e=this._events[a];if(e)for(b||(b={}),b.type!==a&&(b.type=a),e=e.slice(),c=e.length;c--;){d=e[c];try{d.handleEvent?d.handleEvent(b):d.call(this,b)}catch(b){b.details="Squire: fireEvent error. Event type: "+a,this.didError(b)}}return this},Ra.destroy=function(){var a,b=this._win,c=this._doc,d=this._events;b.removeEventListener("focus",this,!1),b.removeEventListener("blur",this,!1);for(a in d)Sa[a]||c.removeEventListener(a,this,!0);this._mutation&&this._mutation.disconnect();for(var e=Qa.length;e--;)Qa[e]===this&&Qa.splice(e,1)},Ra.handleEvent=function(a){this.fireEvent(a.type,a)},Ra.addEventListener=function(a,b){var c=this._events[a];return b?(c||(c=this._events[a]=[],Sa[a]||this._doc.addEventListener(a,this,!0)),c.push(b),this):(this.didError({name:"Squire: addEventListener with null or undefined fn",message:"Event type: "+a}),this)},Ra.removeEventListener=function(a,b){var c,d=this._events[a];if(d){for(c=d.length;c--;)d[c]===b&&d.splice(c,1);d.length||(delete this._events[a],Sa[a]||this._doc.removeEventListener(a,this,!1))}return this},Ra._createRange=function(a,b,c,d){if(a instanceof this._win.Range)return a.cloneRange();var e=this._doc.createRange();return e.setStart(a,b),c?e.setEnd(c,d):e.setEnd(a,b),e},Ra.scrollRangeIntoView=function(a){var b,c,d=a.getBoundingClientRect();if(d&&!d.top&&(b=this._doc.createElement("SPAN"),a=a.cloneRange(),ia(a,b),d=b.getBoundingClientRect(),c=b.parentNode,c.removeChild(b),c.normalize()),d){var e=this._win,f=e.innerHeight,g=d.top;g>f&&e.scrollBy(0,g-f+20),this.fireEvent("scrollPointIntoView",{x:d.left,y:g})}},Ra._moveCursorTo=function(a){var b=this._body,c=this._createRange(b,a?0:b.childNodes.length);return na(c),this.setSelection(c),this},Ra.moveCursorToStart=function(){return this._moveCursorTo(!0)},Ra.moveCursorToEnd=function(){return this._moveCursorTo(!1)};var Ta=function(a){return a._win.getSelection()||null};Ra.setSelection=function(a){if(a){R&&this._win.focus();var b=Ta(this);b&&(b.removeAllRanges(),b.addRange(a),this.scrollRangeIntoView(a))}return this},Ra.getSelection=function(){var a,b,c,d=Ta(this);return d&&d.rangeCount?(a=d.getRangeAt(0).cloneRange(),b=a.startContainer,c=a.endContainer,b&&g(b)&&a.setStartBefore(b),c&&g(c)&&a.setEndBefore(c),this._lastSelection=a):a=this._lastSelection,a||(a=this._createRange(this._body.firstChild,0)),a},Ra.getSelectedText=function(){var a,b=this.getSelection(),d=new c(b.commonAncestorContainer,J|I,function(a){return ma(b,a,!0)}),e=b.startContainer,f=b.endContainer,g=d.currentNode=e,i="",j=!1;for(d.filter(g)||(g=d.nextNode());g;)g.nodeType===G?(a=g.data,a&&/\S/.test(a)&&(g===f&&(a=a.slice(0,b.endOffset)),g===e&&(a=a.slice(b.startOffset)),i+=a,j=!0)):("BR"===g.nodeName||j&&!h(g))&&(i+="\n",j=!1),g=d.nextNode();return i},Ra.getPath=function(){return this._path};var Ua=function(a){for(var b,d,e,f=new c(a,J,function(){return!0},!1);d=f.nextNode();)for(;(e=d.data.indexOf(O))>-1;){if(1===d.length){do b=d.parentNode,b.removeChild(d),d=b,f.currentNode=b;while(h(d)&&!p(d));break}d.deleteData(e,1)}};Ra._didAddZWS=function(){this._hasZWS=!0},Ra._removeZWS=function(){this._hasZWS&&(Ua(this._body),this._hasZWS=!1)},Ra._updatePath=function(a,b){var c,d=a.startContainer,e=a.endContainer;(b||d!==this._lastAnchorNode||e!==this._lastFocusNode)&&(this._lastAnchorNode=d,this._lastFocusNode=e,c=d&&e?d===e?o(e):"(selection)":"",this._path!==c&&(this._path=c,this.fireEvent("pathChange",{path:c}))),a.collapsed||this.fireEvent("select")},Ra._updatePathOnEvent=function(){this._updatePath(this.getSelection())},Ra.focus=function(){return V||this._body.focus(),this._win.focus(),this},Ra.blur=function(){return T&&this._body.blur(),top.focus(),this};var Va="squire-selection-start",Wa="squire-selection-end";Ra._saveRangeToBookmark=function(a){var b,c=this.createElement("INPUT",{id:Va,type:"hidden"}),d=this.createElement("INPUT",{id:Wa,type:"hidden"});ia(a,c),a.collapse(!1),ia(a,d),c.compareDocumentPosition(d)&E&&(c.id=Wa,d.id=Va,b=c,c=d,d=b),a.setStartAfter(c),a.setEndBefore(d)},Ra._getRangeAndRemoveBookmark=function(a){var b=this._doc,c=b.getElementById(Va),d=b.getElementById(Wa);if(c&&d){var e,f=c.parentNode,g=d.parentNode,h={startContainer:f,endContainer:g,startOffset:ca.call(f.childNodes,c),endOffset:ca.call(g.childNodes,d)};f===g&&(h.endOffset-=1),q(c),q(d),x(f,h),f!==g&&x(g,h),a||(a=b.createRange()),a.setStart(h.startContainer,h.startOffset),a.setEnd(h.endContainer,h.endOffset),e=a.collapsed,na(a),e&&a.collapse(!0)}return a||null},Ra._keyUpDetectChange=function(a){var b=a.keyCode;a.ctrlKey||a.metaKey||a.altKey||!(16>b||b>20)||!(33>b||b>45)||this._docWasChanged()},Ra._docWasChanged=function(){return aa&&this._ignoreChange?void(this._ignoreChange=!1):(this._isInUndoState&&(this._isInUndoState=!1,this.fireEvent("undoStateChange",{canUndo:!0,canRedo:!1})),void this.fireEvent("input"))},Ra._recordUndoState=function(a){if(!this._isInUndoState){var b=this._undoIndex+=1,c=this._undoStack;b<this._undoStackLength&&(c.length=this._undoStackLength=b),a&&this._saveRangeToBookmark(a),c[b]=this._getHTML(),this._undoStackLength+=1,this._isInUndoState=!0}},Ra.saveUndoState=function(a){return a===b&&(a=this.getSelection()),this._isInUndoState||(this._recordUndoState(a),this._getRangeAndRemoveBookmark(a)),this},Ra.undo=function(){if(0!==this._undoIndex||!this._isInUndoState){this._recordUndoState(this.getSelection()),this._undoIndex-=1,this._setHTML(this._undoStack[this._undoIndex]);var a=this._getRangeAndRemoveBookmark();a&&this.setSelection(a),this._isInUndoState=!0,this.fireEvent("undoStateChange",{canUndo:0!==this._undoIndex,canRedo:!0}),this.fireEvent("input")}return this},Ra.redo=function(){var a=this._undoIndex,b=this._undoStackLength;if(b>a+1&&this._isInUndoState){this._undoIndex+=1,this._setHTML(this._undoStack[this._undoIndex]);var c=this._getRangeAndRemoveBookmark();c&&this.setSelection(c),this.fireEvent("undoStateChange",{canUndo:!0,canRedo:b>a+2}),this.fireEvent("input")}return this},Ra.hasFormat=function(a,b,d){if(a=a.toUpperCase(),b||(b={}),!d&&!(d=this.getSelection()))return!1;!d.collapsed&&d.startContainer.nodeType===G&&d.startOffset===d.startContainer.length&&d.startContainer.nextSibling&&d.setStartBefore(d.startContainer.nextSibling),!d.collapsed&&d.endContainer.nodeType===G&&0===d.endOffset&&d.endContainer.previousSibling&&d.setEndAfter(d.endContainer.previousSibling);var e,f,g=d.commonAncestorContainer;if(n(g,a,b))return!0;if(g.nodeType===G)return!1;e=new c(g,J,function(a){return ma(d,a,!0)},!1);for(var h=!1;f=e.nextNode();){if(!n(f,a,b))return!1;h=!0}return h},Ra.getFontInfo=function(a){var c,d,e,f={color:b,backgroundColor:b,family:b,size:b},g=0;if(!a&&!(a=this.getSelection()))return f;if(c=a.commonAncestorContainer,a.collapsed||c.nodeType===G)for(c.nodeType===G&&(c=c.parentNode);4>g&&c&&(d=c.style);)!f.color&&(e=d.color)&&(f.color=e,g+=1),!f.backgroundColor&&(e=d.backgroundColor)&&(f.backgroundColor=e,g+=1),!f.family&&(e=d.fontFamily)&&(f.family=e,g+=1),!f.size&&(e=d.fontSize)&&(f.size=e,g+=1),c=c.parentNode;return f},Ra._addFormat=function(a,b,d){var e,f,g,h,i,j,k,l;if(d.collapsed)e=u(this.createElement(a,b)),ia(d,e),d.setStart(e.firstChild,e.firstChild.length),d.collapse(!0);else{if(f=new c(d.commonAncestorContainer,J|I,function(a){return(a.nodeType===G||"BR"===a.nodeName||"IMG"===a.nodeName)&&ma(d,a,!0)},!1),g=d.startContainer,i=d.startOffset,h=d.endContainer,j=d.endOffset,f.currentNode=g,f.filter(g)||(g=f.nextNode(),i=0),!g)return d;do k=f.currentNode,l=!n(k,a,b),l&&(k===h&&k.length>j&&k.splitText(j),k===g&&i&&(k=k.splitText(i),h===g&&(h=k,j-=i),g=k,i=0),e=this.createElement(a,b),r(k,e),e.appendChild(k));while(f.nextNode());h.nodeType!==G&&(k.nodeType===G?(h=k,j=k.length):(h=k.parentNode,j=1)),d=this._createRange(g,i,h,j)}return d},Ra._removeFormat=function(a,b,c,d){this._saveRangeToBookmark(c);var f,g=this._doc;c.collapsed&&($?(f=g.createTextNode(O),this._didAddZWS()):f=g.createTextNode(""),ia(c,f));for(var i=c.commonAncestorContainer;h(i);)i=i.parentNode;var j=c.startContainer,k=c.startOffset,l=c.endContainer,m=c.endOffset,n=[],o=function(a,b){if(!ma(c,a,!1)){var d,e,f=a.nodeType===G;if(!ma(c,a,!0))return void("INPUT"===a.nodeName||f&&!a.data||n.push([b,a]));if(f)a===l&&m!==a.length&&n.push([b,a.splitText(m)]),a===j&&k&&(a.splitText(k),n.push([b,a]));else for(d=a.firstChild;d;d=e)e=d.nextSibling,o(d,b)}},p=Array.prototype.filter.call(i.getElementsByTagName(a),function(d){return ma(c,d,!0)&&e(d,a,b)});d||p.forEach(function(a){o(a,a)}),n.forEach(function(a){var b=a[0].cloneNode(!1),c=a[1];r(c,b),b.appendChild(c)}),p.forEach(function(a){r(a,s(a))}),this._getRangeAndRemoveBookmark(c),f&&c.collapse(!1);var q={startContainer:c.startContainer,startOffset:c.startOffset,endContainer:c.endContainer,endOffset:c.endOffset};return x(i,q),c.setStart(q.startContainer,q.startOffset),c.setEnd(q.endContainer,q.endOffset),c},Ra.changeFormat=function(a,b,c,d){return c||(c=this.getSelection())?(this.saveUndoState(c),b&&(c=this._removeFormat(b.tag.toUpperCase(),b.attributes||{},c,d)),a&&(c=this._addFormat(a.tag.toUpperCase(),a.attributes||{},c)),this.setSelection(c),this._updatePath(c,!0),aa||this._docWasChanged(),this):void 0};var Xa={DT:"DD",DD:"DT",LI:"LI"},Ya=function(a,b,c,d){var f=Xa[b.nodeName],g=null,h=w(c,d,b.parentNode),i=a._config;return f||(f=i.blockTag,g=i.blockAttributes),
e(h,f,g)||(b=t(h.ownerDocument,f,g),h.dir&&(b.dir=h.dir),r(h,b),b.appendChild(s(h)),h=b),h};Ra.forEachBlock=function(a,b,c){if(!c&&!(c=this.getSelection()))return this;b&&this.saveUndoState(c);var d=pa(c),e=qa(c);if(d&&e)do if(a(d)||d===e)break;while(d=m(d));return b&&(this.setSelection(c),this._updatePath(c,!0),aa||this._docWasChanged()),this},Ra.modifyBlocks=function(a,b){if(!b&&!(b=this.getSelection()))return this;this._isInUndoState?this._saveRangeToBookmark(b):this._recordUndoState(b),ua(b);var c,d=this._body;return oa(b,d),c=ja(b,d),ia(b,a.call(this,c)),b.endOffset<b.endContainer.childNodes.length&&z(b.endContainer.childNodes[b.endOffset]),z(b.startContainer.childNodes[b.startOffset]),this._getRangeAndRemoveBookmark(b),this.setSelection(b),this._updatePath(b,!0),aa||this._docWasChanged(),this};var Za=function(a){return this.createElement("BLOCKQUOTE",this._config.tagAttributes.blockquote,[a])},$a=function(a){var b=a.querySelectorAll("blockquote");return Array.prototype.filter.call(b,function(a){return!n(a.parentNode,"BLOCKQUOTE")}).forEach(function(a){r(a,s(a))}),a},_a=function(){return this.createDefaultBlock([this.createElement("INPUT",{id:Va,type:"hidden"}),this.createElement("INPUT",{id:Wa,type:"hidden"})])},ab=function(a,b,c){for(var d,e,f,g,h=k(b),i=a._config.tagAttributes,j=i[c.toLowerCase()],l=i.li;d=h.nextNode();)e=d.parentNode.nodeName,"LI"!==e?(g=a.createElement("LI",l),d.dir&&(g.dir=d.dir),(f=d.previousSibling)&&f.nodeName===c?f.appendChild(g):r(d,a.createElement(c,j,[g])),g.appendChild(d)):(d=d.parentNode.parentNode,e=d.nodeName,e!==c&&/^[OU]L$/.test(e)&&r(d,a.createElement(c,j,[s(d)])))},bb=function(a){return ab(this,a,"UL"),a},cb=function(a){return ab(this,a,"OL"),a},db=function(a){var b,c,d,e,f,g,h,i=a.querySelectorAll("UL, OL");for(b=0,c=i.length;c>b;b+=1){for(e=i[b],f=s(e),g=f.childNodes,d=g.length;d--;)h=g[d],r(h,s(h));v(f),r(e,f)}return a},eb=function(a){var b,c,d,e,f,g,h=a.querySelectorAll("LI"),i=this._config.tagAttributes,k=i.li;for(b=0,c=h.length;c>b;b+=1)d=h[b],j(d.firstChild)||(e=d.parentNode.nodeName,f=d.previousSibling,f&&(f=f.lastChild)&&f.nodeName===e||(g=i[e.toLowerCase()],r(d,this.createElement("LI",k,[f=this.createElement(e,g)]))),f.appendChild(d));return a},fb=function(a){var b=a.querySelectorAll("LI");return Array.prototype.filter.call(b,function(a){return!j(a.firstChild)}).forEach(function(b){var c,d=b.parentNode,e=d.parentNode,f=b.firstChild,g=f;for(b.previousSibling&&(d=w(d,b,e));g&&(c=g.nextSibling,!j(g));)e.insertBefore(g,d),g=c;for("LI"===e.nodeName&&f.previousSibling&&w(e,f,e.parentNode);b!==a&&!b.childNodes.length;)d=b.parentNode,d.removeChild(b),b=d},this),v(a),a};Ra._ensureBottomLine=function(){var a=this._body,b=a.lastElementChild;b&&b.nodeName===this._config.blockTag&&i(b)||a.appendChild(this.createDefaultBlock())},Ra.setKeyHandler=function(a,b){return this._keyHandlers[a]=b,this},Ra._getHTML=function(){return this._body.innerHTML},Ra._setHTML=function(a){var b=this._body;b.innerHTML=a;do u(b);while(b=m(b));this._ignoreChange=!0},Ra.getHTML=function(a){var b,c,d,e,f,g=[];if(a&&(f=this.getSelection())&&this._saveRangeToBookmark(f),Z)for(b=this._body;b=m(b);)b.textContent||b.querySelector("BR")||(c=this.createElement("BR"),b.appendChild(c),g.push(c));if(d=this._getHTML().replace(/\u200B/g,""),Z)for(e=g.length;e--;)q(g[e]);return f&&this._getRangeAndRemoveBookmark(f),d},Ra.setHTML=function(a){var b,c=this._doc.createDocumentFragment(),d=this.createElement("DIV");d.innerHTML=a,c.appendChild(s(d)),Ia(c),Ma(c),v(c);for(var e=c;e=m(e);)u(e);this._ignoreChange=!0;for(var f=this._body;b=f.lastChild;)f.removeChild(b);f.appendChild(c),u(f),this._undoIndex=-1,this._undoStack.length=0,this._undoStackLength=0,this._isInUndoState=!1;var g=this._getRangeAndRemoveBookmark()||this._createRange(f.firstChild,0);return this.saveUndoState(g),_?this._lastSelection=g:this.setSelection(g),this._updatePath(g,!0),this},Ra.insertElement=function(a,b){if(b||(b=this.getSelection()),b.collapse(!0),h(a))ia(b,a),b.setStartAfter(a);else{for(var c,d,e=this._body,f=pa(b)||e;f!==e&&!f.nextSibling;)f=f.parentNode;f!==e&&(c=f.parentNode,d=w(c,f.nextSibling,e)),d?e.insertBefore(a,d):(e.appendChild(a),d=this.createDefaultBlock(),e.appendChild(d)),b.setStart(d,0),b.setEnd(d,0),na(b)}return this.focus(),this.setSelection(b),this._updatePath(b),this},Ra.insertImage=function(a,b){var c=this.createElement("IMG",B({src:a},b));return this.insertElement(c),c};var gb=/\b((?:(?:ht|f)tps?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,}\/)(?:[^\s()<>]+|\([^\s()<>]+\))+(?:\((?:[^\s()<>]+|(?:\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))|([\w\-.%+]+@(?:[\w\-]+\.)+[A-Z]{2,}\b)/i,hb=function(a){for(var b,d,e,f,g,h,i,j=a.ownerDocument,k=new c(a,J,function(a){return!n(a,"A")},!1);b=k.nextNode();)for(d=b.data,e=b.parentNode;f=gb.exec(d);)g=f.index,h=g+f[0].length,g&&(i=j.createTextNode(d.slice(0,g)),e.insertBefore(i,b)),i=j.createElement("A"),i.textContent=d.slice(g,h),i.href=f[1]?/^(?:ht|f)tps?:/.test(f[1])?f[1]:"http://"+f[1]:"mailto:"+f[2],e.insertBefore(i,b),b.data=d=d.slice(h)};Ra.insertHTML=function(a,b){var c=this.getSelection(),d=this._doc.createDocumentFragment(),e=this.createElement("DIV");e.innerHTML=a,d.appendChild(s(e)),this.saveUndoState(c);try{var f=d,g={fragment:d,preventDefault:function(){this.defaultPrevented=!0},defaultPrevented:!1};for(hb(d),Ia(d),Ma(d),Ja(d),d.normalize();f=m(f);)u(f);b&&this.fireEvent("willPaste",g),g.defaultPrevented||(la(c,g.fragment),aa||this._docWasChanged(),c.collapse(!1),this._ensureBottomLine()),this.setSelection(c),this._updatePath(c,!0)}catch(a){this.didError(a)}return this},Ra.insertPlainText=function(a,b){var c,d,e,f=a.split("\n");for(c=0,d=f.length;d>c;c+=1)e=f[c],e=e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").replace(/ (?= )/g,"&nbsp;"),c&&d>c+1&&(e="<DIV>"+(e||"<BR>")+"</DIV>"),f[c]=e;return this.insertHTML(f.join(""),b)};var ib=function(a,b,c){return function(){return this[a](b,c),this.focus()}};Ra.addStyles=function(a){if(a){var b=this._doc.documentElement.firstChild,c=this.createElement("STYLE",{type:"text/css"});c.appendChild(this._doc.createTextNode(a)),b.appendChild(c)}return this},Ra.bold=ib("changeFormat",{tag:"B"}),Ra.italic=ib("changeFormat",{tag:"I"}),Ra.underline=ib("changeFormat",{tag:"U"}),Ra.strikethrough=ib("changeFormat",{tag:"S"}),Ra.subscript=ib("changeFormat",{tag:"SUB"},{tag:"SUP"}),Ra.superscript=ib("changeFormat",{tag:"SUP"},{tag:"SUB"}),Ra.removeBold=ib("changeFormat",null,{tag:"B"}),Ra.removeItalic=ib("changeFormat",null,{tag:"I"}),Ra.removeUnderline=ib("changeFormat",null,{tag:"U"}),Ra.removeStrikethrough=ib("changeFormat",null,{tag:"S"}),Ra.removeSubscript=ib("changeFormat",null,{tag:"SUB"}),Ra.removeSuperscript=ib("changeFormat",null,{tag:"SUP"}),Ra.makeLink=function(a,b){var c=this.getSelection();if(c.collapsed){var d=a.indexOf(":")+1;if(d)for(;"/"===a[d];)d+=1;ia(c,this._doc.createTextNode(a.slice(d)))}return b||(b={}),b.href=a,this.changeFormat({tag:"A",attributes:b},{tag:"A"},c),this.focus()},Ra.removeLink=function(){return this.changeFormat(null,{tag:"A"},this.getSelection(),!0),this.focus()},Ra.setFontFace=function(a){return this.changeFormat({tag:"SPAN",attributes:{class:"font",style:"font-family: "+a+", sans-serif;"}},{tag:"SPAN",attributes:{class:"font"}}),this.focus()},Ra.setFontSize=function(a){return this.changeFormat({tag:"SPAN",attributes:{class:"size",style:"font-size: "+("number"==typeof a?a+"px":a)}},{tag:"SPAN",attributes:{class:"size"}}),this.focus()},Ra.setTextColour=function(a){return this.changeFormat({tag:"SPAN",attributes:{class:"colour",style:"color:"+a}},{tag:"SPAN",attributes:{class:"colour"}}),this.focus()},Ra.setHighlightColour=function(a){return this.changeFormat({tag:"SPAN",attributes:{class:"highlight",style:"background-color:"+a}},{tag:"SPAN",attributes:{class:"highlight"}}),this.focus()},Ra.setTextAlignment=function(a){return this.forEachBlock(function(b){b.className=(b.className.split(/\s+/).filter(function(a){return!/align/.test(a)}).join(" ")+" align-"+a).trim(),b.style.textAlign=a},!0),this.focus()},Ra.setTextDirection=function(a){return this.forEachBlock(function(b){b.dir=a},!0),this.focus()},Ra.removeAllFormatting=function(a){if(!a&&!(a=this.getSelection())||a.collapsed)return this;for(var b=a.commonAncestorContainer;b&&!i(b);)b=b.parentNode;if(b||(ua(a),b=this._body),b.nodeType===G)return this;this.saveUndoState(a),oa(a,b);for(var c,d,e,f=b.ownerDocument,g=a.startContainer,h=a.startOffset,j=a.endContainer,k=a.endOffset,l=f.createDocumentFragment(),m=f.createDocumentFragment(),n=w(j,k,b),o=w(g,h,b);o!==n;)c=o.nextSibling,l.appendChild(o),o=c;return D(this,l,m),m.normalize(),o=m.firstChild,c=m.lastChild,e=b.childNodes,o?(b.insertBefore(m,n),h=ca.call(e,o),k=ca.call(e,c)+1):(h=ca.call(e,n),k=h),d={startContainer:b,startOffset:h,endContainer:b,endOffset:k},x(b,d),a.setStart(d.startContainer,d.startOffset),a.setEnd(d.endContainer,d.endOffset),na(a),this.setSelection(a),this._updatePath(a,!0),this.focus()},Ra.increaseQuoteLevel=ib("modifyBlocks",Za),Ra.decreaseQuoteLevel=ib("modifyBlocks",$a),Ra.makeUnorderedList=ib("modifyBlocks",bb),Ra.makeOrderedList=ib("modifyBlocks",cb),Ra.removeList=ib("modifyBlocks",db),Ra.increaseListLevel=ib("modifyBlocks",eb),Ra.decreaseListLevel=ib("modifyBlocks",fb),"object"==typeof exports?module.exports=C:"function"==typeof define&&define.amd?define("squire-rte",[],function(){return C}):(P.Squire=C,top!==P&&"true"===a.documentElement.getAttribute("data-squireinit")&&(P.editor=new C(a),P.onEditorLoad&&(P.onEditorLoad(P.editor),P.onEditorLoad=null)))}(document),define("stache!common-ui/lib/helper/squire_toolbar",["mustache"],function(a){var b='<ul>\n  {{#advanced}}\n    <li>\n      <label>\n        <span class="yj-acc-hidden">{{preformatPlaceholderText}}</span>\n        <select class="yj-squire-editor-toolbar--preformat-options">\n          <option disabled selected>{{preformatPlaceholderText}}</option>\n          <option value="h1">{{headingOptionText}}</option>\n          <option value="p">{{paragraphOptionText}}</option>\n        </select>\n      </label>\n    </li>\n  {{/advanced}}\n  <li>\n    <BoldButtonView key="squire-toolbar-button-bold" />\n  </li>\n  <li>\n    <ItalicButtonView key="squire-toolbar-button-italic" />\n  </li>\n  <li>\n    <UnorderedListButtonView key="squire-toolbar-button-unordered-list" />\n  </li>\n  <li>\n    <OrderedListButtonView key="squire-toolbar-button-ordered-list" />\n  </li>\n  <li>\n    <LinkButtonView key="squire-toolbar-button-link" />\n  </li>\n  <li>\n    <UnlinkButtonView key="squire-toolbar-button-unlink" />\n  </li>\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/helper/squire_toolbar",[],function(){}),define("common-ui/lib/helper/squire_toolbar",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","common-ui/lib/ui/shared/button","core/lib/tr","html!./squire_toolbar","css!./squire_toolbar"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("common-ui/lib/ui/shared/button"),g=a("core/lib/tr"),h=a("html!./squire_toolbar");return a("css!./squire_toolbar"),c.extend({mixins:[d,e],defaults:{buttons:{"squire-toolbar-button-bold":{className:"yj-btn-squire--bold",icon:"yamicon-squire-bold",altText:g.t("editor_bold_label"),tagName:"B"},"squire-toolbar-button-italic":{className:"yj-btn-squire--italic",icon:"yamicon-squire-italic",altText:g.t("editor_italic_label"),tagName:"I"},"squire-toolbar-button-unordered-list":{className:"yj-btn-squire--unordered-list",icon:"yamicon-squire-unordered-list",altText:g.t("editor_bulleted_list_label"),tagName:"UL"},"squire-toolbar-button-ordered-list":{className:"yj-btn-squire--ordered-list",icon:"yamicon-squire-ordered-list",altText:g.t("editor_numbered_list_label"),tagName:"OL"},"squire-toolbar-button-link":{className:"yj-btn-squire--link",icon:"yamicon-squire-link",altText:g.t("editor_link_label"),tagName:"A"},"squire-toolbar-button-unlink":{className:"yj-btn-squire--unlink",icon:"yamicon-squire-unlink",altText:g.t("editor_unlink_label")}}},template:h,className:"yj-squire-editor-toolbar",views:{BoldButtonView:"_createButton",ItalicButtonView:"_createButton",UnorderedListButtonView:"_createButton",OrderedListButtonView:"_createButton",LinkButtonView:"_createButton",UnlinkButtonView:"_createButton"},events:{"click .yj-btn-squire--bold":"_emboldenSelectedText","click .yj-btn-squire--italic":"_italiciseSelectedText","click .yj-btn-squire--unordered-list":"_unorderedListSelectedText","click .yj-btn-squire--ordered-list":"_orderedListSelectedText","click .yj-btn-squire--link":"_linkSelectedText","click .yj-btn-squire--unlink":"_unlinkSelectedText","change .yj-squire-editor-toolbar--preformat-options":"_preformatText"},initialize:function(a){this._advanced=a.advanced,b.bindAll(this,"_highlightButton","_resetButtonHighlights")},getTemplateData:function(){return{advanced:this._advanced,preformatPlaceholderText:g.t("select_preformat_style"),headingOptionText:g.t("heading_one_style"),paragraphOptionText:g.t("paragraph_style")}},highlightButtonsByPath:function(a){var c=b.pluck(this.options.buttons,"tagName"),d=b.filter(a.split(">"),function(a){return b.contains(c,a)});this.highlightButtonsByTagNames(d)},highlightButtonsByTagNames:function(a){this._resetButtonHighlights(),a.forEach(this._highlightButton.bind(this))},getButtonTagNames:function(){return b.filter(b.pluck(this.options.buttons,"tagName"),function(a){return!!a})},_highlightButton:function(a){var c=this;b.each(this.options.buttons,function(b){b.tagName&&a===b.tagName&&c.$("."+b.className).addClass("yj-btn-squire--active").attr("aria-pressed",!0)})},_resetButtonHighlights:function(){var a=this.$(".yj-squire-editor-toolbar--button");a.removeClass("yj-btn-squire--active").attr("aria-pressed",!1)},_createButton:function(a){var b=this.options.buttons[a];return new f({className:"yj-btn yj-squire-editor-toolbar--button "+b.className,attributes:{"data-speechtip":b.altText,title:b.altText,"aria-pressed":!1},icon:b.icon,altText:b.altText})},_emboldenSelectedText:function(){this.trigger("squire:embolden")},_italiciseSelectedText:function(){this.trigger("squire:italicise")},_unorderedListSelectedText:function(){this.trigger("squire:unorderedList")},_orderedListSelectedText:function(){this.trigger("squire:orderedList")},_linkSelectedText:function(){this.trigger("squire:link")},_unlinkSelectedText:function(){this.trigger("squire:unlink")},_preformatText:function(a){this.trigger("squire:preformat",a.target.value)}})}),define("stache!common-ui/lib/helper/squire",["mustache"],function(a){var b='<SquireToolbarView />\n\n<div class="squire-editor--iframe-container">\n  <iframe  class="squire-editor--iframe" style="height:{{iFrameHeight}}" title="{{title}}"></iframe>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/helper/squire",[],function(){}),define("common-ui/lib/helper/squire",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","squire-rte","common-ui/lib/helper/squire_toolbar","core/lib/session","core/lib/tr","core/lib/string_helper","core/lib/yammer_uri","html!./squire","css!./squire"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("squire-rte"),h=a("common-ui/lib/helper/squire_toolbar"),i=a("core/lib/session"),j=a("core/lib/tr"),k=a("core/lib/string_helper"),l=a("core/lib/yammer_uri"),m=a("html!./squire");return a("css!./squire"),d.extend({mixins:[e,f],defaults:{editorCssPath:"/assets/resources/yam-squire.css",blockTag:"P",height:300,advanced:!1,stripLineBreaks:!0},template:m,className:"squire-editor",views:{SquireToolbarView:"_createToolbar"},initialize:function(){c.bindAll(this,"_onInput","_onKeyDown","_emboldenSelectedText","_italiciseSelectedText","_unorderedListSelectedText","_orderedListSelectedText","_linkSelectedText","_unlinkSelectedText","_preformatSelectedText","_onPathChange","_onSelect")},render:function(){this._iframe=this.$("iframe")[0],this._iframe.addEventListener("load",c.bind(this._createEditor,this))},clear:function(){this._editor.setHTML("")},refresh:function(){this._editor||this._createEditor()},hide:function(){this.$el.height(0),this.$el.css("overflow","hidden")},show:function(){this.$el.height("100%"),this.$el.css("overflow","auto")},toggle:function(){0===this.$el.height()?this.show():this.hide()},getTemplateData:function(){return{iFrameHeight:this.options.height+"px",title:this.options.title}},getHTML:function(){var a=this._editor.getHTML();return a=this._processTag(a,"b","strong"),a=this._processTag(a,"i","em"),this.options.stripLineBreaks&&(a=this._stripLineBreaks(a)),a},setHTML:function(a){this._editor.setHTML(a)},_processTag:function(a,b,c){var d=new RegExp("<"+b+">","ig"),e=new RegExp("</"+b+">","ig"),f="<"+c+">",g="</"+c+">";return a=a.replace(d,f),a=a.replace(e,g)},_stripLineBreaks:function(a){var c,d=new RegExp("\n","ig");return a=a.replace(d,""),c=b(a),c.find("li>p").each(function(){var a=b(this);a.replaceWith(a.html())}),c.find("br:last-child").remove(),b("<div>").append(c).html()},_getIframeDoc:function(){return this._iframe.contentDocument},_createEditor:function(){var a=this._getIframeDoc(),c=b(a).find("head");c.append('<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">');var d=b('<link rel="stylesheet" type="text/css" href="'+l.cdn(this.options.editorCssPath)+'">');c.append(d),this._editor=new g(a,{blockTag:this.options.blockTag}),this._editor.addEventListener("input",this._onInput),this._editor.addEventListener("keydown",this._onKeyDown),this._editor.addEventListener("pathChange",this._onPathChange),this._editor.addEventListener("select",this._onSelect),this._editor.addEventListener("willPaste",this._pasteFilter),this.trigger("ready")},_createToolbar:function(){return this._toolbar=new h({advanced:this.options.advanced}),this._toolbar.on("squire:embolden",this._emboldenSelectedText),this._toolbar.on("squire:italicise",this._italiciseSelectedText),this._toolbar.on("squire:unorderedList",this._unorderedListSelectedText),this._toolbar.on("squire:orderedList",this._orderedListSelectedText),this._toolbar.on("squire:link",this._linkSelectedText),this._toolbar.on("squire:unlink",this._unlinkSelectedText),this._toolbar.on("squire:preformat",this._preformatSelectedText),this._toolbar},_emboldenSelectedText:function(){this._editor.hasFormat("b")?this._editor.removeBold():this._editor.bold()},_italiciseSelectedText:function(){this._editor.hasFormat("i")?this._editor.removeItalic():this._editor.italic()},_unorderedListSelectedText:function(){this._editor.hasFormat("ul")?this._editor.removeList():this._editor.makeUnorderedList()},_orderedListSelectedText:function(){this._editor.hasFormat("ol")?this._editor.removeList():this._editor.makeOrderedList()},_linkSelectedText:function(){var a=window.prompt(j.t("please_enter_a_valid_url"));a&&(a=this._addHTTPPrefixToUrl(a),this._editor.makeLink(a,{target:"_blank"}))},_unlinkSelectedText:function(){this._editor.removeLink()},_preformatSelectedText:function(a){this._editor.modifyBlocks(function(c){var d=document.createDocumentFragment(),e=b("<"+a+">").html(b(c.childNodes).html());return d.appendChild(e[0]),d})},_addHTTPPrefixToUrl:function(a){function b(){return/^https?:\/\//.test(a)}function c(){return/^mailto:/.test(a)}function d(){return/^#/.test(a)}return d()||b()||c()?a:"http://"+a},_onInput:function(){this.trigger("input")},_onKeyDown:function(a){if(85===a.which&&(a.ctrlKey===!0||a.metaKey===!0))return void a.preventDefault();if(13===a.which){var b=i.getCurrentUser(),c=b&&b.web_preferences,d=c?!k.convertStringyBoolean(c.enter_does_not_submit_message):!1;d&&!a.shiftKey||!d&&a.shiftKey?(a.preventDefault(),this.trigger("submit")):d&&a.shiftKey&&(a.preventDefault(),this._appendParagraph())}},_onPathChange:function(a){a.path&&this._toolbar.highlightButtonsByPath(a.path)},_onSelect:function(){var a=this,b=c.filter(this._toolbar.getButtonTagNames(),function(b){return a._editor.hasFormat(b)});this._toolbar.highlightButtonsByTagNames(b)},_appendParagraph:function(){var a=document.createElement(this.options.blockTag);this._editor.insertHTML(b("<div/>").html(a).html())},_pasteFilter:function(a){var d=function(a,b){return c.each(b.childNodes,function(a){var b=3===a.nodeType;b&&(a.data=a.data.replace(/\n/g," "))}),b},e=b("<div/>").append(a.fragment.childNodes);e.find("*").removeAttr("class").removeAttr("style").each(d),a.fragment.innerHTML="",e.contents().each(function(){a.fragment.appendChild(this)})}})}),define("stache!workfeed/lib/app/views/group/info_editor",["mustache"],function(a){var b='<div class="info-header tab-header">\n  {{#is_editable}}\n    <div class="edit-group-info-container">\n      <a href="#" role="button" class="control edit-group-info">\n        <span class="yamicon yamicon-xxx-small yamicon-pencil yj-dark-gray"></span>\n        {{edit_label}}\n      </a>\n      <a href="#" role="button" class="yj-btn yj-btn control save-group-info" style="display: none">\n        {{save_label}}\n      </a>\n      <a href="#" role="button" class="control cancel-edit-group-info" style="display: none">\n        {{cancel_label}}\n      </a>\n    </div>\n  {{/is_editable}}\n  {{title}}\n</div>\n<div id="group-info-display" class="yj-group--info rich-text spaced">\n  {{#body}}\n    {{{body}}}\n  {{/body}}\n  {{^body}}\n    <p class="sample-info yj-dark-gray">\n      {{instructions}}\n    </p>\n  {{/body}}\n</div>\n{{#is_editable}}\n  <EditorView key="squire_editor" />\n{{/is_editable}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/group/info_editor",["require","underscore","core/lib/tr","backbone","core/lib/yammer_api","common-ui/lib/helper/squire","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","models/helpers/group","html!./info_editor"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("backbone"),e=a("core/lib/yammer_api"),f=a("common-ui/lib/helper/squire"),g=a("core/lib/backbone_base_view"),h=a("core/lib/backbone_with_auto_render"),i=a("core/lib/backbone_with_subviews"),j=a("models/helpers/group"),k=a("html!./info_editor"),l={edit_label:c.t("group_info_edit"),save_label:c.t("group_info_save"),cancel_label:c.t("group_info_cancel"),success_message:c.t("group_info_success")},m=g.extend({mixins:[h,i],template:k,id:"group-info",events:{"click .edit-group-info":"_onClickEditOrCancel","click .cancel-edit-group-info":"_onClickEditOrCancel","click .save-group-info":"_onClickSave"},views:{EditorView:"_createEditor"},initialize:function(){this.listenTo(this.model,"change:group_info",this.render)},render:function(){this.$header=this.$(".tab-header"),this.$edit=this.$(".edit-group-info"),this.$cancel=this.$(".cancel-edit-group-info"),this.$save=this.$(".save-group-info"),this.$infoDisplay=this.$("#group-info-display"),this.$infoEdit=this.$("#group-info-edit"),this.$textarea=this.$("textarea.rich-text")},getTemplateData:function(){var a=this.model;return b.extend({title:c.t("group_info_title",{group:a.get("full_name")}),instructions:c.t("group_info_instructions"),body:a.get("group_info"),is_editable:j.isEditableByCurrentUser(a)},l)},_createEditor:function(){var a=this;return this._editor=new f({height:"300",advanced:!0,title:c.t("group_info_rich_text")}),this._editor.on("ready",function(){var b=a.model.get("group_info")||"";a._editor.setHTML(b)}),this._editor.hide(),this._editor},_toggleEdit:function(){this.$edit.toggle(),this.$cancel.toggle(),this.$save.toggle(),this.$infoDisplay.toggle(),this.$infoEdit.toggle(),this.$header.toggleClass("editing"),this._editor.toggle()},_postData:function(){var a=this._editor.getHTML(),b=this.model,c={id:b.id,page:{html:a}},f=e.updateGroup.bind(e);j.isAllCompany(b)&&(f=e.updateNetworkInfo.bind(e),c.id=b.get("network_id")),this.$save.addClass("yj-btn-disabled"),f(c).then(function(){b.set({group_info:a}),d.trigger("/ui/alert/show","notice",l.success_message)})},_onClickEditOrCancel:function(a){a.preventDefault(),this._toggleEdit()},_onClickSave:function(a){a.preventDefault(),this._postData(),this._toggleEdit()}});return m}),define("stache!workfeed/lib/app/views/group/info",["mustache"],function(a){var b='{{#hasGroup}}<GroupHeader key="group-header"/>{{/hasGroup}}\n<div class="page-content-container yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block sticky-group-header-column" role="main">\n  {{#hasError}}<GroupErrorNotice key="group-error-notice"/>{{/hasError}}\n  {{#showEditor}}\n    <div class="yk-row">\n      <div id="main-column" class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n        <InfoEditor key="info-editor"/>\n      </div>\n    </div>\n  {{/showEditor}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/group/info",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","workfeed/lib/app/header/group_error_notice","workfeed/lib/app/header/group_header","./info_editor","workfeed/lib/app/helpers/group_error_helper","models/helpers/group","core/lib/util/route_helper","feeds/lib/ui/util/title_updater","core/lib/tr","html!./info"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("workfeed/lib/app/header/group_error_notice"),f=a("workfeed/lib/app/header/group_header"),g=a("./info_editor"),h=a("workfeed/lib/app/helpers/group_error_helper"),i=a("models/helpers/group"),j=a("core/lib/util/route_helper"),k=a("feeds/lib/ui/util/title_updater"),l=a("core/lib/tr"),m=a("html!./info");return c.extend({mixins:[b,d],template:m,views:{GroupHeader:"_createGroupHeader",GroupErrorNotice:"_createGroupErrorNotice",InfoEditor:"_createInfoEditor"},id:"listInGroup",initialize:function(){k.setTitle(""),this.tab="group_info",this.groupId=this.options.groupId,i.fetch(this.options.groupId).then(j.executeInCurrentFragment(this._groupFetchSuccess,this),j.executeInCurrentFragment(this._groupFetchError,this))},_createGroupHeader:function(){return new f({model:this._group})},_createGroupErrorNotice:function(){return new e({group:this._group,error:this._error})},_createInfoEditor:function(){return new g({model:this._group})},_groupFetchSuccess:function(a){this._group=a,this._error=h.getErrorForGroup(a),k.setTitle(a.get("full_name")+" : "+l.t("info")),this._showEditor=!this._error,this.render()},_groupFetchError:function(a){this._error=h.getErrorForStatus(a.status),this.render()},getTemplateData:function(){return{hasGroup:!!this._group,hasError:!!this._error,showEditor:this._showEditor}}})}),define("stache!workfeed/lib/app/views/group/list",["mustache"],function(a){var b='{{#hasGroup}}<GroupHeader key="group-header"/>{{/hasGroup}}\n<div class="page-content-container yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block sticky-group-header-column" role="main">\n  {{#hasError}}<GroupErrorNotice key="group-error-notice"/>{{/hasError}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/group/list",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","feeds/lib/ui/files/selector","workfeed/lib/app/header/group_error_notice","workfeed/lib/app/header/group_header","feeds/lib/ui/pages/selector","workfeed/lib/app/helpers/group_error_helper","models/helpers/group","core/lib/util/route_helper","feeds/lib/ui/util/title_updater","core/lib/tr","html!./list"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("feeds/lib/ui/files/selector"),f=a("workfeed/lib/app/header/group_error_notice"),g=a("workfeed/lib/app/header/group_header"),h=a("feeds/lib/ui/pages/selector"),i=a("workfeed/lib/app/helpers/group_error_helper"),j=a("models/helpers/group"),k=a("core/lib/util/route_helper"),l=a("feeds/lib/ui/util/title_updater"),m=a("core/lib/tr"),n=a("html!./list");return c.extend({mixins:[b,d],template:n,views:{GroupHeader:"_createGroupHeader",GroupErrorNotice:"_createGroupErrorNotice"},id:"infoInGroup",initialize:function(){l.setTitle(""),this.type=this.options.type,this.groupId=this.options.groupId,j.fetch(this.options.groupId).then(k.executeInCurrentFragment(this._groupFetchSuccess,this),k.executeInCurrentFragment(this._groupFetchError,this))},_groupFetchSuccess:function(a){this._group=a,this._error=i.getErrorForGroup(a);var b="notes"===this.type?m.t("notes"):m.t("files");l.setTitle(a.get("full_name")+" : "+b),this._showSelector=!this._error,this.render()},_groupFetchError:function(a){this._error=i.getErrorForStatus(a.status),this.render()},_createGroupHeader:function(){return new g({model:this._group})},_createGroupErrorNotice:function(){return new f({group:this._group,error:this._error})},getTemplateData:function(){return{hasGroup:!!this._group,hasError:!!this._error}},render:function(){var a;return this._selector&&this._selector.remove(),this._showSelector&&(a="notes"===this.type?h:e,this._selector=new a({tableWidth:"549px",hasFilter:!0,filterGroup:{id:this.options.groupId}}),this._selector.render(),this.$(".page-content-container").append(this._selector.$el)),this},remove:function(){return this._selector&&this._selector.remove(),c.prototype.remove.call(this)}})}),define("workfeed/lib/app/settings_privacy_controls",["require","common-ui/lib/ui/groups/group_privacy_controls","core/lib/treatment"],function(a){"use strict";var b=a("common-ui/lib/ui/groups/group_privacy_controls"),c=a("core/lib/treatment"),d="suite_groups_simplified_group_types",e=b.extend({render:function(){return b.prototype.render.call(this),this._shouldTreatForSimplifiedGroupType()&&this.options.isPublic&&this._hideGroupModeration(),this},isGroupModerationHidden:function(){return this._getGroupModerationElement().hasClass("yj-hide")},isGroupModerationShown:function(){return!this.isGroupModerationHidden()},_showPublicRadioOptions:function(){b.prototype._showPublicRadioOptions.call(this),this._shouldTreatForSimplifiedGroupType()&&this._hideGroupModeration()},_showPrivateRadioOptions:function(){b.prototype._showPrivateRadioOptions.call(this),this._showGroupModeration()},_shouldTreatForSimplifiedGroupType:function(){return c.treatment(d)},_hideGroupModeration:function(){this._getGroupModerationElement().addClass("yj-hide")},_showGroupModeration:function(){this._getGroupModerationElement().removeClass("yj-hide")},_getGroupModerationElement:function(){return this.$(".settings.add-members")}});return e}),define("common-ui/lib/ui/accessibility/color_util",[],function(){"use strict";var a=function(a){var b=a.red/255,c=a.green/255,d=a.blue/255,e=.03928>=b?b/12.92:Math.pow((b+.055)/1.055,2.4),f=.03928>=c?c/12.92:Math.pow((c+.055)/1.055,2.4),g=.03928>=d?d/12.92:Math.pow((d+.055)/1.055,2.4);return.2126*e+.7152*f+.0722*g},b=function(a,b){return a+=.05,b+=.05,a>b?a/b:b/a},c=function(a,b){var c=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i;return b&&(c=/(^#?[0-9A-F]{6}$)|(^#?[0-9A-F]{3}$)/i),c.test(a)},d=function(a){return c(a,!0)?(3!==a.length&&6!==a.length||(a="#"+a),4===a.length?"#"+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]:a):null},e=function(a){a=d(a);var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?{red:parseInt(b[1],16),green:parseInt(b[2],16),blue:parseInt(b[3],16)}:null},f=function(a,b){var c=e(a),d=e(b);return c&&d?g(c,d):-1},g=function(c,d){var e=a(c),f=a(d);return b(e,f)};return{validateHex:c,sanitizeHex:d,hexToRgb:e,getContrastRatioFromHexCodes:f}}),define("components/group_color_picker/src/group_color_name_map",["core/lib/tr"],function(){"use strict";var a=require("core/lib/tr");return{"#91401A":a.t("color_brown"),
"#915A1A":a.t("color_orange"),"#5B7D0C":a.t("color_dark_olive_green"),"#348255":a.t("color_green"),"#317C8B":a.t("color_teal"),"#1952A1":a.t("color_blue"),"#377CA1":a.t("color_steel_blue"),"#4E5C6D":a.t("color_slate"),"#2B3F59":a.t("color_dark_slate"),"#48456E":a.t("color_dark_purple"),"#6A588A":a.t("color_purple"),"#B01263":a.t("color_pink"),"#913648":a.t("color_maroon")}}),define("stache!components/group_color_picker/src/group_color_picker",["mustache"],function(a){var b='<ul class="yj-group-color-picker--color-list">\n  {{#colors}}\n  <li class="yj-group-color-picker--color-list-item" data-color="{{hexCode}}" style="background-color: {{hexCode}}">\n    <button type="button" class="yj-group-color-picker--button" title="{{colorName}}" data-speechtip>\n      <span class="yj-acc-hidden">{{colorName}}</span>\n      <span class="yj-acc-hidden yj-group-color-picker--check-alt"></span>\n      <span class="yamicon yamicon-rd_checkmark"></span>\n    </button>\n  </li>\n  {{/colors}}\n  <li class="yj-group-color-picker--color-list-item is-selected" data-color="{{originalColor}}" style="background-color: {{originalColor}}">\n    <button type="button" class="yj-group-color-picker--button" title="{{originalColorName}}" data-speechtip>\n      <span class="yj-acc-hidden">{{originalColorName}}</span>\n      <span class="yj-acc-hidden yj-group-color-picker--check-alt"></span>\n      <span class="yamicon yamicon-rd_checkmark"></span>\n    </button>\n  </li>\n</ul>\n<div class="yj-group-color-picker--custom-color-container">\n  <button type="button" class="yj-group-color-picker--add-button yamicon yamicon-rd_add" title="{{addCustomColor}}" data-speechtip>\n    <span class="yj-acc-hidden">{{addCustomColor}}</span>\n  </button>\n\n  <button type="button" class="yj-group-color-picker--remove-button yamicon yamicon-x" title="{{removeCustomColor}}" data-speechtip>\n    <span class="yj-acc-hidden">{{removeCustomColor}}</span>\n  </button>\n\n  <button type="button" class="yj-group-color-picker--custom-color-label" title="{{customColorName}}" data-speechtip>\n    <span class="yj-acc-hidden">{{customColorName}}</span>\n    <span class="yj-acc-hidden yj-group-color-picker--check-alt"></span>\n    <span class="yamicon yamicon-rd_checkmark"></span>\n  </button>\n  <label class="yj-group-color-picker--custom-color-input-container">\n    <span class="yj-acc-hidden">{{customColorInputLabel}}</span>\n    <input type="text" class="yj-group-color-picker--custom-color" maxlength="7" value="{{originalColor}}"/>\n    <div class="yj-group-color-picker--status"></div>\n  </label>\n</div>\n\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/group_color_picker/src/group_color_picker",[],function(){}),define("components/group_color_picker/src/group_color_picker",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/ui/accessibility/color_util","backbone","core/lib/tr","core/lib/report","common-ui/lib/ui/accessibility/screenreader_announcer","./group_color_name_map","html!./group_color_picker","css!./group_color_picker"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("common-ui/lib/ui/accessibility/color_util"),f=a("backbone"),g=a("core/lib/tr"),h=a("core/lib/report"),i=a("common-ui/lib/ui/accessibility/screenreader_announcer"),j=a("./group_color_name_map"),k=a("html!./group_color_picker");a("css!./group_color_picker");var l=13;return c.extend({mixins:[d],template:k,className:"yj-group-color-picker",events:{"click .yj-group-color-picker--color-list-item":"_onColorClick","click .yj-group-color-picker--custom-color-label":"_onCustomColorLabelClick","click .yj-group-color-picker--custom-color":"_onCustomColorLabelClick","input .yj-group-color-picker--custom-color":"_handleCustomColorInput","change .yj-group-color-picker--custom-color":"_validateCustomColor","click .yj-group-color-picker--add-button":"_onCustomColorLabelClick","click .yj-group-color-picker--remove-button":"_onRemoveButtonClick"},initialize:function(a){this.colors=a.colors,this.originalColor=a.originalColor,this.currentColor=this.originalColor,this.listenTo(f,"/ui/group/setGroupColor",this._resetGroupColor)},getTemplateData:function(){var a=b.map(this.colors,function(a){return{hexCode:a,colorName:j[a]}});return a.length=l,{colors:a,originalColor:this.originalColor,addCustomColor:g.t("group_color_add_custom_color"),removeCustomColor:g.t("group_color_remove_custom_color"),customColorName:g.t("group_color_custom_color"),originalColorName:g.t("group_color_original_color"),customColorInputLabel:g.t("group_color_custom_color_input"),selected:g.t("selected")}},render:function(){return this.$customColorContainer=this.$el.find(".yj-group-color-picker--custom-color-container"),this.$customColorLabel=this.$el.find(".yj-group-color-picker--custom-color-label"),this.$input=this.$el.find(".yj-group-color-picker--custom-color"),this.$status=this.$el.find(".yj-group-color-picker--status"),this.$removeButton=this.$el.find(".yj-group-color-picker--remove-button"),this},_resetGroupColor:function(a,b){b&&(this.originalColor=a,this.currentColor=a,this.render(),this._triggerChangeGroupColorEvent(a,!0),this.trigger("/ui/group_settings/saveGroupColor"))},_onRemoveButtonClick:function(){this._resetGroupColor(this.originalColor,!0),this.$el.find(".is-selected button").focus()},_onColorClick:function(a){this._logFirstInteraction(),this._clearSelection(),this._selectItem($(a.currentTarget),!0),this._clearStatusMessage(),this._triggerChangeGroupColorEvent($(a.currentTarget).data("color"),!0),i.announceText($(a.currentTarget).text())},_onCustomColorLabelClick:function(){this._logFirstInteraction(),this.$customColorContainer.addClass("is-open"),this.$input.focus(),this._handleCustomColorSelect()},_handleCustomColorSelect:function(){this._clearSelection(),this._validateCustomColor(this.currentColor)},_handleCustomColorInput:function(a){this._clearSelection(),this._validateCustomColor(a)},setCustomColor:function(a){this.$customColorContainer.addClass("is-open"),this._clearSelection(),this.$input.val(a).trigger("change")},_updateCustomColorField:function(a){this.$customColorLabel.css({"background-color":a,"border-color":a}),this.$removeButton.css({"background-color":a,"border-color":a})},_clearSelection:function(){this._selectItem(this.$el.find(".yj-group-color-picker--color-list-item"),!1),this._selectItem(this.$customColorLabel,!1),this._setValid(!0)},_validateCustomColor:function(a){this.currentColor="string"==typeof a?a:$(a.target).val();var b=e.validateHex(this.currentColor,!0);b&&(this.currentColor=e.sanitizeHex(this.currentColor));var c=this._isAccessible(this.currentColor),d="input"===a.type;b?c?(this._shouldDisplayContrastRatioWarning(this.currentColor)?this._setStatusMessage(g.t("darker_group_color_recommended"),!1,d):this._clearStatusMessage(),this._selectItem(this.$customColorLabel,!0),this._updateCustomColorField(this.currentColor)):(this._selectItem(this.$customColorLabel,!1),this._setStatusMessage(g.t("group_color_too_light"),!0,d)):(this._selectItem(this.$customColorLabel,!1),this._setStatusMessage(g.t("group_color_invalid_hexcode"),!0,d)),this._setValid(b&&c),this._triggerChangeGroupColorEvent(this.currentColor,b&&c)},_isAccessible:function(a){return e.getContrastRatioFromHexCodes(a,"#FFFFFF")>=3},_shouldDisplayContrastRatioWarning:function(a){var b=e.getContrastRatioFromHexCodes(a,"#FFFFFF");return b>=3&&4>b},_setValid:function(a){this.$customColorContainer.toggleClass("yj-invalid",!a),this.$input.attr("aria-invalid",!a)},_selectItem:function(a,b){a.toggleClass("is-selected",b),a.find(".yj-group-color-picker--check-alt").text(b?g.t("selected"):"")},_setStatusMessage:function(a,b,c){this.$status.toggleClass("has-error",!!b),this.$status.text(a||""),a&&c&&i.announceText(a)},_clearStatusMessage:function(){this._setStatusMessage()},_triggerChangeGroupColorEvent:function(a,b){this.trigger("/ui/group_settings/changeGroupColor",{color:a,isValid:b})},_logFirstInteraction:function(){this.logged||(h.event("group_color_picker_click"),this.logged=!0)}})}),define("components/group_color_picker/index",["require","./src/group_color_picker"],function(a){"use strict";return a("./src/group_color_picker")}),define("stache!workfeed/lib/app/outlook_import",["mustache"],function(a){var b='<div class="import-address-book-wrapper">\n  <div class="tabs-content">\n    <div id="csv">\n      <div id="csv-container" class="contact-import-container">\n        <div id="csv-upload-container" class="step-1">\n          <form accept-charset="UTF-8" action="{{processOutlookHref}}" enctype="multipart/form-data" id="csv-import" method="post"\n          target="csv-iframe">\n            <input name="group_id" type="hidden" value="{{groupId}}">\n            <div style="margin:0;padding:0;display:inline">\n              <input name="utf8" type="hidden" value="✓">\n              <input name="authenticity_token" type="hidden" value="{{csrfToken}}">\n            </div>\n            <div id="csv-upload-container-form">\n              <input id="invite_section" name="invite_section" type="hidden" value="process_outlook">\n              <input id="invite_source" name="invite_source" type="hidden" value="invite_users_addressbook_csv">\n              <input id="community" name="community" type="hidden" value="false">\n              <input id="include_members" name="include_members" type="hidden" value="true">\n              <p>{{{csvImportHelp}}}\n              </p>\n              <table role="presentation">\n                <tr>\n                  <th role="presentation">\n                    <label for="csv_file">{{fileLocationLabel}}</label>\n                  </th>\n                  <td>\n                    <input class="file-input" id="csv_file" name="csv_file" type="file">\n                  </td>\n                </tr>\n                <tr>\n                  <th role="presentation"></th>\n                  <td>\n                    <button type="submit" class="yj-btn  preview-btn ">\n                      <span>{{previewButtonLabel}}</span>\n                    </button>\n                    <span class="secondary-actions">{{{orCancel}}}</span>\n                  </td>\n                </tr>\n              </table>\n            </div>\n          </form>\n          <div id="processing-spinner" class="processing-spinner">\n            <div class="yj-spinner-loading">{{spinnerProcessing}}</div>\n          </div>\n          <iframe width="0" scrolling="no" height="0" frameborder="0" src="javascript:false" style="display: none;" name="csv-iframe"\n          id="csv-iframe"></iframe>\n        </div>\n        <div id="csv-contact-list-container" class="step-2" style="display: none;">\n          <form accept-charset="UTF-8" action="{{processInvitesHref}}" class="invite-contacts-form" id="csv-send-invite-form" method="post">\n            <div style="margin:0;padding:0;display:inline">\n              <input name="utf8" type="hidden" value="✓">\n              <input name="authenticity_token" type="hidden" value="{{csrfToken}}">\n            </div>\n            <input id="invite_section" name="invite_section" type="hidden" value="send_outlook_invite">\n            <input id="invite_source" name="invite_source" type="hidden" value="invite_users_addressbook_csv">\n            <input id="email_addresses_provided" name="email_addresses_provided" type="hidden" value="1">\n            <input id="group_id" name="group_id" type="hidden" value="{{groupId}}">\n            <p>\n              <span class="contact-count">{{selectPeopleToInvite}}</span>\n            </p>\n            <ul class="horz-menu piped">\n              <li class="first">\n                <a href="javascript://" role="button" class="select-all">{{selectAll}}</a>\n              </li>\n              <li class="last">\n                <a href="javascript://" role="button" class="select-none">{{selectNone}}</a>\n              </li>\n            </ul>\n            <div class="contact-list-container">\n              <table class="grid contact-list"></table>\n            </div>\n            <button id="invite-csvimport-send-button" type="submit" class="yj-btn yj-btn-disabled">{{selectInvitations}}</button>\n            <span class="secondary-actions">{{{orCancel}}}</span>\n          </form>\n        </div>\n        <div class="zero-contacts-error" style="display:none;">\n          <p style="font-weight:bold;">{{#community}} {{noContactsFound}} {{/community}} {{^community}} {{noContactsInDomain}} {{/community}}</p>\n          <span class="secondary-actions">\n            <a class="yj-btn import-another" href="#" role="button">\n              <span>{{importAddressesFromOtherBook}}</span>\n            </a>\n          </span>\n          <span class="secondary-actions">{{{orCancel}}}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n  <input type="hidden" class="enable-submit-flag" value="true" />\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("core/lib/ajax_form",["require","jquery","backbone","core/lib/yammer_request"],function(a){var b=a("jquery"),c=a("backbone"),d=a("core/lib/yammer_request");b.fn.ajaxForm=function(a){var e={submitOnInputChange:!1,successMessage:"",errorMessage:"",showSuccessFlash:!0,showErrorFlash:!0,successCallback:void 0,errorCallback:void 0,callbackScope:null,ajaxer:d.send,disabledClass:"yj-disabled",confirmText:!1,validationCallback:void 0};return"undefined"!=typeof a&&b.extend(e,a),this.each(function(){var a=b(this);e.submitOnInputChange===!0&&a.find("input, select").bind("change",{form:a},function(a){if("function"==typeof e.validationCallback&&e.validationCallback.call(e.callbackScope,a.data.form)===!1)return!1;var b=a.data.form;e.confirmText&&!window.confirm(e.confirmText)||b.submit()}),a.bind("submit",{form:a},function(a){var b=a.data.form;if("function"==typeof e.validationCallback&&e.validationCallback.call(e.callbackScope,b)===!1)return!1;var d={url:b.attr("action"),type:"post",contentType:"application/x-www-form-urlencoded",data:b.serialize(),success:function(a){e.showSuccessFlash===!0&&(null!==a.notice?c.trigger("/ui/alert/show","notice",a.notice):c.trigger("/ui/alert/show","notice",e.successMessage)),"function"==typeof e.successCallback&&e.successCallback.call(e.callbackScope,a,b)},error:function(a){a=JSON.parse(a.responseText),e.showErrorFlash===!0&&(null!==a.error?c.trigger("/ui/alert/show","error",a.error):c.trigger("/ui/alert/show","error",e.errorMessage)),"function"==typeof e.errorCallback&&e.errorCallback.call(e.callbackScope,b)},complete:function(){b.find("input").removeAttr("disabled").removeClass(e.disabledClass),b.removeClass("yj-loading")}};b.addClass("yj-loading"),b.find("input").attr("disabled","disabled").addClass(e.disabledClass),d.url.match(/\.[^\/]+$/)||(d.url+=".js"),e.ajaxer(d),a.preventDefault()})}),this}}),define("css!workfeed/lib/app/outlook_import",[],function(){}),define("workfeed/lib/app/outlook_import",["require","jquery","core/lib/tr","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","backbone","core/lib/util/authenticity_token","core/lib/session","html!./outlook_import","mustache","core/lib/yammer_uri","workfeed/lib/app/forms","core/lib/ajax_form","css!./outlook_import"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/tr"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_base_view"),f=a("backbone"),g=a("core/lib/util/authenticity_token"),h=a("core/lib/session"),i=a("html!./outlook_import"),j=a("mustache"),k=a("core/lib/yammer_uri"),l=a("workfeed/lib/app/forms");return a("core/lib/ajax_form"),a("css!./outlook_import"),e.extend({mixins:[d],template:i,id:"import-address-book-lightbox",getTemplateData:function(){var a=h.getCurrentNetwork();return{processOutlookHref:this._getProcessOutlookLink(),csvImportHelpHref:this._getCsvImportHelpLink(),processInvitesHref:this._getProcessInvitesLink(),groupId:this.options.groupId,csrfToken:g.get(),community:a.community,spinnerProcessing:c.t("processing"),selectAll:c.t("select_all"),selectNone:c.t("select_none"),importAddressesFromOtherBook:c.t("import_from_another_address_book"),noContactsInDomain:c.t("no_valid_contacts_import",{network:a.name}),noContactsFound:c.t("no_contacts"),fileLocationLabel:c.t("file_location"),previewButtonLabel:c.t("preview"),cancelButtonLabel:c.t("cancel_2"),selectPeopleToInvite:c.t("select_people_to_invite",{count:0}),sendInvitations:c.t("send_invitations",{count:0}),csvImportHelp:c.t("csv_import_help",{link:'<a href="'+this._getCsvImportHelpLink()+'" target="_blank">{$0}</a>'}),orCancel:c.t("or_cancel",{link:'<a href="javascript://" class="cancel-colorbox">{$0}</a>'})}},render:function(){return this._initEmailImport(),this._initForm(),this},_getProcessOutlookLink:function(){return k.app("/email_import/process_outlook.js")},_getCsvImportHelpLink:function(){return k.app("/email_import/csv_import_help")},_getProcessInvitesLink:function(){return k.app("/email_import/process_invite")},_initEmailImport:function(){function a(){f.trigger("/ui/lightbox/resize",{transition:"none"})}function d(a){var d=e.$(".contact-list"),k=d.parents(".contact-import-container:first"),l=0;d.find("tr").remove(),b.each(a.email_addresses,function(e,k){var m;k.member&&this.allowInvitingMembers?m=b(j.render(g,k)):void 0===k.valid||k.valid?m=b(j.render(h,b.extend({key:e},k))):(m=b(j.render(i,b.extend({key:e},k))),f.trigger("/ui/tooltip/add",{target:m.find("td.rejected"),text:c.t("this_email_address_is_not_allowed")})),m.find("input").change(function(a){n(b(a.target).parents("form:first"))}).end().appendTo(d),a.checked_by_default===!0&&(m.find(".checkbox").prop("checked",!0),l++)}),k.find("#email_addresses_provided").val("1"),k.find(".contact-count").text(c.t("weve_found_count_people_in_your_contact_list_select",{count:a.email_addresses.length})),n(d.parents("form:first")),e.$(".select-all").click(function(a){var c=b(a.target).parents(".contact-import-container:first");c.find(".contact-list input").prop("checked",!0),n(b(a.target).parents("form:first"))}),e.$(".select-none").click(function(a){var c=b(a.target).parents(".contact-import-container:first");c.find(".contact-list input").prop("checked",!1),n(b(a.target).parents("form:first"))}),b(document).bind("yj_cbox_complete",function(){b("#yj_cboxLoadedContent").find("#import-address-book-lightbox").length>0&&b("#import-address-book-lightbox").parents("#yj_cboxLoadedContent").css("border","none")})}var e=this,g='<tr>        <td><img src="'+k.cdn("assets/images/check.gif")+'" width="16" height="16"></td>        <td class="name">{{ name }} <span class="member-status">(joined)</span></td>        <td class="address" data-email-address={{ address }}>{{ address }}</td></tr>',h='<tr>        <td><input id="coworkers-{{ key }}" type="checkbox" class="checkbox" name="coworkers[]" value="{{ address}}" /></td>        <td class="name"><label for="coworkers-{{ key }}">{{ name }}</label></td>        <td class="address" data-email-address="{{ address }}">{{ address }}</td></tr>',i='<tr>        <td class="rejected"><img src="'+k.cdn("assets/images/x_red.gif")+'" width="16" height="16"></td>        <td class="name"><label for="coworkers-{{ key }}">{{ name }}</label></td>        <td class="address" data-email-address="{{ address }}">{{ address }}</td></tr>',l=0;this.$(".contact-import-form").ajaxForm({showSuccessFlash:!1,successCallback:function(c,d){var e=b.Event("contactsImported"),f=d.parents(".contact-import-container:first");return 0===c.payload.email_addresses.length?void f.find(".step-1").fadeOut("fast",function(){f.find(".step-2").fadeOut("fast",function(){f.find(".zero-contacts-error").fadeIn("fast")})}):(e.email_addresses=c.payload.email_addresses,e.checked_by_default=c.payload.checked_by_default,f.find(".contact-list").trigger(e),void f.find(".step-1").fadeOut("fast",function(){f.find(".step-2").fadeIn("fast"),a()}))},errorCallback:function(a){a.find(".preview-btn").removeClass("yj-btn-disabled").attr("disabled",null)}}).submit(function(a){b(a.target).find(".preview-btn").addClass("yj-btn-disabled").attr("disabled","disabled")}),this.$(".step-1 .preview-btn").on("click",function(){b(".step-1 #csv-upload-container-form").hide(),b(".step-1 #processing-spinner").show()});var m=this.$(".invite-contacts-form"),n=function(a){var b=a.find(".contact-list input:checked").length;l=b,b>0?(a.find("#invite-csvimport-send-button").text(c.t("send_count_invitations",{count:b})),a.find(".yj-btn:first").removeClass("yj-btn-disabled")):(a.find("#invite-csvimport-send-button").text(c.t("send_count_invitations",{count:0})),a.find(".yj-btn:first").addClass("yj-btn-disabled"))},o=function(){return 0===l?(f.trigger("/ui/alert/show","error",c.t("please_select_some_users_to_invite")),!1):void 0};"true"===this.$(".enable-submit-flag").val()?m.ajaxForm({validationCallback:o}):m.submit(function(a){if(o(m)===!1)return!1;var c=b.Event("inviteesSelected");return c.email_addresses=[],b(this).find("input:checked").each(function(){c.email_addresses.push(b(this).parents("tr:first").find("td.address").attr("data-email-address"))}),b(document).trigger(c),a.preventDefault(),!1}),m.submit(function(){o(m)!==!1&&setTimeout(function(){b.fn.colorbox.close(),e.$(".contact-import-container").trigger("reset")},300)}),this.$(".cancel-colorbox, .import-another").click(function(){e.$(".contact-import-container").trigger("reset")}),b("#yj_cboxClose").click(function(){e.$(".contact-import-container").trigger("reset")}),this.$(".contact-import-container").bind("reset",function(){b(this).find("input").not("[name='authenticity_token']").not("[name='community']").not("[name='include_members']").not("[name='group_id']").val("").removeClass("yj-valid").removeClass("yj-invalid"),b(this).find(".yj-validation-error").remove(),b(this).find(".zero-contacts-error").hide(),b(this).find(".step-2").hide(),b(this).find(".step-1").show(),b(".step-1 #csv-upload-container-form").show(),b(".step-1 #processing-spinner").hide(),b(this).find(".Invitecount").html(""),b(this).find(".yj-btn-disabled").removeClass("yj-btn-disabled").attr("disabled",null)}),yam.workfeed.CSVImporter={handleUploaded:function(c,e){var f=b.Event("contactsImported"),g=b("#csv");return 0===c.length?void g.find(".step-1").fadeOut("fast",function(){g.find(".step-2").fadeOut("fast",function(){g.find(".zero-contacts-error").fadeIn("fast")})}):(f.email_addresses=c,f.checked_by_default=e,d(f),void g.find(".step-1").fadeOut("fast",function(){g.find(".step-2").fadeIn("fast"),a()}))}}},_initForm:function(){b("#invite-form").ajaxForm({successCallback:function(){b("#invite-form").find("#invite_addresses").val("")}}),b("#group-invite-submit").click(function(){a()&&(b(this).attr("disabled",!0),b(this).addClass("yj-btn-disabled"),b(this).closest("form").submit())}),b(document).bind("inviteesSelected",function(a){b("#emails").show().focus().val(b("#emails").val()+a.email_addresses.join(", ")).keyup()});var a=function(){var a,c,e,f=!1;b.trim(b("#emails").val()).length>0&&(f=!0),e="true"===b("#is_canonical").val()?/^([A-Za-z0-9_\-\.\'\$\+\*\&])+$/:l.EMAIL_REGEX;for(var g=0;5>g;g++)if(b("#invite_by_email_"+g).length){if(a=b.trim(b("#invite_by_email_"+g).val()),c=a.match(e),a.length>1){if(!c)return d(),!1;f=!0}}else f=!0;return f?!0:(d(),!1)},d=function(){f.trigger("/ui/alert/show","error",c.t("please_enter_a_valid_email_address"))}}})}),define("css!workfeed/lib/app/group_settings",[],function(){}),define("stache!workfeed/lib/app/group_settings",["mustache"],function(a){var b='{{#colorCustomizationEnabled}}\n<div class="yj-group-settings--preview-message">\n  <span class="yamicon yamicon-rd_info"></span><span class="yj-group-settings--preview-message-text">{{headerPreviewMessage}}</span>\n</div>\n{{/colorCustomizationEnabled}}\n<div id="groups-creation-container" class="groups-creation">\n<div class="edit-group group-settings">\n  <fieldset class="group-info group-image no-bottom-margin">\n    {{^colorCustomizationEnabled}}\n    <div class="dl" >\n      <div class="dl last">\n        <div class="dt" ><label for="group_mugshot">{{groupImageLabel}}</label></div>\n        <div class="dd mugshot-overall-container">\n          <div class="mugshot-container yj-mugshot-thumb-left">\n            <img src="{{groupMugshotUrl}}" class="default-photo" alt="{{groupImageLabel}}">\n          </div>\n          <input class="file-input yj-mugshot-form-file-margin yj-mugshot-file-input" id="group_mugshot" name="image" type="file">\n        </div>\n      </div>\n    </div>\n    {{/colorCustomizationEnabled}}\n  </fieldset>\n\n  {{#currentUserCanDelete}}\n    <div class="group-actions">\n      <a href="{{confirmDeleteUrl}}" role="button">{{deleteGroupLabel}}</a>\n    </div>\n  {{/currentUserCanDelete}}\n\n<form accept-charset="UTF-8" action={{groupHref}} class="edit_group" enctype="multipart/form-data" method="post">\n  <div style="margin:0;padding:0;display:inline">\n     <input name="utf8" type="hidden" value="✓">\n     <input name="_method" type="hidden" value="put">\n     <input name="authenticity_token" type="hidden" value="{{csrf}}">\n  </div>\n  <input class="hidden_mugshot_id" id="group_mugshot_id" name="group[mugshot_id]" type="hidden" value="{{hiddenMugshotId}}">\n  <input class="yj-hidden" id="group_id" name="group_id" type="hidden" value="{{groupId}}">\n  <fieldset class="group-info group-details">\n      <div class="dl" >\n        <div class="dt group-detail-label">\n          <span id="group_name_status" class="response"></span>\n          <label for="group_name_entry">{{groupNameLabel}}</label>\n        </div>\n        <div class="dd" >\n          <div class="group-name">\n            <input class="group-name-entry" id="group_name_entry" maxlength="150" name="group[name]" size="150" type="text" value="{{groupName}}">\n            <input type="hidden" class="field-status" value="invalid" />\n          </div>\n        </div>\n      </div>\n      {{#colorCustomizationEnabled}}\n      <div class="yj-group-settings--section-heading">{{groupAvatarAndColorLabel}}</div>\n      <div class="yj-group-mugshot-upload-container">\n        <input class="file-input yj-group-mugshot-file-input" id="group_mugshot" name="image" type="file">\n        <div class="mugshot-container yj-group-mugshot-container">\n          <img src="{{groupMugshotUrl}}" class="default-photo yj-group-settings--mugshot" alt="{{groupImageLabel}}">\n        </div>\n        <button type="button" class="yj-group-mugshot-upload-button yj-btn yj-btn-alt"><span class="yamicon yamicon-upload"></span><span class="yj-group-mugshot-upload-button-label">{{groupAvatarUploadLabel}}</span></button>\n      </div>\n      <div class="yj-group-settings--color-picker-container"></div>\n      {{/colorCustomizationEnabled}}\n      <div class="dl"  class=\'no-bottom-margin\'>\n        <div class="dt group-detail-label">\n          <span id="group-count" class="char-count yj-hide">{{{remainingCharacterCount}}}</span>\n          <label for="group_description_entry">{{groupDescriptionLabel}}</label>\n        </div>\n        <div class="dd" >\n          <textarea id="group_description_entry" class="group-description-entry" name="group[description]">{{groupDescription}}</textarea>\n        </div>\n      </div>\n  </fieldset>\n\n  <fieldset class="settings options members-option">\n    <div class="dl" >\n     <div class="dt" >{{groupMembersLabel}}</div>\n      <div class="dd" >\n        <div class="actions">{{groupMembersCountString}}\n         <a href="#" role="button" class="edit-members-lightbox links">{{addMembersLabel}}</a>\n         <a href="#" role="button" class="links" id="invite-address-book">{{importMembersFromAddressBook}}</a>\n        </div>\n      </div>\n   </div>\n  </fieldset>\n\n    <fieldset class="settings options manage-members-option">\n      <legend><div role="heading" aria-level="3">{{managementSectionLabel}}</div></legend>\n      <div class="dl" >\n        <div class="dt" >{{manageAdminsLabel}}</div>\n        <div class="dd" >\n          <a href="javascript://" role="button" class="edit-members-lightbox group-settings-manage-admins" data-qaid="group-settings-add-remove-admins">{{addRemoveGroupAdminsLabel}}</a>\n        </div>\n        <div class="dt" >{{manageMembersLabel}}</div>\n        <div class="dd" >\n          <a href="javascript://" role="button" class="edit-members-lightbox group-settings-manage-members" data-qaid="group-settings-remove-members">{{removeMembers}}</a>\n        </div>\n      </div>\n    </fieldset>\n\n    <fieldset class="settings options content-option">\n      <legend><div role="heading" aria-level="3">{{contentOptionsLabel}}</div></legend>\n      <div class="dl" >\n        <div class="dt" >{{announcementsLabel}}</div>\n        <div class="dd" >\n          <a href="javascript://" role="button" class="help-lightbox" data-lightbox-src="settings_announcements">{{announceToGroup}}</a>\n        </div>\n        {{#currentNetworkPaid}}\n          <div class="dt" >{{officialContentLabel}}</div>\n          <div class="dd" >\n            <a href="javascript://" role="button" class="help-lightbox" data-lightbox-src="settings_official_content">{{officialContent}}</a>\n          </div>\n        {{/currentNetworkPaid}}\n      </div>\n    </fieldset>\n\n    <div class="settings group-privacy">\n    </div>\n\n    <div class="form-buttons">\n      <button id="submit_edit_group_form" type="submit" class="yj-btn"><span>{{saveButtonLabel}}</span></button>\n      <a href="{{groupHref}}" class="yj-btn yj-btn-alt" role="button">{{cancelButtonLabel}}</a>\n    </div>\n</form>\n</div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/group_settings",["require","jquery","underscore","mustache","core/lib/tr","backbone","core/lib/session","models/helpers/user","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/util/authenticity_token","common-ui/lib/ui/general/lightbox_manager","common-ui/lib/ui/groups/member_list","workfeed/lib/modules/observe_field","workfeed/lib/modules/file_uploader","workfeed/lib/modules/character_counter","workfeed/lib/app/settings_privacy_controls","components/group_color_picker/index","workfeed/lib/app/outlook_import","common-ui/lib/helper/name_validator","core/lib/string_helper","core/lib/treatment","core/lib/yammer_api","models/network","core/lib/urls","css!./group_settings","html!./group_settings"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("core/lib/tr"),f=a("backbone"),g=a("core/lib/session"),h=a("models/helpers/user"),i=a("core/lib/backbone_with_auto_render"),j=a("core/lib/backbone_base_view"),k=a("core/lib/util/authenticity_token"),l=a("common-ui/lib/ui/general/lightbox_manager"),m=a("common-ui/lib/ui/groups/member_list"),n=a("workfeed/lib/modules/observe_field"),o=a("workfeed/lib/modules/file_uploader"),p=a("workfeed/lib/modules/character_counter"),q=a("workfeed/lib/app/settings_privacy_controls"),r=a("components/group_color_picker/index"),s=a("workfeed/lib/app/outlook_import"),t=a("common-ui/lib/helper/name_validator"),u=a("core/lib/string_helper"),v=a("core/lib/treatment"),w=a("core/lib/yammer_api"),x=a("models/network"),y=a("core/lib/urls");return a("css!./group_settings"),j.extend({mixins:[i],template:a("html!./group_settings"),className:"yj-group-settings",defaults:{descriptionMaxCharsLength:150},events:{"click .edit-members-lightbox":"_showMembersLightbox","click #invite-address-book":"_showOutlookImportLightbox","click .help-lightbox":"_showHelpLightbox","submit form":"_submitForm","click .yj-group-mugshot-container":"_clickMugshotUpload","click .yj-group-mugshot-upload-button":"_clickMugshotUpload"},initialize:function(){c.bindAll(this,"_showMembersLightbox","_showHelpLightbox","_submitForm"),this.listenTo(this.model,"change",this.render)},getTemplateData:function(){var a=g.getCurrentNetwork(),b=v.treatment("tow_group_header_color_customization")?150:48,c=this.model.get("stats"),d=c&&c.members>=0;
return{csrf:k.get(),groupImageLabel:e.t("group_image_form_label"),importMembersFromAddressBook:e.t("import_members_from_address_book"),managementSectionLabel:e.t("group_member_managment_section"),manageAdminsLabel:e.t("manage_group_admins_label"),manageMembersLabel:e.t("manage_group_members_label"),addRemoveGroupAdminsLabel:e.t("add_remove_group_admins_label"),removeMembers:e.t("remove_members"),announceToGroup:e.t("announce_to_group"),deleteGroupLabel:e.t("delete_group_label"),groupNameLabel:e.t("create_ig_group_name_label"),groupMembersLabel:e.t("group_members_label"),groupDescriptionLabel:e.t("group_description_form_label"),cancelButtonLabel:e.t("cancel"),saveButtonLabel:e.t("group_settings_save"),announcementsLabel:e.t("announcements"),contentOptionsLabel:e.t("content_options_label"),officialContentLabel:e.t("official_content_label"),officialContent:e.t("mark_files_notes_official"),addMembersLabel:e.t("group_add_members_label"),groupAvatarAndColorLabel:e.t("group_avatar_and_color"),groupAvatarUploadLabel:e.t("upload"),headerPreviewMessage:e.t("group_header_preview_message"),remainingCharacterCount:this._buildDescriptionCountText(this.options.descriptionMaxCharsLength),currentUserCanDelete:yam.helper.group.canCurrentUserDelete(this.model,g,x),groupName:this.model.get("full_name"),groupDescription:this.model.get("description"),groupMugshotUrl:y.groupMugshot(this.model,b),currentNetworkPaid:a.paid,confirmDeleteUrl:y.groupDelete(this.model),hiddenMugshotId:this.model.get("mugshot_id"),hiddenMugshotColor:this.model.get("mugshot_color"),groupId:this.model.get("id"),groupMembersCountString:d?e.t("count_members",{count:c.members}):"",groupHref:y.groupName(this.model),colorCustomizationEnabled:v.treatment("tow_group_header_color_customization")}},render:function(){new n(this.$("#group_name_entry"),{validateFunction:function(a){return a===this.model.get("full_name")?b.Deferred().resolve(e.t("name_is_available")):t.validateGroupName(a)}.bind(this),update:this.$("#group_name_status"),spinner:!0,submit:this.$("#submit_edit_group_form"),validate:!0});var a=".mugshot-overall-container",d="small";v.treatment("tow_group_header_color_customization")&&(a=".yj-group-mugshot-upload-container",d="group_settings"),new o({container:this.$(".group-info "+a),file:this.$(".group-info "+a+" .file-input"),thumbnail:this.$(".group-info "+a+" .mugshot-container"),dimensions:d,autoUpdateUserMugshot:!1,hiddenMugshotIdField:this.$(".edit_group .hidden_mugshot_id"),generateMugshotColor:!0,saveButtonToDisable:this.$("#submit_edit_group_form"),onMugshotUploaded:function(a,b,c){c&&c.match(/^#[0-9a-f]{6}$/i)&&(this._createColorField(c),v.treatment("tow_group_header_color_customization")&&(this._previewColorInGroupHeader(c),this._previewAvatarInGroupHeader(b),this.groupColorPickerView&&this.groupColorPickerView.setCustomColor(c)))}.bind(this)}),this.shouldShowInvite&&yam.ready(c.bind(function(){this.$("#invite-address-book").trigger("click")},this));var f=this.$(".char-count");return p.init({textarea:this.$("#group_description_entry"),count:f,max:this.options.descriptionMaxCharsLength,buildCountString:this._buildDescriptionCountText,topLevel:f,negClass:"yj-invalid"}),this._renderGroupPrivacyControls(),v.treatment("tow_group_header_color_customization")&&this._addGroupColorPicker(),this},_renderGroupPrivacyControls:function(){var a=u.convertStringyBoolean(this.model.get("show_in_directory")),b=new q({isPrivate:yam.helper.group.isPrivate(this.model),isModerated:yam.helper.group.isModerated(this.model),showInDirectory:a,showWhoCanViewContent:!yam.helper.group.isExternal(this.model),extendedOptions:!yam.helper.group.isExternal(this.model),isPublic:yam.helper.group.isPublic(this.model)});this.$(".group-privacy").html(b.render().$el)},_createColorField:function(a){var c=this.$("#group_mugshot_color");if(c.length>0)c.val(a);else{var e='<input class="hidden_mugshot_color" id="group_mugshot_color" name="group[mugshot_color]" type="hidden" value="{{color}}">',f=d.render(e,{color:a});b(f).insertAfter(this.$("#group_mugshot_id"))}},_addGroupColorPicker:function(){var a=this;w.getGroupColorPalette().then(function(b){a.groupColorPickerView=new r({colors:b,originalColor:yam.helper.group.getGroupColor(a.model)}),a.listenTo(a.groupColorPickerView,"/ui/group_settings/changeGroupColor",function(b){a._validateForm(),b.isValid&&(a._createColorField(b.color),a._previewColorInGroupHeader(b.color))}),a.listenTo(a.groupColorPickerView,"/ui/group_settings/saveGroupColor",function(){a._hidePreviewMessage()}),a.$(".yj-group-settings--color-picker-container").html(a.groupColorPickerView.render().$el)})},_previewColorInGroupHeader:function(a){!yam.helper.group.isCurrentUserMember(this.model)&&h.isAdmin(g.getCurrentUser())&&f.trigger("/ui/group/setHeaderJoin",!0),f.trigger("/ui/group/setGroupColor",a),this.$(".yj-group-settings--preview-message").show()},_previewAvatarInGroupHeader:function(a){f.trigger("/ui/group/mugshotPreview",a),this.isPreviewingAvatar=!0},_hidePreviewMessage:function(){this.isPreviewingAvatar||this.$(".yj-group-settings--preview-message").hide()},_clickMugshotUpload:function(){this.$("#group_mugshot").click()},_buildDescriptionCountText:function(a){return e.t("remaining_character_count",{span:'<span class="count">{$0}</span>',count:a})},_showMembersLightbox:function(a){a.preventDefault();var b=new m({groupId:this.model.get("id"),permalink:this.model.get("name"),isCommunity:this.model.get("community")});m.showInLightbox(b)},_showOutlookImportLightbox:function(a){a.preventDefault(),l.openComponent(new s({groupId:this.model.get("id")}),"yj-quick-link-lightbox",void 0,{title:e.t("import_from_address_book"),width:null})},_showHelpLightbox:function(a){var c,d,g=b(a.currentTarget),h=g.attr("data-lightbox-src");switch(h){case"settings_announcements":d=e.t("send_an_announcement_to_the_entire_group"),c="<p>"+e.t("group_admins_can_use_announcements_to_broadcast_important_information")+"</p>";break;case"settings_official_content":d=e.t("mark_files_and_notes_as_official"),c=e.t("group_admins_can_mark_files_or_notes_as_official");break;default:return!1}c='<div class="yj-lightbox-content help-lightbox-content">'+c,c+="</div>",f.trigger("/ui/lightbox/open",{html:c,title:d,innerWidth:"450px"})},_submitForm:function(a){this.$("#group_name_entry").hasClass("invalid")&&(f.trigger("/ui/alert/show","error",e.t("please_choose_a_valid_name_for_your_group")),a.preventDefault()),this.$("#group_description_entry").val().length>this.options.descriptionMaxCharsLength&&(f.trigger("/ui/alert/show","error","The description must be less than "+this.options.descriptionMaxCharsLength+" characters long."),a.preventDefault())},_validateForm:function(){var a=this.$("#submit_edit_group_form");this.$(".yj-invalid").length>0?(a.addClass("yj-btn-disabled"),a.attr("disabled",!0)):(a.removeClass("yj-btn-disabled"),a.attr("disabled",!1))}})}),define("stache!workfeed/lib/app/views/group/settings",["mustache"],function(a){var b='{{#hasGroup}}<GroupHeader key="group-header"/>{{/hasGroup}}\n<div class="page-content-container yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block sticky-group-header-column" role="main">\n  {{#hasError}}<GroupErrorNotice key="group-error-notice"/>{{/hasError}}\n  {{#showSettings}}<GroupSettings key="group-settings"/>{{/showSettings}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/group/settings",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","workfeed/lib/app/header/group_error_notice","workfeed/lib/app/header/group_header","workfeed/lib/app/group_settings","workfeed/lib/app/helpers/group_error_helper","models/helpers/group","core/lib/location_helper","core/lib/util/route_helper","feeds/lib/ui/util/title_updater","core/lib/tr","core/lib/urls","html!./settings"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("workfeed/lib/app/header/group_error_notice"),f=a("workfeed/lib/app/header/group_header"),g=a("workfeed/lib/app/group_settings"),h=a("workfeed/lib/app/helpers/group_error_helper"),i=a("models/helpers/group"),j=a("core/lib/location_helper"),k=a("core/lib/util/route_helper"),l=a("feeds/lib/ui/util/title_updater"),m=a("core/lib/tr"),n=a("core/lib/urls"),o=a("html!./settings");return c.extend({mixins:[b,d],template:o,views:{GroupHeader:"_createGroupHeader",GroupErrorNotice:"_createGroupErrorNotice",GroupSettings:"_createGroupSettings"},initialize:function(){l.setTitle(""),i.fetch(this.options.groupId).then(k.executeInCurrentFragment(this._groupFetchSuccess,this),k.executeInCurrentFragment(this._groupFetchError,this))},_groupFetchSuccess:function(a){return this._group=a,this._error=h.getErrorForGroup(a),l.setTitle(a.get("full_name")+" : "+m.t("group_settings")),i.isAllCompany(a)||!i.isEditableByCurrentUser(a)?void j.assign(n.groupIndex(a)):(this._showSettings=!this._error,void this.render())},_groupFetchError:function(a){this._error=h.getErrorForStatus(a.status),this.render()},_createGroupHeader:function(){return new f({model:this._group})},_createGroupErrorNotice:function(){return new e({group:this._group,error:this._error})},_createGroupSettings:function(){return new g({model:this._group})},getTemplateData:function(){return{hasGroup:!!this._group,hasError:!!this._error,showSettings:this._showSettings}}})}),define("stache!workfeed/lib/app/views/group/delete",["mustache"],function(a){var b='{{#loaded}}\n<div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block">\n  <div class="page-header">\n    <div class="header-content">\n      <h2>{{title_label}}</h2>\n    </div>\n  </div>\n</div>\n<div class="yk-row">\n  <div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n    <h2>{{confirm_label}}</h2>\n    <p>{{{warning_label}}}</p>\n    <div class="buttons">\n      <button class="yj-btn yj-delete-group-confirm--delete">{{delete_label}}</button>\n      or <a href="{{group_url}}">{{cancel_label}}</a>\n    </div>        \n  </div>\n</div>\n{{/loaded}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/group/delete",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","core/lib/yammer_api","core/lib/tr","backbone","core/lib/urls","core/lib/location_helper","collections/groups","models/helpers/group","collections/group_memberships","core/lib/session","core/lib/yammer_uri","html!./delete"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/yammer_api"),f=a("core/lib/tr"),g=a("backbone"),h=a("core/lib/urls"),i=a("core/lib/location_helper"),j=a("collections/groups"),k=a("models/helpers/group"),l=a("collections/group_memberships"),m=a("core/lib/session"),n=a("core/lib/yammer_uri"),o=a("html!./delete");return c.extend({className:"yj-delete-group-confirm",mixins:[b,d],template:o,events:{"click .yj-delete-group-confirm--delete":"deleteGroup"},initialize:function(){this.model=j.get(this.options.groupId),this.model||this._fetchGroup()},_fetchGroup:function(){var a=this;e.getGroup({id:this.options.groupId}).then(function(b){a.model=j.add(b),a.render()}).fail(function(b){var c=h.groupIndex({id:a.options.id});404===b.status&&(c=n.app("/#/home")),i.replace(c)})},getTemplateData:function(){return this.model?{loaded:!0,title_label:f.t("group_delete_title"),confirm_label:f.t("group_delete_confirm",{group:k.getFullName(this.model)}),warning_label:f.t("group_delete_warning"),delete_label:f.t("group_delete_delete_button"),cancel_label:f.t("group_delete_cancel_button"),group_url:h.groupIndex(this.model)}:{}},deleteGroup:function(){var a=this;e.deleteGroup({id:this.options.groupId}).then(function(){a._removeUserFromGroup(),i.replace(h.groupIndex({id:a.options.groupId}))}).fail(function(a){var b=f.t("group_delete_fail");403===a.status&&(b=f.t("group_delete_perms")),g.trigger("/ui/alert/show","error",b)})},_removeUserFromGroup:function(){var a=l.findWhere({user_id:m.getCurrentUser().id,group_id:this.model.id});a&&a.destroy(),j.remove(this.options.groupId)}})}),define("core/lib/backbone_with_animations",["require","underscore","jquery"],function(a){"use strict";var b=a("underscore"),c=a("jquery"),d=function(a){return a.animatedElements=a.animatedElements.filter(function(a){var b=c(a).queue("fx");return b&&b.length>0}),a.animatedElements.length>0},e=function(a,d,e){b.isString(a)&&(a=this.$(a)),e=b.isObject(e)?e:{};var f=this._animateData,g=this.render,h=e.complete;return e=b.extend(e,{complete:function(){b.isFunction(h)&&h.apply(null,arguments),f.isRenderCallPending&&b.defer(g.bind(this))}.bind(this)}),c(a)[this.animateMethod](d,e),f.animatedElements.push(a),this},f=function(a,b){b=b||{};var c=this,e=this._animateData;return d(e)&&!b.force?e.isRenderCallPending=!0:(b.force&&h(e),e.isRenderCallPending=!1,c=a.call(this)),c},g=function(a,c){this.animateMethod=b.result(c,"animateMethod")||this.animateMethod,a.call(this,c)},h=function(a){d(a)&&(a.animatedElements.forEach(function(a){c(a).stop(!0)}),a.animatedElements.length=0)},i=function(a){var b=this._animateData;return h(b),a.call(this)},j=function(a,c,d){return c.initialize&&(c.initialize=b.wrap(c.initialize,g)),c.render&&(c.render=b.wrap(c.render,f)),c.remove&&(c.remove=b.wrap(c.remove,i)),a.call(this,c,d)},k=function(){this.constructor.extend=b.wrap(this.constructor.extend,j),this.initialize=b.wrap(this.initialize,g),this.render=b.wrap(this.render,f),this.remove=b.wrap(this.remove,i),this._animateData={animatedElements:[],isRenderCallPending:!1},this.animateMethod=this.animateMethod||"animate",this.animate=e};return k}),define("stache!feeds/lib/ui/inbox/expiring_announcements_banner",["mustache"],function(a){var b='<div class="yj-expiring-announcements-banner--network-icon">{{{svgIconMegaphone}}}</div>\n<div class="yj-expiring-announcements-banner--header">{{header}}</div>\n<div class="yj-expiring-announcements-banner--body">\n  <p class="yj-expiring-announcements-banner--body-message">{{{message_1}}}</p>\n  <p class="yj-expiring-announcements-banner--body-message">{{{message_2}}}</p>\n  <p>\n    <button class="yj-btn yj-expiring-announcements-banner--dismiss">\n      <span>{{closeAltText}}</span>\n    </button>\n  </p>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/expiring_announcements_banner",[],function(){}),define("feeds/lib/ui/inbox/expiring_announcements_banner",["require","underscore","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","collections/banners","common-ui/lib/helper/svg_icon","backbone","core/lib/tr","html!./expiring_announcements_banner","css!./expiring_announcements_banner"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("collections/banners"),f=a("common-ui/lib/helper/svg_icon"),g=a("backbone"),h=a("core/lib/tr"),i=a("html!./expiring_announcements_banner");a("css!./expiring_announcements_banner");var j="expiring-announcements";return d.extend({mixins:[c],events:{"click .yj-expiring-announcements-banner--dismiss":"_handleClose","click .yj-expiring-announcements-banner--learn-more":"_handleLearnMore"},template:i,className:"yj-expiring-announcements-banner yj-hidden",initialize:function(){var a=this;b.defer(function(){a._showBanner(a.options.target)}),this.listenTo(g,"/ui/announcementbanner/remove",this._hideBanner)},getTemplateData:function(){var a={width:32,height:32};return{svgIconMegaphone:f("megaphone",a),header:h.t("announcement_banner_header"),message_1:h.t("announcement_banner_text_1"),message_2:h.t("announcement_banner_text_2",{link:'<a href="http://www.surveygizmo.com/s3/2440486/Expiring-announcements-feedback" class="yj-expiring-announcements-banner--learn-more" target="_blank">{$0}</a>'}),closeAltText:h.t("announcement_banner_close_button")}},_handleClose:function(a){a.stopPropagation(),this._hideBanner(),this._optOutOfBanner()},_handleLearnMore:function(a){a.stopPropagation()},_showBanner:function(a){this.$el.removeClass("yj-hidden").css("left",a.outerWidth())},_hideBanner:function(){this.$el.addClass("yj-hidden")},_optOutOfBanner:function(){e.getOrFetch(j).optOut()}},{BANNER_NAME:j})}),define("stache!feeds/lib/ui/inbox/inbox_list_item_header",["mustache"],function(a){var b='{{#headerMessage}}\n  <div class="yj-inbox-list-item--message-header {{#shouldShowAnnouncementsBanner}}yj-message-header--announcement{{/shouldShowAnnouncementsBanner}}">{{headerMessage}}</div>\n  {{#shouldShowAnnouncementsBanner}}\n    <div class="yj-message-header--banner">\n      <ExpiringAnnouncementsBanner key="expiring_announcements_banner"/>\n    </div>\n  {{/shouldShowAnnouncementsBanner}}\n{{/headerMessage}}';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/inbox_list_item_header",[],function(){}),define("feeds/lib/ui/inbox/inbox_list_item_header",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","core/lib/treatment","core/lib/util/emoji_helper","backbone","core/lib/session","models/user","feeds/lib/ui/inbox/expiring_announcements_banner","html!./inbox_list_item_header","css!./inbox_list_item_header"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/tr"),f=a("core/lib/treatment"),g=a("core/lib/util/emoji_helper"),h=a("backbone"),i=a("core/lib/session"),j=a("models/user"),k=a("feeds/lib/ui/inbox/expiring_announcements_banner"),l=a("html!./inbox_list_item_header");return a("css!./inbox_list_item_header"),b.extend({mixins:[c,d],template:l,views:{ExpiringAnnouncementsBanner:"_getExpiringAnnouncementBanner"},initialize:function(){this._thread=this.options.thread,this._isRead=this.options.isRead,this._unreadCount=this.options.unreadCount},getTemplateData:function(){return{shouldShowAnnouncementsBanner:this.options.shouldShowAnnouncementsBanner,headerMessage:g.parse(this._getMessageHeader())}},_getMessageHeader:function(){var a,b=this._thread.getThreadStarter();if("announcement"===this._thread.getThreadStarter().message_type)a=e.t("announcement");else if(b.hasAttachmentOfType("praise")){var c=j.findById(b.hasAttachmentOfType("praise").praised_user_ids[0]);a=c.id===i.getCurrentUser().id?e.t("sender_praised_you",{sender:b.findSender().full_name}):b.findSender().id===i.getCurrentUser().id?e.t("you_praised_praisee",{praisee:c.full_name}):e.t("sender_praised_praisee",{sender:b.findSender().full_name,praisee:c.full_name})}else a=b.direct_message?this._isRead?f.usePriorityCopy()?e.t("direct_message"):e.t("private_message_2"):f.usePriorityCopy()?e.t("direct_message"):e.t("new_private_message"):this._isRead?"":!this._unreadCount||this._thread.getReplies().length<this._unreadCount?f.usePriorityCopy()?e.t("priority_conversation"):e.t("new_conversation"):e.t("unread_replies",{count:this._unreadCount});return a},_getExpiringAnnouncementBanner:function(){return this.options.shouldShowAnnouncementsBanner?(h.trigger("/ui/announcementbanner/remove"),new k({target:this.$el.find(".yj-message-header--announcement")})):void 0}})}),define("stache!components/mini_facepile/src/mini_facepile_item",["mustache"],function(a){var b='<div class="yj-mini-facepile-item-center-align">\n  <AvatarView />\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("components/mini_facepile/src/mini_facepile_item",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/avatar/index","html!./mini_facepile_item"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("components/avatar/index"),f=a("html!./mini_facepile_item");return b.extend({mixins:[c,d],template:f,tagName:"li",className:function(){var a=this.options.vertical?"vertical":"square";return"yj-mini-facepile--item yj-mini-facepile--item-"+a},defaults:{vertical:!1,withHovercard:!1,hideFromAccessibility:!0,excludeLink:!1},views:{AvatarView:"_getAvatar"},_getAvatar:function(){return new e(this.options)}})}),define("stache!components/mini_facepile/src/mini_facepile",["mustache"],function(a){var b='<ol class="yj-mini-facepile--list yj-mini-facepile--list-{{name}}">\n  {{#items}}\n    <MiniFacepileItemView key="{{id}}" data-vertical="{{vertical}}" />\n  {{/items}}\n</ol>\n\n{{#borders}}\n  <div class="yj-mini-facepile--border-{{.}}"/>\n{{/borders}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/mini_facepile/src/mini_facepile",[],function(){}),define("components/mini_facepile/src/mini_facepile",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./mini_facepile_item","html!./mini_facepile","css!./mini_facepile.css"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./mini_facepile_item"),f=a("html!./mini_facepile");a("css!./mini_facepile.css");var g=["one","two","three","four"],h=["top","bottom","right","left"];return b.extend({mixins:[c,d],template:f,className:"yj-mini-facepile",attributes:{"aria-hidden":!0},defaults:{withHovercard:!1,excludeLink:!1},views:{MiniFacepileItemView:"_getMiniFacepileItem"},initialize:function(){this.listenTo(this.collection,"add remove reset sort",this.render)},getTemplateData:function(){var a=this._getParticipantCount();return{name:this._getName(a),borders:this._getBorders(a),items:this.collection.map(function(b,c){return{id:b.id,vertical:this._isParticipantVertical(a,c)}},this)}},_getMiniFacepileItem:function(a,b){var c=this.collection.get(a);return new e({model:c,vertical:"true"===b("vertical"),withHovercard:this.options.withHovercard,excludeLink:this.options.excludeLink})},_getParticipantCount:function(){return Math.min(this.collection.length,4)},_getName:function(a){return g[a-1]},_getBorders:function(a){return h.slice(0,2>a?0:a)},_isParticipantVertical:function(a,b){return 2===a||3===a&&0===b}})}),define("components/mini_facepile/index",["require","./src/mini_facepile"],function(a){"use strict";var b=a("./src/mini_facepile");return b}),define("stache!feeds/lib/ui/inbox/inbox_list_item_avatar",["mustache"],function(a){var b='{{#participants}}\n<div class="yj-inbox-list-item--multiple-participants" data-qaid="inbox_avatar">\n  <MiniFacepile key="mini_face_pile"/>\n</div>\n{{/participants}}\n{{^participants}}\n  <div class="yj-inbox-list-item--single-participant" data-qaid="inbox_avatar">\n    <Avatar key="avatar"/>\n  </div>\n{{/participants}}';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/inbox_list_item_avatar",[],function(){}),define("feeds/lib/ui/inbox/inbox_list_item_avatar",["require","underscore","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/avatar/index","components/mini_facepile/index","models/user","models/helpers/conversation","html!./inbox_list_item_avatar","css!./inbox_list_item_avatar"],function(a){"use strict";var b=a("underscore"),c=a("backbone"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("components/avatar/index"),h=a("components/mini_facepile/index"),i=a("models/user"),j=a("models/helpers/conversation"),k=a("html!./inbox_list_item_avatar");return a("css!./inbox_list_item_avatar"),d.extend({mixins:[e,f],template:k,className:"yj-inbox-list-item--avatar",views:{Avatar:"_getAvatar",MiniFacepile:"_getMiniFacepile"},initialize:function(){this._thread=this.options.thread,this._user=this.options.user,this._dimensions=this.options.dimensions},getTemplateData:function(){return{participants:this._getParticipants(this._user).length>1}},_getParticipants:function(){var a,c,d=function(a){var b=i.findById(a);return b};return a=this._thread.getConversation(),c=a?j.getParticipants(a).map(i.save.bind(i)):b.chain(this._thread.getMessages()).pluck("sender_id").uniq().map(d).compact().take(3).value()},_getAvatar:function(){return new g({model:this._user,size:this._dimensions,withHovercard:!0,hideFromAccessibility:!0,excludeLink:!0})},_getMiniFacepile:function(){return new h({collection:new c.Collection(this._getParticipants(this._user)),withHovercard:!0,excludeLink:!0})}})}),define("stache!feeds/lib/ui/inbox/inbox_list_item_user_link",["mustache"],function(a){var b='<a class="yj-hovercard-link yj-inbox-list-item--message-sender-user" data-resource-model="user" data-resource-id="{{userResourceId}}" dir="auto">{{userFullName}}</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/inbox_list_item_user_link",[],function(){}),define("feeds/lib/ui/inbox/inbox_list_item_user_link",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/string_helper","backbone","models/helpers/user","html!./inbox_list_item_user_link","css!./inbox_list_item_user_link"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/string_helper"),e=a("backbone"),f=a("models/helpers/user"),g=a("html!./inbox_list_item_user_link");return a("css!./inbox_list_item_user_link"),b.extend({mixins:[c],tagName:"span",template:g,initialize:function(){this._user=this.options.user},getTemplateData:function(){var a=f.getFullName(this._user);return{userFullName:this.options.nameTruncationLimit?d.truncate(a,this.options.nameTruncationLimit):a,userResourceId:this._user.id}},render:function(){return e.trigger("/ui/hovercard/build",this.$el,".yj-hovercard-link"),this}})}),define("stache!feeds/lib/ui/inbox/inbox_list_item_group_link",["mustache"],function(a){var b='<a class="yj-hovercard-link yj-inbox-list-item--message-sender-group" data-resource-model="group" data-resource-id="{{groupResourceId}}">{{groupFullName}}</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/inbox_list_item_group_link",[],function(){}),define("feeds/lib/ui/inbox/inbox_list_item_group_link",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","backbone","core/lib/session","core/lib/yammer_uri","models/network","models/helpers/network","html!./inbox_list_item_group_link","css!./inbox_list_item_group_link"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("backbone"),f=a("core/lib/session"),g=a("core/lib/yammer_uri"),h=a("models/network"),i=a("models/helpers/network"),j=a("html!./inbox_list_item_group_link");return a("css!./inbox_list_item_group_link"),b.extend({mixins:[c],tagName:"span",template:j,initialize:function(){this._thread=this.options.thread},getTemplateData:function(){var a,b,c,e=this._thread.getGroup(),j=this._thread.isForeign();if(e?(a=e.get("full_name"),c=g.app("/#/threads/inGroup?type=in_group&feedId="+e.get("id")),b=e.get("id")):(a=i.getCompanyGroupName(f.getCurrentNetwork()),b="company",j||(c=i.getCompanyGroupUrl(f.getCurrentNetwork()))),j){var k=h.findById(this._thread.network_id);a=d.t("group_at_network",{group:a,network:k.getPlainBody()})}return{groupFullName:a,groupResourceId:b}},render:function(){return e.trigger("/ui/hovercard/build",this.$el,".yj-hovercard-link"),this}})}),define("stache!feeds/lib/ui/inbox/inbox_list_item_message_sender",["mustache"],function(a){var b="{{{link}}}";return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/inbox_list_item_message_sender",[],function(){}),define("feeds/lib/ui/inbox/inbox_list_item_message_sender",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","backbone","./inbox_list_item_user_link","./inbox_list_item_group_link","html!./inbox_list_item_message_sender","css!./inbox_list_item_message_sender"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/tr"),f=a("backbone"),g=a("./inbox_list_item_user_link"),h=a("./inbox_list_item_group_link"),i=a("html!./inbox_list_item_message_sender");return a("css!./inbox_list_item_message_sender"),b.extend({mixins:[c,d],template:i,className:"yj-inbox-list-item--message-sender",initialize:function(){this._user=this.options.user,this._thread=this.options.thread},getTemplateData:function(){var a=new g({user:this._user}),b=new h({thread:this._thread});return{link:this._thread.direct_message?a.render().el.innerHTML:e.t("user_in_group",{user:a.render().el.innerHTML,group:b.render().el.innerHTML})}},render:function(){return f.trigger("/ui/hovercard/build",this.$el,".yj-hovercard-link"),this}})}),define("stache!feeds/lib/ui/inbox/inbox_list_item_message",["mustache"],function(a){var b="{{{firstMessageText}}}";return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/inbox_list_item_message",[],function(){}),define("feeds/lib/ui/inbox/inbox_list_item_message",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","core/lib/util/emoji_helper","feeds/lib/helper/i18n_helper","html!./inbox_list_item_message","css!./inbox_list_item_message"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g=a("core/lib/util/emoji_helper"),h=a("feeds/lib/helper/i18n_helper"),i=a("html!./inbox_list_item_message");return a("css!./inbox_list_item_message"),c.extend({mixins:[d,e],template:i,className:"yj-inbox-list-item--message-text",initialize:function(){this._thread=this.options.thread,this._searchTerm=this.options.searchTerm,this._replies=this.options.replies},getTemplateData:function(){return{firstMessageText:"announcement"===this._thread.message_type?g.parse(b.escape(this._thread.title)):g.parse(this._getMessageText(this._thread)),hasReplies:this._replies}},render:function(){return h.addDirectionSupportToElement(this.$el,this._thread.getTextDirection()),this},_getMessageText:function(a){if(a.isThreadStarter()&&this._searchTerm)return this._truncateSnippetHighlight(a.getHighlightedPlainBodyWithoutCCs(),50);var c=a.getPlainBodyWithoutCCs();return c?b.escape(c):this._getAttachmentsDescription(a)},_truncateSnippetHighlight:function(a,b){var c=a.replace(/[\u200B]/g,"").search(/<em>/i);return b>=c?a:"... "+a.slice(c-b)},_getAttachmentsDescription:function(a){var c=a.hasAttachmentOfType("praise"),d=a.hasAttachmentOfType("ymodule");if(c)return b.escape(c.comment);if(d)return b.escape(d.name);var e,g=a.getAttachments();return 1===g.length?e="message"===g[0].type?f.t("share_attached"):g[0].name:g.length>1&&(e=f.t("count_attachments",{count:g.length.toString()})),e?'<span class="yj-message-text-attachment">'+b.escape(e)+"</span>":void 0}})}),define("stache!feeds/lib/ui/inbox/inbox_list_item_replies",["mustache"],function(a){var b='{{#showExpiringTimestamp}}\n  <div class="yj-inbox-list-item--reply-metadata">\n    {{#showAttachmentsIndicator}}\n      <span class="yamicon yamicon-paperclip yamicon-inline">\n        <span class="yj-acc-hidden">{{attachmentsIndicatorAltText}}</span>\n      </span>\n    {{/showAttachmentsIndicator}}\n    <span class="yamicon yamicon yamicon-rd_expire"></span>\n    {{#timeStamp}}<a class="yj-reply-info" href="{{threadUrl}}">{{timeStamp}}</a>{{/timeStamp}}\n  </div>\n{{/showExpiringTimestamp}}\n{{^showExpiringTimestamp}}\n  <div class="yj-inbox-list-item--reply-metadata">\n    {{#showAttachmentsIndicator}}\n      <span class="yamicon yamicon-paperclip yamicon-inline">\n        <span class="yj-acc-hidden">{{attachmentsIndicatorAltText}}</span>\n      </span>\n    {{/showAttachmentsIndicator}}\n    {{#timeStamp}}<a class="yj-reply-info" href="{{threadUrl}}">{{timeStamp}}</a>{{/timeStamp}}\n  </div>\n{{/showExpiringTimestamp}}\n<span class="yj-reply-blurb" {{#textDirection}} dir="{{textDirection}}" {{/textDirection}}>\n  <span class="yamicon yamicon-rd_reply">\n    <span class="yj-acc-hidden">{{replyIndicatorAltText}}</span>\n  </span>\n  <UserLinkView key="reply_user_link_view"/>:\n  <span class="yj-reply-blurb-text">{{{blurb}}}</span>\n</span>\n';
return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/inbox_list_item_replies",[],function(){}),define("feeds/lib/ui/inbox/inbox_list_item_replies",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/date_helper","core/lib/tr","core/lib/util/emoji_helper","core/lib/yammer_uri","common-ui/lib/ui/shared/tooltip","./inbox_list_item_user_link","html!./inbox_list_item_replies","css!./inbox_list_item_replies"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/date_helper"),g=a("core/lib/tr"),h=a("core/lib/util/emoji_helper"),i=a("core/lib/yammer_uri"),j=a("common-ui/lib/ui/shared/tooltip"),k=a("./inbox_list_item_user_link"),l=a("html!./inbox_list_item_replies");return a("css!./inbox_list_item_replies"),c.extend({mixins:[d,e],template:l,className:"yj-inbox-list-item--reply",views:{UserLinkView:"_getUserLinkView"},initialize:function(){this._thread=this.options.thread,this._reply=this.options.reply,this._showExpiringTimestamp=this.options.showExpiringTimestamp,this._showAttachmentsIndicator=this.options.showAttachmentsIndicator},getTemplateData:function(){return{blurb:this._getMessageText(this._reply),showExpiringTimestamp:this._showExpiringTimestamp,timeStamp:this._getTimestamp(this._reply),showAttachmentsIndicator:this._showAttachmentsIndicator,attachmentsIndicatorAltText:g.t("has_attachments"),replyIndicatorAltText:g.t("last_reply"),threadUrl:this._getThreadUrl()}},_getThreadUrl:function(){var a="/#/Threads/show?threadId="+this._thread.id;return i.app(a)},render:function(){return this._showExpiringTimestamp&&this._addExpiringTimestampTooltip(),this},_getMessageText:function(a){var c=a.getPlainBodyWithoutCCs();return c?h.parse(b.escape(c)):this._getAttachmentsDescription(a)},_getUserLinkView:function(){return new k({user:this._reply.findSender(),nameTruncationLimit:18})},_getTimestamp:function(a){return f.formatAgoForInboxPreviews(new Date(a.getTime()))},_getAttachmentsDescription:function(a){var c=a.hasAttachmentOfType("praise"),d=a.hasAttachmentOfType("ymodule");if(c)return b.escape(c.comment);if(d)return b.escape(d.name);var e,f=a.getAttachments();return 1===f.length?e="message"===f[0].type?g.t("share_attached"):f[0].name:f.length>1&&(e=g.t("count_attachments",{count:f.length.toString()})),e?'<span class="yj-message-text-attachment">'+b.escape(e)+"</span>":void 0},_addExpiringTimestampTooltip:function(){var a=this.$el.find(".yamicon-rd_expire"),b=g.t("announcement_expiration_timestamp_tooltip",{count:this.options.expiration});j.addTooltip(a,b)}})}),define("stache!feeds/lib/ui/inbox/inbox_list_item_snippet_item",["mustache"],function(a){var b='<div class="yj-snippet">\n  <span class="yj-snippet-blurb" {{#textDirection}}dir="{{textDirection}}{{/textDirection}}">\n    <span class="yj-inbox-list-item-snippet--icon yamicon yamicon-rd_reply">\n      <span class="yj-acc-hidden">{{replyIndicatorAltText}}</span>\n    </span>\n    <UserLinkView key="snippet_user_link_view"/>: {{{blurb}}}\n  </span>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/inbox/inbox_list_item_snippet_item",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/util/emoji_helper","core/lib/tr","./inbox_list_item_user_link","html!./inbox_list_item_snippet_item"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/util/emoji_helper"),f=a("core/lib/tr"),g=a("./inbox_list_item_user_link"),h=a("html!./inbox_list_item_snippet_item");return b.extend({mixins:[c,d],template:h,views:{UserLinkView:"_getUserLinkView"},initialize:function(){this._snippet=this.options.model},getTemplateData:function(){var a=this._truncateSnippetHighlight(this._snippet.getPlainBody(),50);return{blurb:e.parse(a),textDirection:this._snippet.getTextDirection(),replyIndicatorAltText:f.t("last_reply")}},_truncateSnippetHighlight:function(a,b){var c=a.replace(/[\u200B]/g,"").search(/<em>/i);return b>=c?a:"... "+a.slice(c-b)},_getUserLinkView:function(){return new g({user:this._snippet.findSender(),nameTruncationLimit:18})}})}),define("css!feeds/lib/ui/inbox/inbox_list_item_snippets",[],function(){}),define("feeds/lib/ui/inbox/inbox_list_item_snippets",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","./inbox_list_item_snippet_item","css!./inbox_list_item_snippets"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("./inbox_list_item_snippet_item");return a("css!./inbox_list_item_snippets"),c.extend({mixins:[d,e],initialize:function(){this._snippets=this.options.snippets,b.each(this._snippets,function(a){this.add(new f({model:a}))},this)}})}),define("css!components/inbox_read_state_button/src/inbox_read_state_button",[],function(){}),define("stache!components/inbox_read_state_button/src/inbox_read_state_button",["mustache"],function(a){var b='<button class="yj-inbox-read-state-button--toggle" data-speechtip data-qaid="inbox_read_state_button">\n  <span class="yamicon {{^isRead}}yamicon-rd_checkmark{{/isRead}}{{#isRead}}yamicon-rd_checkmark_empty{{/isRead}}">\n    <span class="yj-acc-hidden">{{readStateToggleTooltip}}</span>\n  </span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/inbox_read_state_button/src/inbox_read_state_button",["require","models/lib/events","core/lib/tr","backbone","common-ui/lib/ui/shared/tooltip","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","css!./inbox_read_state_button","html!./inbox_read_state_button"],function(a){"use strict";var b=a("models/lib/events"),c=a("core/lib/tr"),d=a("backbone"),e=a("common-ui/lib/ui/shared/tooltip"),f=a("core/lib/backbone_base_view"),g=a("core/lib/backbone_with_auto_render");return a("css!./inbox_read_state_button"),f.extend({mixins:[g],className:"yj-inbox-read-state-button",template:a("html!./inbox_read_state_button"),attributes:{"aria-hidden":"false"},events:{click:"_toggleReadState"},initialize:function(){this._thread=this.options.thread,this.listenTo(b,"Thread/"+this._thread.id+"/update",this.render)},isRead:function(){return this._thread.isSeen()},getTemplateData:function(){var a=this._getReadStateTooltipOptions();return{isRead:this.isRead(),readStateToggleTooltip:a.text}},addTooltips:function(){this.removeTooltips();var a=this._getReadStateTooltipOptions();e.addTooltip(this.$el,a.text,a)},removeTooltips:function(){e.hideAndRemoveTooltip(this.$el)},render:function(){return this.addTooltips(),this},remove:function(){return this.removeTooltips(),f.prototype.remove.call(this)},_toggleReadState:function(){var a=this._thread,b={read:{action:"markAsUnread",log_source:"inbox_mark_as_unread_button",successMessage:c.t("the_conversation_has_been_marked_as_unread"),errorMessage:c.t("there_was_an_error_marking_the_conversation_as_unread")},unread:{action:"markAsRead",log_source:"inbox_mark_as_read_button",successMessage:c.t("the_conversation_has_been_marked_as_read"),errorMessage:c.t("there_was_an_error_marking_the_conversation_as_read")}},e=b[this.isRead()?"read":"unread"];this.trigger(e.action),a[e.action]({log_data:{source:e.log_source},success:function(){d.trigger("/ui/inbox/"+e.action,a.id)},error:function(){d.trigger("/ui/alert/show","error",e.errorMessage)}})},_getReadStateTooltipOptions:function(){return{text:this.isRead()?c.t("mark_conversation_as_unread"):c.t("mark_conversation_as_read"),orientation:"left",delay:700}}})}),define("components/inbox_read_state_button/index",["require","./src/inbox_read_state_button"],function(a){"use strict";return a("./src/inbox_read_state_button")}),define("stache!feeds/lib/ui/inbox/inbox_list_item",["mustache"],function(a){var b='<InboxListItemHeader key="inbox_list_item_header"/>\n\n<div class="yj-inbox-list-item--message-container yk-clearfix">\n  {{#showMessageInfo}}\n    {{^repliesFragment}}\n      {{#showExpiringTimestamp}}\n        <div class="yj-inbox-list-item--message-metadata">\n          <span class="yj-inbox-list-item--expire-icon yamicon yamicon yamicon-rd_expire"></span>\n          <a class="yj-message-info" href="{{threadUrl}}">{{timestamp}}</a>\n        </div>\n      {{/showExpiringTimestamp}}\n      {{^showExpiringTimestamp}}\n        <a class="yj-message-info" href="{{threadUrl}}">{{timestamp}}</a>\n      {{/showExpiringTimestamp}}\n    {{/repliesFragment}}\n  {{/showMessageInfo}}\n  <div class="yj-inbox-list-item--message">\n    <InboxListItemAvatar key="inbox_list_item_avatar"/>\n    <InboxListItemMessageSender key="inbox_list_item_message_sender"/>\n    <InboxListItemMessage key="inbox_list_item_message"/>\n  </div>\n</div>\n\n{{#repliesFragment}}\n  <div class="yj-inbox-list-item--reply-container">\n    <InboxListItemReplies key="inbox_list_item_replies"/>\n  </div>\n{{/repliesFragment}}\n\n{{#snippetsFragment}}\n  <div class="yj-inbox-list-item--search-snippets">{{! Search terms highlighting }}\n    <InboxListItemSearchSnippet key="inbox_list_item_search_snippets"/>\n  </div>\n{{/snippetsFragment}}\n<span class="yj-message--trailing-expiration-metadata yj-acc-hidden"></span>\n\n<InboxReadStateButton key="inbox_read_state_button" />\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/inbox_list_item",[],function(){}),define("feeds/lib/ui/inbox/inbox_list_item",["require","models/lib/events","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/session","core/lib/date_helper","core/lib/yammer_uri","core/lib/location_helper","backbone","core/lib/tr","common-ui/lib/helper/ui","common-ui/lib/ui/keyboard/navigable_element_adaptor","models/snippet","common-ui/lib/ui/shared/tooltip","collections/banners","common-ui/lib/ui/accessibility/accessibility_util","./inbox_list_item_header","./inbox_list_item_avatar","./inbox_list_item_message_sender","./inbox_list_item_message","./inbox_list_item_replies","./inbox_list_item_snippets","components/inbox_read_state_button/index","html!./inbox_list_item","css!./inbox_list_item"],function(a){"use strict";var b=a("models/lib/events"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("core/lib/session"),h=a("core/lib/date_helper"),i=a("core/lib/yammer_uri"),j=a("core/lib/location_helper"),k=a("backbone"),l=a("core/lib/tr"),m=a("common-ui/lib/helper/ui"),n=a("common-ui/lib/ui/keyboard/navigable_element_adaptor"),o=a("models/snippet"),p=a("common-ui/lib/ui/shared/tooltip"),q=a("collections/banners"),r=a("common-ui/lib/ui/accessibility/accessibility_util"),s=a("./inbox_list_item_header"),t=a("./inbox_list_item_avatar"),u=a("./inbox_list_item_message_sender"),v=a("./inbox_list_item_message"),w=a("./inbox_list_item_replies"),x=a("./inbox_list_item_snippets"),y=a("components/inbox_read_state_button/index"),z=a("html!./inbox_list_item");return a("css!./inbox_list_item"),d.extend({mixins:[e,f],tagName:"li",className:"yj-inbox-list-item yj-clearfix yj-want-focuswithin",template:z,views:{InboxListItemHeader:"_getInboxListItemHeader",InboxListItemAvatar:"_getInboxListItemAvatar",InboxListItemMessageSender:"_getInboxListItemMessageSender",InboxListItemMessage:"_getInboxListItemMessage",InboxListItemReplies:"_getInboxListItemReplies",InboxListItemSearchSnippet:"_getInboxListItemSearchSnippet",InboxReadStateButton:"_getInboxReadStateButton"},events:{click:"_goToThreadView"},initialize:function(){this._thread=this.options.thread,this._searchTerm=this.options.searchTerm,this._isFirstUnreadAnnouncement=this.options.isFirstUnreadAnnouncement,this._expiringAnnouncements=this.options.expiringAnnouncements,this._lastReply=this._getLastReply(),this._hasReplies=!!this._lastReply,this.data=this.options.thread,this.$element=this.$el,this.options.navigator&&(this.navigableElementAdaptor=new n({navigator:this.options.navigator,model:this._thread,rootElement:this.$el,focusTarget:".yj-acc-placeholder"})),this.listenTo(b,"Thread/"+this._thread.id+"/update",this.updateInPlace)},showAttachmentsIndicator:function(a){return this._thread.has_attachments&&!(a.hasAttachmentOfType("praise")||a.hasAttachmentOfType("ymodule"))},getTemplateData:function(){var a=this._thread.getThreadStarter();return{showMessageInfo:this.showAttachmentsIndicator(a)||this._getTimestamp(a),showExpiringTimestamp:this._shouldShowExpiringTimestamp(a)&&!this._hasReplies,threadUrl:this._getThreadUrl(),timestamp:this._getTimestamp(a),repliesFragment:this._hasReplies&&!this._searchTerm,snippetsFragment:this._searchTerm&&this._getSortedSnippets().length>0,isRead:this.isRead(),readStateToggleTooltip:this.isRead()?l.t("mark_conversation_as_unread"):l.t("mark_conversation_as_read")}},updateReadState:function(){var a=this.isRead();this.$el.toggleClass("yj-read-item",a),this.$el.toggleClass("yj-unread-item",!a)},addTooltips:function(){var a=this._thread.getThreadStarter();this._shouldShowExpiringTimestamp(a)&&!this._hasReplies&&this._addExpiringTimestampTooltip(a)},removeTooltips:function(){var a=this.$(".yj-inbox-list-item--expire-icon");p.hideAndRemoveTooltip(a)},updateInPlace:function(){this.removeTooltips(),this.render()},render:function(){return this.updateReadState(),this.addTooltips(),this._addAccessibilitySupport(),this},isRead:function(){return this._thread.isSeen()},addReply:function(){this.options.unreadCount+=1,this.render()},handleMuteThread:function(){},remove:function(){return this.removeTooltips(),o.clearByThreadId(this._thread.id),this.navigableElementAdaptor&&this.navigableElementAdaptor.stop(),d.prototype.remove.call(this)},_getLastReply:function(){return c.last(this._thread.getReplies())},_getInboxReadStateButton:function(){var a=new y({thread:this._thread});return this.listenTo(a,"all",this.trigger),a},_getInboxListItemHeader:function(){return new s({thread:this._thread,isRead:this.isRead(),unreadCount:this.options.unreadCount,shouldShowAnnouncementsBanner:this._shouldShowAnnouncementsBanner(this._thread.getThreadStarter())})},_getInboxListItemAvatar:function(){return new t({thread:this._thread,user:this._thread.getThreadStarter().findSender(),dimensions:48})},_getInboxListItemMessageSender:function(){return new u({thread:this._thread,user:this._thread.getThreadStarter().findSender()})},_getInboxListItemMessage:function(){return new v({thread:this._thread.getThreadStarter(),searchTerm:this._searchTerm})},_getInboxListItemReplies:function(){var a=this._thread.getThreadStarter(),b=this.showAttachmentsIndicator(a);return new w({thread:this._thread,reply:this._lastReply,expiration:this._getExpiringTimestamp(this._thread.getThreadStarter()),isRead:this.isRead(),showExpiringTimestamp:this._shouldShowExpiringTimestamp(a)&&this._hasReplies,showAttachmentsIndicator:b})},_getInboxListItemSearchSnippet:function(){return new x({snippets:this._getSortedSnippets(),searchTerm:this._searchTerm})},_getThreadUrl:function(){var a="/#/Threads/show?threadId="+this._thread.id,b={search:this._searchTerm};return this._searchTerm?i.app(a,b):i.app(a)},_getTimestamp:function(a){return h.formatAgoForInboxPreviews(new Date(a.getTime()))},_getExpiringTimestamp:function(a){var b=new Date(a.created_at),c=Math.ceil((b.getTime()+864e6-Date.now())/864e5);return c},_getSortedSnippets:function(){return c.sortBy(this._thread.getSnippets(),function(a){return a.id})},_goToThreadView:function(a){this._isReadToggleEvent(a)?a.preventDefault():m.isTextSelected()||j.assign(this._getThreadUrl())},_toggleReadState:function(){var a=this._thread;this.isRead()?a.markAsUnread({success:function(){k.trigger("/ui/inbox/markAsUnread",a.id),k.trigger("/ui/alert/show","notice",l.t("the_conversation_has_been_marked_as_unread"))},error:function(){k.trigger("/ui/alert/show","error",l.t("there_was_an_error_marking_the_conversation_as_unread"))}}):a.markAsRead({success:function(){k.trigger("/ui/inbox/markAsRead",a.id),k.trigger("/ui/alert/show","notice",l.t("the_conversation_has_been_marked_as_read"))},error:function(){k.trigger("/ui/alert/show","error",l.t("there_was_an_error_marking_the_conversation_as_read"))}})},_isReadToggleEvent:function(a){var b=$(a.target),c=".yj-inbox-read-state-button--toggle",d=$(c),e=b.closest(c,d).length>0;return e},_addAccessibilitySupport:function(){c.defer(c.bind(this._deferredAddAccessibilitySupport,this))},_deferredAddAccessibilitySupport:function(){this.$("a").prop("tabindex","-1"),this.$(".yj-expiring-announcements-banner a").prop("tabindex","0"),this.$el.children().attr("aria-hidden",!1),this.$(".yj-inbox-list-item--message-header").attr("aria-hidden",!1);var a=r.extractTextExcluding(this.$el[0],"[aria-hidden=true], .yj-inbox-read-state-button, .yj-expiring-announcements-banner");a=a.trim().replace(/\s+/g," "),this.$el.children().attr("aria-hidden",!0),this.$(".yj-inbox-read-state-button").attr("aria-hidden",!1),this.$(".yj-message-header--banner").attr("aria-hidden",!1).parent().attr("aria-hidden",!1),this.$(".yj-inbox-list-item--message-header").attr("aria-hidden",!0);var b=$("<a href='javascript://' class='yj-acc-placeholder'><span class='yj-acc-hidden'></span></a>");b.find(".yj-acc-hidden").text(a);var c=this.$(".yj-message-header--banner");c[0]?b.insertAfter(c):b.prependTo(this.$el)},_shouldShowAnnouncementsBanner:function(){var a="expiring-announcements",b=10;return this._expiringAnnouncements&&this._isFirstUnreadAnnouncement&&!this._hasOptedOutOfBanner(a)&&!this._isNewUser(b)},_shouldShowExpiringTimestamp:function(a){var b="announcement"===a.message_type&&this._getExpiringTimestamp(a)>=0;return this._expiringAnnouncements&&b&&!this.isRead()},_addExpiringTimestampTooltip:function(a){var b=this.$(".yj-inbox-list-item--expire-icon"),c=l.t("announcement_expiration_timestamp_tooltip",{count:this._getExpiringTimestamp(a)});p.addTooltip(b,c),this.$(".yj-message--trailing-expiration-metadata").text(c)},_hasOptedOutOfBanner:function(a){return q.isOptedOut(a)},_isNewUser:function(a){return this._daysSinceActivation()<=a},_daysSinceActivation:function(){var a=g.getCurrentUser(),b=new Date(a.activated_at);return Math.ceil((Date.now()-b.getTime())/864e5)}})}),define("feeds/lib/ui/feeds/spinner",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","html!./spinner","css!./spinner"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/tr"),f=a("html!./spinner");a("css!./spinner");var g=3e4;return c.extend({mixins:[d],className:"yj-spinner-loading-container",template:f,defaults:{dontListen:!1,text:e.t("loading")},events:{"click .yj-reload-page-notice a":"_onReloadClick"},initialize:function(){this.errorTimeout=null,b.bindAll(this,"handleMessagesProcessed","handleEmptyFeedArrived","_drawErrorState","_onReloadClick"),this._observeEvents(),this.show()},getTemplateData:function(){return this.options},render:function(){return this.$el.removeAttr("id"),this},reset:function(){this.$el&&this.render()},_observeEvents:function(){this.options.dontListen||(this.listenTo(this.options.mediator,"messagesProcessed",this.handleMessagesProcessed),this.listenTo(this.options.mediator,"beforeListRender",this.handleMessagesProcessed),this.listenTo(this.options.mediator,"emptyFeedArrived",this.handleEmptyFeedArrived))},handleMessagesProcessed:function(){this.hide()},handleEmptyFeedArrived:function(){this.hide()},show:function(){this.reset(),this.$el.show(),this.startErrorTimeout()},forceError:function(){this.reset(),this.$el.show(),this._drawErrorState(),this.clearErrorTimeout()},startErrorTimeout:function(){this.errorTimeout=window.setTimeout(this._drawErrorState,g)},clearErrorTimeout:function(){this.errorTimeout&&window.clearTimeout(this.errorTimeout),this.errorTimeout=null},_drawErrorState:function(){var a='<div class="yj-reload-page-notice yj-message-list-notice"> <a href="#">'+e.t("click_here_to_reload")+"</a>. "+e.t("if_the_issue_persists_please_contact_support")+"</div>";this.$el.html(a)},_onReloadClick:function(a){a.preventDefault(),window.location.reload()},hide:function(){this.$el.hide(),this.clearErrorTimeout()}})}),define("css!components/icon_banner/src/icon_banner",[],function(){}),define("stache!components/icon_banner/src/icon_banner",["mustache"],function(a){var b='{{{svgIcon}}}\n<header role="banner">\n  <h2 class="yj-icon-banner--header">{{headerLabel}}</h2>\n  {{#subheaderLabel}}\n    <p class="yj-icon-banner--subheader">{{subheaderLabel}}</p>\n  {{/subheaderLabel}}\n</header>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/icon_banner/src/icon_banner",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/helper/svg_icon","css!./icon_banner","html!./icon_banner"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("common-ui/lib/helper/svg_icon");return a("css!./icon_banner"),c.extend({tagName:"a",mixins:[d],className:"yj-icon-banner",template:a("html!./icon_banner"),getTemplateData:function(){return{svgIcon:this._getSvgIcon(),headerLabel:this.options.headerLabel,subheaderLabel:this.options.subheaderLabel}},updateData:function(a){this.options=b.extend(this.options,a),this.render()},render:function(){this.options.href&&this.$el.attr("href",this.options.href),this.$el.toggleClass("has-link",!!this.options.href)},_getSvgIcon:function(){return this.options.iconName?e(this.options.iconName,{width:60,height:60}):this.options.iconHtml?this.options.iconHtml:""}})}),define("components/icon_banner/index",["require","./src/icon_banner"],function(a){"use strict";return a("./src/icon_banner")}),define("css!components/inbox_empty_notice/src/inbox_empty_notice",[],function(){}),define("stache!components/inbox_empty_notice/src/inbox_empty_notice",["mustache"],function(a){var b='<IconBanner key="icon-banner">\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/inbox_empty_notice/src/inbox_empty_notice",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/yammer_uri","core/lib/tr","core/lib/treatment","models/lib/model/helper/report_feed_events","models/helpers/group","models/lib/model/helper/top_groups","components/icon_banner/index","core/lib/urls","css!./inbox_empty_notice","html!./inbox_empty_notice"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/yammer_uri"),f=a("core/lib/tr"),g=a("core/lib/treatment"),h=a("models/lib/model/helper/report_feed_events"),i=a("models/helpers/group"),j=a("models/lib/model/helper/top_groups"),k=a("components/icon_banner/index"),l=a("core/lib/urls");return a("css!./inbox_empty_notice"),b.extend({className:"yj-inbox-empty-notice",mixins:[c,d],template:a("html!./inbox_empty_notice"),views:{IconBanner:"_getIconBanner"},events:{click:"_logClick"},initialize:function(){this._nextGroup=this._getNextGroup()},render:function(){this.banner&&this.banner.updateData({href:this._getLink()})},_logClick:function(){var a={link_type:"inbox_unread_empty_cta",feed_type:"discovery_feed"};if(this._nextGroup){var b=this._nextGroup.get("id"),c=i.isAllCompany(this._nextGroup);a.is_joined_group=!0,a.feed_type=c?"general":"group",a.unviewed_thread_count=j.getUnviewedCountForGroup(b),c||(a.feed_id=b)}h.reportFeedEvent("feed_link_click",this.model.getLogSource(),this.model.getGroupId(),a)},_getNextGroup:function(){return j.getNextGroupFromInbox()},_getLink:function(){var a=e.app("/#/home");return this._nextGroup&&(a=l.groupIndex(this._nextGroup)),a},_getIconBannerData:function(){var a=g.usePriorityCopy(),b={iconName:"checkmark",href:this._getLink(),headerLabel:a?f.t("youve_caught_up_on_all_your_priority_conversations"):f.t("youve_read_everything_in_your_inbox"),subheaderLabel:a?f.t("discover_more_from_across_your_company"):f.t("see_more_conversations_from_across_your_company")};return this._nextGroup&&(b.subheaderLabel=f.t("see_what_else_is_new_in_your_groups")),b},_getIconBanner:function(){return this.banner=new k(this._getIconBannerData()),this.banner}})}),define("components/inbox_empty_notice/index",["require","./src/inbox_empty_notice"],function(a){"use strict";return a("./src/inbox_empty_notice")}),define("models/mobile_feed_ad",["require","underscore","models/yammer_model","models/user","core/lib/session","core/lib/adapters/store_adapter","core/lib/yammer_request","core/lib/yammer_uri","models/helpers/user"],function(a){var b=a("underscore"),c=a("models/yammer_model"),d=a("models/user"),e=a("core/lib/session"),f=a("core/lib/adapters/store_adapter"),g=a("core/lib/yammer_request"),h=a("core/lib/yammer_uri"),i=a("models/helpers/user"),j="yj-mobile-ad-v2",k=21,l=3;return c.extend({defaults:{placementIndex:1.1},url:function(){return h.api("mobile/rankings")},authType:"oauth2",initialize:function(){b.bindAll(this,"_handleSendEmailSuccess","_handleSendEmailError")},parse:function(a){var b={},c=a.users_with_mobile;return b.users=(c||[]).map(d.save.bind(d)),b},shouldFetch:function(){var a=e.getCurrentUser();return!(i.usesMobile(a)||this._isNewUser()||i.hasFakeEmail(a)||this._wasClosed()||this._exceedsShowCount()||this._alreadyRequested())},incrementShowCount:function(){var a=this._getLocalStorageSettings().showCount+1;this._setLocalStorageSetting({showCount:a})},setClosed:function(){this._setLocalStorageSetting({closed:!0})},setRequested:function(){this._setLocalStorageSetting({requested:!0})},sendEmail:function(){g.send({method:"POST",dataType:"json",url:"yammer_mobile_promote",success:this._handleSendEmailSuccess,error:this._handleSendEmailError})},_handleSendEmailSuccess:function(){this.setRequested(),this.trigger("email-sent")},_handleSendEmailError:function(a){this.trigger("email-error",a)},_getLocalStorageSettings:function(){var a={closed:!1,showCount:0,requested:!1},b=f.get(j)||a;return b},_setLocalStorageSetting:function(a){var c=this._getLocalStorageSettings(),d=b.extend(c,a);f.set(j,d)},_isNewUser:function(){return this._daysSinceActivation()<=k},_daysSinceActivation:function(){var a=e.getCurrentUser(),b=new Date(a.activated_at);return Math.ceil((Date.now()-b.getTime())/864e5)},_wasClosed:function(){return this._getLocalStorageSettings().closed},_exceedsShowCount:function(){return this._getLocalStorageSettings().showCount>=l},_alreadyRequested:function(){return this._getLocalStorageSettings().requested}})}),define("feeds/lib/ui/threads/future/feed_delegate",["require","underscore","backbone","models/activity","models/mobile_feed_ad","core/lib/ctor","models/lib/helper/inbox_manager","models/helpers/feed","models/lib/events"],function(a){"use strict";var b=a("underscore"),c=a("backbone"),d=a("models/activity"),e=a("models/mobile_feed_ad"),f=a("core/lib/ctor"),g=a("models/lib/helper/inbox_manager"),h=a("models/helpers/feed"),i=a("models/lib/events"),j=f(null,{init:function(a){var c=a.feed,d=a.connectionOptions||{},e={startClient:!0};b.extend(e,d),b.bindAll(this,"_onThreadDestroy","_onAfterProcess","_onMessageCreate"),this.listenTo(i,"ThreadFeedDelivery/"+c.id+"/destroy",this._onThreadDestroy),this.listenTo(c,"onAfterProcess markUnseen",this._onAfterProcess),this.listenTo(c,"onFullMessageCreate",this._onMessageCreate),this._feed=c,this._indexedModels=[],this._lastSeenId=0,this._isLoading=!this._feed.hasFirstPayload(),this._comparator=this._comparator.bind(this)},add:function(a){this._insertModel(a),this.trigger("update")},cleanup:function(){this.getFeed().pruneUsingContentFilter(),this._pruneThreads(),this.stopListening(),this.off()},getFeed:function(){return this._feed},shouldFetch:function(){return!this._feed.hasFirstPayload()||h.shouldReloadFeed(this._feed)},fetch:function(a){this.shouldFetch()?(this.once("sync",this.trigger.bind(this,"reset"),this),this._feed.fetch().then(this._feed.connectToRealtime.bind(this._feed),this._onDataError.bind(this))):a.reset&&(this._updateModelIndexes(),a.reset&&this.trigger("reset",this))},fetchOlderThreads:function(a){this._feed.fetchOlder(a?a.limit:void 0)},hasOlderItems:function(){return this._feed.hasOlderAvailable()},isLoading:function(){return this._isLoading},getThreads:function(){return b.where(this._indexedModels,{type:"thread"})},getThreadModel:function(a){return b.findWhere(this._indexedModels,{type:"thread",id:a})},getThreadLatestReplyId:function(a){a=parseInt(a,10);var b=this.getThreadModel(a);return b?b.getLatestReplyId():0},getActivities:function(){return b.filter(this._indexedModels,function(a){return a instanceof d})},getModelIndex:function(a){return b.indexOf(this._indexedModels,a)},indexForThreadId:function(a){var b=this.getThreadModel(a);return b?this.getModelIndex(b):-1},getLastSeenModelIndex:function(a){var c=-1,d=b.filter(this._indexedModels,function(b){return b.getLatestReplyId&&a<b.getLatestReplyId()});if(d.length){var e=d[d.length-1];c=b.indexOf(this._indexedModels,e)+1}return c},getLastSeenMessageId:function(){return this._feed.getLocalLastSeenMessageId()},getUnseenCount:function(){return this._feed.getUnseenCount()},getOlderUnseenCount:function(){return this._feed.getOlderUnseenCount()},moveCursor:function(a){var b=this._feed.getLocalLastSeenMessageId();(a||b<this._lastSeenId)&&(this._feed.setLocalLastSeenMessageId(this._lastSeenId),this._feed.pushCursor(a))},markAllAsViewed:function(){this.moveCursor(!0)},setThreadAsSeen:function(a){var b=a.stats.latest_reply_id;this._lastSeenId=Math.max(this._lastSeenId,b)},_onMessageCreate:function(a){this.trigger("add:message",a)},_pruneThreads:function(){if(!this._feed.hasKeyType("algo")){var a=8,b=a;this._feed.isInbox()&&(b=g.MAX_THREADS),this._feed.pruneThreads(b)}},_onThreadDestroy:function(a){this._destroyItem(a)},_destroyItem:function(a){var c=b.findWhere(this._indexedModels,{id:a.id,type:a.type}),d=a.muted?"mute:":"remove:";if(c){var e=b.indexOf(this._indexedModels,c);this._indexedModels.splice(e,1),this.trigger(d+a.type,c)}this.trigger("update")},_comparator:function(a){return a instanceof e?a.get("placementIndex"):this._feed.getOrder(a)},_triggerAdd:function(a){a.type?this.trigger("add:"+a.type,a):a instanceof d?this.trigger("add:activity",a):a instanceof e&&this.trigger("add:mobile-ad",a)},_insertModel:function(a){var c=!0,d=b.indexOf(this._indexedModels,a);-1!==d&&(c=!1,this._indexedModels.splice(d,1)),d=b.sortedIndex(this._indexedModels,a,this._comparator),this._indexedModels.splice(d,0,a),c&&this._triggerAdd(a)},_insertModels:function(a){b.each(a,this._insertModel,this)},_updateModelIndexes:function(){var a=this._feed.getThreads();this._insertModels(a),this.trigger("sync",this)},_onDataError:function(){this._isLoading=!1,this.trigger("error",this)},_onAfterProcess:function(){this._isLoading=!1,this._updateModelIndexes(),this.trigger("update")}});return b.extend(j.prototype,c.Events),j}),define("css!components/inbox_list/src/inbox_list",[],function(){}),define("stache!components/inbox_list/src/inbox_list",["mustache"],function(a){var b='<div class="yj-inbox-list--container">\n  <div class="yj-inbox-list--notices">\n    {{#isLoading}}\n      <SpinnerView key="spinner" />\n    {{/isLoading}}\n  </div>\n  <ul data-qaid="inbox-list-messages" class="yj-inbox-list--messages {{#isEmpty}}yj-empty{{/isEmpty}}">\n    {{#threads}}\n      <InboxListItemPreviewView key="{{latestReplyId}}" data-thread-id="{{id}}" />\n    {{/threads}}\n  </ul>\n  {{#hasOlderItems}}\n    <MoreButtonView key="more-button" />\n  {{/hasOlderItems}}\n  {{#isEmpty}}\n    <InboxEmptyNoticeView key="inbox-empty-notice" />\n  {{/isEmpty}}\n</div>\n';return a.parse(b),function(c){
return a.render(b,c)}}),define("components/inbox_list/src/inbox_list",["require","underscore","core/lib/tr","core/lib/treatment","core/lib/backbone_with_auto_render","core/lib/backbone_with_animations","core/lib/backbone_with_subviews","core/lib/backbone_base_view","feeds/lib/ui/inbox/inbox_list_item","common-ui/lib/ui/shared/more_button","feeds/lib/ui/feeds/spinner","components/inbox_empty_notice/index","models/lib/helper/inbox_manager","models/thread","feeds/lib/ui/threads/future/feed_delegate","core/lib/log","core/lib/report","css!./inbox_list","html!./inbox_list"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/treatment"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_animations"),g=a("core/lib/backbone_with_subviews"),h=a("core/lib/backbone_base_view"),i=a("feeds/lib/ui/inbox/inbox_list_item"),j=a("common-ui/lib/ui/shared/more_button"),k=a("feeds/lib/ui/feeds/spinner"),l=a("components/inbox_empty_notice/index"),m=a("models/lib/helper/inbox_manager"),n=a("models/thread"),o=a("feeds/lib/ui/threads/future/feed_delegate"),p=a("core/lib/log"),q=a("core/lib/report");a("css!./inbox_list");var r={READ:"read",UNREAD:"unread",ALL:"all",SEARCH:"search"};return h.extend({className:"yj-inbox-list",mixins:[e,g,f],animateMethod:"velocity",template:a("html!./inbox_list"),views:{InboxListItemPreviewView:"_getInboxListItemPreview",MoreButtonView:"_getMoreButton",InboxEmptyNoticeView:"_getInboxEmptyNoticeView",SpinnerView:"_getSpinner"},defaults:{view:r.READ},initialize:function(){if(this._feed=this.options.feed,this._delegate=this._instantiateFeedDelegate(),this._previousTopThread={},this._topThread={},this.listenToOnce(this._delegate,"sync reset",b.once(this._handleFirstLoad)),this.listenTo(this._delegate,"error",this._renderError),!d.treatment("tow_vnext_inbox_hydrant")&&!this._isAll()){var a=m.getAllFeed();a.hasFirstPayload()||a.fetch().then(a.connectToRealtime.bind(a))}},reset:function(){this._delegate.fetch({reset:!0})},isLoading:function(){return this._delegate.isLoading()},getTemplateData:function(){var a=this._getThreadIds();this._previousTopThread=this._topThread,this._topThread=a.length>0?a[0]:{};var b=a.length>0,c=this.isLoading(),d=!c&&this._delegate.hasOlderItems(),e=!c&&!b&&!d;return{threads:a,isLoading:c,hasOlderItems:d,isEmpty:e}},render:function(){return this.trigger("render"),this.moreButton&&this.moreButton.show(),this},remove:function(){return this._delegate.cleanup(),h.prototype.remove.call(this)},addNavigationCandidates:function(){var a=this.options.navigator.get("candidates"),b=this._getThreads(),c=a.concat(b);this.options.navigator.set("candidates",c)},_isUnread:function(){return this.options.view===r.UNREAD},_isAll:function(){return this.options.view===r.ALL},_instantiateFeedDelegate:function(){return this._delegate?this._delegate:new o({feed:this._feed,connectionOptions:this.options.connectionOptions})},_handleFirstLoad:function(){this.render(),this._hasFirstLoad=!0,this.listenTo(this._delegate,"reset update remove:thread mute:thread",this.render)},_fetchOlderThreads:function(a){this._delegate.fetchOlderThreads(a)},_checkBackfill:function(a){if(this._isUnread()){var c=this._delegate.hasOlderItems(),d=m.MAX_THREADS,e=d-this._getThreadIds().length;c&&e>0&&(a=b.isNumber(a)?a:e,this._fetchOlderThreads({limit:a}))}},_isThreadSenderDefined:b.memoize(function(a){var b=a.getThreadStarter(),c=b&&b.findSender();return c||this._reportThreadSenderUndefined(a),c},function(a){return a.id}),_reportThreadSenderUndefined:function(a){q.info({message:"inbox_list_item_thread_sender_undefined",thread_id:a.id,thread_starter_id:a.thread_starter_id,sender_id:a.sender_id}),p.warn("Can't render thread",a.id,"with missing sender",a.sender_id,"and thread starter id",a.thread_starter_id)},_shouldRenderThread:function(a){var b=a.getThreadStarter();if(!b)return q.info({message:"inbox_list_missing_thread_starter",thread_id:a.id,thread_starter_id:a.thread_starter_id}),!1;if(b.is_reference)return!1;if(!this._isThreadSenderDefined(a))return!1;if(this._isAll())return!0;var c=this._feed.isSeen(a);return c&&q.info({message:"unread_inbox_contains_read_thread",thread_id:a.id,unread_count:this._feed.getUnseenThreadCount()}),!c},_getThreads:function(){var a=this._delegate.getThreads();return b.filter(a,this._shouldRenderThread.bind(this))},_getThreadIds:function(){var a=this._getThreads();return b.map(a,function(a){return{id:a.id,latestReplyId:a.stats.latest_reply_id}})},_getFirstUnreadAnnouncement:function(a){var c=this._delegate.getThreads(),d=b.first(b.filter(c,function(a){var b=a.getThreadStarter();return"announcement"===b.message_type}));return this._isUnread()&&d&&a.id===d.id?!0:void 0},_getInboxListItemPreview:function(a,b){var c=parseInt(b("thread-id"),10),e=n.findById(c),f=new i({isAll:this._isAll(),thread:e,unreadCount:this._feed.getUnseenCountFor(e),isFirstUnreadAnnouncement:this._getFirstUnreadAnnouncement(e),navigator:this.options.navigator,expiringAnnouncements:d.treatment("prod_support_expiring_announcements_v2")}),g={duration:250,easing:"ease-out"};this._isUnread()&&this.listenTo(f,"markAsRead",function(){this.animate(f.el,"slideUp",g)});var h=this._hasFirstLoad&&this._isNewTopThread(e);return h&&this.animate(f.el,"slideUp",{duration:0}).animate(f.el,"slideDown",g),f},_isNewTopThread:function(a){var b=this._previousTopThread.id!==this._topThread.id,c=a.id===this._topThread.id;return b&&c},_getMoreButton:function(){return this.moreButton=new j({id:"moreButton",model:{labelText:c.t("more_2")},renderVisible:!0}),this.listenTo(this.moreButton,"click",this._fetchOlderThreads),this.moreButton},_getInboxEmptyNoticeView:function(){return new l({model:this._feed})},_getSpinner:function(){return this.spinner=new k({id:"spinner",dontListen:!0}),this.spinner},_renderError:function(){this.trigger("render"),this.spinner&&this.spinner.forceError()}},{ViewTypes:r})}),define("components/inbox_list/index",["require","./src/inbox_list"],function(a){"use strict";var b=a("./src/inbox_list");return b}),define("workfeed/lib/app/views/inbox/inbox_view_commands",["require","core/lib/backbone_base_class","common-ui/lib/ui/keyboard/keyboard_shortcuts"],function(a){var b=a("core/lib/backbone_base_class"),c=a("common-ui/lib/ui/keyboard/keyboard_shortcuts"),d={noNextItem:"No next item.",noPrevItem:"No previous item.",noItems:"No items."};return b.extend({initialize:function(){this.listenTo(c,"nav_next",this._navNextItem),this.listenTo(c,"nav_prev",this._navPrevItem)},stop:function(){this.stopListening()},_navNextItem:function(){this.options.navigator.navNext({errorStrings:d})},_navPrevItem:function(){this.options.navigator.navPrev({errorStrings:d})}})}),define("css!components/badge_count/src/badge_count",[],function(){}),define("stache!components/badge_count/src/badge_count",["mustache"],function(a){var b="{{count}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("components/badge_count/src/badge_count",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","css!./badge_count","html!./badge_count"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render");return a("css!./badge_count"),b.extend({mixins:[c],className:"yj-badge-count",template:a("html!./badge_count"),setCount:function(a){this.options.count=a,this.$el.text(this.getCount())},getCount:function(){return this.options.count>=0?this.options.count:0},getTemplateData:function(){return{count:this.getCount()}}})}),define("components/badge_count/index",["require","./src/badge_count"],function(a){"use strict";return a("./src/badge_count")}),define("stache!feeds/lib/ui/inbox/feed_title",["mustache"],function(a){var b='<h2 class="yj-inbox-feed-title header-content">{{feedName}}</h2>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/inbox/feed_title",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","core/lib/treatment","html!./feed_title"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("core/lib/treatment"),f=a("html!./feed_title");return b.extend({mixins:[c],template:f,getTemplateData:function(){return{feedName:e.usePriorityCopy()?d.t("priority_conversations"):d.t("inbox")}}})}),define("css!common-ui/lib/ui/shared/create_message_button",[],function(){}),define("stache!common-ui/lib/ui/shared/create_message_button",["mustache"],function(a){var b='<a class="yj-btn yj-btn-secondary" href="javascript://" role="button">\n  <span>{{labelText}}</span>\n</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/create_message_button",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","css!./create_message_button","html!./create_message_button"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr");return a("css!./create_message_button"),b.extend({mixins:[c],events:{"click .yj-btn":"_click"},id:"createMessageButton",className:"yj-create-message-button",template:a("html!./create_message_button"),initialize:function(a){this.mediator=a&&a.mediator},getTemplateData:function(){return{labelText:d.t("create_message")}},_click:function(){this.mediator&&this.mediator.trigger("createNewMessage")}})}),define("stache!feeds/lib/ui/inbox/inbox_search_controls_vnext",["mustache"],function(a){var b='<div class="yj-inbox-search-controls--input-container">\n  <label>\n    <span class="yj-acc-hidden">{{placeholder_label}}</span>\n    <input type="text" placeholder="{{placeholder_label}}" class="yj-inbox-search-controls--input" value="{{query}}" {{#has_focus}}autofocus{{/has_focus}}></input>\n  </label>\n</div>\n<a href="javascript://" role="button" class="yj-inbox-search-controls--submit yj-btn yj-btn-alt">\n  <span>{{search_label}}</span>\n</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/inbox_search_controls_vnext",[],function(){}),define("feeds/lib/ui/inbox/inbox_search_controls_vnext",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","core/lib/treatment","html!./inbox_search_controls_vnext","css!./inbox_search_controls_vnext"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("core/lib/treatment"),f=a("html!./inbox_search_controls_vnext");return a("css!./inbox_search_controls_vnext"),b.extend({mixins:[c],tagName:"span",className:"yj-inbox-search-controls",template:f,attributes:{name:"inbox-search",role:"search"},events:{"click .yj-inbox-search-controls--submit":"_submitHandler","keyup .yj-inbox-search-controls--input":"_keyHandler"},getTemplateData:function(){return{query:this.options.query,has_focus:this.options.hasFocus,search_label:d.t("search"),placeholder_label:e.usePriorityCopy()?d.t("search_priority_conversations"):d.t("search_inbox")}},_submitHandler:function(){var a=this.$("input").val();return/\S/.test(a)&&this.trigger("search",{query:encodeURIComponent(a)}),!1},_keyHandler:function(a){13===a.which&&this._submitHandler()}})}),define("stache!workfeed/lib/app/header/inbox_header",["mustache"],function(a){var b='<div class="yj-inbox-header--title-container">\n  <FeedTitle key="feed-title"/>\n</div>\n\n<div class="yj-inbox-header--message-button-container">\n  <CreateMessageButton key="create-message-button"/>\n</div>\n\n<div class="yj-inbox-header--tabs-container" role="navigation">\n  <ul class="yj-inbox-header--tabs">\n    <li class="yj-inbox-header--tab yj-filter-tab {{#unread_selected}}is-selected{{/unread_selected}}">\n      <a href="{{unread_messages_url}}" class="yj-inbox-header--tab-link yj-filter-tab-link" data-feed-type="unread" data-qaid="inbox-unread-tab-link">\n        {{unread_messages_label}}\n        <span class="yj-inbox-header--unread-count" data-qaid="inbox-unread-tab-count"><BadgeCount key="badge-count" /></span>\n        <span class="yj-acc-hidden"> {{tab_label}}</span>\n        <span class="yj-acc-selectedstate"> {{selected_label}}</span>\n      </a>\n    </li>\n\n    <li class="yj-inbox-header--tab yj-filter-tab {{#all_selected}}is-selected{{/all_selected}}">\n      <a href="{{all_messages_url}}" class="yj-inbox-header--tab-link yj-filter-tab-link" data-feed-type="all" data-qaid="inbox-all-tab-link">\n        {{all_messages_label}}\n        <span class="yj-acc-hidden"> {{tab_label}}</span>\n        <span class="yj-acc-selectedstate"> {{selected_label}}</span>\n      </a>\n    </li>\n\n    <li class="yj-inbox-header--tab yj-filter-tab {{#search_selected}}is-selected{{/search_selected}}">\n      <a href="javascript://" role="button" class="yj-inbox-header--search-link{{#search_selected}} is-hidden{{/search_selected}}" data-speechtip>\n        <span class="yj-inbox-header--search-icon yamicon yamicon-rd_search"></span>\n        <span class="yj-acc-hidden">{{search_messages_label}}</span>\n      </a>\n      <span class="yj-inbox-header--search-controls{{^search_selected}} is-hidden{{/search_selected}}">\n        <InboxSearchControls key="inbox-search-controls"/>\n      </span>\n    </li>\n  </ul>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/header/inbox_header",[],function(){}),define("workfeed/lib/app/header/inbox_header",["require","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","underscore","core/lib/tr","core/lib/yammer_uri","core/lib/treatment","core/lib/report","workfeed/lib/app/helpers/layout","feeds/lib/ui/publisher/global/publisher_helper","models/lib/helper/inbox_manager","components/inbox_list/index","components/badge_count/index","feeds/lib/ui/inbox/feed_title","common-ui/lib/ui/shared/create_message_button","feeds/lib/ui/inbox/inbox_search_controls_vnext","models/lib/events","html!./inbox_header","css!./inbox_header"],function(a){"use strict";var b=a("backbone"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("underscore"),g=a("core/lib/tr"),h=a("core/lib/yammer_uri"),i=a("core/lib/treatment"),j=a("core/lib/report"),k=a("workfeed/lib/app/helpers/layout"),l=a("feeds/lib/ui/publisher/global/publisher_helper"),m=a("models/lib/helper/inbox_manager"),n=a("components/inbox_list/index"),o=a("components/badge_count/index"),p=a("feeds/lib/ui/inbox/feed_title"),q=a("common-ui/lib/ui/shared/create_message_button"),r=a("feeds/lib/ui/inbox/inbox_search_controls_vnext"),s=a("models/lib/events"),t=a("html!./inbox_header");a("css!./inbox_header");var u={unread_messages_label:g.t("group_tab_unread_label"),all_messages_label:g.t("group_tab_all_label"),search_messages_label:i.usePriorityCopy()?g.t("search_priority_conversations"):g.t("search_inbox"),tab_label:g.t("tab"),selected_label:g.t("selected")},v=c.extend({mixins:[d,e],template:t,className:k.twoColumnMainClass+" yj-inbox-header",events:{"click .yj-inbox-header--tab-link[data-feed-type]":"_onTabClick","click .yj-inbox-header--search-link":"_onSearchIconClick","focus .yj-inbox-header--search-link":"_onSearchIconClick"},views:{FeedTitle:"_createFeedTitle",CreateMessageButton:"_createCreateMessageButton",InboxSearchControls:"_createInboxSearchControls",BadgeCount:"_createBadgeCount"},initialize:function(){this.unreadFeed=m.getUnreadFeed(),this.listenTo(s,"Feed/"+this.unreadFeed.id+"/update",this._updateUnreadCount)},getTemplateData:function(){return f.extend({unread_messages_url:h.app("/#/inbox/unread"),all_messages_url:h.app("/#/inbox/all"),unread_selected:this._isUnreadSelected(),all_selected:this._isAllSelected(),search_selected:this._isSearchSelected()},u)},render:function(){return this._updateUnreadCount(),b.trigger("/ui/tooltip/add",{target:this.$(".yj-inbox-header--search-link"),text:u.search_messages_label}),this},remove:function(){return b.trigger("/ui/tooltip/remove",{target:this.$(".yj-inbox-header--search-link")}),c.prototype.remove.call(this)},_isUnreadSelected:function(){return this.options.selected===n.ViewTypes.UNREAD},_isAllSelected:function(){return this.options.selected===n.ViewTypes.ALL},_isSearchSelected:function(){return this.options.selected===n.ViewTypes.SEARCH},_createFeedTitle:function(){return new p},_createBadgeCount:function(){return this.badgeCount=new o({count:this.unreadFeed.getUnseenCount()}),this.badgeCount},_createCreateMessageButton:function(){var a=new b.Model;return this.listenTo(a,"createNewMessage",this._openPublisherLightbox),new q({mediator:a})},_createInboxSearchControls:function(){var a=new r({query:this.options.query,hasFocus:this._isSearchSelected()});return this.listenTo(a,"search",this._goToSearch),a},_updateUnreadCount:function(){var a=this.unreadFeed.getUnseenCount(),b=this.$(".yj-inbox-header--unread-count");this.badgeCount&&this.badgeCount.setCount(a),b.toggleClass("is-hidden",0>=a)},_openPublisherLightbox:function(a){l.openComposeLightbox(a,"inbox_main",!0)},_onTabClick:function(a){var b=$(a.currentTarget);if(!b.parent().hasClass("is-selected")){var c={tab_name:b.data("feed-type")},d=this.unreadFeed.getUnseenCount();d>0&&(c.tab_count=d),j.event("inbox_tab_clicked",c)}},_onSearchIconClick:function(){this.$(".yj-inbox-header--search-link").addClass("is-hidden"),this.$(".yj-inbox-header--search-controls").removeClass("is-hidden").velocity({opacity:[1,0],translateX:[0,-5]},{duration:200,easing:"ease-out"}),this.$(".yj-inbox-search-controls--input").focus(),j.event("inbox_search_icon_clicked")},_goToSearch:function(a){yam.router.navigate("/inbox/search?search="+a.query,{trigger:!0})}});return v}),define("css!workfeed/lib/app/views/inbox/index",[],function(){}),define("stache!workfeed/lib/app/views/inbox/index",["mustache"],function(a){var b='<div class="yj-inbox-index--header page-header" role="region" style="display: block">\n  <InboxHeader key="inbox-header" />\n</div>\n<div class="yj-inbox-list-container">\n  <InboxList key="inbox-list"/>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/inbox/index",["require","models/lib/events","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","models/lib/helper/inbox_manager","components/inbox_list/index","workfeed/lib/app/helpers/layout","feeds/lib/ui/publisher/global/publisher_helper","backbone","core/lib/report","feeds/lib/ui/util/title_updater","core/lib/tr","core/lib/treatment","common-ui/lib/ui/keyboard/linear_navigator","workfeed/lib/app/views/inbox/inbox_view_commands","workfeed/lib/app/header/inbox_header","css!./index","html!./index"],function(a){"use strict";var b=a("models/lib/events"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_subviews"),f=a("models/lib/helper/inbox_manager"),g=a("components/inbox_list/index"),h=a("workfeed/lib/app/helpers/layout"),i=a("feeds/lib/ui/publisher/global/publisher_helper"),j=a("backbone"),k=a("core/lib/report"),l=a("feeds/lib/ui/util/title_updater"),m=a("core/lib/tr"),n=a("core/lib/treatment"),o=a("common-ui/lib/ui/keyboard/linear_navigator"),p=a("workfeed/lib/app/views/inbox/inbox_view_commands"),q=a("workfeed/lib/app/header/inbox_header");return a("css!./index"),d.extend({mixins:[c,e],template:a("html!./index"),className:h.twoColumnMainClass,attributes:{role:"main"},views:{InboxHeader:"_createInboxHeader",InboxList:"_createInboxList"},headerNavigationTab:"inbox",_createInboxHeader:function(){return new q({selected:this.options.view})},_createInboxList:function(){var a=this.options.view===g.ViewTypes.ALL;this.inboxFeed=a?f.getAllFeed():f.getUnreadFeed();var c=new g({feed:this.inboxFeed,view:this.options.view,navigator:this.navigator});return this.listenTo(c,"render",this._initChatManager),!a&&c.isLoading()||c.reset(),void 0!==this.inboxFeed.unseen_thread_count&&this._logUnreadCountEvent(),this.listenTo(b,"Feed/"+this.inboxFeed.id+"/update",this._logUnreadCountEvent),n.treatment("keyboardshortcuts2")&&c.listenTo(this,"add_unread_navigation_candidates",c.addNavigationCandidates),j.on("/ui/inbox/markAsUnread",c.reset,c),a&&j.on("/ui/inbox/markAsRead",c.reset,c),c},_goToSearch:function(a){yam.router.navigate("/inbox/search?search="+a.query,{trigger:!0})},_logUnreadCountEvent:function(){var a=f.getUnreadFeed();k.event("inbox_visited",{unread_count:a.getUnseenCount()})},initialize:function(){this._setPageTitle(),this._initializeNavigation()},getTemplateData:function(){return{unreadLabel:n.usePriorityCopy()?m.t("unread_conversations"):m.t("unread_messages"),readLabel:n.usePriorityCopy()?m.t("read_conversations"):m.t("read_messages")}},remove:function(){return this.navigator&&this.navigator.stop(),this.commands&&this.commands.stop(),d.prototype.remove.call(this)},_setPageTitle:function(){var a=n.usePriorityCopy()?m.t("priority_conversations"):m.t("inbox");a=this.options.view===g.ViewTypes.ALL?n.usePriorityCopy()?m.t("priority_conversations_all"):m.t("inbox_all"):n.usePriorityCopy()?m.t("priority_conversations_unread"):m.t("inbox_unread"),l.setTitle(a)},_initializeNavigation:function(){n.treatment("keyboardshortcuts2")&&(this.navigator=new o,this.listenTo(this.navigator,"getCandidates",this._getNavigationCandidates),this.commands=new p({navigator:this.navigator}))},_updateUnreadCount:function(){var a=this.unreadFeed.getUnseenCount(),b=this.$(".yj-inbox--unread-count");a?(b.text("("+a+")"),b.show()):b.hide()},_openPublisherLightbox:function(a){i.openComposeLightbox(a,"inbox_main",!0)},_initChatManager:function(){j.trigger("/ui/view/afterListRendered")},_getNavigationCandidates:function(){this.navigator.set("candidates",[]),this.trigger("add_unread_navigation_candidates"),this.trigger("add_read_navigation_candidates")}})}),define("css!components/inbox_search_empty_notice/src/inbox_search_empty_notice",[],function(){}),define("stache!components/inbox_search_empty_notice/src/inbox_search_empty_notice",["mustache"],function(a){var b='<IconBannerView key="icon-banner" />\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/inbox_search_empty_notice/src/inbox_search_empty_notice",["require","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/icon_banner/index","css!./inbox_search_empty_notice","html!./inbox_search_empty_notice"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/icon_banner/index");return a("css!./inbox_search_empty_notice"),c.extend({mixins:[d,e],className:"yj-inbox-search-empty-notice",template:a("html!./inbox_search_empty_notice"),views:{IconBannerView:"_getIconBannerView"},_getIconBannerData:function(){return{iconName:"no_inbox_search_results",headerLabel:b.t("no_results_found_for_term",{term:this.options.searchTerm}),subheaderLabel:b.t("check_your_spelling_or_try_searching_for_fewer_words")}},_getIconBannerView:function(){return new f(this._getIconBannerData())}})}),define("components/inbox_search_empty_notice/index",["require","./src/inbox_search_empty_notice"],function(a){"use strict";return a("./src/inbox_search_empty_notice")}),define("feeds/lib/ui/feeds/feed_renderer",["require","underscore","core/lib/ctor","core/lib/util/work_queue","core/lib/util/work_queue_task"],function(a){var b=a("underscore"),c=a("core/lib/ctor"),d=a("core/lib/util/work_queue"),e=a("core/lib/util/work_queue_task"),f=3,g=c(null,{init:function(a){this.$list=a.$list,this.async="boolean"==typeof a.async?a.async:!0,this.startRefresh()},add:function(a){var b=this.mode;b&&(this.queueItems.push(a),this.queue.enqueue(new k(this,a,this.mode)))},remove:function(a){this.items=b.reject(this.items,function(b){return b.data.id==a?(b.remove&&b.remove(),!0):!1}),this.queue.removeTask(a)},renderItem:function(a,b){var c="prepend"===b?"prepend":"append";a.render(),this.$list[c](a.$element||a.$el)},isPrepending:function(){return this.mode===i},isRefreshing:function(){return this.mode===h},isAppending:function(){return this.mode===j},render:function(a){switch(a||(a=function(){}),this.mode){case j:this.items=this.items.concat(this.queueItems);break;case h:this.items=this.queueItems.concat([]);break;case i:this.items=this.queueItems.concat(this.items)}this.setRenderOptions(),this.lastCompletedRenderMode=this.mode,this.mode=null,this.queue.enqueue(new l(a))},firstItem:function(a){var b=a||this.items;return b.length?b[0]:void 0},foldItem:function(a){var b=a||this.items;return b.length?b[f]:void 0},lastItem:function(a){var b=a||this.items;return b.length?b[b.length-1]:void 0},getItemIndex:function(a){return b.indexOf(this.items,a)},moveItem:function(a,b){for(var c=[],d=this.items[a],e=0,f=this.items.length;f>e;e++){var g=this.items[e];e==b&&c.push(d),g!==d&&c.push(g)}},size:function(){return this.items.length},queueSize:function(){return this.queueItems.length},getFirstSeen:function(){return this.trackedItems.firstSeen},getLastUnseen:function(){return this.trackedItems.lastUnseen},trackedItemNames:["first","last","firstSeen","lastUnseen"],updateRenderingOptions:function(a){for(var b=this.trackedItemNames,c=[],d=this.trackedItems,e=0,f=b.length;f>e;e++){var g=b[e],h=d[g],i=a[g];h&&h.renderOptions&&h!==i&&(h.renderOptions[g]=!1,c.push(h)),i&&i.renderOptions&&(i.renderOptions[g]=!0,h!==i&&c.push(i))}return this.trackedItems=a,c},setRenderOptions:function(){for(var a=this.items,c=[],d={first:a[0],last:a[a.length-1],firstSeen:null,lastUnseen:null},e=0,f=a.length;f>e;e++){var g=a[e];if(g.isUnseen&&g.isUnseen())d.lastUnseen=g;else if(!d.firstSeen){d.firstSeen=g;break}}c=this.updateRenderingOptions(d),this.mode!==h&&b.invoke(c,"applyRenderOptions")},startAppend:function(){this.mode=j,this.reset()},startPrepend:function(){this.mode=i,this.reset()},startRefresh:function(){this.mode=h,this.trackedItems&&b.each(this.trackedItems,function(a,b){a&&a.renderOptions&&a.renderOptions[b]&&(a.renderOptions[b]=!1)}),this.trackedItems={},this.items=[],this.reset()},reset:function(){this.queue&&this.queue.kill(),this.queueItems=[],this.queue=new d({async:this.async,delay:1,delayBefore:1})},destroy:function(){this.queue&&this.queue.kill(),this.$list&&this.$list.empty().remove(),this.items=this.queue=this.trackedItems=this.queueItems=this.$list=null,this.destroyed=!0},isQueueEmpty:function(){return 0===this.queueItems.length},pauseQueue:function(){this.queue.pause()},resumeQueue:function(){this.queue.resume()},sortQueue:function(){this.queue._queue.sort(function(a,b){return a._feedListItem.data.stats.latest_reply_id>b._feedListItem.data.stats.latest_reply_id?1:-1})}}),h=g.REFRESH="refresh",i=g.PREPEND="prepend",j=g.APPEND="append",k=c(null,[e.prototype],{init:function(a,b,c){this._feedList=a,this._feedListItem=b,this._mode=c},execute:function(){this._feedList.renderItem(this._feedListItem,this._mode),this.onComplete()},getId:function(){return this._feedListItem.data.id}}),l=c(null,[e.prototype],{init:function(a){this._callback=a},execute:function(){this._callback(),this.onComplete()}});return g}),define("feeds/lib/ui/feeds/payload_subtask",["require","core/lib/util/work_queue_task","core/lib/ctor"],function(a){var b=a("core/lib/util/work_queue_task"),c=a("core/lib/ctor");return c(null,[b.prototype],{init:function(a,b,c){this._feedList=a,this._func="string"==typeof b?a[b]:b,this._args=c},execute:function(){this._func.apply(this._feedList,this._args||[]),this.onComplete()}})}),define("feeds/lib/ui/feeds/payload_process_task",["require","feeds/lib/ui/feeds/payload_subtask","core/lib/util/work_queue","core/lib/util/work_queue_task","core/lib/ctor"],function(a){var b=a("feeds/lib/ui/feeds/payload_subtask"),c=a("core/lib/util/work_queue"),d=a("core/lib/util/work_queue_task"),e=a("core/lib/ctor");return e(null,[d.prototype],{init:function(a){this._feedList=a,this._subQueue=new c({}),this._subQueue.pause()},addSubtask:function(a,c){var d=new b(this._feedList,a,c);this._subQueue.enqueue(d)},execute:function(){this._subQueue.resume()},kill:function(){this._subQueue.kill(),d.prototype.kill.call(this)}})}),define("feeds/lib/ui/feeds/feed_list",["require","jquery","backbone","core/lib/jam/component","feeds/lib/ui/feeds/feed_renderer","feeds/lib/ui/feeds/payload_process_task","core/lib/util/work_queue","models/lib/helper/feed_factory","models/lib/helper/feed_hydrator","core/lib/log","models/lib/orm-models"],function(a){var b=a("jquery"),c=a("backbone"),d=a("core/lib/jam/component"),e=a("feeds/lib/ui/feeds/feed_renderer"),f=a("feeds/lib/ui/feeds/payload_process_task"),g=a("core/lib/util/work_queue"),h=a("models/lib/helper/feed_factory"),i=a("models/lib/helper/feed_hydrator"),j=a("core/lib/log"),k=a("models/lib/orm-models"),l=d.extend({beforeInit:function(){this.mediator=new c.Model},init:function(a,c){this.allItems={},this.data={},this.latestPayloadProcessTask=null,this.payloadQueue=new g({}),this.renderer=new e({}),d.prototype.init.call(this,b.extend({},this.defaults,a),c)},defaults:{id:"feedList",settings:{},children:[],isDelegator:!0},template:'      <div class="yj-list-wrapper">           <div class="yj-list-container">            <div class="yj-notices-container"></div>             <ul data-yamjs-id="{{getDomId}}" style="display:none"></ul>          </div>        </div>',prepViewData:function(){return this},afterRender:function(){this.$list=this.$element.find("ul[data-yamjs-id="+this.getDomId()+"]"),this.renderer.$list=this.$list;var a=this._getMoreButton();a&&(a.clickCallBack=this.getOlderItems.bind(this))},_getMoreButton:function(){var a=this.childMap.moreButton;return!a&&this.getChildByType&&(a=this.getChildByType("moreButton")),a},getOlderItems:function(){this.renderer.startAppend()},addItem:function(a){return a.data&&"function"==typeof a.data.getThreadStarter&&!a.data.getThreadStarter().findSender()?void j.log("No sender data found: ",a):(this.allItems[a.data.id]=a,this.addComponent(a),void this.renderer.add(a,this))},startRefresh:function(){this.onBeginPayloadProcess(),this.$list.empty(),this.renderer.startRefresh()},setHasOlderItems:function(){this.hasOlderItems=this.getFeed().hasOlderAvailable()},onItemListProcessed:function(a){this.$list.show(),this.setHasOlderItems(a),this.renderItems(a);var b=this.createBeforeListRenderEvent(a);this.mediator.trigger(b.type,b),this.$element.trigger(b)},renderItems:function(a){var b=this;this.renderer.render(function(){b.itemListRenderComplete(a)})},createBeforeListRenderEvent:function(){return{type:"beforeListRender"}},itemListRenderComplete:function(a){var b=this._getMoreButton(),c=this.createItemsProcessedEvent(a);this.onAfterListRendered(),this.$element.trigger(c),this.mediator.trigger(c.type,c),b&&(b.stopLoading(),this.hasOlderItems?b.show():b.hide(),b.setCount(this.getFeed().getOlderUnseenCount(),k.Feed().UNKNOWN_COUNT_VALUE)),this.completePayloadProcessing()},onAfterListRendered:function(){},createItemsProcessedEvent:function(){return{type:"messagesProcessed"}},clearTimers:function(){this.renderer.destroy()},subscribeToData:function(){this.feedModel=h.findOrCreate("search")},processPayload:function(a){return this.onBeginPayloadProcess(),i.hydrate({feed:this.getFeed(),payload:a,fetchType:"search"}),this.createPayloadSubtask("onItemListProcessed",[a]),a},unsubscribeData:function(){},createPayloadSubtask:function(a,b){this.latestPayloadProcessTask.addSubtask(a,b)},completePayloadProcessing:function(){this.payloadQueue.getCurrentTask().onComplete()},onBeginPayloadProcess:function(){this.latestPayloadProcessTask=new f(this),this.payloadQueue.enqueue(this.latestPayloadProcessTask)},destroy:function(){this.$list=null,this.payloadQueue.kill(),d.prototype.destroy.call(this)},getFeed:function(){return this.feedModel}});return l}),define("css!feeds/lib/ui/threads/thread_search_starter",[],function(){}),define("feeds/lib/ui/threads/thread_search_starter",["require","jquery","underscore","mustache","feeds/lib/ui/attachments/praise_helper","core/lib/date_helper","feeds/lib/helper/i18n_helper","feeds/lib/helper/message_header_helper","core/lib/session","core/lib/tr","feeds/lib/ui/shared/message_subheader","feeds/lib/ui/messages/thread_starter","components/hovercard_link/index","css!feeds/lib/ui/threads/thread_search_starter"],function(a){
var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("feeds/lib/ui/attachments/praise_helper"),f=a("core/lib/date_helper"),g=a("feeds/lib/helper/i18n_helper"),h=a("feeds/lib/helper/message_header_helper"),i=a("core/lib/session"),j=a("core/lib/tr"),k=a("feeds/lib/ui/shared/message_subheader"),l=a("feeds/lib/ui/messages/thread_starter"),m=a("components/hovercard_link/index"),n=function(a){var b=new m({model:a});return b.render().el.innerHTML};a("css!feeds/lib/ui/threads/thread_search_starter");var o=l.extend({defaults:{manuallyRender:!0,settings:{elementType:"div",elementClassName:"yj-thread-search-starter yj-thread-starter",idPrefix:"threadStarter"},display:"threaded",displayShareLink:!1},beforeInit:function(){var a=c.find(this.getMessage().getAttachments(),function(a){return"praise"===a.type});a&&c.extend(this,{getMessageBody:function(){return e.getPraiseMessageBody(this.getMessage().getPraise().praised_user_ids)}})},createElement:function(){this.$readLine=null,this.renderContainerClass="yj-message-list-item--attachment-container",this.$element=b(["<",this.settings.elementType,' class="',this.settings.elementClassName,'" data-yamjs-id="',this.getDomId(),'" data-message-id="',this.data.id,'" >'].join("")),this.$element.append('<div class="yj-thread-search-starter--message-container yj-message-container" />').children("div:last").append(this.buildAvatar({withHovercard:!1})).append(this.buildBody()).append('<div class="'+this.renderContainerClass+'">').append(this.buildAttributes()).end(),this.$messageContainer=this.$element.find(".yj-message-container"),this.buildAttachments();var a=this.messageAttachments||this.sticker;a&&(this.renderContainerClass="yj-message-list-item--attachment-container",this.$messageContainer.append('<div class="'+this.renderContainerClass+'">'),this.addChild(a,"."+this.renderContainerClass)),this.data.isSystemMessage()&&this.$element.addClass("yj-system-message"),this.data.hasAttachmentOfType("praise")&&this.$element.addClass("yj-praise"),h.addTooltip(this.$element),this.applyRenderOptions()},buildAttributes:function(){var a,e=this.data,g=e.getThread().getReplyCount2(),h=Math.min(c(e.getThread().getSnippets()).size(),3),i=e.getThread().getLatestReplyTime(),k=e.getThread().getLatestReplyId();g>0&&h>0?a=j.t("showing_part_of_count_replies",{part:h,count:g}):g>0&&(a=j.t("count_replies",{count:g}));var l,m;return i&&k!=e.id?(l=i,m=j.t("last_reply_time",{time:f.formatAgo(l)})):(l=e.getTime(),m=j.t("started_time",{time:f.formatAgo(l)})),b(d.render('<p class="yj-attributes"><span>{{replies}}{{#replies}}&nbsp;&middot;&nbsp;{{/replies}}</span><span title="{{time}}">{{ago}}</span></p>',{replies:a,time:f.formatDateTime(new Date(l)),ago:m}))},buildBody:function(){var a,e,f=[],h=this.data,i=h.findSender();f.push('<div class="yj-message-list-item--body yj-message-body"><span class="yj-byline'),f.push(h.isReplyToThreadStarter()?' yj-reply-to-thread-starter">':'">'),f.push(n(i)),a=this.data.title,e=this.getMessageBody(),"announcement"===h.message_type&&f.push(" "+j.t("announcement_2"));var l=new k({model:h,isAReply:this.isAReply(),useIn:!1});f.push(l.render().el.outerHTML),f.push(" </span>"),h.isDirectMessage()&&f.push(this.buildPrivateRecipients()),this.data.title&&(f.push('<span class="yj-message-title">'+c.escape(a)),f.push("</span>")),f.push('<span class="yj-thread-search-starter--message yj-message">'+e+"</span></div>");var m=b(f.join(""));if(!this.data.isSystemMessage()){var o=this.data.getTextDirection();this.data.title&&g.addDirectionSupportToElement(m.find(".yj-message-title"),o),g.addDirectionSupportToElement(m.find(".yj-message"),o)}var p=m.find(".yj-byline"),q="<h3 class='yj-acc-hidden'><span>{{summaryText}}</span></h3>",r=d.render(q,{summaryText:p.text().replace(/\s+/g," ")});return b(r).insertBefore(p),m.find(".expand-body").replaceWith("<span>&hellip;</span>"),m},buildPrivateRecipients:function(){var a,b,e=this.data.getConversation().participating_names,f=this.data.getConversation().participating_users_count,g=this.data.findSender(),h=i.getCurrentUser(),k=h.name==g.name,l=k?3:2;e=c.filter(e,function(a){return a.permalink!=g.name&&a.permalink!=h.name}),e.length>l+1&&(e=e.slice(0,l)),e.length&&(e[e.length-1].last=!0,e.length>1?e[0].first=!0:k&&1==e.length&&(e[0].first=!0)),a=k?f-e.length-1:f-e.length-2,a=Math.max(0,a),b=e.length<2&&!a;var m='        <span class="yj-thread-search-starter--recipients-label yj-recipients-label yj-experiment-universal-publisher-ui">          {{to}}{{#recipients}}            {{#last}}{{^others}}{{^first}}'+j.t("and")+" {{/first}}{{/others}}{{/last}}            {{full_name}}{{^last}}{{^two}},{{/two}} {{/last}}          {{/recipients}}{{others}}        </span>";return d.render(m,{to:k?j.t("to_2"):b?j.t("to_you"):j.t("to_you_2"),recipients:e,two:2==e.length&&!a&&k,others:a?j.t("and_count_others_2",{count:a}):""})},getMessageBody:function(){var a,b=this.data;return a=b.getHighlightedBody(),this._appMessageType&&"praise"!=this._appMessageType&&(a=""),a},getAttachmentsRenderMode:function(){return"reply"}});return o}),define("feeds/lib/ui/threads/thread_search_list_item_mixin",["require","underscore","core/lib/string_helper","core/lib/uri_helper","core/lib/treatment"],function(a){var b=a("underscore"),c=a("core/lib/string_helper"),d=a("core/lib/uri_helper"),e=a("core/lib/treatment"),f={getHoverCardQueryString:function(a,b,c){var d=a.type;c&&c.type&&c.type!==d&&(d+="_"+c.type),d="hc_"+d;var e=this.getSearchClickTarget(d);return this.decorateInternalLink({link:b,searchClickTarget:e,id:a.id})},getEntityModel:function(a){var b=a||this.queryOptions.facet_type;return b?(b=c.camelize(c.capitalize(b)),"YmoduleApplication"===b&&(b="YmoduleInstance"),b):"Message"},decorateInternalLink:function(a){var b=a.link,c="string"==typeof b?b:b.attr("href"),e=d.parse(c),f=e.anchor,g=a.id||this.thread.id,h=this.getYamTrack(g,this.getIndex());e=[e.protocol,"://",e.host,e.path],f?(e=e.concat(["#",f]),e=e.concat(["&"])):e=e.concat(["?"]),e=e.concat([h]);var i=a.searchClickTarget||this.getSearchClickTarget(b);return e=e.concat([i]),e=e.concat(["&"]),c=e.join(""),"string"!=typeof b&&b.attr("href",c),c},getYamTrack:function(a,c,f){function g(a){var c={};return b.map(a,function(a,b){c["trk_"+b]=a}),c}var h={event:"search_click"};return"undefined"!=typeof c&&(e.treatment("make_search_fast_ab")&&(c+=(this.queryOptions.page-1)*this.searchStrategy.pageSize),h.result_index=c),a&&(h.entity_model=this.getEntityModel(),h.entity_id=a),f?h:"&"+d.paramify(g(h))},getSearchClickTarget:function(a){if("string"==typeof a)return"&trk_search_click_target="+a;var b=a.attr("data-resource-model")||"auxiliary";return"&trk_search_click_target="+b}};return f}),define("css!feeds/lib/ui/threads/thread_search_list_item",[],function(){}),define("feeds/lib/ui/threads/thread_search_list_item",["require","jquery","underscore","mustache","core/lib/util/emoji_helper","core/lib/jam/component","feeds/lib/helper/i18n_helper","backbone","core/lib/report","models/snippet","core/lib/secure_opener","feeds/lib/ui/threads/thread_search_starter","feeds/lib/ui/threads/thread_search_list_item_mixin","core/lib/tr","common-ui/lib/helper/ui","core/lib/uri_helper","core/lib/yammer_uri","core/lib/location_helper","components/hovercard_link/index","css!feeds/lib/ui/threads/thread_search_list_item"],function(a){var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("core/lib/util/emoji_helper"),f=a("core/lib/jam/component"),g=a("feeds/lib/helper/i18n_helper"),h=a("backbone"),i=a("core/lib/report"),j=a("models/snippet"),k=a("core/lib/secure_opener"),l=a("feeds/lib/ui/threads/thread_search_starter"),m=a("feeds/lib/ui/threads/thread_search_list_item_mixin"),n=a("core/lib/tr"),o=a("common-ui/lib/helper/ui"),p=a("core/lib/uri_helper"),q=a("core/lib/yammer_uri"),r=a("core/lib/location_helper"),s=a("components/hovercard_link/index"),t=function(a){var b=new s({model:a});return b.render().el.innerHTML};a("css!feeds/lib/ui/threads/thread_search_list_item");var u=f.extend({init:function(a,c,d){this.data=a,this.thread=a,c=c||{},this.queryOptions=c.queryOptions||{},f.prototype.init.call(this,b.extend({},this.defaults,c),d),this.addThreadStarter(this.thread.getThreadStarter())},defaults:{settings:{elementType:"li",idPrefix:"threadListItem"}},snippetTemplate:'<li class="yj-thread-search-list-item--snippet"><div class="yj-search-message-container">        <div class="yj-message-list-item--body yj-message-body">          <span class="yj-thread-search-list-item--snippet-byline yj-byline yj-reply-to-thread-starter">{{{ name }}}</span>          <span class="yj-thread-search-list-item--snippet-message yj-message">{{{ body }}}</span>        </div>      </div></li>',searchListItemTemplate:'<{{type}} class="yj-thread-search-list-item yj-thread-list-item sprite-parent" data-thread-id="{{id}}"></{{type}}>',snippetContainerTemplate:'<div class="yj-thread-search-list-item--snippets-container yj-thread-snippets-container">        <ul class="yj-thread-search-list-item--snippets yj-thread-snippets"></ul>      </div>',unseenSnippetTemplate:'<span class="yj-thread-search-list-item--unseen-snippets">{{text}}</span>',actionTemplate:'<div class="yj-thread-search-list-item--action yj-action">      <a href="{{link}}" class="yj-thread-search-list-item--action-link yj-detail"><span class="yamicon yamicon-goto yamicon-inline"></span> <span class="yj-thread-search-list-item--action-label">{{name}}</span></a></div>',beforeInit:function(){this.decorateLinks=c.once(this.decorateLinks.bind(this))},observeDomEvents:function(){this.$element.on("click",c.bind(function(a){o.isTextSelected()||this.handleItemClick(a)},this))},destroy:function(){f.prototype.destroy.call(this),j.clearByThreadId(this.thread.id),this.$element&&this.$element.off("click on_click_external")},handleItemClick:function(a){var c=b(a.target).closest(".yj-thread-list-item"),d=this.$element.parent().find(".yj-thread-list-item").index(c),e=+c.attr("data-thread-id"),f=this.getItemClickTarget(a);f.location&&(-1!==f.location.indexOf(q.base())?(a.preventDefault(),this.openItemClick(f)):this.reportExternalLink(e,d))},openItemClick:function(a){a.location&&(a.modifierKey?k.open(a.location,"_blank"):r.assign(a.location))},getItemClickTarget:function(a){var c,d=b(a.target),e=d.closest("li.yj-thread-list-item"),f=!!(a.which&&2===a.which||a.metaKey||a.ctrlKey),g=d.closest(".yj-action").length,h=d.closest("a, button").length;return"radio"!==d[0].type&&(c=d.closest("a").attr("href")||e.find(".yj-action a").attr("href"),!g&&h||a.preventDefault()),{modifierKey:f,location:c}},afterRender:function(){this.$element.on("on_click_external",c.bind(function(a){a.stopPropagation(),this.reportExternalLink(this.thread.id,this.getIndex())},this))},addThreadStarter:function(a){this.threadStarter=new l(a,void 0,this),this.addComponent(this.threadStarter)},createElement:function(){this.$readLine=null;var a=c(this.thread.getSnippets()),e=this.thread.getUnseenSnippetCount();this.$element=b(d.render(this.searchListItemTemplate,{type:this.settings.elementType,id:this.thread.id})).append(this.threadStarter.render()),a.size()>0&&(this.$element.append(d.render(this.snippetContainerTemplate)),this.$threadRepliesList=this.$element.find(".yj-thread-snippets"),this.renderSnippets(a),e>0&&this.$element.find(".yj-thread-snippets-container").append(d.render(this.unseenSnippetTemplate,{text:n.t("count_more_search_matches_in_this_conversation",{count:e})}))),this.$element.append(this.buildAction())},renderSnippets:function(a){var c=b(document.createDocumentFragment());a.chain().sortBy(function(a){return a.id}).each(function(a){c.append(this.renderSnippet(a))},this),c.appendTo(this.$threadRepliesList)},renderSnippet:function(a){var c=b(d.render(this.snippetTemplate,{name:t(a.findSender())+": ",body:e.parse(a.getPlainBody())})),f=a.getTextDirection();g.addDirectionSupportToElement(c.find(".yj-message-body"),f);var h=c.find(".yj-byline"),i="<h4 class='yj-acc-hidden'><span>{{summaryText}}</span></h4>",j=d.render(i,{summaryText:h.text().replace(/\s+/g," ")});return b(j).insertBefore(h),c},buildAction:function(){var a=b(d.render(this.actionTemplate,{name:n.t("view_full_conversation_2")}));this.$element.append(a)},decorateLinks:function(){this.decorateLinksDelegate(),this.addHoverCards()},decorateLinksDelegate:function(){var a=this.$element.find("a"),d=a.filter(".yj-action a");a=a.not(".yj-action a"),this.decorateActionLink(d),a.each(c.bind(function(a,c){c=b(c);var d=c.attr("href");d&&-1!==d.indexOf(q.base())&&this.decorateInternalLink({link:c})},this))},addHoverCards:function(){var a;this.$element.find(".yj-hovercard-link").each(c.bind(function(a,c){var d=b(c),e=d.data("resource-model")||"user",f=d.data("resource-id")||this.thread.getThreadStarter.sender_id;h.trigger("/ui/hovercard/add",d,{id:f,type:e,decorator:{qs:this.getHoverCardQueryString.bind(this,{type:e})}})},this)),a=this.$element.find(".yj-avatar--thumb"),h.trigger("/ui/hovercard/add",a,{id:this.thread.getThreadStarter().sender_id,type:a.data("resource-model")||"user",decorator:{qs:this.getHoverCardQueryString.bind(this,{type:a.data("resource-model")||"user"})}})},decorateActionLink:function(a){var b=this.thread.id,c=this.getIndex(),d=this.getThreadPermalink(b,c);a.attr("href",d)},getThreadPermalink:function(a,b){var c="/#/Threads/show?threadId="+a;c+=this.getSearchUriParams(a);var d="&search_origin=global";return c+=d,c+=this.getYamTrack(a,b),q.app(c)},getSearchUriParams:function(){var a=c.omit(this.queryOptions,"searchStrategy");return a&&a.type&&(a.search_type=a.type,delete a.type),"&"+p.paramify(a)},reportExternalLink:function(a,b){var c=this.getExternalYamTrack(a,b);i.event("search_click",c)},getExternalYamTrack:function(a,b){var c=this.getYamTrack(a,b,!0);return delete c.event,c.search_click_target="external",c},getIndex:function(){var a=this.$element&&this.$element.parent();return a&&a.find("li.yj-thread-list-item").index(this.$element)}});return c.extend(u.prototype,m),u}),define("css!feeds/lib/ui/threads/thread_search_list",[],function(){}),define("stache!feeds/lib/ui/threads/thread_search_list",["mustache"],function(a){var b='<div class="yj-list-wrapper">\n  <div class="yj-message-form-selector"></div>\n  <div class="yj-list-container">\n    <span class="yj-acc-hidden"><h2>{{feedHeaderText}}</h2></span>\n    <div class="yj-feed-toggle-container"></div>\n    <div role="region">\n      <div class="yj-notices-container"></div>\n      <ul data-yamjs-id="{{domId}}" class="yj-thread-search-list--messages yj-feed-messages" style="display:none"></ul>\n    </div>\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/threads/thread_search_list",["require","jquery","underscore","backbone","feeds/lib/ui/feeds/feed_list","feeds/lib/ui/feeds/spinner","feeds/lib/ui/threads/thread_search_list_item","core/lib/client/message_payload","common-ui/lib/ui/shared/more_button","core/lib/log","core/lib/client/payload_helper","core/lib/tr","core/lib/yammer_api","models/lib/events","css!./thread_search_list","html!./thread_search_list"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("feeds/lib/ui/feeds/feed_list"),f=a("feeds/lib/ui/feeds/spinner"),g=a("feeds/lib/ui/threads/thread_search_list_item"),h=a("core/lib/client/message_payload"),i=a("common-ui/lib/ui/shared/more_button"),j=a("core/lib/log"),k=a("core/lib/client/payload_helper"),l=a("core/lib/tr"),m=a("core/lib/yammer_api"),n=a("models/lib/events"),o=function(){d.trigger("/ui/alert/show","error",l.t("search_error"))};a("css!./thread_search_list");var p=e.extend({template:a("html!./thread_search_list"),defaults:{id:"searchResultsList",settings:{},children:[{id:"spinner",type:f,target:".yj-notices-container:first"},{id:"moreButton",type:i,target:".yj-list-container:first"}]},init:function(a,b){c.bindAll(this,"_searchSuccess","fetchMore","renderThread"),this.searchTerm=a.settings.search,this.searchPage=1,this.searchFilters=a.settings.searchFilters||{},e.prototype.init.call(this,c.extend({},this.defaults,a),b)},afterInit:function(){this.searchMessages()},createElement:function(){this.$element=b(this.template({domId:this.getDomId(),feedHeaderText:l.t("message_list")}))},subscribeToData:function(){e.prototype.subscribeToData.call(this);var a=this.getFeed();this.listenTo(n,"ThreadFeedDelivery/"+a.id+"/create",this.renderThread)},fetchMore:function(){var a=this._getMoreButton();a&&a.handleClick()},searchMessages:function(){return m.searchMessages(this._requestdata()).then(k.searchPayloadProcessor(this._searchSuccess)).fail(o)},_requestdata:function(){return p.enhanceParams(this.getQueryOptions())},_searchSuccess:function(a){a=this.processPayload(a),this.settings.renderTabs&&this.trigger("results-to-render",a.getRaw())},processPayload:function(a){return e.prototype.processPayload.call(this,a)},getQueryOptions:function(){return c.extend({},this.searchFilters,{search:this.searchTerm,page:this.searchPage})},getOlderItems:function(){this.searchPage++,this.renderer.startAppend(),this.searchMessages()},renderThread:function(a){var b=a.getLatestReplyId();!this.initialized||b<this.newest?this.createPayloadSubtask("onThreadStarterCreate",[a]):d.trigger("/ui/alert/show","notice","Your message has been posted.")},onThreadStarterCreate:function(a){var b=this.createThreadListItem(a);return this.addItem(b),b},createThreadListItem:function(a){try{return new g(a,{queryOptions:this.getQueryOptions()},this)}catch(b){throw j.log("ERROR: SearchList.createThreadListItem: ",b,"thread: ",a),b}},onAfterListRendered:function(){var a=c.filter(this.allItems,function(a){return/^threadListItem/.test(a.getId())});c.each(a,function(a){a.decorateLinks()}),this.trigger("list-rendered")},setHasOlderItems:function(a){a.val||(a=new h(a)),!a||"number"!=typeof a.val("count.messages.count")||"refresh"!==this.renderer.mode&&"append"!==this.renderer.mode||(this.hasOlderItems=a.val("count.messages.count")>c.size(this.allItems))},reset:function(){this.stopListening(),this.getFeed().destroyDeliverys(),this.destroy()}});return p.enhanceParams=function(a){return c.extend(a,{scoring:"linear1Y-prankie-group-private-higher",match:"any-exact",search_sort:"relevance"})},c.extend(p.prototype,d.Events),p}),define("css!feeds/lib/ui/inbox/inbox_search_list",[],function(){}),define("feeds/lib/ui/inbox/inbox_search_list",["require","jquery","underscore","core/lib/jam/component2","feeds/lib/ui/inbox/inbox_list_item","common-ui/lib/ui/shared/more_button","feeds/lib/ui/feeds/spinner","components/inbox_search_empty_notice/index","feeds/lib/ui/threads/thread_search_list","core/lib/log","core/lib/client/payload_helper","core/lib/tr","core/lib/yammer_api","core/lib/treatment","backbone","core/lib/report","css!./inbox_search_list"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/jam/component2"),e=a("feeds/lib/ui/inbox/inbox_list_item"),f=a("common-ui/lib/ui/shared/more_button"),g=a("feeds/lib/ui/feeds/spinner"),h=a("components/inbox_search_empty_notice/index"),i=a("feeds/lib/ui/threads/thread_search_list"),j=a("core/lib/log"),k=a("core/lib/client/payload_helper"),l=a("core/lib/tr"),m=a("core/lib/yammer_api"),n=a("core/lib/treatment"),o=a("backbone"),p=a("core/lib/report"),q=function(){o.trigger("/ui/alert/show","error",l.t("search_error"))},r=20;return a("css!./inbox_search_list"),i.extend({defaults:{id:"inboxList",settings:{},children:[{id:"spinner",type:g,target:".yj-notices-container:first"},{id:"moreButton",type:f,target:".yj-list-container:first"}]},init:function(a,d){i.prototype.init.call(this,b.extend({},this.defaults,a),d),c.bindAll(this,"moreButtonHandler","handleSuccess","processPayload")},observeDomEvents:function(){i.prototype.observeDomEvents.call(this),this.$element.delegate(".yj-more-button-link","click",this.moreButtonHandler)},moreButtonHandler:function(){this.renderer.startAppend()},afterInit:function(){this.renderer.startRefresh(),i.prototype.afterInit.call(this)},searchMessages:function(){this.renderer.isRefreshing()&&this.$element.find("ul").empty(),this.getFeed().destroyDeliverys();var a,b=this.getQueryOptions();n.treatment("make_search_fast_ab")?(p.event("inbox_scoped_search",b),a=m.searchInboxV2(b).then(function(a){return a.count={messages:{count:a.count}},a})):(b.search_inbox=1,b.search_source="inbox",a=m.searchInbox(b)),a.then(k.searchPayloadProcessor(this.handleSuccess)).then(this.processPayload,q)},_getSearchCountView:function(){return new d({id:"inbox_result_count",prependToTarget:!0,target:".yj-list-container",template:'<div class="{{cssClass}} yj-inbox-search-list--count">{{{result}}}</div>',model:{result:l.t("total_results_for_term",{count:this.resultsCount,term:c.escape(this.searchTerm)})}})},handleSuccess:function(a){var b=a._raw;return this.resultsCount=b.count.messages&&b.count.messages.count||0,this.resultsCount<=0?(this.emptyNotice=this.emptyNotice||new h({searchTerm:this.searchTerm}),this.$el.find(".yj-list-container").html(this.emptyNotice.render().$el),this.searchCount&&(this.searchCount.remove(),this.searchCount=null)):(this.emptyNotice&&(this.emptyNotice.remove(),this.emptyNotice=null),this.searchCount||(this.searchCount=this._getSearchCountView(),this.addComponent(this.searchCount),this.renderChild(this.searchCount.getId()))),a},createThreadListItem:function(a){var b;try{return a.addToInboxLocal(),new e({thread:a,unreadCount:0,searchTerm:this.searchTerm})}catch(c){b=c,j.log("ERROR: InboxSearchList.createThreadListItem: ",b,"thread: ",a)}throw b},getQueryOptions:function(){return n.treatment("make_search_fast_ab")?{search:this.searchTerm,start:(this.searchPage-1)*r,size:r}:i.prototype.getQueryOptions.call(this)}})}),define("stache!workfeed/lib/app/views/inbox/search",["mustache"],function(a){var b='<div class="yj-inbox-search--header page-header" role="region" style="display: block">\n  <InboxHeader key="inbox-header" />\n</div>\n<div class="yj-inbox-list-container yj-inbox-search-list"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/inbox/search",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","feeds/lib/ui/inbox/inbox_search_list","workfeed/lib/app/header/inbox_header","components/inbox_list/index","feeds/lib/ui/publisher/global/publisher_helper","workfeed/lib/app/helpers/layout","feeds/lib/ui/util/title_updater","core/lib/tr","core/lib/treatment","html!./search"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("feeds/lib/ui/inbox/inbox_search_list"),f=a("workfeed/lib/app/header/inbox_header"),g=a("components/inbox_list/index"),h=a("feeds/lib/ui/publisher/global/publisher_helper"),i=a("workfeed/lib/app/helpers/layout"),j=a("feeds/lib/ui/util/title_updater"),k=a("core/lib/tr"),l=a("core/lib/treatment");return c.extend({mixins:[b,d],template:a("html!./search"),className:i.twoColumnMainClass,attributes:{role:"main"},views:{InboxHeader:"_createInboxHeader"},headerNavigationTab:"inbox",initialize:function(){return this.options.search?(this._title=l.usePriorityCopy()?k.t("results_in_priority_conversations"):k.t("inbox_search_results"),void j.setTitle(this._title)):void yam.router.navigate("/inbox/index",{trigger:!0})},render:function(){return this._removeSearchList(),this._searchList=new e({settings:{renderTabs:!1,search:this.options.search}}),this._searchList.render(),this.$(".yj-inbox-search-list").append(this._searchList.$el),this},_removeSearchList:function(){this._searchList&&(this._searchList.reset(),this._searchList.remove())},_openPublisherLightbox:function(a){h.openComposeLightbox(a,"inbox_search",!0)},_createInboxHeader:function(){return new f({query:this.options.search,selected:g.ViewTypes.SEARCH})},remove:function(){return this._removeSearchList(),c.prototype.remove.apply(this,arguments)}})}),define("stache!feeds/lib/ui/publisher/global/topic_list_item",["mustache"],function(a){var b='{{#icon}}\n  <span class="item-icon subtle yamicon yamicon-{{icon}}"></span>\n{{/icon}}\n<span class="item-type yj-acc-hidden">{{typeLabel}}:</span>\n<span class="item-name">{{name}}</span>\n<button class="item-remove unstyle-button-as-span" data-speechtip="{{removeLabelShort}}">\n  <span class="yamicon yamicon-x"></span>\n  <span class="yj-acc-hidden">{{removeLabel}}: {{name}}</span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/topic_list_item",["require","underscore","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./topic_list_item"],function(a){var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("html!./topic_list_item"),g={main:"tag"};return d.extend({mixins:[e],defaults:function(){var a={type:c.t("topic_2"),remove:c.t("remove_topic_2"),removeShort:c.t("remove")};return{icons:g,strings:a}},events:{"click .item-remove":"_onClickRemove"},tagName:"li",className:"yj-global-tag-list-item yj-global-topic-list-item",template:f,initialize:function(a){this._icons=a.icons,this._strings=a.strings,this._setupListeners()},getTemplateData:function(){return b.extend(this.model.toJSON(),{icon:this._icons.main,typeLabel:this._strings.type,removeLabel:this._strings.remove,removeLabelShort:this._strings.removeShort})},render:function(){return this.$removeButton=this.$(".item-remove"),this},enable:function(){return this.$removeButton&&this.$removeButton.prop("disabled",!1),this},disable:function(){return this.$removeButton&&this.$removeButton.prop("disabled",!0),this},_setupListeners:function(){this.listenTo(this.model,"change",this.render)},_onClickRemove:function(){this.remove(),this.model.collection.remove(this.model)}})}),define("feeds/lib/ui/publisher/global/topic_list",["require","underscore","backbone","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/topic_list_item"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("feeds/lib/ui/publisher/global/topic_list_item");return d.extend({mixins:[e,f],tagName:"ol",className:"yj-global-tag-list yj-global-topic-list",initialize:function(a){this._filter=a.filter||this.collection.toArray,this._createChildren(),this._setupListeners()},enable:function(){return b.invoke(this.children(),"enable"),this},disable:function(){return b.invoke(this.children(),"disable"),this},_createChildren:function(){var a=this._filter.call(this.collection);b.each(a,function(a){this.add(new g({model:a}))},this)},_setupListeners:function(){this.listenTo(this.collection,"add remove reset sort",this._recreateChildren)},_recreateChildren:function(){this.empty(),this._createChildren(),this.render(),c.trigger("/ui/lightbox/resize")}})}),define("stache!feeds/lib/ui/publisher/global/topic_input",["mustache"],function(a){var b='<label>\n  <span class="input-label yj-acc-hidden"></span>\n  <input aria-haspopup="true" aria-autocomplete="list" />\n</label>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/topic_input",["require","underscore","core/lib/backbone_base_view","core/lib/log","core/lib/session","core/lib/string_helper","core/lib/tr","common-ui/lib/helper/ui","jquery-watermark","models/topic_backbone","common-ui/lib/ui/shared/type_ahead","html!./topic_input"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/log"),e=a("core/lib/session"),f=a("core/lib/string_helper"),g=a("core/lib/tr"),h=a("common-ui/lib/helper/ui");a("jquery-watermark");var i=a("models/topic_backbone"),j=a("common-ui/lib/ui/shared/type_ahead"),k=a("html!./topic_input"),l=j,m={maxResults:10,hintMessage:null,selectFirst:!1,inline:!0,allowWide:!1,width:260},n=[j.MODEL_TOPIC];return c.extend({defaults:function(){var a=g.t("add_topics_2"),b={placeholder:a};return{strings:b,typeahead:l,typeaheadOptions:m,typeaheadModels:n}},events:{"keydown input":"_onKeydown"},className:"yj-global-tag-input yj-global-topic-input",template:k,initialize:function(a){this._message=a.message,this._strings=a.strings,this._typeahead=a.typeahead,this._typeaheadOptions=a.typeaheadOptions,this._typeaheadModels=a.typeaheadModels,this._setupListeners()},render:function(){return this._destroyTypeahead(),this.$el.html(this.template()),this.$input=this.$("input"),this.$label=this.$(".input-label"),this._updatePlaceholder(),this._registerTypeahead(),this},remove:function(){return this._destroyTypeahead(),c.prototype.remove.call(this)},enable:function(){return this.$input&&this.$input.prop("disabled",!1),this},disable:function(){return this.$input&&this.$input.prop("disabled",!0),this},clear:function(){return this.val(""),this},val:function(){return this.$input?this.$input.val.apply(this.$input,arguments):""},focus:function(){return this.$input&&this.$input.focus(),this},blur:function(){return this.$input&&this.$input.blur(),this},_setupListeners:function(){this.listenTo(this.collection,"add remove reset",this._onChangeCollection)},_registerTypeahead:function(){var a={completableModels:this._typeaheadModels,getPosition:this._getTypeaheadPosition.bind(this),onSelect:this._onSelectTypeahead.bind(this),onNoSelection:this._onNoSelectTypeahead.bind(this)};this._typeahead.registerField(this.$input,b.extend(a,this._typeaheadOptions))},_destroyTypeahead:function(){this.$input&&this._typeahead.removeField(this.$input)},_getTypeaheadPosition:function(){var a=this.$input.position(),b=this.$input.outerHeight(),c=this.$el.offsetParent().width(),d=this._typeahead.$el.width();return{left:Math.min(a.left+d,c)-d,top:a.top+b+1}},_onSelectTypeahead:function(a){var b=i.fromOriginalModel(a);return b?void this._addTopic(b):void d.warn("TopicInput: could not create topic")},_onNoSelectTypeahead:function(a){this._addTopic({name:a}),this.clear()},_onKeydown:function(a){switch(a.which){case 8:this._onDeleteKeydown(a);break;case 13:this._onEnterKeydown(a)}},_onDeleteKeydown:function(a){0===this.val().length&&this.collection.length>0&&(a.preventDefault(),a.stopPropagation(),this._removeLastTopic())},_onEnterKeydown:function(a){var b=e.getCurrentUser(),c=b&&b.web_preferences,d=c?!f.convertStringyBoolean(c.enter_does_not_submit_message):!1;(d&&!a.shiftKey||!d&&a.shiftKey)&&(a.preventDefault(),this.trigger("submit"))},_addTopic:function(a){this.collection.add(a),this.blur(),this.focus()},_removeLastTopic:function(){this.collection.pop(),this.blur(),this.focus()},_updatePlaceholder:function(){if(null!=this.$input){var a=this.collection.length,b=this._strings.placeholder,c=0===a?"75%":h.getTextWidth(b);this.$input.watermark(b),this.$input.css({width:c}),this.$label.text(b)}},_onChangeCollection:function(){this._updatePlaceholder()}})}),define("feeds/lib/ui/publisher/global/topic_change_reporter",["require","core/lib/report","core/lib/backbone_base_view","core/lib/backbone_with_show_hide"],function(a){var b=a("core/lib/report"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_show_hide");return c.extend({mixins:[d],initialize:function(){this._enabled=!0,this.listenTo(this.collection,"add",this._onTopicAdded),this.listenTo(this.collection,"remove",this._onTopicRemoved),this.hide()},enable:function(){return this._enabled=!0,this},disable:function(){return this._enabled=!1,this},_onTopicAdded:function(){this._enabled&&b.event("topic_added")},_onTopicRemoved:function(){this._enabled&&b.event("topic_removed")}})}),define("stache!feeds/lib/ui/publisher/global/topic_selector",["mustache"],function(a){var b='<span class="selector-prefix yamicon yamicon-tag"></span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/topic_selector",[],function(){}),define("feeds/lib/ui/publisher/global/topic_selector",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/topic_list","feeds/lib/ui/publisher/global/topic_input","feeds/lib/ui/publisher/global/topic_change_reporter","html!./topic_selector","css!./topic_selector"],function(a){
var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("feeds/lib/ui/publisher/global/topic_list"),g=a("feeds/lib/ui/publisher/global/topic_input"),h=a("feeds/lib/ui/publisher/global/topic_change_reporter"),i=a("html!./topic_selector");return a("css!./topic_selector"),b.extend({mixins:[c,d,e],events:{click:"_onClick"},className:"yj-global-tag-selector yj-global-topic-selector",template:i,initialize:function(a){this._strings=a.strings,this._typeahead=a.typeahead,this._typeaheadOptions=a.typeaheadOptions,this._typeaheadModels=a.typeaheadModels,this._message=a.message,this._createChildren(),this._setupListener()},render:function(){return this.$prefix=this.$(".selector-prefix"),this},enable:function(){return this._list.enable(),this._input.enable(),this._reporter.enable(),this},disable:function(){return this._list.disable(),this._input.disable(),this._reporter.disable(),this},clear:function(){return this.val(""),this},val:function(){return this._input.val.apply(this._input,arguments)},focus:function(){return this._input.focus(),this},blur:function(){return this._input.blur(),this},_createChildren:function(){this._list=new f({collection:this.collection,message:this._message}),this.add(this._list),this._input=new g({collection:this.collection,message:this._message,strings:this._strings,typeahead:this._typeahead,typeaheadOptions:this._typeaheadOptions,typeaheadModels:this._typeaheadModels}),this.add(this._input),this._reporter=new h({collection:this.collection}),this.add(this._reporter)},_setupListener:function(){this.listenTo(this.collection,"add remove reset",this._updatePrefix),this.listenTo(this._input,"submit",this._notifyParent.bind(this,"submit"))},_updatePrefix:function(){this.$prefix&&this.$prefix.toggle(0===this.collection.length)},_notifyParent:function(){this.trigger.apply(this,arguments)},_onClick:function(){this.focus()}})}),define("stache!feeds/lib/ui/publisher/global/topic_menu",["mustache"],function(a){var b='<button class="unstyle-button-as-span menu-button">\n  <span class="menu-icon yamicon yamicon-{{icon}}"></span>\n  <span class="menu-label">{{label}}</span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/topic_menu",[],function(){}),define("feeds/lib/ui/publisher/global/topic_menu",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_show_hide","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","backbone","core/lib/tr","feeds/lib/ui/publisher/global/topic_selector","html!./topic_menu","css!./topic_menu"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_show_hide"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("backbone"),h=a("core/lib/tr"),i=a("feeds/lib/ui/publisher/global/topic_selector"),j=a("html!./topic_menu");a("css!./topic_menu");var k={main:"tag"};return b.extend({mixins:[c,d,e,f],defaults:function(){var a={main:h.t("add_topics_2")};return{icons:k,strings:a}},events:{"click .menu-button":"_onClickButton"},className:"yj-global-topic-menu",template:j,initialize:function(a){return this._icons=a.icons,this._strings=a.strings,this._inLightbox=a.inLightbox,this._inLightbox?void this.hide():(this._createChildren(),void this._setupListener())},getTemplateData:function(){return{icon:this._icons.main,label:this._strings.main}},open:function(){return this.swap(!0),this},close:function(){return this.swap(!1),this},swap:function(a){return this.$el.toggleClass("yj-open",a),this.trigger(a?"open":"close"),a&&this._topicSelector&&this._topicSelector.focus(),g.trigger("/ui/lightbox/resize"),this},isOpen:function(){return this.$el.hasClass("yj-open")},enable:function(){return this._topicSelector&&this._topicSelector.enable(),this},disable:function(){return this._topicSelector&&this._topicSelector.disable(),this},_createChildren:function(){this._topicSelector=new i({collection:this.model.get("topics"),message:this.model}),this.add(this._topicSelector)},_setupListener:function(){this.listenTo(this.model,"clear",this.close),this.listenTo(this.model.get("topics"),"add",this.open),this.listenTo(this._topicSelector,"submit",this._notifyParent.bind(this,"submit"))},_notifyParent:function(){this.trigger.apply(this,arguments)},_onClickButton:function(a){a.preventDefault(),this.open()}})}),define("stache!feeds/lib/ui/publisher/global/standalone_popup_publisher",["mustache"],function(a){var b='<div class="yj-standalone-publisher-header" role="heading" aria-level="1">\n  <span class="yamicon-yam-spittle yamicon"></span> {{shareTitle}}\n</div>\n<div class="publisher-relative" role="main">\n  <div class="publisher-main">\n    <div class="publisher-body"></div>\n    <div class="publisher-recipients"></div>\n  </div>\n  <div class="publisher-warning"></div>\n  <div class="publisher-excerpt"></div>\n  <div class="publisher-actions">\n    <div class="publisher-topic"></div>\n    {{#networkLabel}}<div class="yj-standalone-publisher-network-name">{{networkLabel}}</div>{{/networkLabel}}\n    <div class="publisher-submit"></div>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/standalone_popup_publisher",[],function(){}),define("feeds/lib/ui/publisher/global/standalone_popup_publisher",["require","underscore","feeds/lib/ui/publisher/global/base_publisher","feeds/lib/ui/publisher/global/body_editor","models/message_backbone","feeds/lib/ui/publisher/global/recipient_selector_with_more","core/lib/report","core/lib/session","feeds/lib/ui/publisher/global/topic_menu","core/lib/tr","common-ui/lib/ui/shared/type_ahead","core/lib/uri_helper","feeds/lib/ui/publisher/global/privacy_warning","html!./standalone_popup_publisher","css!./standalone_popup_publisher"],function(a){var b=a("underscore"),c=a("feeds/lib/ui/publisher/global/base_publisher"),d=a("feeds/lib/ui/publisher/global/body_editor"),e=a("models/message_backbone"),f=a("feeds/lib/ui/publisher/global/recipient_selector_with_more"),g=a("core/lib/report"),h=a("core/lib/session"),i=a("feeds/lib/ui/publisher/global/topic_menu"),j=a("core/lib/tr"),k=a("common-ui/lib/ui/shared/type_ahead"),l=a("core/lib/uri_helper"),m=a("feeds/lib/ui/publisher/global/privacy_warning"),n=a("html!./standalone_popup_publisher");a("css!./standalone_popup_publisher");var o=e.TYPE,p={};return c.extend({defaults:function(){var a=b.object([[o.EMPTY,j.t("new_message")],[o.ALL_COMPANY,j.t("new_group_message")],[o.PUBLIC_GROUP,j.t("new_group_message")],[o.PRIVATE_GROUP,j.t("new_group_message")],[o.PRIVATE_GROUP_WITH_EXTERNAL,j.t("new_group_message")],[o.PRIVATE_MESSAGE,j.t("new_private_message_2")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,j.t("new_private_message_2")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,j.t("new_private_message_2")]]),c=b.object([[o.ALL_COMPANY,j.t("your_message_has_been_posted")],[o.PUBLIC_GROUP,j.t("your_message_has_been_posted")],[o.PRIVATE_GROUP,j.t("your_message_has_been_posted")],[o.PRIVATE_GROUP_WITH_EXTERNAL,j.t("your_message_has_been_posted")],[o.PRIVATE_MESSAGE,j.t("your_private_message_has_been_sent")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,j.t("your_private_message_has_been_sent")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,j.t("your_private_message_has_been_sent")]]),d=b.object([[o.ALL_COMPANY,j.t("your_message_could_not_be_posted")],[o.PUBLIC_GROUP,j.t("your_message_could_not_be_posted")],[o.PRIVATE_GROUP,j.t("your_message_could_not_be_posted")],[o.PRIVATE_GROUP_WITH_EXTERNAL,j.t("your_message_could_not_be_posted")],[o.PRIVATE_MESSAGE,j.t("your_private_message_could_not_be_sent")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,j.t("your_private_message_could_not_be_sent")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,j.t("your_private_message_could_not_be_sent")]]),e=b.object([[o.EMPTY,j.t("post")],[o.ALL_COMPANY,j.t("post")],[o.PUBLIC_GROUP,j.t("post")],[o.PRIVATE_GROUP,j.t("post")],[o.PRIVATE_GROUP_WITH_EXTERNAL,j.t("post")],[o.PRIVATE_MESSAGE,j.t("post")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,j.t("post")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,j.t("post")]]),f={titles:a,successes:c,errors:d,submit:e};return{icons:p,strings:f,allowAttachments:!1,showAlert:!0,inLightbox:!0,logType:"yam.ui.publisher.global.StandalonePublisher",logSource:"yammer_share"}},className:"yj-global-publisher yj-global-standalone-publisher yj-clearfix",template:n,initialize:function(){c.prototype.initialize.apply(this,arguments),this._reportLoadEvent()},render:function(){var a={shareTitle:j.t("share_on_yammer"),networkLabel:j.t("networkname_network",{networkName:h.getCurrentNetwork().name})};return this.renderTemplate(a),this},_reportLoadEvent:function(){var a={type:"loaded_share_popup",source:document.URL,publisher_source:"default",publisher_referrer:l.parse(document.referrer).host},c=l.parse(window.location).queryKey;b.has(c,"trk_event")&&(a.publisher_source=c.trk_event),g.event("yammer_standalone_publisher_loaded",a)},_createModel:function(){return new e({sender:h.getCurrentUser()})},_getEditorModel:function(){return this.model},_getEditorClass:function(){return d},_getSelectorClass:function(){return f},_getSelectorOptions:function(){return{typeaheadModels:[k.MODEL_GROUP,k.MODEL_USER,k.MODEL_PENDINGUSER,k.MODEL_DOMAIN]}},_getDropdownDirection:function(){return this._inLightbox?"up":"down"},_requiresGroup:function(){return!0},_createOther:function(){this._createTopicArea(),this._createWarningArea()},_createTopicArea:function(){this._topicMenu=new i({model:this.model,inLightbox:this._inLightbox}),this.add(this._topicMenu,".publisher-topic")},_createWarningArea:function(){this._privacyWarning=new m({model:this.model,inLightbox:this._inLightbox}),this.add(this._privacyWarning,".publisher-warning")}})}),define("workfeed/lib/app/views/messages/bookmarklet",["require","jquery","underscore","core/lib/backbone_base_class","models/group","models/recipient","models/message_backbone","core/lib/uri_helper","feeds/lib/ui/publisher/global/standalone_popup_publisher"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_class"),e=a("models/group"),f=a("models/recipient"),g=a("models/message_backbone"),h=a("core/lib/uri_helper"),i=a("feeds/lib/ui/publisher/global/standalone_popup_publisher");return d.extend({initialize:function(){var a=this._createStandalonePublisher();b("body").append(a.render().$el),this._publisher=a,this._publisher.show()},remove:function(){this.stopListening(),this._publisher.remove()},_getEventLogSource:function(){var a=h.parse(window.location).queryKey;return c.has(a,"trk_event")?a.trk_event:"default"},_createStandalonePublisher:function(){var a=this._getMessage(),b=new i({model:a,logSource:this._getEventLogSource()}),d=a.get("recipients"),g=f.fromOriginalModel(e.ALL_COMPANY());return this.listenTo(b,"show",d.add.bind(d,g)),this.listenTo(a,"clear",function(){b.show(),c.delay(window.close,2e3)}),b},_getMessage:function(){return new g({body:this._getBodyFromStatusParam()})},_getBodyFromStatusParam:function(){var a=h.parse(document.location.href).queryKey.status;return null!=a?decodeURIComponent(a):void 0}})}),define("stache!feeds/lib/ui/feeds/feed_title",["mustache"],function(a){var b='<span class="yj-feed-name">{{name}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/feeds/feed_title",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","html!./feed_title"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("backbone"),e=a("html!./feed_title");return b.extend({mixins:[c],tagName:"h2",className:"yj-home-feed-title header-content",template:e,initialize:function(a){this._feedName=a.feedName,this._feedDescription=a.feedDescription},getTemplateData:function(){return{name:this._feedName}},render:function(){var a=this.$el.find(".yj-feed-name"),b=this._feedDescription;return b?d.trigger("/ui/tooltip/add",{target:a,text:b}):a.css({cursor:"text"}),this}})}),define("stache!feeds/lib/ui/feeds/no_items_notice",["mustache"],function(a){var b="{{messageText}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/feeds/no_items_notice",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./no_items_notice"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("html!./no_items_notice");return b.extend({mixins:[c],className:"yj-message-list-notice yj-no-items-notice",template:d,getTemplateData:function(){return{messageText:this.options.messageText}}})}),define("css!components/notification_list/src/notification_list",[],function(){}),define("stache!components/notification_list/src/notification_list",["mustache"],function(a){var b='<div class="yj-list-wrapper">\n  <div class="yj-list-container yj-notification-list-container">\n    <div class="yj-notices-container">\n      {{#isLoading}}\n        <SpinnerView key="spinner" />\n      {{/isLoading}}\n      {{#isEmpty}}\n        <NoItemsNoticeView key="no-items-notice" />\n      {{/isEmpty}}\n    </div>\n    <ul class="yj-feed-notifications {{#isEmpty}}yj-empty{{/isEmpty}}">\n      {{#rollups}}\n        <NotificationListItemView key="{{.}}" />\n      {{/rollups}}\n    </ul>\n    {{#hasOlderItems}}\n      <MoreButtonView key="more-button" />\n    {{/hasOlderItems}}\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/notification_list/src/notification_list",["require","underscore","core/lib/tr","core/lib/yammer_uri","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/backbone_base_view","models/rollup","models/stream","feeds/lib/ui/feeds/spinner","feeds/lib/ui/feeds/no_items_notice","common-ui/lib/ui/shared/more_button","feeds/lib/ui/notifications/notification_list_item","models/lib/events","css!./notification_list","html!./notification_list"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/yammer_uri"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("core/lib/backbone_base_view"),h=a("models/rollup"),i=a("models/stream"),j=a("feeds/lib/ui/feeds/spinner"),k=a("feeds/lib/ui/feeds/no_items_notice"),l=a("common-ui/lib/ui/shared/more_button"),m=a("feeds/lib/ui/notifications/notification_list_item"),n=a("models/lib/events");return a("css!./notification_list"),g.extend({className:"yj-notification-list",mixins:[e,f],template:a("html!./notification_list"),views:{NotificationListItemView:"_getNotificationListItemView",MoreButtonView:"_getMoreButtonView",NoItemsNoticeView:"_getNoItemsNoticeView",SpinnerView:"_getSpinnerView"},initialize:function(){b.bindAll(this,"_onAfterProcess","_onRollupCreate"),this._getStream=b.memoize(this._getStream),this._isLoading=!0,this._rollups=[],this._listen()},getTemplateData:function(){var a=this._rollups.length>0;return{rollups:this._rollups,isLoading:this._isLoading,hasOlderItems:this._getStream().hasOlderAvailable(),isEmpty:!this._isLoading&&!a}},render:function(){var a=this._getNewestId();return a&&this._getStream().setLastSeen({id:a}),this},remove:function(){return this._getStream().unlisten(),this._getStream().destroy(),g.prototype.remove.call(this)},_getStream:function(){var a={url:d.api("streams/notifications"),type:"notifications"};return i.findOrCreate(a)},_getNotificationListItemView:function(a){var b=h.findById(a);return new m({data:b},this)},_getSpinnerView:function(){return new j({dontListen:!0})},_getMoreButtonView:function(){return this.moreButton=new l({renderVisible:!0}),this.listenTo(this.moreButton,"click",this._fetchOlderItems),this.moreButton},_getNoItemsNoticeView:function(){return new k({messageText:c.t("you_have_no_notifications_message_displayed_when_the_user_has_no_notifications")})},_getOldestId:function(){var a=this._rollups;return a&&a.length>0?b.last(this._rollups):!1},_getNewestId:function(){var a=this._rollups;return a&&a.length>0?b.first(this._rollups):!1},_fetchOlderItems:function(){this._getStream().fetchRollups({data:{older_than:this._getOldestId()||""}})},_listen:function(){var a=this._getStream();this.listenTo(a,"onAfterProcess",this._onAfterProcess),this.listenTo(n,"RollupStreamDelivery/"+a.id+"/create",this._onRollupCreate),a.listen()},_onRollupCreate:function(a){this._rollups.push(a.id)},_onAfterProcess:function(){this._isLoading=!1,this.render()}})}),define("components/notification_list/index",["require","./src/notification_list"],function(a){"use strict";var b=a("./src/notification_list");return b}),define("stache!workfeed/lib/app/views/notifications/index",["mustache"],function(a){var b='<div class="page-header" role="region" style="display: block">\n  <FeedTitle key="feed-title"/>\n</div>\n<NotificationList key="notification-list"/>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/notifications/index",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","feeds/lib/ui/feeds/feed_title","components/notification_list/index","workfeed/lib/app/helpers/layout","feeds/lib/ui/util/title_updater","core/lib/tr","html!./index"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("feeds/lib/ui/feeds/feed_title"),f=a("components/notification_list/index"),g=a("workfeed/lib/app/helpers/layout"),h=a("feeds/lib/ui/util/title_updater"),i=a("core/lib/tr"),j=a("html!./index");return c.extend({mixins:[b,d],template:j,className:g.twoColumnMainClass,attributes:{role:"main"},views:{FeedTitle:"_createFeedTitle",NotificationList:"_createNotificationList"},headerNavigationTab:"notifications",initialize:function(){h.setTitle(i.t("notifications"))},_createFeedTitle:function(){return new e({feedName:i.t("notifications"),feedDescription:i.t("this_feed_shows_your_notifications")})},_createNotificationList:function(){return new f}})}),define("stache!components/address_book_importer/src/address_book_importer_step1",["mustache"],function(a){var b='<form class="yj-address-book-importer--step-1-form" accept-charset="UTF-8" action="{{webUrl}}/email_import/process_outlook.js" enctype="multipart/form-data" method="post" target="csv-iframe">\n  <input name="utf8" type="hidden" value="✓" />\n  <input name="authenticity_token" type="hidden" value="{{authToken}}" />\n  <div id="csv-upload-container-form">\n    <input id="invite_section" name="invite_section" type="hidden" value="" />\n    <input id="invite_source" name="invite_source" type="hidden" value="" />\n\n    <input id="community" name="community" type="hidden" value="{{isCommunity}}">\n    <!-- WHAT IS THIS? -->\n    <input id="include_members" name="include_members" type="hidden" value="false">\n\n    <p>{{{csvImportHelp}}}</p>\n\n    <table role="presentation">\n      <tbody>\n        <tr>\n          <th role="presentation"><label for="csv_file">{{fileLocationLabel}}</label></th>\n          <td><input class="yj-address-book-importer--file-input file-input" id="csv_file" name="csv_file" type="file"></td>\n        </tr>\n        <tr>\n          <th role="presentation"></th>\n          <td>\n            <button type="submit" class="yj-address-book-importer--preview yj-btn yj-btn-disabled preview-btn" disabled>{{previewLabel}}</button>\n            <span class="secondary-actions">{{{orCancel}}}</span>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</form>\n<iframe src="javascript:false" name="csv-iframe" id="csv-iframe" class="yj-address-book-importer--iframe" style="display: none"></iframe>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/address_book_importer/src/address_book_importer_step1",["require","core/lib/tr","core/lib/util/authenticity_token","core/lib/session","backbone","core/lib/namespace","common-ui/lib/helper/ui","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/urls","html!./address_book_importer_step1"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/util/authenticity_token"),d=a("core/lib/session"),e=a("backbone"),f=a("core/lib/namespace"),g=a("common-ui/lib/helper/ui"),h=a("core/lib/backbone_base_view"),i=a("core/lib/backbone_with_auto_render"),j=a("core/lib/urls"),k=h.extend({mixins:[i],className:"yj-address-book-importer--step-1",template:a("html!./address_book_importer_step1"),events:{"submit .yj-address-book-importer--step-1-form":"formSubmitted","change .yj-address-book-importer--file-input":"checkFormValid"},initialize:function(){this.listenTo(e,"processImport",this.processImport)},checkFormValid:function(){var a=this.hasFileSelected();a?g.enableButton(this.$(".yj-address-book-importer--preview")):g.disableButton(this.$(".yj-address-book-importer--preview"))},hasFileSelected:function(){var a=this.$(".yj-address-book-importer--file-input");return a.get(0).files?a.get(0).files.length>0:a.val().length>0},processImport:function(a){return a.length<=0?void this.options.mediator.trigger("setState","has-no-contacts"):(this.options.mediator.trigger("populateImport",a),void this.options.mediator.trigger("setState","is-step-2"))},getTemplateData:function(){var a=j.networkIndex(d.getCurrentNetwork());return{webUrl:a,authToken:c.get(),isCommunity:d.getCurrentNetwork().community,csvImportHelp:b.t("csv_import_help",{link:'<a href="'+a+'/email_import/csv_import_help">{$0}</a>'}),processingLabel:b.t("processing"),previewLabel:b.t("preview"),fileLocationLabel:b.t("file_location"),orCancel:b.t("or_cancel",{link:'<a href="javascript://" class="cancel-colorbox">{$0}</a>'})}},formSubmitted:function(){this.options.mediator.trigger("setState","is-loading"),g.disableButton(this.$(".yj-address-book-importer--preview"))}},{triggerImportEvent:function(a){e.trigger("processImport",a)}});return f.ns("yam.workfeed.CSVImporter"),yam.workfeed.CSVImporter.handleUploaded=k.triggerImportEvent,k}),define("stache!components/address_book_importer/src/address_book_importer_step2",["mustache"],function(a){var b='<form accept-charset="UTF-8" action="{{webUrl}}/email_import/process_invite" class="yj-address-book-importer--step-2-form" method="post">\n  <input name="utf8" type="hidden" value="✓">\n  <input name="authenticity_token" type="hidden" value="{{authToken}}">\n  <input id="invite_section" name="invite_section" type="hidden" value="send_outlook_invite">\n  <input id="invite_source" name="invite_source" type="hidden" value="invite_users_addressbook_csv">\n  <input id="email_addresses_provided" name="email_addresses_provided" type="hidden">\n  <p><span class="contact-count">{{contactCountLabel}}</span></p>\n  <ul class="horz-menu piped">\n    <li class="first"><a href="javascript://" role="button" class="yj-address-book-importer--select-all">{{selectAllLabel}}</a></li>\n    <li class="last"><a href="javascript://" role="button" class="yj-address-book-importer--select-none">{{selectNoneLabel}}</a></li>\n  </ul>\n  <div class="contact-list-container">\n    <table class="grid yj-address-book-importer--contact-list">\n      {{#emails}}\n        {{#is_member}}\n        <tr class="yj-address-book-importer--import-row">\n          <td class="yj-address-book-importer--import-member"><img src="{{checkedImage}}" width="16" height="16" /></td>\n          <td class="yj-address-book-importer--import-name name">{{name}} <span class="member-status">({{joinedLabel}})</span></td>\n          <td class="yj-address-book-importer--import-address address" data-email-address="{{address}}">{{address}}</td>\n        </tr>\n        {{/is_member}}\n        {{#is_valid}}\n        <tr class="yj-address-book-importer--import-row">\n          <td class="yj-address-book-importer--import-valid"><input id="coworkers-{{key}}" type="checkbox" class="yj-address-book-importer--contact-input checkbox" name="coworkers[]" value="{{address}}" {{#checked_by_default}}checked{{/checked_by_default}} /></td>\n          <td class="yj-address-book-importer--import-name name"><label for="coworkers-{{key}}">{{name}}</label></td>\n          <td class="yj-address-book-importer--import-address address" data-email-address="{{address}}">{{address}}</td>\n        </tr>\n        {{/is_valid}}\n        {{#is_rejected}}\n        <tr class="yj-address-book-importer--import-row">\n          <td class="yj-address-book-importer--import-rejected rejected"><img src="{{rejectedImage}}" width="16" height="16" /></td>\n          <td class="yj-address-book-importer--import-name name"><label for="coworkers-{{key}}">{{name}}</label></td>\n          <td class="yj-address-book-importer--import-address address" data-email-address="{{address}}">{{address}}</td>\n        </tr>\n        {{/is_rejected}}\n      {{/emails}}\n    </table>\n  </div>\n  <button id="invite-csvimport-send-button" type="submit" class="yj-address-book-importer--import yj-btn">\n    <span></span>\n  </button>\n  <span class="secondary-actions">{{{orCancel}}}</span>\n</form>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/address_book_importer/src/address_book_importer_step2",["require","underscore","core/lib/tr","core/lib/session","core/lib/util/authenticity_token","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/urls","core/lib/yammer_uri","core/lib/ajax_form","html!./address_book_importer_step2"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("core/lib/util/authenticity_token"),f=a("backbone"),g=a("core/lib/backbone_base_view"),h=a("core/lib/backbone_with_auto_render"),i=a("core/lib/urls"),j=a("core/lib/yammer_uri");return a("core/lib/ajax_form"),g.extend({mixins:[h],className:"yj-address-book-importer--step-2",template:a("html!./address_book_importer_step2"),events:{"submit .yj-address-book-importer--step-2-form":"submit","click .yj-address-book-importer--select-none":"selectNone","click .yj-address-book-importer--select-all":"selectAll","change .yj-address-book-importer--contact-input":"updateSelectionCount"},initialize:function(){this.is_community=d.getCurrentNetwork().community,this.listenTo(this.options.mediator,"populateImport",this.populateImportList)},render:function(){return this.updateSelectionCount(),f.trigger("/ui/tooltip/add",{target:this.$el.find("td.rejected"),text:c.t("this_email_address_is_not_allowed")}),this.is_community||this.$(".yj-address-book-importer--step-2-form").ajaxForm({validationCallback:this.inviteSubmitValidator.bind(this)}),this},getTemplateData:function(){return{checkedImage:j.cdn("assets/images/check.gif"),rejectedImage:j.cdn("assets/images/x_red.gif"),webUrl:i.networkIndex(d.getCurrentNetwork()),authToken:e.get(),contactCountLabel:c.t("weve_found_count_people_in_your_contact_list_select",{count:this.emails?this.emails.length:0}),selectAllLabel:c.t("select_all"),selectNoneLabel:c.t("select_none"),joinedLabel:c.t("joined"),emails:this.emails,orCancel:c.t("or_cancel",{link:'<a href="javascript://" class="cancel-colorbox">{$0}</a>'})}},selectNone:function(){this.$(".yj-address-book-importer--contact-input").prop("checked",!1),this.updateSelectionCount()},selectAll:function(){this.$(".yj-address-book-importer--contact-input").prop("checked",!0),this.updateSelectionCount()},updateSelectionCount:function(){var a=this.getCheckedContactsCount();a>0?this.$(".yj-address-book-importer--import").text(c.t("send_count_invitations",{count:a})).removeClass("yj-btn-disabled"):this.$(".yj-address-book-importer--import").text(c.t("send_count_invitations",{count:0})).addClass("yj-btn-disabled")},getCheckedContactsEmails:function(){return this.$(".yj-address-book-importer--contact-input:checked").map(function(){return $(this).val()}).get().join(", ")},getCheckedContactsCount:function(){return this.$(".yj-address-book-importer--contact-input:checked").length},submit:function(a){this.inviteSubmitValidator()||a.preventDefault(),this.is_community&&(f.trigger("localImportAddress",this.getCheckedContactsEmails()),a.preventDefault()),setTimeout(this.inviteSuccess.bind(this),300)},inviteSubmitValidator:function(){var a=this.getCheckedContactsCount();return 0===a?(f.trigger("/ui/alert/show","error",c.t("please_select_some_users_to_invite")),!1):!0},populateImportList:function(a){this.processEmails(a),this.render()},processEmails:function(a){this.emails=a,b.each(this.emails,function(a){a.member?a.is_member=!0:void 0===a.valid||a.valid?a.is_valid=!0:a.is_rejected=!0,a.checked_by_default=!this.is_community},this)},inviteSuccess:function(){f.trigger("/ui/lightbox/close"),this.options.mediator.trigger("reset")}})}),define("css!components/address_book_importer/src/address_book_importer",[],function(){}),define("stache!components/address_book_importer/src/address_book_importer",["mustache"],function(a){var b='<div class="yj-address-book-importer--content tabs-content">\n  <div class="yj-address-book-importer--steps-container">\n    <Step1ImporterView key="step-1" />\n    <Step2ImporterView key="step-2" />\n    <div class="yj-address-book-importer--no-contacts">\n      <p class="yj-address-book-importer--no-contacts-message">{{noValidContactsMessage}}</p>\n      <span class="secondary-actions">\n        <a class="yj-address-book-importer--import-another yj-btn" href="javascript://" role="button">\n          <span>{{importFromAnotherAddressBookMessage}}</span>\n        </a>\n      </span>\n      <span class="secondary-actions">\n        {{{orCancel}}}\n      </span>\n    </div>\n  </div>\n  <div class="yj-address-book-importer--spinner">\n    <div class="yj-address-book-importer--spinner-image yj-spinner-loading">{{processingLabel}}</div>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/address_book_importer/src/address_book_importer",["require","core/lib/backbone_base_class","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","backbone","core/lib/tr","core/lib/session","./address_book_importer_step1","./address_book_importer_step2","core/lib/ajax_form","css!./address_book_importer","html!./address_book_importer"],function(a){"use strict";var b=a("core/lib/backbone_base_class"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("backbone"),g=a("core/lib/tr"),h=a("core/lib/session"),i=a("./address_book_importer_step1"),j=a("./address_book_importer_step2");return a("core/lib/ajax_form"),a("css!./address_book_importer"),c.extend({id:"import-address-book-lightbox",className:"yj-address-book-importer is-step-1",mixins:[d,e],template:a("html!./address_book_importer"),views:{Step1ImporterView:"_getStep1Importer",Step2ImporterView:"_getStep2Importer"},events:{"click .yj-address-book-importer--import-another":"reset"},initialize:function(){this.mediator=new b,this.listenTo(this.mediator,"reset",this.reset),this.listenTo(this.mediator,"setState",this.setState),f.on("/ui/lightbox/closed",this.reset,this)},getTemplateData:function(){return{noValidContactsMessage:g.t("no_valid_contacts_import",{network:h.getCurrentNetwork().permalink}),importFromAnotherAddressBookMessage:g.t("import_from_another_address_book"),orCancel:g.t("or_cancel",{link:'<a href="javascript://" class="cancel-colorbox">{$0}</a>'})}},_getStep1Importer:function(){return this.step1=this._getImporter(i),this.step1},_getStep2Importer:function(){return this.step2=this._getImporter(j),this.step2},_getImporter:function(a){var b=new a({mediator:this.mediator});return b},reset:function(){this.$("form").each(function(){this.reset()}),this.setState("is-step-1")},remove:function(){return f.off("/ui/lightbox/closed",this.reset,this),c.prototype.remove.call(this)},setState:function(a){this.$el.removeClass("is-step-1 is-step-2 has-no-contacts is-loading").addClass(a),this.resizeImportAddressLightbox()},resizeImportAddressLightbox:function(){
f.trigger("/ui/lightbox/resize",{transition:"none"})}})}),define("components/address_book_importer/index",["require","./src/address_book_importer"],function(a){"use strict";return a("./src/address_book_importer")}),define("css!components/invitation_by_email_input/src/invitation_by_email_input",[],function(){}),define("stache!components/invitation_by_email_input/src/invitation_by_email_input",["mustache"],function(a){var b='<div class="yj-invitation-by-email-input--domain-container">\n  <label>\n    <span class="yj-acc-hidden">{{user_label}} {{index}}</span>\n    <input data-qaid="invite-address-field" type="text" class="yj-invitation-by-email-input--user-value medium email partial" name="usernames[]" id="usernames_" {{#placeholder}}placeholder="{{placeholder}}"{{/placeholder}} />\n  </label>\n  {{^is_multiple_domains}}\n    {{#domains}}\n      <strong title="{{domain}}">\n        @ {{domain}}\n        <input type="hidden" class="yj-invitation-by-email-input--domain-value" value="{{domain}}" name="domains[]" id="domains_" />\n      </strong>\n    {{/domains}}\n  {{/is_multiple_domains}}\n  {{#is_multiple_domains}}\n    @\n    <label>\n      <span class="yj-acc-hidden">{{domain_label}} {{index}}</span>\n      <select name="domains[]" id="domains_" class="yj-invitation-by-email-input--domain-value">\n      {{#domains}}\n        <option value="{{domain}}">{{domain}}</option>\n      {{/domains}}\n      </select>\n    </label>\n  {{/is_multiple_domains}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/invitation_by_email_input/src/invitation_by_email_input",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","css!./invitation_by_email_input","html!./invitation_by_email_input"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/tr");return a("css!./invitation_by_email_input"),c.extend({mixins:[d],tagName:"li",template:a("html!./invitation_by_email_input"),className:"yj-invitation-by-email-input is-appended",events:{"input .yj-invitation-by-email-input--user-value":"_triggerValueChange"},getTemplateData:function(){return{domain_label:e.t("domain"),user_label:e.t("user"),domains:this.options.domains,placeholder:this.options.placeholder,is_multiple_domains:this.options.domains.length>1,index:this.options.index}},value:function(){var a=this.$(".yj-invitation-by-email-input--user-value");return a.val.apply(a,arguments)},getEmailAddress:function(){var a=this.value();return a.length<=0?"":a+"@"+this.$(".yj-invitation-by-email-input--domain-value").val()},render:function(){return b.defer(b.bind(function(){this.$el.removeClass("is-appended")},this)),this},_triggerValueChange:function(){this.trigger("valueChange")}})}),define("components/invitation_by_email_input/index",["require","./src/invitation_by_email_input"],function(a){"use strict";return a("./src/invitation_by_email_input")}),define("stache!components/invitations_by_email/src/invitations_by_email",["mustache"],function(a){var b='{{^is_community}}\n  {{#is_loading}}\n    <SpinnerView key="spinner" />\n  {{/is_loading}}\n  {{^is_loading}}\n    <ul id="email-form" class="yj-invitations-by-email--fields">\n      {{#fields}}\n        <InvitationByEmailInputView key="{{id}}" />\n      {{/fields}}\n    </ul>\n    <button type="submit" data-qaid="invite-user-button" class="yj-invitations-by-email--submit yj-btn yj-btn-disabled" disabled>{{invite_label}}</button>\n  {{/is_loading}}\n{{/is_community}}\n{{#is_community}}\n  <label>\n    <span class="yj-acc-hidden">{{enter_list_comma_separated_emails_label}}</span>\n    <textarea class="yj-invitations-by-email--textarea email-list water-marked super-wide" id="addresses" name="addresses" title="{{enter_list_comma_separated_emails_label}}" placeholder="{{enter_list_comma_separated_emails_label}}"></textarea>\n  </label>\n  <p class="yj-invitations-by-email--address-book address-book">\n    <a href="#yj-invitations-title--import-lightbox" class="yj-invitations-title--import-link tightbox"\n   data-lightbox-class="shaded" title="{{import_from_address_book}}">{{import_from_address_book}}</a>\n  </p>\n  <div class="buttons">\n    <button type="submit" class="yj-invitations-by-email--submit yj-btn yj-btn-disabled" disabled>{{add_label}}</button>\n  </div>\n  <p class="help">{{csv_import_help_en_label}}</p>\n{{/is_community}}\n\n<div class="colorbox-wrap">\n  <div class="yj-invitations-title--import-lightbox" id="yj-invitations-title--import-lightbox">\n    <AddressBookImporterView key="address-book-import" />\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/invitations_by_email/src/invitations_by_email",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","core/lib/session","backbone","core/lib/yammer_api","core/lib/yammer_uri","core/lib/string_helper","core/lib/yammer_request","components/address_book_importer/index","components/invitation_by_email_input/index","common-ui/lib/ui/shared/spinner","html!./invitations_by_email"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g=a("core/lib/session"),h=a("backbone"),i=a("core/lib/yammer_api"),j=a("core/lib/yammer_uri"),k=a("core/lib/string_helper"),l=a("core/lib/yammer_request"),m=a("components/address_book_importer/index"),n=a("components/invitation_by_email_input/index"),o=a("common-ui/lib/ui/shared/spinner");return c.extend({tagName:"form",mixins:[d,e],template:a("html!./invitations_by_email"),views:{SpinnerView:"_getSpinnerView",InvitationByEmailInputView:"_getInvitationByEmailInput",AddressBookImporterView:"_getAddressBookImporter"},events:{submit:"submit","input .yj-invitations-by-email--textarea":"_checkFormValue"},attributes:function(){return{"accept-charset":"UTF-8",action:j.app("/invitations/emails.js"),method:"post"}},initialize:function(){this.is_community=g.getCurrentNetwork().community,this.is_loading=!0,this.INITIAL_FIELDS=this.is_community?0:6,this.fieldsCounter=0,this.fields=[],this.is_community?this.listenTo(h,"localImportAddress",this.fillImportAddresses):i.getNetworkDomains().then(this.processDomains.bind(this))},submit:function(a){a&&a.preventDefault();var c=this.getAddresses();c.length<=0||(this.disableSubmit(),l.send({url:j.app("/invitations/emails.js"),method:"post",data:{addresses:this.getAddresses(),invite_source:this.is_community?"invite_community_users":"invite_users",invite_section:"invitations_page"},complete:b.bind(function(a){var b=a.responseJSON;if(b.error){if(h.trigger("/ui/alert/show","error",b.error),b.payload)if(this.is_community){var c=b.payload.invalid_emails?b.payload.invalid_emails.join(", "):"";this.$(".yj-invitations-by-email--textarea").val(c)}else this.clearValidEmails(b.payload.valid_emails);this.trigger("error")}else if(b.notice){var d=this._getSuccessMessage(b);h.trigger("/ui/alert/show","notice",d),this.resetForm(),this.trigger("success")}},this)}))},clearValidEmails:function(a){b.each(this.fields,function(c){var d=b.includes(a,c.component.getEmailAddress());d&&c.component.value("")})},fillImportAddresses:function(a){this.$(".yj-invitations-by-email--textarea").val(a),this._checkFormValue()},getAddresses:function(){return this.is_community?this.$(".yj-invitations-by-email--textarea").val():b.reduce(this.fields,function(a,b){var c=b.component.getEmailAddress();if(c.length<=0)return a;var d=""===a?a:a+",";return d+c},"")},disableSubmit:function(){var a=this.$(".yj-invitations-by-email--submit");a.addClass("yj-btn-disabled").prop("disabled",!0)},enableSubmit:function(){var a=this.$(".yj-invitations-by-email--submit");a.removeClass("yj-btn-disabled").prop("disabled",!1)},getTemplateData:function(){return{is_loading:this.is_loading,is_community:this.is_community,add_label:f.t("add"),enter_list_comma_separated_emails_label:f.t("enter_list_comma_separated_emails"),csv_import_help_en_label:f.t("csv_import_help_en"),import_from_address_book:f.t("import_from_address_book"),invite_label:this._getInviteLabel(),fields:this.fields}},processDomains:function(a){this.is_loading=!1,this.domains=a,this.initializeFields()},initializeFields:function(){b.times(this.INITIAL_FIELDS,this.addField,this),this.render()},addField:function(){var a=this.fieldsCounter,b={id:a,component:this._instantiateInvitationByEmailInput(a+1)};return this.fields.push(b),this.fieldsCounter+=1,b},resetForm:function(){return this.is_community?void this.$(".yj-invitations-by-email--textarea").val(""):(b.chain(this.fields).map(function(a){return a.component}).invoke("remove"),this.fields=[],void this.initializeFields())},_checkFormValue:function(){this.getAddresses().length>0?this.enableSubmit():this.disableSubmit(),this.is_community||this._checkGrowForm()},_getPopulatedFieldsLength:function(){var a=b.filter(this.fields,function(a){return k.trim(a.component.value())});return a.length},_checkGrowForm:function(){var a=b.last(this.fields),c=k.trim(a.component.value());if(c.length>0){var d=this.addField();this.$(".yj-invitations-by-email--fields").append(d.component.render().el)}},_getSpinnerView:function(){return new o},_instantiateInvitationByEmailInput:function(a){var b=new n({domains:this.domains,placeholder:this.options.emailInputPlaceholder,index:a});return this.listenTo(b,"valueChange",this._checkFormValue),b},_getInvitationByEmailInput:function(a){var c=b.findWhere(this.fields,{id:parseInt(a,10)});return c.component},_getAddressBookImporter:function(){return new m},_getInviteLabel:function(){return this.options.inviteLabel?this.options.inviteLabel:f.t("invite")},_getSuccessMessage:function(a){return this.options.successMessage?this.options.successMessage:a.notice}})}),define("components/invitations_by_email/index",["require","./src/invitations_by_email"],function(a){"use strict";return a("./src/invitations_by_email")}),define("css!components/reinvite_all/src/invite_all",[],function(){}),define("stache!components/reinvite_all/src/invite_all",["mustache"],function(a){var b='<div class="yj-invite-all">\n  <button type="submit" class="single-submit yj-btn yj-btn-secondary yj-invite-all--invite">\n    {{inviteThem}}\n  </button>\n  <div class="invitee-count yj-invite-all--invitee-count">\n    {{inviteeCount}}\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("components/reinvite_all/src/invite_all",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","backbone","core/lib/tr","core/lib/yammer_api","css!./invite_all","html!./invite_all"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("backbone"),e=a("core/lib/tr"),f=a("core/lib/yammer_api");a("css!./invite_all");var g={INVITE_ALL_BTN:".yj-invite-all--invite"};return c.extend({mixins:[b],template:a("html!./invite_all"),getTemplateData:function(){return{inviteeCount:e.t("count_people",{count:this._invitableCount}),inviteThem:e.t("invite_them")}},events:{"click .yj-invite-all--invite":"_inviteAll"},initialize:function(a){this._invitableCount=a.invitableCount||0},_inviteAll:function(){this._handleInviteSuccess(),this._setInviteBtnEnabled(!1),f.inviteAllToNetwork({invite_source:"resend_all_button"}).then(this._handleInviteSuccess.bind(this),this._handleInviteFailure.bind(this))},_handleInviteSuccess:function(){d.trigger("/ui/lightbox/close"),d.trigger("/reinvite_all/invite_all")},_handleInviteFailure:function(){d.trigger("/ui/alert/show","error",e.t("there_was_an_error")),this._setInviteBtnEnabled(!0)},_setInviteBtnEnabled:function(a){var b=this.$(g.INVITE_ALL_BTN);a?b.removeClass("yj-btn-disabled").attr("disabled",""):b.addClass("yj-btn-disabled").attr("disabled",!0)}})}),define("css!components/reinvite_all/src/invite_contact",[],function(){}),define("stache!components/reinvite_all/src/invite_contact",["mustache"],function(a){var b='<span class="v-align-middle yj-invite-contact--name">{{name}}</span>\n<span class="v-align-middle yj-invite-contact--email">{{email}}</span>\n<div class="v-align-middle yj-invite-contact--invite-control">\n  <button type="submit" class="yj-btn single-submit yj-invite-contact--invite-btn">{{invite}}</button>\n</span>';return a.parse(b),function(c){return a.render(b,c)}}),define("components/reinvite_all/src/invite_contact",["require","jquery","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","backbone","core/lib/string_helper","core/lib/tr","core/lib/yammer_api","css!./invite_contact","html!./invite_contact"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("backbone"),f=a("core/lib/string_helper"),g=a("core/lib/tr"),h=a("core/lib/yammer_api");a("css!./invite_contact");var i={INVITE_BTN:".yj-invite-contact--invite-btn"};return d.extend({mixins:[c],template:a("html!./invite_contact"),getTemplateData:function(){return{name:f.truncate(this._name,20),email:f.truncate(this._email,30),invite:g.t("invite")}},events:{"click .yj-invite-contact--invite-control":"_invite"},className:"yj-invite-contact",initialize:function(a){this._name=a.name||"",this._email=a.email||""},_invite:function(){this._setInviteBtnEnabled(!1),h.inviteToNetwork({invite_section:"network_contacts",addresses:this._email}).then(this._handleInviteSuccess.bind(this),this._handleInviteFailure.bind(this))},_handleInviteSuccess:function(){this.$el.fadeOut(500,function(){b(this).remove()})},_handleInviteFailure:function(){e.trigger("/ui/alert/show","error",g.t("there_was_an_error")),this._setInviteBtnEnabled(!0)},_setInviteBtnEnabled:function(a){var b=this.$(i.INVITE_BTN);a?b.removeClass("yj-btn-disabled"):b.addClass("yj-btn-disabled")}})}),define("css!components/reinvite_all/src/invite_contact_list",[],function(){}),define("stache!components/reinvite_all/src/invite_contact_list",["mustache"],function(a){var b='<div class="yj-invite-contact-list--contacts">\n  {{#contacts}}\n    <InviteContact key="{{ndx}}" />\n  {{/contacts}}\n</div>\n\n<div class="yj-invite-contact-list--more">\n  <a href="#" class="yj-btn yj-btn-alt yj-btn-wide yj-invite-contact-list--more-btn" role="button"><span>{{more}}</span></a>\n</div>\n\n<div class="yj-invite-contact-list--loading is-hidden">\n  <Spinner />\n</div>\n\n<div class="yj-invite-contact-list--no-results is-hidden">\n  <span>{{no_colleagues_found}}</span>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("components/reinvite_all/src/invite_contact_list",["require","jquery","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","./invite_contact","common-ui/lib/ui/shared/spinner","core/lib/backbone_with_subviews","core/lib/tr","core/lib/yammer_api","css!./invite_contact_list","html!./invite_contact_list"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("./invite_contact"),f=a("common-ui/lib/ui/shared/spinner"),g=a("core/lib/backbone_with_subviews"),h=a("core/lib/tr"),i=a("core/lib/yammer_api");a("css!./invite_contact_list");var j={CONTACT_LIST:".yj-invite-contact-list--table",MORE:".yj-invite-contact-list--more",LOADING:".yj-invite-contact-list--loading",NO_RESULTS:".yj-invite-contact-list--no-results"};return d.extend({mixins:[c,g],template:a("html!./invite_contact_list"),views:{InviteContact:"_getInviteContact",Spinner:"_getSpinner"},getTemplateData:function(){return{contacts:this._contacts,more:h.t("more"),noColleaguesFound:h.t("no_colleagues_found")}},events:{"click .yj-invite-contact-list--more-btn":"_loadMoreResults"},className:"yj-invite-contact-list",initialize:function(){this._perPage=20,this._page=1,this._loading=!1,this._currentRequest=null,this._filter="",this._contacts=[]},_getInviteContact:function(a){var b=this._contacts[a];return new e({name:b.name,email:b.email})},_getSpinner:function(){return new f},_loadMoreResults:function(){this._page++,this.loadContacts(this._filter)},loadContacts:function(a){this._currentRequest&&this._currentRequest.abort(),this._filter=a;var b=this.$(j.MORE),c=this.$(j.LOADING),d=this.$(j.NO_RESULTS);this._setEltDisplayed(b,!1),this._setEltDisplayed(c,!0),this._setEltDisplayed(d,!1),i.getInvitableContactsForNetwork({page:this._page,name:this._filter}).then(this._handleLoadContactsSuccess.bind(this))},_handleLoadContactsSuccess:function(a){if(a){var b=this.$(j.MORE),c=this.$(j.LOADING),d=this.$(j.NO_RESULTS);1===this._page&&this.reset(),this._addContacts(a.results);var e=a.total_results,f=Math.ceil(e/this._perPage);0===a.results.length&&this._setEltDisplayed(d,!0),this._page>=f?this._setEltDisplayed(b,!1):this._setEltDisplayed(b,!0),this._setEltDisplayed(c,!1),this._currentRequest=null}},_addContacts:function(a){var c=this._contacts.length;b.each(a,function(a,b){this._contacts.push({ndx:c+a,name:b.display_name,email:b.address})}.bind(this)),this.render()},reset:function(){this._contacts=[],this._page=1,this.render()},_setEltDisplayed:function(a,b){b?a.removeClass("is-hidden"):a.addClass("is-hidden")}})}),define("css!components/reinvite_all/src/reinvite_all",[],function(){}),define("stache!components/reinvite_all/src/reinvite_all",["mustache"],function(a){var b='<div class="yj-reinvite-all--search-container">\n  <label><span class="yj-acc-hidden">{{search}}</span>\n    <input class="water-marked yj-reinvite-all--search" name="search" value="" title="{{search}}" autocomplete="off" />\n  </label>\n  <span class="yamicon yamicon-search yj-dark-gray-light yj-flip-x yj-reinvite-all--search-icon"></span>\n</div>\n<InviteContactList key="invite-contact-list" />\n<div class="yj-reinvite-all--footer-controls">\n  <!-- Invite all contacts. -->\n  {{#showAvalanceButton}}\n    <InviteAll />\n  {{/showAvalanceButton}}\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("components/reinvite_all/src/reinvite_all",["require","underscore","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","./invite_all","./invite_contact_list","core/lib/backbone_with_subviews","backbone","core/lib/tr","css!./reinvite_all","html!./reinvite_all"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("./invite_all"),f=a("./invite_contact_list"),g=a("core/lib/backbone_with_subviews"),h=a("backbone"),i=a("core/lib/tr");a("css!./reinvite_all");var j={REINVITE_ALL_SEARCH:".yj-reinvite-all--search",TABLE_CONTACT_LIST:".yj-reinvite-all--contact-list",TABLE_CONTACT_LIST_LOADING:".yj-reinvite-all--contact-list-loading",TABLE_CONTACT_LIST_MORE:".yj-reinvite-all--more",TABLE_CONTACT_LIST_NO_RESULTS:".yj-reinvite-all--contact-list-no-results"};return d.extend({mixins:[c,g],template:a("html!./reinvite_all"),getTemplateData:function(){return{showAvalanceButton:this._showAvalanceButton,search:i.t("search")}},views:{InviteAll:"_getInviteAll",InviteContactList:"_getInviteContactList"},events:{"click .yj-reinvite-all--search-icon":"_handleSearchClick","keyup .yj-reinvite-all--search":"_updateSearchParams"},className:"yj-reinvite-all",initialize:function(a){this._showAvalanceButton=a.showAvalanceButton||!1,this._invitableCount=a.invitableCount||0,this._searchInput=""},remove:function(){return h.off("/ui/lightbox/open",this._handleLightboxOpen,this),h.off("/ui/lightbox/close",this._handleLightboxClose,this),d.prototype.remove.call(this)},_getInviteAll:function(){return new e({invitableCount:this._invitableCount})},_getInviteContactList:function(){return this._inviteContactList=new f,h.on("/ui/lightbox/open",this._handleLightboxOpen,this),h.on("/ui/lightbox/close",this._handleLightboxClose,this),this._inviteContactList},_handleLightboxOpen:function(){this._searchInput="",this._inviteContactList.reset(),this._inviteContactList.loadContacts()},_handleLightboxClose:function(){this.$(j.REINVITE_ALL_SEARCH).val("").trigger("blur"),this._inviteContactList.reset()},_updateSearchParams:function(a){var b=a.keyCode?a.keyCode:a.which;13===b?this._delay(this.bind(this),0):this._delay(this._search.bind(this),1e3)},_handleSearchClick:function(){b.defer(this._search.bind(this))},_search:function(){this._page=1;var a=this.$(j.REINVITE_ALL_SEARCH).val();a!==this._searchInput&&"Search"!==a&&(this._searchInput=a,this._inviteContactList.reset(),this._inviteContactList.loadContacts(a))}})}),define("components/reinvite_all/index",["require","./src/reinvite_all"],function(a){"use strict";return a("./src/reinvite_all")}),define("css!components/network_pending_invitations/src/network_pending_invitations",[],function(){}),define("stache!components/network_pending_invitations/src/network_pending_invitations",["mustache"],function(a){var b='{{^tow_header_standardization}}\n<p>\n  <span class="yj-network-pending-invitations--invitable-count"></span>\n</p>\n\n<div class="notice-btn">\n  <a role="button" class="yj-btn yj-btn-secondary yj-network-pending-invitations--open-lightbox" title="{{inviteYourCoworkers}}"><span>{{inviteThem}}</span></a>\n</div>\n{{/tow_header_standardization}}\n{{#tow_header_standardization}}\n<span class="yj-network-pending-invitations--invitable-count"></span>\n<a role="button" class="yj-btn yj-btn-alt yj-network-pending-invitations--invite-btn yj-network-pending-invitations--open-lightbox" title="{{inviteYourCoworkers}}"><span>{{inviteThem}}</span></a>\n{{/tow_header_standardization}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/network_pending_invitations/src/network_pending_invitations",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","common-ui/lib/ui/general/lightbox_manager","components/reinvite_all/index","core/lib/location_helper","backbone","core/lib/tr","core/lib/yammer_api","core/lib/treatment","css!./network_pending_invitations","html!./network_pending_invitations"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("common-ui/lib/ui/general/lightbox_manager"),e=a("components/reinvite_all/index"),f=a("core/lib/location_helper"),g=a("backbone"),h=a("core/lib/tr"),i=a("core/lib/yammer_api"),j=a("core/lib/treatment");a("css!./network_pending_invitations");var k={INVITABLE_COUNT:".yj-network-pending-invitations--invitable-count",OPEN_LIGHTBOX_BTN:".yj-network-pending-invitations--open-lightbox"};return c.extend({mixins:[b],template:a("html!./network_pending_invitations"),className:"yj-network-pending-invitations special-action is-hidden",events:{"click .yj-network-pending-invitations--open-lightbox":"_openReinviteAllLightbox"},initialize:function(){this._invitableCount=0,this._useMassReinvite=!1,this._showAvalanceButton=!1,g.on("/reinvite_all/invite_all",this._handleInviteAll,this)},render:function(){this._getInvitationData()},getTemplateData:function(){return{inviteThem:h.t("invite_them"),inviteYourCoworkers:h.t("invite_your_coworkers"),tow_header_standardization:j.treatment("tow_header_standardization")}},setInvitableCount:function(a){this._invitableCount=a,this._updateInvitableCount()},setUseMassReinvite:function(a){this._useMassReinvite=a},setShowAvalanceButton:function(a){this._showAvalanceButton=a},_updateInvitableCount:function(){this.$(k.INVITABLE_COUNT).html(h.t("count_people_in_your_company_who_have_not_activated_yet",{count:this._invitableCount}))},_updateLightboxHrefs:function(){var a=f.hash();this.$(k.INVITABLE_COUNT).find("a").attr("title",h.t("invite")).addClass("yj-network-pending-invitations--open-lightbox"),this.$(k.OPEN_LIGHTBOX_BTN).attr("href",a)},_getInvitationData:function(){i.getInvites().then(function(a){this.setInvitableCount(a.invitable_count),this.setUseMassReinvite(a.use_mass_reinvite),this.setShowAvalanceButton(a.show_avalance_button),this._isDisplayable()&&(this._updateLightboxHrefs(),this.$el.removeClass("is-hidden"))}.bind(this))},_isDisplayable:function(){return this._useMassReinvite&&this._invitableCount>0},_openReinviteAllLightbox:function(){var a=new e({showAvalanceButton:this._showAvalanceButton,invitableCount:this._invitableCount}),b={title:h.t("invite"),width:"auto",height:"auto"};d.openComponent(a,null,null,b)},_handleInviteAll:function(){this.$el.slideUp()}})}),define("components/network_pending_invitations/index",["require","./src/network_pending_invitations"],function(a){"use strict";return a("./src/network_pending_invitations")}),define("css!components/invitations_title/src/invitations_title",[],function(){}),define("stache!components/invitations_title/src/invitations_title",["mustache"],function(a){var b='{{^is_community}}{{^tow_header_standardization}}\n<div class="yj-invitations-title--invite-avalanche">\n  <NetworkPendingInvitationsView />\n</div>\n{{/tow_header_standardization}}{{/is_community}}\n\n<div class="yj-invitations-title--content header-content">\n  <h2>{{invite_new_members}}</h2>\n</div>\n\n{{^is_community}}\n<div class="yj-invitations-title--actions-container">\n  <a href="#yj-invitations-title--import-lightbox" class="yj-invitations-title--import-link tightbox {{#tow_header_standardization}}yj-btn{{/tow_header_standardization}}"\n   data-lightbox-class="shaded" title="{{import_from_address_book}}">{{import_from_address_book}}</a>\n</div>\n{{/is_community}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/invitations_title/src/invitations_title",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","components/network_pending_invitations/index","core/lib/backbone_with_subviews","core/lib/tr","core/lib/treatment","core/lib/session","css!./invitations_title","html!./invitations_title"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("components/network_pending_invitations/index"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g=a("core/lib/treatment"),h=a("core/lib/session");return a("css!./invitations_title"),c.extend({mixins:[b,e],template:a("html!./invitations_title"),views:{NetworkPendingInvitationsView:"_getNetworkPendingInvitationsView"},getTemplateData:function(){return{tow_header_standardization:g.treatment("tow_header_standardization"),invite_new_members:f.t("invite_new_members_title"),import_from_address_book:f.t("import_from_address_book"),is_community:this.is_community}},initialize:function(){this.is_community=h.getCurrentNetwork().community},_getNetworkPendingInvitationsView:function(){return new d}})}),define("components/invitations_title/index",["require","./src/invitations_title"],function(a){"use strict";return a("./src/invitations_title")}),define("stache!workfeed/lib/app/views/invitations/index",["mustache"],function(a){var b='<div class="page-header" role="region" style="display: block">\n  <InvitationsTitle key="invitations-title"/>\n</div>\n{{#show_network_pending_invitations}}\n<NetworkPendingInvitations key="network-pending-invitations"/>\n{{/show_network_pending_invitations}}\n<InvitationsByEmail key="invitations-by-email"/>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/invitations/index",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","feeds/lib/ui/util/title_updater","core/lib/tr","core/lib/yammer_request","core/lib/yammer_uri","workfeed/lib/app/helpers/layout","core/lib/treatment","core/lib/session","components/invitations_by_email/index","components/invitations_title/index","components/network_pending_invitations/index","html!./index"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("feeds/lib/ui/util/title_updater"),f=a("core/lib/tr"),g=a("core/lib/yammer_request"),h=a("core/lib/yammer_uri"),i=a("workfeed/lib/app/helpers/layout"),j=a("core/lib/treatment"),k=a("core/lib/session"),l=a("components/invitations_by_email/index"),m=a("components/invitations_title/index"),n=a("components/network_pending_invitations/index"),o=a("html!./index");return c.extend({mixins:[b,d],template:o,className:i.twoColumnMainClass,attributes:{role:"main"},views:{InvitationsTitle:"_createInvitationsTitle",InvitationsByEmail:"_createInvitationsByEmail",NetworkPendingInvitations:"_createNetworkPendingInvitations"},initialize:function(){e.setTitle(f.t("invite_new_members_title")),this._sendEvents(this.options)},getTemplateData:function(){return{show_network_pending_invitations:j.treatment("tow_header_standardization")&&!k.getCurrentNetwork().community}},_sendEvents:function(a){var b=a.from,c={};b&&(c={from:b}),g.send({url:h.app("/invitations/complete_invite_team"),data:c})},_createInvitationsTitle:function(){return new m},_createInvitationsByEmail:function(){return new l},_createNetworkPendingInvitations:function(){return new n}})}),define("models/poll",["require","underscore","backbone","core/lib/namespace"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/namespace"),e=2,f=c.Model.extend({defaults:{enabled:!0,type:"poll"},initialize:function(a){a=a||{},null==a.answers&&this.set("answers",[])},hasQuestion:function(){var a=this.get("question");return null!=a&&a.replace(/^\s+|\s+$/gm,"").length>0},hasAnswers:function(){var a=this.get("answers");return a.length>0&&b.every(a,function(a){return a.replace(/^\s+|\s+$/gm,"").length>0})},hasEnoughAnswers:function(){var a=this.get("answers");return b.filter(a,function(a){return a.replace(/^\s+|\s+$/gm,"").length>0}).length>=e},hasUniqueAnswers:function(){var a=this.get("answers");return b.uniq(a).length===a.length},isEmpty:function(){return!(this.hasQuestion()||this.hasAnswers())},isEnabled:function(){return this.get("enabled")},validate:function(){var a=this.hasQuestion(),b=this.hasEnoughAnswers(),c=this.hasUniqueAnswers(),d=a&&b&&c;return d?void 0:"Poll is not valid"},clear:function(a){this.set({answers:[]});var c=b.omit(this.attributes,"answers");for(var d in c)c[d]=this.defaults[d];this.set(c,b.extend({},a))},toModuleHash:function(){var a=this.get("question"),b=this.get("answers"),c={app_id:"polls",instance:{saved:!1,type:"Poll",properties:{question:{name:"question",datatype:"String",options:{required:!0,searchable:!0,title:!0}},answers:{name:"answers",datatype:"Array",options:{required:!0,searchable:!0}},allowChange:{name:"allowChange",datatype:"String",options:{}},allowSkip:{name:"allowSkip",datatype:"String",options:{}}},virtualProperties:{responses:{name:"responses",datatype:"Object",options:{selfReadOnly:!1,selfWriteOnly:!0}}},responses:{},question:a,answers:b,allowChange:"true",allowSkip:"true"}};return{body:"(See attached poll)",story:JSON.stringify(c)}}});return d.ns("yam.backbone.model"),yam.backbone.model.Poll=f,f}),define("models/praise",["require","underscore","backbone","collections/recipients","core/lib/namespace"],function(a){var b=a("underscore"),c=a("backbone"),d=a("collections/recipients"),e=a("core/lib/namespace"),f=c.Model.extend({defaults:{enabled:!0,icon:"thumbsup",type:"praise"},initialize:function(a){a=a||{},null==a.recipients&&this.set("recipients",new d),this.listenTo(this.get("recipients"),"add remove reset",b.bind(function(){this.trigger("change:recipients"),this.trigger("change")},this))},hasBody:function(){var a=this.get("body");return null!=a&&a.replace(/^\s+|\s+$/gm,"").length>0},hasIcon:function(){var a=this.get("icon");return null!=a&&a.replace(/^\s+|\s+$/gm,"").length>0},hasRecipients:function(){return this.get("recipients").length>0},isEmpty:function(){return!(this.hasBody()||this.hasRecipients())},isEnabled:function(){return this.get("enabled")},validate:function(){var a=this.hasBody(),b=this.hasIcon(),c=this.hasRecipients(),d=a&&b&&c;return d?void 0:"Praise is not valid"},clear:function(a){var c=["recipients"];b.each(c,function(a){a=this.get(a),a&&a.reset(null)},this);var d=b.omit(this.attributes,c);for(var e in d)d[e]=this.defaults[e];this.set(d,b.extend({},a))},toModuleHash:function(){
var a=this.get("body"),b=this.get("icon"),c=this.get("recipients").map(function(a){return a.getId()}),d={comment:a,icon:b,praised_user_ids:c};return{body:"(See attached praise)",praise:JSON.stringify(d)}}});return e.ns("yam.backbone.model"),yam.backbone.model.Praise=f,f}),define("models/announcement",["require","backbone","core/lib/namespace"],function(a){var b=a("backbone"),c=a("core/lib/namespace"),d=b.Model.extend({defaults:{enabled:!0,type:"announcement"},hasTitle:function(){var a=this.get("title");return null!=a&&a.replace(/^\s+|\s+$/gm,"").length>0},hasBody:function(){var a=this.get("body");return null!=a&&a.replace(/^\s+|\s+$/gm,"").length>0},isEmpty:function(){return!(this.hasTitle()||this.hasBody())},isEnabled:function(){return this.get("enabled")},validate:function(){var a=this.hasTitle(),b=this.hasBody(),c=a&&b;return c?void 0:"Announcement is not valid"},toModuleHash:function(){var a=this.get("title"),b=this.get("body");return{is_rich_text:!0,message_type:"announcement",title:a,body:b}}});return c.ns("yam.backbone.model"),yam.backbone.model.Announcement=d,d}),define("stache!feeds/lib/ui/publisher/global/update_publisher",["mustache"],function(a){var b='<div class="publisher-relative">\n  <div class="publisher-main">\n    <div class="publisher-body"></div>\n    <div class="publisher-recipients"></div>\n    <div class="publisher-educational-popup"></div>\n  </div>\n  <div class="publisher-warning"></div>\n  <div class="publisher-excerpt"></div>\n  <div class="publisher-actions">\n    <div class="publisher-topic"></div>\n    <div class="publisher-file"></div>\n    <div class="publisher-submit"></div>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/update_publisher",["require","underscore","core/lib/session","core/lib/tr","models/message_backbone","common-ui/lib/ui/shared/type_ahead","feeds/lib/ui/publisher/global/body_editor","feeds/lib/ui/publisher/global/recipient_selector_with_more","feeds/lib/ui/publisher/global/topic_menu","feeds/lib/ui/publisher/global/base_publisher","feeds/lib/ui/publisher/global/privacy_warning","html!./update_publisher"],function(a){var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/tr"),e=a("models/message_backbone"),f=a("common-ui/lib/ui/shared/type_ahead"),g=a("feeds/lib/ui/publisher/global/body_editor"),h=a("feeds/lib/ui/publisher/global/recipient_selector_with_more"),i=a("feeds/lib/ui/publisher/global/topic_menu"),j=a("feeds/lib/ui/publisher/global/base_publisher"),k=a("feeds/lib/ui/publisher/global/privacy_warning"),l=a("html!./update_publisher"),m=e.TYPE,n={};return j.extend({defaults:function(){var a=b.object([[m.EMPTY,d.t("new_message")],[m.ALL_COMPANY,d.t("new_group_message")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("new_group_message")],[m.PUBLIC_GROUP,d.t("new_group_message")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("new_group_message")],[m.PRIVATE_GROUP,d.t("new_group_message")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("new_group_message")],[m.PRIVATE_MESSAGE,d.t("new_private_message_2")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("new_private_message_2")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("new_private_message_2")]]),c=b.object([[m.ALL_COMPANY,d.t("your_message_has_been_posted")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[m.PUBLIC_GROUP,d.t("your_message_has_been_posted")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[m.PRIVATE_GROUP,d.t("your_message_has_been_posted")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[m.PRIVATE_MESSAGE,d.t("your_private_message_has_been_sent")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_message_has_been_sent")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_message_has_been_sent")]]),e=b.object([[m.ALL_COMPANY,d.t("your_message_could_not_be_posted")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[m.PUBLIC_GROUP,d.t("your_message_could_not_be_posted")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[m.PRIVATE_GROUP,d.t("your_message_could_not_be_posted")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[m.PRIVATE_MESSAGE,d.t("your_private_message_could_not_be_sent")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_message_could_not_be_sent")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_message_could_not_be_sent")]]),f=b.object([[m.EMPTY,d.t("post")],[m.ALL_COMPANY,d.t("post")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("post")],[m.PUBLIC_GROUP,d.t("post")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("post")],[m.PRIVATE_GROUP,d.t("post")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("post")],[m.PRIVATE_MESSAGE,d.t("post")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("post")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("post")]]),g={titles:a,successes:c,errors:e,submit:f};return{icons:n,strings:g,allowAttachments:!0,showAlert:!1,inLightbox:!1,logType:"yam.ui.publisher.global.UpdatePublisher",logSource:"default"}},className:"yj-global-publisher yj-global-update-publisher yj-clearfix",template:l,_createModel:function(){return new e({sender:c.getCurrentUser()})},_getEditorModel:function(){return this.model},_getEditorClass:function(){return g},_getSelectorClass:function(){return h},_getSelectorOptions:function(){return{allowExternalEmails:!0,allowForeignEmails:!0,typeaheadModels:[f.MODEL_GROUP,f.MODEL_USER,f.MODEL_PENDINGUSER,f.MODEL_DOMAIN],typeaheadFilter:this._typeaheadFilter}},_getDropdownDirection:function(){return this._inLightbox?"up":"down"},_requiresGroup:function(){return!0},_createOther:function(){this._createTopicArea(),this._createWarningArea()},_createTopicArea:function(){this._topicMenu=new i({model:this.model,inLightbox:this._inLightbox}),this.add(this._topicMenu,".publisher-topic")},_createWarningArea:function(){this._privacyWarning=new k({model:this.model,inLightbox:this._inLightbox}),this.add(this._privacyWarning,".publisher-warning")}})}),define("common-ui/lib/ui/shared/input/normal_text_input",["require","underscore","core/lib/backbone_base_view","core/lib/session","core/lib/string_helper","jquery-watermark"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/session"),e=a("core/lib/string_helper");return a("jquery-watermark"),c.extend({tagName:"input",events:{keydown:"_onKeydown"},initialize:function(a){this.placeholder=a.placeholder,this.usesLegacyInputEvents=!1,this._updatePlaceholder(),this._addListeners()},remove:function(){return this._removeListeners(),c.prototype.remove.call(this)},enable:function(){return this.$el.prop("disabled",!1),this},disable:function(){return this.$el.prop("disabled",!0),this},clear:function(){return this.val(""),this},val:function(){return this.$el.val.apply(this.$el,arguments)},focus:function(){return this.$el.focus(),this},blur:function(){return this.$el.blur(),this},_updatePlaceholder:function(){this.placeholder&&this.$el.watermark(this.placeholder)},_addListeners:function(){b.bindAll(this,"_onInput");var a=this;"undefined"!=typeof this.el.oninput?this.$el.on("input keyup",this._onInput):"undefined"!=typeof this.el.onpropertychange&&(this.el.attachEvent("onpropertychange",function(b){"value"===b.propertyName&&a._onInput(b)}),this.usesLegacyInputEvents=!0)},_removeListeners:function(){this.usesLegacyInputEvents?this.el.detachEvent("onpropertychange",this._onInput):this.$el.off("input keyup",this._onInput)},_onInput:function(){this.trigger("input")},_onKeydown:function(a){if(13===a.which){var b=d.getCurrentUser(),c=b&&b.web_preferences,f=c?!e.convertStringyBoolean(c.enter_does_not_submit_message):!1;(f&&!a.shiftKey||!f&&a.shiftKey)&&(a.preventDefault(),this.trigger("submit"))}}})}),define("common-ui/lib/ui/shared/input/auto_grow_text_area",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","common-ui/lib/ui/shared/input/normal_text_input","backbone"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("common-ui/lib/ui/shared/input/normal_text_input"),g=a("backbone");return c.extend({mixins:[d,e],events:{click:"_onClick"},className:"yj-autogrow-textarea",template:'      <div class="wrap">        <div class="shadow" aria-hidden="true"></div>        {{#hiddenLabelText}}        <label><span class="yj-acc-hidden">{{hiddenLabelText}}</span>        {{/hiddenLabelText}}        <div class="textarea"></div>        {{#hiddenLabelText}}        </label>        {{/hiddenLabelText}}      </div>    ',initialize:function(a){this.options=b.extend({},a),this._placeholder=a.placeholder,this._createChildren(),this._setupListeners()},render:function(){var a=this._getTemplateData();return this.renderTemplate(a),this},refresh:function(){this._cacheReferences();var a=b.escape(this.val())||"";a=a.replace(/\r\n|[\r\n]/g,"<br/>"),this.$shadow.html(a+" ");var c=this.$shadow.height();this.$textarea.height(c),this.$wrap.height(c),g.trigger("/ui/lightbox/resize")},enable:function(){return this.$textarea&&this.$textarea.prop("disabled",!1),this},disable:function(){return this.$textarea&&this.$textarea.prop("disabled",!0),this},clear:function(){return this.val(""),this},val:function(){return this.$textarea?this.$textarea.val.apply(this.$textarea,arguments):""},focus:function(){return this.$textarea&&this.$textarea.focus(),this},blur:function(){return this.$textarea&&this.$textarea.blur(),this},_createChildren:function(){this._textarea=new f({tagName:"textarea",placeholder:this._placeholder}),this.add(this._textarea,".textarea")},_setupListeners:function(){this.listenTo(this._textarea,"input",this._onInput),this.listenTo(this._textarea,"submit",this._onSubmit)},_cacheReferences:function(){this.$wrap=this.$(".wrap"),this.$shadow=this.$(".shadow"),this.$textarea=this.$("textarea"),this.$wrap.length>0&&(this._cacheReferences=function(){})},_onClick:function(){this.focus()},_onInput:function(){this.refresh(),this.trigger("input")},_onSubmit:function(){this.trigger("submit")},_getTemplateData:function(){return{hiddenLabelText:this.options.hiddenLabelText}}})}),define("stache!feeds/lib/ui/publisher/global/poll_question",["mustache"],function(a){var b='<label>\n  <span class="yj-acc-hidden"></span>\n  <div class="poll-input"></div>\n</label>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/poll_question",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","common-ui/lib/ui/shared/input/auto_grow_text_area","core/lib/tr","html!./poll_question"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("common-ui/lib/ui/shared/input/auto_grow_text_area"),g=a("core/lib/tr"),h=a("html!./poll_question");return b.extend({mixins:[c,d,e],defaults:function(){var a={question:g.t("whats_your_question_2")},b={placeholders:a};return{strings:b}},className:"yj-global-poll-question",template:h,initialize:function(a){this._strings=a.strings,this._createChildren(),this._setupListeners()},render:function(){return this.$question=this.$(".yj-acc-hidden"),this._updatePlaceholder(),this},refresh:function(){return this._question.refresh(),this},enable:function(){return this._question.enable(),this},disable:function(){return this._question.disable(),this},clear:function(){return this._question.clear(),this},val:function(){return this._question.val.apply(this._question,arguments)},focus:function(){return this._question.focus(),this},blur:function(){return this._question.blur(),this},_createChildren:function(){this._question=new f({placeholder:this._strings.placeholders.question}),this.add(this._question,".poll-input")},_setupListeners:function(){this.listenTo(this._question,"input",this._notifyParent.bind(this,"input")),this.listenTo(this._question,"submit",this._notifyParent.bind(this,"submit"))},_updatePlaceholder:function(){var a=this._strings.placeholders.question;this.$question.text(a)},_notifyParent:function(){this.trigger.apply(this,arguments)}})}),define("stache!feeds/lib/ui/publisher/global/poll_answer",["mustache"],function(a){var b='<label>\n  <span class="yj-acc-hidden"></span>\n  <span class="poll-bullet">{{letter}}</span>\n  <div class="poll-input"></div>\n</label>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/poll_answer",[],function(){}),define("feeds/lib/ui/publisher/global/poll_answer",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","core/lib/tr","common-ui/lib/ui/shared/input/normal_text_input","html!./poll_answer","css!./poll_answer"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g=a("common-ui/lib/ui/shared/input/normal_text_input"),h=a("html!./poll_answer");return a("css!./poll_answer"),b.extend({mixins:[c,d,e],defaults:function(){var a={answer:f.t("answer_2")},b={placeholders:a};return{strings:b}},tagName:"li",className:"yj-global-poll-answer",template:h,initialize:function(a){this._index=a.index,this._strings=a.strings,this._createChildren(),this._setupListeners()},getTemplateData:function(){var a="A".charCodeAt(0);return{letter:String.fromCharCode(a+this._index)}},render:function(){return this.$answer=this.$(".yj-acc-hidden"),this._updatePlaceholder(),this},enable:function(){return this._answer.enable(),this},disable:function(){return this._answer.disable(),this},clear:function(){return this._answer.clear(),this},val:function(){return this._answer.val.apply(this._answer,arguments)},focus:function(){return this._answer.focus(),this},blur:function(){return this._answer.blur(),this},_createChildren:function(){this._answer=new g({placeholder:this._strings.placeholders.answer}),this.add(this._answer,".poll-input")},_setupListeners:function(){this.listenTo(this._answer,"input",this._notifyParent.bind(this,"input")),this.listenTo(this._answer,"submit",this._notifyParent.bind(this,"submit"))},_updatePlaceholder:function(){var a=this._strings.placeholders.answer;this.$answer.text(a)},_notifyParent:function(){this.trigger.apply(this,arguments)}})}),define("stache!feeds/lib/ui/publisher/global/poll_editor",["mustache"],function(a){var b='<div class="poll-question"></div>\n<ul class="poll-answers"></ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/poll_editor",[],function(){}),define("feeds/lib/ui/publisher/global/poll_editor",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","feeds/lib/ui/publisher/global/poll_question","feeds/lib/ui/publisher/global/poll_answer","html!./poll_editor","css!./poll_editor"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_legacy_subviews"),f=a("core/lib/backbone_with_subviews"),g=a("feeds/lib/ui/publisher/global/poll_question"),h=a("feeds/lib/ui/publisher/global/poll_answer"),i=a("html!./poll_editor");return a("css!./poll_editor"),d.extend({mixins:[e,f],defaults:{minAnswers:3,maxAnswers:20},className:"yj-global-poll-editor",template:i,initialize:function(a){this._strings=a.strings,this._minAnswers=a.minAnswers,this._maxAnswers=a.maxAnswers,this._createChildren(),this._setupListeners()},render:function(){return this.renderTemplate(),this.$question=this.$(".poll-question"),this.$answers=this.$(".poll-answers"),this._addAnswers(),this},refresh:function(){return this._question.refresh(),this},enable:function(){return this._question.enable(),c.invoke(this._answers,"enable"),this},disable:function(){return this._question.disable(),c.invoke(this._answers,"disable"),this},clear:function(){return this._question.clear(),c.invoke(this._answers,"clear"),this},focus:function(){return this},blur:function(){return this},_createChildren:function(){this._question=new g,this.add(this._question,".poll-question"),this._answers=[]},_setupListeners:function(){this.listenTo(this._question,"input",this._onInput),this.listenTo(this._question,"submit",this._onSubmit)},_addAnswers:function(){for(var a=c.compact(this.model.get("answers")),b=a.length;b++<this._minAnswers;)a.push("");c.each(a,this._addAnswer,this)},_addAnswer:function(a,b){var c=new h({index:b});return this.add(c,".poll-answers"),this.listenTo(c,"input",this._onInput),this.listenTo(c,"submit",this._onSubmit),this._answers.push(c),c},_onInput:function(){var a=b.trim(this._question.val()),d=c.compact(c.map(this._answers,function(a){return b.trim(a.val())}));if(this.model.set({question:a,answers:d}),null!=this.$answers&&d.length===this._answers.length){var e=this._addAnswer(null,d.length);this.$answers.append(e.render().$el)}},_onSubmit:function(){this.trigger("submit")}})}),define("feeds/lib/ui/publisher/global/poll_publisher",["require","underscore","core/lib/session","core/lib/tr","models/poll","models/message_backbone","common-ui/lib/ui/shared/type_ahead","feeds/lib/ui/publisher/global/poll_editor","feeds/lib/ui/publisher/global/recipient_selector_with_more","feeds/lib/ui/publisher/global/topic_menu","feeds/lib/ui/publisher/global/base_publisher","feeds/lib/ui/publisher/global/privacy_warning"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/tr"),e=a("models/poll"),f=a("models/message_backbone"),g=a("common-ui/lib/ui/shared/type_ahead"),h=a("feeds/lib/ui/publisher/global/poll_editor"),i=a("feeds/lib/ui/publisher/global/recipient_selector_with_more"),j=a("feeds/lib/ui/publisher/global/topic_menu"),k=a("feeds/lib/ui/publisher/global/base_publisher"),l=a("feeds/lib/ui/publisher/global/privacy_warning"),m=f.TYPE,n={};return k.extend({defaults:function(){var a=b.object([[m.EMPTY,d.t("new_poll")],[m.ALL_COMPANY,d.t("new_group_poll")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("new_group_poll")],[m.PUBLIC_GROUP,d.t("new_group_poll")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("new_group_poll")],[m.PRIVATE_GROUP,d.t("new_group_poll")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("new_group_poll")],[m.PRIVATE_MESSAGE,d.t("new_private_poll")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("new_private_poll")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("new_private_poll")]]),c=b.object([[m.ALL_COMPANY,d.t("your_poll_has_been_posted")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("your_poll_has_been_posted")],[m.PUBLIC_GROUP,d.t("your_poll_has_been_posted")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_poll_has_been_posted")],[m.PRIVATE_GROUP,d.t("your_poll_has_been_posted")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_poll_has_been_posted")],[m.PRIVATE_MESSAGE,d.t("your_private_poll_has_been_sent")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_poll_has_been_sent")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_poll_has_been_sent")]]),e=b.object([[m.ALL_COMPANY,d.t("your_poll_could_not_be_posted")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("your_poll_could_not_be_posted")],[m.PUBLIC_GROUP,d.t("your_poll_could_not_be_posted")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_poll_could_not_be_posted")],[m.PRIVATE_GROUP,d.t("your_poll_could_not_be_posted")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_poll_could_not_be_posted")],[m.PRIVATE_MESSAGE,d.t("your_private_poll_could_not_be_sent")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_poll_could_not_be_sent")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_poll_could_not_be_sent")]]),f=b.object([[m.EMPTY,d.t("post")],[m.ALL_COMPANY_WITH_EXTERNAL,d.t("post")],[m.ALL_COMPANY,d.t("post")],[m.PUBLIC_GROUP,d.t("post")],[m.PUBLIC_GROUP_WITH_EXTERNAL,d.t("post")],[m.PRIVATE_GROUP,d.t("post")],[m.PRIVATE_GROUP_WITH_EXTERNAL,d.t("post")],[m.PRIVATE_MESSAGE,d.t("post")],[m.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("post")],[m.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("post")]]),g={titles:a,successes:c,errors:e,submit:f};return{icons:n,strings:g,allowAttachments:!0,showAlert:!1,inLightbox:!1,logType:"yam.ui.publisher.global.PollPublisher",logSource:"default"}},className:"yj-global-publisher yj-global-poll-publisher yj-clearfix",_createModel:function(){return new f({sender:c.getCurrentUser(),poll:new e})},_getEditorModel:function(){return this.model.get("poll")},_getEditorClass:function(){return h},_getSelectorClass:function(){return i},_getSelectorOptions:function(){return{allowExternalEmails:!0,allowForeignEmails:!0,typeaheadModels:[g.MODEL_GROUP,g.MODEL_USER,g.MODEL_PENDINGUSER,g.MODEL_DOMAIN],typeaheadFilter:this._typeaheadFilter}},_getDropdownDirection:function(){return this._inLightbox?"up":"down"},_requiresGroup:function(){return!0},_createOther:function(){this._createTopicArea(),this._createWarningArea()},_createTopicArea:function(){this._topicMenu=new j({model:this.model,inLightbox:this._inLightbox}),this.add(this._topicMenu,".publisher-topic")},_createWarningArea:function(){this._privacyWarning=new l({model:this.model,inLightbox:this._inLightbox}),this.add(this._privacyWarning,".publisher-warning")}})}),define("stache!feeds/lib/ui/publisher/global/praise_slideshow",["mustache"],function(a){var b='<button class="slideshow-left unstyle-button-as-span" data-speechtip>\n  <span class="yj-acc-hidden">{{leftLabel}}</span>\n</button>\n<ul class="slideshow-slides">\n  {{#slides}}\n    <li class="slideshow-slide" id="slideshow-slide-{{index}}">\n      {{{svgIcon}}}\n    </li>\n  {{/slides}}\n</ul>\n<button class="slideshow-right unstyle-button-as-span" data-speechtip>\n  <span class="yj-acc-hidden">{{rightLabel}}</span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/praise_slideshow",[],function(){}),define("feeds/lib/ui/publisher/global/praise_slideshow",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/helper/svg_icon","html!./praise_slideshow","css!./praise_slideshow"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("common-ui/lib/helper/svg_icon"),f=a("html!./praise_slideshow");a("css!./praise_slideshow");var g={left:"Left",right:"Right"},h={labels:g},i=["thumbsup","star","trophy","money","checkeredflag","lightbulb","graduationcap","ace","glasses","heart","doublerainbow","coffee","pie","diamond","monocle","ninja","gift"];return c.extend({mixins:[d],defaults:{icons:i,strings:h},events:{"click .slideshow-left":"_slideLeft","click .slideshow-right":"_slideRight","click .slideshow-slide":"_slideRight"},className:"yj-global-praise-slideshow",template:f,initialize:function(a){this._icons=a.icons,this._strings=a.strings,this._index=0,this._slides=b.map(a.icons,function(a,b){return{index:b,key:a}})},getTemplateData:function(){return b.each(this._slides,function(a){a.svgIcon=e("praise-"+a.key,{width:46,height:46})}),{leftLabel:this._strings.labels.left,rightLabel:this._strings.labels.right,slides:this._slides}},render:function(){return this.$left=this.$(".slideshow-left"),this.$right=this.$(".slideshow-right"),this._fadeInCurrentSlide(),this},enable:function(){return this.$left&&this.$left.attr("disabled",!1),this.$right&&this.$right.attr("disabled",!1),this},disable:function(){return this.$left&&this.$left.attr("disabled",!0),this.$right&&this.$right.attr("disabled",!0),this},clear:function(){return this._index=0,this._hideSlides(),this._fadeInCurrentSlide(this._index),this},focus:function(){return this},blur:function(){return this},_currentSlide:function(){return this.$("#slideshow-slide-"+this._index)},_hideSlides:function(){this.$(".slideshow-slide").hide()},_fadeOutCurrentSlide:function(a){this._currentSlide().hide(),a&&a()},_fadeInCurrentSlide:function(a){this._currentSlide().show(),a&&a()},_changeSlide:function(a){this._index=a,this.model.set({icon:this._icons[this._index]})},_changeSlideWithAnimation:function(a){var b=this;this._fadeOutCurrentSlide(function(){b._changeSlide(a),b._fadeInCurrentSlide()})},_slideLeft:function(){var a=this._index-1;0>a&&(a=this._slides.length-1),this._changeSlideWithAnimation(a)},_slideRight:function(){var a=this._index+1;a>=this._slides.length&&(a=0),this._changeSlideWithAnimation(a)}})}),define("stache!feeds/lib/ui/publisher/global/praise_editor",["mustache"],function(a){var b='<div class="praise-recipients"></div>\n<div class="praise-icon"></div>\n<div class="praise-body"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/praise_editor",[],function(){}),define("feeds/lib/ui/publisher/global/praise_editor",["require","underscore","jquery","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","collections/recipients","feeds/lib/ui/publisher/global/recipient_selector","feeds/lib/ui/publisher/global/praise_slideshow","common-ui/lib/ui/shared/input/auto_grow_text_area","core/lib/tr","common-ui/lib/ui/shared/type_ahead","html!./praise_editor","css!./praise_editor"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_legacy_subviews"),g=a("core/lib/backbone_with_subviews"),h=a("collections/recipients"),i=a("feeds/lib/ui/publisher/global/recipient_selector"),j=a("feeds/lib/ui/publisher/global/praise_slideshow"),k=a("common-ui/lib/ui/shared/input/auto_grow_text_area"),l=a("core/lib/tr"),m=a("common-ui/lib/ui/shared/type_ahead"),n=a("html!./praise_editor");a("css!./praise_editor");var o=h.TYPE;return d.extend({mixins:[e,f,g],defaults:function(){var a=l.t("what_are_you_praising_them_for_2"),c=b.object([[o.EMPTY,l.t("who_would_you_like_to_praise_2")],[o.PRIVATE_MESSAGE,l.t("add_more_people_2")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,l.t("add_more_people_2")]]),d={placeholders:c},e={placeholder:a,selector:d};return{strings:e}},className:"yj-global-praise-editor",template:n,initialize:function(a){this._strings=a.strings,this._createChildren(),this._setupListeners()},refresh:function(){return this._textarea.refresh(),this},enable:function(){return this._selector.enable(),this._slideshow.enable(),this._textarea.enable(),this},disable:function(){return this._selector.disable(),this._slideshow.disable(),this._textarea.disable(),this},clear:function(){return this._selector.clear(),this._slideshow.clear(),this._textarea.clear(),this},focus:function(){return this},blur:function(){return this},_createChildren:function(){this._selector=new i({collection:this.model.get("recipients"),strings:this._strings.selector,typeaheadModels:[m.MODEL_USER],typeaheadOptions:{maxResults:6,hintMessage:null,accessFilter:"post",includeAllCompany:!0,selectFirst:!1,selectOnType:!0,groupsFirst:!0,inline:!0,allowWide:!1,width:260,showTopRankingsOnce:!0,cacheEmails:!0,allowForeignEmails:!1,allowForeignUsers:!1}}),this.add(this._selector,".praise-recipients"),this._slideshow=new j({model:this.model}),this.add(this._slideshow,".praise-icon"),this._textarea=new k({placeholder:this._strings.placeholder,hiddenLabelText:this._strings.placeholder}),this.add(this._textarea,".praise-body")},_setupListeners:function(){this.listenTo(this._textarea,"input",this._onInput),this.listenTo(this._textarea,"submit",this._onSubmit)},_onInput:function(){this.model.set({body:c.trim(this._textarea.val())})},_onSubmit:function(){this.trigger("submit")}})}),define("stache!feeds/lib/ui/publisher/global/praise_publisher",["mustache"],function(a){var b='<div class="publisher-relative">\n  <div class="publisher-main">\n    <div class="publisher-body"></div>\n    <div class="publisher-recipients"></div>\n  </div>\n  <div class="publisher-warning"></div>\n  <div class="publisher-excerpt"></div>\n  <div class="publisher-actions">\n    <div class="publisher-topic"></div>\n    <div class="publisher-file"></div>\n    <div class="publisher-submit"></div>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/praise_publisher",["require","underscore","core/lib/session","core/lib/tr","models/praise","models/message_backbone","common-ui/lib/ui/shared/type_ahead","feeds/lib/ui/publisher/global/praise_editor","feeds/lib/ui/publisher/global/recipient_selector_with_more","feeds/lib/ui/publisher/global/topic_menu","feeds/lib/ui/publisher/global/base_publisher","feeds/lib/ui/publisher/global/privacy_warning","html!./praise_publisher"],function(a){var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/tr"),e=a("models/praise"),f=a("models/message_backbone"),g=a("common-ui/lib/ui/shared/type_ahead"),h=a("feeds/lib/ui/publisher/global/praise_editor"),i=a("feeds/lib/ui/publisher/global/recipient_selector_with_more"),j=a("feeds/lib/ui/publisher/global/topic_menu"),k=a("feeds/lib/ui/publisher/global/base_publisher"),l=a("feeds/lib/ui/publisher/global/privacy_warning"),m=a("html!./praise_publisher"),n=f.TYPE,o={};return k.extend({defaults:function(){var a=b.object([[n.EMPTY,d.t("new_praise")],[n.ALL_COMPANY,d.t("new_group_praise")],[n.ALL_COMPANY_WITH_EXTERNAL,d.t("new_group_praise")],[n.PUBLIC_GROUP,d.t("new_group_praise")],[n.PUBLIC_GROUP_WITH_EXTERNAL,d.t("new_group_praise")],[n.PRIVATE_GROUP,d.t("new_group_praise")],[n.PRIVATE_GROUP_WITH_EXTERNAL,d.t("new_group_praise")],[n.PRIVATE_MESSAGE,d.t("new_private_praise")],[n.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("new_private_praise")],[n.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("new_private_praise")]]),c=b.object([[n.ALL_COMPANY,d.t("your_praise_has_been_posted")],[n.ALL_COMPANY_WITH_EXTERNAL,d.t("your_praise_has_been_posted")],[n.PUBLIC_GROUP,d.t("your_praise_has_been_posted")],[n.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_praise_has_been_posted")],[n.PRIVATE_GROUP,d.t("your_praise_has_been_posted")],[n.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_praise_has_been_posted")],[n.PRIVATE_MESSAGE,d.t("your_private_praise_has_been_sent")],[n.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_praise_has_been_sent")],[n.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_praise_has_been_sent")]]),e=b.object([[n.ALL_COMPANY,d.t("your_praise_could_not_be_posted")],[n.ALL_COMPANY_WITH_EXTERNAL,d.t("your_praise_could_not_be_posted")],[n.PUBLIC_GROUP,d.t("your_praise_could_not_be_posted")],[n.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_praise_could_not_be_posted")],[n.PRIVATE_GROUP,d.t("your_praise_could_not_be_posted")],[n.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_praise_could_not_be_posted")],[n.PRIVATE_MESSAGE,d.t("your_private_praise_could_not_be_sent")],[n.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_praise_could_not_be_sent")],[n.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_praise_could_not_be_sent")]]),f=b.object([[n.EMPTY,d.t("post")],[n.ALL_COMPANY,d.t("post")],[n.ALL_COMPANY_WITH_EXTERNAL,d.t("post")],[n.PUBLIC_GROUP,d.t("post")],[n.PUBLIC_GROUP_WITH_EXTERNAL,d.t("post")],[n.PRIVATE_GROUP,d.t("post")],[n.PRIVATE_GROUP_WITH_EXTERNAL,d.t("post")],[n.PRIVATE_MESSAGE,d.t("post")],[n.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("post")],[n.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("post")]]),g={titles:a,successes:c,errors:e,submit:f};return{icons:o,strings:g,allowAttachments:!0,showAlert:!1,inLightbox:!1,logType:"yam.ui.publisher.global.PraisePublisher",logSource:"default"}},className:"yj-global-publisher yj-global-praise-publisher yj-clearfix",template:m,_createModel:function(){return new f({sender:c.getCurrentUser(),praise:new e})},_getEditorModel:function(){return this.model.get("praise")},_getEditorClass:function(){return h},_getSelectorClass:function(){return i},_getSelectorOptions:function(){return{allowExternalEmails:!0,allowForeignEmails:!0,typeaheadModels:[g.MODEL_GROUP,g.MODEL_USER,g.MODEL_PENDINGUSER,g.MODEL_DOMAIN],typeaheadFilter:this._typeaheadFilter}},_getDropdownDirection:function(){return this._inLightbox?"up":"down"},_requiresGroup:function(){return!0},_createOther:function(){
this._createTopicArea(),this._createWarningArea()},_createTopicArea:function(){this._topicMenu=new j({model:this.model,inLightbox:this._inLightbox}),this.add(this._topicMenu,".publisher-topic")},_createWarningArea:function(){this._privacyWarning=new l({model:this.model,inLightbox:this._inLightbox}),this.add(this._privacyWarning,".publisher-warning")}})}),define("stache!feeds/lib/ui/publisher/global/announcement_editor",["mustache"],function(a){var b='<div class="announcement-header">\n  <label><span class="yj-acc-hidden">{{labelText}}</span>\n    <div class="announcement-title"></div>\n  </label>\n</div>\n<div class="announcement-body"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/announcement_editor",[],function(){}),define("feeds/lib/ui/publisher/global/announcement_editor",["require","jquery","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","core/lib/tr","common-ui/lib/ui/shared/input/normal_text_input","common-ui/lib/helper/squire","html!./announcement_editor","css!./announcement_editor"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g=a("common-ui/lib/ui/shared/input/normal_text_input"),h=a("common-ui/lib/helper/squire"),i=a("html!./announcement_editor");return a("css!./announcement_editor"),c.extend({mixins:[d,e],defaults:function(){var a={title:f.t("what_do_you_want_to_announce"),body:""},b={placeholders:a};return{strings:b,inLightbox:!1}},className:"yj-global-announcement-editor",template:i,initialize:function(a){this._strings=a.strings,this._createChildren(),this._setupListeners()},render:function(){return this.renderTemplate({labelText:this._strings.placeholders.title}),this},refresh:function(){return this},enable:function(){return this._title.enable(),this},disable:function(){return this._title.disable(),this},clear:function(){return this._title.clear(),this._body.clear(),this},focus:function(){return this},blur:function(){return this},_createChildren:function(){this._title=new g({placeholder:this._strings.placeholders.title}),this.add(this._title,".announcement-title"),this._body=new h({placeholder:this._strings.placeholders.body,height:"145",title:f.t("announcement_body_rich_text")}),this.add(this._body,".announcement-body")},_setupListeners:function(){this.listenTo(this._title,"input",this._onInput),this.listenTo(this._body,"input",this._onInput),this.listenTo(this._title,"submit",this._onSubmit),this.listenTo(this._body,"submit",this._onSubmit)},_onInput:function(){this.model.set({title:b.trim(this._title.val()),body:b.trim(this._body.getHTML())})},_onSubmit:function(){this.trigger("submit")}})}),define("stache!feeds/lib/ui/publisher/global/announcement_expiration_warning",["mustache"],function(a){var b='<div class="warning-bar">\n  <span class="warning-icon yamicon yamicon-rd_expire" aria-hidden="true"></span>\n  <div class="warning-label">{{content}}</div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/announcement_expiration_warning",[],function(){}),define("feeds/lib/ui/publisher/global/announcement_expiration_warning",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","html!./announcement_expiration_warning","css!./announcement_expiration_warning"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/tr"),f=a("html!./announcement_expiration_warning");return a("css!./announcement_expiration_warning"),b.extend({mixins:[c,d],className:"yj-global-announcement-warning",template:f,getTemplateData:function(){return{content:e.t("announcement_warning")}}})}),define("css!feeds/lib/ui/publisher/global/announcement_publisher",[],function(){}),define("feeds/lib/ui/publisher/global/announcement_publisher",["require","underscore","core/lib/session","core/lib/tr","core/lib/treatment","models/announcement","models/message_backbone","common-ui/lib/ui/shared/type_ahead","feeds/lib/ui/publisher/global/announcement_editor","feeds/lib/ui/publisher/global/recipient_selector_with_more","feeds/lib/ui/publisher/global/topic_menu","feeds/lib/ui/publisher/global/base_publisher","feeds/lib/ui/publisher/global/privacy_warning","feeds/lib/ui/publisher/global/announcement_expiration_warning","css!./announcement_publisher"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/tr"),e=a("core/lib/treatment"),f=a("models/announcement"),g=a("models/message_backbone"),h=a("common-ui/lib/ui/shared/type_ahead"),i=a("feeds/lib/ui/publisher/global/announcement_editor"),j=a("feeds/lib/ui/publisher/global/recipient_selector_with_more"),k=a("feeds/lib/ui/publisher/global/topic_menu"),l=a("feeds/lib/ui/publisher/global/base_publisher"),m=a("feeds/lib/ui/publisher/global/privacy_warning"),n=a("feeds/lib/ui/publisher/global/announcement_expiration_warning");a("css!./announcement_publisher");var o=g.TYPE,p={};return l.extend({defaults:function(){var a=b.object([[o.EMPTY,d.t("new_announcement")],[o.ALL_COMPANY,d.t("new_group_announcement")],[o.ALL_COMPANY_WITH_EXTERNAL,d.t("new_group_announcement")],[o.PUBLIC_GROUP,d.t("new_group_announcement")],[o.PUBLIC_GROUP_WITH_EXTERNAL,d.t("new_group_announcement")],[o.PRIVATE_GROUP,d.t("new_group_announcement")],[o.PRIVATE_GROUP_WITH_EXTERNAL,d.t("new_group_announcement")],[o.PRIVATE_MESSAGE,d.t("new_private_announcement")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("new_private_announcement")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("new_private_announcement")]]),c=b.object([[o.ALL_COMPANY,d.t("your_announcement_has_been_posted")],[o.ALL_COMPANY_WITH_EXTERNAL,d.t("your_announcement_has_been_posted")],[o.PUBLIC_GROUP,d.t("your_announcement_has_been_posted")],[o.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_announcement_has_been_posted")],[o.PRIVATE_GROUP,d.t("your_announcement_has_been_posted")],[o.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_announcement_has_been_posted")],[o.PRIVATE_MESSAGE,d.t("your_private_announcement_has_been_sent")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_announcement_has_been_sent")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_announcement_has_been_sent")]]),e=b.object([[o.ALL_COMPANY,d.t("your_announcement_could_not_be_posted")],[o.ALL_COMPANY_WITH_EXTERNAL,d.t("your_announcement_could_not_be_posted")],[o.PUBLIC_GROUP,d.t("your_announcement_could_not_be_posted")],[o.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_announcement_could_not_be_posted")],[o.PRIVATE_GROUP,d.t("your_announcement_could_not_be_posted")],[o.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_announcement_could_not_be_posted")],[o.PRIVATE_MESSAGE,d.t("your_private_announcement_could_not_be_sent")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_announcement_could_not_be_sent")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_announcement_could_not_be_sent")]]),f=b.object([[o.EMPTY,d.t("notify_specific_people_2")],[o.ALL_COMPANY,d.t("notify_specific_people_2")],[o.ALL_COMPANY_WITH_EXTERNAL,d.t("notify_specific_people_2")],[o.PUBLIC_GROUP,d.t("notify_specific_people_2")],[o.PUBLIC_GROUP_WITH_EXTERNAL,d.t("notify_specific_people_2")],[o.PRIVATE_GROUP,d.t("notify_specific_people_2")],[o.PRIVATE_GROUP_WITH_EXTERNAL,d.t("notify_more_people_2")],[o.PRIVATE_MESSAGE,d.t("notify_more_people_2")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("notify_more_people_2")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("notify_more_people_2")]]),g={placeholders:f},h=b.object([[o.EMPTY,d.t("post")],[o.ALL_COMPANY,d.t("post")],[o.ALL_COMPANY_WITH_EXTERNAL,d.t("post")],[o.PUBLIC_GROUP,d.t("post")],[o.PUBLIC_GROUP_WITH_EXTERNAL,d.t("post")],[o.PRIVATE_GROUP,d.t("post")],[o.PRIVATE_GROUP_WITH_EXTERNAL,d.t("post")],[o.PRIVATE_MESSAGE,d.t("post")],[o.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("post")],[o.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("post")]]),i={titles:a,successes:c,errors:e,selector:g,submit:h};return{icons:p,strings:i,allowAttachments:!0,showAlert:!1,inLightbox:!1,logType:"yam.ui.publisher.global.AnnouncementPublisher",logSource:"default"}},className:"yj-global-publisher yj-global-announcement-publisher yj-clearfix",_createModel:function(){return new g({sender:c.getCurrentUser(),announcement:new f})},_getEditorModel:function(){return this.model.get("announcement")},_getEditorClass:function(){return i},_getSelectorClass:function(){return j},_getSelectorOptions:function(){return{allowExternalEmails:!0,allowForeignEmails:!0,typeaheadModels:[h.MODEL_GROUP,h.MODEL_USER,h.MODEL_PENDINGUSER,h.MODEL_DOMAIN],typeaheadFilter:this._typeaheadFilter}},_getDropdownDirection:function(){return this._inLightbox?"up":"down"},_requiresGroup:function(){return!0},_createOther:function(){this._createTopicArea(),this._createWarningArea(),e.treatment("prod_support_expiring_announcements_v2")&&this._createExpirationWarningArea()},_createTopicArea:function(){this._topicMenu=new k({model:this.model,inLightbox:this._inLightbox}),this.add(this._topicMenu,".publisher-topic")},_createWarningArea:function(){this._privacyWarning=new m({model:this.model,inLightbox:this._inLightbox}),this.add(this._privacyWarning,".publisher-warning")},_createExpirationWarningArea:function(){this._announcementWarning=new n({model:this.model}),this.add(this._announcementWarning,".publisher-warning")}})}),define("stache!feeds/lib/ui/publisher/global/thread_starter_publisher",["mustache"],function(a){var b='<h2 class="yj-acc-hidden">\n  <span>{{heading}}</span>\n</h2>\n<div class="publisher-switcher"></div>\n{{#userAvatar}}\n  <div class="publisher-user-avatar"></div>\n{{/userAvatar}}\n<div class="publisher-fake">\n  <a class="publisher-placeholder" href="javascript://" role="button">{{placeholder}}</a>\n  {{#allowAttachments}}\n    <button class="unstyle-button-as-span publisher-fake-button">\n      <span class="publisher-fake-icon yamicon yamicon-paperclip">\n        <span class="yj-acc-hidden">{{paperclipAltText}}</span>\n      </span>\n    </button>\n  {{/allowAttachments}}\n</div>\n<div class="publisher-real"></div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/publisher/global/thread_starter_publisher",[],function(){}),define("feeds/lib/ui/publisher/global/thread_starter_publisher",["require","jquery","underscore","core/lib/tr","core/lib/report","core/lib/session","core/lib/string_helper","core/lib/treatment","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","models/poll","models/praise","models/announcement","models/recipient","models/message_backbone","feeds/lib/ui/publisher/global/publisher_switcher","feeds/lib/ui/publisher/global/update_publisher","feeds/lib/ui/publisher/global/poll_publisher","feeds/lib/ui/publisher/global/praise_publisher","backbone","feeds/lib/ui/publisher/global/announcement_publisher","feeds/lib/ui/publisher/global/file_drag_drop_area","feeds/lib/ui/publisher/global/external_educational_popup","common-ui/lib/ui/accessibility/focus_helper","html!./thread_starter_publisher","css!./thread_starter_publisher"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/tr"),e=a("core/lib/report"),f=a("core/lib/session"),g=a("core/lib/string_helper"),h=a("core/lib/treatment"),i=a("core/lib/backbone_base_view"),j=a("core/lib/backbone_with_legacy_subviews"),k=a("core/lib/backbone_with_subviews"),l=a("models/poll"),m=a("models/praise"),n=a("models/announcement"),o=a("models/recipient"),p=a("models/message_backbone"),q=a("feeds/lib/ui/publisher/global/publisher_switcher"),r=a("feeds/lib/ui/publisher/global/update_publisher"),s=a("feeds/lib/ui/publisher/global/poll_publisher"),t=a("feeds/lib/ui/publisher/global/praise_publisher"),u=a("backbone"),v=a("feeds/lib/ui/publisher/global/announcement_publisher"),w=a("feeds/lib/ui/publisher/global/file_drag_drop_area"),x=a("feeds/lib/ui/publisher/global/external_educational_popup"),y=a("common-ui/lib/ui/accessibility/focus_helper"),z=a("html!./thread_starter_publisher");a("css!./thread_starter_publisher");var A={updatePublisher:r,pollPublisher:s,praisePublisher:t,announcementPublisher:v},B={updatePublisher:"rd_update",pollPublisher:"rd_poll",praisePublisher:"rd_praise",announcementPublisher:"rd_announcement"},C="updatePublisher";return i.extend({mixins:[j,k],defaults:function(){var a={updatePublisher:d.t("update"),pollPublisher:d.t("poll"),praisePublisher:d.t("praise"),announcementPublisher:d.t("announcement")},b=d.t("message_composer_publisher_header_for_screenreader_users"),c=d.t("add_file"),e={heading:b,switcher:a,paperclipAltText:c},f={switcher:B};return{classes:A,icons:f,strings:e,selection:C,allowAttachments:!0}},events:{"click .publisher-fake":"_onClickFake","click .publisher-fake-button":"_onClickFakeButton"},className:"yj-global-thread-starter-publisher style-paperclip",template:z,initialize:function(a){this._classes=a.classes,this._icons=a.icons,this._switcherIcons=this._icons.switcher,this._strings=a.strings,this._switcherStrings=this._strings.switcher,this._selection=a.selection,this._showAnnouncements=a.showAnnouncements,this._logType=a.logType,this._logSource=a.logSource,this._isHomeFeedPublisher=a.isHomeFeedPublisher,this._typeaheadFilter=a.typeaheadFilter,this._popupMode=x.MODE.RECIPIENT_WITH_GROUP,this.model=a.model||new p({sender:f.getCurrentUser(),poll:new l({enabled:!1}),praise:new m({enabled:!1}),announcement:new n({enabled:!1})});var b=f.getCurrentUser(),c=b&&b.web_preferences,d=c&&c.network_settings,e=d?g.convertStringyBoolean(d.allow_attachments):!0;this._allowAttachments=e&&a.allowAttachments,this._createChildren(),this._setupListeners()},remove:function(){return this._removeListeners(),i.prototype.remove.call(this)},render:function(){var a=this._getTemplateData();return this.renderTemplate(a),this.$placeholder=this.$(".publisher-placeholder"),this.close(),this},open:function(){return this.swap(!0),this},close:function(){return this.swap(!1),this},swap:function(a){return this.$el.is(".yj-open")&&!a&&y.notifyRemoval(this.$el),this.$el.toggleClass("yj-open",a),this.trigger(a?"open":"close"),u.trigger("/ui/lightbox/resize"),this},isOpen:function(){return this.$el.hasClass("yj-open")},select:function(a){return null==a&&(a=this._selection),this._switcher.select(a),this},enable:function(){return this._getPublisher().enable(),this},disable:function(){return this._getPublisher().disable(),this},focus:function(){return this._getPublisher().focus(),this},blur:function(){return this._getPublisher().blur(),this},isFocused:function(){return this.$el.has(window.document.activeElement).length>0},reset:function(){return this._getPublisher().reset(),this.close(),this},isResettable:function(){return this._getPublisher().isResettable()},_createChildren:function(){this._showAnnouncements||this._removeAnnouncementPublisher(),this._addPublisherSwitcher(),this._addDragDropArea(),this._addEducationalPopup()},_removeAnnouncementPublisher:function(){var a="announcementPublisher";this._classes=c.omit(this._classes,a),this._switcherIcons=c.omit(this._switcherIcons,a),this._switcherStrings=c.omit(this._switcherStrings,a)},_addPublisherSwitcher:function(){this._switcher=new q({icons:this._switcherIcons,strings:this._switcherStrings,selection:this._selection}),this.add(this._switcher,".publisher-switcher")},_addPublishers:function(){this._publishers={};var a=this._isHomeFeedPublisher&&h.treatment("tow_small_ab_primary_composer_defaultless");c.each(this._classes,function(b,c){var d=new b({model:this.model,logType:this._logType,logSource:this._logSource,allowAttachments:this._allowAttachments,noAllCompanyDefault:a,typeaheadFilter:this._typeaheadFilter});d.disable().hide(),this.listenTo(d,"change:title",this._notifyParent.bind(this,"change:title")),this._publishers[c]=d,this.add(d,".publisher-real")},this),this.render()},_addDragDropArea:function(){this._dragdrop=new w({model:this.model}),this.add(this._dragdrop)},_addEducationalPopup:function(){this._canShowEducationalPopup()&&(this._recipientPopup=new x({mode:this._popupMode}),this.add(this._recipientPopup,".publisher-educational-popup"))},_canShowEducationalPopup:function(){return x.canShowForMode(this._popupMode)},_setupListeners:function(){c.bindAll(this,"_swapWhenAppropriate","_onBlur"),this.listenTo(this.model,"clear",this.close),this.listenTo(this.model.get("recipients"),"add remove reset",this._updatePlaceholder),this.listenTo(this._switcher,"select",this._onSelect),this.listenTo(this._dragdrop,"drop",this.select),b(window).on("click",this._onBlur)},_removeListeners:function(){b(window).off("click",this._onBlur)},_getTemplateData:function(){return{heading:this._strings.heading,placeholder:this._getPlaceholder(),paperclipAltText:this._strings.paperclipAltText,allowAttachments:this._allowAttachments,userAvatar:!1}},_getDefaultAllCompanyPlaceholder:function(){return d.t("what_are_you_working_on")},_getDefaultGroupPlaceholder:function(){return d.t("share_something_with_this_group")},_getPlaceholder:function(){var a=this._strings.placeholder,b=this.model.getGroup(),c=b&&b.get("id");if(null==a){if(null==c||c===o.ALL_COMPANY_ID){var d=this._getCustomPlaceholder();a=null!=d?d:this._getDefaultAllCompanyPlaceholder()}else a=this._getDefaultGroupPlaceholder();return a}},_getCustomPlaceholder:function(){var a=f.getCurrentUser(),b=a&&a.web_preferences,c=b&&b.network_settings;return c?c.message_prompt:null},_updatePlaceholder:function(){this.$placeholder&&this.$placeholder.text(this._getPlaceholder())},_getPublisher:function(){return!this._publishers&&this._addPublishers(),this._publishers[this._selection]},_getPublishers:function(){return!this._publishers&&this._addPublishers(),this._publishers},_notifyParent:function(){this.trigger.apply(this,arguments)},_showEducationalPopup:function(){this._recipientPopup&&this._recipientPopup.show()},_hideEducationalPopup:function(){this._recipientPopup&&this._recipientPopup.hide()},_onClickFake:function(a){return a.preventDefault(),a.stopPropagation(),a._pubHandled?!1:(this._showEducationalPopup(),e.event("main_publisher_opened",{publisher_type:this._logType||"yam.ui.publisher.global.ThreadStarterPublisher",publisher_source:this._logSource,type:"yam.ui.publisher.global.ThreadStarterPublisher"}),this.select(null),void(a._pubHandled=!0))},_onClickFakeButton:function(a){return a.preventDefault(),a.stopPropagation(),a._pubHandled?!1:(this.select(null),this._getPublisher().openFileMenu(),this._showEducationalPopup(),e.event("main_publisher_opened_through_paperclip",{publisher_type:this._logType||"yam.ui.publisher.global.ThreadStarterPublisher",publisher_source:this._logSource}),void(a._pubHandled=!0))},_onSelect:function(a){var b=this._getPublishers();null!=b[a]&&(this._selection=a),this.open(),c.each(b,function(a,b){b===this._selection?a.enable().show():a.disable().hide()},this),this._showEducationalPopup()},_onBlur:function(a){b.contains(window.document,a.target)&&!b.contains(this.el,a.target)&&c.defer(this._swapWhenAppropriate)},_swapWhenAppropriate:function(){if(this.isFocused())return this;var a=this.model.isEmpty(),b=!a;return this.swap(b),b||this._hideEducationalPopup(),this}})}),define("css!feeds/lib/ui/messages/featured_feed_seller",[],function(){}),define("stache!feeds/lib/ui/messages/featured_feed_seller",["mustache"],function(a){var b='<span class="yamicon-yam-spittle yamicon"></span>\n{{text}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/messages/featured_feed_seller",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","models/lib/model/helper/report_feed_events","core/lib/tr","css!./featured_feed_seller","html!./featured_feed_seller"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("models/lib/model/helper/report_feed_events"),e=a("core/lib/tr");return a("css!./featured_feed_seller"),b.extend({mixins:[c],className:"yj-featured-feed-seller yj-btn yj-btn-alt yj-btn-wide is-hidden",template:a("html!./featured_feed_seller"),events:{click:"_onClick"},getTemplateData:function(){return{text:e.t("see_more_conversations_from_the_people_groups_and_topics")}},show:function(){this.$el.removeClass("is-hidden")},_onClick:function(){this._reportFeedLinkClick(),this._navigateToFeaturedFeed()},_reportFeedLinkClick:function(){d.reportFeedEvent("feed_link_click","following",null,{link_type:"featured_feed_seller"})},_navigateToFeaturedFeed:function(){yam.router.navigate("/home?type=following&rand="+Math.random(),{trigger:!0})}})}),define("css!feeds/lib/ui/feeds/feed_toggle",[],function(){}),define("stache!feeds/lib/ui/feeds/feed_toggle",["mustache"],function(a){var b='<h3 class="yj-acc-hidden">\n  <span>{{feedSelectorLabel}}</span>\n</h3>\n<a class="yj-feed-toggle--settings-link yj-sticky-dropdown yj-click-menu-trigger" href="javascript://" role="button" aria-haspopup="true" data-attach-menu="true" data-content-id="yj-feed-sticky-menu-content" data-position-menu="right" data-speechtip="{{feedSettingsAltText}}">\n  <span class="yamicon yamicon-settings yj-feed-toggle--settings yj-feed-settings" data-position-menu="right">\n    <span class="yj-acc-hidden">{{feedSettingsAltText}}</span>\n  </span>\n  <small class="yj-feed-toggle--settings-arrow yj-arrow yj-down-arrow" aria-hidden="true">&#9660;</small>\n</a>\n\n{{^tow_header_standardization}}\n<ul class="yj-feed-toggle--options yj-feed-choices">\n  <li class="yj-feed-toggle--option">\n  {{#algo}}\n    <span data-feed="algo">{{topLabel}}</span>\n    <span class="yj-acc-hidden">{{selectedLabel}}</span>\n  {{/algo}}\n  {{^algo}}\n    <a class="yj-feed-toggle--option-link" data-feed="algo" href="{{uri}}/#/home?type=algo">{{topLabel}}</a>\n  {{/algo}}\n  </li>\n  <li class="yj-feed-toggle--option">\n    <span class="yj-feed-toggle--option-bullet" aria-hidden="true">&#8226;</span>\n    {{#all}}\n      <span data-feed="my_all">{{allLabel}}</span>\n      <span class="yj-acc-hidden">{{selectedLabel}}</span>\n    {{/all}}\n    {{^all}}\n      <a class="yj-feed-toggle--option-link" data-feed="my_all" href="{{uri}}/#/home?type=my_all">{{allLabel}}</a>\n    {{/all}}\n    <span class="yj-feed-toggle--option-bullet" aria-hidden="true">&#8226;</span>\n  </li>\n  <li class="yj-feed-toggle--option">\n  {{#following}}\n    <span data-feed="following">{{followingLabel}}</span>\n    <span class="yj-acc-hidden">{{selectedLabel}}</span>\n  {{/following}}\n  {{^following}}\n    <a class="yj-feed-toggle--option-link" data-feed="following" href="{{uri}}/#/home?type={{followingType}}&rand={{rand}}">\n      {{followingLabel}}\n    </a>\n  {{/following}}\n  </li>\n</ul>\n{{/tow_header_standardization}}\n{{#tow_header_standardization}}\n<ul class="yj-feed-toggle--options yj-feed-choices yj-tabs">\n  <li class="yj-feed-toggle--option yj-filter-tab {{#algo}}yj-selected{{/algo}}">\n    <a class="yj-feed-toggle--option-link yj-filter-tab-link" data-feed="algo" href="{{uri}}/#/home?type=algo">{{topLabel}}</a>\n    {{#algo}}<span class="yj-acc-hidden">{{selectedLabel}}</span>{{/algo}}\n  </li>\n  <li class="yj-feed-toggle--option yj-filter-tab {{#all}}yj-selected{{/all}}">\n    <a class="yj-feed-toggle--option-link yj-filter-tab-link" data-feed="my_all" href="{{uri}}/#/home?type=my_all">{{allLabel}}</a>\n    {{#all}}<span class="yj-acc-hidden">{{selectedLabel}}</span>{{/all}}\n  </li>\n  <li class="yj-feed-toggle--option yj-filter-tab {{#following}}yj-selected{{/following}}">\n    <a class="yj-feed-toggle--option-link yj-filter-tab-link" data-feed="following" href="{{uri}}/#/home?type={{followingType}}&rand={{rand}}">{{followingLabel}}</a>\n    {{#following}}<span class="yj-acc-hidden">{{selectedLabel}}</span>{{/following}}\n  </li>\n</ul>\n{{/tow_header_standardization}}\n\n<span class="yj-feed-toggle--menu yj-menu yj-click-menu yj-click-menu-content yj-menu-shadow" data-yamjs-id="yj-feed-sticky-menu-content">\n  <div class="yj-feed-toggle--menu-arrow-border"></div>\n  <div class="yj-feed-toggle--menu-arrow"></div>\n  <ul class="yj-feed-toggle--menu-items yj-sticky-menu-items">\n    <li class="yj-feed-toggle--menu-item yj-item" data-feed-option="sticky">\n      <a class="yj-feed-toggle--menu-item-link yj-item-anchor {{stickyFeed}}" tabindex="0">{{stickyLabel}}</a>\n    </li>\n  </ul>\n</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/feeds/feed_toggle",["require","underscore","jquery","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/session","core/lib/tr","core/lib/report","core/lib/yammer_uri","models/helpers/user","core/lib/treatment","css!./feed_toggle","html!./feed_toggle"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("backbone"),g=a("core/lib/session"),h=a("core/lib/tr"),i=a("core/lib/report"),j=a("core/lib/yammer_uri"),k=a("models/helpers/user"),l=a("core/lib/treatment");return a("css!./feed_toggle"),d.extend({mixins:[e],className:"yj-feed-toggle",template:a("html!./feed_toggle"),events:{"click .yj-feed-toggle--option-link":"_handleFeedSelection","click .yj-feed-toggle--menu-item-link":"_handleStickySelection"},initialize:function(a){this.feedType=a.feedType},isSticky:function(){return k.isStickyMyFeed(g.getCurrentUser())},getTemplateData:function(){return{tow_header_standardization:l.treatment("tow_header_standardization"),uri:j.app(),algo:"algo"===this.feedType,following:"following"===this.feedType,all:"my_all"===this.feedType,rand:Math.random(),stickyLabel:h.t("remember_my_feed_selections"),stickyFeed:this.isSticky()?"yj-selected":"",topLabel:h.t("discovery"),allLabel:h.t("all"),followingLabel:h.t("following"),followingType:"following",feedSettingsAltText:h.t("feed_settings"),feedSelectorLabel:h.t("feed_selector"),selectedLabel:h.t("selected")}},render:function(){return this._addTooltips(),this},_handleStickySelection:function(a){var b=c(a.target),d=!b.hasClass("yj-selected"),e=function(){d&&f.trigger("/ui/alert/show","notice",h.t("your_feed_selections_have_been_remembered"))},i=this.feedType;k.setStickyMyFeed(g.getCurrentUser(),{isSticky:d,feedType:i,success:e}),d?b.addClass("yj-selected"):b.removeClass("yj-selected")},_handleFeedSelection:function(a){var b=c(a.target).data("feed");l.treatment("tow_header_standardization")&&this.feedType===b||b&&(k.setPrescribedFeed(g.getCurrentUser(),b),i.event("feed_selected",{feed_type:b}))},_addTooltips:function(){var a={orientation:"top",delay:400,fadeTime:0},c={algo:h.t("true_discovery_feed_tooltip"),following:h.t("see_only_conversations_involving_people_groups_or_topics_that_you"),my_all:h.t("see_all_conversations_in_your_network")};b(c).each(function(c,d){var e=b.extend({target:this.$el.find("[data-feed='"+d+"']"),text:c},a);f.trigger("/ui/tooltip/add",e)},this)}})}),define("common-ui/lib/ui/shared/scroll_monitor",["require","jquery","underscore","backbone","core/lib/ctor"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/ctor");return e(null,[d.Events],{defaults:{scrollInterval:100,container:window},init:function(a){c.bindAll(this,"start"),this.options=a=c.extend({},this.defaults,a),this.container=a.container instanceof b?a.container.get():a.container},start:function(){var a=this.options;this._checkScroll(),this._timeout=this._setTimeout(this.start,a.scrollInterval)},stop:function(){delete this.oldScrollPosition,this._timeout&&this._clearTimeout(this._timeout)},destroy:function(){this.stop()},_checkScroll:function(){var a=!1;void 0===this.oldScrollPosition&&(this.oldScrollPosition=this._getScrollTopPosition(),a=!0);var b=this._getScrollTopPosition(),c=this.oldScrollPosition,d=c-b;(0!==d||a)&&this.trigger("scroll",d,b),this.oldScrollPosition=b},_getScrollTopPosition:function(){var a=this.container;return"pageYOffset"in a?a.pageYOffset:b(a).scrollTop()},_setTimeout:function(a,b){return window.setTimeout(a,b)},_clearTimeout:function(a,b){return window.clearTimeout(a,b)}})}),define("common-ui/lib/ui/shared/scroll_spy",["require","jquery","underscore","backbone","core/lib/ctor","common-ui/lib/ui/shared/scroll_monitor"],function(a){var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("core/lib/ctor"),f=a("common-ui/lib/ui/shared/scroll_monitor");return e(null,[d.Events],{defaults:{scrollInterval:100,container:window,topOffset:0,bottomOffset:0},init:function(a,d){this.options=c.extend({},this.defaults,d),this.container=this.options.container instanceof b?this.options.container[0]:this.options.container,this._setElements(a),c.bindAll(this,"_onScroll","_isScrolledInTop","_isScrolledInBottom","_isScrolledAboveTop","_isScrolledAboveBottom","_isScrolledBelowTop","_isScrolledBelowBottom"),this.eventTriggers={scrolledInTop:this.trigger.bind(this,"scrolledInTop"),scrolledInBottom:this.trigger.bind(this,"scrolledInBottom"),scrolledAboveTop:this.trigger.bind(this,"scrolledAboveTop"),scrolledAboveBottom:this.trigger.bind(this,"scrolledAboveBottom"),scrolledBelowTop:this.trigger.bind(this,"scrolledBelowTop"),scrolledBelowBottom:this.trigger.bind(this,"scrolledBelowBottom")},this.scrollMonitor=new f({scrollInterval:this.options.scrollInterval,container:this.container})},start:function(){this.scrollMonitor.on("scroll",this._onScroll),this.scrollMonitor.start()},stop:function(){this.scrollMonitor.off("scroll",this._onScroll),this.scrollMonitor.stop()},reload:function(a){this._setElements(a||this.elementsSelector),this.stop(),this.start()},destroy:function(){this.stop(),this.elements&&(this.elements.length=0,delete this.elements)},_setElements:function(a){if(!a)throw"ScrollSpy needs elements to spy on";c.isString(a)&&(this.elementsSelector=a,a=this.container===window?b(a):b(this.container).find(a)),a instanceof b&&(a=a.get()),a=[].concat(a),this.elements=a.sort(this._sortNodes)},_isInDom:function(a){var b=this.container===window,c=b?!0:document.body.contains(this.container),d=b?document.body:this.container,e=d.contains(a);return c&&e},_onScroll:function(a){var b=this.options,d=0+b.topOffset,e=this._getContainerHeight()-b.bottomOffset,f=c.filter(this.elements,this._isInDom,this),g={scrolledInTop:[],scrolledInBottom:[],scrolledAboveTop:[],scrolledAboveBottom:[],scrolledBelowTop:[],scrolledBelowBottom:[]};g.scrolledInTop=c(f.reverse()).filter(c.partial(this._isScrolledInTop,d,e,a)),g.scrolledInBottom=c(f.reverse()).filter(c.partial(this._isScrolledInBottom,d,e,a)),g.scrolledAboveTop=c(f).filter(c.partial(this._isScrolledAboveTop,d,a)),g.scrolledAboveBottom=c(f).filter(c.partial(this._isScrolledAboveBottom,d,a)),g.scrolledBelowTop=c(f).filter(c.partial(this._isScrolledBelowTop,e,a)),g.scrolledBelowBottom=c(f).filter(c.partial(this._isScrolledBelowBottom,e,a)),this._triggerEventsForAffectedElements(g)},_triggerEventsForAffectedElements:function(a){c(this.eventTriggers).each(function(b,d){c(a[d]).each(b)})},_getContainerHeight:function(){var a,c=this.container;return a=c===window&&"innerHeight"in c?c.innerHeight:b(c).innerHeight()},_getElementOffsetTop:function(a){var b,c=a.getBoundingClientRect().top,d=this.container;return d!==window&&(b=d.getBoundingClientRect(),c-=b.top),c},_getElementOffsetBottom:function(a){var b,c,d=a.getBoundingClientRect().bottom,e=this.container;return e!==window&&(b=e.getBoundingClientRect(),c=window.innerHeight-b.bottom,d=d-c-b.top),d},_isInViewport:function(a,b,c,d){var e=a-d,f=e===a;return f||b>=e||e>=c?a>=b&&c>=a:!1},_isScrolledInTop:function(a,b,c,d){var e=this._getElementOffsetTop(d);return this._isInViewport(e,a,b,c)},_isScrolledInBottom:function(a,b,c,d){var e=this._getElementOffsetBottom(d);return this._isInViewport(e,a,b,c)},_isAboveViewport:function(a,b,c){var d=a-c;return d>=b?b>=a:!1},_isBelowViewport:function(a,b,c){var d=a-c;return b>=d?a>=b:!1},_isScrolledAboveTop:function(a,b,c){var d=this._getElementOffsetTop(c);return this._isAboveViewport(d,a,b)},_isScrolledAboveBottom:function(a,b,c){
var d=this._getElementOffsetBottom(c);return this._isAboveViewport(d,a,b)},_isScrolledBelowTop:function(a,b,c){var d=this._getElementOffsetTop(c);return this._isBelowViewport(d,a,b)},_isScrolledBelowBottom:function(a,b,c){var d=this._getElementOffsetBottom(c);return this._isBelowViewport(d,a,b)},_sortNodes:function(a,b){return a.getBoundingClientRect().top-b.getBoundingClientRect().top}})}),define("stache!components/end_of_unread_feed_banner/src/end_of_unread_feed_banner",["mustache"],function(a){var b='<IconBannerView key="icon-banner" />\n{{#g2gButtonExperiment}}\n  <a class="yj-end-of-unread-feed-banner--container" href="{{href}}">\n    <span class="yj-end-of-unread-feed-banner--button yj-btn yj-btn-alt">\n    {{#hasNextGroup}}\n      <span class="yj-end-of-unread-feed-banner--button-icon yamicon yamicon-rd_groups"></span><span class="yj-end-of-unread-feed-banner--button-text">{{groupName}}</span><span class="yj-end-of-unread-feed-banner--unread-count">{{unreadCountLabel}}</span>\n    {{/hasNextGroup}}\n    {{^hasNextGroup}}\n      {{discoverMoreLabel}}\n    {{/hasNextGroup}}\n    </span>\n  </a>\n{{/g2gButtonExperiment}}';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/end_of_unread_feed_banner/src/end_of_unread_feed_banner",[],function(){}),define("components/end_of_unread_feed_banner/src/end_of_unread_feed_banner",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","core/lib/treatment","core/lib/uri_helper","core/lib/urls","core/lib/location_helper","models/lib/model/helper/report_feed_events","components/icon_banner/index","common-ui/lib/ui/shared/scroll_spy","collections/groups","models/group","models/lib/model/helper/top_groups","html!./end_of_unread_feed_banner","css!./end_of_unread_feed_banner"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g=a("core/lib/treatment"),h=a("core/lib/uri_helper"),i=a("core/lib/urls"),j=a("core/lib/location_helper"),k=a("models/lib/model/helper/report_feed_events"),l=a("components/icon_banner/index"),m=a("common-ui/lib/ui/shared/scroll_spy"),n=a("collections/groups"),o=a("models/group"),p=a("models/lib/model/helper/top_groups"),q=a("html!./end_of_unread_feed_banner");return a("css!./end_of_unread_feed_banner"),c.extend({className:function(){var a="yj-end-of-unread-feed-banner";return g.treatment("tow_g2g_v2")&&(a+=" g2g_v2_"+g.treatment("tow_g2g_v2")),a},mixins:[d,e],template:q,events:{click:"_logBannerClick",mouseover:"_logHover"},views:{IconBannerView:"_getIconBannerView"},initialize:function(){this._g2gTreatment=g.treatment("tow_g2g_v2"),this._nextGroup=this._getNextGroup(),this._g2gTreatment&&(this._g2gTextLink="text_link"===this._g2gTreatment,this._g2gButtonLink="button_link"===this._g2gTreatment)},show:function(){this.$el.removeClass("is-hidden"),this._startScrollReporting()},hide:function(){this.$el.addClass("is-hidden")},toggleSticky:function(a){this.$el.toggleClass("is-sticky",a||!1)},remove:function(){return this._scrollSpy&&this._scrollSpy.stop(),c.prototype.remove.call(this)},_getNextGroup:function(){return this._g2gTreatment?this.model.isAllCompany()?p.getNextGroupFromAllCompany():p.getNextGroupFromGroup(this.model.getGroupId()):this.model.isAllCompany()?o.ALL_COMPANY():n.get(this.model.getGroupId())},render:function(){return this._g2gButtonLink&&this._nextGroup&&this.$(".yj-end-of-unread-feed-banner--button").css({color:this._nextGroup.get("color")}),this},getTemplateData:function(){var a={};if(this._g2gButtonLink)if(this._nextGroup){var b=p.getUnviewedCountForGroup(this._nextGroup.get("id"));a={g2gButtonExperiment:!0,href:i.groupUnviewed(this._nextGroup),groupName:this._nextGroup.get("full_name"),unreadCountLabel:b>0?f.t("count_new",{count:b}):"",hasNextGroup:!0}}else a={g2gButtonExperiment:!0,href:i.home(),discoverMoreLabel:f.t("discover_more")};return a},_getIconBannerView:function(){var a=f.t("see_all_of_this_group_conversations"),b=h.replaceParam(j.href(),"view","all"),c=f.t("youre_all_caught_up_here");return this._g2gTextLink&&(a=f.t("discover_more_from_across_your_company"),b=i.home(),this._nextGroup&&(a=f.t("go_to_group_name",{group_name:this._nextGroup.get("full_name")}),b=i.groupUnviewed(this._nextGroup))),this._g2gButtonLink&&(b=i.home(),c=f.t("youre_all_caught_up_here_next_up"),a=void 0,this._nextGroup&&(b=i.groupUnviewed(this._nextGroup),c=f.t("youre_all_caught_up_here_next_group"))),this._instantiateIconBannerView({iconName:"checkmark",headerLabel:c,subheaderLabel:a,href:b})},_instantiateIconBannerView:function(a){return new l(a)},_startScrollReporting:function(){this._scrollSpy||(this._scrollSpy=this._getScrollSpy(),this.listenToOnce(this._scrollSpy,"scrolledInTop",this._logBannerInScreen),this._scrollSpy.start())},_getScrollSpy:function(){return this._scrollSpy||new m(this.el)},_logBannerInScreen:function(){var a=this.model,b=a.getThreads({sorted:!1}).length;this._reportFeedEvent("feed_link_displayed",{from_group_thread_count:b}),this._scrollSpy.stop()},_logHover:function(){this._hoverLogged||(this._reportFeedEvent("feed_link_hover"),this._hoverLogged=!0)},_reportFeedEvent:function(a,c){c=c||{};var d=this.model,e=this._nextGroup,f=null,g="";if(e)switch(e.get("id")){case"COMPANY_GROUP_ID":g="general";break;default:g="group",f=e.get("id")}else g="algo";var h={link_type:"group_bottom_banner",feed_view:this._g2gTreatment?"unviewed":"default",from_group_id:d.getGroupId(),from_group_type:d.getLogSource()};k.reportFeedEvent(a,g,f,b.extend(h,c))},_logBannerClick:function(){var a=this.model;this._g2gTreatment?this._reportFeedEvent("feed_link_click",{link_type:"group_bottom_banner"}):k.reportFeedEvent("feed_link_click",a.getLogSource(),a.getGroupId(),{link_type:"group_bottom_banner",feed_view:"default"})}})}),define("components/end_of_unread_feed_banner/index",["require","./src/end_of_unread_feed_banner"],function(a){"use strict";return a("./src/end_of_unread_feed_banner")}),define("stache!components/group_unread_header/src/group_unread_header",["mustache"],function(a){var b='<a href="javascript://" role="button" class="yj-group-unread-header--mark-all-as-viewed">{{markAllAsReadLabel}}</a>\n<h2 class="yj-group-unread-header--unread-header" aria-hidden="true">{{unreadConversationsLabel}}</h2>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/group_unread_header/src/group_unread_header",[],function(){}),define("components/group_unread_header/src/group_unread_header",["require","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","models/lib/model/helper/report_feed_events","core/lib/treatment","html!./group_unread_header","css!./group_unread_header"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("models/lib/model/helper/report_feed_events"),f=a("core/lib/treatment"),g=a("html!./group_unread_header");return a("css!./group_unread_header"),c.extend({mixins:[d],template:g,className:"yj-group-unread-header",events:{"click .yj-group-unread-header--mark-all-as-viewed":"_onMarkAllAsViewedClick"},getTemplateData:function(){return f.treatment("tow_self_sufficient_groups_phase1")?{markAllAsReadLabel:b.t("group_clear_new"),unreadConversationsLabel:b.t("new_conversations")}:{markAllAsReadLabel:b.t("group_mark_all_as_read"),unreadConversationsLabel:b.t("unread_conversations")}},_onMarkAllAsViewedClick:function(){var a=this.model;e.reportFeedEvent("feed_link_click",a.getLogSource(),a.getGroupId(),{link_type:"group_mark_all_as_viewed",feed_view:a.getLogFeedView()}),this.trigger("markAllAsViewed")}})}),define("components/group_unread_header/index",["require","./src/group_unread_header"],function(a){"use strict";return a("./src/group_unread_header")}),define("common-ui/lib/helper/custom_timing",["require","core/lib/session","models/helpers/user"],function(a){"use strict";var b=a("core/lib/session"),c=a("models/helpers/user");return{feedLabelMap:{algo:"top",my_all:"all"},getCurrentDefaultFeed:function(){return c.getPrescribedFeedType(b.getCurrentUser())},pickFeedEventName:function(a){var b;return a=a===this.getCurrentDefaultFeed()?"default":a,b=this.feedLabelMap[a]?this.feedLabelMap[a]:a,b+"_feed"},getFeedRenderEventName:function(a,b){return this.pickFeedEventName(a)+(b?"_render":"_render_fresh")},getPageViewEventName:function(a,b){return this.pickFeedEventName(a)+(b?"_load":"_load_fresh")},getMoreViewEventName:function(a){return this.pickFeedEventName(a)+"_more"},getInboxTypeLabel:function(a){return a?"_read":""}}}),define("stache!workfeed/lib/app/sidebar/getting_started_new_mobile_task_lightbox",["mustache"],function(a){var b='<img src="{{image}}" class="mobile-mascot" srcset="{{image}} 1x, {{image2}} 2x">\n<div id="mobile-form-container">\n  <p class="description">{{promo}}</p>\n\n  {{#hasNoFakeEmail}}\n  <form accept-charset="UTF-8" action="yammer_mobile_promote" id="send-email-form" method="post">\n    <div class="email">{{email}}</div>\n\n    <button type="submit" id="send-email-button" data-qaid="email_link_button" class="yj-btn">{{emailLabel}}</button>\n    <span class="error-msg yj-invalid"></span>\n  </form>\n  {{/hasNoFakeEmail}}\n\n  <form accept-charset="UTF-8" action="/sms" id="send-sms-form" method="post">\n    <label><span class="yj-acc-hidden">{{countryCodeLabel}}</span>\n      <input class="country-code" id="phone-country-code" name="phone-country-code" placeholder="1" type="tel" value="1">\n    </label>\n\n    <label><span class="yj-acc-hidden">{{mobileNumberLabel}}</span>\n      <input class="phone-number" id="phone-number" name="phone-number" placeholder="Enter your mobile number" type="tel" data-qaid="mobile_number_field">\n    </label>\n\n    <button type="submit" id="send-sms-button" data-qaid="text_link_button" class="yj-btn">{{textLabel}}</button>\n    <span class="confirmation-msg yj-valid"></span>\n    <span class="error-msg yj-invalid"></span>\n    <p class="message-rates"><small>{{textDisclaimer}}</small></p>\n  </form>\n</div>\n\n<div id="mobile-success-container" class="yj-hide">\n  <span class="header yj-valid" data-qaid="sent_confirmation_header">{{textSuccess}}</span>\n  <p class="success-message" data-qaid="success_message_text"></p>\n  <p class="success-retry-message"></p>\n  <button id="close-lightbox-btn" data-qaid="okay_button" class="yj-btn">{{textOkayButton}}</button>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/sidebar/getting_started_new_mobile_task_lightbox",[],function(){}),define("workfeed/lib/app/sidebar/getting_started_new_mobile_task_lightbox",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/tr","core/lib/report","core/lib/session","core/lib/yammer_request","core/lib/yammer_uri","models/helpers/user","html!./getting_started_new_mobile_task_lightbox","css!./getting_started_new_mobile_task_lightbox"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("backbone"),f=a("core/lib/tr"),g=a("core/lib/report"),h=a("core/lib/session"),i=a("core/lib/yammer_request"),j=a("core/lib/yammer_uri"),k=a("models/helpers/user"),l=a("html!./getting_started_new_mobile_task_lightbox");return a("css!./getting_started_new_mobile_task_lightbox"),c.extend({id:"promote-mobile-web",mixins:[d],template:l,events:{"click #send-email-button":"_sendEmail","click #send-sms-button":"_sendSMS","click #mobile-success-container .success-retry-message a":"_tryAgain","click #close-lightbox-btn":"_closeLightbox"},initialize:function(){b.bindAll(this,"_handleEmailSuccess","_handleEmailError","_handleSMSSuccess","_handleSMSError")},render:function(){return this.$mobileFormsContainer=this.$("#mobile-form-container"),this.$mobileSuccessContainer=this.$("#mobile-success-container"),this.$emailFormAction=this.$("#send-email-form"),this.$emailField=this.$("#send-email-input"),this.$SMSFormAction=this.$("#send-sms-form"),this.$phoneCountryCode=this.$("#phone-country-code"),this.$phoneNumber=this.$("#phone-number"),this.$phoneNumberErrorMsg=this.$("#send-sms-form .error-msg"),this},getTemplateData:function(){return{hasNoFakeEmail:!h.getCurrentUser().contact.has_fake_email,email:h.getCurrentUser().email,image:j.cdn("assets/images/experiments/promote_mobile_on_web/mobile-on-web-mascot.png"),image2:j.cdn("assets/images/experiments/promote_mobile_on_web/mobile-on-web-mascot_2x.png"),promo:f.t("getting_started_mobile_task_promo"),emailLabel:f.t("getting_started_mobile_task_email_button"),countryCodeLabel:f.t("getting_started_mobile_task_country_code"),mobileNumberLabel:f.t("getting_started_mobile_task_mobile_number"),textLabel:f.t("getting_started_mobile_task_text_button"),textDisclaimer:f.t("getting_started_mobile_task_text_disclaimer"),textSuccess:f.t("getting_started_mobile_task_text_success"),textOkayButton:f.t("getting_started_mobile_task_text_okay")}},onComplete:function(){i.send({url:j.app("getting_started/dismiss_phone_task"),type:"POST",data:{},success:function(){}}),e.trigger("taskListComplete","install_mobile")},_report:function(a){g.event("yammer_promote_mobile_on_web",a)},_sendEmail:function(a){a.preventDefault();var b=this.$emailFormAction.attr("action"),c=this.$el.find("#send-email-button");c.addClass("yj-btn-disabled"),i.send({method:"post",dataType:"json",url:b,success:this._handleEmailSuccess,error:this._handleEmailError,complete:function(){c.removeClass("yj-btn-disabled")}})},_handleEmailSuccess:function(){var a=k.getPrimaryEmailAddress(h.getCurrentUser());this.$mobileFormsContainer.addClass("yj-hide"),this.$mobileSuccessContainer.removeClass("yj-hide"),this.$mobileSuccessContainer.addClass("email_success"),this.$mobileSuccessContainer.find(".success-message").html(f.t("an_email_has_been_sent_to_email_check_your_email",{email:"<strong>"+b.escape(a)+"</strong>"})),this.$mobileSuccessContainer.find(".success-retry-message").html(f.t("didnt_receive_an_email_try_again",{link:{1:"javscript://"}})),this._report({source:"email_success"})},_handleEmailError:function(a){this._report({source:"email_error",error:a.notice})},_sendSMS:function(a){a.preventDefault();var b=this.$SMSFormAction.attr("action"),c=0!==this.$phoneCountryCode.val().length?this.$phoneCountryCode.val():"1",d=this.$phoneNumber.val(),e=this.$el.find("#send-sms-button"),g=f.t("please_enter_a_phone_number");return 0===d.length?void this.$phoneNumberErrorMsg.text(g):(e.addClass("yj-btn-disabled"),void i.send({method:"post",dataType:"json",data:{phone_country_code:c,phone_number:d},url:b,success:this._handleSMSSuccess,error:this._handleSMSError,complete:function(){e.removeClass("yj-btn-disabled")}}))},_handleSMSSuccess:function(){var a=0!==this.$phoneCountryCode.val().length?this.$phoneCountryCode.val():"1",b=this.$phoneNumber.val();this.$phoneNumberErrorMsg.empty(),this.$mobileFormsContainer.addClass("yj-hide"),this.$mobileSuccessContainer.removeClass("yj-hide"),this.$mobileSuccessContainer.addClass("sms_success"),this.$mobileSuccessContainer.find(".success-message").html(f.t("a_text_message_has_been_sent_to_strong_countrycode_strong",{countryCode:a,phoneNumber:b})),this.$mobileSuccessContainer.find(".success-retry-message").html(f.t("didnt_receive_a_text_message_link_try_again",{link:{1:"javscript://"}})),this._report({source:"sms_success"})},_handleSMSError:function(a){this.$phoneNumberErrorMsg.text(a.responseJSON.error),this._report({source:"sms_error",error:a.responseJSON.error})},_tryAgain:function(a){a.preventDefault();var b=this.$mobileSuccessContainer.attr("class");this.$mobileSuccessContainer.addClass("yj-hide"),this.$mobileFormsContainer.removeClass("yj-hide"),this._report({from:b,source:"try_again"})},_closeLightbox:function(){e.trigger("/ui/lightbox/close")}})}),define("stache!feeds/lib/ui/feeds/mobile_feed_ad_body",["mustache"],function(a){var b='<div class="top-container yj-clearfix">\n  <img alt="" class="running-yammy" src="{{imgSrc}}" width="104" height="126">\n  <p class="heading">{{heading}}</p>\n  <p class="send-subheading">{{subHeading}}</p>\n  <p class="success yj-hidden yj-green">{{success}}</p>\n  <p class="sent-subheading yj-hidden">{{linkSent}}</p>\n  <a class="yj-hidden try-again-btn" href="javascript://">{{tryAgain}}</a>\n  <div class="button-container">\n    <button class="yj-btn yj-btn-blue yj-get-app-btn yj-email-submit">\n      <span>{{getApp}}</span>\n    </button>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/feeds/mobile_feed_ad_body",[],function(){}),define("feeds/lib/ui/feeds/mobile_feed_ad_body",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/util/screen_helper","core/lib/report","core/lib/tr","core/lib/yammer_uri","common-ui/lib/ui/general/lightbox_manager","workfeed/lib/app/sidebar/getting_started_new_mobile_task_lightbox","html!./mobile_feed_ad_body","css!./mobile_feed_ad_body"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("backbone"),f=a("core/lib/util/screen_helper"),g=a("core/lib/report"),h=a("core/lib/tr"),i=a("core/lib/yammer_uri"),j=a("common-ui/lib/ui/general/lightbox_manager"),k=a("workfeed/lib/app/sidebar/getting_started_new_mobile_task_lightbox"),l=a("html!./mobile_feed_ad_body");return a("css!./mobile_feed_ad_body"),c.extend({mixins:[d],className:"yj-mobile-feed-ad",template:l,events:{"click .yj-email-submit":"_handleSendEmail","click .try-again-btn":"_handleTryAgain"},initialize:function(){b.bindAll(this,"_handleSendEmailSuccess","_handleSendEmailError","_handleSendEmail"),this.model.on("email-sent",this._handleSendEmailSuccess),this.model.on("email-error",this._handleSendEmailError)},getTemplateData:function(){var a=i.cdn("assets/images/experiments/promote_mobile_on_web/mobile-on-web-mascot-feed.png"),b=i.cdn("assets/images/experiments/promote_mobile_on_web/mobile-on-web-mascot-feed_2x.png");return{imgSrc:2===f.getPixelRatio()?b:a,heading:h.t("get_the_yammer_mobile_app"),subHeading:h.t("stay_connected_to_your_messages_with_the_yammer_mobile_app"),success:h.t("success"),linkSent:h.t("check_your_email_you_should_hear_from_us_shortly"),tryAgain:h.t("didnt_receive_an_email"),getApp:h.t("get_the_app")}},_handleSendEmail:function(a){a.preventDefault(),a.stopPropagation(),this.$(".yj-email-submit").attr("disabled","disabled"),this.model.sendEmail()},_handleSendEmailSuccess:function(){this._hideCalltoAction(),this._showSuccessMessage(),g.event("yammer_promote_mobile_on_web",{source:"in_feed_ad_email_success"})},_handleSendEmailError:function(a){if(a.responseText){var b=JSON.parse(a.responseText);b.error&&e.trigger("/ui/alert/show","error",b.error)}},_hideCalltoAction:function(){this.$(".heading").addClass("yj-hidden"),this.$(".send-subheading").addClass("yj-hidden"),this.$(".yj-email-submit").addClass("yj-hidden")},_showSuccessMessage:function(){this.$(".sent-subheading").removeClass("yj-hidden"),this.$(".success").removeClass("yj-hidden"),this.$(".try-again-btn").removeClass("yj-hidden")},_handleTryAgain:function(){var a=new k;j.openComponent(a,"",null,{title:h.t("get_the_yammer_mobile_app"),width:null}),g.event("yammer_promote_mobile_on_web",{source:"in_feed_ad_try_again"})}})}),define("css!feeds/lib/ui/feeds/mobile_ad_item",[],function(){}),define("feeds/lib/ui/feeds/mobile_ad_item",["require","underscore","jquery","mustache","core/lib/backbone_legacy_integration","feeds/lib/ui/feeds/mobile_feed_ad_body","components/avatar/index","models/user","feeds/lib/ui/shared/subscription_list_lightbox","backbone","core/lib/report","core/lib/tr","core/lib/session","core/lib/urls","css!feeds/lib/ui/feeds/mobile_ad_item"],function(a){"use strict";var b=a("underscore"),c=a("jquery"),d=a("mustache"),e=a("core/lib/backbone_legacy_integration"),f=a("feeds/lib/ui/feeds/mobile_feed_ad_body"),g=a("components/avatar/index"),h=a("models/user"),i=a("feeds/lib/ui/shared/subscription_list_lightbox"),j=a("backbone"),k=a("core/lib/report"),l=a("core/lib/tr"),m=a("core/lib/session"),n=a("core/lib/urls");return a("css!feeds/lib/ui/feeds/mobile_ad_item"),e.extend({tagName:"li",className:"yj-mobile-feed-ad-item",template:'      <div class="yj-avatar-container"></div>      <div class="close-btn">        <a href="javascript://" class="yj-close-link" role="button">          <span class="yamicon yamicon-x yamicon-xx-small">            <span class="yj-acc-hidden">{{accCloseBanner}}</span>          </span>        </a>      </div>      <h3 class="yj-acc-hidden">{{accHeader}}</h3>      <div class="header">{{{headerHtml}}}</div>      <div class="ad-contents"></div>     ',events:{"click .yj-close-link":"_handleClose","click .yj-others":"_handleOthersClick"},initialize:function(a){var c=a.model.get("users");this.avatarUser=b.first(c),this.otherUsers=b.rest(c),this.otherUsersCount=this.otherUsers.length,this._createChildren()},render:function(){return this.renderTemplate(this._getTemplateData()),this._addUserLinkHovercards(),this.model.incrementShowCount(),this},_createChildren:function(){this.add(new f({model:this.model}),".ad-contents"),this.add(new g({model:this.avatarUser,askForPhoto:!1,size:40}),".yj-avatar-container")},_addUserLinkHovercards:function(){var a=this.$(".yj-hovercard-link");b.each(a,function(a){var b=c(a).data("resource-id");j.trigger("/ui/hovercard/add",c(a),{id:b,type:"user"})},this)},_getTemplateData:function(){return{headerHtml:this._getHeaderHtml(),accHeader:this._getAccessibilityHeaderText(),accCloseBanner:l.t("close_banner")}},_getHeaderHtml:function(){var a,b='<a href="{{url}}" class="yj-hovercard-link" data-resource-id="{{id}}">{{full_name}}</a>',c=d.render(b,{id:this.avatarUser.id,url:n.userIndex(this.avatarUser,m),full_name:this.avatarUser.get("full_name")});return a=0===this.otherUsersCount?l.t("avatar_is_using_yammer_for_mobile",{avatar:c}):1===this.otherUsersCount?l.t("avatar_and_otheruser_are_using_yammer_for_mobile",{avatar:c,otherUser:d.render(b,{id:this.otherUsers[0].id,url:n.userIndex(this.otherUsers[0],m),full_name:this.otherUsers[0].get("full_name")})}):this.otherUsersCount<20?l.t("avatar_and_link_count_others_are_using_yammer_for_mobile",{avatar:c,count:this.otherUsersCount,link:'<a href="javascript://" class="yj-others">{$0}</a>'}):l.t("avatar_and_twentyplus_are_using_yammer_for_mobile",{avatar:c,link:'<a href="javascript://" class="yj-others">{$0}</a>'})},_getAccessibilityHeaderText:function(){var a;return a=0===this.otherUsersCount?l.t("user_is_using_yammer_for_mobile"):l.t("user_and_count_others_are_using_yammer_for_mobile",{count:this.otherUsersCount,user:this.avatarUser.full_name})},_handleClose:function(){this.model.setClosed(),this.$el.slideToggle(this.remove.bind(this)),k.event("yammer_promote_mobile_on_web",{source:"in_feed_ad_close"})},_handleOthersClick:function(a){a.preventDefault(),this._showOthersLightbox()},_showOthersLightbox:function(){var a=this.otherUsers,c=b.map(a,function(a){return h.findById(a.get("id"))});new i({load:function(){this.loadItems(c)},settings:{title:l.t("people_using_yammer_for_mobile"),open:!0}})}})}),define("css!feeds/lib/ui/threads/future/thread_list",[],function(){}),define("stache!feeds/lib/ui/threads/future/thread_list",["mustache"],function(a){var b='<div class="yj-thread-list--publisher yj-message-form-selector"></div>\n<div class="yj-thread-list--body yj-list-container">\n  {{! header for screenreader users }}\n  {{#feedHeaderText}}<span class="yj-acc-hidden"><h2>{{feedHeaderText}}</h2></span>{{/feedHeaderText}}\n  {{#displayFeedFilter}}<div class="yj-thread-list--filter yj-feed-filter"></div>{{/displayFeedFilter}}\n  <div class="yj-thread-list--toggle yj-feed-toggle-container"></div>\n\n  {{#showMarkAllAsViewed}}\n  <div class="yj-thread-list--unread-header-container"></div>\n  {{/showMarkAllAsViewed}}\n\n  <div class="yj-thread-list--notices yj-notices-container">\n    <div class="yj-thread-list--loading-indicator yj-spinner-loading">{{loadingText}}</div>\n    <div class="yj-thread-list--new-messages-notice is-hidden yj-new-messages-notice" style="display:none">\n      <a class="yj-thread-list--new-message-link yj-new-messages-link yj-btn yj-btn-alt yj-btn-wide" href="javascript://" role="button">\n        <span class="yj-thread-list--new-message-text yj-notice-text"></span>\n      </a>\n    </div>\n  </div>\n\n  <div class="yj-thread-list--content-container">\n    <ul class="yj-thread-list--content yj-feed-messages" data-qaid="feed"></ul>\n  </div>\n\n  {{#isUnviewedFeed}}\n    <div class="yj-thread-list--banner-container"></div>\n  {{/isUnviewedFeed}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/threads/future/thread_list_no_items",["mustache"],function(a){var b='<div class="yj-thread-list--no-items-notice yj-message-list-notice yj-no-items-notice">{{messageText}}</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/threads/future/thread_list_failed_to_load",["mustache"],function(a){var b='<div class="yj-thread-list--reload-page-notice yj-reload-page-notice yj-message-list-notice">\n  <a href="#" role="button">{{clickToReload}}</a>. {{message}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/threads/future/thread_list",["require","underscore","jquery","core/lib/backbone_legacy_integration","models/feed_backbone","collections/groups","models/group","feeds/lib/ui/threads/future/feed_delegate","feeds/lib/ui/threads/future/thread_list_item","feeds/lib/ui/publisher/global/thread_starter_publisher","feeds/lib/ui/messages/featured_feed_seller","feeds/lib/ui/feeds/feed_toggle","common-ui/lib/ui/shared/more_button","components/end_of_unread_feed_banner/index","components/group_unread_header/index","feeds/lib/helper/threads_helper","models/lib/helper/message/message_action_mixin","common-ui/lib/ui/shared/scroll_spy","core/lib/session","components/suite_nav/src/suite_nav","common-ui/lib/helper/yerf","common-ui/lib/helper/custom_timing","feeds/lib/ui/feeds/mobile_ad_item","models/lib/model/helper/report_feed_events","core/lib/tr","core/lib/treatment","backbone","core/lib/log","core/lib/yammer_config","core/lib/report","models/lib/model/helper/log_viewed_threads","models/lib/orm-models","common-ui/lib/helper/ui","models/lib/helper/assured_delivery_experiments","common-ui/lib/ui/keyboard/linear_navigator","feeds/lib/ui/threads/future/thread_list_commands","models/helpers/user","common-ui/lib/ui/accessibility/screenreader_announcer","common-ui/lib/ui/accessibility/focus_helper","css!./thread_list","html!./thread_list","html!./thread_list_no_items","html!./thread_list_failed_to_load"],function(a){"use strict";var b=a("underscore"),c=a("jquery"),d=a("core/lib/backbone_legacy_integration"),e=a("models/feed_backbone"),f=a("collections/groups"),g=a("models/group"),h=a("feeds/lib/ui/threads/future/feed_delegate"),i=a("feeds/lib/ui/threads/future/thread_list_item"),j=a("feeds/lib/ui/publisher/global/thread_starter_publisher"),k=a("feeds/lib/ui/messages/featured_feed_seller"),l=a("feeds/lib/ui/feeds/feed_toggle"),m=a("common-ui/lib/ui/shared/more_button"),n=a("components/end_of_unread_feed_banner/index"),o=a("components/group_unread_header/index"),p=a("feeds/lib/helper/threads_helper"),q=a("models/lib/helper/message/message_action_mixin"),r=a("common-ui/lib/ui/shared/scroll_spy"),s=a("core/lib/session"),t=a("components/suite_nav/src/suite_nav"),u=a("common-ui/lib/helper/yerf"),v=a("common-ui/lib/helper/custom_timing"),w=a("feeds/lib/ui/feeds/mobile_ad_item"),x=a("models/lib/model/helper/report_feed_events"),y=a("core/lib/tr"),z=a("core/lib/treatment"),A=a("backbone"),B=a("core/lib/log"),C=a("core/lib/yammer_config"),D=a("core/lib/report"),E=a("models/lib/model/helper/log_viewed_threads"),F=a("models/lib/orm-models"),G=a("common-ui/lib/helper/ui"),H=a("models/lib/helper/assured_delivery_experiments"),I=a("common-ui/lib/ui/keyboard/linear_navigator"),J=a("feeds/lib/ui/threads/future/thread_list_commands"),K=a("models/helpers/user"),L=a("common-ui/lib/ui/accessibility/screenreader_announcer"),M=a("common-ui/lib/ui/accessibility/focus_helper");a("css!./thread_list");var N=3e4;return d.extend({className:"yj-thread-list yj-list-wrapper",events:{"click .yj-thread-list--new-messages-notice":"handleRedrawClick","click .yj-thread-list--reload-page-notice a":"_onReloadClick"},template:a("html!./thread_list"),noItemsTemplate:a("html!./thread_list_no_items"),failedToLoadTemplate:a("html!./thread_list_failed_to_load"),_applySettings:function(a){var c=b.keys(this.settings);return this.settings=b.extend({},this.settings,b.pick(a,c)),C.config().isEmbed||(this.settings.markAsViewedOnScroll=!0),this.settings},initialize:function(a){var c=this._applySettings(a);this.feed=a.feed,this.feedId=a.feedId,this._allItems={},a.delegate&&(this._delegate=a.delegate),this.spLightBox=a.spLightBox&&C.config().isEmbed,this._errorCallback=a.error,this._createScrollSpy(),this.settings.markAsViewedOnScroll&&this._addMarkAsViewedListeners(),this._startScrollSpyWithDelay(),x.reportFeedEvent("feed_visit_start",this.feed.getLogSource(),this.feedId,{feed_view:this.feed.getLogFeedView()}),c.hideThreadStarter||this.addPublisher(),c.useFeedToggle&&this.addFeedToggle(),c.showFeedSeller&&this.addFeedSeller(),c.hideMoreButton||this.addMoreButton(),this._isUnviewedFeed()&&(this.addEndOfUnreadFeedBanner(),z.treatment("tow_group_mark_all_as_viewed")&&(this.addGroupUnreadHeader(),this.listenTo(this._groupUnreadHeader,"markAllAsViewed",this._onMarkAllAsViewed),this.listenTo(this.feed.feedCounter,"markAllAsViewedSuccess",this._onMarkAllAsViewedSuccess),this.listenTo(this.feed.feedCounter,"markAllAsViewedError",this._onMarkAllAsViewedError))),b.extend(this,q,p),this._threadsWithNewReplies={},this._lastSeenMessageId=0,this.subscribeToData(),this._shouldClearNotices=!1,z.treatment("keyboardshortcuts2")&&(this.threadNavigator=new I,this.listenTo(this.threadNavigator,"getCandidates",this._getThreadNavigationCandidates),this.commands=new J({navigator:this.threadNavigator}))},remove:function(){this._delegate.cleanup(),clearTimeout(this.loadTimeout),this.threadNavigator&&this.threadNavigator.stop(),this.commands&&this.commands.stop(),c(window).off("scroll.markAsReadDelay"),this.stopScrollSpy(),this.settings.markAsViewedOnScroll&&E.flushPendingViewedThreads(),this._infiniteScrollSpy&&(this._infiniteScrollSpy.destroy(),this._reportWaitingSpy.destroy()),this._bannerScrollSpy&&this._bannerScrollSpy.destroy(),x.reportFeedEvent("feed_visit_end",this.feed.getLogSource(),this.feedId,{feed_view:this.feed.getLogFeedView()}),A.off("/feed/threads/redraw",this.handleRedraw,this),b.each(this._allItems,this._removeListItem),this._allItems=null,this.$list=null},_isUnviewedFeed:function(){return H.isOcularSupportedFeed(this.feed)&&this.feed.isUnviewed()},_removeListItem:function(a){a.remove&&a.remove(),a.destroy&&a.destroy()},_resolveGroupCountClearOnScroll:function(){this.listenTo(this.scrollSpy.scrollMonitor,"scroll",function(a){Math.abs(a)>0&&this.stopListening(this.scrollSpy.scrollMonitor,"scroll")}.bind(this))},_createScrollSpy:function(){this.scrollSpy||(this.scrollSpy=new r(".yj-thread-list-item",{container:window,bottomOffset:-70,scrollInterval:100}))},_startScrollSpyWithDelay:function(){var a=100,d=H.isOcularSupportedFeed(this.feed)?2e3:1e3;this.scrollSpyReady=new c.Deferred;var e=function(){this.scrollSpyReady.resolve()}.bind(this);this.scrollSpyReadyTimeout=setTimeout(e,d),c(window).on("scroll.markAsReadDelay",function(){window.pageYOffset>0&&(e(),c(window).off("scroll.markAsReadDelay"))}),this.startScrollSpy=b.debounce(this.startScrollSpy,a)},_addMarkAsViewedListeners:function(){this.listenTo(this.scrollSpy,"scrolledInTop",b.partial(this.checkViewed,"top")),this.listenTo(this.scrollSpy,"scrolledInBottom",b.partial(this.checkViewed,"bottom"));
},startScrollSpy:function(){this.scrollSpy&&this.scrollSpyReady.then(this.scrollSpy.reload.bind(this.scrollSpy))},stopScrollSpy:function(){clearTimeout(this.scrollSpyReadyTimeout),this.scrollSpy&&this.scrollSpy.destroy()},checkViewed:function(a,b){var d=c(b).data("thread-id");if(d){var e=this.getThreadListItem(d);e&&e.scrolledIn(a)}},addPublisher:function(){var a=this._getGroup(),b=this._getFeed(),c=this.feed&&(this.feed.hasKeyType("algo")||this.feed.hasKeyType("following")||this.feed.hasKeyType("myAll")),d=new j({logSource:b.getLogSource(),showAnnouncements:this._showAnnouncements(),isHomeFeedPublisher:c});d.model.set("feed",b),c||d.model.get("recipients").add(a),d.model.on("clear",function(){var b=c&&z.treatment("tow_small_ab_primary_composer_defaultless");b||d.model.get("recipients").add(a)},this),d.on("open",function(){null==a.get("name")&&(d.model.get("recipients").remove(a),a=this._getGroup()),d.model.set("feed",b);var e=c&&z.treatment("tow_small_ab_primary_composer_defaultless");e||d.model.hasNonFixedRecipients()||d.model.get("recipients").add(a)},this),this.add(d,".yj-thread-list--publisher:first")},addMoreButton:function(){var a={id:"moreButton",clickCallBack:this._onMoreButtonClick.bind(this)},b=new m(a,this);this.add(b,".yj-thread-list--body:first"),b.render(),this._moreButton=b},addEndOfUnreadFeedBanner:function(){var a=new n({model:this.feed});this.add(a,".yj-thread-list--banner-container"),a.render().hide(),this._endOfUnreadFeedBanner=a},addGroupUnreadHeader:function(){var a=new o({model:this.feed});this.add(a,".yj-thread-list--unread-header-container"),a.render(),this._groupUnreadHeader=a},startEndOfUnreadBannerStickiness:function(){if(!this._bannerScrollSpy){var a=this._endOfUnreadFeedBanner;this._bannerScrollSpy=new r(this.$(".yj-thread-list--banner-container"),{topOffset:120}),this._bannerScrollSpy.on("scrolledAboveTop",a.toggleSticky.bind(a,!0)).on("scrolledBelowTop scrolledInTop",a.toggleSticky.bind(a,!1)).start()}},addFeedToggle:function(){this.$el.addClass("has-feed-toggle");var a,b=this.feed;b.hasKeyType("algo")?a="algo":b.hasKeyType("myAll")?a="my_all":b.hasKeyType("following")&&(a="following"),this.add(new l({feedType:a}),".yj-thread-list--toggle")},addFeedSeller:function(){var a={id:"featuredFeedSeller"},b=new k(a);this.add(b,".yj-thread-list--body:first"),this._featuredFeedSeller=b},getRouteHandler:function(){var a=yam.router;return a&&a.handler},settings:{elementClassName:"threads",useFeedToggle:!1,showFeedSeller:!1,hideThreadStarter:!1,hideMoreButton:!1,disableInfiniteScroll:!1,disableUnreadMarker:!1,markAsViewedOnScroll:!1,accessibilityLabel:void 0},getId:function(){return"threadList"},getFeed:function(){return this._delegate.getFeed()},onReset:function(){clearTimeout(this.loadTimeout),this.handleRedraw(),this._delegate.on("sync",this.onSync,this).on("add:thread",this.handleThreadAdded,this).on("add:message",this.handleNewReply,this).on("remove:thread",this.handleThreadRemoved,this).on("mute:thread",this.handleThreadMuted,this).on("add:mobile-ad",this.handleMobileAdAdded,this)},onSync:function(){this.correctRenderOptions(),this.$list.show(),this.updateMoreButton(),this.startInfiniteScroll(),this._isUnviewedFeed()&&this.checkAndShowEndOfUnreadFeedBanner(),this.trigger("sync")},handleRedrawClick:function(){var a=this.feed;this.handleRedraw(),a.hasKeyType("myAll")&&x.reportFeedEvent("thread_list_see_count_more",a.getLogSource(),this.feedId,{admin:s.getCurrentUser().admin})},handleRedraw:function(){var a=this._delegate.getThreads(),d=a.length,e=c.fx.off,f=window.performance&&"function"==typeof window.performance.now&&window.performance.now();if(this._lastSeenMessageId=this._delegate.getLastSeenMessageId(),H.isOcularSupportedFeed(this.getFeed())&&(this._threadsWithNewReplies={}),this._isFullyRendered=!1,c.fx.off=!0,this.clearNotices(),0===d?this.feed.isUnviewed()||(this.showEmptyState(),this._shouldClearNotices=!0):(this.$list.detach(),b.each(a,this.handleThreadAdded,this),this.correctRenderOptions(),this.$listContainer.append(this.$list),this._delegate.moveCursor(),this.updateMoreButton(),b.defer(this.startInfiniteScroll.bind(this))),this._isUnviewedFeed()&&(this.checkAndShowEndOfUnreadFeedBanner(),z.treatment("tow_group_mark_all_as_viewed")&&(this.toggleMarkAllAsViewedLink(d>0),this.updateMoreButton())),c.fx.off=e,this._isFullyRendered=!0,void 0!==yam.router&&z.treatment("prodsupport_fe_timing")){var g=this.getRouteHandler();if(g.isOriginalFeedLoad){g.isOriginalFeedLoad=!1;var h=this.feed.getLogSource(),i=v.getFeedRenderEventName(h,g.isFastSwitch());u.recordStopWithStartAndParams(i,f,{num_items:d},!0);var j=v.getPageViewEventName(h,g.isFastSwitch());u.recordStopWithStart(j,g.navigationStart)}}this.trigger("render"),window.__phantomas&&window.__phantomas.setMarkerMetric("feedRendered")},getHighestRenderedMessageId:function(){return b.chain(this._allItems).keys().map(this._delegate.getThreadLatestReplyId,this._delegate).max().value()},createThreadListItem:function(a){var b={thread:a,feed:this.feed,feedId:this.feedId,lastSeenMessageId:this._lastSeenMessageId,markAsViewedOnScroll:this.settings.markAsViewedOnScroll,showGroupCallout:this._shouldShowGroupCallout(),threadNavigator:this.threadNavigator};return H.isOcularSupportedFeed(this.feed)&&(b.lastViewedMessageId=a.getLastViewedMessageId(),b.isOcularSupportedFeed=!0),new i(b)},handleThreadAdded:function(a){var b=this._delegate.getModelIndex(a),c=this._allItems[a.id];this.shouldRenderThread(a,b)?(this._shouldClearNotices&&(this.clearNotices(),this._shouldClearNotices=!1),c?((c.$el||c.$element).detach(),c.setLastSeenMessageId&&c.setLastSeenMessageId(this._lastSeenMessageId)):(c=this.createThreadListItem(a),this._allItems[a.id]=c),c.render(),this.insertListItemElement(c.$el||c.$element,b),this._delegate.setThreadAsSeen(a)):this.shouldRenderNewCount(a)&&this.showNewItemNotice(),this.settings.markAsViewedOnScroll&&this.startScrollSpy()},handleMobileAdAdded:function(a){var b,c;b=this._delegate.getModelIndex(a),c=new w({model:a}),c.render(),this.insertListItemElement(c.$el,b)},handleNewReply:function(a){var b=a.getThread(),c=this._allItems[b.id],d=b&&c,e=d&&a.id>c.getNewestRenderedReplyId();e&&(a.sender_id===s.getCurrentUser().id?this._lastSeenMessageId=a.id:(H.isOcularSupportedFeed(this.getFeed())&&(this._threadsWithNewReplies[b.id]=!0),this.showNewItemNotice()))},handleThreadRemoved:function(a){var b=this._allItems[a.id];b&&(b.remove(),delete this._allItems[a.id])},handleThreadMuted:function(a){var b=this._allItems[a.id];b&&b.handleMuteThread.call(b)},shouldRenderThread:function(a,b){if(!a.getThreadStarter())return!1;var c=!this._isFullyRendered,d=a.getThreadStarter().sender_id===s.getCurrentUser().id,e=!1;return e=H.newerRealtimeTreatment(this.feed)?a.getLatestReplyId()<=this._highestRenderedMessageId:b>0,c||e||d},shouldRenderNewCount:function(a){return this._isFullyRendered?H.isOcularSupportedFeed(this.getFeed())?this._getNewItemCount()>0:a.getLatestReplyId()>this._highestRenderedMessageId:!1},insertListItemElement:function(a,b){var c=this.$list.children(".yj-thread-list-item");0>=b?this.$list.prepend(a):b>=c.length?this.$list.append(a):a.insertBefore(c[b])},render:function(){var a=this.settings.accessibilityLabel||y.t("message_list");return this.renderTemplate({displayFeedFilter:this.settings.useFeedToggle,loadingText:y.t("loading"),feedHeaderText:a,isUnviewedFeed:this._isUnviewedFeed(),showMarkAllAsViewed:this._isUnviewedFeed()&&z.treatment("tow_group_mark_all_as_viewed")}),this.$listContainer=this.$el.find(".yj-thread-list--content-container"),this.$list=this.$el.find(".yj-feed-messages"),this.$notices=this.$el.find(".yj-notices-container"),this.$element=this.$el,A.on("/feed/threads/redraw",this.handleRedraw,this),this.observeMessageDomEvents(),this.observeThreadDomEvents(),this.startInfiniteScroll(),this._delegate.fetch({reset:!0}),this._isUnviewedFeed()&&this.startEndOfUnreadBannerStickiness(),c.browser.safari&&t.exists()&&b.defer(G.forceBrowserRepaint),this},getOlderItems:function(a){z.treatment("prodsupport_fe_timing")&&u.recordStart(v.getMoreViewEventName(this.feed.getLogSource())),this._delegate.fetchOlderThreads(a)},subscribeToData:function(){this._delegate||(this._delegate=new h({feed:this.feed})),this._delegate.once("reset",this.onReset,this).on("error",this.onDataError,this),this.loadTimeout=setTimeout(this.onTimeout.bind(this),N)},getMessageListItem:function(a){var c=b.detect(this._allItems,function(b){return b.messages[a]},this);return c?c.messages[a]:void 0},getThreadListItem:function(a){return this._allItems[a]},startInfiniteScroll:function(){var a=this._moreButton,c=this.$(".yj-thread-list-item:nth-last-child(2)"),d=this.$(".yj-more-button-container");this._infiniteScrollSpy?(this._infiniteScrollSpy.reload(c),this._reportWaitingSpy.reload(d)):a&&!this.settings.disableInfiniteScroll&&(this._infiniteScrollSpy=new r(c),this.listenTo(this._infiniteScrollSpy,"scrolledInTop",b.bind(function(){this._delegate.hasOlderItems()&&a.handleClick(),this._infiniteScrollSpy.stop()},this)),this._reportWaitingSpy=new r(d),this.listenTo(this._reportWaitingSpy,"scrolledInBottom",b.bind(function(){D.event("feed_waiting_for_more_threads_at_the_bottom"),this._reportWaitingSpy.stop()},this)))},updateMoreButton:function(){var a=this._moreButton,b=this._delegate.hasOlderItems();a&&(a.stopLoading()&&z.treatment("prodsupport_fe_timing")&&u.recordStop(v.getMoreViewEventName(this.feed.getLogSource())),b?a.show():a.hide(),a.setCount(this._delegate.getOlderUnseenCount(),F.Feed().UNKNOWN_COUNT_VALUE)),this._featuredFeedSeller&&this._featuredFeedSeller.show()},checkAndShowEndOfUnreadFeedBanner:function(){this._endOfUnreadFeedBanner&&!this._delegate.hasOlderItems()&&this._endOfUnreadFeedBanner.show()},toggleMarkAllAsViewedLink:function(a){this._groupUnreadHeader.$el.toggle(a)},_onMarkAllAsViewed:function(){this._delegate.markAllAsViewed()},_onMarkAllAsViewedSuccess:function(){var a=this;M.notifyRemoval(this.$el.find(".yj-thread-list--body")),a.$el.find(".yj-thread-list--body").fadeOut(500,function(){a.feed.setOlderAvailable(!1),a.feed.pruneUsingContentFilter(),a.handleRedraw(),c(this).show()}),L.announceText(y.t("group_mark_all_as_read_success"))},_onMarkAllAsViewedError:function(){A.trigger("/ui/alert/show","error",y.t("sorry_something_went_wrong_try_again"))},_getGroup:function(){var a=this.feed,b=a.groupId||a.group_id||a.getGroupId&&a.getGroupId(),c=null!=b?f.get(b):g.ALL_COMPANY();return null==c&&(c={id:b,name:a.name,private:!!a.private,type:"group"}),(c=yam.backbone.model.Recipient.fromOriginalModel(c))?(c.set("fixed",null!=b),c):void B.warn("ThreadList: could not determine group")},_getFeed:function(){return e.fromOriginalModel(this.feed)},_showAnnouncements:function(){var a=this._getGroup();return K.canAnnounce(s.getCurrentUser(),a)},_onMoreButtonClick:function(){this.trigger("more_button_click.embed_no_default_group"),this.getOlderItems()},onDataError:function(){var a=this._moreButton;a&&(a.stopLoading(),a.showError()),clearTimeout(this.loadTimeout),this.failedToLoad()},onTimeout:function(){D.event("feed_timeout",{feed_type:K.getPrescribedFeedType(s.getCurrentUser())}),this.failedToLoad()},clearNotices:function(){this.$notices&&(M.notifyRemoval(this.$notices),this.$notices.children().hide().filter(".yj-thread-list--new-messages-notice").addClass("is-hidden"))},showNewItemNotice:function(){if(!this.settings.disableUnreadMarker){var a=H.isOcularSupportedFeed(this.getFeed())?this._getNewItemCount():this._delegate.getUnseenCount(),c=this.$notices.children(".yj-thread-list--new-messages-notice");if(0===a)return c.hide().addClass("is-hidden");var d=y.t("click_to_see_count_new_messages",{count:a});c.find(".yj-thread-list--new-message-text").text(d),c.hasClass("is-hidden")&&b.defer(function(){c.removeClass("is-hidden")}),c.show(),A.trigger("/ui/reflow/vertical")}},_getNewItemCount:function(){var a=this._delegate.getThreads().length,c=b.size(this._allItems),d=a-c,e=b.keys(this._threadsWithNewReplies).length,f=d+e;return f},failedToLoad:function(){if(this._errorCallback&&this._errorCallback(),this.clearNotices(),this.$notices){var a=this.failedToLoadTemplate({clickToReload:y.t("click_here_to_reload"),message:y.t("if_the_issue_persists_please_contact_support")});this.$notices.append(a)}},_onReloadClick:function(a){a.preventDefault(),window.location.reload()},_getEmptyStateMessage:function(){var a,b=this.feed;return a=b.hasKeyType("following")?y.t("there_are_no_messages_for_items_you_are_following"):b.hasKeyType("bookmarks")?y.t("you_have_no_bookmarked_messages"):b.isGroup()||b.isAllCompany()?y.t("no_messages_posted_to_this_group_yet"):this.spLightBox?y.t("conversations_will_be_seen_by_your_coworkers_here_and_on"):y.t("there_are_no_messages_in_this_feed")},showEmptyState:function(){var a=this._getEmptyStateMessage(),b=this.noItemsTemplate({messageText:a});this.$notices.append(b)},correctRenderOptions:function(){if(this._highestRenderedMessageId=this.getHighestRenderedMessageId(),!H.isOcularSupportedFeed(this.feed)&&!this.settings.disableUnreadMarker){var a,c,d,e=this._getThreadPositions(),f=b.pluck(e,"index");c=this._delegate.getLastSeenModelIndex(this._lastSeenMessageId),a=b.min(f),this._delegate.hasOlderItems()||(d=b.max(f));var g={first:a,firstSeen:c,lastUnseen:c-1,lastThreadIndex:d};b.each(e,this._correctRenderOptions.bind(this,g))}},_correctRenderOptions:function(a,c){var d=c.index,e=this._allItems[c.threadId],f=b.object(b.map(a,function(b,c){return[c,a[c]===d]}));e.setRenderOptions(f)},_getThreadPositions:function(){return b.chain(this._allItems).keys().map(this._getThreadPosition,this).value()},_getThreadPosition:function(a){a=parseInt(a,10);var b=this._delegate.indexForThreadId(a);return{threadId:a,index:b}},_shouldShowGroupCallout:function(){var a=this.feed,b=a&&(a.isGroup()||a.isAllCompany());return!b},_getThreadNavigationCandidates:function(){var a=this._delegate.getThreads();this.threadNavigator.set("candidates",a)}})}),define("workfeed/lib/app/views/threads/about_topic",["require","jquery","core/lib/backbone_base_class","feeds/lib/ui/threads/future/thread_list","models/lib/helper/feed_factory","models/helpers/feed","common-ui/lib/helper/ui"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_base_class"),d=a("feeds/lib/ui/threads/future/thread_list"),e=a("models/lib/helper/feed_factory"),f=a("models/helpers/feed"),g=a("common-ui/lib/helper/ui");return c.extend({initialize:function(){var a=this.options,c=a.appId;g.setSelectedTabForFeed(c);var h,i=a.feedId,j=f.getAppId("links"),k=f.getAppId("polls"),l=f.getAppId("announcements");h=j&&j===c?e.findOrCreate("topicLinks",i):k&&k===c?e.findOrCreate("topicPolls",i):l&&l===c?e.findOrCreate("topicAnnouncements",i):e.findOrCreate("topic",i);var m=new d({feed:h,feedId:i,hideThreadStarter:!0});b(".yj-main-messagelist-container:first").append(m.render().$el),this.threadList=m},remove:function(){this.threadList.remove()}})}),define("stache!workfeed/lib/app/sidebar/group_pending_members",["mustache"],function(a){var b='{{#pending_count}}\n  <div class="yj-group-pending-members yj-quick-links">\n    <h2 class="yj-group-pending-members--header">\n      {{group_pending_header_label}}\n    </h2>\n    <ul class="yyj-group-pending-members--list">\n      <li class="yj-group-pending-members--list-item">\n        <p class="yj-group-pending-members--pending-requests">\n          <span class="yj-group-pending-members--pending-requests-text">\n            {{pending_requests_label}}\n          </span>\n          <a href="#" class="yj-btn pending-review" role="button">\n            {{review_label}}\n          </a>\n        </p>\n      </li>\n    </ul>\n  </div>\n{{/pending_count}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/sidebar/group_pending_members",[],function(){}),define("workfeed/lib/app/sidebar/group_pending_members",["require","underscore","core/lib/tr","core/lib/session","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/ui/groups/member_list","html!./group_pending_members","css!./group_pending_members"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("common-ui/lib/ui/groups/member_list"),h=a("html!./group_pending_members");a("css!./group_pending_members");var i={group_pending_header_label:c.t("group_pending_members_header_label"),review_label:c.t("group_pending_requests_review_label")},j=e.extend({mixins:[f],template:h,events:{"click .pending-review":"_onClickReview"},initialize:function(){this.listenTo(this.model,"change:pending_requests_count",this.render),this.listenTo(this.model,"change:suggested_requests_count",this.render)},getTemplateData:function(){var a=this._getPendingMembersCount();return b.extend({pending_count:a,pending_requests_label:c.t("group_pending_member_requests_label",{count:a})},i)},_getPendingMembersCount:function(){var a=this.model,b=a.get("pending_requests_count"),c=a.get("suggested_requests_count");return b+c},_onClickReview:function(a){a.preventDefault();var b=this.model,c=d.getCurrentNetwork(),e=new g({groupId:b.get("id"),permalink:b.get("name"),isCommunity:c.get("community")});e.setParent(this),g.showInLightbox(e)}});return j}),define("stache!workfeed/lib/app/sidebar/group_info",["mustache"],function(a){var b='{{#has_info}}\n  <div class="yj-group-info">\n    <h2 class="yj-group-info--header">\n      <a href="{{info_url}}" class="yj-group-info--header-link">\n        {{info_label}}\n      </a>\n      {{#can_edit}}\n      <a href="{{info_url}}" class="yj-group-info--header-edit">{{edit_label_short}}</a>\n      {{/can_edit}}\n    </h2>\n    <div class="yj-group-info--body">\n      {{{body}}}\n    </div>\n  </div>\n{{/has_info}}\n{{^has_info}}\n  <div class="yj-group-info">\n    <h2 class="yj-group-info--header">\n      {{info_label}}\n    </h2>\n    <p class="yj-group-info--edit">\n      <a href="{{edit_url}}">\n        {{edit_label}}\n      </a>\n    </p>\n  </div>\n{{/has_info}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/sidebar/group_info",[],function(){}),define("workfeed/lib/app/sidebar/group_info",["require","underscore","core/lib/tr","common-ui/lib/helper/html_truncator","common-ui/lib/ui/accessibility/accessibility_util","models/helpers/group","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./group_info","core/lib/report","core/lib/urls","css!./group_info"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("common-ui/lib/helper/html_truncator"),e=a("common-ui/lib/ui/accessibility/accessibility_util"),f=a("models/helpers/group"),g=a("core/lib/backbone_base_view"),h=a("core/lib/backbone_with_auto_render"),i=a("html!./group_info"),j=a("core/lib/report"),k=a("core/lib/urls");a("css!./group_info");var l={info_label:c.t("group_sidebar_info_label"),see_all_label:c.t("group_sidebar_info_see_all_label"),edit_label:c.t("group_sidebar_info_edit_label"),edit_label_short:c.t("group_info_edit")},m=g.extend({mixins:[h],template:i,initialize:function(){this.listenTo(this.model,"change:group_info",this.render)},events:{"click .custom-notice-raise-pinned-test a":function(){j.event("rr_groups_info")}},getTemplateData:function(){var a=this.model,e=a.get("group_info"),g=k.groupInfo(a),h={length:500,ellipsis:"... ",expandText:c.t("see_all_4")},i=d.truncateWithLink(e,h);return b.extend({info_url:g,has_info:!!e,has_info_truncated:e!==i,see_all_url:k.groupInfo(a),edit_url:k.groupInfo(a),can_edit:f.isEditableByCurrentUser(a),body:i},l)},render:function(){var a=this.model;this.$(".expand-collapse-link").attr("href",k.groupInfo(a)),e.adjustAccessibilityHeadingLevels(this.$(".yj-group-info--body"),2)}});return m}),define("stache!feeds/lib/ui/ogos/selector",["mustache"],function(a){var b='<form class="yj-add-link-form">\n  <div class="yj-add-link-lightbox-field-wrap">\n    <span class="yj-error" style="display:none">\n      {{invalid_url_error}}\n    </span>\n\n    <label class="yj-add-link-lightbox-label">\n      {{url_label}}\n      <input type="text" name="link_url" value="https://"\n        class="yj-link-text yj-add-link-lightbox-field-url yj-add-link-lightbox-field"\n        aria-required="true">\n    </label>\n\n    <div class="clear"></div>\n  </div>\n\n  <div class="yj-add-link-lightbox-field-wrap">\n    <label class="yj-add-link-lightbox-label">\n      {{title_label}}\n      <input type="text" name="link_title" placeholder="{{optional_label}}"\n        class="yj-link-text yj-add-link-lightbox-field yj-add-link-lightbox-field-title">\n    </label>\n\n    <span class="yj-add-link-lightbox-spinner-container">\n      <span class="yj-add-link-lightbox-spinner yj-inline-spinner" style="display:none"></span>\n    </span>\n\n    <div class="clear"></div>\n\n    <div class="yj-add-link-preview" style="display:none"></div>\n  </div>\n\n  <div class="yj-add-link-submit-wrap">\n    <button class="yj-btn yj-add-link-form-submit yj-btn-disabled unstyle-button-as-span">\n      {{button_label}}\n    </button>\n  </div>\n</form>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/ogos/selector",["require","underscore","core/lib/tr","backbone","core/lib/uri_helper","core/lib/yammer_api","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","models/ogo","feeds/lib/ui/publisher/global/ogo_hydrator","html!./selector"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("backbone"),e=a("core/lib/uri_helper"),f=a("core/lib/yammer_api"),g=a("core/lib/backbone_base_view"),h=a("core/lib/backbone_with_auto_render"),i=a("models/ogo"),j=a("feeds/lib/ui/publisher/global/ogo_hydrator"),k=a("html!./selector"),l={url_label:c.t("url"),title_label:c.t("title"),optional_label:c.t("optional_field"),button_label:c.t("add"),read_only_label:c.t("this_title_cannot_be_edited"),invalid_url_error:c.t("please_enter_a_valid_url"),request_error:c.t("there_was_a_problem_processing_your_request_please_try_again")},m=g.extend({mixins:[h],template:k,events:{"input .yj-add-link-lightbox-field-url":"_onFieldInput","submit .yj-add-link-form":"_onSubmit"},initialize:function(a){this.model=new i,this.hydrator=new j({model:this.model,groupId:a.groupId}),this.listenTo(this.model,"change",this._onChangeModel)},render:function(){this.$url=this.$(".yj-add-link-lightbox-field-url"),this.$title=this.$(".yj-add-link-lightbox-field-title"),this.$button=this.$(".yj-add-link-form-submit"),this.$spinner=this.$(".yj-add-link-lightbox-spinner"),this.$url.focus(),this.disable()},getTemplateData:function(){return l},enable:function(){this._setTitle(this.model.get("name")),this.toggle(!0)},disable:function(){this._setTitle(""),this.toggle(!1)},toggle:function(a){this.$title.prop("readOnly",!a).toggleClass("yj-disabled",!a),this.$button.prop("disabled",!a).toggleClass("yj-btn-disabled",!a)},startProgress:function(){this.$spinner.show(),this.hydrator.hydrate()},stopProgress:function(){this.$spinner.hide()},_getUrl:function(){return this.$url.val()},_getTitle:function(){return this.$title.val()},_setTitle:function(a){return this.$title.val(a)},_isValid:function(){var a=this._getUrl(),b=a.match(e.HREF_PATTERN);return b&&b[0]===a},_onFieldInput:b.debounce(function(){var a=this._getUrl(),b=this.model.get("original"),c=this.model.get("progress");a!==b&&(this.hydrator.abort(),this._isValid()?null!=c&&100!==c||this.model.set({url:a,original:a}):(this.disable(),this.stopProgress()))},500),_onChangeModel:function(){var a=this.model.get("progress");null==a?(this.disable(),this.startProgress()):100===a&&(this.enable(),this.stopProgress())},_onSubmit:function(a){a.preventDefault();var b={url:this.model.get("url"),official_title:this._getTitle()},c=this;f.updateOpenGraphObjects(b).then(function(a){c.trigger("select",a),d.trigger("/ui/lightbox/close")},function(){d.trigger("/ui/alert/show","error",l.request_error)})}});return m}),
// License: http://dragsort.codeplex.com/license
function(a){a.fn.dragsort=function(b){if("destroy"==b)return void a(this.selector).trigger("dragsort-uninit");var c=a.extend({},a.fn.dragsort.defaults,b),d=[],e=null,f=null;return this.each(function(b,g){a(g).is("table")&&1==a(g).children().size()&&a(g).children().is("tbody")&&(g=a(g).children().get(0));var h={draggedItem:null,placeHolderItem:null,pos:null,offset:null,offsetLimit:null,scroll:null,container:g,init:function(){c.tagName=0==a(this.container).children().size()?"li":a(this.container).children().get(0).tagName.toLowerCase(),""==c.itemSelector&&(c.itemSelector=c.tagName),""==c.dragSelector&&(c.dragSelector=c.tagName),""==c.placeHolderTemplate&&(c.placeHolderTemplate="<"+c.tagName+">&nbsp;</"+c.tagName+">"),a(this.container).attr("data-listidx",b).mousedown(this.grabItem).bind("dragsort-uninit",this.uninit),this.styleDragHandlers(!0)},uninit:function(){var b=d[a(this).attr("data-listidx")];a(b.container).unbind("mousedown",b.grabItem).unbind("dragsort-uninit"),b.styleDragHandlers(!1)},getItems:function(){return a(this.container).children(c.itemSelector)},styleDragHandlers:function(b){this.getItems().map(function(){return a(this).is(c.dragSelector)?this:a(this).find(c.dragSelector).get()}).css("cursor",b?"pointer":"")},grabItem:function(b){var e=d[a(this).attr("data-listidx")],f=a(b.target).closest("[data-listidx] > "+c.tagName).get(0),g=e.getItems().filter(function(){return this==f}).size()>0;if(!(1!=b.which||a(b.target).is(c.dragSelectorExclude)||a(b.target).closest(c.dragSelectorExclude).size()>0)&&g){b.preventDefault();for(var h=b.target;!a(h).is(c.dragSelector);){if(h==this)return;h=h.parentNode}a(h).attr("data-cursor",a(h).css("cursor")),a(h).css("cursor","move");var i=this,j=function(){e.dragStart.call(i,b),a(e.container).unbind("mousemove",j)};a(e.container).mousemove(j).mouseup(function(){a(e.container).unbind("mousemove",j),a(h).css("cursor",a(h).attr("data-cursor"))})}},dragStart:function(b){null!=e&&null!=e.draggedItem&&e.dropItem(),e=d[a(this).attr("data-listidx")],e.draggedItem=a(b.target).closest("[data-listidx] > "+c.tagName),e.draggedItem.attr("data-origpos",a(this).attr("data-listidx")+"-"+a(e.container).children().index(e.draggedItem));var f=parseInt(e.draggedItem.css("marginTop")),g=parseInt(e.draggedItem.css("marginLeft"));if(e.offset=e.draggedItem.offset(),e.offset.top=b.pageY-e.offset.top+(isNaN(f)?0:f)-1,e.offset.left=b.pageX-e.offset.left+(isNaN(g)?0:g)-1,!c.dragBetween){var h=0==a(e.container).outerHeight()?Math.max(1,Math.round(.5+e.getItems().size()*e.draggedItem.outerWidth()/a(e.container).outerWidth()))*e.draggedItem.outerHeight():a(e.container).outerHeight();e.offsetLimit=a(e.container).offset(),e.offsetLimit.right=e.offsetLimit.left+a(e.container).outerWidth()-e.draggedItem.outerWidth(),e.offsetLimit.bottom=e.offsetLimit.top+h-e.draggedItem.outerHeight()}var i=e.draggedItem.height(),j=e.draggedItem.width();if("tr"==c.tagName?(e.draggedItem.children().each(function(){a(this).width(a(this).width())}),e.placeHolderItem=e.draggedItem.clone().attr("data-placeholder",!0),e.draggedItem.after(e.placeHolderItem),e.placeHolderItem.children().each(function(){a(this).css({borderWidth:0,width:a(this).width()+1,height:a(this).height()+1}).html("&nbsp;")})):(e.draggedItem.after(c.placeHolderTemplate),e.placeHolderItem=e.draggedItem.next().css({height:i,width:j}).attr("data-placeholder",!0)),"td"==c.tagName){var k=e.draggedItem.closest("table").get(0);a("<table id='"+k.id+"' style='border-width: 0px;' class='dragSortItem "+k.className+"'><tr></tr></table>").appendTo("body").children().append(e.draggedItem)}var l=e.draggedItem.attr("style");e.draggedItem.attr("data-origstyle",l?l:""),e.draggedItem.css({position:"absolute",opacity:.8,"z-index":999,height:i,width:j}),e.scroll={moveX:0,moveY:0,maxX:a(document).width()-a(window).width(),maxY:a(document).height()-a(window).height()},e.scroll.scrollY=window.setInterval(function(){if(c.scrollContainer!=window)return void a(c.scrollContainer).scrollTop(a(c.scrollContainer).scrollTop()+e.scroll.moveY);var b=a(c.scrollContainer).scrollTop();(e.scroll.moveY>0&&b<e.scroll.maxY||e.scroll.moveY<0&&b>0)&&(a(c.scrollContainer).scrollTop(b+e.scroll.moveY),e.draggedItem.css("top",e.draggedItem.offset().top+e.scroll.moveY+1))},10),e.scroll.scrollX=window.setInterval(function(){if(c.scrollContainer!=window)return void a(c.scrollContainer).scrollLeft(a(c.scrollContainer).scrollLeft()+e.scroll.moveX);var b=a(c.scrollContainer).scrollLeft();(e.scroll.moveX>0&&b<e.scroll.maxX||e.scroll.moveX<0&&b>0)&&(a(c.scrollContainer).scrollLeft(b+e.scroll.moveX),e.draggedItem.css("left",e.draggedItem.offset().left+e.scroll.moveX+1))},10),a(d).each(function(a,b){b.createDropTargets(),b.buildPositionTable()}),e.setPos(b.pageX,b.pageY),a(document).bind("mousemove",e.swapItems),a(document).bind("mouseup",e.dropItem),c.scrollContainer!=window&&a(window).bind("wheel",e.wheel)},setPos:function(b,d){var f=d-this.offset.top,g=b-this.offset.left;c.dragBetween||(f=Math.min(this.offsetLimit.bottom,Math.max(f,this.offsetLimit.top)),g=Math.min(this.offsetLimit.right,Math.max(g,this.offsetLimit.left)));var h=this.draggedItem.offsetParent().not("body").offset();if(null!=h&&(f-=h.top,g-=h.left),c.scrollContainer==window)d-=a(window).scrollTop(),b-=a(window).scrollLeft(),d=Math.max(0,d-a(window).height()+5)+Math.min(0,d-5),b=Math.max(0,b-a(window).width()+5)+Math.min(0,b-5);else{var i=a(c.scrollContainer),j=i.offset();d=Math.max(0,d-i.height()-j.top)+Math.min(0,d-j.top),b=Math.max(0,b-i.width()-j.left)+Math.min(0,b-j.left)}e.scroll.moveX=0==b?0:b*c.scrollSpeed/Math.abs(b),e.scroll.moveY=0==d?0:d*c.scrollSpeed/Math.abs(d),this.draggedItem.css({top:f,left:g})},wheel:function(b){if(e&&c.scrollContainer!=window){var d=a(c.scrollContainer),f=d.offset();if(b=b.originalEvent,b.clientX>f.left&&b.clientX<f.left+d.width()&&b.clientY>f.top&&b.clientY<f.top+d.height()){var g=(0==b.deltaMode?1:10)*b.deltaY;d.scrollTop(d.scrollTop()+g),b.preventDefault()}}},buildPositionTable:function(){var b=[];this.getItems().not([e.draggedItem[0],e.placeHolderItem[0]]).each(function(c){var d=a(this).offset();d.right=d.left+a(this).outerWidth(),d.bottom=d.top+a(this).outerHeight(),d.elm=this,b[c]=d}),this.pos=b},dropItem:function(){if(null!=e.draggedItem){var b=e.draggedItem.attr("data-origstyle");if(e.draggedItem.attr("style",b),""==b&&e.draggedItem.removeAttr("style"),e.draggedItem.removeAttr("data-origstyle"),e.styleDragHandlers(!0),e.placeHolderItem.before(e.draggedItem),e.placeHolderItem.remove(),a("[data-droptarget], .dragSortItem").remove(),window.clearInterval(e.scroll.scrollY),window.clearInterval(e.scroll.scrollX),e.draggedItem.attr("data-origpos")!=a(d).index(e)+"-"+a(e.container).children().index(e.draggedItem)&&0==c.dragEnd.apply(e.draggedItem)){var f=e.draggedItem.attr("data-origpos").split("-"),g=a(d[f[0]].container).children().not(e.draggedItem).eq(f[1]);g.size()>0?g.before(e.draggedItem):0==f[1]?a(d[f[0]].container).prepend(e.draggedItem):a(d[f[0]].container).append(e.draggedItem)}return e.draggedItem.removeAttr("data-origpos"),e.draggedItem=null,a(document).unbind("mousemove",e.swapItems),a(document).unbind("mouseup",e.dropItem),c.scrollContainer!=window&&a(window).unbind("wheel",e.wheel),!1}},swapItems:function(b){if(null==e.draggedItem)return!1;e.setPos(b.pageX,b.pageY);for(var g=e.findPos(b.pageX,b.pageY),h=e,i=0;-1==g&&c.dragBetween&&i<d.length;i++)g=d[i].findPos(b.pageX,b.pageY),h=d[i];if(-1==g)return!1;var j=function(){return a(h.container).children().not(h.draggedItem)},k=j().not(c.itemSelector).each(function(a){this.idx=j().index(this)});return null==f||f.top>e.draggedItem.offset().top||f.left>e.draggedItem.offset().left?a(h.pos[g].elm).before(e.placeHolderItem):a(h.pos[g].elm).after(e.placeHolderItem),k.each(function(){var b=j().eq(this.idx).get(0);this!=b&&j().index(this)<this.idx?a(this).insertAfter(b):this!=b&&a(this).insertBefore(b)}),a(d).each(function(a,b){b.createDropTargets(),b.buildPositionTable()}),f=e.draggedItem.offset(),!1},findPos:function(a,b){for(var c=0;c<this.pos.length;c++)if(this.pos[c].left<a&&this.pos[c].right>a&&this.pos[c].top<b&&this.pos[c].bottom>b)return c;return-1},createDropTargets:function(){c.dragBetween&&a(d).each(function(){var b=a(this.container).find("[data-placeholder]"),d=a(this.container).find("[data-droptarget]");b.size()>0&&d.size()>0?d.remove():0==b.size()&&0==d.size()&&("td"==c.tagName?a(c.placeHolderTemplate).attr("data-droptarget",!0).appendTo(this.container):a(this.container).append(e.placeHolderItem.removeAttr("data-placeholder").clone().attr("data-droptarget",!0)),e.placeHolderItem.attr("data-placeholder",!0))})}};h.init(),d.push(h)}),this},a.fn.dragsort.defaults={itemSelector:"",dragSelector:"",dragSelectorExclude:"input, textarea",dragEnd:function(){},dragBetween:!1,placeHolderTemplate:"",scrollContainer:window,scrollSpeed:5}}(jQuery),define("jquery-dragsort",function(){}),define("css!workfeed/lib/app/sidebar/related_contents",[],function(){}),define("css!workfeed/lib/app/sidebar/related_content",[],function(){}),define("stache!workfeed/lib/app/sidebar/related_content",["mustache"],function(a){var b='{{#is_editable}}\n  <span class="yj-dnd-handle">\n    <span class="yamicon yamicon-rd_top_bottom_arrows"></span>\n  </span>\n{{/is_editable}}\n\n<span class="yj-pinned-item--type" data-qaid="pinned_content_{{icon}}">\n  {{{svgIcon}}}{{! generated HTML }}\n</span>\n\n<span class="yj-pinned-item--name">\n  <a class="file-link yj-item-link" href="{{web_url}}" {{#target}}target="_blank" rel="noreferrer"{{/target}}>\n    <span class="yj-acc-hidden">{{icon_alt_text}} </span>\n    <span title="{{name}}">{{name}}</span>\n  </a>\n</span>\n\n{{#is_editable}}\n  <button class="yj-pinned-item--move-up" title="{{move_up_title}}" data-speechtip data-qaid="pinned_item_move_up">\n    <span class="yamicon yamicon-up-arrow">\n      <span class="yj-acc-hidden">{{move_up_title}}</span>\n    </span>\n  </button>\n\n  <a href="javascript://" role="button" class="yj-close-link yj-menu-shadow-top" title="{{remove_title}}" data-speechtip\n    data-id="{{id}}" data-content-rel-id="{{rid}}">\n    <span class="yamicon yamicon-rd_close">\n      <span class="yj-acc-hidden">{{remove_title}}</span>\n    </span>\n  </a>\n\n  <button class="yj-pinned-item--move-down" title="{{move_down_title}}" data-speechtip data-qaid="pinned_item_move_down">\n    <span class="yamicon yamicon-down-arrow">\n      <span class="yj-acc-hidden">{{move_down_title}}</span>\n    </span>\n  </button>\n{{/is_editable}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/related_content",["require","underscore","core/lib/tr","backbone","core/lib/session","core/lib/date_helper","core/lib/filename_helper","core/lib/location_helper","core/lib/secure_opener","core/lib/yammer_api","common-ui/lib/helper/svg_icon","models/helpers/user","models/helpers/file","models/helpers/ogo","core/lib/urls","common-ui/lib/ui/accessibility/screenreader_announcer","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","css!./related_content","html!./related_content"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("backbone"),e=a("core/lib/session"),f=a("core/lib/date_helper"),g=a("core/lib/filename_helper"),h=a("core/lib/location_helper"),i=a("core/lib/secure_opener"),j=a("core/lib/yammer_api"),k=a("common-ui/lib/helper/svg_icon"),l=a("models/helpers/user"),m=a("models/helpers/file"),n=a("models/helpers/ogo"),o=a("core/lib/urls"),p=a("common-ui/lib/ui/accessibility/screenreader_announcer"),q=a("core/lib/backbone_base_view"),r=a("core/lib/backbone_with_auto_render");a("css!./related_content");var s=a("html!./related_content"),t={remove_title:c.t("remove"),move_up_title:c.t("move_up"),move_down_title:c.t("move_down")},u=q.extend({mixins:[r],template:s,tagName:"li",className:"yj-draggable-list-item yj-hovercard-link yj-pinned-item yj-want-focuswithin yk-clearfix",attributes:function(){var a=this.model,b=this.options;return{"data-id":a.get("id"),"data-rel-id":a.get("relationship_id"),"data-type":a.get("type"),"data-orientation":"left","data-visible":b.visible}},events:{"click .yj-close-link":"_onClickRemove","click .yj-pinned-item--move-up":"_onClickMoveUp","click .yj-pinned-item--move-down":"_onClickMoveDown",click:"_onClick"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"focus_request",this._focus)},render:function(){var a=this.model;return d.trigger("/ui/hovercard/add",this.$el,{id:a.get("id"),type:a.get("type"),orientation:"left"}),this},getTemplateData:function(){var a=this.model,d=e.getCurrentUser(),h={id:a.get("id"),rid:a.get("relationship_id"),type:a.get("type"),web_url:o.indexForModel(a),is_editable:this.options.editable};if(m.isFile(a)&&l.allowsFiles(d)){var i=g.getFileIconClass(a.get("name")),j=g.getFileIconClassAltText(i);b.extend(h,{icon:i,icon_alt_text:j,name:a.get("full_name"),byline:c.t("uploaded_time",{time:f.formatAgo(new Date(a.get("last_uploaded_at")),null,!0)})})}else m.isPage(a)&&l.allowsNotes(d)?b.extend(h,{icon:"note",icon_alt_text:c.t("item_type_note"),name:a.get("full_name"),byline:c.t("published_time",{time:f.formatAgo(new Date(a.get("last_published_at")||a.get("updated_at")),null,!0)})}):n.isOpenGraphObject(a)&&b.extend(h,{icon:"link",icon_alt_text:c.t("item_type_link"),name:a.get("official_name")||a.get("name"),web_url:a.get("web_url"),target:a.get("is_first_party"),byline:c.t("published_time",{time:f.formatAgo(new Date(a.get("created_at")||a.get("updated_at")),null,!0)})});return h.svgIcon=k("docicon-"+h.icon,{width:24,height:24}),b.extend(h,t)},_onClickRemove:function(a){a.stopPropagation(),a.preventDefault();var b=this.model,d=b.get("relationship_id"),e={relationship_id:d,related_content_action:"remove"},f=this;j.deleteContentRelationship(e).then(function(){f.model.collection.remove(f.model),f.remove(),p.announceText(c.t("removed_item",{name:f.model.get("full_name")}))})},_onClickMoveUp:function(){return this.model.trigger("move_up_request",this.model),!1},_onClickMoveDown:function(){return this.model.trigger("move_down_request",this.model),!1},_onClick:function(a){a.stopPropagation(),a.preventDefault();var b=this.$(".file-link"),c=b.attr("href"),d=b.attr("target");"_blank"===d?i.open(c):h.assign(c)},_focus:function(){this.$(".yj-item-link").focus()}});return u}),define("stache!workfeed/lib/app/sidebar/related_contents",["mustache"],function(a){var b='<div class="yj-header-extra-link">\n  <h2 class="yj-pinned-content--header">\n    {{title}}\n  </h2>\n\n  {{#is_editable}}\n    <a href="javascript://" class="yj-related-info--header-add yj-simple-click-menu-trigger" data-qaid="add-link" aria-haspopup="true" role="button">\n      {{add_content_link}}\n    </a>\n    <ul class="yj-click-menu yj-related-info--list">\n      {{#show_add_files}}\n        <li class="yj-related-info--list-item">\n          <a href="#" class="yj-related-info--list-item-anchor" id="get-file" title="{{add_file_label}}">\n            <span class="yamicon yamicon-rd_attach yk-yamicon-s"></span>\n            <span class="yj-link-label">{{file_label}}</span>\n          </a>\n        </li>\n      {{/show_add_files}}\n      {{#show_add_notes}}\n        <li class="yj-related-info--list-item">\n          <a href="#" class="yj-related-info--list-item-anchor" id="get-page" title="{{add_file_label}}">\n            <span class="yamicon yamicon-write yk-yamicon-s"></span>\n            <span class="yj-link-label">{{note_label}}</span>\n          </a>\n        </li>\n      {{/show_add_notes}}\n      {{#show_add_links}}\n        <li class="yj-related-info--list-item">\n          <a href="#" class="yj-related-info--list-item-anchor" id="get-link" title="{{add_link_label}}">\n            <span class="yamicon yamicon-rd_link yk-yamicon-s"></span>\n            <span class="yj-link-label">{{link_label}}</span>\n          </a>\n        </li>\n      {{/show_add_links}}\n    </ul>\n  {{/is_editable}}\n</div>\n\n<ul class="yj-draggable-list yj-related-contents--list">\n  {{#contents}}\n    <RelatedContentView key="{{id}}" data-index="{{index}}"/>\n  {{/contents}}\n</ul>\n\n{{#has_others}}\n  <a href="javascript://" role="button" class="yj-pinned-content--others-link">\n    {{others_label}}\n  </a>\n{{/has_others}}\n\n{{^contents}}\n  <div class="yj-pinned-content--empty" style="">\n    <div class="yj-pinned-content--empty-image-svg">{{{svgIconPinned}}}</div>\n      <div class="yj-pinned-content--empty-text">\n      {{#is_administrable}}\n          {{add_admin_label_no_notes}}\n      {{/is_administrable}}\n      {{^is_administrable}}\n          {{add_long_label_no_notes}}\n      {{/is_administrable}}\n    </div>\n  </div>\n{{/contents}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/related_contents",["require","underscore","core/lib/tr","core/lib/session","core/lib/yammer_api","backbone","core/lib/report","common-ui/lib/helper/svg_icon","models/helpers/user","models/helpers/group","common-ui/lib/ui/accessibility/screenreader_announcer","components/avatar/index","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/backbone_with_timers","common-ui/lib/ui/general/lightbox_manager","feeds/lib/ui/attachments/selector","feeds/lib/ui/ogos/selector","jquery-dragsort","css!./related_contents","./related_content","html!./related_contents"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("core/lib/yammer_api"),f=a("backbone"),g=a("core/lib/report"),h=a("common-ui/lib/helper/svg_icon"),i=a("models/helpers/user"),j=a("models/helpers/group"),k=a("common-ui/lib/ui/accessibility/screenreader_announcer"),l=a("components/avatar/index"),m=a("core/lib/backbone_base_view"),n=a("core/lib/backbone_with_auto_render"),o=a("core/lib/backbone_with_subviews"),p=a("core/lib/backbone_with_timers"),q=a("common-ui/lib/ui/general/lightbox_manager"),r=a("feeds/lib/ui/attachments/selector"),s=a("feeds/lib/ui/ogos/selector");a("jquery-dragsort"),a("css!./related_contents");var t=a("./related_content"),u=a("html!./related_contents"),v={related_contents:c.t("related_contents_label"),add_label:c.t("group_sidebar_related_contents_add_label"),add_short_label:c.t("group_sidebar_related_contents_add_short_label"),add_long_label:c.t("group_sidebar_related_contents_add_long_label"),add_long_label_no_notes:c.t("group_sidebar_related_contents_add_long_no_notes_label"),empty_label:c.t("group_sidebar_related_contents_empty_label"),add_link_label:c.t("select_a_link"),file_label:c.t("file_label"),note_label:c.t("note_label"),link_label:c.t("link_label"),attachment_selector_title:c.t("select_an_attachment"),link_selector_title:c.t("add_a_link"),note_attach_itself_error:c.t("a_note_cannot_be_related_to_itself"),file_attach_itself_error:c.t("a_file_cannot_be_related_to_itself"),item_attach_itself_error:c.t("an_item_cannot_be_related_to_itself"),add_content_link:c.t("add")},w=10;return m.extend({mixins:[n,o,p],attributes:{"data-qaid":"pinned-content-section"},template:u,views:{RelatedContentView:"_getRelatedContent"},events:{"click #get-file":"onClickAddFile","click #get-page":"onClickAddNote","click #get-link":"onClickAddLink","click .yj-pinned-content--others-link":"_onClickOthers"},initialize:function(){this.listenTo(this.collection,"add remove reset",this.render),this.listenTo(this.collection,"add",this.expand),this.listenTo(this.collection,"move_up_request",this._onMoveUp),this.listenTo(this.collection,"move_down_request",this._onMoveDown)},render:function(){null!=this.$list&&this._isEditable()&&this._removeDragAndDrop(this.$list),this.$list=this.$(".yj-draggable-list"),this._isEditable()&&this._enableDragAndDrop(this.$list);var a=new l({model:d.getCurrentUser(),withHovercard:!1,hideFromAccessibility:!0}),b=this.$(".yj-admin-company-resources--avatar");return b.append(a.render().$el),this},remove:function(){return this._isEditable()&&this._removeDragAndDrop(this.$list),m.prototype.remove.call(this)},expand:function(){return this.$el.addClass("yj-pinned-content--is-expanded"),this},getTemplateData:function(){var a=this.collection,e=d.getCurrentUser(),f=this._isEditable(),g={width:52,height:52};return b.extend({svgIconPinned:h("pinned-files",g),title:v.related_contents,contents:a.map(function(a,b){return{id:a.get("id"),index:b}}),is_editable:f,show_add_files:i.allowsFiles(e),show_add_notes:i.allowsNotes(e),show_add_links:!0,has_others:a.length>w,others_label:c.t("related_count_others",{count:a.length-w}),add_admin_label:c.t("group_sidebar_related_contents_add_admin_label",{user:e.get("full_name")}),add_admin_label_no_notes:c.t("group_sidebar_related_contents_add_admin_no_notes_label",{user:e.get("full_name")})},v)},onClickAddFile:function(a){this._onClickAddContent(a,"files")},onClickAddNote:function(a){this._onClickAddContent(a,"pages")},onClickAddLink:function(a){this._onClickAddContent(a,"links")},_onClickAddContent:function(a,c){a.preventDefault();var d,e=this.model,f=null!=e?e.get("id"):null,h=this.options.source.id,i=this.options.source.type,j={id:h,type:i},k="links"===c,l={groupId:f,sourceId:h,defaultSelector:c,inLightbox:!0},m={overlayClose:!1};k?(d=new s(l),b.extend(m,{title:v.link_selector_title,width:450,height:450})):(d=new r(l),b.extend(m,{title:v.attachment_selector_title,width:800,height:480,onComplete:function(){d.addUploader()}}));var n=q.openComponent(d,"yj-attachment-selector-lightbox",null,m);n.on("select",this._onSelectContent.bind(this,j)),g.event("rr_home_company_resources",{event_action:c})},_onSelectContent:function(a,d){if(a.id===d.id&&a.type===d.type){var g;switch(d.type){case"file":g=v.file_attach_itself_error;break;case"page":g=v.note_attach_itself_error;break;default:g=v.item_attach_itself_error}return f.trigger("/ui/alert/show","error",g)}var h={source_id:a.id,source_type:a.type,target_id:d.id,target_type:d.type,related_content_action:"add"},i=this;e.createContentRelationship(h).then(function(a){var e=b.first(a.content_relationships);i.collection.add(b.extend({relationship_id:e.id},d)),k.announceText(c.t("added_item",{name:d.full_name}))})},_getRelatedContent:function(a,b){return new t({model:this.collection.get(a),editable:this._isEditable(),visible:b("index")<w})},_isEditable:function(){var a=this.model,b=d.getCurrentUser();return null!=a&&!j.isAllCompany(a)&&j.isCurrentUserMember(a)||i.isAdmin(b)},_enableDragAndDrop:function(a){this.setTimeout(function(){a.dragsort({dragSelector:".yj-draggable-list-item",dragSelectorExclude:".yj-close-link, .yamicon-rd_close",dragEnd:b.partial(this._onDragEnd,this)}),a.on("/ui/draggable/dragStart",function(){$(".yj-hovercard").hide()})},300)},_removeDragAndDrop:function(a){a.dragsort("destroy")},_onDragEnd:function(a){var b=$(this),c={targetPos:b.index(),targetId:b.data("id"),targetType:b.data("type"),relId:b.data("rel-id"),silent:!0};a._updateItemPosition(c)},_updateItemPosition:function(a){var b=this.options.source.id,c=this.options.source.type,d={relationship_id:a.relId,source_id:b,source_type:c,position:a.targetPos,target_id:a.targetId,target_type:a.targetType,listed_types:["page","uploaded_file","open_graph_object"].join(","),related_content_action:"update"},f=this;e.updateContentRelationship(d).then(function(){var b=f.collection.get(a.targetId);f.collection.remove(b,{silent:!0}),f.collection.add(b,{at:a.targetPos,silent:a.silent}),a.success&&a.success()})},_onMoveUp:function(a){this._moveItemBy(a,-1)},_onMoveDown:function(a){this._moveItemBy(a,1)},_moveItemBy:function(a,d){var e=this.collection.indexOf(a),f=e+d;if(0>f)k.announceText(c.t("already_at_top"));else if(f>=this.collection.length)k.announceText(c.t("already_at_bottom"));else{var g={relId:a.get("relationship_id"),targetId:a.get("id"),targetType:a.get("type"),targetPos:f,silent:!1,success:b.bind(function(){k.announceText(c.t("now_at_position",{position:f+1,total:this.collection.length}))},this)};k.announceText(c.t("working")),this._updateItemPosition(g)}},_onClickOthers:function(a){a.preventDefault();var b=document.activeElement===this.$(".yj-pinned-content--others-link")[0];if(this.expand(),b){var c=this.collection.at(w);c.trigger("focus_request")}}})}),define("workfeed/lib/app/sidebar/group_related_contents",["require","./related_contents","underscore","core/lib/tr","core/lib/session","core/lib/report","models/helpers/user","models/helpers/group"],function(a){"use strict";var b=a("./related_contents"),c=a("underscore"),d=a("core/lib/tr"),e=a("core/lib/session"),f=a("core/lib/report"),g=a("models/helpers/user"),h=a("models/helpers/group"),i=b.extend({className:function(){return h.isAllCompany(this.model)?"yj-pinned-content yj-company-resources":"yj-pinned-content yj-related-content"},getTemplateData:function(){var a=b.prototype.getTemplateData.call(this),f=e.getCurrentNetwork(),g=this._isAdministrable();return f.get("community")?c.extend(a,{title:d.t("group_sidebar_network_resources_label")}):h.isAllCompany(this.model)?c.extend(a,{title:d.t("group_sidebar_company_resources_label")}):c.extend(a,{title:d.t("group_sidebar_related_contents_label")}),c.extend(a,{is_administrable:g})},_isAdministrable:function(){var a=this.model,b=e.getCurrentUser();return h.isAllCompany(a)&&g.isAdmin(b)},_isEditable:function(){var a=this.model,b=e.getCurrentUser();return!h.isAllCompany(a)&&h.isCurrentUserMember(a)||g.isAdmin(b)},onClickAddFile:function(a){f.event("rr_groups_pinned",{event_action:"file"}),b.prototype.onClickAddFile.call(this,a)},onClickAddNote:function(a){f.event("rr_groups_pinned",{event_action:"note"}),b.prototype.onClickAddNote.call(this,a)},onClickAddLink:function(a){f.event("rr_groups_pinned",{event_action:"link"}),b.prototype.onClickAddLink.call(this,a)}});return i}),define("css!workfeed/lib/app/sidebar/group_related_groups",[],function(){}),define("css!workfeed/lib/app/sidebar/group_related_group",[],function(){}),define("stache!workfeed/lib/app/sidebar/group_related_group",["mustache"],function(a){var b='{{#is_editable}}\n  <span class="yj-dnd-handle">\n    <span class="yamicon yamicon-rd_top_bottom_arrows"></span>\n  </span>\n{{/is_editable}}\n\n<a class="yj-related-groups-item--type" href="{{web_url}}" tabindex="-1" aria-hidden="true">\n  <img class="yj-related-groups-item--thumb" src="{{mugshot_url}}" alt=""/>\n</a>\n\n<span class="yj-related-groups-item--name">\n  <a class="file-link yj-item-link" href="{{web_url}}">\n    <span title="{{name}}">{{name}}</span>\n  </a>\n</span>\n\n{{#is_editable}}\n  <button class="yj-related-groups-item--move-up" title="{{move_up_title}}" data-speechtip data-qaid="related_groups_item_move_up">\n    <span class="yamicon yamicon-up-arrow">\n      <span class="yj-acc-hidden">{{move_up_title}}</span>\n    </span>\n  </button>\n\n  <a href="javascript://" role="button" class="yj-close-link yj-menu-shadow-top" title="{{remove_title}}" data-speechtip\n    data-id="{{id}}" data-content-rel-id="{{rid}}">\n    <span class="yamicon yamicon-rd_close">\n      <span class="yj-acc-hidden">{{remove_title}}</span>\n    </span>\n  </a>\n\n  <button class="yj-related-groups-item--move-down" title="{{move_down_title}}" data-speechtip data-qaid="related_groups_item_move_down">\n    <span class="yamicon yamicon-down-arrow">\n      <span class="yj-acc-hidden">{{move_down_title}}</span>\n    </span>\n  </button>\n{{/is_editable}}\n\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/group_related_group",["require","underscore","core/lib/tr","backbone","core/lib/location_helper","core/lib/yammer_api","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","css!./group_related_group","html!./group_related_group","core/lib/report","core/lib/urls","common-ui/lib/ui/accessibility/screenreader_announcer"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("backbone"),e=a("core/lib/location_helper"),f=a("core/lib/yammer_api"),g=a("core/lib/backbone_base_view"),h=a("core/lib/backbone_with_auto_render");a("css!./group_related_group");var i=a("html!./group_related_group"),j=a("core/lib/report"),k=a("core/lib/urls"),l=a("common-ui/lib/ui/accessibility/screenreader_announcer"),m={remove_title:c.t("remove"),move_up_title:c.t("move_up"),move_down_title:c.t("move_down")},n=g.extend({mixins:[h],template:i,tagName:"li",className:"yj-draggable-list-item yj-hovercard-link yj-related-groups-item yj-want-focuswithin yk-clearfix",attributes:function(){var a=this.model,b=this.options;return{"data-id":a.get("id"),"data-rel-id":a.get("relationship_id"),"data-type":"group","data-orientation":"left","data-visible":b.visible}},events:{"click .yj-close-link":"_onClickRemove","click .yj-related-groups-item--move-up":"_onClickMoveUp","click .yj-related-groups-item--move-down":"_onClickMoveDown",click:"_onClick"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"focus_request",this._focus)},render:function(){var a=this.model;return d.trigger("/ui/hovercard/add",this.$el,{id:a.get("id"),type:"group",orientation:"left"}),this},getTemplateData:function(){var a=this.model,c=this.options.editable;return b.extend({id:a.get("id"),rid:a.get("relationship_id"),name:a.get("full_name"),web_url:k.groupIndex(a),mugshot_url:k.groupMugshot(a,48,!0),is_editable:c},m)},_onClickRemove:function(a){a.stopPropagation(),a.preventDefault();var b=this.model,d=b.get("relationship_id"),e={relationship_id:d,related_content_action:"remove"},g=this;f.deleteContentRelationship(e).then(function(){g.model.collection.remove(g.model),g.remove(),l.announceText(c.t("removed_group_name",{name:g.model.get("full_name")}))})},_onClickMoveUp:function(){return this.model.trigger("move_up_request",this.model),!1},_onClickMoveDown:function(){return this.model.trigger("move_down_request",this.model),!1},_onClick:function(a){a.preventDefault();var b=this.$(".file-link"),c=b.attr("href");j.event("rr_groups_related_groups"),e.assign(c)},_focus:function(){this.$(".yj-item-link").focus()}});return n}),define("stache!workfeed/lib/app/sidebar/group_related_groups",["mustache"],function(a){var b='<h2 class="yj-related-groups--header">\n  {{related_groups_label}}\n</h2>\n\n{{#is_editable}}\n  <div class="yj-related-groups--ta yj-ta-spinner-wrap">\n    <label for="yj-related-groups--input" class="yj-acc-hidden">\n      {{add_label_no_ellipsis}}\n    </label>\n    <input id="yj-related-groups--input" class="yj-related-groups--field" autocomplete="off"/>\n  </div>\n{{/is_editable}}\n\n<ul class="yj-draggable-list yj-related-groups-list">\n  {{#groups}}\n    <GroupRelatedGroupView key="{{id}}" data-index="{{index}}"/>\n  {{/groups}}\n</ul>\n\n{{#has_others}}\n  <a href="javascript://" role="button" class="yj-related-groups--others-link">\n    {{others_label}}\n  </a>\n{{/has_others}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/group_related_groups",["require","underscore","core/lib/tr","core/lib/session","core/lib/yammer_api","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/backbone_with_timers","models/helpers/user","models/helpers/group","common-ui/lib/ui/accessibility/screenreader_announcer","common-ui/lib/ui/shared/type_ahead","jquery-dragsort","css!./group_related_groups","./group_related_group","html!./group_related_groups"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("core/lib/yammer_api"),f=a("core/lib/backbone_base_view"),g=a("core/lib/backbone_with_auto_render"),h=a("core/lib/backbone_with_subviews"),i=a("core/lib/backbone_with_timers"),j=a("models/helpers/user"),k=a("models/helpers/group"),l=a("common-ui/lib/ui/accessibility/screenreader_announcer"),m=a("common-ui/lib/ui/shared/type_ahead");a("jquery-dragsort"),a("css!./group_related_groups");var n=a("./group_related_group"),o=a("html!./group_related_groups"),p={related_groups_label:c.t("group_sidebar_related_groups_label"),see_all_label:c.t("group_sidebar_related_groups_see_all_label"),
add_label:c.t("group_sidebar_related_groups_add_label"),add_label_no_ellipsis:c.t("group_sidebar_related_groups_add_label_no_ellipsis"),unlisted_group_error:c.t("sorry_unlisted_groups_cant_be_added")},q=5,r=f.extend({mixins:[g,h,i],className:"yj-related-groups",template:o,views:{GroupRelatedGroupView:"_getGroupRelatedGroup"},events:{"click .yj-related-groups--others-link":"_onClickOthers"},initialize:function(){this.listenTo(this.collection,"add remove reset",this.render),this.listenTo(this.collection,"add",this.expand),this.listenTo(this.collection,"move_up_request",this._onMoveUp),this.listenTo(this.collection,"move_down_request",this._onMoveDown),q=10,b.bindAll(this,"_onFilterTypeAhead","_onSelectTypeAhead")},render:function(){return null!=this.$input&&this._removeTypeAhead(this.$input),null!=this.$list&&this._isEditable()&&this._removeDragAndDrop(this.$list),this.$input=this.$(".yj-related-groups--field"),this._registerTypeAhead(this.$input),this.$list=this.$(".yj-draggable-list"),this._isEditable()&&this._enableDragAndDrop(this.$list),this},remove:function(){return this._removeTypeAhead(this.$input),this._isEditable()&&this._removeDragAndDrop(this.$list),f.prototype.remove.call(this)},expand:function(){var a;return a="yj-related-groups--is-expanded",this.$el.addClass(a),this},getTemplateData:function(){var a=this.collection,d=this._isEditable();return b.extend({groups:a.map(function(a,b){return{id:a.get("id"),index:b}}),is_editable:d,has_others:a.length>q,others_label:c.t("related_count_others",{count:a.length-q})},p)},_getGroupRelatedGroup:function(a,b){return new n({model:this.collection.get(a),editable:this._isEditable(),visible:b("index")<q})},_isEditable:function(){var a=this.model,b=d.getCurrentUser();return!k.isAllCompany(a)&&k.isCurrentUserMember(a)||j.isVerifiedAdmin(b)},_enableDragAndDrop:function(a){this.setTimeout(function(){a.dragsort({dragSelector:".yj-draggable-list-item",dragSelectorExclude:".yj-close-link, .yamicon-rd_close",dragEnd:b.partial(this._onDragEnd,this)}),a.on("/ui/draggable/dragStart",function(){$(".yj-hovercard").hide()})},300)},_removeDragAndDrop:function(a){a.dragsort("destroy")},_registerTypeAhead:function(a){var c={completableModels:[m.MODEL_GROUP],scrollResults:!0,showTopRankings:!0,selectFirst:!1,noCache:!1,noResultsAction:!0,noResultsMessage:p.unlisted_group_error,watermarkText:p.add_label_no_ellipsis,watermarkIcon:!1,filter:this._onFilterTypeAhead,onSelect:this._onSelectTypeAhead};c=b.extend({watermarkIconAlignLeft:!0},c),m.registerField(a,c)},_removeTypeAhead:function(a){m.removeField(a)},_onFilterTypeAhead:function(a,b){var c=this.collection,d=this.model,e=d.get("id"),f=b.id==e,g=null!=c.get(b.id),h=!!b.show_in_directory;return!f&&!g&&h},_onSelectTypeAhead:function(a){var d=this.model,f=d.get("id"),g={source_id:f,source_type:"group",target_id:a.id,target_type:"group",related_groups_action:"add"},h=this;e.createContentRelationship(g).then(function(d){var e=b.first(d.content_relationships);h.collection.add(b.extend({relationship_id:e.id},a)),l.announceText(c.t("added_group_name",{name:a.full_name}))})},_onDragEnd:function(a){var b=$(this),c={targetPos:b.index(),targetId:b.data("id"),relId:b.data("rel-id"),silent:!0};a._updateItemPosition(c)},_updateItemPosition:function(a){var b=this.model,c=b.get("id"),d=b.get("type"),f={relationship_id:a.relId,source_id:c,source_type:d,position:a.targetPos,target_id:a.targetId,target_type:"group",listed_types:"group",related_groups_action:"update"},g=this;e.updateContentRelationship(f).then(function(){var b=g.collection.get(a.targetId);g.collection.remove(b,{silent:!0}),g.collection.add(b,{at:a.targetPos,silent:a.silent}),a.success&&a.success()})},_onMoveUp:function(a){this._moveItemBy(a,-1)},_onMoveDown:function(a){this._moveItemBy(a,1)},_moveItemBy:function(a,d){var e=this.collection.indexOf(a),f=e+d;if(0>f)l.announceText(c.t("already_at_top"));else if(f>=this.collection.length)l.announceText(c.t("already_at_bottom"));else{var g={relId:a.get("relationship_id"),targetId:a.get("id"),targetType:a.get("type"),targetPos:f,silent:!1,success:b.bind(function(){l.announceText(c.t("now_at_position",{position:f+1,total:this.collection.length}))},this)};l.announceText(c.t("working")),this._updateItemPosition(g)}},_onClickOthers:function(a){a.preventDefault();var b=document.activeElement===this.$(".yj-related-groups--others-link")[0];if(this.expand(),b){var c=this.collection.at(q);c.trigger("focus_request")}}});return r}),define("stache!workfeed/lib/app/embed_group_feed_dialog",["mustache"],function(a){var b='<div class="yj-embed-group-feed-dialog--container">\n  <label>\n    {{addLabel}}\n    <textarea class="yj-embed-group-feed-dialog--textarea" id="embedCode">{{code}}</textarea>\n  </label>\n  <div class="yj-embed-group-feed-dialog--notice-text">{{{copyLabel}}}</div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!workfeed/lib/app/embed_group_feed_dialog_code",["mustache"],function(a){var b='<div id="embedded-feed" style="height:800px;width:400px;"></div>\n<script type="text/javascript" src="{{{assetURL}}}"></script>\n<script type="text/javascript">\nyam.connect.embedFeed({\n  container: "#embedded-feed",\n  network: "{{permalink}}",\n  feedType: "group",\n  feedId: "{{feedId}}"\n});\n</script>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/embed_group_feed_dialog",[],function(){}),define("workfeed/lib/app/embed_group_feed_dialog",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/namespace","core/lib/session","core/lib/tr","core/lib/yammer_config","html!./embed_group_feed_dialog","html!./embed_group_feed_dialog_code","css!./embed_group_feed_dialog"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/namespace"),f=a("core/lib/session"),g=a("core/lib/tr"),h=a("core/lib/yammer_config"),i=a("html!./embed_group_feed_dialog"),j=a("html!./embed_group_feed_dialog_code");return a("css!./embed_group_feed_dialog"),e.ns("yam.workfeed"),yam.workfeed.EmbedGroupFeedDialog=c.extend({mixins:[d],className:"yj-embed-group-feed-dialog",template:i,codeTemplate:j,initialize:function(a){b.bindAll(this,"_selectEmbedCodeText"),this.feedId=a&&a.feedId},_selectEmbedCodeText:function(){this.$el.find("textarea").select()},getTemplateData:function(){var a={feedId:this.feedId,permalink:f.getCurrentNetwork().permalink,assetURL:h.config().cdnAssetHost+"/assets/platform_embed.js"};return{code:this.codeTemplate(a),addLabel:g.t("add_this_groups_conversations_to_the_tools_you_already_use"),copyLabel:g.t("copy_and_paste_the_code_above_into_any_html_page",{link:'<a href="https://developer.yammer.com/v1.0/docs/embed/">{$0}</a>'})}},render:function(){return b.defer(this._selectEmbedCodeText),this}})}),define("stache!workfeed/lib/app/embed_group_email_dialog",["mustache"],function(a){var b='<div class="yj-embed-group-email-dialog--container">\n  <label>{{dialog_instructions}}</label>\n  <textarea class="yj-embed-group-email-dialog--textarea" id="embedCode">{{email_url}}</textarea>\n  <div class="yj-embed-group-feed-dialog--notice-text">{{{additional_info}}}</div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/embed_group_email_dialog",[],function(){}),define("workfeed/lib/app/embed_group_email_dialog",["require","underscore","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./embed_group_email_dialog","css!./embed_group_email_dialog"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("html!./embed_group_email_dialog");a("css!./embed_group_email_dialog");var g=d.extend({mixins:[e],template:f,className:"yj-embed-group-email-dialog",initialize:function(a){b.bindAll(this,"_selectEmbedEmailText"),this.email_url=a&&a.email_url,b.defer(this._selectEmbedEmailText)},getTemplateData:function(){return{dialog_instructions:c.t("post_to_this_group_by_email"),additional_info:c.t("emails_you_send_to_the_above_email_address_will_show_up_in_this_group_as_posts",{link:'<a class="yj-embed-group-email-dialog--learn-more" href="https://support.microsoft.com/en-us/kb/2783933">{$0}</a>'}),email_url:this.email_url}},_selectEmbedEmailText:function(){this.$el.find("textarea").select()}});return g}),define("stache!workfeed/lib/app/sidebar/group_options",["mustache"],function(a){var b='<div class="yj-group-options">\n  <h2 class="yj-group-options--header">\n    {{access_options_label}}\n  </h2>\n\n  <ul class="yj-group-options--checklist">\n    <li class="yj-group-options--settings yk-clearfix">\n      <div class="yj-group-options--settings-option-item settings-option--subscribe-email">\n        <input id="feed_subscription_settings_email" class="checkbox" type="checkbox"\n          value="enabled" {{#is_subscribed_email}}checked{{/is_subscribed_email}}>\n        <span class="yamicon {{#is_subscribed_email}}yamicon-rd_checked{{/is_subscribed_email}} {{^is_subscribed_email}}yamicon-rd_check{{/is_subscribed_email}} yj-dark-gray yk-yamicon-s yj-group-options--settings-option-item-checkbox-icon"></span>\n      </div>\n      <div class="yj-group-options--settings-option-label settings-option--subscribe-email">\n        <label for="feed_subscription_settings_email">\n          {{subscribe_email_label}}\n        </label>\n      </div>\n    </li>\n\n    {{#showPostLink}}\n    <li class="yj-group-options--settings yk-clearfix">\n      <div class="yj-group-options--settings-option-item settings-option--post-email">\n        <a class="yj-group-options--settings-option-link" href="{{email_url}}" aria-hidden="true" tabindex="-1">\n          <span class="yamicon yamicon-rd_inbox yj-dark-gray yk-yamicon-s"></span>\n        </a>\n      </div>\n      <div class="yj-group-options--settings-option-label settings-option--post-email">\n        <a class="yj-group-options--settings-option-link" href="javascript://" role="button" title="{{email_url}}" class="yj-group-options--settings-option-link">\n          {{post_email_label}}\n        </a>\n      </div>\n    </li>\n    {{/showPostLink}}\n\n    <li class="yj-group-options--settings yk-clearfix">\n      <div class="yj-group-options--settings-option-item settings-option--embed">\n        <a class="yj-group-options--settings-option-link" href="#" title="{{embed_feed_label}}" aria-hidden="true" tabindex="-1">\n          <span class="yamicon yamicon-rd_embed yj-dark-gray yk-yamicon-m"></span>\n        </a>\n      </div>\n      <div class="yj-group-options--settings-option-label settings-option--embed">\n        <a class="yj-group-options--settings-option-link" href="javascript://" role="button" title="{{embed_feed_label}}">\n          {{embed_feed_label}}\n        </a>\n      </div>\n    </li>\n  </ul>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/sidebar/group_options",[],function(){}),define("workfeed/lib/app/sidebar/group_options",["require","underscore","core/lib/tr","backbone","core/lib/yammer_api","core/lib/session","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","common-ui/lib/ui/general/lightbox_manager","workfeed/lib/app/embed_group_feed_dialog","workfeed/lib/app/embed_group_email_dialog","common-ui/lib/ui/shared/follow_group_button","models/helpers/group","html!./group_options","core/lib/report","css!./group_options"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("backbone"),e=a("core/lib/yammer_api"),f=a("core/lib/session"),g=a("core/lib/backbone_base_view"),h=a("core/lib/backbone_with_auto_render"),i=a("core/lib/backbone_with_subviews"),j=a("common-ui/lib/ui/general/lightbox_manager"),k=a("workfeed/lib/app/embed_group_feed_dialog"),l=a("workfeed/lib/app/embed_group_email_dialog"),m=a("common-ui/lib/ui/shared/follow_group_button"),n=a("models/helpers/group"),o=a("html!./group_options"),p=a("core/lib/report");a("css!./group_options");var q={access_options_label:c.t("group_sidebar_access_options_label"),subscribe_email_label:c.t("group_sidebar_subscribe_email_label"),post_email_label:c.t("group_sidebar_post_email_label"),embed_label:c.t("group_sidebar_embed_label"),embed_feed_label:c.t("group_sidebar_embed_feed_label"),email_label:c.t("group_sidebar_email_label")},r=g.extend({mixins:[h,i],template:o,events:{"change .settings-option--subscribe-email .checkbox":"_onChangeSubscribeEmail","click .settings-option--post-email":"_onClickPostEmail","click .settings-option--embed":"_onClickEmbed","click .yj-follow-button":"_onClickFollow","click .yj-unfollow-button":"_onClickLeave","click .yj-group-options--settings-option-item-checkbox-icon":"_onClickFakeCheckbox"},views:{JoinLeaveButton:"_getJoinLeaveButton"},initialize:function(){this.listenTo(this.model,"change:subscriptions",this.render)},getTemplateData:function(){var a=this.model,c=a.get("subscriptions");return b.extend({show_join:!n.isAllCompany(a),email_url:this._getEmailUrl(),is_subscribed_email:c&&"enabled"===c.email,showPostLink:!(n.isExternal(a)&&n.isForeign(a,f))},q)},_getJoinLeaveButton:function(){return new m(this.options)},_onClickLeave:function(){p.event("rr_groups_access_options",{event_action:"leave"})},_onClickFollow:function(){p.event("rr_groups_access_options",{event_action:"join"})},_onClickFakeCheckbox:function(){this.$("#feed_subscription_settings_email").trigger("click")},_onChangeSubscribeEmail:function(a){p.event("rr_groups_access_options",{event_action:"subscribe_by_email"});var f=this.model,g=f.get("feed_key"),h=this.$("#feed_subscription_settings_email"),i=this.$(".yj-group-options--settings-option-item-checkbox-icon"),j=b.object(["client_type","feed_subscription_settings"],["email",b.object([g],[$(a.target).is(":checked")])]);j=b.object(["client_type","feed_subscription_settings"],["email",b.object([g],[h.is(":checked")])]),h.is(":checked")?i.removeClass("yamicon-rd_check").addClass("yamicon-rd_checked"):i.removeClass("yamicon-rd_checked").addClass("yamicon-rd_check"),e.updateFeedSubscriptions(j).then(function(){var a=f.get("full_name"),b=c.t("group_sidebar_subscribe_email_success",{group:a});d.trigger("/ui/alert/show","notice",b)})},_getEmailUrl:function(){var a=this.model,b=f.getCurrentNetwork(),c=n.isAllCompany(a)?b.get("email"):a.get("email");return c},_onClickPostEmail:function(){p.event("rr_groups_access_options",{event_action:"post_by_email"});var a=new l({email_url:this._getEmailUrl()}),b={title:q.email_label};j.openComponent(a,"yj-attachment-selector-lightbox",null,b)},_onClickEmbed:function(a){a.preventDefault(),p.event("rr_groups_access_options",{event_action:"embed"});var b=this.model,c=new k({feedId:n.isAllCompany(b)?"all":b.get("id")}),d={title:q.embed_label};j.openComponent(c,"yj-attachment-selector-lightbox",null,d)}});return r}),define("stache!workfeed/lib/app/sidebar/group_search",["mustache"],function(a){var b='<h2 class="yj-sidebar-group-search--header">{{search_label}}</h2>\n<GroupSearchView key="group_search"/>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/sidebar/group_search",[],function(){}),define("workfeed/lib/app/sidebar/group_search",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","common-ui/lib/ui/groups/group_search","core/lib/tr","models/helpers/group","html!./group_search","css!./group_search"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("common-ui/lib/ui/groups/group_search"),f=a("core/lib/tr"),g=a("models/helpers/group"),h=a("html!./group_search");return a("css!./group_search"),b.extend({mixins:[c,d],template:h,className:"yj-sidebar-group-search-container",views:{GroupSearchView:"_getGroupSearchView"},getTemplateData:function(){return{search_label:f.t("group_search")}},_getGroupSearchView:function(){var a=this.model;return new e({searchParameters:{search_group:g.isAllCompany(a)?0:a.id}})}})}),define("stache!workfeed/lib/app/header/group_members_count",["mustache"],function(a){var b='<button type="button" class="unstyle-button-as-span yj-members-link" data-qaid="members_count_button">\n  <span class="yj-quick-link-nostyle">\n    {{members_label}} <span class="members-count">{{members_count}}</span>\n  </span>\n</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/header/group_members_count",["require","underscore","core/lib/tr","core/lib/session","core/lib/yammer_uri","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/ui/groups/member_list","core/lib/location_helper","core/lib/urls","models/helpers/group","html!./group_members_count"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("core/lib/yammer_uri"),f=a("core/lib/backbone_base_view"),g=a("core/lib/backbone_with_auto_render"),h=a("common-ui/lib/ui/groups/member_list"),i=a("core/lib/location_helper"),j=a("core/lib/urls"),k=a("models/helpers/group"),l=a("html!./group_members_count"),m={members_title:c.t("group_members_title"),members_label:c.t("group_members_label")},n=f.extend({mixins:[g],className:"yj-group-members-count",template:l,events:{click:"_onClick"},initialize:function(){this.listenTo(this.model,"change:stats",this.render)},getTemplateData:function(){var a=this.model,c=a.get("stats"),d=null!=c?c.members:0;return d="("+d+")",b.extend({members_count:d,members_url:j.groupMembers(a)},m)},_onClick:function(a){var b=this.model,c=d.getCurrentNetwork();if(k.isAllCompany(b))i.assign(e.app("/users"));else{a.preventDefault();var f=new h({groupId:b.get("id"),permalink:b.get("name"),isCommunity:c.get("community")});h.showInLightbox(f)}}});return n}),define("css!common-ui/lib/ui/shared/type_ahead_tag_list_with_submit",[],function(){}),define("common-ui/lib/ui/shared/type_ahead_tag_list_with_submit",["require","underscore","common-ui/lib/ui/shared/type_ahead_tag_list","backbone","core/lib/tr","css!./type_ahead_tag_list_with_submit"],function(a){var b=a("underscore"),c=a("common-ui/lib/ui/shared/type_ahead_tag_list"),d=a("backbone"),e=a("core/lib/tr");return a("css!./type_ahead_tag_list_with_submit"),c.extend({defaults:b.defaults({buttonText:"+ "+e.t("add"),closeOnSubmit:!0},c.prototype.defaults),events:b.defaults({"click .yj-bubbles-form-submit":"handleSubmitClick"},c.prototype.events),id:"typeAheadTagListWithSubmit",className:"yj-bubbles-container yj-taglist-submit external_groups_v1",tagName:"table",template:'      {{#titleText}}      <tr>      <td>        <h1 class="yj-type-ahead-tag-list-with-submit--title">          {{titleText}}        </h1>      </td>      </tr>      {{/titleText}}      <tr class="yj-type-ahead-tag-list-with-submit--input-row">      {{#displayInput}}      <td class="yj-type-ahead-tag-list-with-submit--input yj-input-column"><div class="yj-bubbles">        <div class="yj-spinner"><span class="yj-inline-icon"></span></div>        <label><span class="yj-acc-hidden yj-bubble-field-label"></span>          <input type="{{inputType}}" class="yj-bubble-field" wrap="off" />        </label>      </div></td>      {{/displayInput}}      <td class="yj-type-ahead-tag-list-with-submit--button yj-button-column"><button class="yj-btn yj-btn-disabled yj-bubbles-form-submit" disabled>{{ buttonText }}</button>      </td>      </tr>    ',initialize:function(a){this.options=b.extend({},this.options,a),c.prototype.initialize.call(this,a),b.bindAll(this,"handleSubmitSuccess","handleSubmitFailure"),this.on("addedEntry",this._addedEntry,this),this.on("removedEntry",this._removedEntry,this),this.$el.attr("role","presentation")},createSubElements:function(){this.$entryContainer=this.$(".yj-bubbles"),this.$entryField=this.$(".yj-bubble-field"),this.$entryFieldLabel=this.$(".yj-bubble-field-label"),this.$spinner=this.$(".yj-spinner"),this.$submit=this.$(".yj-bubbles-form-submit")},_addedEntry:function(){this._enableSubmitButton()},_removedEntry:function(){this.hasNoEntries()&&this._disableSubmitButton()},handleSubmitClick:function(){return this._isSubmitButtonEnabled()?(this._showSpinner(),this._disableSubmitButton(),void("function"==typeof this.options.submitCallback&&this.options.submitCallback.apply(this,arguments))):!1},handleSubmitSuccess:function(){d.trigger("/ui/alert/show","notice",this.options.successMessage||e.t("success")),this.clear(),this._hideSpinner(),this._updateEntryField(),this.options.closeOnSubmit&&d.trigger("/ui/lightbox/close")},handleSubmitFailure:function(){d.trigger("/ui/alert/show","error",this.options.errorMessage||e.t("there_was_an_error")),this._hideSpinner(),this._enableSubmitButton()},_showSpinner:function(){this.$spinner.css("visibility","visible")},_hideSpinner:function(){this.$spinner.css("visibility","hidden")},_focusOnSubmitButton:function(){this.$submit.focus()},_enableSubmitButton:function(){this.$submit.removeClass("yj-btn-disabled"),this.$submit.prop("disabled",!1)},_disableSubmitButton:function(){this.$submit.addClass("yj-btn-disabled"),this.$submit.prop("disabled",!0)},_isSubmitButtonEnabled:function(){return!this.$submit.hasClass("yj-btn-disabled")}})}),define("common-ui/lib/ui/shared/type_ahead_tag_list_add_members",["require","jquery","underscore","common-ui/lib/ui/shared/type_ahead_tag_list_with_submit","core/lib/tr","core/lib/yammer_api"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/shared/type_ahead_tag_list_with_submit"),e=a("core/lib/tr"),f=a("core/lib/yammer_api");return d.extend({initialize:function(a){this.options=c.extend({},this.options,a),d.prototype.initialize.call(this,c.extend(a,{submitCallback:this._submitCallback,titleText:e.t("group_add_members_title")}))},_submitCallback:function(){this.options.isCompanyGroup?(this.options.successMessage=e.t("users_invited_successfully"),this.options.errorMessage=e.t("users_not_invited_successfully"),f.inviteToGroup({email:this.tagList.getTagAddresses().join(","),section:b(".yj-quick-links").attr("data-section")||"",source:b(".yj-quick-links").attr("data-source")||""}).then(this.handleSubmitSuccess,this.handleSubmitFailure)):(this.options.successMessage=e.t("users_added_successfully"),this.options.errorMessage=e.t("users_not_added_successfully"),f.addToGroup({group_id:this.options.groupId||b(".yj-quick-links").attr("data-group-id"),invite_section:this.options.inviteSection,invites:{ids:this.tagList.getTagIds(),emails:{addresses:this.tagList.getTagAddresses().join(",")}},auto_add_invitees:!0}).then(this.handleSubmitSuccess,this.handleSubmitFailure))}})}),define("stache!workfeed/lib/app/header/group_members_add",["mustache"],function(a){var b='<a href="javascript://" class="yj-btn yj-btn-alt yj-quick-link" data-qaid="group_add_members"\n  role="button" title="{{members_title}}" data-speechtip>\n  <span class="yamicon yamicon-rd_invite_user yk-yamicon-l yj-dark-grey">\n    <span class="yj-acc-hidden">{{members_label}}</span>\n  </span>\n</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/header/group_members_add",["require","core/lib/tr","core/lib/session","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/ui/shared/type_ahead_tag_list_add_members","common-ui/lib/ui/groups/member_list","models/helpers/group","html!./group_members_add"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/session"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("common-ui/lib/ui/shared/type_ahead_tag_list_add_members"),g=a("common-ui/lib/ui/groups/member_list"),h=a("models/helpers/group"),i=a("html!./group_members_add"),j={members_title:b.t("group_add_members_title"),members_label:b.t("group_add_members_label"),invite_watermark:b.t("group_invite_watermark"),invite_label:b.t("group_invite_label")},k=d.extend({mixins:[e],className:"yj-group-members-add",template:i,events:{click:"_onClick"},getTemplateData:function(){return j},_onClick:function(a){a.preventDefault();var b,d=this.model,e=c.getCurrentNetwork();b=h.isAllCompany(d)?new f({inline:!1,inputType:"email",isCommunity:e.get("community"),isCompanyGroup:!0,allowNonCanonicalEmails:!0,emailsOnly:!0,emptyWatermark:"+ "+j.invite_watermark,buttonText:"+ "+j.invite_label}):new g({groupId:d.get("id"),permalink:d.get("name"),isCommunity:e.get("community")}),g.showInLightbox(b)}});return k}),define("stache!workfeed/lib/app/header/group_claim_admin",["mustache"],function(a){var b="{{#pending_members}}\n  {{{pending_members_notice}}}\n{{/pending_members}}\n{{^pending_members}}\n  {{{admin_left_notice}}}\n{{/pending_members}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("stache!workfeed/lib/app/header/group_claim_admin_link",["mustache"],function(a){var b='<a href="{{url}}" class="claim-admin" data-qaid="claim_admin_link">{$0}</a>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/header/group_claim_admin",["require","core/lib/tr","core/lib/location_helper","core/lib/yammer_api","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./group_claim_admin","html!./group_claim_admin_link","core/lib/urls"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/location_helper"),d=a("core/lib/yammer_api"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("html!./group_claim_admin"),h=a("html!./group_claim_admin_link"),i=a("core/lib/urls"),j=e.extend({mixins:[f],className:"custom-member-notice",template:g,events:{"click .claim-admin":"_onClick"},initialize:function(){this.listenTo(this.model,"change:stats",this.render)},getTemplateData:function(){var a=this.model,c=i.groupSettings(a),d=h({url:c});return{pending_members_notice:b.t("group_pending_members_notice",{link:d}),admin_left_notice:b.t("group_admin_left_notice",{link:d})}},_onClick:function(a){a.preventDefault(),d.claimGroup({id:this.model.get("id")}).always(function(){c.reload()})}});return j}),define("stache!workfeed/lib/app/sidebar/featured_group_members",["mustache"],function(a){var b='{{#show_members}}\n<div class="yj-group-header-facepile-container">\n  <h2 class="yj-featured-group-members--header">\n    <GroupMembersCountView key="membersCount"/>\n    {{#show_members_add}}\n      <GroupMembersAddView key="addMember"/>\n    {{/show_members_add}}\n  </h2>\n\n  <div class="thumbs yj-clearfix">\n    <FacePileView key="{{hash}}"/>\n    {{#show_members_add}}\n      <GroupMembersAddView key="addMember"/>\n    {{/show_members_add}}\n  </div>\n\n  {{#show_notices}}\n    <GroupClaimAdminView key="claim"/>\n  {{/show_notices}}\n</div>\n{{/show_members}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/sidebar/featured_group_members",[],function(){}),define("workfeed/lib/app/sidebar/featured_group_members",["require","core/lib/tr","core/lib/session","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","common-ui/lib/ui/shared/face_pile","workfeed/lib/app/header/group_members_count","workfeed/lib/app/header/group_members_add","workfeed/lib/app/header/group_claim_admin","models/helpers/user","models/helpers/group","html!./featured_group_members","css!./featured_group_members"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/session"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("common-ui/lib/ui/shared/face_pile"),h=a("workfeed/lib/app/header/group_members_count"),i=a("workfeed/lib/app/header/group_members_add"),j=a("workfeed/lib/app/header/group_claim_admin"),k=a("models/helpers/user"),l=a("models/helpers/group"),m=a("html!./featured_group_members");a("css!./featured_group_members");var n={admin_label:b.t("admin")},o=d.extend({mixins:[e,f],className:"yj-featured-group-members",template:m,views:{FacePileView:"_getFacePile",GroupMembersCountView:"_getGroupMembersCount",GroupMembersAddView:"_getGroupMembersAdd",GroupClaimAdminView:"_getGroupClaimAdmin"},initialize:function(){this.listenTo(this.collection,"add remove reset",this.render),this.listenTo(this.model,"change",this.render)},getTemplateData:function(){var a=this.collection,b=this.model,d=c.getCurrentUser();return{hash:null!=a?a.pluck("id").join("|"):"empty",show_members:(!l.isPrivate(b)||l.isCurrentUserMember(b)||k.isVerifiedAdmin(d))&&l.isActive(b),show_members_add:l.canCurrentUserInviteMembers(b,c),show_notices:!l.isAllCompany(b)&&!l.isForeign(b,c)&&l.isCurrentUserMember(b)&&!l.hasAdmin(b)}},_getFacePile:function(){var a=this.collection||[],b=this.model,d=l.canCurrentUserInviteMembers(b,c)?5:6;return new g({collection:a.first(d).map(function(a){return a.get("admin")&&a.set({badge:n.admin_label},{silent:!0}),a})})},_getGroupMembersCount:function(){return new h({model:this.model})},_getGroupMembersAdd:function(){return new i({model:this.model})},_getGroupClaimAdmin:function(){return new j({model:this.model})}});return o}),define("stache!components/sidebar_o365_links/src/sidebar_o365_links",["mustache"],function(a){var b='<div class="yj-o365-sidebar">\n  <h2 class="yj-o365-sidebar--header">\n    Office 365\n  </h2>\n  <ul>\n    {{#links}}\n      <li>\n        <a href="{{link}}" target=\'_blank\'>{{name}}</a>\n      </li>\n    {{/links}}\n  </ul>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/sidebar_o365_links/src/sidebar_o365_links",[],function(){}),define("components/sidebar_o365_links/src/sidebar_o365_links",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!components/sidebar_o365_links/src/sidebar_o365_links","css!components/sidebar_o365_links/src/sidebar_o365_links"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("html!components/sidebar_o365_links/src/sidebar_o365_links");a("css!components/sidebar_o365_links/src/sidebar_o365_links");var e=b.extend({template:d,mixins:[c],getTemplateData:function(){return{links:this._getLinks()}},_getLinks:function(){return[{link:"about:blank",name:"OneDrive"},{link:"about:blank",name:"Calendar"},{link:"about:blank",name:"Planner"}]}});return e}),define("components/sidebar_o365_links/index",["require","./src/sidebar_o365_links"],function(a){"use strict";return a("./src/sidebar_o365_links")}),define("stache!workfeed/lib/app/sidebar/group_sidebar",["mustache"],function(a){var b='{{#showPending}}\n  <GroupPendingMembersView key="pending"/>\n{{/showPending}}\n\n<div id="group-details" class="details yj-thread-sidebar yj-component" role="complementary">\n  <FeaturedGroupMembersView key="facepile"/>\n  <div class="yj-group-search-container">\n    <GroupSearchView key="search"/>\n  </div>\n\n  {{#o365_suite_groups}}\n    <SidebarO365LinksView />\n  {{/o365_suite_groups}}\n\n  {{#showInfo}}\n    <GroupInfoView key="info"/>\n  {{/showInfo}}\n\n  {{#showRelatedContents}}\n    <GroupRelatedContentsView key="related_contents"/>\n  {{/showRelatedContents}}\n\n  {{#showRelatedGroups}}\n    <GroupRelatedGroupsView key="related_groups"/>\n  {{/showRelatedGroups}}\n\n  {{#showOptions}}\n    <GroupOptionsView key="options"/>\n  {{/showOptions}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/group_sidebar",["require","underscore","core/lib/treatment","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./group_pending_members","./group_info","./group_related_contents","./group_related_groups","./group_options","./group_search","./featured_group_members","components/sidebar_o365_links/index","core/lib/session","components/suite_nav/src/suite_nav","models/helpers/group","html!./group_sidebar"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/treatment"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("./group_pending_members"),h=a("./group_info"),i=a("./group_related_contents"),j=a("./group_related_groups"),k=a("./group_options"),l=a("./group_search"),m=a("./featured_group_members"),n=a("components/sidebar_o365_links/index"),o=a("core/lib/session"),p=a("components/suite_nav/src/suite_nav"),q=a("models/helpers/group"),r=a("html!./group_sidebar"),s=d.extend({
mixins:[e,f],template:r,views:{GroupPendingMembersView:"_getGroupPendingMembers",GroupInfoView:"_getGroupInfo",GroupRelatedContentsView:"_getGroupRelatedContents",GroupRelatedGroupsView:"_getGroupRelatedGroups",GroupOptionsView:"_getGroupOptions",GroupSearchView:"_getGroupSearchView",FeaturedGroupMembersView:"_getFeaturedGroupMembersView",SidebarO365LinksView:"_getSidebarO365LinksView"},initialize:function(){this.listenTo(this.model,"change",b.debounce(this.render,100))},getTemplateData:function(){return this._modulePermissions()},_modulePermissions:function(){var a=this._fullModulePermissions(),d=this._readModulePermissions(),e={showInfo:this._hasInfo(),showRelatedContents:(c.treatment("external_groups_phase5")||!q.isExternal(this.model))&&(a||this._hasRelatedContents()&&d)};return q.isAllCompany(this.model)||b.extend(e,{showPending:this._canApprove(),showRelatedGroups:!q.isExternal(this.model)&&(a||this._hasRelatedGroups()&&d),showOptions:this._hasSubscriptions(),o365_suite_groups:this._isInO365SuiteGroups()}),e},_fullModulePermissions:function(){var a=q.isEditableByCurrentUser(this.model),b=q.isCurrentUserMember(this.model);return a||b},_readModulePermissions:function(){return!q.isPrivate(this.model)},_canApprove:function(){return q.canUserApproveMembers(this.model)},_hasInfo:function(){return q.isEditableByCurrentUser(this.model)||!!this.model.get("group_info")},_hasSubscriptions:function(){return!!this.model.get("subscriptions")},_hasRelatedContents:function(){var a=this.model.get("related_contents");return a&&a.length>0},_hasRelatedGroups:function(){var a=this.model.get("related_groups");return a&&a.length>0},_getGroupPendingMembers:function(){return new g(this.options)},_getGroupInfo:function(){return new h(this.options)},_getGroupRelatedContents:function(){var a=o.getCurrentNetwork(),b=this.model&&!q.isAllCompany(this.model)?this.model:a,c={id:b.get("id"),type:b.get("type")};return new i({source:c,model:this.model,collection:this.model.get("related_contents"),editable:this._fullModulePermissions()})},_getGroupRelatedGroups:function(){return new j({model:this.model,collection:this.model.get("related_groups"),editable:this._fullModulePermissions()})},_getGroupOptions:function(){return new k(this.options)},_getGroupSearchView:function(){return new l({model:this.model})},_getFeaturedGroupMembersView:function(){return new m({model:this.model,collection:this.model.get("featured_users")})},_getSidebarO365LinksView:function(){return new n},_isInO365SuiteGroups:function(){return p.exists()&&c.treatment("suite_groups_sidebar_ui")}});return s}),define("css!common-ui/lib/ui/shared/explore_feed_cta",[],function(){}),define("stache!common-ui/lib/ui/shared/explore_feed_cta",["mustache"],function(a){var b='<div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block">\n  <button type="button" class="unstyle-button-as-span">\n    <div class="yj-explore-feed-cta--explore-label">{{labelText}}: </div>\n    <div class="yj-explore-feed-cta--explore-details">{{feedDetails}}</div>\n  </button>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/explore_feed_cta",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/tr","core/lib/yammer_uri","core/lib/location_helper","models/lib/model/helper/report_feed_events","css!./explore_feed_cta","html!./explore_feed_cta"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/tr"),e=a("core/lib/yammer_uri"),f=a("core/lib/location_helper"),g=a("models/lib/model/helper/report_feed_events"),h="group_to_group_workflow_cta";return a("css!./explore_feed_cta"),c.extend({mixins:[b],className:"yj-explore-feed-cta zindex-t3",template:a("html!./explore_feed_cta"),events:{click:"_onClick",mouseover:"_logHover"},attributes:{role:"heading","aria-level":2},initialize:function(){this._reportEvent("feed_link_displayed",h)},_reportEvent:function(a,b){g.reportFeedEvent(a,"algo",null,{link_type:b,is_from_home:!1})},_getFeedUrl:function(){return e.app("/#/home",{type:"algo"})},_logHover:function(){if(!this._hoverLogged){var a="company"===this.options.currentGroupInfo.type;g.reportFeedEvent("feed_link_hover","algo",null,{link_type:h,from_group_type:a?"general":"group",from_group_id:this.options.currentGroupInfo.id}),this._hoverLogged=!0}},_onClick:function(a){a.stopPropagation(),this._reportEvent("feed_link_click",h),f.assign(this._getFeedUrl())},getTemplateData:function(){var a={feedUrl:this._getFeedUrl(),labelText:d.t("explore"),feedDetails:d.t("discover_conversations_v2")};return a}})}),define("css!common-ui/lib/ui/shared/next_group_cta",[],function(){}),define("stache!common-ui/lib/ui/shared/next_group_cta",["mustache"],function(a){var b='<div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block">\n  <button type="button" class="unstyle-button-as-span">\n    <div class="yj-next-group-cta--next-group-label">{{labelText}}: </div>\n    <div class="yj-next-group-cta--group-name" title="{{groupName}}">{{groupName}}</div>\n    {{#groupCountDetails}}\n      <div class="yj-next-group-cta--next-group-details">{{groupCountDetails}}</div>\n    {{/groupCountDetails}}\n  </button>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/next_group_cta",["require","jquery","underscore","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/backbone_base_view","core/lib/tr","core/lib/location_helper","models/lib/model/helper/report_feed_events","components/avatar/src/avatar","core/lib/urls","core/lib/treatment","css!./next_group_cta","html!./next_group_cta"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/backbone_base_view"),g=a("core/lib/tr"),h=a("core/lib/location_helper"),i=a("models/lib/model/helper/report_feed_events"),j=a("components/avatar/src/avatar"),k=a("core/lib/urls"),l=a("core/lib/treatment"),m="group_to_group_workflow_cta";return a("css!./next_group_cta"),f.extend({mixins:[d,e],className:"yj-next-group-cta yj-dark-gray zindex-t1",template:a("html!./next_group_cta"),events:{click:"_onClick",mouseover:"_onMouseOver",mouseout:"_onMouseOut"},views:{GroupAvatar:"_getGroupAvatar"},attributes:{role:"heading","aria-level":2},initialize:function(){if(!this.options.nextGroup)throw new Error("NextGroupCta requires a Group model value in options.nextGroup");this.options.unreadCount=this.options.unreadCount||0,this._reportEvent("feed_link_displayed")},isFromGroupFeed:function(){return!!this.options.isFromGroupFeed},_getGroupAvatar:function(){return new j({model:this.options.nextGroup,size:24,withHovercard:!1,badge:null,hideFromAccessibility:!0,excludeLink:!0})},_reportEvent:function(a,b){var d="COMPANY_GROUP_ID"===this.options.nextGroup.get("id"),e=c.extend({link_type:m,is_from_home_feed:!this.isFromGroupFeed()},b);i.reportFeedEvent(a,d?"general":this.options.nextGroup.get("type"),d?null:this.options.nextGroup.get("id"),e)},_getFeedUrl:function(){return k.groupIndex(this.options.nextGroup)},getTemplateData:function(){var a,b=this.options.nextGroup.get("full_name"),c=this.isFromGroupFeed()&&l.treatment("tow_self_sufficient_groups_phase1")&&!l.treatment("tow_g2g_v2");return a=this.options.unreadCount>20?c?g.t("twenty_plus_new_items_new"):g.t("twenty_plus_new_items_unread"):c?g.t("count_new_posts_unread",{count:this.options.unreadCount}):g.t("count_new_posts_new",{count:this.options.unreadCount}),{feedUrl:this._getFeedUrl(),labelText:this.isFromGroupFeed()?g.t("next_group"):g.t("next_group_from_home"),groupName:b,groupCountDetails:a}},_onClick:function(a){a.stopPropagation(),this._reportEvent("feed_link_click"),this._getMatchingGroupNavElem().removeClass("yj-highlight"),h.assign(this._getFeedUrl())},_getMatchingGroupNavElem:function(){if(!this._matchingNavElem){var a=this.options.nextGroup.get("id");"COMPANY_GROUP_ID"===this.options.nextGroup.get("id")&&(a="all"),this._matchingNavElem=b(".yj-group-nav-list li[data-group-id="+a+"]")}return this._matchingNavElem},_onMouseOver:function(){this._logHover(),this._getMatchingGroupNavElem().addClass("yj-highlight")},_logHover:function(){if(!this._hoverLogged){var a,b=null;switch(this.options.currentGroupInfo.type){case"company":a="general";break;case"home":a="algo";break;default:a="group",b=this.options.currentGroupInfo.id}this._reportEvent("feed_link_hover",{from_group_id:b,from_group_type:a}),this._hoverLogged=!0}},_onMouseOut:function(){this._getMatchingGroupNavElem().removeClass("yj-highlight")}})}),define("common-ui/lib/ui/shared/next_group_cta_trigger",["require","core/lib/backbone_base_class","common-ui/lib/ui/shared/scroll_monitor"],function(a){"use strict";var b=a("core/lib/backbone_base_class"),c=a("common-ui/lib/ui/shared/scroll_monitor");return b.extend({initialize:function(){this._viewedThreads=[],this.options.offsetPixels?this._switchToOffsetTrigger($(window).height()+this.options.offsetPixels):(this.listenTo(this.options.scrollSpy,"scrolledInTop",this._checkShow),this.listenTo(this.options.scrollSpy,"scrolledBelowTop",this._checkHide))},stop:function(){this.stopListening(),this._stopScrollMonitor()},_stopScrollMonitor:function(){this._scrollMonitor&&this._scrollMonitor.stop()},_checkShow:function(){this._ensureInitialShow(),this.trigger("scrolledBelowTrigger")},_checkHide:function(){this.trigger("scrolledAboveTrigger")},_switchToOffsetTrigger:function(a){this._triggerOffsetPosition=a,this.stopListening(),this._createScrollMonitor()},_ensureInitialShow:function(){this._hasBeenShown||(this._hasBeenShown=!0,this.trigger("show"))},_createScrollMonitor:function(){var a=this._scrollMonitor=new c;this.listenTo(a,"scroll",this._onScroll.bind(this)),a.start()},_onScroll:function(a,b){var c=this._isScrolledPastTrigger(b);c&&"below"!==this._previousPosition?(this._ensureInitialShow(),this.trigger("scrolledBelowTrigger"),this._previousPosition="below"):c||"above"===this._previousPosition||(this.trigger("scrolledAboveTrigger"),this._previousPosition="above")},_isScrolledPastTrigger:function(a){var b=a+window.innerHeight;return b>=this._triggerOffsetPosition}})}),define("common-ui/lib/ui/shared/shift_up_viewport",["require","jquery","core/lib/backbone_base_class"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_base_class");return c.extend({initialize:function(){this.$slidingElement=b(this.options.slidingElement),this.shiftDelta=this.$slidingElement.outerHeight(),this.$slidingElement.addClass("yj-fixed-bottom"),this.$fixedBottomElemsToLift=b(this.options.fixedBottomElems),this._slidingElements=b(this.$slidingElement).add(this.$fixedBottomElemsToLift),this._setShiftedUp(!1)},_setShiftedUp:function(a){this._isShiftedUp=a},shiftUp:function(){this.shiftToggle("up")},shiftDown:function(){this.shiftToggle("down")},shiftToggle:function(a){var b="up"===a,c="down"===a;b&&this._isShiftedUp||c&&!this._isShiftedUp||(this._slidingElements.stop(!0,!0).velocity({translateY:b?-this.shiftDelta:0},{easing:"ease-out"}),this._setShiftedUp(b))}})}),define("common-ui/lib/ui/shared/next_group",["require","jquery","core/lib/backbone_base_class","common-ui/lib/ui/shared/explore_feed_cta","common-ui/lib/ui/shared/next_group_cta","common-ui/lib/ui/shared/next_group_cta_trigger","common-ui/lib/ui/shared/scroll_spy","common-ui/lib/ui/shared/shift_up_viewport","models/lib/model/helper/top_groups"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_base_class"),d=a("common-ui/lib/ui/shared/explore_feed_cta"),e=a("common-ui/lib/ui/shared/next_group_cta"),f=a("common-ui/lib/ui/shared/next_group_cta_trigger"),g=a("common-ui/lib/ui/shared/scroll_spy"),h=a("common-ui/lib/ui/shared/shift_up_viewport"),i=a("models/lib/model/helper/top_groups");return c.extend({initialize:function(){this._scrollSpy=this._createScrollSpy(),this._nextGroupCtaTrigger=new f({scrollSpy:this._scrollSpy,offsetPixels:this.options.offsetPixels}),this._nextGroupCtaTrigger.on("show",this._renderNextGroupCta,this)},reload:function(){this._scrollSpy.reload()},_createScrollSpy:function(){var a=".yj-end-of-unread-feed-banner:not(.is-hidden)";return new g(a,{container:window,scrollInterval:200})},_createNextGroupCta:function(){var a,b=this.options.type;a="home"===b?i.getNextGroupFromHome():"company"===b?i.getNextGroupFromAllCompany():i.getNextGroupFromGroup(this.options.groupId);var c,f={id:this.options.groupId,type:b};return a?c=new e({nextGroup:a,currentGroupInfo:f,unreadCount:i.getUnviewedCountForGroup(a.get("id")),isFromGroupFeed:"home"!==b}):"home"!==b&&(c=new d({currentGroupInfo:f})),c},_renderNextGroupCta:function(){if(this._nextGroupCta=this._createNextGroupCta(),this._nextGroupCta){this.options.container.append(this._nextGroupCta.render().$el);var a=b(".yj-fixed-bottom");this._shiftUpViewport=new h({slidingElement:this._nextGroupCta.$el,fixedBottomElems:a}),this._showNextGroupCta(),this._nextGroupCtaTrigger.on("scrolledAboveTrigger",this._hideNextGroupCta,this),this._nextGroupCtaTrigger.on("scrolledBelowTrigger",this._showNextGroupCta,this)}else this._removeCtaTrigger()},_hideNextGroupCta:function(){this._shiftUpViewport.shiftDown()},_showNextGroupCta:function(){this._shiftUpViewport.shiftUp()},_removeCtaTrigger:function(){this._nextGroupCtaTrigger&&(this._nextGroupCtaTrigger.off(),this._nextGroupCtaTrigger.stop())},remove:function(){this._scrollSpy.destroy(),this._removeCtaTrigger(),this._nextGroupCta&&this._nextGroupCta.remove(),this._shiftUpViewport&&this._shiftUpViewport.shiftDown()}})}),define("workfeed/lib/app/views/threads/view_with_unviewed_section",["require","underscore","models/lib/helper/feed_factory","core/lib/util/route_helper","core/lib/routing/group_viewed_routing_helper","models/helpers/group","core/lib/session"],function(a){var b=a("underscore"),c=a("models/lib/helper/feed_factory"),d=a("core/lib/util/route_helper"),e=d.executeInCurrentFragment,f=a("core/lib/routing/group_viewed_routing_helper"),g=a("models/helpers/group"),h=a("core/lib/session"),i={_setupInitialView:function(){this.fetchGroupPromise.then(e(function(a){g.isVisibleByCurrentUser(a,h)&&this._showFeed()}.bind(this)))},_showFeed:function(){this.isFeedSelected=!0,this.render()},_getGroupFeed:function(){var a=f.groupTypeKeys[this.groupType][this.options.view],b=c.findOrCreate(a,this.groupId);return b}},j=function(a){a._createThreadList=b.wrap(a._createThreadList,function(b){var c=a._getGroupFeed();c.pruneUsingContentFilter();var d=b.call(a);return this.scrollSpy&&("unviewed"===this.options.view?this.listenTo(d,"sync",function(){this.scrollSpy.reload()}.bind(this)):this.scrollSpy.stop()),d}),b.extend(a,i)};return j}),define("stache!workfeed/lib/app/views/threads/company",["mustache"],function(a){var b='{{#hasGroup}}<GroupHeader key="group-header"/>{{/hasGroup}}\n<div class="page-content-container yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block sticky-group-header-column" role="main">\n  {{#hasError}}<GroupErrorNotice key="group-error-notice"/>{{/hasError}}\n  <div class="yk-row">\n    <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n      {{#showThreadList}}<ThreadList key="thread-list"/>{{/showThreadList}}\n    </div>\n    {{#showSidebar}}\n      <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6">\n        <GroupSidebar key="group-sidebar"/>\n      </div>\n    {{/showSidebar}}\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/threads/company",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","workfeed/lib/app/header/group_error_notice","workfeed/lib/app/header/group_header","workfeed/lib/app/sidebar/group_sidebar","common-ui/lib/ui/shared/next_group","feeds/lib/ui/threads/future/thread_list","models/lib/helper/feed_factory","workfeed/lib/app/helpers/group_error_helper","models/helpers/group","common-ui/lib/ui/keyboard/group_navigation_commands","core/lib/util/route_helper","core/lib/session","core/lib/treatment","feeds/lib/ui/util/title_updater","workfeed/lib/app/views/threads/view_with_unviewed_section","core/lib/yammer_api","models/helpers/network","html!./company"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("workfeed/lib/app/header/group_error_notice"),f=a("workfeed/lib/app/header/group_header"),g=a("workfeed/lib/app/sidebar/group_sidebar"),h=a("common-ui/lib/ui/shared/next_group"),i=a("feeds/lib/ui/threads/future/thread_list"),j=a("models/lib/helper/feed_factory"),k=a("workfeed/lib/app/helpers/group_error_helper"),l=a("models/helpers/group"),m=a("common-ui/lib/ui/keyboard/group_navigation_commands"),n=a("core/lib/util/route_helper"),o=a("core/lib/session"),p=a("core/lib/treatment"),q=a("feeds/lib/ui/util/title_updater"),r=a("workfeed/lib/app/views/threads/view_with_unviewed_section"),s=a("core/lib/yammer_api"),t=a("models/helpers/network"),u=a("html!./company");return c.extend({mixins:[b,d],template:u,views:{GroupHeader:"_createGroupHeader",GroupErrorNotice:"_createGroupErrorNotice",ThreadList:"_createThreadList",GroupSidebar:"_createGroupSidebar"},id:"threadsCompany",initialize:function(){r(this),this.groupType="general",q.setTitle(t.getCompanyGroupName(o.getCurrentNetwork())),this.fetchGroupPromise=l.fetch("company"),p.treatment("tow_g2g_v2")||this._startNextGroupCta(),this._setupInitialView(this.options),this.fetchGroupPromise.then(n.executeInCurrentFragment(this._groupFetchSuccess,this),n.executeInCurrentFragment(this._groupFetchError,this)),m.setAllCompanyView()},_startNextGroupCta:function(){"unviewed"===this.options.view&&(this._nextGroup=new h({container:this.$el,type:"company"}))},_getGroupFeed:function(){return j.findOrCreate("general")},_createThreadList:function(){var a=new i({feed:this._getGroupFeed(),markAsViewedOnScroll:!0});return this._nextGroup&&this.listenTo(a,"render sync",this._nextGroup.reload.bind(this._nextGroup)),a},_createGroupHeader:function(){return new f({model:this._group,view:this.options.view})},_createGroupErrorNotice:function(){return new e({group:this._group,error:this._error})},_createGroupSidebar:function(){return new g({model:this._group})},_groupFetchSuccess:function(a){this._group=a,s.registerGroupVisit({id:"company"}),this._showThreadList=!0;try{this.render()}catch(a){this.render()}},_groupFetchError:function(a){this._error=k.getErrorForStatus(a.status);try{this.render()}catch(a){this.render()}},getTemplateData:function(){return{hasGroup:!!this._group,hasError:!!this._error,showThreadList:this.isFeedSelected&&this._showThreadList,showSidebar:this._showThreadList}},remove:function(){return this._nextGroup&&this._nextGroup.remove(),m.clearView(),c.prototype.remove.call(this)}})}),define("workfeed/lib/app/views/threads/from_user",["require","jquery","core/lib/backbone_base_class","feeds/lib/ui/threads/future/thread_list","models/lib/helper/feed_factory","models/helpers/feed","common-ui/lib/helper/ui"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_base_class"),d=a("feeds/lib/ui/threads/future/thread_list"),e=a("models/lib/helper/feed_factory"),f=a("models/helpers/feed"),g=a("common-ui/lib/helper/ui");return c.extend({initialize:function(){var a=this.options,c=a.type,h=a.appId;g.setSelectedTabForFeed(h,c);var i,j=a.feedId;if("bookmarked_by"===c)i=e.findOrCreate("bookmarks",j);else{var k=f.getAppId("links"),l=f.getAppId("polls"),m=f.getAppId("announcements");i=k&&k===h?e.findOrCreate("userLinks",j):l&&l===h?e.findOrCreate("userPolls",j):m&&m===h?e.findOrCreate("userAnnouncements",j):e.findOrCreate("user",j)}var n=new d({feed:i,feedId:j,hideThreadStarter:!0});b(".yj-main-messagelist-container:first").append(n.render().$el),this.threadList=n},remove:function(){this.threadList.remove()}})}),define("css!common-ui/lib/ui/groups/group_description_editor_v2",[],function(){}),define("stache!common-ui/lib/ui/groups/group_description_editor_v2",["mustache"],function(a){var b='<h2 class="yj-group-description--header">{{headerText}}</h2>\n<p>\n  <InlineEditorView key="editor"/>\n</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/groups/group_description_editor_v2",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","common-ui/lib/ui/shared/inline_edit","collections/groups","backbone","core/lib/tr","core/lib/yammer_api","css!./group_description_editor_v2","html!./group_description_editor_v2"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("common-ui/lib/ui/shared/inline_edit"),g=a("collections/groups"),h=a("backbone"),i=a("core/lib/tr"),j=a("core/lib/yammer_api");return a("css!./group_description_editor_v2"),c.extend({mixins:[d,e],className:"yj-group-description yj-group-description-editor description",template:a("html!./group_description_editor_v2"),views:{InlineEditorView:"_getInlineEditor"},initialize:function(a){this._description=a.description,this._groupId=a.groupId},getTemplateData:function(){return{headerText:i.t("group_description_header")}},change:function(a){this._editor.trigger("change",a)},_getInlineEditor:function(){return this._editor=new f({type:"editable",maxLength:150,data_id:this._groupId,editType:"textarea",defaultText:i.t("default_group_description"),text:this._description,fieldLabel:i.t("group_description_form_label"),editLabel:i.t("edit_group_description")}),b.bindAll(this,"_onEditorChange"),this._editor.on("change",this._onEditorChange),this._editor},_onEditorChange:function(a){if(a){this._description=a.value,j.updateGroup({description:this._description,id:this._groupId});var b=g.get(this._groupId);b.set({description:this._description},{silent:!0}),h.trigger("/ui/group/descriptionEdit/"+this._groupId,this._description)}}})}),define("stache!common-ui/lib/ui/groups/group_description_viewer_v2",["mustache"],function(a){var b='<h2 class="yj-group-description--header">{{headerText}}</h2>\n<p>{{descriptionText}}</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!common-ui/lib/ui/groups/group_description_viewer_v2",[],function(){}),define("common-ui/lib/ui/groups/group_description_viewer_v2",["require","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./group_description_viewer_v2","css!./group_description_viewer_v2"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("html!./group_description_viewer_v2");return a("css!./group_description_viewer_v2"),c.extend({className:"yj-group-description description",template:e,mixins:[d],initialize:function(a){this._description=a.description},getTemplateData:function(){return{headerText:b.t("group_description_header"),descriptionText:this._description}}})}),define("feeds/lib/helper/parameter_helper",["require","core/lib/report"],function(a){"use strict";var b=a("core/lib/report");return{filterTrackingParams:function(a){var c,d,e,f={},g={};for(d in a)e=a[d],"trk_event"===d?c=e:"trk_"===d.substr(0,4)?f[d.substr(4)]=e:g[d]=e;return c&&b.event(c,f),g}}}),define("stache!workfeed/lib/app/views/threads/in_group",["mustache"],function(a){var b='{{#hasGroup}}<GroupHeader key="group-header"/>{{/hasGroup}}\n<div class="page-content-container yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block sticky-group-header-column" role="main">\n  {{#hasError}}<GroupErrorNotice key="group-error-notice"/>{{/hasError}}\n  <div class="yk-row">\n    <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n      {{#showDescription}}<GroupDescription key="group-description"/>{{/showDescription}}\n      {{#showThreadList}}<ThreadList key="thread-list"/>{{/showThreadList}}\n    </div>\n    {{#showSidebar}}\n      <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6">\n        <GroupSidebar key="group-sidebar"/>\n      </div>\n    {{/showSidebar}}\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/threads/in_group",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","workfeed/lib/app/header/group_error_notice","common-ui/lib/ui/groups/group_description_editor_v2","common-ui/lib/ui/groups/group_description_viewer_v2","workfeed/lib/app/header/group_header","workfeed/lib/app/sidebar/group_sidebar","common-ui/lib/ui/groups/member_list","common-ui/lib/ui/shared/next_group","feeds/lib/ui/threads/future/thread_list","models/lib/model/helper/top_groups","models/lib/helper/feed_factory","workfeed/lib/app/helpers/group_error_helper","models/helpers/group","common-ui/lib/ui/keyboard/group_navigation_commands","feeds/lib/helper/parameter_helper","core/lib/util/route_helper","core/lib/session","feeds/lib/ui/util/title_updater","core/lib/tr","core/lib/treatment","workfeed/lib/app/views/threads/view_with_unviewed_section","core/lib/yammer_api","collections/group_memberships","html!./in_group"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("workfeed/lib/app/header/group_error_notice"),f=a("common-ui/lib/ui/groups/group_description_editor_v2"),g=a("common-ui/lib/ui/groups/group_description_viewer_v2"),h=a("workfeed/lib/app/header/group_header"),i=a("workfeed/lib/app/sidebar/group_sidebar"),j=a("common-ui/lib/ui/groups/member_list"),k=a("common-ui/lib/ui/shared/next_group"),l=a("feeds/lib/ui/threads/future/thread_list"),m=a("models/lib/model/helper/top_groups"),n=a("models/lib/helper/feed_factory"),o=a("workfeed/lib/app/helpers/group_error_helper"),p=a("models/helpers/group"),q=a("common-ui/lib/ui/keyboard/group_navigation_commands"),r=a("feeds/lib/helper/parameter_helper"),s=a("core/lib/util/route_helper"),t=a("core/lib/session"),u=a("feeds/lib/ui/util/title_updater"),v=a("core/lib/tr"),w=a("core/lib/treatment"),x=a("workfeed/lib/app/views/threads/view_with_unviewed_section"),y=a("core/lib/yammer_api"),z=a("collections/group_memberships"),A=a("html!./in_group");return c.extend({mixins:[b,d],template:A,views:{GroupHeader:"_createGroupHeader",GroupErrorNotice:"_createGroupErrorNotice",GroupDescription:"_createGroupDescription",ThreadList:"_createThreadList",GroupSidebar:"_createGroupSidebar"},id:"threadsInGroup",initialize:function(){x(this);var a=r.filterTrackingParams(this.options);this.groupId=a.feedId,this.groupType="group",u.setTitle(""),this.fetchGroupPromise=p.fetch(this.groupId),w.treatment("tow_g2g_v2")||this._startNextGroupCta(),this._setupInitialView(a),this.fetchGroupPromise.then(s.executeInCurrentFragment(this._groupFetchSuccess,this),s.executeInCurrentFragment(this._groupFetchError,this)),q.setGroupView(this.groupId)},_startNextGroupCta:function(){"unviewed"===this.options.view&&m.getIndexForGroup(this.groupId)>-1&&(this._nextGroup=new k({container:this.$el,groupId:this.groupId}))},_getGroupFeed:function(){return n.findOrCreate("group",this.groupId)},_createThreadList:function(){var a=this.groupId,b=this._getGroupFeed().isUnviewed()?v.t("unread_conversations_accessible_heading"):v.t("all_conversations_accessible_heading"),c=new l({feed:this._getGroupFeed(),feedId:a,markAsViewedOnScroll:!0,accessibilityLabel:b});return this._nextGroup&&this.listenTo(c,"render sync",this._nextGroup.reload.bind(this._nextGroup)),c},_createGroupDescription:function(){var a=this._group,b=a.get("description")&&!p.isCurrentUserMember(a),c=b?g:f;return new c({groupId:this.groupId,description:a.get("description")})},_createGroupHeader:function(){return new h({model:this._group,view:this.options.view})},_createGroupErrorNotice:function(){return new e({group:this._group,error:this._error})},_createGroupSidebar:function(){return new i({model:this._group})},_groupFetchSuccess:function(a){var b=t.getCurrentUser().id;if(this._group=a,p.isUserInvited(a,b)&&z.add({user_id:b,group_id:a.get("id"),invited:!0}),this._error=o.getErrorForGroup(a),u.setTitle(a.get("full_name"),{announce:!0}),!this._error){p.isCurrentUserMember(a)&&z.add({user_id:t.getCurrentUser().id,group_id:a.get("id")}),y.registerGroupVisit({id:this.groupId}),this._showThreadList=!0;var c=a.get("description")&&!p.isCurrentUserMember(a),d=!a.get("description")&&p.isEditableByCurrentUser(a);(c||d)&&(this._showDescription=!0),a.has("stats")?this._showLightbox():this.listenToOnce(a,"change:stats",s.executeInCurrentFragment(this._showLightbox,this))}this.render()},_showLightbox:function(){var a=this._group,b=a.get("stats"),c=a.get("invited_requests_count")>0,d=null!=b&&1===b.members,e=p.isCurrentUserMember(a),f=p.canCurrentUserInviteMembers(a,t);if(d&&!c&&e&&f){var g=new j({groupId:a.get("id"),permalink:a.get("name"),isCompanyGroup:!1,isCommunity:t.getCurrentNetwork().get("community"),inviteSection:"groups_page_automatic_add_members_lightbox",groupMembersTitle:v.t("add_members_to_this_group"),showMembersCount:!1});j.showInLightbox(g)}},_groupFetchError:function(a){this._error=o.getErrorForStatus(a.status),this.render()},getTemplateData:function(){return{hasGroup:!!this._group,hasError:!!this._error,showDescription:this._showDescription,showThreadList:this.isFeedSelected&&this._showThreadList,showSidebar:this._showThreadList}},remove:function(){return this._nextGroup&&this._nextGroup.remove(),q.clearView(),c.prototype.remove.call(this)}})}),define("stache!feeds/lib/ui/activities/activity_ticker_item",["mustache"],function(a){var b='<div class="yj-avatar-placeholder">\n    <Avatar key="avatar"/>\n</div>\n<span class="yj-activity-body">{{{body}}}</span>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/activities/activity_ticker_item",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/avatar/index","core/lib/model_helper","backbone","core/lib/uri_helper","core/lib/yammer_uri","html!./activity_ticker_item"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/avatar/index"),g=a("core/lib/model_helper"),h=a("backbone"),i=a("core/lib/uri_helper"),j=a("core/lib/yammer_uri"),k=a("html!./activity_ticker_item");return c.extend({mixins:[d,e],tagName:"li",className:"yj-activity-ticker-item",template:k,views:{Avatar:"_getAvatar"},getTemplateData:function(){return{body:this.options.data.getHtmlBody()}},_getAvatar:function(){var a=g.objectForReference({type:"user",id:this.options.data.getFirstUserReference()});return new f({model:a,withHovercard:!1,badge:null,hideFromAccessibility:!0})},render:function(){return this.$el.data("activity-id",this.options.data.id),this._cleanupLinks(),this._addHovercard(),this},appear:function(){var a=this.render().$el.addClass("is-prepended");return b.defer(function(){a.removeClass("is-prepended")}),a},_cleanupLinks:function(){this.$el.find(".yj-activity-body a").each(function(){var a=this.href;a&&(-1===a.indexOf(j.base())?this.target="_blank":this.href=i.replaceParam(a,"trk_event","ticker"))})},_addHovercard:function(){var a=this.options.data.getHovercard();a&&(a.hovercard_type=this.options.data.category,a.orientation="left",a.delay=1e3,a.track_event="ticker",h.trigger("/ui/hovercard/add",this.$el,a))}})}),define("css!feeds/lib/ui/activities/activity_ticker",[],function(){}),define("stache!feeds/lib/ui/activities/activity_ticker",["mustache"],function(a){var b='<h2 role="heading" aria-level="2" class="yj-recent-activity-ticker--header">\n  {{title}}</h2>\n<ul class="yj-activity-ticker-list"></ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/activities/activity_ticker",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","feeds/lib/ui/activities/activity_ticker_item","core/lib/log","common-ui/lib/ui/shared/scroller","core/lib/namespace","backbone","common-ui/lib/ui/shared/scroll_watcher","core/lib/tr","core/lib/yammer_uri","models/lib/events","models/stream","css!./activity_ticker","html!./activity_ticker"],function(a){
var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("feeds/lib/ui/activities/activity_ticker_item"),g=a("core/lib/log"),h=a("common-ui/lib/ui/shared/scroller"),i=a("core/lib/namespace"),j=a("backbone"),k=a("common-ui/lib/ui/shared/scroll_watcher"),l=a("core/lib/tr"),m=a("core/lib/yammer_uri"),n=a("models/lib/events");return a("models/stream"),a("css!./activity_ticker"),d.extend({mixins:[e],className:"yj-recent-activity-ticker",attributes:{"data-qaid":"activity-ticker"},defaults:{visibleItems:6,trailingItems:20,intervalMin:2,intervalMax:10,delay:3,prepend:!0,paused:!1,apiPath:"streams/activities?no_cursor=true&limit_rollup_list=true",minItems:6},getTemplateData:function(){return{title:l.t("recent_activity")}},template:a("html!./activity_ticker"),initialize:function(){c.bindAll(this,"onActivityCreate"),this._items=[],this._listItems=[],this._headIndex=0,this.subscribeToData()},render:function(){return this._attachScroller(),this._startScroller(),this.$loading=b('<li class="yj-activity-ticker-item yj-component yj-activity-loading"><div class="yj-activity-spinner yj-inline-spinner"></div></li>'),this},subscribeToData:function(){var a=m.api(this.options.apiPath);this.feed=yam.model.Stream.findOrCreate({url:a}),this.listenTo(n,"RollupStreamDelivery/"+this.feed.id+"/create",this.onActivityCreate),this.listenTo(this.feed,"onFirstPayload",this.onInitialActivities.bind(this)),this.feed.listen({delayStart:1e3*this.options.delay});var b=this;j.on("/ui/tooltip/visible",function(a){a.hasClass("yj-activity-ticker-item")&&(b.options.paused=!0)}),j.on("/ui/tooltip/hidden",function(){b.options.paused=!1})},_attachScroller:function(){this.$list=this.$el.find(".yj-activity-ticker-list"),this.scroller=h(this.$list,229,5,"100%",{useWheel:!0})},_startScroller:function(){var a;j.trigger("/ui/reflow/vertical"),a=".yj-scroller";var b=this;this.infiniteScroll=new k({onReached:function(){var a=b.$list.find(".yj-activity-ticker-item").last();b.showLoadingIndicator(),b.feed.fetchRollups({data:{older_than:a.data("activity-id")},afterProcess:function(){b.options.prepend=!0,b.hideLoadingIndicator()},success:function(a){i.val(a,"meta.older_available")?(g.log("more activity things available!"),b.infiniteScroll.start()):(g.log("no more activity things available"),b.infiniteScroll.stop()),b.options.prepend=!1}})},$contentArea:this.$list,$scrollableArea:this.$el.find(a)}),this.infiniteScroll.start()},onInitialActivities:function(){var a,b=this._items.length;return b<this.options.minItems?(this.$el.hide(),void this.remove()):(this._items.reverse(),this._headIndex=b-2,c.each(this._items,function(b,c){c<=this._headIndex&&(a=this._createActivityListItem(b),this.$list.prepend(a.render().$el))},this),this.feed.setLastSeen(c.last(this._items)),this.$el.slideDown(420,function(){j.trigger("/ui/reflow/vertical")}),void this._startTicker())},onActivityCreate:function(a){if(this.options.prepend)this._items.push(a),this.feed.setLastSeen(a);else{var b=new f({data:a},this);this.$list.append(b.render().$el),this.$list.trigger("domchange")}},hide:function(){this.$el.hide()},remove:function(){return this.feed.destroy(),d.prototype.remove.call(this)},_startTicker:function(){var a=function(){var b=1e3*c.random(this.options.intervalMin,this.options.intervalMax);this.options.paused||this._tick(),window.setTimeout(a.bind(this),b)};window.setTimeout(a.bind(this),2e3)},_createActivityListItem:function(a){var b=new f({data:a},this);return this._listItems.push(b),b},_tick:function(){this._updateIndex()&&this._cycleItems()},_updateIndex:function(){return this._headIndex+1<this._items.length?(this._headIndex++,!0):!1},_cycleItems:function(){var a=this._items[this._headIndex],b=this._createActivityListItem(a);this.$list.prepend(b.appear());var c=this.$list.parent().scrollTop();c>0&&this.$list.parent().scrollTop(c+b.$.outerHeight()),this.$list.trigger("domchange"),this._listItems.length>this.options.visibleItems+this.options.trailingItems&&this._listItems.splice(0,1)[0].remove()},showLoadingIndicator:function(){this.$list.append(this.$loading)},hideLoadingIndicator:function(){this.$loading.detach()}})}),define("stache!common-ui/lib/ui/shared/tabs",["mustache"],function(a){var b='{{#tabs}}<li class="yj-filter-tab{{#selected}} yj-selected{{/selected}}"><a class="yj-filter-tab-link" href="javascript://" data-tab-id="{{tabId}}" {{#yapp_id}}data-ymod-app-id="{{yapp_id}}"{{/yapp_id}}{{#client_app_id}}data-client-app-id="{{client_app_id}}"{{/client_app_id}}{{#type}}data-type="{{type}}"{{/type}}>{{{label}}}{{#tow_header_standardization}}{{#count}}<span class="yj-badge-count">{{count}}</span>{{/count}}{{/tow_header_standardization}}<span class="yj-acc-hidden"> {{tabAltText}}</span><span class="yj-acc-selectedstate"> {{selectedAltText}}</span></a></li>{{/tabs}}{{#more_tabs.length}}<li class="yj-tab-more yj-filter-tab yj-click-menu-trigger{{#more_sel}} yj-more-selected{{/more_sel}}" data-attach-menu="true"><a href="javascript://" class="yj-filter-tab-link yj-more-link" role="button" aria-haspopup="true">{{^tow_header_standardization}}{{more}} <small class="yj-down-arrow" aria-hidden="true">&#9660;</small>{{/tow_header_standardization}}{{#tow_header_standardization}}<span class="yamicon yamicon-ellipsis yk-yamicon-m"></span>{{/tow_header_standardization}}</a><ul class="yj-tab-dropdown yj-menu yj-menu-shadow yj-click-menu yj-click-menu-content">{{#more_tabs}}<li class="yj-tab-dropdown-item{{#selected}} yj-selected{{/selected}}"><a class="yj-tab-dropdown-link" href="javascript://" data-tab-id="{{tabId}}" {{#yapp_id}}data-ymod-app-id="{{yapp_id}}"{{/yapp_id}}{{#client_app_id}}data-client-app-id="{{client_app_id}}"{{/client_app_id}}{{#type}}data-type="{{type}}"{{/type}}>{{{label}}}{{#tow_header_standardization}}{{#count}} ({{count}}){{/count}}{{/tow_header_standardization}}</a></li>{{/more_tabs}}</ul></li>{{/more_tabs.length}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/tabs",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/tr","core/lib/treatment","html!./tabs"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/tr"),f=a("core/lib/treatment"),g=a("html!./tabs");return d.extend({tagName:"ul",className:"yj-tabs",template:g,events:{"click .yj-filter-tab-link, .yj-tab-dropdown-link":"_handleTabClick"},defaults:{settings:{maxTabs:5}},initialize:function(a){this.settings=a.settings,this.data=a.data,this.target=a.target,this.fetch=a.fetch,this.onTabSwitch=a.onTabSwitch,this.onTabClick=a.onTabClick,a.handleTabSwitch&&(this.handleTabSwitch=a.handleTabSwitch)},render:function(){var a,b,d,g=0,h=14;return this.data.tabs&&(this.data.tabs.length>this.settings.maxTabs?(g=c.reduce(this.data.tabs,function(a,b){return a+b.label.length},0)/this.data.tabs.length,g>h&&(this.settings.maxTabs-=1),a=this.data.tabs.slice(0,this.settings.maxTabs),b=this.data.tabs.slice(this.settings.maxTabs),d=c.any(b,function(a){return a.selected})):a=this.data.tabs,this.$el.html(this.template({tabs:a,more_tabs:b||[],more:e.t("more_2"),more_sel:d,tabAltText:e.t("tab"),selectedAltText:e.t("selected"),tow_header_standardization:f.treatment("tow_header_standardization")}))),this.settings.tabContent&&this._setTabHtml(),0===this.$(".yj-selected").length&&this._setSelected(this.$(".yj-filter-tab:first").addClass("yj-selected").find("a")),this},_setTabHtml:function(){this.$tabContent=b(this.settings.tabContent),this.data.tabHtml&&c.each(this.data.tabHtml,function(a,b){var c=this.$tabContent.find("#tab-"+b);c.length&&c.html(a)},this)},_setSelected:function(a){var b=a.attr("data-ymod-app-id"),c=a.attr("data-client-app-id");this.fetch?this.onTabSwitch.apply(this,[a,a]):(b||c)&&"function"==typeof this.onTabSwitch&&this.onTabSwitch.apply(this,[a,a]),this.handleTabSwitch(this.getTabId(a),this.getTabId(a))},_handleTabClick:function(a){var c,d=b(a.currentTarget),e="yj-selected";a.preventDefault(),d.hasClass("yj-more-link")||d.parent().hasClass(e)||(c=this.$("."+e).removeClass(e),this.$(".yj-more-selected").removeClass("yj-more-selected"),d.parent().addClass(e),d.hasClass("yj-tab-dropdown-link")&&this.$(".yj-tab-dropdown").addClass("yj-more-selected"),"function"==typeof this.onTabClick&&this.onTabClick.apply(this,[d,c]),"function"==typeof this.onTabSwitch&&this.onTabSwitch.apply(this,[d,c]),this.handleTabSwitch(this.getTabId(d),this.getTabId(c.find("a"))))},getTabId:function(a){return a.attr("data-tab-id")},_findTab:function(a){return c(this.data.tabs).findWhere({tabId:a})},showHideTab:function(a,b){b=b||"show",a&&(a instanceof d?a.$el[b]():a[b]())},handleTabSwitch:function(a,b){var c=this._findTab(a);c&&(c.selected=!0);var d=this._findTab(b);d&&(d.selected=!1),this.$tabContent?(this.$tabContent.find(".yj-tab-content").hide(),this.$tabContent.find("#"+a).show()):c&&c.tabComponent&&(this.showHideTab(d.tabComponent,"hide"),this.showHideTab(c.tabComponent,"show"))}})}),define("css!feeds/lib/ui/feeds/subscription_list",[],function(){}),define("feeds/lib/ui/feeds/subscription_list",["require","jquery","underscore","mustache","backbone","core/lib/session","common-ui/lib/ui/shared/spinner","common-ui/lib/ui/shared/follow_button","common-ui/lib/ui/shared/more_button","components/avatar/index","core/lib/jam/component","core/lib/yammer_api","models/user","css!./subscription_list"],function(a){var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("backbone"),f=a("core/lib/session"),g=a("common-ui/lib/ui/shared/spinner"),h=a("common-ui/lib/ui/shared/follow_button"),i=a("common-ui/lib/ui/shared/more_button"),j=a("components/avatar/index"),k=a("core/lib/jam/component"),l=a("core/lib/yammer_api");return a("models/user"),a("css!./subscription_list"),k.extend({init:function(a,d){k.prototype.init.call(this,b.extend({},this.defaults,a),d),this.addSubscribeButtons(this.data.references||[]),this.addSpinner(),this.paginate&&this.addMoreButton(),c.bindAll(this,"addSubscriptions")},defaults:{moreButton:null,spinner:null,initialized:!1,page:1,paginate:!0},afterRender:function(){!this.selected||this.initialized||this.postLoad||this.load()},template:'<div class="{{className}}"{{^selected}} style="display:none;"{{/selected}}><ul class="yj-follow-list {{type}}"></ul></div>',itemsTemplate:'{{#references}}<li class="yj-clearfix yj-follow-item {{className}}"><div class="yj-actions"></div>{{{info}}}</li>{{/references}}',descriptionTemplates:{people:'<div class="yj-mugshot" data-id="{{id}}"></div>              <a class="yj-name" href="{{web_url}}">{{full_name}}</a>               <p class="yj-description">{{job_title}}</p>',groups:'<a href="{{web_url}}" tabindex="-1" aria-hidden="true"><img class="yj-mug" src="{{mugshot_url}}" alt=""></a>           <a class="yj-name" href="{{web_url}}">{{full_name}}</a>           <p class="yj-description">{{description}}</p>',topics:'<a class="yj-name" href="{{web_url}}">{{name}}</a>'},addSpinner:function(){this.spinner=new g,this.spinner.prependToTarget=!0,this.spinner.renderHidden=!0,this.spinner.$el.hide(),this.addComponent(this.spinner)},addMoreButton:function(){this.moreButton=new i({renderHidden:!0,clickCallBack:this.handleMoreClick.bind(this)}),this.addComponent(this.moreButton)},handleMoreClick:function(){this.page+=1,this.load()},toggleLoading:function(a){this.spinner&&(a?this.spinner.$el.show():this.spinner.$el.hide())},toggleMoreButton:function(a){a?this.moreButton.show():this.moreButton.hide()},load:function(){var a={page:this.page};"people"==this.data.type?a.include_users=!0:"topics"==this.data.type&&(a.include_topics=!0),l.getSubscriptions(a).then(this.addSubscriptions),this.toggleLoading(1),this.initialized=!0},addSubscriptions:function(a){e.trigger("/client/subscriptions",a);var b=this.prepViewData(a);this.toggleLoading(0),this.spinner&&(this.spinner.destroy(),this.spinner=null),this.appendItems(b),a.meta&&(this.paginate&&this.toggleMoreButton(a.more_available),this.$element.trigger({type:"subscriptionsLoaded",message:a.meta.stats}))},clearList:function(){this.$element.find(".yj-follow-item").remove()},appendItems:function(a){var b=[];this.$element.find(".yj-follow-list").append(d.render(this.itemsTemplate,a)),b.push.apply(b,this.addSubscribeButtons(a.references)),b.push.apply(b,this.addAvatars(a.references)),this.renderChildren(b)},prepViewData:function(a){for(var b=a.references||[],c=0,e=b.length;e>c;c++)"people"==this.data.type&&(b[c]=yam.model.User.save(b[c])),b[c].info=d.render(this.descriptionTemplates[this.data.type],b[c]),b[c].className=this.getItemClassName(b[c]);return a.className=this.settings.elementClassName,a.selected=this.selected,a},getItemClassName:function(a){return"follow-"+a.type+"-"+a.id},createSubscribeButton:function(a){return new h(a)},addSubscribeButtons:function(a){for(var b,c,d,e=[],g=0,h=a.length;h>g;g++)c=a[g],"user"==c.type&&c.id===f.getCurrentUser().id||(d={model:c,target:"."+this.getItemClassName(c)+" .yj-actions"},b=this.createSubscribeButton(d),e.push(b),this.addComponent(b));return e},addAvatars:function(a){return c.map(a,function(a){var b=new j({model:a,withHovercard:!1,hideFromAccessibility:!0});return this.addChild(b,'.yj-mugshot[data-id="'+a.id+'"]'),b},this)},show:function(){this.initialized||this.load(),this.$element.show()}})}),define("feeds/lib/ui/feeds/group_membership_list",["require","common-ui/lib/ui/shared/follow_group_button","core/lib/session","feeds/lib/ui/feeds/subscription_list"],function(a){var b=a("common-ui/lib/ui/shared/follow_group_button"),c=a("core/lib/session"),d=a("feeds/lib/ui/feeds/subscription_list");return d.extend({load:function(){var a={references:c.getCurrentUser().group_memberships},b=this.prepViewData(a);this.initialized=!0,this.appendItems(b)},addMoreButton:function(){},addSpinner:function(){},createSubscribeButton:function(a){return a.following=!0,new b(a)}})}),define("feeds/lib/ui/feeds/subscriptions",["require","jquery","underscore","mustache","common-ui/lib/ui/shared/tabs","core/lib/jam/component","feeds/lib/ui/feeds/group_membership_list","core/lib/session","feeds/lib/ui/feeds/subscription_list","core/lib/tr"],function(a){var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("common-ui/lib/ui/shared/tabs"),f=a("core/lib/jam/component"),g=a("feeds/lib/ui/feeds/group_membership_list"),h=a("core/lib/session"),i=a("feeds/lib/ui/feeds/subscription_list"),j=a("core/lib/tr");return f.extend({init:function(a,c){f.prototype.init.call(this,b.extend({},this.defaults,a),c),this.addTabs(),this.settings.selected&&(this.initialized=!0)},afterRender:function(){this.updateGroupsLabel(h.getCurrentUser().group_memberships.length),this.$element.bind("subscriptionsLoaded",this.handleSubscriptionsLoaded.bind(this))},handleSubscriptionsLoaded:function(a){var b=a.message.following_users||"0",c=a.message.following_topics||"0";this.updateUsersLabel(b),this.updateTopicsLabel(c)},updateGroupsLabel:function(a){var b=this.$element.find(".groups-label");b.text(j.t("count_groups",{count:a})),h.getCurrentUser().web_preferences.network_settings.enable_groups||b.closest(".yj-filter-tab").hide()},updateUsersLabel:function(a){this.$element.find(".people-label").text(j.t("count_people",{count:a}))},updateTopicsLabel:function(a){this.$element.find(".topics-label").text(j.t("count_topics",{count:a}))},defaults:{id:"subscriptions",data:[{type:"people",label:j.t("people")},{type:"groups",label:" "+j.t("groups")},{type:"topics",label:" "+j.t("topics")}],settings:{elementClassName:"yj-subscriptions",selected:!1},tabs:[]},template:'<div class="{{className}}"><div class="yj-sub-hd"></div></div>',createElement:function(){var a=d.render(this.template,{id:this.getDomId(),className:this.settings.elementClassName,tabs:this.tabs});this.$element=b(a),this.settings.selected||this.$element.hide()},addTabs:function(){for(var a,b=this.data,d=[],f=0,g=b.length;g>f;f++)d.push({label:'<span class="'+b[f].type+'-label">'+c.escape(b[f].label)+"</span>",tabId:this.settings.elementClassName.replace("yj-","")+"-"+b[f].type,selected:0===f,tabComponent:this.addTabContentComponent(b[f],f)});a={target:".yj-sub-hd",data:{tabs:d},className:"yj-tabs yj-filters"},this.addComponent(new e(a)),this.tabs=d},addTabContentComponent:function(a,b){var c,d,e={type:a.type,id:this.settings.elementClassName.replace("yj-","")+"-"+a.type,settings:{elementClassName:"yj-tab-content"},data:a||[],selected:0===b,postLoad:!this.settings.selected};return d="groups"===a.type?g:i,c=new d(e,this),this.addComponent(c),c},show:function(){this.$element.show(),this.initialized||this.load()},load:function(){for(var a,b,c=0,d=this.tabs.length;d>c;c++)b=this.tabs[c].tabId,a=this.getComponent(b),a.selected&&(a.load(),this.initialized=!0)}})}),define("css!feeds/lib/ui/feeds/suggestion_search",[],function(){}),define("feeds/lib/ui/feeds/suggestion_search",["require","underscore","core/lib/jam/component","common-ui/lib/ui/shared/type_ahead","core/lib/tr","core/lib/yammer_api","models/user","css!./suggestion_search"],function(a){var b=a("underscore"),c=a("core/lib/jam/component"),d=a("common-ui/lib/ui/shared/type_ahead"),e=a("core/lib/tr"),f=a("core/lib/yammer_api");return a("models/user"),a("css!./suggestion_search"),c.extend({defaults:{id:"suggestionSearch",settings:{labelText:"Start typing a name..."},data:{},results:null},template:'<div class="yj-suggestion-search"><label><span class="yj-acc-hidden">{{searchBoxLabel}}</span><input class="yj-sugg-search yj-search-input yj-inactive" type="text" value="{{searchBoxLabel}}" /></label><span class="searching"><span class="yj-for"></span><a class="yj-clear-search" href="javascript://">show all suggestions</a></span></div>',prepViewData:function(){var a=this.settings.labelText;return"Start typing a name..."===a&&(a=e.t("start_typing_a_name")),{searchBoxLabel:a}},afterRender:function(){this.$searchBox=this.$element.find(".yj-search-input"),this.$searching=this.$element.find(".searching").hide(),this.$searchStatus=this.$searching.find(".yj-for"),this.$clear=this.$element.find(".yj-clear-search"),this.createTypeAhead(),this.results=this.parent.getComponent(this.results)},createTypeAhead:function(){var a={onSelect:this.handleRecipientSelect.bind(this),labelText:this.settings.labelText,maxResults:6,insertionMode:!1,completableModels:[d.MODEL_USER],hintMessage:e.t("start_typing_a_name")},c=this;b.defer(function(){c.typeAhead=d.registerField(c.$searchBox,a)})},handleRecipientSelect:function(a){var b=yam.model.User.findById(a.id);b?this.showSearchResults(b):f.getUser({id:a.id}).then(this.handleGetUserCallback.bind(this))},handleGetUserCallback:function(a){yam.model.User.save(a),this.showSearchResults(a)},showSearchResults:function(a){this.results.clearList(),this.results.addSubscriptions({references:[a],subscriptions:[]}),this.$searching.show();var c=this;b.defer(function(){c.resetSearchBox(),c.$searchBox.blur()}),this.triggerSearchEvent(!0)},observeDomEvents:function(){this.$clear.click(this.clearSearch.bind(this)),this.$searchBox.click(this.startSearch.bind(this)).focus(this.startSearch.bind(this))},clearSearch:function(){this.$searching.hide(),this.resetSearchBox(),this.triggerSearchEvent(!1)},triggerSearchEvent:function(a){this.$element.trigger({type:"suggestionSearch",message:{showResults:a}})},resetSearchBox:function(){this.$searchBox.attr("value",this.settings.labelText),this.$searchBox.addClass("yj-inactive")},startSearch:function(){this.getSearchValue()==this.settings.labelText&&(this.$searchBox.attr("value",""),this.$searchBox.removeClass("yj-inactive"))},getSearchValue:function(){return this.$searchBox.attr("value")}})}),define("feeds/lib/ui/feeds/suggestion_list",["require","mustache","feeds/lib/ui/feeds/subscription_list","common-ui/lib/ui/shared/follow_button","core/lib/yammer_api","models/user"],function(a){var b=a("mustache"),c=a("feeds/lib/ui/feeds/subscription_list"),d=a("common-ui/lib/ui/shared/follow_button"),e=a("core/lib/yammer_api");return a("models/user"),c.extend({load:function(){this.initialized=!0,e.getUserSuggestions().then(this.addSubscriptions.bind(this)),this.toggleLoading(1)},addMoreButton:function(){},createSubscribeButton:function(a){return a.following=!1,new d(a)},addSubscriptions:function(a){var b=this.prepViewData(a);this.appendItems(b),this.toggleLoading(0),this.$element.trigger({type:"suggestionsLoaded"})},prepViewData:function(a){for(var c=[],d=0,e=a.length;e>d;d++)c.push(a[d].suggested),"people"==this.data.type&&(c[d]=yam.model.User.save(c[d])),c[d].info=b.render(this.descriptionTemplates[this.data.type],c[d]),c[d].className=this.getItemClassName(c[d]);return{references:c,className:this.settings.elementClassName,selected:this.selected}}})}),define("feeds/lib/ui/feeds/suggestions",["require","jquery","feeds/lib/ui/feeds/subscriptions","feeds/lib/ui/feeds/suggestion_search","feeds/lib/ui/feeds/subscription_list","feeds/lib/ui/feeds/suggestion_list"],function(a){var b=a("jquery"),c=a("feeds/lib/ui/feeds/subscriptions"),d=a("feeds/lib/ui/feeds/suggestion_search"),e=a("feeds/lib/ui/feeds/subscription_list"),f=a("feeds/lib/ui/feeds/suggestion_list");return c.extend({init:function(a,d){this.tabs=[],c.prototype.init.call(this,b.extend({},this.defaults,a),d),this.addTabContent(),this.initialized=this.settings.selected},afterRender:function(){var a=this.$element.find(".yj-sub-hd").addClass("yj-hidden");this.$element.bind("suggestionsLoaded",function(){a.removeClass("yj-hidden")}),this.$search=this.getComponent("suggestionsSearchResults"),this.$suggestions=this.getComponent("suggestions-people"),this.$element.bind("suggestionSearch",this.suggestionSearch.bind(this))},suggestionSearch:function(a){a.message.showResults?(this.$search.show(),this.$suggestions.hide()):(this.$search.hide(),this.$suggestions.show())},defaults:{id:"suggestions",data:[{type:"people"}],settings:{elementClassName:"yj-suggestions",selected:!1},children:[{type:d,target:".yj-sub-hd",results:"suggestionsSearchResults"},{type:e,id:"suggestionsSearchResults",data:{type:"people"},initialized:!0,renderHidden:!0,settings:{elementClassName:"yj-tab-content"},followingDefault:!1}]},template:'<div class="{{className}}"><div class="yj-sub-hd"></div></div>',addTabs:function(){for(var a=this.data,b=[],c=0,d=a.length;d>c;c++)b.push({tabId:this.settings.elementClassName.replace("yj-","")+"-"+a[c].type,selected:0===c,label:"People"});this.tabs=b},addTabContent:function(){for(var a,b=this.data,c=0,d=b.length;d>c;c++)a={type:this.data[c],id:this.settings.elementClassName.replace("yj-","")+"-"+b[c].type,settings:{elementClassName:"yj-tab-content"},data:this.data[c],selected:0===c,postLoad:!this.settings.selected},this.addComponent(new f(a,this))}})}),define("css!feeds/lib/resources/stylesheets/configure_feed",[],function(){}),define("stache!feeds/lib/ui/feeds/configure_feed",["mustache"],function(a){var b='<div class="yj-action-bar-tabs"></div>\n<div class="yj-configure-feed__suggestions"></div>\n<div class="yj-configure-feed__subscriptions"></div>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/feeds/configure_feed",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","feeds/lib/ui/feeds/suggestions","feeds/lib/ui/feeds/subscriptions","common-ui/lib/ui/shared/tabs","core/lib/tr","css!feeds/lib/resources/stylesheets/configure_feed","html!./configure_feed"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("feeds/lib/ui/feeds/suggestions"),e=a("feeds/lib/ui/feeds/subscriptions"),f=a("common-ui/lib/ui/shared/tabs"),g=a("core/lib/tr");return a("css!feeds/lib/resources/stylesheets/configure_feed"),b.extend({className:"yj-config-feed",template:a("html!./configure_feed"),mixins:[c],defaults:{selectedTab:"subscriptions"},render:function(){return this._renderSuggestions(),this._renderSubscriptions(),this._renderTabs(),this},_renderSuggestions:function(){this.suggestions=new d({id:"configureFeedSuggestions",settings:{elementClassName:"yj-suggestions",selected:this._isSelectTab("suggestions")}}),this.suggestions.render(),this.$(".yj-configure-feed__suggestions").html(this.suggestions.$el)},_renderSubscriptions:function(){this.subscriptions=new e({id:"configureFeedSubscriptions",settings:{elementClassName:"yj-subscriptions",selected:this._isSelectTab("subscriptions")}}),this.subscriptions.render(),this.$(".yj-configure-feed__subscriptions").html(this.subscriptions.$el),this._loadSubscriptions()},_renderTabs:function(){this.tabs=new f({className:"yj-tabs feed-tabs",data:{tabs:[{label:g.t("im_following"),tabId:"configureFeedSubscriptions",selected:this._isSelectTab("subscriptions"),tabComponent:this.subscriptions},{label:g.t("suggestions"),tabId:"configureFeedSuggestions",selected:this._isSelectTab("suggestions"),tabComponent:this.suggestions}]}}),this.tabs.render(),this.$(".yj-action-bar-tabs").html(this.tabs.$el)},_loadSubscriptions:function(){"suggestions"===this.options.selectedTab&&this.subscriptions.load()},_isSelectTab:function(a){return this.options.selectedTab===a},remove:function(){this.tabs.remove(),this.subscriptions.remove(),this.suggestions.remove(),b.prototype.remove.call(this)}})}),define("feeds/lib/ui/feeds/configure_feed_link",["require","core/lib/backbone_base_class","feeds/lib/ui/feeds/configure_feed","backbone","core/lib/tr"],function(a){"use strict";var b=a("core/lib/backbone_base_class"),c=a("feeds/lib/ui/feeds/configure_feed"),d=a("backbone"),e=a("core/lib/tr");return b.extend({defaults:{selectedTab:"subscriptions"},_renderConfigureFeed:function(){this.configureFeed=new c({selectedTab:this.options.selectedTab}).render()},closeLightBox:function(){this.configureFeed.remove()},displayFeedLightbox:function(){this._renderConfigureFeed(),d.trigger("/ui/lightbox/open",{title:e.t("manage_following"),width:"450px",html:this.configureFeed.$el,onClosed:this.closeLightBox.bind(this)})}})}),define("stache!feeds/lib/ui/publisher/global/getting_started_publisher",["mustache"],function(a){var b='<div class="publisher-relative">\n  <div class="publisher-main">\n    <div class="publisher-body"></div>\n    <div class="publisher-recipients"></div>\n  </div>\n  <div class="publisher-warning"></div>\n  <div class="publisher-excerpt"></div>\n  <div class="publisher-actions">\n    <!-- <div class="publisher-topic"></div> -->\n    <!-- <div class="publisher-file"></div> -->\n    <a href="javascript://" role="button" class="skip-link">{{dismiss}}</a>\n    <div class="publisher-submit"></div>\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/publisher/global/getting_started_publisher",["require","underscore","core/lib/session","core/lib/tr","models/message_backbone","common-ui/lib/ui/shared/type_ahead","feeds/lib/ui/publisher/global/body_editor","feeds/lib/ui/publisher/global/recipient_selector_with_more","feeds/lib/ui/publisher/global/base_publisher","html!./getting_started_publisher"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/session"),d=a("core/lib/tr"),e=a("models/message_backbone"),f=a("common-ui/lib/ui/shared/type_ahead"),g=a("feeds/lib/ui/publisher/global/body_editor"),h=a("feeds/lib/ui/publisher/global/recipient_selector_with_more"),i=a("feeds/lib/ui/publisher/global/base_publisher"),j=a("html!./getting_started_publisher"),k=e.TYPE,l=b.object([[k.EMPTY,d.t("new_message")],[k.ALL_COMPANY,d.t("new_group_message")],[k.ALL_COMPANY_WITH_EXTERNAL,d.t("new_group_message")],[k.PUBLIC_GROUP,d.t("new_group_message")],[k.PUBLIC_GROUP_WITH_EXTERNAL,d.t("new_group_message")],[k.PRIVATE_GROUP,d.t("new_group_message")],[k.PRIVATE_GROUP_WITH_EXTERNAL,d.t("new_group_message")],[k.PRIVATE_MESSAGE,d.t("new_private_message_2")],[k.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("new_private_message_2")],[k.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("new_private_message_2")]]),m=b.object([[k.ALL_COMPANY,d.t("your_message_has_been_posted")],[k.ALL_COMPANY_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[k.PUBLIC_GROUP,d.t("your_message_has_been_posted")],[k.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[k.PRIVATE_GROUP,d.t("your_message_has_been_posted")],[k.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_message_has_been_posted")],[k.PRIVATE_MESSAGE,d.t("your_private_message_has_been_sent")],[k.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_message_has_been_sent")],[k.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_message_has_been_sent")]]),n=b.object([[k.ALL_COMPANY,d.t("your_message_could_not_be_posted")],[k.ALL_COMPANY_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[k.PUBLIC_GROUP,d.t("your_message_could_not_be_posted")],[k.PUBLIC_GROUP_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[k.PRIVATE_GROUP,d.t("your_message_could_not_be_posted")],[k.PRIVATE_GROUP_WITH_EXTERNAL,d.t("your_message_could_not_be_posted")],[k.PRIVATE_MESSAGE,d.t("your_private_message_could_not_be_sent")],[k.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("your_private_message_could_not_be_sent")],[k.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("your_private_message_could_not_be_sent")]]),o=b.object([[k.EMPTY,d.t("post")],[k.ALL_COMPANY,d.t("post")],[k.ALL_COMPANY_WITH_EXTERNAL,d.t("post")],[k.PUBLIC_GROUP,d.t("post")],[k.PUBLIC_GROUP_WITH_EXTERNAL,d.t("post")],[k.PRIVATE_GROUP,d.t("post")],[k.PRIVATE_GROUP_WITH_EXTERNAL,d.t("post")],[k.PRIVATE_MESSAGE,d.t("post")],[k.PRIVATE_MESSAGE_WITH_EXTERNAL,d.t("post")],[k.PRIVATE_MESSAGE_WITH_MENTIONS,d.t("post")]]),p={placeholder:d.t("write_your_message_here")},q={titles:l,successes:m,errors:n,editor:p,submit:o},r={};return i.extend({defaults:{icons:r,strings:q,showAlert:!0,warnOnRouteChange:!1,inLightbox:!1,allowAttachments:!1,logType:"yam.ui.publisher.global.GettingStarted",logSource:"default"},events:{"click .skip-link":"_skipTask"},className:"yj-global-publisher yj-global-getting-started-publisher yj-clearfix",template:j,render:function(){i.prototype.render.call(this,{dismiss:d.t("dismiss")})},_createModel:function(){return new e({sender:c.getCurrentUser()})},_getEditorModel:function(){return this.model},_getEditorClass:function(){return g},_getSelectorClass:function(){return h},_getSelectorOptions:function(){return{typeaheadModels:[f.MODEL_USER,f.MODEL_PENDINGUSER,f.MODEL_DOMAIN]}},_getDropdownDirection:function(){return this._inLightbox?"up":"down"},_requiresGroup:function(){return!0},_skipTask:function(){this.trigger("postTask:skipped")}})}),define("stache!workfeed/lib/app/sidebar/getting_started_post_task_lightbox",["mustache"],function(a){var b='<img src="{{image}}" data-low-res="{{lowResImage}}" id="post-task-sidebar-image" width="173" height="215" alt="{{imageAltText}}">\n<div id="post-task-publisher">\n  <div class="yj-getting-started-post-task">\n    <div class="yj-label yj-publisher-label yj-getting-started-label">{{labelText}}</div>\n    <Publisher/>\n  </div>\n</div>\n<div class="clear"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/getting_started_post_task_lightbox",["require","jquery","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/backbone_with_show_hide","core/lib/yammer_uri","core/lib/session","core/lib/tr","core/lib/yammer_request","core/lib/report","models/group","models/message_backbone","models/recipient","feeds/lib/ui/publisher/global/getting_started_publisher","html!./getting_started_post_task_lightbox"],function(a){"use strict";var b=a("jquery"),c=a("backbone"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("core/lib/backbone_with_show_hide"),h=a("core/lib/yammer_uri"),i=a("core/lib/session"),j=a("core/lib/tr"),k=a("core/lib/yammer_request"),l=a("core/lib/report"),m=a("models/group"),n=a("models/message_backbone"),o=a("models/recipient"),p=a("feeds/lib/ui/publisher/global/getting_started_publisher"),q=a("html!./getting_started_post_task_lightbox");return d.extend({mixins:[e,f,g],id:"post-task",template:q,views:{Publisher:"_getPublisher"},initialize:function(){this.message=new n({sender:i.getCurrentUser()
}),this._setGroupRecipient(),this.listenTo(this.message,"change:state",this._closeLightbox),this.listenTo(this,"show",this._showPublisher)},render:function(){if(b.browser.msie){var a=this.$("#post-task-sidebar-image").attr("data-low-res");this.$("#post-task-sidebar-image").attr("src",a)}return this},getTemplateData:function(){return{image:h.cdn("assets/images/post_task/update_2x.png"),lowResImage:h.cdn("assets/images/post_task/update_2x_low.png"),labelText:j.t("tell_your_coworkers_what_your_team_is_working_on"),imageAltText:j.t("getting_started_post_task_image_alt_text")}},onComplete:function(){b("#yj_cboxLoadedContent").css({overflow:"visible"}),l.event("nue_tasks_post_task")},_setGroupRecipient:function(){var a=this.message.get("recipients"),b=o.fromOriginalModel(m.ALL_COMPANY());b.set("fixed",!0),a.add(b)},_getPublisher:function(){return this._publisher=new p({model:this.message,inLightbox:!0}),this.listenTo(this._publisher,"postTask:skipped",this._skipTask),this._publisher},_showPublisher:function(){this._publisher.show()},_skipTask:function(){this._reportSkipped(),this._closeLightbox()},_reportSkipped:function(){k.send({url:h.app("getting_started/dismiss_post_task"),type:"POST"})},_closeLightbox:function(){c.trigger("taskListComplete","make_a_post"),c.trigger("/ui/lightbox/close")}})}),define("feeds/lib/ui/feeds/nue_mugshot_bar",["require","jquery","underscore","mustache","core/lib/backbone_legacy_integration","components/avatar/src/avatar","core/lib/session","core/lib/yammer_uri"],function(a){var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("core/lib/backbone_legacy_integration"),f=a("components/avatar/src/avatar"),g=a("core/lib/session"),h=a("core/lib/yammer_uri");return e.extend({tagName:"div",className:"yj-nue-mugshotbar",id:"nue-mugshotbar",users:{},defaults:{height:40,width:40,currentUserHeight:110,currentUserWidth:110,avatarClassName:"yj-nue-avatar",slotClassName:"yj-nue-mugshotbar-item",limit:5},slotTemplate:'<div class="{{slotClassName}} item{{i}} yj-empty">      <img src="{{followImage}}" width="{{width}}" height="{{height}}" alt=""/>      {{#isLast}}      <div class="yj-nue-extra-users">        <img src="{{dottedImage}}" width="{{width}}" height="{{height}}" alt=""/>        <span class="number">0</span>      </div>      {{/isLast}}    </div>',mugshotTemplate:'<img src="{{url}}" width="{{width}}" height="{{height}}" alt=""/>',noPhotoUrl:"/mugshot/images/40x40/no_photo.png",mugshotReplacementTemplate:'<div class="yj-follow-mugshot-replacement       yj-avatar--replacement-color-{{avatar_color_class}}" aria-hidden="true">{{first_letter}}{{last_letter}}</div>',initialize:function(a){c.defaults(this,a,this.defaults),this.slots=[],this.extraCounter=0},render:function(){return this.$el.append(this._constructCurrentUserAvatar()),this._createSlots(),this},_createSlots:function(){for(var a="",c=null,e=0,f=this.limit;f>e;e++)a=d.render(this.slotTemplate,{i:e,height:this.height,width:this.width,followImage:h.cdn("assets/images/follow_number_icon/follow_"+(e+1)+"_2x.png"),dottedImage:h.cdn("assets/images/follow_number_icon/dotted_2x.png"),isLast:e===f-1,slotClassName:this.slotClassName}),c=b(a),this.slots.push(c),this.$el.append(c)},_isRetinaDisplay:function(){return 2===window.devicePixelRatio},_constructAvatar:function(a,b){var c=new f({model:a,size:b,withHovercard:!1,askForPhoto:!1,excludeLink:!0,badge:!1});return c.render().$el},_constructCurrentUserAvatar:function(){var a=this._constructAvatar(g.getCurrentUser(),this.currentUserWidth,this.currentUserHeight);return b("<div></div>").append(a).addClass(this.avatarClassName)},_removeFirstAvailableSlot:function(){this.slots.length>1&&(this.slots=this.slots.slice(1))},_replaceFirstAvailableSlotWithMugshot:function(a){var b,c=this.slots;1===c.length?(this.extraCounter+=1,this.extraCounter<100&&(b="+"+this.extraCounter),c[0].find(".yj-nue-extra-users .number").text(b)):c[0].find("img").replaceWith(this._constructAvatar(a,this.width,this.height)),c[0].removeClass("yj-empty")},addMugshot:function(a){this._replaceFirstAvailableSlotWithMugshot(a),this._removeFirstAvailableSlot(),this.users[a.id]=a},hasUser:function(a){return void 0!==this.users[a.id]}})}),define("stache!workfeed/lib/app/sidebar/getting_started_group_task_lightbox",["mustache"],function(a){var b='<div class="groups-creation yj-nue">\n  <form accept-charset="UTF-8" action="{{formUrl}}" class="new_group" enctype="multipart/form-data" id="new_group" method="POST">\n    <input name="utf8" type="hidden" value="✓">\n    <input name="authenticity_token" type="hidden" value="{{csrfToken}}">\n    <input type="hidden" name="section" value="getting_started_group_creation_lightbox">\n    <input type="hidden" name="group[mugshot_id]">\n    <input type="hidden" name="group_id">\n\n    <input type="hidden" class="group-private-field" name="group[private]" value="false">\n\n    <input type="hidden" name="notify" value="true">\n\n    <img src="{{image}}" class="groups-creation-image" width="187" height="261" alt="{{imageAltText}}">\n\n    <fieldset class="group-info">\n      <dl>\n        <dt>\n          <label for="group_name_entry" class="label">{{groupNameLabel}}</label>\n        </dt>\n        <dd>\n          <div class="group-name">\n            <input class="group-name-field" maxlength="150" name="group[name]" id="group_name_entry"\n              size="150" type="text" placeholder="{{groupNamePlaceholder}}" autocomplete="off">\n            <span class="response group-name-status"></span>\n          </div>\n        </dd>\n      </dl>\n\n      <dl class="no-bottom-margin">\n        <dt>\n          <div class="label">{{groupMembersLabel}}</div>\n        </dt>\n        <dd class="group-add-member-container" data-watermark="{{groupMembersPlaceholder}}">\n          <TypeAhead />\n        </dd>\n      </dl>\n\n      <dl class="no-bottom-margin">\n        <dd class="group-mugshotbar-container"></dd>\n      </dl>\n    </fieldset>\n\n    <div class="groups-creation-footer yj-clearfix">\n      <div class="groups-creation-controls">\n        <a href="javascript://" class="link-skip">{{dismissLink}}</a> <button disabled class="yj-btn yj-btn-disabled button-submit"><span>{{createButton}}</span></button>\n      </div>\n    </div>\n  </form>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!workfeed/lib/app/sidebar/getting_started_group_task_lightbox_toggle",["mustache"],function(a){var b='<div class="group-creation-toggle">\n  <div class="private-message">\n    {{privateMessage}}.\n    <br>\n    <a href="javascript://" role="button" class="public-toggle">\n      {{publicToggleText}}</a>.\n  </div>\n  <div class="public-message">\n    {{publicMessage}}.\n    <a href="javascript://" role="button" class="private-toggle">{{privacyToggleText}}</a>.\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/getting_started_group_task_lightbox",["require","underscore","jquery","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/yammer_uri","models/user","common-ui/lib/helper/name_validator","core/lib/session","core/lib/tr","core/lib/yammer_request","core/lib/urls","core/lib/util/authenticity_token","feeds/lib/ui/feeds/nue_mugshot_bar","common-ui/lib/ui/shared/type_ahead_tag_list","workfeed/lib/modules/observe_field","html!./getting_started_group_task_lightbox","html!./getting_started_group_task_lightbox_toggle"],function(a){"use strict";var b=a("underscore"),c=a("jquery"),d=a("backbone"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("core/lib/backbone_with_subviews"),h=a("core/lib/yammer_uri"),i=a("models/user"),j=a("common-ui/lib/helper/name_validator"),k=a("core/lib/session"),l=a("core/lib/tr"),m=a("core/lib/yammer_request"),n=a("core/lib/urls"),o=a("core/lib/util/authenticity_token"),p=a("feeds/lib/ui/feeds/nue_mugshot_bar"),q=a("common-ui/lib/ui/shared/type_ahead_tag_list"),r=a("workfeed/lib/modules/observe_field"),s=a("html!./getting_started_group_task_lightbox"),t=a("html!./getting_started_group_task_lightbox_toggle");return e.extend({id:"group-task",mixins:[f,g],template:s,views:{TypeAhead:"_getTypeAhead"},events:{"click .link-skip":"_handleSkip","submit #new_group":"_handleOnSubmit","click .public-toggle":"_handlePublicToggle","click .private-toggle":"_handlePrivateToggle"},render:function(){return this.$groupSubmitButton=this.$(".button-submit"),this.$groupMemberContainer=this.$(".group-add-member-container"),this.$groupNameField=this.$(".group-name-field"),this.$groupNameStatus=this.$(".group-name-status"),this.$image=this.$(".groups-creation-image"),this._renderMugshotBar(),this._renderPrivacyToggle(),this._setGroupNameInstantValidation(),this._retinizeImage(),d.trigger("/ui/lightbox/resize"),this},getTemplateData:function(){return{image:h.cdn("assets/images/groups_task/general.png"),formUrl:n.groups(),csrfToken:o.get(),imageAltText:l.t("getting_started_group_task_image_alt_text"),groupNameLabel:l.t("getting_started_group_task_name_label"),groupNamePlaceholder:l.t("getting_started_group_task_name_placeholder"),groupMembersLabel:l.t("getting_started_group_task_members_label"),groupMembersPlaceholder:l.t("getting_started_group_task_members_placeholder"),dismissLink:l.t("dismiss"),createButton:l.t("getting_started_group_task_create_button")}},onComplete:function(){c("#yj_cboxLoadedContent").css({overflow:"visible"})},_handleSkip:function(){m.send({url:h.app("getting_started/dismiss_groups_task"),type:"POST",data:{},success:function(){}}),d.trigger("taskListComplete","join_a_group"),d.trigger("/ui/lightbox/close")},_handlePublicToggle:function(){this.$(".group-private-field").val("false"),this.$(".private-message").hide(),this.$(".public-message").show()},_handlePrivateToggle:function(){this.$(".group-private-field").val("true"),this.$(".public-message").hide(),this.$(".private-message").show()},_handleOnMemberListChange:function(){this._renderMugshotBar(this.typeAhead.val())},_renderMugshotBar:function(a){this.mugshotBar&&(this.mugshotBar.remove(),delete this.mugshotBar),this.mugshotBar=new p({id:"group-creation-mugshotbar",className:"yj-clearfix",slotClassName:"group-creation-mugshotbar-item",currentUserWidth:40,currentUserHeight:40,width:40,height:40,avatarClassName:"group-creation-mugshotbar-item"}),this.$(".group-mugshotbar-container").empty().append(this.mugshotBar.render().$el),b.each(a,function(a){a.mugshot_url=a.photo,a=i.save(a),this.mugshotBar.addMugshot(a)},this)},_getTypeAhead:function(){return this.typeAhead=new q({typeAheadWidth:300,emptyWatermark:this.$groupMemberContainer.data("watermark")||l.t("add_people_to_this_group_by_name_or_email")},this),this.listenTo(this.typeAhead,"addedEntry",this._handleOnMemberListChange.bind(this)),this.listenTo(this.typeAhead,"removedEntry",this._handleOnMemberListChange.bind(this)),this.typeAhead},_renderPrivacyToggle:function(){var a=t({publicMessage:l.t("this_groups_messages_are_visible_to_the_networkname_network_recommended",{networkName:k.getCurrentNetwork().name}),privateMessage:l.t("this_groups_messages_are_only_visible_to_group_members"),publicToggleText:l.t("make_public_recommended"),privacyToggleText:l.t("make_private")});this.$(".groups-creation-footer").prepend(a)},_retinizeImage:function(){var a=this.$image.attr("src"),b=a.substr(-4),c=a.substr(0,a.length-4);2==window.devicePixelRatio&&this.$image.attr("src",c+"@2x"+b)},_setGroupNameInstantValidation:function(){var a=this.$groupNameField,b=this.$groupSubmitButton,c=this.$groupNameStatus,d=this;return new r(a,{validateFunction:function(a){return j.validateGroupName(a)},update:c,spinner:!0,submit:b,validate:!0,onAjaxComplete:function(){d.$el.trigger("resize")}})},_validateGroupName:function(){var a=c("<span>").addClass("yj-invalid").text(l.t("name_is_required"));return 0===this.$groupNameField.val().length&&this.$groupNameStatus.empty().append(a),0===this.$groupNameStatus.find(".yj-invalid").length},_handleOnSubmit:function(){return this._validateGroupName()?(this.$groupSubmitButton.addClass("yj-btn-disabled"),"disabled"in this.$groupSubmitButton[0]&&(this.$groupSubmitButton[0].disabled=!0),b.each(this.typeAhead.val(),function(a){this.$groupMemberContainer.append('<input type="hidden" name="invites[ids][]" value="'+a.id+'"/>')},this),!0):!1}})}),define("css!feeds/lib/ui/feeds/nue_suggestion_search",[],function(){}),define("feeds/lib/ui/feeds/nue_suggestion_search",["require","backbone","core/lib/session","feeds/lib/ui/feeds/suggestion_search","core/lib/tr","core/lib/yammer_api","models/helpers/user","models/user","css!./nue_suggestion_search"],function(a){var b=a("backbone"),c=a("core/lib/session"),d=a("feeds/lib/ui/feeds/suggestion_search"),e=a("core/lib/tr"),f=a("core/lib/yammer_api"),g=a("models/helpers/user");return a("models/user"),a("css!./nue_suggestion_search"),d.extend({template:'<div class="yj-suggestion-search">    <label><span class="yj-acc-hidden">{{searchBoxLabel}}</span>      <input class="yj-sugg-search yj-search-input yj-inactive" type="text" value="{{searchBoxLabel}}" />    </label>    <span class="searching"><span class="yj-for"></span>    <span class="yj-spinner-loading"></span></span>  </div>',showSearchResults:function(a){var b={target_type:a.type,target_id:a.id,bfr_source:"getting_started_search"};this.toggleLoading(!0),this.selectedUser=a,f.subscribeToTarget(b).then(this.handleSubscribe.bind(this)),this.resetSearchBox(),this.$searchBox.blur()},toggleLoading:function(a){a?this.$searching.show():this.$searching.hide()},handleSubscribe:function(){var a=yam.model.User.findById(this.selectedUser.id);this.toggleLoading(!1),g.isFollowingUser(c.getCurrentUser(),this.selectedUser.id)||b.trigger("/ui/alert/show","notice",e.t("you_are_now_following_name",{name:a.full_name})),b.trigger("/nue/follow",{source:"search",user:a}),g.followUser(c.getCurrentUser(),this.selectedUser.id)},handleRecipientSelect:function(a){f.getUser({id:a.id}).then(this.handleGetUserCallback.bind(this))}})}),define("feeds/lib/ui/feeds/nue_subscription_list",["require","jquery","mustache","core/lib/session","feeds/lib/ui/feeds/subscription_list"],function(a){var b=a("jquery"),c=a("mustache"),d=a("core/lib/session"),e=a("feeds/lib/ui/feeds/subscription_list");return e.extend({defaults:{spinner:null,initialized:!1,page:1},template:'    <div class="{{className}}"{{^selected}} style="display:none;"{{/selected}}>      <div class="yj-nue-follow-list yj-clearfix {{type}}">        <h2>Suggested People</h2>      </div>    </div>',itemsTemplate:'{{#references}}<div class="{{className}} yj-nue-follow-user"><div class="yj-actions"></div>{{{info}}}</div>{{/references}}',descriptionTemplates:{people:"",groups:'<a href="{{web_url}}"><img class="yj-mug" src="{{mugshot_url}}" alt="{{full_name}}"></a>           <a class="yj-name" href="{{web_url}}">{{full_name}}</a>           <p class="yj-description">{{description}}</p>',topics:'<a class="yj-name" href="{{web_url}}">{{name}}</a>'},toggleLoading:function(a){var b=this.$element.find(".yj-nue-follow-list h2");a?b.hide():b.show(),e.prototype.toggleLoading.call(this,a)},clearList:function(){this.$element.find(".yj-nue-follow-user").remove(),this.$element.find(".yj-nue-no-user-message").remove()},isEmpty:function(){return 0===this.$element.find(".yj-nue-follow-user").filter(function(){return"none"!==b(this).css("display")}).length},appendItems:function(a){var d,e;d=b(c.render(this.itemsTemplate,a)),this.$element.find(".yj-nue-follow-list").append(d),e=this.addSubscribeButtons(a.references),this.renderChildren(e)},addSubscribeButtons:function(a){for(var b,c,e,f=[],g=0,h=a.length;h>g;g++)c=a[g],"user"==c.type&&c.id===d.getCurrentUser().id||(e={model:c,target:"."+this.getItemClassName(c)+" .yj-actions"},b=this.createSubscribeButton(e),f.push(b),this.addComponent(b));return f}})}),define("stache!common-ui/lib/ui/shared/nue_follow_button_follow",["mustache"],function(a){var b='<div class="yj-spinner">\n  <span class="yj-inline-icon"></span>\n</div>\n<div class="yj-nue-container">\n  <div class="yj-follow-mugshot-imagearea">\n    <img src="{{mugshot}}" width="{{width}}" height="{{height}}" alt="">\n    <div class="overlay">\n      <span class="yj-acc-hidden">{{follow_label}}</span>\n      <span class="plus" aria-hidden="true">+</span><span class="text" aria-hidden="true">{{follow_label}}</span>\n    </div>\n  </div>\n  <div class="yj-nue-follow-mugshot-name">{{full_name}}</div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/nue_follow_button",["require","jquery","underscore","mustache","common-ui/lib/ui/shared/follow_button","backbone","models/helpers/avatar","core/lib/session","core/lib/tr","html!./nue_follow_button_follow"],function(a){var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("common-ui/lib/ui/shared/follow_button"),f=a("backbone"),g=a("models/helpers/avatar"),h=a("core/lib/session"),i=a("core/lib/tr"),j=a("html!./nue_follow_button_follow");return e.extend({elementClassName:"yj-follow-mugshot",className:"unstyle-button-as-div",tagName:"button",defaults:c.extend({},e.prototype.defaults,{followTemplate:j}),avatarReplacementTemplate:'<div aria-hidden="true" class="yj-follow-mugshot-replacement       yj-avatar--replacement-color-{{avatar_color_class}}">{{first_letter}}{{last_letter}}</div>',initialize:function(){e.prototype.initialize.apply(this,arguments),this.width=this.options.width||100,this.height=this.options.height||100,this.model.mugshot_url_template=this.model.mugshot_url_template||""},getTemplateData:function(){var a=e.prototype.getTemplateData.call(this);return c.extend(a,{follow_label:i.t("follow"),full_name:this.model?this.model.full_name||"":"",height:this.height,mugshot:this.model.mugshot_url_template.replace("{width}",this.width).replace("{height}",this.height),width:this.width})},render:function(){var a=null,c=null,f=null;return e.prototype.render.call(this),c=this.$el.find(".yj-follow-mugshot-imagearea"),a=g.determineAvatarReplacementInfo(this.model,h),a.replaceAvatar===!0&&(f=b(d.render(this.avatarReplacementTemplate,{first_letter:a.firstLetter,last_letter:a.letterCount>1?a.lastLetter:"",avatar_color_class:a.avatarColorClass})),f.width(this.width).height(this.height).css("line-height",this.height+"px"),c.find("img").remove(),c.prepend(f)),c.width(this.width).height(this.height),this},hideContainer:function(){this.$el.parents(".yj-nue-follow-user").hide()},updateButtonState:function(){var a=this;this.hideContainer(),f.trigger("/nue/follow",{source:"followButton",user:a.model}),this.toggleLoading(!1)},handleClick:function(){this.clicked||(e.prototype.handleClick.apply(this,arguments),this.clicked=!0,this.toggleLoading(!0))}})}),define("feeds/lib/ui/feeds/nue_suggestion_list",["require","jquery","mustache","feeds/lib/ui/feeds/nue_subscription_list","common-ui/lib/ui/shared/nue_follow_button","core/lib/yammer_api","core/lib/yammer_uri","models/user"],function(a){var b=a("jquery"),c=a("mustache"),d=a("feeds/lib/ui/feeds/nue_subscription_list"),e=a("common-ui/lib/ui/shared/nue_follow_button"),f=a("core/lib/yammer_api"),g=a("core/lib/yammer_uri");return a("models/user"),d.extend({defaults:{id:"nue-suggestion-list",suggestionsLimit:6},emptyListTemplate:'<div class="yj-nue-no-user-message">Can\'t find who you\'re looking for? <a href="{{invite_url}}">Invite them to this network</a></div>',load:function(){this.initialized=!0,f.getUserSuggestions().then(this.addSubscriptions.bind(this)),this.toggleLoading(1)},renderEmptyListContent:function(){var a=b(c.render(this.emptyListTemplate,{invite_url:g.app("invitations/by_email")}));this.$element.find(".yj-nue-follow-list").html(a)},addMoreButton:function(){},createSubscribeButton:function(a){return a.following=!1,new e(a)},addSubscriptions:function(a){var b=[];this.payload||(b=this.prepViewData(a.slice(0,this.suggestionsLimit)),this.payload=a.slice(this.suggestionsLimit)),this.appendItems(b),this.toggleLoading(0),this.isEmpty()&&this.renderEmptyListContent(),this.$element.trigger({type:"suggestionsLoaded"})},showSpecialSuggestion:function(a){var b=this.prepItem(a);this.appendItems({references:[b],className:this.settings.elementClassName,selected:this.selected}),this.$element.trigger({type:"suggestionsLoaded"})},showOneMoreSuggestion:function(){if(this.payload&&this.payload.length>0){var a=this.prepViewData([this.payload[0]]);this.appendItems(a),this.$element.trigger({type:"suggestionsLoaded"}),this.payload=this.payload.slice(1)}},prepItem:function(a){return"people"==this.data.type&&(a=yam.model.User.save(a),a.mugshot_url=a.mugshot_url.replace("48x48","100x100")),a.info=c.render(this.descriptionTemplates[this.data.type],a),a.className=this.getItemClassName(a),a},prepViewData:function(a){for(var b=[],c=0,d=a.length;d>c&&c<this.suggestionsLimit;c++)b.push(a[c].suggested),b[c]=this.prepItem(b[c]);return{references:b,className:this.settings.elementClassName,selected:this.selected}}})}),define("feeds/lib/ui/feeds/nue_suggestions",["require","underscore","backbone","core/lib/session","feeds/lib/ui/feeds/suggestions","feeds/lib/ui/feeds/nue_mugshot_bar","feeds/lib/ui/feeds/nue_suggestion_search","feeds/lib/ui/feeds/nue_suggestion_list","core/lib/tr"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/session"),e=a("feeds/lib/ui/feeds/suggestions"),f=a("feeds/lib/ui/feeds/nue_mugshot_bar"),g=a("feeds/lib/ui/feeds/nue_suggestion_search"),h=a("feeds/lib/ui/feeds/nue_suggestion_list"),i=a("core/lib/tr");return e.extend({subscribeToData:function(){c.on("/nue/follow",function(a){var b=this.getChild("nue-mugshotbar"),e=this.getChild("suggestions-people"),f=a.user,g=null;b.hasUser(f)?c.trigger("/ui/alert/show","error",i.t("you_are_already_following_name",{name:f.full_name})):f.id==d.getCurrentUser().id?c.trigger("/ui/alert/show","error",i.t("you_cant_follow_yourself")):(d.getCurrentUser().stats.following||c.trigger("taskListComplete","follow_a_user"),b.addMugshot(a.user),"search"===a.source?(g=this.findSuggestionButton(f.id),g&&(g.hideContainer(),e.showOneMoreSuggestion())):e.showOneMoreSuggestion()),e.isEmpty()&&e.renderEmptyListContent()},this)},findSuggestionButton:function(a){var c=this.getChild("suggestions-people"),d=null;return b.each(c.children,function(b){b.model&&"user"===b.model.type&&b.model.id===a&&(d=b)}),d},unsubscribeData:function(){c.off("/nue/follow",null,this)},afterRender:function(){e.prototype.afterRender.call(this),this.$search=this.getComponent("subscriptionList")},defaults:{id:"suggestions",data:[{type:"people"}],settings:{elementClassName:"yj-suggestions",selected:!1},children:[{type:f,target:".yj-nue-followees"},{type:g,target:".yj-sub-hd",results:"subscriptionList"}]},template:'<div class="{{className}}"><h1 role="heading" aria-level="2">Follow at least 5 coworkers to see their updates more frequently in your Feed.</h1>      <div class="yj-nue-followees"></div><div class="yj-sub-hd"></div></div>',addTabContent:function(){for(var a,b=this.data,c=0,d=b.length;d>c;c++)a={type:this.data[c],id:this.settings.elementClassName.replace("yj-","")+"-"+b[c].type,settings:{elementClassName:"yj-nue-suggestion-list"},data:this.data[c],selected:0===c,postLoad:!this.settings.selected},this.addComponent(new h(a,this))}})}),define("stache!workfeed/lib/app/sidebar/getting_started_follow_task_lightbox",["mustache"],function(a){var b='<Suggestions />\n<div class="follow-task--controls">\n  <div class="follow-controls">\n    <a href="javascript://" role="button" class="skip-link">{{dismiss}}</a>\n    <DoneButton />\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/getting_started_follow_task_lightbox",["require","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/yammer_uri","core/lib/yammer_request","core/lib/tr","common-ui/lib/ui/shared/button","feeds/lib/ui/feeds/nue_suggestions","html!./getting_started_follow_task_lightbox"],function(a){"use strict";var b=a("backbone"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/yammer_uri"),g=a("core/lib/yammer_request"),h=a("core/lib/tr"),i=a("common-ui/lib/ui/shared/button"),j=a("feeds/lib/ui/feeds/nue_suggestions"),k=a("html!./getting_started_follow_task_lightbox");return c.extend({id:"follow-task",mixins:[d,e],views:{Suggestions:"_getSuggestions",DoneButton:"_getDoneButton"},template:k,events:{"click .skip-link":"_handleDismiss","click #follow-done-button":"_handleDone"},getTemplateData:function(){return{dismiss:h.t("dismiss")}},onComplete:function(){},_getSuggestions:function(){return new j({settings:{elementClassName:"yj-suggestions",selected:!0}})},_getDoneButton:function(){var a=this.doneButton=new i({id:"follow-done-button",labelText:h.t("done"),renderDisabled:!0});return b.on("/nue/follow",function(){a.enabled||a.enable()}),a},_handleDismiss:function(){g.send({url:f.app("getting_started/dismiss_follow_task"),type:"POST",data:{},success:function(){}}),b.trigger("taskListComplete","follow_a_user"),b.trigger("/ui/lightbox/close")},_handleDone:function(){this.doneButton.enabled&&b.trigger("/ui/lightbox/close")}})}),define("stache!workfeed/lib/app/sidebar/getting_started_desktop_task_lightbox",["mustache"],function(a){var b='<p class="desktop-task-text">\n  <a class="yj-btn"><span class="windows-notifier-icon"></span> {{linkText}}</a>\n</p>\n<p>{{promoText}}</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/getting_started_desktop_task_lightbox",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/yammer_uri","core/lib/yammer_request","core/lib/tr","common-ui/lib/helper/environment","core/lib/report","html!./getting_started_desktop_task_lightbox"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("backbone"),e=a("core/lib/yammer_uri"),f=a("core/lib/yammer_request"),g=a("core/lib/tr"),h=a("common-ui/lib/helper/environment"),i=a("core/lib/report"),j=a("html!./getting_started_desktop_task_lightbox");return b.extend({id:"desktop-task",template:j,mixins:[c],events:{"mouseenter .yj-btn":"_addMouseoverClass","mouseleave .yj-btn":"_removeMouseoverClass"},render:function(){return this._setDesktopLinkHref(),this},getTemplateData:function(){return{linkText:g.t("getting_started_desktop_task_link"),promoText:g.t("getting_started_desktop_task_promo")}},onComplete:function(){f.send({url:e.app("getting_started/dismiss_desktop_task"),type:"POST",data:{},success:function(){}}),i.event("nue_tasks_download_desktop"),d.trigger("taskListComplete","download_desktop")},_setDesktopLinkHref:function(){var a=this.$(".yj-btn"),b=h.getUserAgent(),c="https://assets.yammer.com/application_support/windows_notifier/Yammer.Notifier.application",d="https://assets.yammer.com/application_support/windows_notifier/setup.exe";b.match(/NET[4-9]/)||h.isIE()&&h.isIE().version>9?a.attr("href",c):a.attr("href",d)},_addMouseoverClass:function(){this.$(".yj-btn").addClass("yj-mouseover")},_removeMouseoverClass:function(){this.$(".yj-btn").removeClass("yj-mouseover")}})}),define("stache!workfeed/lib/app/sidebar/getting_started_mobile_task_lightbox",["mustache"],function(a){var b='<ul class="app-list">\n  {{#platforms}}\n  <li class="app-list-item">\n    <a href="{{url}}" class="get-yammer-mobile-link" data-qaid="{{qaid}}">\n      <img src="{{image}}" alt="">\n      <br>{{name}}\n      <img src="{{arrowImage}}" class="lightbox-toggle-link-arrow" alt="">\n    </a>\n  </li>\n  {{/platforms}}\n  <li class="clearing" aria-hidden="true"></li>\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/getting_started_mobile_task_lightbox",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/yammer_uri","core/lib/yammer_request","core/lib/report","html!./getting_started_mobile_task_lightbox"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("backbone"),e=a("core/lib/yammer_uri"),f=a("core/lib/yammer_request"),g=a("core/lib/report"),h=a("html!./getting_started_mobile_task_lightbox");return b.extend({id:"phone-task",mixins:[c],template:h,getTemplateData:function(){var a=[{url:"/company/ios/",image:e.cdn("assets/images/clients/iphone_thumb.png"),name:"iPhone/iPad",qaid:"iphone_ipad_link"},{url:"/company/android/",image:e.cdn("assets/images/clients/android_thumb.png"),name:"Android",qaid:"android_link"},{url:"/company/windowsphone/",image:e.cdn("assets/images/clients/wp_thumb.png"),name:"Windows Phone",qaid:"windows_phone_link"}];return{arrowImage:e.cdn("assets/images/blue_right_arrow.png"),platforms:a}},onComplete:function(){f.send({url:e.app("getting_started/dismiss_phone_task"),type:"POST",data:{},success:function(){}}),g.event("nue_tasks_download_mobile"),d.trigger("taskListComplete","install_mobile")}})}),define("css!workfeed/lib/app/sidebar/getting_started",[],function(){}),define("stache!workfeed/lib/app/sidebar/getting_started",["mustache"],function(a){var b='<h2 class="yj-user-getting-started--header">{{gettingStarted}}</h2>\n\n<div class="yj-user-getting-started--progress-meter" data-completion="{{completion}}" data-tasks="{{totalTasks}}">\n  <div class="yj-user-getting-started--pm-shell">\n    <div class="yj-user-getting-started--pm-progress" style="width:{{completion}}%;"></div>\n  </div>\n  <span class="yj-user-getting-started--pm-label">{{completion}}%</span>\n  <div style="clear:both;"></div>\n</div>\n\n<ul class="yj-user-getting-started--getting-started-list">\n{{#tasks}}\n  <li class="yj-user-getting-started--task" data-name="{{name}}">\n  {{#completed}}\n    <span class="yj-inline-icon check-green-icon">\n    </span>\n    <span class="strike">\n      <a href="javascript://" class="yj-user-getting-started--link {{#lightbox}}workfirst-nue-lightbox-override cboxElement{{/lightbox}} task-action"\n         id="{{name}}" title="{{title}}">{{text}}</a>\n    </span>\n  {{/completed}}\n  {{^completed}}\n    <a href="javascript://" class="yj-user-getting-started--link {{#lightbox}}workfirst-nue-lightbox-override cboxElement{{/lightbox}} task-action"\n       id="{{name}}" title="{{title}}">{{text}}</a>\n  {{/completed}}\n  </li>\n{{/tasks}}\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/getting_started",["require","jquery","underscore","core/lib/tr","core/lib/urls","core/lib/session","backbone","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/report","common-ui/lib/ui/general/lightbox_manager","workfeed/lib/app/sidebar/getting_started_post_task_lightbox","workfeed/lib/app/sidebar/getting_started_group_task_lightbox","workfeed/lib/app/sidebar/getting_started_follow_task_lightbox","workfeed/lib/app/sidebar/getting_started_desktop_task_lightbox","workfeed/lib/app/sidebar/getting_started_mobile_task_lightbox","css!./getting_started","html!./getting_started"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/tr"),e=a("core/lib/urls"),f=a("core/lib/session"),g=a("backbone"),h=a("core/lib/backbone_base_view"),i=a("core/lib/backbone_with_auto_render"),j=a("core/lib/report"),k=a("common-ui/lib/ui/general/lightbox_manager"),l=a("workfeed/lib/app/sidebar/getting_started_post_task_lightbox"),m=a("workfeed/lib/app/sidebar/getting_started_group_task_lightbox"),n=a("workfeed/lib/app/sidebar/getting_started_follow_task_lightbox"),o=a("workfeed/lib/app/sidebar/getting_started_desktop_task_lightbox"),p=a("workfeed/lib/app/sidebar/getting_started_mobile_task_lightbox");a("css!./getting_started");var q={make_a_post:"make_a_post",follow_a_user:"follow_a_user",join_a_group:"join_a_group",download_desktop:"download_desktop",install_mobile:"install_mobile"},r=c.object([[q.make_a_post,"write_your_first_post"],[q.follow_a_user,"follow_your_coworkers"],[q.join_a_group,"start_a_group"],[q.download_desktop,"get_yammer_for_desktop"],[q.install_mobile,"get_the_yammer_mobile_app"]]),s=c.object([[q.make_a_post,"share_a_project_update"],[q.follow_a_user,"whose_messages_are_you_interested_in"],[q.join_a_group,"start_a_group"],[q.download_desktop,"get_yammer_for_desktop"],[q.install_mobile,"get_the_yammer_mobile_app"]]),t=c.object([[q.make_a_post,l],[q.join_a_group,m],[q.follow_a_user,n],[q.download_desktop,o],[q.install_mobile,p]]),u=h.extend({
attributes:{"data-qaid":"user-getting-started"},className:"yj-user-getting-started",mixins:[i],template:a("html!./getting_started"),events:{"click .yj-user-getting-started--task":"_handleClick"},initialize:function(){this.listenTo(g,"taskListComplete",this._completeTask.bind(this))},getTemplateData:function(){var a=f.getCurrentUser().task_list,b=c.map(a.tasks,function(a){return c.extend({},a,{text:d.t(r[a.name]),title:d.t(s[a.name]),url:e.gettingStartedTask(a.action)})},this);return{hasTasks:a.has_remaining_tasks,tasks:b,totalTasks:a.total_tasks,completion:a.completion,gettingStarted:d.t("getting_started_title"),completed:d.t("completed_label")}},_handleClick:function(a){var c=b(a.currentTarget).data("name");this._trackClick(c),this._openTaskLightbox(c)},_openTaskLightbox:function(a){var b=this._getLightboxClass(a),c=new b;k.openComponent(c,"",null,{title:d.t(s[a]),width:null,onComplete:c.onComplete.bind(c)})},_getLightboxClass:function(a){return t[a]},_trackClick:function(a){j.event("rr_home_getting_started",{event_action:a})},_completeTask:function(a){var b=this.$('[data-name="'+a+'"]'),c=this.$(".yj-user-getting-started--progress-meter");if(b.length){var d=parseInt(c.data("completion"),10),e=parseInt(c.data("tasks"),10),f=Math.floor(100/e);d+=f,1===this.$(".task").length&&(d=100),c.data("completion",d),c.find(".yj-user-getting-started--pm-label").text(d+"%"),c.find(".yj-user-getting-started--pm-progress").animate({width:d+"%"},"slow"),d>=100?this.$el.fadeOut("slow",this.remove.bind(this)):b.fadeOut("slow",b.remove.bind(b))}}});return u}),define("common-ui/lib/ui/shared/group_suggestions",["require","underscore","common-ui/lib/ui/shared/suggestions","core/lib/yammer_api","components/avatar/index","core/lib/session","core/lib/tr","core/lib/report"],function(a){var b=a("underscore"),c=a("common-ui/lib/ui/shared/suggestions"),d=a("core/lib/yammer_api"),e=a("components/avatar/index"),f=a("core/lib/session"),g=a("core/lib/tr"),h=a("core/lib/report"),i=c.extend({attributes:{"data-qaid":"group-suggestions"},type:"group",modelType:"yam.model.GroupMembership",followEndpoint:"acceptGroupSuggestion",removeEndpoint:"declineGroupSuggestion",initialSuggestionSlots:["group","group"],fallbacks:{group:null},optimistic:!1,title:g.t("suggested_groups"),menus:[{reason:"remove_suggestion",text:g.t("remove_suggestion")}],_buttonText:function(){return g.t("join")},_successText:function(a){return g.t("you_have_joined_the_name_group",{name:a})},_pendingText:function(a){return g.t("you_have_requested_to_join_the_name_group",{name:a})},_infoToModel:function(a){return{user_id:f.getCurrentUser().id,group_id:+a.id,group_name:a.name}},_modelToInfo:function(a){return{id:a.get("group_id"),name:a.get("group_name"),type:this.type}},_followCallbacks:function(a,b){var c,d=this;return{success:function(e){null!=e.payload&&null!=e.payload.group&&(b.id=e.payload.group.id,a.attr("data-sug-id",b.id)),null!=e.status&&"pending"===e.status.membership?(d._emptySuggestionSlot(b),d._alertFollowPending(b)):(c=d._createSubscription(b),d._alertFollowSuccess(b)),h.event("rr_home_suggested_groups",{event_action:"join"})},error:function(a){d._onRequestError(a),d._destroySubscription(c)}}},_followParams:function(a){return a.id?{id:a.id,pool:a.pool,strategy:"user",section:"home_page",source:"suggested_groups_sidebar"}:{id:"0",name:a.full_name,pool:a.pool,strategy:a.strategy}},_removeCallbacks:function(a,b){var c=this;return{success:function(){c._emptySuggestionSlot(b),c._replaceSuggestionElement(a),h.event("rr_home_suggested_groups",{event_action:"remove"})},error:function(a){c._onRequestError(a)}}},_removeParams:function(a,b){return a.id?{id:a.id,pool:a.pool,reason:b,strategy:"user",section:"home_page",source:"suggested_groups_sidebar"}:{id:"0",name:a.full_name,pool:a.pool,strategy:a.strategy}},_logSuggestions:function(a){var c=this._onRequestNoop.bind(this),e=this._onRequestError.bind(this);d.logGroupSuggestions({events:b.map(a,this._eventRepresentation)}).then(c,e)},_eventRepresentation:function(a){var b=a.suggested;return{group_suggestion_offered:{type:"group_suggestion",group_id:b.id||"",group_permalink:b.name,source:b.source,section:b.section,pool:a.pool,strategy:a.strategy}}},_alertFollowSuccess:function(a){this._alertText(this._successText(a.full_name))},_alertFollowPending:function(a){this._alertText(this._pendingText(a.full_name))},_createAvatar:function(a){return new e({model:a,withHovercard:!1,badge:null,hideFromAccessibility:!0})}});return i}),define("css!workfeed/lib/app/sidebar/related_networks",[],function(){}),define("stache!workfeed/lib/app/sidebar/related_networks",["mustache"],function(a){var b='<h2 class="yj-related-networks--header">{{relatedNetworksTitle}}</h2>\n<ul class="yj-related-networks--list">\n  {{#relatedNetworks}}\n    <li class="yj-related-networks--list-item bottom-margin {{^isParent}}related-network-li{{/isParent}}">\n      <a href="/{{permalink}}/">{{permalinkText}}</a> {{#isParent}}<strong>({{parent}})</strong>{{/isParent}}\n    </li>\n  {{/relatedNetworks}}\n  <li style="display:none" class="yj-related-networks--show-more"><a href="javascript://" role="button">{{more}} &raquo;</a></li>\n  <li style="display:none" class="yj-related-networks--show-less"><a href="javascript://" role="button">&laquo; {{less}}</a></li>\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/related_networks",["require","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/string_helper","css!./related_networks","html!./related_networks"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/string_helper"),f=9;a("css!./related_networks");var g=c.extend({className:"yj-related-networks",mixins:[d],template:a("html!./related_networks"),events:{"click .yj-related-networks--show-more":"_showMore","click .yj-related-networks--show-less":"_showLess"},initialize:function(){this.listenTo(this.collection,"change reset add remove",this.render)},render:function(){this.$showMore=this.$(".yj-related-networks--show-more"),this.$showLess=this.$(".yj-related-networks--show-less"),this.$relatedNetworks=this.$(".related-network-li"),this.$toggleable=this._toggleableNetworks(),this.$toggleable.length&&this._showLess()},_toggleableNetworks:function(){var a=[];return this.$relatedNetworks.length>f&&(a=this.$relatedNetworks.slice(0,f)),$(a)},getTemplateData:function(){return{relatedNetworksTitle:b.t("related_networks"),more:b.t("more"),less:b.t("less"),parent:b.t("parent_network_indicator"),relatedNetworks:this._relatedNetworksData()}},_relatedNetworksData:function(){return this.collection.map(function(a){var b=a.get("permalink");return{permalink:b,permalinkText:e.capitalize(b),isParent:a.get("is_primary")}})},_showMore:function(){this.$toggleable.show(),this.$showMore.hide(),this.$showLess.show()},_showLess:function(){this.$toggleable.hide(),this.$showLess.hide(),this.$showMore.show()}});return g}),define("css!workfeed/lib/app/sidebar/sidebar_apps_store",[],function(){}),define("stache!workfeed/lib/app/sidebar/sidebar_apps_store",["mustache"],function(a){var b='<a href="{{url}}" class="yj-apps-store--header-link" title="{{appDirectoryTitle}}"><h2 class="yj-apps-store--header">{{appDirectoryTitle}}</h2></a>\n<span class="yj-apps-store--description-block">\n  <span>{{appDescription}} </span><a href="{{url}}" class="yj-apps-store--description" title="{{appDirectoryTitle}}">{{appDirectoryTitle}}</a><span> {{thisWeek}}.</span>\n</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/sidebar_apps_store",["require","underscore","core/lib/tr","core/lib/urls","core/lib/session","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/report","css!./sidebar_apps_store","html!./sidebar_apps_store"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/urls"),e=a("core/lib/session"),f=a("core/lib/backbone_base_view"),g=a("core/lib/backbone_with_auto_render"),h=a("core/lib/report");a("css!./sidebar_apps_store");var i=f.extend({className:"yj-apps-store",mixins:[g],template:a("html!./sidebar_apps_store"),events:{"click .yj-see-all-link":"_trackClick"},getTemplateData:function(){var a=e.getCurrentNetwork(),b=a.new_featured_apps_count;return b=b>0?b:0,{hasNewApps:b>0,appDirectoryTitle:c.t("app_directory_title"),description:c.t("count_new_featured_apps_added_this_week",{count:b}),appDescription:c.t("count_new_featured_apps_this_week",{count:b}),thisWeek:c.t("this_week"),linkText:c.t("see_all"),url:d.apps({from:"sidebar"})}},_trackClick:function(a){h.event("rr_home_sidebar_apps_store"),a.preventDefault(),b.delay(b.bind(function(){window.open(a.currentTarget.href,"_self")},this),1)}});return i}),define("css!common-ui/lib/ui/shared/sidebar_inviter",[],function(){}),define("stache!common-ui/lib/ui/shared/sidebar_inviter",["mustache"],function(a){var b='<div class="ir-invite-module yj-sidebar-inviter--content">\n  <label class="yj-acc-hidden" for="addresses">{{watermark}}</label>\n  <div class="yj-sidebar-inviter--invite-addresses-container sidebar">\n    <input type="text" id="addresses" data-qaid="invite_addresses" class="yj-sidebar-inviter--invite-addresses" title="{{watermark}}">\n  </div>\n  <div class="yj-sidebar-inviter--invite-form-submit-container">\n    <button type="button" data-qaid="invite_button" class="yj-sidebar-inviter--form-submit yj-btn yj-btn-alt">\n      <span>{{addButton}}</span>\n    </button>\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/sidebar_inviter",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/session","core/lib/tr","core/lib/yammer_api","common-ui/lib/ui/shared/type_ahead","core/lib/util/email_extractor","core/lib/report","core/lib/util/authenticity_token","css!./sidebar_inviter","jquery-watermark","html!./sidebar_inviter"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("backbone"),f=a("core/lib/session"),g=a("core/lib/tr"),h=a("core/lib/yammer_api"),i=a("common-ui/lib/ui/shared/type_ahead"),j=a("core/lib/util/email_extractor"),k=a("core/lib/report"),l=a("core/lib/util/authenticity_token");a("css!./sidebar_inviter"),a("jquery-watermark");var m=c.extend({mixins:[d],id:"invite-form",className:"yj-sidebar-inviter ir-invite-module",template:a("html!./sidebar_inviter"),events:{"click .yj-sidebar-inviter--form-submit":"_invite"},initialize:function(){var a=f.getCurrentNetwork();this._networkIsCommunity=a.community,this._networkPermalink=a.permalink,this._watermark=g.t("add_coworkers"),this._emailExtractor=new j,b.bindAll(this,"_onSelect","_inviteSuccess","_inviteFailure")},render:function(){return this.$inviteAddresses=this.$(".yj-sidebar-inviter--invite-addresses"),this.$inviteAddresses.watermark(this._watermark),this.$submit=this.$(".yj-sidebar-inviter--form-submit"),this._networkIsCommunity||this._registerTypeAhead(),this},getTemplateData:function(){return{watermark:this._watermark,addButton:g.t("add")}},_registerTypeAhead:function(){i.registerField(this.$inviteAddresses,{triggerStrings:[],completableModels:[i.MODEL_DOMAIN],styles:"minimal",hintMessage:g.t("enter_email_address"),allowNoMatch:!0,onSelect:this._onSelect})},_onSelect:function(a){this.$inviteAddresses.val(a.name),this._invite()},_invite:function(){this._disableSubmit();var a=this._getEmail();return a?void h.inviteToNetwork({emails:[a],invite_section:"home_page",invite_source:"invite_users",authenticity_token:l.get()}).then(this._inviteSuccess,this._inviteFailure):void this._validationFailure()},_getEmail:function(){var a=this._emailExtractor.extractEmails(this.$inviteAddresses.val()).accepted;return a.length?a[0]:null},_disableSubmit:function(){this.$submit.addClass("yj-btn-disabled")},_enableSubmit:function(){this.$submit.removeClass("yj-btn-disabled")},_validationFailure:function(){this._showAlertAndReset("error",g.t("please_enter_a_valid_email_address"))},_inviteSuccess:function(){this._showAlertAndReset("notice",g.t("your_invitation_has_been_sent")),k.event("rr_home_sidebar_inviter")},_inviteFailure:function(){this._showAlertAndReset("error",g.t("none_of_your_invitations_were_sent_please_verify_the_email"))},_showAlertAndReset:function(a,b){e.trigger("/ui/alert/show",a,b),this._resetInitialState()},_resetInitialState:function(){this.$inviteAddresses.val("").blur(),this._enableSubmit()}});return m}),define("css!components/sidebar_invites/src/sidebar_invites",[],function(){}),define("stache!components/sidebar_invites/src/sidebar_invites",["mustache"],function(a){var b='<div class="yj-invite-coworkers--header">\n  <h2 role="heading" class="yj-invite-coworkers--header-title" aria-level="2">\n    <a href="{{invitationsUrl}}" class="yj-invite-coworkers--header-link">\n      {{#external}}\n        {{inviteYourColleagues}}\n      {{/external}}\n      {{^external}}\n        {{inviteCoworkersMsg}}\n      {{/external}}\n    </a>\n  </h2>\n</div>\n<div class="yj-invite-coworkers--image-svg">{{{svgIconInvite}}}</div>\n<div class="yj-invite-coworkers--text">\n  {{inviteMoreMsg}}\n  <a data-qaid="invite-user-link" href="{{invitationsUrl}}" class="yj-invite-coworkers--text-link yj-btn yj-btn-alt yj-btn-small"><div>{{inviteThemNow}}</div></a>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/sidebar_invites/src/sidebar_invites",["require","core/lib/tr","core/lib/report","core/lib/yammer_uri","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/session","common-ui/lib/helper/svg_icon","css!./sidebar_invites","html!./sidebar_invites"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/report"),d=a("core/lib/yammer_uri"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_base_view"),g=a("core/lib/session"),h=a("common-ui/lib/helper/svg_icon");return a("css!./sidebar_invites"),f.extend({className:"yj-invite-coworkers",mixins:[e],template:a("html!./sidebar_invites"),events:{"click .yj-sidebar-invites--invite-link":"_handleClick"},getTemplateData:function(){var a=g.getCurrentNetwork()?g.getCurrentNetwork().community:!1,c={width:52,height:52};return{svgIconInvite:h("invite-people",c),external:a,invitationsUrl:d.app("/#/invitations/by_email",{from:"nav"}),inviteMsg:b.t("invite"),inviteThemNow:b.t("invite_them_now"),inviteCoworkersMsg:b.t("invite_your_coworkers"),inviteYourColleagues:b.t("invite_your_colleagues"),inviteMoreMsg:b.t("invite_more_people")}},_handleClick:function(){c.event("rr_home_invite")}})}),define("components/sidebar_invites/index",["require","./src/sidebar_invites"],function(a){"use strict";var b=a("./src/sidebar_invites");return b}),define("css!workfeed/lib/app/sidebar/usage_policy",[],function(){}),define("stache!workfeed/lib/app/sidebar/usage_policy",["mustache"],function(a){var b='<h2 class="yj-usage-policy--header">\n  <a href="{{usagePolicyUrl}}" class="yj-usage-policy--header-link">{{usagePolicyTitle}}</a>\n</h2>\n<p>\n  <a class="yj-usage-policy--banner" href="{{usagePolicyUrl}}">{{linkText}}</a>\n</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/usage_policy",["require","underscore","core/lib/tr","core/lib/urls","core/lib/session","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/report","css!./usage_policy","html!./usage_policy"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/urls"),e=a("core/lib/session"),f=a("core/lib/backbone_base_view"),g=a("core/lib/backbone_with_auto_render"),h=a("core/lib/report");a("css!./usage_policy");var i=f.extend({className:"yj-usage-policy",mixins:[g],template:a("html!./usage_policy"),events:{"click .yj-usage-policy-banner":"_trackClick"},getTemplateData:function(){var a=e.getCurrentNetwork(),b=a.usage_policy.policy.banner_message,f=b||c.t("view_the_network_usage_policy",{networkName:a.getPlainBody()});return{linkText:f,usagePolicyTitle:c.t("network_usage_policy_title"),usagePolicyUrl:d.usagePolicy()}},_trackClick:function(a){h.event("rr_home_usage_policy"),a.preventDefault(),b.delay(b.bind(function(){window.open(a.currentTarget.href,"_self")},this),1)}});return i}),define("css!workfeed/lib/app/sidebar/suggested_list",[],function(){}),define("stache!workfeed/lib/app/sidebar/home_sidebar",["mustache"],function(a){var b='<div id="requests-container" class="yj-requests-container yamjs-content">\n  {{#showNetworkInvitations}}\n    <NetworkInvitationsView key="network_invitations" />\n  {{/showNetworkInvitations}}\n</div>\n\n{{#showGettingStarted}}\n  <GettingStartedView key="getting_started" />\n{{/showGettingStarted}}\n\n{{#showNewSidebarInviter}}\n  <SidebarInvitesView key="sidebar_invites" />\n{{/showNewSidebarInviter}}\n\n{{#showUsagePolicy}}\n  <UsagePolicyView key="usage_policy" />\n{{/showUsagePolicy}}\n\n<ActivityTickerView key="activity_ticker"/>\n\n{{#showSidebarApps}}\n  <SidebarAppsStoreView key="apps_store" />\n{{/showSidebarApps}}\n\n<div class="yj-rightrail-suggested-users" data-qaid="user-suggestions">\n  <UserSuggestionsView key="user_suggestions"/>\n</div>\n<div class="yj-rightrail-suggested-groups">\n  <GroupSuggestionsView key="group_suggestions"/>\n</div>\n\n{{#showRelatedContents}}\n  <CompanyResourcesView key="related_contents" />\n{{/showRelatedContents}}\n\n{{#showRelatedNetworks}}\n  <RelatedNetworksView key="related_networks" />\n{{/showRelatedNetworks}}\n\n{{#showFooter}}\n  <SidebarFooterView key="footer" />\n{{/showFooter}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/home_sidebar",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_subviews","core/lib/backbone_with_auto_render","feeds/lib/ui/activities/activity_ticker","components/browse_groups/index","feeds/lib/ui/feeds/configure_feed_link","./getting_started","./group_related_contents","common-ui/lib/ui/shared/group_suggestions","common-ui/lib/ui/general/lightbox_manager","./network_invitations","./related_networks","./sidebar_apps_store","common-ui/lib/ui/shared/sidebar_inviter","components/sidebar_invites/index","./usage_policy","common-ui/lib/ui/shared/user_suggestions","core/lib/tr","core/lib/report","core/lib/session","models/helpers/group","css!./suggested_list","html!./home_sidebar"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/backbone_with_auto_render"),f=a("feeds/lib/ui/activities/activity_ticker"),g=a("components/browse_groups/index"),h=a("feeds/lib/ui/feeds/configure_feed_link"),i=a("./getting_started"),j=a("./group_related_contents"),k=a("common-ui/lib/ui/shared/group_suggestions"),l=a("common-ui/lib/ui/general/lightbox_manager"),m=a("./network_invitations"),n=a("./related_networks"),o=a("./sidebar_apps_store"),p=a("common-ui/lib/ui/shared/sidebar_inviter"),q=a("components/sidebar_invites/index"),r=a("./usage_policy"),s=a("common-ui/lib/ui/shared/user_suggestions"),t=a("core/lib/tr"),u=a("core/lib/report"),v=a("core/lib/session"),w=a("models/helpers/group");a("css!./suggested_list");var x=c.extend({mixins:[e,d],template:a("html!./home_sidebar"),className:"yj-sidebar yj-ir-sidebar",id:"sidebar",attributes:{role:"complementary"},views:{NetworkInvitationsView:"_getNetworkInvitations",GettingStartedView:"_getGettingStarted",UsagePolicyView:"_getUsagePolicy",ActivityTickerView:"_getActivityTicker",UserSuggestionsView:"_getUserSuggestions",GroupSuggestionsView:"_getGroupSuggestions",SidebarAppsStoreView:"_getSidebarAppsStore",SidebarInviterView:"_getSidebarInviter",CompanyResourcesView:"_getGroupRelatedContents",RelatedNetworksView:"_getRelatedNetworks",SidebarInvitesView:"_getSidebarInvites"},events:{"click .yj-rightrail-suggested-users .yj-suggested-list--header-link":"_suggestUsers","click .yj-rightrail-suggested-groups .yj-suggested-list--header-link":"_suggestGroups"},getTemplateData:function(){return this._modulePermissions()},_modulePermissions:function(){var a=this._fullModulePermissions(),c={showNetworkInvitations:this._hasNetworkInvitations(),showGettingStarted:this._hasGettingStartedTasks(),showSidebarInviter:this._canSendInvites(),showUsagePolicy:this._hasUsagePolicy(),showSidebarApps:this._hasFeaturedApps(),showRelatedContents:a||this._hasRelatedContents(),showRelatedNetworks:this._hasRelatedNetworks(),showFooter:!0,showNewSidebarInviter:this._canSendInvites()};return b.extend(c,{showNetworkInvitations:!1,showFooter:!1}),c},_fullModulePermissions:function(){return w.isEditableByCurrentUser(this.model)},_canSendInvites:function(){return v.getCurrentUser().get("can_send_invites")},_hasUsagePolicy:function(){var a=v.getCurrentNetwork().get("has_usage_policy_banner");return"undefined"==typeof a&&(a=v.getCurrentNetwork().usage_policy.policy,a="undefined"!=typeof a),a},_hasFeaturedApps:function(){return v.getCurrentNetwork().get("new_featured_apps_count")},_hasGettingStartedTasks:function(){return v.getCurrentUser().get("task_list").has_remaining_tasks},_hasNetworkInvitations:function(){var a=v.getCurrentUser().get("pending_network_invitations_count");return a&&a>0},_hasRelatedContents:function(){var a=this.model.get("related_contents");return a&&a.length>0},_hasRelatedGroups:function(){var a=this.model.get("related_groups");return a&&a.length>0},_hasRelatedNetworks:function(){var a=v.getCurrentNetwork().get("community"),b=this.model.get("related_networks");return a&&b.length>0},_getNetworkInvitations:function(){return new m},_getGettingStarted:function(){return new i},_getUsagePolicy:function(){return new r},_getActivityTicker:function(){var a=new f;return a.$el.hide(),a},_getUserSuggestions:function(){yam.suggestions.activeUsers.refill({delay:5e3}),yam.suggestions.pendingUsers.refill({delay:5e3});var a=new s({queues:{active:yam.suggestions.activeUsers,pending:yam.suggestions.pendingUsers}},this);return a.requestSuggestions(),this._configureFeedLink=new h({selectedTab:"suggestions"}),a},_getGroupSuggestions:function(){yam.suggestions.groups.refill({delay:5e3});var a=new k({queues:{group:yam.suggestions.groups}});return a.requestSuggestions(),a},_suggestUsers:function(a){a.preventDefault(),a.stopPropagation(),this._configureFeedLink.displayFeedLightbox()},_suggestGroups:function(a){a.preventDefault(),a.stopPropagation(),l.openComponent(new g,"yj-suggested-groups-lightbox-container",null,{title:t.t("suggested_groups"),overlayClose:!0,scrolling:!1,width:735,onClosed:function(){u.event("group_suggestions_lightbox_close")}})},_getSidebarAppsStore:function(){return new o},_getSidebarInviter:function(){return new p},_getGroupRelatedContents:function(){var a=v.getCurrentNetwork(),b={id:a.get("id"),type:a.get("type")};return new j({source:b,model:this.model,collection:this.model.get("related_contents"),editable:this._fullModulePermissions()})},_getRelatedNetworks:function(){return new n({collection:this.model.get("related_networks")})},_getSidebarInvites:function(){return new q},remove:function(){return c.prototype.remove.call(this)}});return x}),define("stache!workfeed/lib/app/views/threads/index",["mustache"],function(a){var b='<div class="yk-row">\n  <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n    <ThreadList key="thread-list"/>\n  </div>\n  <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6">\n    {{#hasGroup}}<HomeSidebar key="home-sidebar"/>{{/hasGroup}}\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/threads/index",["require","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","feeds/lib/ui/threads/future/feed_delegate","workfeed/lib/app/sidebar/home_sidebar","models/mobile_feed_ad","common-ui/lib/ui/shared/next_group","feeds/lib/ui/threads/future/thread_list","models/lib/helper/feed_factory","models/helpers/group","common-ui/lib/ui/keyboard/group_navigation_commands","workfeed/lib/app/helpers/layout","backbone","core/lib/session","feeds/lib/ui/util/title_updater","core/lib/tr","core/lib/util/route_helper","models/helpers/user","html!./index"],function(a){"use strict";var b=a("core/lib/backbone_with_auto_render"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_subviews"),e=a("feeds/lib/ui/threads/future/feed_delegate"),f=a("workfeed/lib/app/sidebar/home_sidebar"),g=a("models/mobile_feed_ad"),h=a("common-ui/lib/ui/shared/next_group"),i=a("feeds/lib/ui/threads/future/thread_list"),j=a("models/lib/helper/feed_factory"),k=a("models/helpers/group"),l=a("common-ui/lib/ui/keyboard/group_navigation_commands"),m=a("workfeed/lib/app/helpers/layout"),n=a("backbone"),o=a("core/lib/session"),p=a("feeds/lib/ui/util/title_updater"),q=a("core/lib/tr"),r=a("core/lib/util/route_helper"),s=a("models/helpers/user"),t=a("html!./index");return c.extend({mixins:[b,d],className:m.twoColumnMainClass+" yk-clearfix",attributes:{role:"main"},template:t,views:{ThreadList:"_createThreadList",HomeSidebar:"_createHomeSidebar"},headerNavigationTab:"home",initialize:function(){p.setTitle(q.t("home")),k.fetch("company").then(r.executeInCurrentFragment(this._groupFetchSuccess,this)),this._nextGroup=new h({container:this.$el,type:"home",offsetPixels:100}),l.setHomeView()},_createThreadList:function(){var a=o.getCurrentUser(),b=this.options.type||s.getPrescribedFeedType(a),c=this._getFeed(b),d=c.hasKeyType("algo"),f={feed:c};d&&(f.connectionOptions={connectionType:"none"});var g=new e(f),h=new i({allowToBar:!0,useFeedToggle:!0,showFeedSeller:d,hideMoreButton:d,disableInfiniteScroll:d,disableUnreadMarker:d,feed:c,delegate:g,error:d&&this._onFeaturedFeedError.bind(this),markAsViewedOnScroll:!0,scrollSpy:this._scrollSpy});return d&&this._createMobileAd(g),this.listenToOnce(h,"render",this._initChatManager),this.threadList=h,h},_getFeed:function(a){var b;switch(a){case"my_all":b=j.findOrCreate("myAll");break;case"following":b=j.findOrCreate("following");break;default:b=j.findOrCreate("algo")}return b},_onFeaturedFeedError:function(){yam.router.navigate("/home?type=following",{trigger:!0})},_createMobileAd:function(a){var b=new g,c=function(){b.fetch({success:function(){var c=b.get("users").length;c>0&&a.add(b)}})};b.shouldFetch()&&a.on("reset",c,this)},_groupFetchSuccess:function(a){this._group=a,this.render()},getTemplateData:function(){return{hasGroup:!!this._group}},_createHomeSidebar:function(){return new f({model:this._group})},remove:function(){return this._nextGroup&&this._nextGroup.remove(),l.clearView(),c.prototype.remove.call(this)},_initChatManager:function(){n.trigger("/ui/view/afterListRendered")}})}),define("css!feeds/lib/ui/attachments/file_list",[],function(){}),define("feeds/lib/ui/attachments/file_list",["require","jquery","underscore","feeds/lib/ui/attachments/yamio_preview","core/lib/date_helper","core/lib/jam/component","core/lib/filename_helper","core/lib/namespace","core/lib/tr","mustache","common-ui/lib/helper/svg_icon","models/attachment","models/user","css!./file_list"],function(a){var b=a("jquery"),c=a("underscore"),d=a("feeds/lib/ui/attachments/yamio_preview"),e=a("core/lib/date_helper"),f=a("core/lib/jam/component"),g=a("core/lib/filename_helper"),h=a("core/lib/namespace"),i=a("core/lib/tr"),j=a("mustache"),k=a("common-ui/lib/helper/svg_icon");a("models/attachment"),a("models/user"),a("css!./file_list"),h.ns("yam.ui.attachments");var l=function(a){return yam.model.Attachment.findById(parseInt(a.attr("data-id"),10))},m=function(a){return function(b){var c=b.currentTarget;"a"===c.nodeName.toLowerCase()&&c.href&&c.href.match(/^http/)&&(void 0!==b.metaKey?b.metaKey:b.ctrlKey)||a.apply(this,arguments)}},n=function(a){var c=b(a.target),e=c.closest(".yj-file-list-item"),f=l(e);f&&d.previewable(f)&&(d.showOverlayForAttachment(f),a.preventDefault())},o=function(a){return function(c){var d=b(c.target),e=d.closest(".yj-file-list-item");e.find(".yj-action .yj-"+a).addClass("yj-highlight")}},p=function(a){return function(c){var d=b(c.target),e=d.closest(".yj-file-list-item");e.find(".yj-action .yj-"+a).removeClass("yj-highlight")}},q={action:'  <a href="{{url}}"      title="{{title}}"      {{#target}} target="{{target}}" {{/target}}      class="yj-conversation--file-action yj-{{key}} yamicon-{{icon}} yamicon yj-inline-icon yj-dark-gray">    <span class="yj-conversation--file-action-description">{{word}}</span>  </a>  ',item:'    <li class="yj-conversation--file-list-item yk-clearfix yj-file-list-item" data-id="{{id}}">      <span class="yj-conversation--file-icon">      {{{svgIcon}}}{{! generated HTML }}</span>      <span class="yj-conversation--file-name yj-name">        <span title="{{filename}}">{{filename}}</span>      </span>    </li>  '},r=f.extend(new function(){this.init=function(){f.prototype.init.call(this,{id:"FileList"}),this._files=[],this._primaryAction="preview"},this.createElement=function(){var a;return a=this.$element=b('<ul class="yj-conversation--file-list striped-grid"></ul>'),this.setFiles(this._files),a},this.setFiles=function(a){if(this._files=a.concat(),this.$element){var b;this.$element.empty(),this.$element.undelegate();for(var c=[],d=0,f=a.length;f>d;d++){var h=a[d],l=h.getMessage&&h.getMessage(),m={};if(c[d]=m,m.id=h.id,m.ext=g.getCanonicalExtension(h.name),m.filename=h.name,m.icon=g.getFileIconClass(h.name),m.svgIcon=k("docicon-"+m.icon,{width:24,height:24}),h.created_at){var n=e.formatDateTime(new Date(h.created_at)),o=e.formatAgo(new Date(h.created_at));o=o.replace(/\s+at\b.+$/,"");var p=h.web_url||l&&l.web_url;b='<span title="{{date}}">{{shortDate}}</span>';var r=j.render(b,{date:n,shortDate:o,webUrl:p}),s=h.creator_id&&yam.model.User.findById(h.creator_id);if(s){var t=j.render('<a href="{{web_url}}">{{full_name}}</a>',s);m.subtitle=i.t("date_by_user",{date:r,user:t})}else m.subtitle=r}else m.subtitle="&nbsp;";m.actions=this._getActionsForFile(h)}var u={items:c};b="    {{#items}}      {{> item}}    {{/items}}    ";var v=j.render(b,u,q);this.$element.html(v),this.adoptElement(this.$element)}},this._getActionsForFile=function(a){var b=d.isVideo(a),e=c(d.availableFileActions(a)).reject(function(a){return"share-file"===a.key||b&&"preview"===a.key}),f=c(e).map(function(b){var d=c.extend({},b);return b.url_fn&&(d.url=b.url_fn.call(null,a)),d});return f},this.adoptElement=function(a){var d,e=this.$element=b(a),f=this;d=e.children(".yj-file-list-item"),d.each(function(a,d){var e=b(d),g=l(e);if(g){var h,i,k=f._getActionsForFile(g),m={};for(h=0,i=k.length;i>h;h++)m[k[h].key]=k[h];for(h=k.length-1;h>=0;h--){var n=k[h],o=".yj-action .yj-"+n.key;e.find(o).length||e.find(".yj-action").prepend(document.createTextNode(" ")).prepend(j.render(q.action,n))}var p;if(f._primaryAction&&f._primaryAction in m){var r=f._primaryAction;p="detail"===r?g.web_url:g[r+"_url"],e.find(".yj-name").wrapInner('<a href="'+c.escape(p)+'" target="blank" />')}else"download"in m&&(p=g.download_url,e.find(".yj-name").wrapInner('<a href="'+c.escape(p)+'" target="blank" />'))}}),e.delegate(".yj-file-list-item > .yj-name a","mouseenter",o(this._primaryAction)),e.delegate(".yj-file-list-item > .yj-name a","mouseleave",p(this._primaryAction)),e.delegate(".yj-file-list-item .yj-action .yj-preview","click",m(n)),"preview"===this._primaryAction&&e.delegate(".yj-file-list-item > .yj-name a","click",m(n))}});return r.addInstances=function(a){for(var b=0,c=a.length;c>b;b++)yam.model.Attachment.save(a[b])},r.bless=function(a,b){var c=new this;return c._primaryAction=b||"preview",c.adoptElement(a),c},yam.ui.attachments.FileList=r}),/**
 *
 * Date picker
 * Author: Stefan Petre www.eyecon.ro
 *
 * Dual licensed under the MIT and GPL licenses
 *
 */
function(a){var b=function(){var b={years:"datepickerViewYears",moths:"datepickerViewMonths",days:"datepickerViewDays"},c={wrapper:'<div class="datepicker"><div class="datepickerBorderT" /><div class="datepickerBorderB" /><div class="datepickerBorderL" /><div class="datepickerBorderR" /><div class="datepickerBorderTL" /><div class="datepickerBorderTR" /><div class="datepickerBorderBL" /><div class="datepickerBorderBR" /><div class="datepickerContainer"><table cellspacing="0" cellpadding="0"><tbody><tr></tr></tbody></table></div></div>',head:["<td>",'<table cellspacing="0" cellpadding="0">',"<thead>","<tr>",'<th class="datepickerGoPrev"><a href="#"><span><%=prev%></span></a></th>','<th colspan="5" class="datepickerMonth"><a href="#"><span></span></a></th>','<th class="datepickerGoNext"><a href="#"><span><%=next%></span></a></th>',"</tr>",'<tr class="datepickerDoW">',"<th><span><%=day1%></span></th>","<th><span><%=day2%></span></th>","<th><span><%=day3%></span></th>","<th><span><%=day4%></span></th>","<th><span><%=day5%></span></th>","<th><span><%=day6%></span></th>",'<th class="last"><span><%=day7%></span></th>',"</tr>","</thead>","</table></td>"],space:'<td class="datepickerSpace"><div></div></td>',days:['<tbody class="datepickerDays">',"<tr>",'<td class="<%=weeks[0].days[0].classname%>"><a href="#"><span><%=weeks[0].days[0].text%></span></a></td>','<td class="<%=weeks[0].days[1].classname%>"><a href="#"><span><%=weeks[0].days[1].text%></span></a></td>','<td class="<%=weeks[0].days[2].classname%>"><a href="#"><span><%=weeks[0].days[2].text%></span></a></td>','<td class="<%=weeks[0].days[3].classname%>"><a href="#"><span><%=weeks[0].days[3].text%></span></a></td>','<td class="<%=weeks[0].days[4].classname%>"><a href="#"><span><%=weeks[0].days[4].text%></span></a></td>','<td class="<%=weeks[0].days[5].classname%>"><a href="#"><span><%=weeks[0].days[5].text%></span></a></td>','<td class="<%=weeks[0].days[6].classname%> last"><a href="#"><span><%=weeks[0].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[1].days[0].classname%>"><a href="#"><span><%=weeks[1].days[0].text%></span></a></td>','<td class="<%=weeks[1].days[1].classname%>"><a href="#"><span><%=weeks[1].days[1].text%></span></a></td>','<td class="<%=weeks[1].days[2].classname%>"><a href="#"><span><%=weeks[1].days[2].text%></span></a></td>','<td class="<%=weeks[1].days[3].classname%>"><a href="#"><span><%=weeks[1].days[3].text%></span></a></td>','<td class="<%=weeks[1].days[4].classname%>"><a href="#"><span><%=weeks[1].days[4].text%></span></a></td>','<td class="<%=weeks[1].days[5].classname%>"><a href="#"><span><%=weeks[1].days[5].text%></span></a></td>','<td class="<%=weeks[1].days[6].classname%> last"><a href="#"><span><%=weeks[1].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[2].days[0].classname%>"><a href="#"><span><%=weeks[2].days[0].text%></span></a></td>','<td class="<%=weeks[2].days[1].classname%>"><a href="#"><span><%=weeks[2].days[1].text%></span></a></td>','<td class="<%=weeks[2].days[2].classname%>"><a href="#"><span><%=weeks[2].days[2].text%></span></a></td>','<td class="<%=weeks[2].days[3].classname%>"><a href="#"><span><%=weeks[2].days[3].text%></span></a></td>','<td class="<%=weeks[2].days[4].classname%>"><a href="#"><span><%=weeks[2].days[4].text%></span></a></td>','<td class="<%=weeks[2].days[5].classname%>"><a href="#"><span><%=weeks[2].days[5].text%></span></a></td>','<td class="<%=weeks[2].days[6].classname%> last"><a href="#"><span><%=weeks[2].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[3].days[0].classname%>"><a href="#"><span><%=weeks[3].days[0].text%></span></a></td>','<td class="<%=weeks[3].days[1].classname%>"><a href="#"><span><%=weeks[3].days[1].text%></span></a></td>','<td class="<%=weeks[3].days[2].classname%>"><a href="#"><span><%=weeks[3].days[2].text%></span></a></td>','<td class="<%=weeks[3].days[3].classname%>"><a href="#"><span><%=weeks[3].days[3].text%></span></a></td>','<td class="<%=weeks[3].days[4].classname%>"><a href="#"><span><%=weeks[3].days[4].text%></span></a></td>','<td class="<%=weeks[3].days[5].classname%>"><a href="#"><span><%=weeks[3].days[5].text%></span></a></td>','<td class="<%=weeks[3].days[6].classname%> last"><a href="#"><span><%=weeks[3].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[4].days[0].classname%>"><a href="#"><span><%=weeks[4].days[0].text%></span></a></td>','<td class="<%=weeks[4].days[1].classname%>"><a href="#"><span><%=weeks[4].days[1].text%></span></a></td>','<td class="<%=weeks[4].days[2].classname%>"><a href="#"><span><%=weeks[4].days[2].text%></span></a></td>','<td class="<%=weeks[4].days[3].classname%>"><a href="#"><span><%=weeks[4].days[3].text%></span></a></td>','<td class="<%=weeks[4].days[4].classname%>"><a href="#"><span><%=weeks[4].days[4].text%></span></a></td>','<td class="<%=weeks[4].days[5].classname%>"><a href="#"><span><%=weeks[4].days[5].text%></span></a></td>','<td class="<%=weeks[4].days[6].classname%> last"><a href="#"><span><%=weeks[4].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[5].days[0].classname%>"><a href="#"><span><%=weeks[5].days[0].text%></span></a></td>','<td class="<%=weeks[5].days[1].classname%>"><a href="#"><span><%=weeks[5].days[1].text%></span></a></td>','<td class="<%=weeks[5].days[2].classname%>"><a href="#"><span><%=weeks[5].days[2].text%></span></a></td>','<td class="<%=weeks[5].days[3].classname%>"><a href="#"><span><%=weeks[5].days[3].text%></span></a></td>','<td class="<%=weeks[5].days[4].classname%>"><a href="#"><span><%=weeks[5].days[4].text%></span></a></td>','<td class="<%=weeks[5].days[5].classname%>"><a href="#"><span><%=weeks[5].days[5].text%></span></a></td>','<td class="<%=weeks[5].days[6].classname%> last"><a href="#"><span><%=weeks[5].days[6].text%></span></a></td>',"</tr>","</tbody>"],months:['<tbody class="<%=className%>">',"<tr>",'<td colspan="2"><a href="#"><span><%=data[0]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[1]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[2]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[3]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[4]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[5]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[6]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[7]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[8]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[9]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[10]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[11]%></span></a></td>',"</tr>","</tbody>"]},d={flat:!1,starts:1,prev:"&#9664;",next:"&#9654;",lastSel:!1,mode:"single",view:"days",calendars:1,format:"Y-m-d",position:"bottom",eventName:"click",onRender:function(){return{}},onChange:function(){return!0},onShow:function(){return!0},onBeforeShow:function(){return!0},onHide:function(){return!0},locale:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekMin:"wk"}},e=function(b){var d,e,f,h,i,j,k,l,m,n=a(b).data("datepicker"),o=a(b),p=Math.floor(n.calendars/2),q=0;o.find("td>table tbody").remove();for(var r=0;r<n.calendars;r++){switch(d=new Date(n.current),d.addMonths(-p+r),m=o.find("table").eq(r+1),m[0].className){case"datepickerViewDays":f=g(d,"B, Y");break;case"datepickerViewMonths":f=d.getFullYear();break;case"datepickerViewYears":f=d.getFullYear()-6+" - "+(d.getFullYear()+5)}m.find("thead tr:first th:eq(1) span").text(f),f=d.getFullYear()-6,e={data:[],className:"datepickerYears"};for(var s=0;12>s;s++)e.data.push(f+s);l=tmpl(c.months.join(""),e),d.setDate(1),e={weeks:[],test:10},h=d.getMonth();var f=(d.getDay()-n.starts)%7;for(d.addDays(-(f+(0>f?7:0))),i=-1,q=0;42>q;){j=parseInt(q/7,10),k=q%7,e.weeks[j]||(i=d.getWeekNumber(),e.weeks[j]={week:i,days:[]}),e.weeks[j].days[k]={text:d.getDate(),classname:[]},h!=d.getMonth()&&e.weeks[j].days[k].classname.push("datepickerNotInMonth"),0==d.getDay()&&e.weeks[j].days[k].classname.push("datepickerSunday"),6==d.getDay()&&e.weeks[j].days[k].classname.push("datepickerSaturday");var t=n.onRender(d),u=d.valueOf();(t.selected||n.date==u||a.inArray(u,n.date)>-1||"range"==n.mode&&u>=n.date[0]&&u<=n.date[1])&&e.weeks[j].days[k].classname.push("datepickerSelected"),t.disabled&&e.weeks[j].days[k].classname.push("datepickerDisabled"),t.className&&e.weeks[j].days[k].classname.push(t.className),e.weeks[j].days[k].classname=e.weeks[j].days[k].classname.join(" "),q++,d.addDays(1)}l=tmpl(c.days.join(""),e)+l,e={data:n.locale.monthsShort,className:"datepickerMonths"},l=tmpl(c.months.join(""),e)+l,m.append(l)}},f=function(a,b){if(a.constructor==Date)return new Date(a);for(var c,d,e,f,g,h=a.split(/\W+/),i=b.split(/\W+/),j=new Date,k=0;k<h.length;k++)switch(i[k]){case"d":case"e":c=parseInt(h[k],10);break;case"m":d=parseInt(h[k],10)-1;break;case"Y":case"y":e=parseInt(h[k],10),e+=e>100?0:29>e?2e3:1900;break;case"H":case"I":case"k":case"l":f=parseInt(h[k],10);break;case"P":case"p":/pm/i.test(h[k])&&12>f?f+=12:/am/i.test(h[k])&&f>=12&&(f-=12);break;case"M":g=parseInt(h[k],10)}return new Date(void 0===e?j.getFullYear():e,void 0===d?j.getMonth():d,void 0===c?j.getDate():c,void 0===f?j.getHours():f,void 0===g?j.getMinutes():g,0)},g=function(a,b){var c=a.getMonth(),d=a.getDate(),e=a.getFullYear(),f=(a.getWeekNumber(),a.getDay()),g=a.getHours(),h=g>=12,i=h?g-12:g,j=a.getDayOfYear();0==i&&(i=12);for(var k,l=a.getMinutes(),m=a.getSeconds(),n=b.split(""),o=0;o<n.length;o++){switch(k=n[o],n[o]){case"a":k=a.getDayName();break;case"A":k=a.getDayName(!0);break;case"b":k=a.getMonthName();break;case"B":k=a.getMonthName(!0);break;case"C":k=1+Math.floor(e/100);break;case"d":k=10>d?"0"+d:d;break;case"e":k=d;break;case"H":k=10>g?"0"+g:g;break;case"I":k=10>i?"0"+i:i;break;case"j":k=100>j?10>j?"00"+j:"0"+j:j;break;case"k":k=g;break;case"l":k=i;break;case"m":k=9>c?"0"+(1+c):1+c;break;case"M":k=10>l?"0"+l:l;break;case"p":case"P":k=h?"PM":"AM";break;case"s":k=Math.floor(a.getTime()/1e3);break;case"S":k=10>m?"0"+m:m;break;case"u":k=f+1;break;case"w":k=f;break;case"y":k=(""+e).substr(2,2);break;case"Y":k=e}n[o]=k}return n.join("")},h=function(a){Date.prototype.tempDate||(Date.prototype.tempDate=null,Date.prototype.months=a.months,Date.prototype.monthsShort=a.monthsShort,Date.prototype.days=a.days,Date.prototype.daysShort=a.daysShort,Date.prototype.getMonthName=function(a){return this[a?"months":"monthsShort"][this.getMonth()]},Date.prototype.getDayName=function(a){return this[a?"days":"daysShort"][this.getDay()]},Date.prototype.addDays=function(a){this.setDate(this.getDate()+a),this.tempDate=this.getDate()},Date.prototype.addMonths=function(a){null==this.tempDate&&(this.tempDate=this.getDate()),this.setDate(1),this.setMonth(this.getMonth()+a),this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.addYears=function(a){null==this.tempDate&&(this.tempDate=this.getDate()),this.setDate(1),this.setFullYear(this.getFullYear()+a),this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.getMaxDays=function(){var a,b=new Date(Date.parse(this)),c=28;for(a=b.getMonth(),c=28;b.getMonth()==a;)c++,b.setDate(c);return c-1},Date.prototype.getFirstDay=function(){var a=new Date(Date.parse(this));return a.setDate(1),a.getDay()},Date.prototype.getWeekNumber=function(){var a=new Date(this);a.setDate(a.getDate()-(a.getDay()+6)%7+3);var b=a.valueOf();return a.setMonth(0),a.setDate(4),Math.round((b-a.valueOf())/6048e5)+1},Date.prototype.getDayOfYear=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),b=new Date(this.getFullYear(),0,0,0,0,0),c=a-b;return Math.floor(c/24*60*60*1e3)})},i=function(b){var c=a(b).data("datepicker"),d=a("#"+c.id);if(!c.extraHeight){var e=a(b).find("div");c.extraHeight=e.get(0).offsetHeight+e.get(1).offsetHeight,c.extraWidth=e.get(2).offsetWidth+e.get(3).offsetWidth}var f=d.find("table:first").get(0),g=f.offsetWidth,h=f.offsetHeight;d.css({width:g+c.extraWidth+"px",height:h+c.extraHeight+"px"}).find("div.datepickerContainer").css({width:g+"px",height:h+"px"})},j=function(b){a(b.target).is("span")&&(b.target=b.target.parentNode);var c=a(b.target);if(c.is("a")){if(b.target.blur(),c.hasClass("datepickerDisabled"))return!1;var d=a(this).data("datepicker"),f=c.parent(),h=f.parent().parent().parent(),i=a("table",this).index(h.get(0))-1,j=new Date(d.current),l=!1,m=!1;if(f.is("th")){if(f.hasClass("datepickerWeek")&&"range"==d.mode&&!f.next().hasClass("datepickerDisabled")){var n=parseInt(f.next().text(),10);j.addMonths(i-Math.floor(d.calendars/2)),f.next().hasClass("datepickerNotInMonth")&&j.addMonths(n>15?-1:1),j.setDate(n),d.date[0]=j.setHours(0,0,0,0).valueOf(),j.setHours(23,59,59,0),j.addDays(6),d.date[1]=j.valueOf(),m=!0,l=!0,d.lastSel=!1}else if(f.hasClass("datepickerMonth"))switch(j.addMonths(i-Math.floor(d.calendars/2)),h.get(0).className){case"datepickerViewDays":h.get(0).className="datepickerViewMonths",c.find("span").text(j.getFullYear());break;case"datepickerViewMonths":h.get(0).className="datepickerViewYears",c.find("span").text(j.getFullYear()-6+" - "+(j.getFullYear()+5));break;case"datepickerViewYears":h.get(0).className="datepickerViewDays",c.find("span").text(g(j,"B, Y"))}else if(f.parent().parent().is("thead")){switch(h.get(0).className){case"datepickerViewDays":d.current.addMonths(f.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewMonths":d.current.addYears(f.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewYears":d.current.addYears(f.hasClass("datepickerGoPrev")?-12:12)}m=!0}}else if(f.is("td")&&!f.hasClass("datepickerDisabled")){switch(h.get(0).className){case"datepickerViewMonths":d.current.setMonth(h.find("tbody.datepickerMonths td").index(f)),d.current.setFullYear(parseInt(h.find("thead th.datepickerMonth span").text(),10)),d.current.addMonths(Math.floor(d.calendars/2)-i),h.get(0).className="datepickerViewDays";break;case"datepickerViewYears":d.current.setFullYear(parseInt(c.text(),10)),h.get(0).className="datepickerViewMonths";break;default:var n=parseInt(c.text(),10);switch(j.addMonths(i-Math.floor(d.calendars/2)),f.hasClass("datepickerNotInMonth")&&j.addMonths(n>15?-1:1),j.setDate(n),d.mode){case"multiple":n=j.setHours(0,0,0,0).valueOf(),a.inArray(n,d.date)>-1?a.each(d.date,function(a,b){return b==n?(d.date.splice(a,1),!1):void 0}):d.date.push(n);break;case"range":d.lastSel||(d.date[0]=j.setHours(0,0,0,0).valueOf()),n=j.setHours(23,59,59,0).valueOf(),n<d.date[0]?(d.date[1]=d.date[0]+86399e3,d.date[0]=n-86399e3):d.date[1]=n,d.lastSel=!d.lastSel;break;default:d.date=j.valueOf()}l=!0}m=!0}m&&e(this),l&&d.onChange.apply(this,k(d))}return!1},k=function(b){var c;return"single"==b.mode?(c=new Date(b.date),[g(c,b.format),c,b.el]):(c=[[],[],b.el],a.each(b.date,function(a,d){var e=new Date(d);c[0].push(g(e,b.format)),c[1].push(e)}),c)},l=function(){var a="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(a?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(a?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(a?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(a?document.documentElement.clientHeight:document.body.clientHeight)}},m=function(a,b,c){if(a==b)return!0;if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return!!(16&a.compareDocumentPosition(b));for(var d=b.parentNode;d&&d!=c;){if(d==a)return!0;d=d.parentNode}return!1},n=function(b){var c=a("#"+a(this).data("datepickerId"));if(!c.is(":visible")){var d=c.get(0);e(d);var f=c.data("datepicker");f.onBeforeShow.apply(this,[c.get(0)]);var g=a(this).offset(),h=l(),j=g.top,k=g.left;a.css(d,"display");switch(c.css({visibility:"hidden",display:"block"}),i(d),f.position){case"top":j-=d.offsetHeight;break;case"left":k-=d.offsetWidth;break;case"right":k+=this.offsetWidth;break;case"bottom":j+=this.offsetHeight}j+d.offsetHeight>h.t+h.h&&(j=g.top-d.offsetHeight),j<h.t&&(j=g.top+this.offsetHeight+d.offsetHeight),k+d.offsetWidth>h.l+h.w&&(k=g.left-d.offsetWidth),k<h.l&&(k=g.left+this.offsetWidth),c.css({visibility:"visible",display:"block",top:j+"px",left:k+"px"}),0!=f.onShow.apply(this,[c.get(0)])&&c.show(),a(document).bind("mousedown",{cal:c,trigger:this},o)}return!1},o=function(b){b.target==b.data.trigger||m(b.data.cal.get(0),b.target,b.data.cal.get(0))||(0!=b.data.cal.data("datepicker").onHide.apply(this,[b.data.cal.get(0)])&&b.data.cal.hide(),a(document).unbind("mousedown",o))};return{init:function(g){return g=a.extend({},d,g||{}),h(g.locale),g.calendars=Math.max(1,parseInt(g.calendars,10)||1),g.mode=/single|multiple|range/.test(g.mode)?g.mode:"single",this.each(function(){if(!a(this).data("datepicker")){if(g.el=this,g.date.constructor==String&&(g.date=f(g.date,g.format),g.date.setHours(0,0,0,0)),"single"!=g.mode)if(g.date.constructor!=Array)g.date=[g.date.valueOf()],"range"==g.mode&&g.date.push(new Date(g.date[0]).setHours(23,59,59,0).valueOf());else{for(var d=0;d<g.date.length;d++)g.date[d]=f(g.date[d],g.format).setHours(0,0,0,0).valueOf();"range"==g.mode&&(g.date[1]=new Date(g.date[1]).setHours(23,59,59,0).valueOf())}else g.date=g.date.valueOf();g.current?g.current=f(g.current,g.format):g.current=new Date,g.current.setDate(1),g.current.setHours(0,0,0,0);var h,k="datepicker_"+parseInt(1e3*Math.random());g.id=k,a(this).data("datepickerId",g.id);var l=a(c.wrapper).attr("id",k).bind("click",j).data("datepicker",g);g.className&&l.addClass(g.className);for(var m="",d=0;d<g.calendars;d++)h=g.starts,d>0&&(m+=c.space),m+=tmpl(c.head.join(""),{week:g.locale.weekMin,prev:g.prev,next:g.next,day1:g.locale.daysMin[h++%7],day2:g.locale.daysMin[h++%7],day3:g.locale.daysMin[h++%7],day4:g.locale.daysMin[h++%7],day5:g.locale.daysMin[h++%7],day6:g.locale.daysMin[h++%7],day7:g.locale.daysMin[h++%7]});l.find("tr:first").append(m).find("table").addClass(b[g.view]),e(l.get(0)),g.flat?(l.appendTo(this).show().css("position","relative"),i(l.get(0))):(l.appendTo(document.body),a(this).bind(g.eventName,n))}})},showPicker:function(){return this.each(function(){a(this).data("datepickerId")&&n.apply(this)})},hidePicker:function(){return this.each(function(){a(this).data("datepickerId")&&a("#"+a(this).data("datepickerId")).hide()})},setDate:function(b,c){return this.each(function(){if(a(this).data("datepickerId")){var d=a("#"+a(this).data("datepickerId")),g=d.data("datepicker");if(g.date=b,g.date.constructor==String&&(g.date=f(g.date,g.format),g.date.setHours(0,0,0,0)),"single"!=g.mode)if(g.date.constructor!=Array)g.date=[g.date.valueOf()],"range"==g.mode&&g.date.push(new Date(g.date[0]).setHours(23,59,59,0).valueOf());else{for(var h=0;h<g.date.length;h++)g.date[h]=f(g.date[h],g.format).setHours(0,0,0,0).valueOf();"range"==g.mode&&(g.date[1]=new Date(g.date[1]).setHours(23,59,59,0).valueOf())}else g.date=g.date.valueOf();c&&(g.current=new Date("single"!=g.mode?g.date[0]:g.date)),e(d.get(0))}})},getDate:function(b){return this.size()>0?k(a("#"+a(this).data("datepickerId")).data("datepicker"))[b?0:1]:void 0},clear:function(){return this.each(function(){if(a(this).data("datepickerId")){var b=a("#"+a(this).data("datepickerId")),c=b.data("datepicker");"single"!=c.mode&&(c.date=[],e(b.get(0)))}})},fixLayout:function(){return this.each(function(){if(a(this).data("datepickerId")){var b=a("#"+a(this).data("datepickerId")),c=b.data("datepicker");c.flat&&i(b.get(0))}})}}}();a.fn.extend({DatePicker:b.init,DatePickerHide:b.hidePicker,DatePickerShow:b.showPicker,DatePickerSetDate:b.setDate,DatePickerGetDate:b.getDate,DatePickerClear:b.clear,DatePickerLayout:b.fixLayout})}(jQuery),function(){var a={};this.tmpl=function b(c,d){var e=/\W/.test(c)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):a[c]=a[c]||b(document.getElementById(c).innerHTML);return d?e(d):e}}(),define("jquery-datepicker",function(){}),define("css!workfeed/lib/app/search_sidebar",[],function(){}),define("stache!workfeed/lib/app/search_sidebar",["mustache"],function(a){var b='<form accept-charset="UTF-8" method="get" class="yj-advanced-search-form">\n  <fieldset class="yj-advanced-search--fieldset">\n    <input name="utf8" type="hidden" value="✓">\n    <legend>{{advanced_search}}</legend>\n    <h2 class="yj-advanced-search--header" role="heading" aria-level="2">\n      {{advanced_search}}\n    </h2>\n    <p class="yj-advanced-search--block yk-clearfix">\n      <label class="yj-advanced-search--label" for="search_sidebar">{{search_for}}</label>\n      <input class="yj-advanced-search--field yj-advanced-search--field-search" id="search_sidebar" maxlength="{{MAX_SEARCH_INPUT_LENGTH}}" name="search" type="text" value="{{search}}">\n    </p>\n    {{^group_selected}}\n      <p class="yj-advanced-search--block yk-clearfix">\n        <label class="yj-advanced-search--label" for="search_sidebar_in">{{group_in}}:</label>\n        <input id="search_sidebar_in" class="yj-advanced-search--field group-select" type="text" autocomplete="off">\n      </p>\n    {{/group_selected}}\n    {{#group_selected}}\n      <div class="yj-advanced-search--block yk-clearfix">\n        <label class="yj-advanced-search--label" for="search_sidebar_in">{{group_in}}:</label>\n        <input id="search_sidebar_in" class="yj-advanced-search--field group-select" style="display:none;" type="text" autocomplete="off">\n        <div class="yj-tag-list-lg">\n          <div class="yj-tag"><span class="yj-tag-group yj-inline-icon yamicon yamicon-rd_groups"></span><span class="yj-tag-name" title="{{group_name}}">{{group_name}}</span><a class="yj-tag-remove yamicon yamicon-rd_close yk-yamicon-m" href="javascript://" role="button"><span class="yj-acc-hidden">{{remove_group_tooltip}}</span></a></div>\n        </div>\n      </div>\n    {{/group_selected}}\n    <input id="search_group" name="search_group" type="hidden" value="{{group_id}}">\n    <input id="search_inbox" name="search_inbox" type="hidden" value="{{inbox}}">\n    <p class="yj-advanced-search--block yk-clearfix">\n      <span class="yj-advanced-search--label">{{date_between}}:</span>\n      <label class="yj-acc-hidden" for="startdate">{{between_start_tooltip}}</label>\n      <input id="startdate" type="text" size="10" name="search_startdate" value="{{start_date}}" class="yj-advanced-search--field yj-advanced-search--field-date">\n      <span class="yj-advanced-search--label-inline"></span>\n      <label class="yj-acc-hidden" for="enddate">{{between_end_tooltip}}</label>\n      <input id="enddate" type="text" size="10" name="search_enddate" value="{{end_date}}" class="yj-advanced-search--field yj-advanced-search--field-date">\n    </p>\n    <p class="yj-advanced-search--block yk-clearfix yj-advanced-search--block-button">\n      <button type="submit" class="yj-btn">\n        <span>{{search_label}}</span>\n      </button>\n    </p>\n  </fieldset>\n</form>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/search_sidebar",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/session","core/lib/tr","core/lib/treatment","common-ui/lib/ui/shared/type_ahead","models/helpers/network","core/lib/urls","models/group","core/lib/yammer_uri","jquery-datepicker","css!workfeed/lib/app/search_sidebar","html!./search_sidebar"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/session"),g=a("core/lib/tr"),h=a("core/lib/treatment"),i=a("common-ui/lib/ui/shared/type_ahead"),j=a("models/helpers/network"),k=a("core/lib/urls"),l=a("models/group"),m=a("core/lib/yammer_uri");return a("jquery-datepicker"),a("css!workfeed/lib/app/search_sidebar"),d.extend({mixins:[e],id:"sidebar",className:"yj-advanced-search",template:a("html!./search_sidebar"),events:{"click .yj-tag-list-lg a.yj-tag-remove":"removeGroupHandler"},initialize:function(a){this.target=a?a.target:null},removeGroupHandler:function(a){a.preventDefault(),this.$("input#search_group, input#search_inbox").val(""),this.$(".yj-tag-list-lg").remove(),b(".group-select").show().focus()},getTemplateData:function(){return c.extend({remove_group_tooltip:g.t("remove_group_groupname",{groupname:this.model.group_name}),between_start_tooltip:g.t("between_start"),between_end_tooltip:g.t("between_end")},this.model)},render:function(){return this.buildComponents(),this},onSubmit:function(){var a=this.getOptions();if(0!==a.search.trim().length)return this.trigger("search",a),!1},getOptions:function(){var a=this.$("form").serializeArray(),b={};return c.each(a,function(a){var c=a.value;b[a.name]=c}),b.search_source="sidebar","Inbox"===b.group_name&&delete b.group_name,b},buildComponents:function(){this.form=this.$("form").submit(this.onSubmit.bind(this)),this.startDate=this.$("#startdate"),this.endDate=this.$("#enddate"),this.startDate.DatePicker({date:this.startDate.val()||new Date,format:"m/d/Y",onChange:c.bind(function(a){this.startDate.val(a).DatePickerHide()},this)}),this.endDate.DatePicker({date:this.endDate.val()||new Date,format:"m/d/Y",onChange:c.bind(function(a){this.endDate.val(a).DatePickerHide()},this)});var a=this.$("#search_user");i.registerField(this.$("#search_user"),{triggerStrings:[],completableModels:[i.MODEL_USER],styles:"minimal",allowNoMatch:!0,onSelect:c.bind(function(d){a.val(d.name),a.hide();var e=b('<a href="javascript://" class="reset">x</a>');e.click(c.bind(function(){this.$("#search-display-name").hide(),a.show(),a.focus(),b(this).remove()},this)),this.$("#search-display-name").html("<strong>"+d.full_name+"</strong> <em class='quiet'>("+d.name+")</em> ").append(e).show()},this)}),i.registerField(this.$(".group-select"),{triggerStrings:[],showTopRankings:!0,maxResults:6,completableModels:[i.MODEL_GROUP],includes:function(){var a=[{id:"0",full_name:j.getCompanyGroupName(f.getCurrentNetwork()),description:g.t("this_is_the_default_group_for_everyone_in_the_currentnetwork",{currentNetwork:f.getCurrentNetwork().name}),web_url:k.groupIndex(l.ALL_COMPANY()),photo:m.cdn("assets/images/company_group_profile.png")},{id:"INBOX_GROUP_ID",full_name:h.usePriorityCopy()?g.t("priority_conversations"):g.t("inbox"),description:h.usePriorityCopy()?"":g.t("your_inbox"),web_url:k.networkIndex(f.getCurrentNetwork())+"/#/inbox/index",photo:m.cdn("assets/images/inbox_search.png")}];return{group:a}}(),onSelect:c.bind(function(a){var b=a.full_name||a.name,c=this.$(".group-select");c.after('<div class="yj-tag-list-lg"><div class="yj-tag"><span class="yj-tag-group yj-inline-icon yamicon yamicon-rd_groups"></span><span class="yj-tag-name" title="'+b+'">'+b+'</span><a class="yj-tag-remove yamicon yamicon-rd_close yk-yamicon-m" href="javascript://"><span class="yj-acc-hidden">'+g.t("remove_group_groupname",{groupname:b})+"</span></a></div></div>");var d,e,f;"Inbox"===b?(d=1,e="",f=""):(d="",e=a.id,f=b),this.$("#search_inbox").val(d),this.$("#search_group").val(e),this.$("#search_group_name").val(f),c.hide()},this)})}})}),define("css!components/search/src/paginated_results",[],function(){}),define("stache!components/search/src/paginated_results",["mustache"],function(a){var b='<div class="yj-paginated-results--search-error" style="display:none">\n  {{searchErrorMessage}} <a href="javascript://" class="yj-paginated-results--retry-search">{{redoSearchMessage}}</a>\n</div>\n\n<Results />\n\n<Paginator />';return a.parse(b),function(c){return a.render(b,c)}}),define("components/search/src/paginated_results",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","backbone","core/lib/tr","models/lib/helper/feed_factory","components/paginator/index","collections/yammer_collection","css!./paginated_results","html!./paginated_results"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("backbone"),g=a("core/lib/tr"),h=a("models/lib/helper/feed_factory"),i=a("components/paginator/index"),j=a("collections/yammer_collection");return c.extend({mixins:[d,e],className:"yj-paginated-results",styles:a("css!./paginated_results"),template:a("html!./paginated_results"),views:{Results:"_createResultsContainer",Paginator:"_createPaginator"},events:{"click .yj-paginated-results--retry-search":"_redoSearch"},initialize:function(a){if(b.bindAll(this,"_searchSuccess","_searchFail"),this._searchParams=b.defaults(a.queryOptions,{page:1}),this._searchFeed=h.findOrCreate("search"),this._searchStrategy=a.searchStrategy,this.collection=new j,!this._searchStrategy)throw"Paginated Results must be instantiated with a search strategy"},getTemplateData:function(){return{searchErrorMessage:g.t("there_was_an_error_performing_this_search"),redoSearchMessage:g.t("click_here_to_retry")}},reset:function(){return this.collection.reset(),this._updatePagination(0),this._hideFailErrorMessage(),this.render()},fetch:function(){var a=this;return this.reset(),this.trigger("loading"),this._searchStrategy.fetch(this._searchParams).then(this._searchSuccess).fail(this._searchFail).always(function(){a.trigger("loaded")}),this},fetchFirstPage:function(){return this._searchParams.page=1,this.fetch()},_searchSuccess:function(a){this._processPayload(a),this.render()},_searchFail:function(){f.trigger("/ui/alert/show","error",g.t("there_was_an_error_performing_this_search")),this.reset(),this._showFailErrorMessage()},_createResultsContainer:function(){return this._searchStrategy.createResultsContainer.call(this)},_createPaginator:function(){return this._paginator=new i,this.listenTo(this._paginator,"previous",this._onPrevious),this.listenTo(this._paginator,"next",this._onNext),this._paginator},_showFailErrorMessage:function(){this.$(".yj-paginated-results--search-error").show()},_hideFailErrorMessage:function(){this.$(".yj-paginated-results--search-error").hide()},_redoSearch:function(){this._hideFailErrorMessage(),this.fetch()},_processPayload:function(a){var b=this._searchStrategy.processPayload.call(this,a);this._updatePagination(a.count),this.collection.reset(b)},_updatePagination:function(a){var b=!1,c=!1;a>this._searchStrategy.pageSize&&(b=this._searchParams.page>1,c=this._searchParams.page*this._searchStrategy.pageSize<a),this._paginator.togglePrevious(b),this._paginator.toggleNext(c)},_onPrevious:function(){this._searchParams.page=--this._searchParams.page||1,this.trigger("paginate",this._searchParams.page),this.reset(),this.fetch()},_onNext:function(){this._searchParams.page++,this.trigger("paginate",this._searchParams.page),this.reset(),this.fetch()}})}),define("stache!components/search_results/src/conversations",["mustache"],function(a){var b='{{#items}}\n  <ThreadSearchListItem key="{{.}}" />\n{{/items}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/search_results/src/conversations",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","feeds/lib/ui/threads/thread_search_list_item","models/message","html!./conversations"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("feeds/lib/ui/threads/thread_search_list_item"),g=a("models/message");
return c.extend({mixins:[d,e],tagName:"ul",views:{ThreadSearchListItem:"_getThreadSearchListItem"},template:a("html!./conversations"),initialize:function(){this.listenTo(this.collection,"reset add remove",this.render)},getTemplateData:function(){return{items:this.collection.pluck("id")}},_getThreadSearchListItem:function(a){var c=g.findById(a);if(c){var d=c.getThread();d.thread_starter_id=d.thread_starter_id||c.id;var e=new f(d,this.options);return b.defer(e.decorateLinks),e}}})}),define("core/lib/search_strategies/conversations",["require","underscore","components/search_results/src/conversations","core/lib/date_helper","core/lib/yammer_api","core/lib/report"],function(a){"use strict";var b=a("underscore"),c=a("components/search_results/src/conversations"),d=a("core/lib/date_helper"),e=a("core/lib/yammer_api"),f=a("core/lib/report"),g=20,h=function(a){return{search:a.search,start:(a.page-1)*g,size:g,start_date:d.formatStringTime(a.search_startdate),end_date:d.formatStringTime(a.search_enddate),group_ids:a.group_ids,model_types:"threads"}};return{pageSize:g,fetch:function(a){return a=h(a),f.event("search_performance",a),e.searchMessagesV2(a)},processPayload:function(a){return yam.modelController.onMessages(a,this._searchFeed),a.messages},createResultsContainer:function(){return this._resultsContainer=new c(b.extend({collection:this.collection},this.options)),this._resultsContainer}}}),define("core/lib/search_strategies/polls",["require","underscore","components/search_results/src/conversations","core/lib/yammer_api"],function(a){"use strict";var b=a("underscore"),c=a("components/search_results/src/conversations"),d=a("core/lib/yammer_api"),e=20,f=function(a){return{search:a.search,page:a.page,search_startdate:a.search_startdate,search_enddate:a.search_enddate,search_group:a.search_group,facet_type:"ymodule_application",facet_id:2}},g=function(a){var b=a.count.polls.count;return a=a.messages,a.count=b,a};return{pageSize:e,processPayload:function(a){return yam.modelController.onMessages(a,this._searchFeed),a.messages},fetch:function(a){return d.getSearchResultsTab(f(a)).then(JSON.parse).then(g)},createResultsContainer:function(){return this._resultsContainer=new c(b.extend({collection:this.collection},this.options)),this._resultsContainer}}}),define("core/lib/search_strategies/inbox",["require","underscore","components/search_results/src/conversations","core/lib/date_helper","core/lib/yammer_api","core/lib/report"],function(a){"use strict";var b=a("underscore"),c=a("components/search_results/src/conversations"),d=a("core/lib/date_helper"),e=a("core/lib/yammer_api"),f=a("core/lib/report"),g=20,h=function(a){return{search:a.search,start_date:d.formatStringTime(a.search_startdate),end_date:d.formatStringTime(a.search_enddate),size:g,start:(a.page-1)*g}};return{pageSize:g,processPayload:function(a){return yam.modelController.onMessages(a,this._searchFeed),a.messages},fetch:function(a){return a=h(a),f.event("inbox_scoped_search",a),e.searchInboxV2(a)},createResultsContainer:function(){return this._resultsContainer=new c(b.extend({collection:this.collection},this.options)),this._resultsContainer}}}),define("css!components/search_results/src/users",[],function(){}),define("stache!components/search_results/src/users",["mustache"],function(a){var b='{{#visible}}\n  <thead>\n    <tr class="yj-user-search-results--header-row">\n      <th class="yj-user-search-results--people">{{people}}</th>\n      <th class="yj-user-search-results--joined">{{joined_on}}</th>\n    </tr>\n  </thead>\n  <tbody>\n  {{#items}}\n    <tr class="yj-user-search-results--results-row">\n      <td class="yj-user-search-results--people">\n        <Avatar key="{{id}}"/>\n        <div class="yj-user-search-results--name-title">\n          <HovercardLink key="{{id}}"/>\n          {{#foreign}}\n          <div class="yj-user-search-results--network">\n            <span class="yamicon yamicon-network"><span class="yj-acc-hidden">{{other_network}}</span></span><span>{{permalink}}</span>\n          </div>\n          {{/foreign}}\n          {{^foreign}}\n          <div class="yj-user-search-results--title">{{title}}</div>\n          {{/foreign}}\n        </div>\n      </td>\n      <td class="yj-user-search-results--joined">{{joined}}</td>\n    </tr>\n  {{/items}}\n  </tbody>\n{{/visible}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/search_results/src/users",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","models/user","components/avatar/index","components/hovercard_link/index","core/lib/tr","core/lib/date_helper","models/helpers/user","core/lib/session","models/network","css!./users","html!./users"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("models/user"),g=a("components/avatar/index"),h=a("components/hovercard_link/index"),i=a("core/lib/tr"),j=a("core/lib/date_helper"),k=a("models/helpers/user"),l=a("core/lib/session"),m=a("models/network");a("css!./users");var n={people:i.t("user_search_result_column_people"),joined_on:i.t("user_search_result_column_joined_on")};return c.extend({mixins:[d,e],tagName:"table",className:"yj-user-search-results",template:a("html!./users"),views:{Avatar:"_getAvatar",HovercardLink:"_getHovercardLink"},initialize:function(a){this._searchStrategy=a.searchStrategy,this.listenTo(this.collection,"reset add remove",this.render)},getTemplateData:function(){return b.extend({visible:!!this.collection.length,items:this.collection.map(function(a){var b=i.t("pending");return k.isActive(a)&&(b=j.formatDate(new Date(a.get("activated_at")))),{id:a.get("id"),joined:b,title:a.get("job_title"),foreign:k.isForeign(a,l),permalink:k.getNetworkName(a,m),other_network:i.t("other_network_icon_alttext")}})},n)},_getAvatar:function(a){var b=f.findById(a);return new g({model:b})},_getHovercardLink:function(a){var b=f.findById(a);return new h({model:b})}})}),define("core/lib/search_strategies/users",["require","underscore","models/user","models/network","core/lib/yammer_api","core/lib/report","core/lib/treatment","components/search_results/src/users","core/lib/util/hydrant_helper","models/helpers/network","core/lib/session"],function(a){"use strict";var b=a("underscore"),c=a("models/user"),d=a("models/network"),e=a("core/lib/yammer_api"),f=a("core/lib/report"),g=a("core/lib/treatment"),h=a("components/search_results/src/users"),i=a("core/lib/util/hydrant_helper"),j=a("models/helpers/network"),k=a("core/lib/session"),l=20,m=function(a){return{search:a.search,size:l,start:(a.page-1)*l,model_types:"users",group_ids:a.group_ids,search_foreign:j.isExternalMessagingEnabled(k.getCurrentNetwork())}},n=function(a){return b.extend({},a,{search_group:a.group_ids,search_foreign:j.isExternalMessagingEnabled(k.getCurrentNetwork())})};return{pageSize:l,fetch:function(a){return g.treatment("msf_core_p1")?(a=m(a),e.searchUsersV2(a).then(function(a){return a.count={users:a.total_count},a})):(a=n(a),a=b.extend({model_types:"User"},a),f.event("search_performance",a),e.getSearchResults(a))},processPayload:function(a){return a.users.forEach(function(b){g.treatment("msf_core_p1")&&(b=i.generateUser(a,b)),c.save(b)}),a.reference_data&&a.reference_data.networks&&Object.keys(a.reference_data.networks).forEach(function(b){d.create(a.reference_data.networks[b])}),a.count=a.count.users,a.users},createResultsContainer:function(){return this._resultsContainer=new h(b.extend({collection:this.collection},this.options)),this._resultsContainer}}}),define("css!components/search_results/src/groups",[],function(){}),define("stache!components/search_results/src/groups",["mustache"],function(a){var b='{{#visible}}\n  <thead>\n    <tr class="yj-group-search-results--header-row">\n      <th class="yj-group-search-results--groups">{{groups}}</th>\n      <th class="yj-group-search-results--members">{{members}}</th>\n    </tr>\n  </thead>\n  <tbody>\n  {{#items}}\n    <tr class="yj-group-search-results--results-row">\n      <td class="yj-group-search-results--people">\n        <Avatar key="{{id}}"/>\n        <div class="yj-group-search-results--name-title">\n          <HovercardLink key="{{id}}"/>\n          {{#private}}<span class="yamicon-lock yamicon yamicon-xx-small yj-dark-gray"></span>{{/private}}\n          <div class="yj-group-search-results--description">{{description}}</div>\n        </div>\n      </td>\n      <td class="yj-group-search-results--members">{{members_count}}</td>\n    </tr>\n  {{/items}}\n  </tbody>\n{{/visible}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/search_results/src/groups",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","collections/groups","components/avatar/index","components/hovercard_link/index","models/helpers/group","core/lib/tr","css!./groups","html!./groups"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("collections/groups"),g=a("components/avatar/index"),h=a("components/hovercard_link/index"),i=a("models/helpers/group"),j=a("core/lib/tr");a("css!./groups");var k={groups:j.t("group_search_result_column_groups"),members:j.t("group_search_result_column_members")};return c.extend({mixins:[d,e],tagName:"table",className:"yj-group-search-results",template:a("html!./groups"),views:{Avatar:"_getAvatar",HovercardLink:"_getHovercardLink"},initialize:function(a){this._searchStrategy=a.searchStrategy,this.listenTo(this.collection,"reset add remove",this.render)},getTemplateData:function(){return b.extend({visible:!!this.collection.length,items:this.collection.map(function(a){var b=a.get("stats"),c=b&&b.members||0;return{id:a.get("id"),members_count:c,description:a.get("description"),private:i.isPrivate(a)}})},k)},_getAvatar:function(a){var b=f.get(a);return new g({model:b})},_getHovercardLink:function(a){var b=f.get(a);return new h({model:b})}})}),define("core/lib/search_strategies/groups",["require","underscore","collections/groups","models/network","core/lib/yammer_api","core/lib/report","core/lib/treatment","components/search_results/src/groups","core/lib/util/hydrant_helper"],function(a){"use strict";var b=a("underscore"),c=a("collections/groups"),d=a("models/network"),e=a("core/lib/yammer_api"),f=a("core/lib/report"),g=a("core/lib/treatment"),h=a("components/search_results/src/groups"),i=a("core/lib/util/hydrant_helper"),j=20,k=function(a){return{search:a.search,size:j,start:(a.page-1)*j,model_types:"groups"}};return{pageSize:j,fetch:function(a){return g.treatment("msf_core_p1")?(a=k(a),e.searchGroupsV2(a).then(function(a){return a.count={groups:a.total_count},a})):(a=b.extend({model_types:"Group"},a),f.event("search_performance",a),e.getSearchResults(a))},processPayload:function(a){var b=c.add(a.groups.map(function(b){return g.treatment("msf_core_p1")?i.generateGroup(a,b):b}),{merge:!0});return a.reference_data&&a.reference_data.networks&&Object.keys(a.reference_data.networks).forEach(function(b){d.create(a.reference_data.networks[b])}),a.count=a.count.groups,b},createResultsContainer:function(){return this._resultsContainer=new h(b.extend({collection:this.collection},this.options)),this._resultsContainer}}}),define("css!components/search_results/src/files",[],function(){}),define("stache!components/search_results/src/files",["mustache"],function(a){var b='{{#visible}}\n  <tbody class="yj-file-search-results--results-body">\n  {{#items}}\n    <tr class="yj-file-search-results--results-row" data-file-id="{{id}}">\n      <td class="yj-file-search-results--file">\n      <div class="yj-file-search-results--thumbnail-preview">\n      {{#show_thumbnail}}\n        <a href="{{thumbnail_link}}"><img alt="{{name}}" class="yj-file-search-results--thumbnail" src="{{thumbnail}}"></a>\n      {{/show_thumbnail}}\n      {{^show_thumbnail}}\n        <div class="yj-image">\n          <div class="large-file-icon">\n          <img src="{{large_icon}}"><span aria-hidden="true" class="file-type-overlay">{{extension}}</span></div>\n        </div>\n      {{/show_thumbnail}}\n      </div>\n      <div class="yj-file-search-results--content">\n        <div class="yj-file-search-results--header">\n          <a href="{{name_link}}" class="yj-file-search-results--name" data-qaid="name">{{name}}</a>\n          <span class="arrow-right-icon yj-inline-icon yj-align-icon"></span> \n          <span class="yj-file-search-results--group" data-qaid="group">\n            <GroupHovercardLink />\n          </span>\n        </div>\n        <div class="yj-file-search-results--subheader yj-byline" data-qaid="subheader">\n          {{last_uploaded_by}} <UserHovercardLink /> {{time_ago}} <span>·</span> <span data-qaid="file-size">{{size}}</span>\n        </div>\n        {{#show_snippets}}\n        <div class="yj-file-search-results--snippets-container">\n          <ul class="yj-file-search-results--snippets">\n          {{#snippets}}\n            <li class="yj-file-search-results--snippet"><span class="yj-file-search-results--snippet-byline yj-byline"><span class="yj-file-search-results--snippet-message">{{{.}}}</span></span>\n            </li>\n          {{/snippets}}\n          </ul>\n        </div>\n        {{/show_snippets}}\n        <div class="yj-file-search-results--actions">\n          {{#previewable}}\n          <a class="yj-file-search-results--preview yj-preview" data-file-id="{{id}}"><i class="yamicon-add-search yamicon yj-inline-icon"></i><span>{{preview}}</span></a>\n          {{/previewable}}\n          {{#downloadable}}\n          <a href="{{download_link}}" class="yj-file-search-results--download" data-qaid="download"><i class="yamicon-download yamicon yj-inline-icon"></i><span>{{download}}</span></a>\n          {{/downloadable}}\n          <a href="{{goto_link}}" class="yj-file-search-results--goto" data-qaid="goto">\n            <i class="yamicon-goto yamicon yj-inline-icon"></i><span>{{goto}}</span>\n          </a>\n        </div>\n      </div>\n      </td>\n    </tr>\n  {{/items}}\n  </tbody>\n{{/visible}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/search_results/src/files",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","models/user","collections/groups","models/group","components/hovercard_link/index","feeds/lib/ui/attachments/yamio_preview","core/lib/tr","core/lib/date_helper","core/lib/location_helper","core/lib/filename_helper","core/lib/treatment","models/helpers/file","core/lib/urls","css!./files","html!./files"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("models/user"),g=a("collections/groups"),h=a("models/group"),i=a("components/hovercard_link/index"),j=a("feeds/lib/ui/attachments/yamio_preview"),k=a("core/lib/tr"),l=a("core/lib/date_helper"),m=a("core/lib/location_helper"),n=a("core/lib/filename_helper"),o=a("core/lib/treatment"),p=a("models/helpers/file"),q=a("core/lib/urls");a("css!./files");var r={preview:k.t("file_search_result_row_preview_link"),download:k.t("file_search_result_row_download_link"),goto:k.t("file_search_result_row_goto_link"),last_uploaded_by:k.t("file_search_result_row_last_uploaded_by")};return c.extend({mixins:[d,e],tagName:"table",className:"yj-file-search-results",template:a("html!./files"),views:{UserHovercardLink:"_getUserHovercardLink",GroupHovercardLink:"_getGroupHovercardLink"},events:{"click .yj-file-search-results--results-row":"_clickRow","click .yj-file-search-results--preview":"_clickPreview","click .yj-file-search-results--download":"_clickLink","click .yj-file-search-results--goto":"_clickLink","click .yj-hovercard-link":"_clickLink"},initialize:function(a){this._searchStrategy=a.searchStrategy,this.listenTo(this.collection,"reset add remove",this.render)},getTemplateData:function(){return b.extend({visible:!!this.collection.length,items:this.collection.map(function(a){var b=a.get("latest_version");o.treatment("msf_core_p2")&&(b=a.attributes);var c=q.fileIndex(a),d=a.get("snippets");return{id:a.get("id"),thumbnail_link:c,show_thumbnail:!!b.thumbnail_url,thumbnail:b.thumbnail_url,large_icon:a.get("large_icon_url"),extension:n.getExtension(a.get("original_name")),name:a.get("name"),name_link:c,time_ago:l.formatAgo(new Date(b.created_at)),size:p.bytesToSize(b.size),previewable:j.previewable(a.attributes),preview_link:b.preview_url,downloadable:p.isFile(a),download_link:b.download_url,goto_link:c,row_link:c,snippets:d,show_snippets:d&&d.length}})},r)},_getUserHovercardLink:function(a){var b,c;return c=o.treatment("msf_core_p2")?this.collection.at(a).get("uploader_id"):this.collection.at(a).get("latest_version").uploader_id,b=f.findById(c),new i({model:b})},_getGroupHovercardLink:function(a){var b,c;return c=this.collection.at(a).get("group_id"),b=g.get(c),c||(b=h.ALL_COMPANY()),new i({model:b})},_clickRow:function(a){var b=$(a.currentTarget).data("file-id");m.assign(q.fileIndex({id:b}))},_clickPreview:function(a){var b=$(a.currentTarget).data("file-id"),c=this.collection.find({id:b});c&&j.showOverlayForAttachment(c.attributes),this._clickLink(a)},_clickLink:function(a){a.stopPropagation()}})}),define("core/lib/search_strategies/files",["require","underscore","core/lib/yammer_api","core/lib/report","components/search_results/src/files","models/user","models/network","collections/groups","core/lib/treatment","core/lib/util/hydrant_helper","models/attachment"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/yammer_api"),d=a("core/lib/report"),e=a("components/search_results/src/files"),f=a("models/user"),g=a("models/network"),h=a("collections/groups"),i=a("core/lib/treatment"),j=a("core/lib/util/hydrant_helper"),k=a("models/attachment"),l=20,m=function(a){var c=a.uploaded_files;return i.treatment("msf_core_p2")?(a.files.forEach(k.save.bind(k)),b.values(a.reference_data.users||{}).forEach(function(b){f.save(j.generateUser(a,b))}),b.values(a.reference_data.groups||{}).forEach(function(b){h.add(j.generateGroup(a,b))}),void b.values(a.reference_data.networks||{}).forEach(function(b){g.save(j.generateNetwork(a,b))})):void c.forEach(function(a){k.save(a);for(var b=a.references||[],c=0;c<b.length;c++){var d=b[c];switch(d.type){case"user":f.save(d);break;case"group":h.add(d);break;case"network":g.save(d)}}})},n=function(a){return{search:a.search,size:l,start:(a.page-1)*l,model_types:"files",group_ids:a.group_ids}},o=function(a){return b.extend({},a,{search_group:a.group_ids})};return{pageSize:l,fetch:function(a){return i.treatment("msf_core_p2")?(a=n(a),c.searchFilesV2(a).then(function(a){return a.files=a.files.map(j.generateFile.bind(null,a.url_templates)),a})):(a=o(a),a=b.extend({model_types:"UploadedFile"},a),d.event("search_performance",a),c.getSearchResults(a))},processPayload:function(a){return m(a),i.treatment("msf_core_p2")?(a.count=a.total_count,a.files):(a.count=a.count.uploaded_files,a.uploaded_files)},createResultsContainer:function(){return this._resultsContainer=new e(b.extend({collection:this.collection},this.options)),this._resultsContainer}}}),define("stache!components/official_badge/src/official_badge",["mustache"],function(a){var b='{{#show}}\n<span class="yj-official-badge--container">\n  <span class="yj-tooltip yj-tooltip-default yj-tooltip-with-default-arrows">\n    <span class="yj-tooltip-icon yamicon yamicon-up-arrow"></span>\n    <span class="yj-tooltip-container">{{tooltip}}</span>\n  </span>\n  <span class="yamicon yamicon-filled-star yamicon-xx-small"></span>\n  <span>{{label}}</span>\n</span>\n{{/show}}';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/official_badge/src/official_badge",[],function(){}),define("components/official_badge/src/official_badge",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","models/helpers/models","html!./official_badge","css!./official_badge"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("models/helpers/models"),f=a("html!./official_badge");return a("css!./official_badge"),b.extend({template:f,mixins:[c],className:"yj-official-badge",attributes:{"data-qaid":"official_badge"},initialize:function(){if(!this.model)throw new Error("Official Badge requires a note or file model")},getTemplateData:function(){var a=e.getHelperForModel(this.model);return{show:a.isOfficial(this.model),label:d.t("official_badge_label"),tooltip:a.getOfficialTooltip(this.model)}}})}),define("components/official_badge/index",["require","./src/official_badge"],function(a){"use strict";return a("./src/official_badge")}),define("css!components/search_results/src/pages",[],function(){}),define("stache!components/search_results/src/pages",["mustache"],function(a){var b='{{#visible}}\n  <tbody class="yj-page-search-results--results-body">\n  {{#items}}\n    <tr class="yj-page-search-results--results-row" data-page-id="{{id}}">\n      <td class="yj-page-search-results--page">\n      <div class="yj-page-search-results--content">\n        <div class="yj-page-search-results--header">\n          <a href="{{name_link}}" class="yj-page-search-results--name" data-qaid="name">{{name}}</a>\n          <span class="arrow-right-icon yj-inline-icon yj-align-icon"></span> \n          <span class="yj-page-search-results--group" data-qaid="group">\n            <GroupHovercardLink />\n          </span>\n        </div>\n        <div class="yj-page-search-results--subheader yj-byline" data-qaid="subheader">\n          <OfficialBadge /> {{last_published_by}} <UserHovercardLink /> {{time_ago}}\n        </div>\n        <div class="yj-page-search-results--actions">\n          <a href="{{goto_link}}" class="yj-page-search-results--goto" data-qaid="goto">\n            <i class="yamicon-goto yamicon yj-inline-icon"></i><span>{{goto}}</span>\n          </a>\n        </div>\n      </div>\n      </td>\n    </tr>\n  {{/items}}\n  </tbody>\n{{/visible}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/search_results/src/pages",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","models/user","models/group","collections/groups","components/hovercard_link/index","components/official_badge/index","core/lib/tr","core/lib/date_helper","core/lib/location_helper","core/lib/urls","css!./pages","html!./pages"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("models/user"),g=a("models/group"),h=a("collections/groups"),i=a("components/hovercard_link/index"),j=a("components/official_badge/index"),k=a("core/lib/tr"),l=a("core/lib/date_helper"),m=a("core/lib/location_helper"),n=a("core/lib/urls");a("css!./pages");var o={goto:k.t("page_search_result_row_goto_link"),last_published_by:k.t("page_search_result_row_last_published_by")},p=function(a){return new Date(a.get("last_published_at")||a.get("updated_at"))},q=function(a){return a.get("last_published_by")||a.get("owner_id")||a.get("creator_id")};return c.extend({mixins:[d,e],tagName:"table",className:"yj-page-search-results",template:a("html!./pages"),views:{GroupHovercardLink:"_getGroupHovercardLink",UserHovercardLink:"_getUserHovercardLink",OfficialBadge:"_getOfficialBadge"},events:{"click .yj-page-search-results--results-row":"_clickRow","click .yj-hovercard-link":"_clickLink"},initialize:function(a){this._searchStrategy=a.searchStrategy,this.listenTo(this.collection,"reset add remove",this.render)},getTemplateData:function(){return b.extend({visible:!!this.collection.length,items:this.collection.map(function(a){var b=n.noteIndex(a.attributes);return{id:a.get("id"),name:a.get("name"),name_link:b,time_ago:l.formatAgo(p(a)),goto_link:b,row_link:b,uploader_id:q(a),group_id:a.get("group_id")}})},o)},_getOfficialBadge:function(a){return new j({model:this.collection.at(a)})},_getUserHovercardLink:function(a){var b,c;return c=q(this.collection.at(a)),b=f.findById(c),new i({model:b})},_getGroupHovercardLink:function(a){var b,c;return c=this.collection.at(a).get("group_id"),b=h.get(c),c||(b=g.ALL_COMPANY()),new i({model:b})},_clickRow:function(a){var b=$(a.currentTarget).data("page-id"),c=this.collection.find({id:b});m.assign(n.noteIndex(c.attributes))},_clickLink:function(a){a.stopPropagation()}})}),define("core/lib/search_strategies/pages",["require","underscore","core/lib/yammer_api","core/lib/report","components/search_results/src/pages","models/user","models/network","collections/groups","core/lib/treatment","core/lib/util/hydrant_helper"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/yammer_api"),d=a("core/lib/report"),e=a("components/search_results/src/pages"),f=a("models/user"),g=a("models/network"),h=a("collections/groups"),i=a("core/lib/treatment"),j=a("core/lib/util/hydrant_helper"),k=20,l=function(a){var c=a.pages;return i.treatment("msf_core_p2")?(b.values(a.reference_data.users||{}).forEach(function(b){f.save(j.generateUser(a,b))}),b.values(a.reference_data.groups||{}).forEach(function(b){h.add(j.generateGroup(a,b))}),void b.values(a.reference_data.networks||{}).forEach(function(b){g.save(j.generateNetwork(a,b))})):void c.forEach(function(a){for(var b=a.references||[],c=0;c<b.length;c++){var d=b[c];switch(d.type){case"user":f.save(d);break;case"group":h.add(d);break;case"network":g.save(d)}}})},m=function(a){return{search:a.search,size:k,start:(a.page-1)*k,model_types:"pages",group_ids:a.group_ids}},n=function(a){return b.extend({},a,{search_group:a.group_ids})};return{pageSize:k,fetch:function(a){return i.treatment("msf_core_p2")?(a=m(a),c.searchPagesV2(a).then(function(a){return a.pages=a.pages.map(j.generatePage.bind(null,a)),a})):(a=n(a),a=b.extend({model_types:"Page"},a),d.event("search_performance",a),c.getSearchResults(a))},processPayload:function(a){return l(a),i.treatment("msf_core_p2")?(a.count=a.total_count,a.pages):(a.count=a.count.pages,a.pages)},createResultsContainer:function(){return this._resultsContainer=new e(b.extend({collection:this.collection},this.options)),this._resultsContainer}}}),define("css!components/search_results/src/topics",[],function(){}),define("stache!components/search_results/src/topics",["mustache"],function(a){var b='{{#visible}}\n  {{#items}}\n  {{#start_row}}<div class="yj-topic-search-results--row">{{/start_row}}\n  <div class="yj-topic-search-results--item">\n    <a href="{{link}}" class="yj-topic-search-results--link" data-qaid="topic">{{name}}</a>\n  </div>\n  {{#end_row}}</div>{{/end_row}}\n  {{/items}}\n  </div>\n{{/visible}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/search_results/src/topics",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/urls","css!./topics","html!./topics"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/urls");return a("css!./topics"),b.extend({mixins:[c,d],tagName:"div",className:"yj-topic-search-results",template:a("html!./topics"),initialize:function(a){this._searchStrategy=a.searchStrategy,this.listenTo(this.collection,"reset add remove",this.render)},getTemplateData:function(){return{visible:!!this.collection.length,items:this.collection.map(function(a,b){return{start_row:b%3===0,end_row:(b-2)%3===0,name:a.get("name"),link:e.topicIndex(a)}})}}})}),define("core/lib/search_strategies/topics",["require","underscore","core/lib/yammer_api","core/lib/report","components/search_results/src/topics","core/lib/treatment"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/yammer_api"),d=a("core/lib/report"),e=a("components/search_results/src/topics"),f=a("core/lib/treatment"),g=21,h=function(a){return{search:a.search,size:g,start:(a.page-1)*g,model_types:"topics"}};return{pageSize:g,fetch:function(a){return f.treatment("msf_core_p2")?(a=h(a),c.searchTopicsV2(a).then(function(a){return a.count={topics:a.total_count},a})):(a=b.extend({model_types:"Topic"},a),d.event("search_performance",a),c.getSearchResults(a))},processPayload:function(a){return a.count=a.count.topics,a.topics},createResultsContainer:function(){return this._resultsContainer=new e(b.extend({collection:this.collection},this.options)),this._resultsContainer}}}),define("stache!workfeed/lib/app/views/threads/search",["mustache"],function(a){var b='<div class="page-header" role="region" style="display: block">\n  <div class="header-content">\n    <h2>{{heading}}</h2>\n    <div class="subhead">{{searchingFor}} <strong>{{searchTerm}}</strong></div>\n  </div>\n  <div class="yj-action-bar-with-tabs">\n    <div class="yj-action-bar-tabs" style="display: none"></div>\n  </div>\n</div>\n<div class="yk-row">\n  <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n    <div id="search-results-content" class="search-results-content-container">\n      <div id="tab-messages" class="search-results yj-tab-content"></div>\n      <div id="tab-topics" class="search-results yj-tab-content" style="display: none"></div>\n      <div id="tab-users" class="search-results yj-tab-content" style="display: none"></div>\n      <div id="tab-groups" class="search-results yj-tab-content" style="display: none"></div>\n      <div id="tab-uploaded_files" class="search-results document-search-results yj-tab-content" style="display: none"></div>\n      <div id="tab-pages" class="search-results document-search-results yj-tab-content" style="display: none"></div>\n      <div id="tab-praises" class="search-results yj-tab-content" style="display: none"></div>\n      <div id="tab-polls" class="search-results yj-tab-content"></div>\n    </div>\n    <div class="yj-search-view--spinner yj-spinner" style="display: none">\n      <span class="yj-inline-icon"></span>{{loading}}\n    </div>\n    <div class="yj-search-view--notice notice" style="display: none">{{searchError}}</div>\n  </div>\n  <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6"></div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/threads/search",["require","jquery","underscore","core/lib/backbone_with_auto_render","backbone","core/lib/backbone_base_view","feeds/lib/ui/attachments/file_list","feeds/lib/ui/threads/thread_search_list","feeds/lib/ui/threads/thread_search_list_item_mixin","workfeed/lib/app/search_sidebar","common-ui/lib/ui/shared/tabs","core/lib/report","workfeed/lib/app/helpers/layout","core/lib/string_helper","feeds/lib/ui/util/title_updater","core/lib/tr","core/lib/treatment","core/lib/uri_helper","common-ui/lib/ui/shared/scroll_watcher","components/search/src/paginated_results","core/lib/yammer_api","core/lib/date_helper","core/lib/search_strategies/conversations","core/lib/search_strategies/polls","core/lib/search_strategies/inbox","core/lib/search_strategies/users","core/lib/search_strategies/groups","core/lib/search_strategies/files","core/lib/search_strategies/pages","core/lib/search_strategies/topics","html!./search"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_with_auto_render"),e=a("backbone"),f=a("core/lib/backbone_base_view"),g=a("feeds/lib/ui/attachments/file_list"),h=a("feeds/lib/ui/threads/thread_search_list"),i=a("feeds/lib/ui/threads/thread_search_list_item_mixin"),j=a("workfeed/lib/app/search_sidebar"),k=a("common-ui/lib/ui/shared/tabs"),l=a("core/lib/report"),m=a("workfeed/lib/app/helpers/layout"),n=a("core/lib/string_helper"),o=a("feeds/lib/ui/util/title_updater"),p=a("core/lib/tr"),q=a("core/lib/treatment"),r=a("core/lib/uri_helper"),s=a("common-ui/lib/ui/shared/scroll_watcher"),t=a("components/search/src/paginated_results"),u=a("core/lib/yammer_api"),v=a("core/lib/date_helper"),w=a("core/lib/search_strategies/conversations"),x=a("core/lib/search_strategies/polls"),y=a("core/lib/search_strategies/inbox"),z=a("core/lib/search_strategies/users"),A=a("core/lib/search_strategies/groups"),B=a("core/lib/search_strategies/files"),C=a("core/lib/search_strategies/pages"),D=a("core/lib/search_strategies/topics"),E=a("html!./search"),F={
users:{label:"search_tabs_users",type:"users",target:"#tab-users",searchStrategy:z},groups:{label:"search_tabs_groups",type:"groups",target:"#tab-groups",searchStrategy:A},files:{label:"search_tabs_files",type:"uploaded_files",target:"#tab-uploaded_files",searchStrategy:B},threads:{label:"search_tabs_conversations",type:"messages",target:"#tab-messages",searchStrategy:w},topics:{label:"search_tabs_topics",type:"topics",target:"#tab-topics",searchStrategy:D},praises:{label:"search_tabs_praises",type:"praises"},pages:{label:"search_tabs_pages",type:"pages",target:"#tab-pages",searchStrategy:C},polls:{label:"search_tabs_polls",type:"polls",target:"#tab-polls",searchStrategy:x}},G=function(a){return Object.keys(F).filter(function(b){return F[b].type===a})[0]},H=function(a){return 0===a.search_group&&(a.search_group_name=p.t("all_company")),new j({model:{MAX_SEARCH_INPUT_LENGTH:500,advanced_search:p.t("advanced_search"),search_for:p.t("search_for"),group_in:p.t("in"),date_between:p.t("between"),search_label:p.t("search"),search:a.search||"",start_date:decodeURIComponent(a.search_startdate||""),end_date:decodeURIComponent(a.search_enddate||""),group_selected:a.search_inbox||a.search_group>-1,inbox:a.search_inbox?1:0,group_id:a.search_group,group_name:a.search_group_name||p.t("inbox")}})};return f.extend({mixins:[d],template:E,className:m.twoColumnMainClass,attributes:{role:"main"},events:{"click .hacky-pagination-link":"_onPaginationClick"},validSearchOpts:["page","num_per_page","type","search_user","search_group","search_inbox","search_startdate","search_enddate","search_sort","model_type","ymodule_app_ids","search_source"],tabOrder:["polls","praise","events","topics","pages","uploaded_files","groups","users","messages"],FACET_TYPE_YMODULE:"ymodule_application",FACET_TYPE_CLIENT:"client_application",FACET_TYPE_PRAISE:"praise",initialize:function(){this._msf=q.treatment("make_search_fast_ab"),this.$search=b("#search").val("").blur(),setTimeout(function(){b("html,body").animate({scrollTop:0},1)},100),c.bindAll(this,"_tabData","_summaryResults","_sortTabs","_processSummary","_onPaginationClick","_displaySearchResultsMarkup","_displaySearchResultsError","_handleTabClick","_handleTabSwitch","_updatePage","_initialRequests","_addSidebar"),this._paginatedResults={},this.searchFilters=this._getSearchFilters(),o.setTitle(p.t("search")+": "+this.options.search)},render:function(){return this.buildComponents(),this._msf?(this._showSpinner(),window.setTimeout(this._initialRequests,0)):this._createNewSearchList(this.searchFilters,!0),this},_initialRequests:function(){this.options.search_inbox?this._hideSpinner():this._summarySearch(),this._paginatedResults.threads=this._createPaginatedResults("threads")},_showSpinner:function(){clearTimeout(this._spinTimeout),this._spinTimeout=setTimeout(function(){this.$(".yj-search-view--spinner").show()}.bind(this),400)},_hideSpinner:function(){clearTimeout(this._spinTimeout),this.$(".yj-search-view--spinner").hide()},getAppContentContainer:function(a){return a||this.$("#tab-messages")},_getSearchFilters:function(){for(var a={},b=0,c=this.validSearchOpts.length;c>b;++b){var d=this.validSearchOpts[b];this.options.hasOwnProperty(d)&&(a[d]=this.options[d])}return a},_createNewSearchList:function(a,b){this.resetSearchList(),this.searchList=new h({settings:{renderTabs:!!b,search:this.options.search||"",searchFilters:a}},this),this.listenTo(this.searchList,"results-to-render",this._renderTabs),this.listenTo(this.searchList,"list-rendered",this._updateInfiniteScroll),this.searchList.render(),this.$(this.getSearchListTarget(a)).append(this.searchList.$el)},_createPaginatedResults:function(a){var b=c.extend(this._searchParams(),{group_ids:this.options.search_group,search:this.options.search,search_startdate:this.options.search_startdate,search_enddate:this.options.search_enddate}),d=c.extend({},F[a],{queryOptions:b});this.options.search_inbox&&(d.searchStrategy=y);var e=new t(d);return this.listenTo(e,"paginate",this._updatePage),this.listenTo(e,"loading",this._showSpinner),this.listenTo(e,"loaded",this._hideSpinner),e.$el.appendTo(this.$(F[a].target)),e.render(),e.fetch(),e},_summarySearch:function(){u.getSearchSummary({search:this.options.search,group_ids:this.options.search_group,start_date:v.formatStringTime(this.options.search_startdate),end_date:v.formatStringTime(this.options.search_enddate)}).then(this._summaryResults)},_summaryResults:function(a){this._renderTabs(a)},_renderTabs:function(a){var b;b=this._msf?this._getTabSummaries(a):this._getTabSummariesFromWorkfeed(a),b=b.sort(this._sortTabs),this._drawTabs(b),this._addHovercards()},_getTabSummaries:function(a){return a&&a.summaries?a.summaries.filter(function(a){return!!a.count}).map(this._processSummary):[]},_getTabSummariesFromWorkfeed:function(a){var b=a.count;if(!b)return[];var d=c.map(b,this._tabData);return d},_tabData:function(a,b){var c=a.client_app_id?"tab-messages":"tab-"+b,d=a.yapp_id&&a.yapp_id==this.searchFilters.ymodule_app_ids,e=a.label,f=F[G(b)];return f&&f.label&&(e=p.t(f.label)),q.treatment("tow_header_standardization")||(e=e+" ("+a.count+")"),{label:e,tabId:c,selected:d,yapp_id:a.yapp_id,type:b,count:a.count,client_app_id:a.client_app_id}},_processSummary:function(a){var b=this._getTabType(a),c=this._getTabLabel(a);q.treatment("tow_header_standardization")||(c=c+" ("+a.count+")");var d={label:c,tabId:this._getTabId(a),count:a.count,type:b,selected:this.options.tab===b};return"polls"===a.id&&(d.yapp_id=2),d},_getTabLabel:function(a){var b=F[a.id];return p.t(b&&b.label||"search_tabs_unknown")},_getTabType:function(a){var b=F[a.id];return b&&b.type||"unknown"},_getTabId:function(a){return"file"===a.id?"tab-uploaded_files":"tab-"+this._getTabType(a)},_sortTabs:function(a,b){return this.tabOrder.indexOf(b.type)-this.tabOrder.indexOf(a.type)},_drawTabs:function(a){var b={tabs:a};this.tabs&&this.tabs.remove(),this.tabs=new k({onTabClick:this._handleTabClick,onTabSwitch:this._handleTabSwitch,fetch:a.fetch,className:"yj-tabs search-results-tab",settings:{elementClassName:"search-results-tab",tabContent:".search-results-content-container",maxTabs:this._getMaxTabsCount()},data:b}),this.setupResponsiveTabs();var d=c.reduce(a,function(a,b){return a+b.count},0),f=c.escape(this.options.search);this.$(".header-content .subhead").html(p.t("count_total_results_for",{count:d})+" <strong>"+f+"</strong>"),this.$(".page-header").addClass("has-tabs"),this.$(".yj-action-bar-tabs").append(this.tabs.render().$el).show(),e.trigger("/ui/reflow/vertical"),this._showSelectedTab(a)},_showSelectedTab:function(a){if(a.length){var b=a.filter(function(a){return!!a.selected})[0];b||(b=a[0]),"messages"!==b.type&&(this.tabs.onTabSwitch(this.$('[data-tab-id="'+b.tabId+'"]')),this.tabs.handleTabSwitch(b.tabId))}},_addHovercards:function(){this.$(".yammer-object, .yj-hovercard-link").each(c.bind(function(a,d){var f=b(d),g=f.data("resource-model")||"user",h=f.data("resource-id"),j={parent:this};c.extend(j,i),j.getEntityModel=j.getEntityModel.bind(j,g),j.getIndex=c.bind(function(){return f.parents("tr").data("index")},j),e.trigger("/ui/hovercard/add",f,{id:h,type:g,decorator:{qs:j.getHoverCardQueryString.bind(j,{id:h,type:g})}})},this))},_updateInfiniteScroll:function(){return this.searchList.hasOlderItems?void(this.scrollWatcher?this._restartScrollWatcher():this._createScrollWatcher()):void this._stopScrollWatcher()},_createScrollWatcher:function(){this.scrollWatcher=new s({$scrollableArea:this.$el,$contentArea:this.searchList.$el,onReached:this.searchList.fetchMore}),this.scrollWatcher.start()},_restartScrollWatcher:function(){this.scrollWatcher.restart()},_stopScrollWatcher:function(){this.scrollWatcher&&this.scrollWatcher.stop()},getTemplateData:function(){var a=this.options.search;return{heading:a?p.t("search_results"):p.t("no_search_term_provided"),searchingFor:p.t("searching_for"),searchTerm:a,searchError:p.t("search_error"),loading:p.t("loading")}},buildComponents:function(){var a=this.options;a.search_group?u.getGroup({id:a.search_group}).then(function(b){a.search_group_name=b.full_name,this._addSidebar()}.bind(this)):this._addSidebar()},_addSidebar:function(){var a=this,b=H(this.options);this.listenTo(b,"search",function(b){b=r.paramify(c.extend(a.searchFilters,b)),yam.router.navigate("/Threads/Search?"+b,{replace:!0,trigger:!0})}),this.$(".yj-selector-right-sidebar").append(b.render().$el),this._sidebar=b},_onPaginationClick:function(a){var b=this.$(a.target),c=this._paginationData(b);c=h.enhanceParams(c);var d={page:c.page,model_type:c.model_type,contentId:b.data("update-id")},e=this._displayPaginatedResults.bind(this,d);u.getSearchResultsTab(c).then(e,this._displaySearchResultsError),a.preventDefault()},_displayPaginatedResults:function(a,c){a.contentId&&"tab-uploaded-files"===a.contentId&&(a.contentId="tab-uploaded_files");var d=b("#"+a.contentId);this.$clientAppResults=b("<div/>").append(c),this.$clientAppResults=this.$clientAppResults.contents(),d.empty().append(this.$clientAppResults),"UploadedFile"===a.model_type&&g.bless(jQuery("#"+a.contentId+" .yj-search-list")),e.trigger("/ui/hovercard/build",d,".yj-hovercard-link"),window.scrollTo(0,0),this._updatePage(a.page)},_updatePage:function(a){a=parseInt(a,10),this.options.page=a,this._updateUrlWithParam("page",a)},_updateUrlWithParam:function(a,b){var c=r.replaceParam(e.history.fragment,a,b);yam.router.navigate(c,{replace:!0,silent:!0})},_paginationData:function(a){return{model_type:a.data("model-type"),page:a.data("page"),search:a.data("search"),facet_type:a.data("facet-type"),facet_id:a.data("facet-id")}},setupResponsiveTabs:function(){b(window).on("resize.searchTabs",c.debounce(c.bind(function(){this.tabs&&(this.tabs.settings.maxTabs=this._getMaxTabsCount(),this.tabs.render())},this),100))},_getMaxTabsCount:function(){return b(window).width()<=1219?5:6},_handleTabClick:function(a){this._hideSpinner(),this._updatePage(1);var b=a.attr("data-type");this._updateUrlWithParam("tab",b),l.event("search_tab_click",{type:b})},_handleTabSwitch:function(a){var b,c=a.data("ymod-app-id"),d=a.data("client-app-id"),e=a.data("type")&&"praises"===a.data("type"),f=a.data("type"),g=G(f),h={users:1,groups:1,uploaded_files:1,pages:1,topics:1};if(this.$(".yj-search-view--notice").hide(),this.resetSearchList(),h[f])switch(f){case"users":case"groups":case"uploaded_files":case"pages":case"topics":b=this._paginatedResults[g],b?b.fetchFirstPage():this._paginatedResults[g]=this._createPaginatedResults(g);break;default:"file"===g&&(g="UploadedFile"),"topics"===g&&(g="Topic"),g=n.capitalize(n.camelize(g)),this.tabSwitchToApplication({type:g,tabName:"tab-"+f,tab:a})}else c?this._msf?this._PaginatedPollResults?this._PaginatedPollResults.fetchFirstPage():this._PaginatedPollResults=this._createPaginatedResults("polls"):this.tabSwitchToApplication({type:this.FACET_TYPE_YMODULE},c):d?this.tabSwitchToApplication({type:this.FACET_TYPE_CLIENT},d):e?this.tabSwitchToApplication({type:this.FACET_TYPE_PRAISE}):"threads"===g&&(this._msf?this._paginatedResults[g].fetchFirstPage():this._createNewSearchList(this.searchFilters,!0))},tabSwitchToApplication:function(a,b){var d={facet_type:a.type,facet_id:b||"",search:this.options.search||""};switch(d=c.extend({},this._getSearchFilters(),d),a.type){case this.FACET_TYPE_YMODULE:this._createNewSearchList(d);break;case this.FACET_TYPE_PRAISE:this._createNewSearchList(d);break;case this.FACET_TYPE_CLIENT:this.requestSearchResultsMarkup(d);break;default:delete d.facet_type,delete d.facet_id,d.model_type=a.type;var e=[d];a.tabName&&e.push({tabName:a.tabName,tab:a.tab}),this.requestSearchResultsMarkup.apply(this,e)}},resetSearchList:function(){this.searchList&&(this.stopListening(this.searchList),this.searchList.reset(),this.searchList.remove()),this.$clientAppResults&&this.$clientAppResults.remove()},getSearchListTarget:function(a){return a&&"ymodule_application"===a.facet_type?"#tab-polls":a&&"praise"===a.facet_type?"#tab-praises":"#tab-messages"},requestSearchResultsMarkup:function(a,b){a=this._searchParams(a);var c=this._displaySearchResultsMarkup;b&&b.tabName&&(c=c.bind(this,b)),this._showSpinner(),u.getSearchResultsTab(a).then(c,this._displaySearchResultsError)},_displaySearchResultsMarkup:function(){var a,c,d;this._hideSpinner(),4===arguments.length?(c=arguments[0],a=arguments[1],d=b("#"+c.tabName)):(a=arguments[0],d=null),this.$clientAppResults=b("<div/>").append(b(a)),this.$clientAppResults=this.$clientAppResults.contents(),this.getAppContentContainer(d).empty().append(this.$clientAppResults)},_displaySearchResultsError:function(){this._hideSpinner(),this.$(".yj-search-view--notice").show()},remove:function(){this.resetSearchList(),b(window).off("resize.searchTabs"),this.scrollWatcher&&this.scrollWatcher.stop();for(var a in this.paginatedResults)this.paginatedResults[a].remove();return this._PaginatedPollResults&&this._PaginatedPollResults.remove(),this.tabs&&this.tabs.remove(),this._sidebar&&this._sidebar.remove(),f.prototype.remove.call(this)},_searchParams:function(a){return c.extend({},a,{scoring:"linear1Y-prankie-group-private-higher",match:"any-exact",search_sort:"relevance",page:a&&a.page||this.options.page})}})}),define("css!feeds/lib/ui/conversations/conversation_participants",[],function(){}),define("stache!feeds/lib/ui/conversations/conversation_participants",["mustache"],function(a){var b='<h2 class="yj-conversation-participants--header">{{header}}</h2>\n<div class="yj-conversation-participants--add">\n  <label>\n      <span class="yj-acc-hidden">{{label}}</span>\n      <input class="yj-conversation-participants--add-input yj-participants-add" placeholder="{{label}}" type="text" aria-haspopup="true" aria-autocomplete="list"/>\n  </label>\n</div>\n<ul class="yj-conversation-participants--list">\n  {{#participants}}\n    {{#isPlaceholder}}\n      <li class="yj-conversation-participants--placeholder">\n        <img class="yj-conversation-participants--mugshot" src="https://mug0.staging.assets-yammer.com/mugshot/images/48x48/no_photo.png" alt="{{name}}" />\n        {{name}}\n      </li>\n    {{/isPlaceholder}}\n    {{^isPlaceholder}}\n      <li class="yj-conversation-participants--item">\n        <a class="yj-conversation-participants--item-link yj-hovercard-link" href="{{web_url}}" data-resource-id="{{id}}" data-qaid="participants-links">\n          <img class="yj-conversation-participants--mugshot" src="{{mugshot_url}}" alt="{{fullName}}"/>\n          {{fullName}}\n        </a>\n      </li>\n    {{/isPlaceholder}}\n  {{/participants}}\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/conversations/conversation_participants",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/tr","core/lib/yammer_api","models/lib/orm-models","core/lib/util/email_extractor","common-ui/lib/ui/shared/type_ahead","models/helpers/user","core/lib/report","css!./conversation_participants","html!./conversation_participants"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("backbone"),f=a("core/lib/tr"),g=a("core/lib/yammer_api"),h=a("models/lib/orm-models"),i=a("core/lib/util/email_extractor"),j=a("common-ui/lib/ui/shared/type_ahead"),k=a("models/helpers/user"),l=a("core/lib/report"),m=6e4,n={generic_error:f.t("error_adding_new_recipient_to_conversation"),recipient_already_added:f.t("recipient_already_added"),invalid_email_address:f.t("looks_like_you_entered_an_incomplete_email_address"),recipient_outside_of_network:f.t("you_are_trying_to_post_to_someone_that_is_not_in_your_network"),recipient_not_invitable:f.t("looks_like_youre_trying_to_include_a_colleagues_personal_email_address")};return a("css!./conversation_participants"),c.extend({mixins:[d],className:"yj-conversation-participants",attributes:{"data-qaid":"conversation-participants"},header:f.t("participants"),label:"+ "+f.t("add_participants"),events:{"focus .yj-conversation-participants--add-input":"_clearSearch","blur .yj-conversation-participants--add-input":"_clearSearch"},template:a("html!./conversation_participants"),initialize:function(a){b.bindAll(this,"_requestThreadUpdate","_threadUpdated","_participantRemoved","_onNewParticipantSelect","_onNoParticipantSelect","_addNewParticipantSuccess","_addNewParticipantError"),this.data=a.data,this.participants={},this._loadParticipants(this.data),this._startPoll(),this._emailExtractor=new i,this.listenTo(e,"threadinfo-updated",this._threadUpdated),this.listenTo(e,"/feed/threads/participants/removed",this._participantRemoved)},getTemplateData:function(){var a=h.User(),c=b.map(this.participants,function(c){var d=c;if(!d.isPlaceholder){var e=a.findById(c.id);e||(e=a.save(c)),d=b.extend({fullName:k.getFullName(e)},e)}return d});return{label:this.label,header:this.header,participants:c}},render:function(){return this.$search=this.$el.find(".yj-conversation-participants--add-input"),this._createTypeAhead(),this._createHovercards(),this},remove:function(){return this._destroyTypeAhead(),this._stopPoll(),c.prototype.remove.call(this)},_createTypeAhead:function(){var a={onSelect:this._onNewParticipantSelect,onNoSelection:this._onNoParticipantSelect,labelText:this.label,prepend_to_search:"@",displayHeaders:!1,completableModels:[j.MODEL_USER,j.MODEL_DOMAIN],customClassName:"participants-tagger",allowForeignUsers:!0,allowForeignEmails:!0};j.registerField(this.$search,a)},_destroyTypeAhead:function(){j.removeField(this.$search)},_createHovercards:function(){e.trigger("/ui/hovercard/build",this.$el,".yj-hovercard-link",{orientation:"left"})},_showError:function(a){var b=n.generic_error;a&&(b=n[a]||n.generic_error),e.trigger("/ui/alert/show","error",b)},_focusOnSearch:function(){return this.$search.blur().focus()},_enableSearch:function(){return this.$search.prop("disabled",!1)},_disableSearch:function(){return this.$search.prop("disabled",!0)},_clearSearch:function(){return this.$search.val("")},_onNewParticipantSelect:function(a){return l.event("rr_private_message_add_participants"),this._alreadyParticipant(a)?void this._addNewParticipantError({errorCode:"recipient_already_added"}):(this._disableSearch(),this._stopPoll(),this._addNewParticipantLocal(a),void this._addNewParticipantRemote(a))},_onNoParticipantSelect:function(a){if(this._emailExtractor.isEmail(a)){var b={id:a,name:a,type:"domain"};this._disableSearch(),this._stopPoll(),this._addNewParticipantLocal(b),this._addNewParticipantRemote(b)}},_alreadyParticipant:function(a){return null!=this.participants[a.id]},_addNewParticipantLocal:function(a){this.participants[a.id]=b.extend({isPlaceholder:!0},a),this.newParticipant=a,this.render()},_removeNewParticipantLocal:function(){delete this.participants[this.newParticipant.email]},_addNewParticipantRemote:function(a){g.addThreadParticipant({threadId:this.data.threadId,include_user_ids:a.id}).then(this._addNewParticipantSuccess,this._addNewParticipantError)},_addNewParticipantError:function(a,b){var c=a.errorCode||a.responseJSON.errors[0];this._removeNewParticipantLocal(),this._showError(c),this._enableSearch(),b||this._focusOnSearch(),this._startPoll()},_addNewParticipantSuccess:function(a,b){this._enableSearch(),b||this._focusOnSearch(),this._requestThreadUpdate(),this._startPoll()},_loadParticipants:function(a){var c=0;return this.participants=b.reduce(a.participants,function(a,b){var d=this.participants[b.id];return d&&!d.isPlaceholder||(c+=1),a[b.id]=b,a},{},this),c},_startPoll:function(){this._stopPoll(),this.pollTimeout=setTimeout(this._requestThreadUpdate,m)},_stopPoll:function(){"number"==typeof this.pollTimeout&&(clearTimeout(this.pollTimeout),delete this.pollTimeout)},_requestThreadUpdate:function(){g.getThreadInfo({thread_id:this.data.threadId}).then(this._threadUpdated)},_threadUpdated:function(a){this._updateFromThread(a),this._startPoll()},_participantRemoved:function(a){var b=h.Thread().findById(a);this._updateFromThread(b,!0)},_updateFromThread:function(a,b){this._updateReferencesInORM(a);var c=this._loadParticipants(a);(c>0||b)&&this.render()},_updateReferencesInORM:function(a){var c=h.User(),d=h.Thread(),e=b.union(a.references||[],a.external_references||[]);b.each(e,function(a){"user"===a.type&&c.save(a)}),d.save(a)}})}),define("css!feeds/lib/ui/threads/thread_attachments",[],function(){}),define("stache!feeds/lib/ui/threads/thread_attachments",["mustache"],function(a){var b='<h2 class="yj-thread-attachments--header" role="heading" aria-level="2">{{label}}</h2>\n<ul></ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/threads/thread_attachments",["require","models/lib/events","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","models/helpers/attachment","css!./thread_attachments","html!./thread_attachments"],function(a){var b=a("models/lib/events"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/tr"),g=a("models/helpers/attachment");a("css!./thread_attachments");var h=d.extend({className:"content",defaults:{label:f.t("attachments"),hideOnEmpty:!0,attachmentType:""},mixins:[e],template:a("html!./thread_attachments"),initialize:function(a){if(c.extend(this,this.defaults,a),!this.data.threadId)throw new Error("ThreadAttachments - data.threadId not set");this.attachments={},this._addAttachmentsToIndex(this.data.attachments),this.listenTo(b,"Message/create",this.onMessageCreate.bind(this)),this.listenTo(b,"Message/destroy",this.onMessageDestroy.bind(this))},getTemplateData:function(){return this.hideOnEmpty&&this.data.attachments.length<1&&this.$el.hide(),this},onMessageCreate:function(a){var b=a.getThread();if(b&&this.data.threadId===b.id){var c=this._filterAttachments(a.getAttachments());c.length>0&&this.addAttachments(c)}},onMessageDestroy:function(a){var b=a.getThread();if(b.id===this.data.threadId){var d=this._typedAttachments(a.getAttachments()),e=c.filter(d,function(d){return!c.any(g.getMessages(d),function(c){return c&&c.id!==a.id&&c.getThread().id===b.id})});this.removeAttachments(e)}},_filterAttachments:function(a){return this._newAttachments(this._typedAttachments(a))},_typedAttachments:function(a){for(var b=[],c=0,d=a.length;d>c;c++)"file"===this.attachmentType&&b.push(a[c]);return b},_newAttachments:function(a){for(var b=[],c=0,d=a.length;d>c;c++)this.attachments[a[c].id]||b.push(a[c]);return b},addAttachments:function(a){this._addAttachmentsToIndex(a),this.isVisible()||this.show()},removeAttachments:function(a){this._removeAttachmentsFromIndex(a);for(var b=0,c=a.length;c>b;b++)this.$el.find('[data-id="'+a[b].id.toString()+'"]').remove();0===this._getAttachments().length&&this.hide()},_getAttachments:function(){var a=[];for(var b in this.attachments){var c="file"===this.attachments[b].type||"image"===this.attachments[b].type;this.attachments.hasOwnProperty(b)&&c&&a.push(this.attachments[b])}return a},_addAttachmentsToIndex:function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];this.attachments[d.id]=d}},_removeAttachmentsFromIndex:function(a){for(var b=0,c=a.length;c>b;b++)this.attachments.hasOwnProperty(a[b].id)&&delete this.attachments[a[b].id]},prepViewData:function(){return{className:this.attachmentType+"s "+this.className,label:this.label}}});return h}),define("feeds/lib/ui/threads/thread_files",["require","underscore","feeds/lib/ui/attachments/file_list","feeds/lib/ui/threads/thread_attachments","core/lib/filename_helper","core/lib/report","core/lib/tr"],function(a){var b=a("underscore"),c=a("feeds/lib/ui/attachments/file_list"),d=a("feeds/lib/ui/threads/thread_attachments"),e=a("core/lib/filename_helper"),f=a("core/lib/report"),g=a("core/lib/tr");return d.extend({_defaults:{label:g.t("files_header_for_files_list"),attachmentType:"file"},className:"yj-conversation--files",events:{"click .yj-name a":"_clickHandlerLinkName","click .yj-action .yamicon-add-search":"_clickHandlerPreviewFile","click .yj-action .yamicon-download":"_clickHandlerDownloadFile","click .yj-action .yamicon-goto":"_clickHandlerGoToFile"},initialize:function(){d.prototype.initialize.apply(this,arguments),b.extend(this,this.defaults,this._defaults)},_clickHandlerLinkName:function(){f.event("rr_message_view_files",{event_action:"click_filename"})},_clickHandlerPreviewFile:function(){f.event("rr_message_view_files",{event_action:"preview_file"})},_clickHandlerDownloadFile:function(){f.event("rr_message_view_files",{event_action:"download_file"})},_clickHandlerGoToFile:function(){f.event("rr_message_view_files",{event_action:"goto_file"})},getItemClassName:function(a){return"document-"+e.getCanonicalExtension(a.name)+"-icon"},remove:function(){this._fileList&&this._fileList.destroy(),d.prototype.remove.apply(this,arguments)},render:function(){d.prototype.render.apply(this),this._fileList=new c,this.$el.find("ul").replaceWith(this._fileList.render());var a=this._getAttachments();return this._fileList.setFiles(a),this},addAttachments:function(a){this._addAttachmentsToIndex(a),a=this._getAttachments(),this._fileList.setFiles(a),a.length>0&&this.$el.show()},removeAttachments:function(a){this._removeAttachmentsFromIndex(a),a=this._getAttachments(),this._fileList.setFiles(a),0===a.length&&this.$el.hide()}})}),define("stache!feeds/lib/ui/inbox/inbox_follow_link",["mustache"],function(a){var b='<span class="yamicon yamicon-flag yamicon-inline yamicon-x-small"></span>\n<span class="yj-follow-thread-in-inbox--label">{{label}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/inbox/inbox_follow_link",["require","core/lib/inbox_follow_delegate","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","core/lib/treatment","html!./inbox_follow_link"],function(a){var b=a("core/lib/inbox_follow_delegate"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/tr"),f=a("core/lib/treatment"),g=a("html!./inbox_follow_link");return c.extend({mixins:[d],tagName:"a",className:"yj-quick-link yj-follow-thread-in-inbox",attributes:{href:"javascript://"},events:{click:"_onClick"},template:g,labels:{follow:e.t("follow_in_inbox"),unfollow:e.t("stop_following_in_inbox")},initialize:function(a){this.thread=a&&a.data?a.data.thread:null,this._inboxFollowDelegate=new b({model:this.thread}),this.listenTo(this._inboxFollowDelegate,"follow unfollow",this.render)},getTemplateData:function(){f.usePriorityCopy()&&(this.labels.follow=e.t("mark_as_priority"),this.labels.unfollow=e.t("remove_from_priority"));var a=this.thread.isFollowedInInbox()?this.labels.unfollow:this.labels.follow;return{label:a}},remove:function(){this._inboxFollowDelegate.remove(),c.prototype.remove.call(this)},_onClick:function(){this._inboxFollowDelegate.toggleFollow()}})}),define("css!feeds/lib/ui/threads/thread_sidebar",[],function(){}),define("stache!feeds/lib/ui/threads/thread_sidebar",["mustache"],function(a){var b='{{#showQuickLinks}}\n  <div class="yj-conversation--actions">\n    <h2 class="yj-conversation--actions-header">\n      {{label}}\n    </h2>\n    <ul class="yj-conversation--quick-links yj-quick-links-list yj-clearfix">\n      <li class="yj-conversation--actions-list yj-thread-sidebar--inbox-follow"></li>\n    </ul>\n  </div>\n{{/showQuickLinks}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/threads/thread_sidebar",["require","jquery","underscore","core/lib/backbone_legacy_integration","feeds/lib/ui/conversations/conversation_participants","models/thread","feeds/lib/ui/threads/thread_files","feeds/lib/ui/inbox/inbox_follow_link","core/lib/tr","core/lib/yammer_api","css!./thread_sidebar","html!./thread_sidebar"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_legacy_integration"),e=a("feeds/lib/ui/conversations/conversation_participants"),f=a("models/thread"),g=a("feeds/lib/ui/threads/thread_files"),h=a("feeds/lib/ui/inbox/inbox_follow_link"),i=a("core/lib/tr"),j=a("core/lib/yammer_api");return a("css!./thread_sidebar"),d.extend({id:"threadSidebar",className:"yj-thread-sidebar",template:a("html!./thread_sidebar"),attributes:{role:"complementary"},initialize:function(a){c.extend(this,a),this.removedFromDom=!1,this.gotThreadInfo=!1},render:function(){var a=this.renderTemplate({label:i.t("conversation_actions"),showQuickLinks:this.showInboxFollowLink});return this.target&&b(this.target).append(a),this.gotThreadInfo||j.getThreadInfo({thread_id:this.model.threadId}).then(this.handleThreadInfo.bind(this)),this},remove:function(){return this.removedFromDom=!0,this},_createInboxFollowLink:function(a){return new h({data:{thread:a}})},handleThreadInfo:function(a){if(!this.removedFromDom){this.gotThreadInfo=!0;var b=this.prepViewData(a),c=this.model.threadId,d=f.save(a);d.direct_message&&this.append(new e({data:{participants:b.participants,threadId:c}})),this.showInboxFollowLink&&this.append(this._createInboxFollowLink(d),".yj-thread-sidebar--inbox-follow");var h=b.files.concat(b.images);this.append(new g({data:{attachments:h,threadId:c}})),this.render()}},_splitReferences:function(a){var b,c,d={},e=[],f=[],g={};a=a||[];for(var h=0,i=a.length;i>h;h++)b=a[h].type,c=a[h].id,"user"===b?d[c]=a[h]:"topic"===b?g[c]=a[h]:"file"===b?e.push(a[h]):"image"===b&&f.push(a[h]);return{users:d,files:e,images:f,topics:g}},prepViewData:function(a){yam.modelController&&yam.modelController.onThreadInfo&&yam.modelController.onThreadInfo(a);var b=a.references.concat(a.external_references||[]),d=this._splitReferences(b),e={users:d.users,files:d.files,images:d.images,topics:d.topics};return e.participants=c.map(a.participants,function(a){return e.users[a.id]}),e.topics=c.map(a.topics,function(a){return e.topics[a.id]}),{participants:e.participants,files:e.files,images:e.images,topics:e.topics,privacy:a.privacy}}})}),define("common-ui/lib/ui/shared/scrolling_type_ahead",["require","underscore","core/lib/jam/component2","core/lib/ctor","core/lib/string_helper","core/lib/tr","common-ui/lib/ui/shared/tag_list","common-ui/lib/ui/shared/type_ahead","jquery-watermark"],function(a){var b=a("underscore"),c=a("core/lib/jam/component2"),d=a("core/lib/ctor"),e=a("core/lib/string_helper"),f=a("core/lib/tr"),g=a("common-ui/lib/ui/shared/tag_list"),h=a("common-ui/lib/ui/shared/type_ahead");return a("jquery-watermark"),d(null,c,{id:"scrollingTypeAhead",typeAheadOptions:{maxResults:20,completableModels:["user"],hintMessage:""},hintMessage:f.t("name"),selectedCls:"yj-scrolling-ta-selected",disabledCls:"yj-scrolling-ta-disabled",events:{"click .yj-scrolling-ta-button":"launchTypeAhead"},template:'<div class="yj-scrolling-ta yj-clearfix">        <span class="yj-scrolling-ta-input-container">          <input type="text" class="yj-scrolling-ta-input" />        </span>        <div class="yj-scrolling-ta-button"><div class="yj-down-arrow"></div></div>      </div>',init:function(a,b){c.prototype.init.call(this,a,b),a&&a.typeAheadOptions&&a.typeAheadOptions.defaultEntry&&(this._defaultEntry=a.typeAheadOptions.defaultEntry)},onLoad:function(){this._attached=!1;var a=function(a,b){this.handleRemoveClick(a,b)};this.tagList=new g({itemTemplate:"userTemplate",className:"yj-tag-list-lg",removeHandler:a.bind(this)})},onRendered:function(){this.$el.find(".yj-scrolling-ta-input-container").append(this.tagList.render().$el),this.$input=this.$el.find(".yj-scrolling-ta-input"),this.$input.watermark(this.hintMessage),this.registerTypeAhead(),this._defaultEntry&&this.handleEntrySelect(this._defaultEntry)},launchTypeAhead:function(){this.$el.hasClass(this.disabledCls)||this.$el.hasClass(this.selectedCls)||this.$input.focus()},registerTypeAhead:function(){var a={scrollResults:!0,showTopRankings:!0,onSelect:this.handleEntrySelect.bind(this),accessFilter:"post"},c=b.extend({},this.typeAheadOptions,a);h.registerField(this.$input,c)},unregisterTypeahead:function(){h&&h.removeField(this.$input)},destroy:function(){this.unregisterTypeahead(),c.prototype.destroy.call(this);
},val:function(){return this.tagList.tags},handleEntrySelect:function(a){this.$input.hide(),this._selectEntry(a),this.unregisterTypeahead(),this.trigger("validation",!0)},handleRemoveClick:function(a,b){b.call(this.tagList),this.clearSelection()},_selectEntry:function(a){var b=a.full_name||a.name;a.truncName=e.truncate(b||"",22),this.tagList.addTags(a),this.$el.addClass(this.selectedCls)},clearSelection:function(){this.tagList.isEmpty()||this.tagList.clear(),this.$input.val(""),this.$input.show(),this.$el.removeClass(this.selectedCls),this.registerTypeAhead(),this.trigger("validation",!1)},disable:function(){this.$el.addClass(this.disabledCls),this.$input.attr("disabled","disabled")},enable:function(){this.$el.removeClass(this.disabledCls),this.$input.removeAttr("disabled")}})}),define("stache!feeds/lib/ui/inbox/move_dialog",["mustache"],function(a){var b='<div class="yj-move-dialog--participants" data-section-id="group">\n  {{#participants}}\n  <div class="yj-move-dialog--participants-list">\n    <span class="yj-move-dialog--participants-label">{{participantsMessage}}</span>\n    <span class="yj-move-dialog--visible-participants">\n      {{#visibleParticipants}}{{^noComma}}, {{/noComma}}{{full_name}}{{/visibleParticipants}}{{#othersText}}, and\n      <a class="yj-move-dialog--others-link" href="#" role="button">{{othersText}}</a></span>{{/othersText}}</span>.\n  </div>\n  {{/participants}}\n  <label class="yj-move-dialog--group-selector">\n    <span class="yj-move-dialog--group-selector-label">{{moveText}}</span>\n    <div class="yj-move-dialog--group-selector-dropdown yj-share-publisher-{{id}}-bar"></div>\n  </label>\n</div>\n<div class="yj-move-dialog--excerpt"></div>\n<div class="yj-move-dialog--submit">\n  <div class="yj-move-dialog--warning-icon yamicon {{icon}}"></div>\n  <div class="yj-move-dialog--warning-text">\n    {{smallPrint}}\n  </div>\n  <button class="yj-move-dialog--submit-button yj-btn yj-btn-disabled" disabled>{{shareButtonText}}</button>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/inbox/move_dialog",[],function(){}),define("feeds/lib/ui/inbox/move_dialog",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","mustache","common-ui/lib/helper/ui","common-ui/lib/ui/shared/scrolling_type_ahead","common-ui/lib/ui/shared/type_ahead","core/lib/model_helper","core/lib/tr","backbone","models/helpers/conversation","core/lib/session","html!./move_dialog","css!./move_dialog","models/group"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_legacy_subviews"),g=a("core/lib/backbone_with_subviews"),h=a("mustache"),i=a("common-ui/lib/helper/ui"),j=a("common-ui/lib/ui/shared/scrolling_type_ahead"),k=a("common-ui/lib/ui/shared/type_ahead"),l=a("core/lib/model_helper"),m=a("core/lib/tr"),n=a("backbone"),o=a("models/helpers/conversation"),p=a("core/lib/session"),q=a("html!./move_dialog");a("css!./move_dialog");var r=d.extend({mixins:[e,f,g],className:"yj-move-dialog",template:q,events:{"click .yj-move-dialog--submit-button":"_postMessage","click .yj-move-dialog--others-link":"_showHiddenParticipants"},initialize:function(a){this.model=a.model,this._createGroupSelector()},getTemplateData:function(){var a=this._getParticipants();return{moveText:m.t("move_this_conversation_to"),smallPrint:m.t("this_conversation_will_be_visible_to_anyone_in_your_network"),icon:"yamicon-circle-italic",participants:a,hiddenParticipants:this._hiddenParticipantList,shareButtonText:m.t("move")}},render:function(){return this.$shareButton=this.$(".yj-move-dialog--submit-button"),this._createTooltip(),this._createExcerpt(),this},_getParticipants:function(){var a,b=p.getCurrentUser(),d=this.model.getConversation(),e=o.getParticipantsExcluding(d,b);if(e.length){c.each(e,function(b,c){b.full_name||(a=l.objectForReference(b),a&&(e[c]=a))});var f=i.buildParticipantList({participants:e});return f.visibleParticipants[0].noComma=!0,this._hiddenParticipantList=c.pluck(f.hiddenParticipants,"full_name").join(", "),{participantsMessage:m.t("this_is_currently_a_private_message_with"),visibleParticipants:f.visibleParticipants,othersText:f.othersText}}},_createGroupSelector:function(){this.groupSelector=new j({attachPoint:".yj-move-dialog--group-selector-dropdown",typeAheadOptions:{completableModels:[k.MODEL_GROUP],includeAllCompany:!0,accessFilter:"post",filter:c.bind(this._shouldDisplayGroup,this)},hintMessage:m.t("select_a_group")}),this.groupSelector.on("validation",this._toggleShareButton.bind(this)),this.add(this.groupSelector,".yj-move-dialog--group-selector-dropdown")},_shouldDisplayGroup:function(a,b){return!b.external},_showHiddenParticipants:function(a){a.preventDefault(),this.$(".yj-move-dialog--others-link").replaceWith(this._hiddenParticipantList),n.trigger("/ui/tooltip/hide"),n.trigger("/ui/lightbox/resize")},_toggleShareButton:function(){this.$shareButton.toggleClass("yj-btn-disabled",!this.groupSelector.val().length),this.$shareButton.attr("disabled",!this.groupSelector.val().length)},_createTooltip:function(){n.trigger("/ui/tooltip/add",{target:this.$(".yj-move-dialog--others-link"),text:this._hiddenParticipantList})},_createExcerpt:function(){function a(a,c){for(var d=0;c>d;d++)b(a[d]).hide()}function d(a){var c=h.render(j,{countText:m.t("count_older_replies",{count:a})});g.find(".yj-thread-replies").before(b(c))}var e,f,g=b(".yj-thread-list-item").clone(),i=g.find(".yj-thread-reply-list-item"),j='<div class="yj-move-dialog--replies-container">{{countText}}</div>',k=i.length>2?i.length-2:0,l=g.find(".yj-thread-list-item--older-replies-link"),n=g.find(".yj-message-body .yj-message");c.each(n,function(a){var c,d=b(a).closest("[data-message-id]");d&&(c=yam.model.Message.findById(d.data("message-id")),c&&b(a).html(c.getHtmlBody({min:180,max:200,ignoreBreaksBefore:180})))}),"none"!==l.css("display")?(g.find(".yj-thread-list-item--show-replies").hide(),e=g.find(".yj-move-dialog--replies-container"),f=this.model.getReplyCount2()-i.length+k,e.remove(),a(i,k),f&&d(f)):i.length>2?(a(i,k),f=this.model.getReplyCount2()-i.length+k,d(f)):i.length||g.find(".yj-thread-replies-container").hide(),g.find(".yj-message-form-container,.yj-actions,.yj-global-reply-publisher-with-avatar,.yj-message-list-item--likes").hide(),g.find(".is-unread").removeClass("is-unread"),g.find("a").click(function(){return!1}).css("cursor","text"),g.find(".expand-collapse-link").html("&hellip;"),this.$(".yj-move-dialog--excerpt").append(g)},_postMessage:function(){this.$shareButton.addClass("yj-btn-disabled"),this.$shareButton.attr("disabled","disabled"),this.model.moveToGroup({success:this._shareSuccessCallback.bind(this),error:this._shareErrorCallback.bind(this),data:this._getPostMessageData()})},_shareSuccessCallback:function(a){n.trigger("/ui/share/success",a),n.trigger("/ui/lightbox/close")},_shareErrorCallback:function(){var a=m.t("there_was_an_error_moving_this_conversation_please_try_again");n.trigger("/ui/alert/show","error",a),this.$shareButton.removeClass("yj-btn-disabled"),this.$shareButton.removeAttr("disabled")},_getPostMessageData:function(){var b={id:this.model.id},c=a("models/group"),d=this.groupSelector.val()[0];return d.id!==c.ALL_COMPANY().id&&(b.group_id=d.id),b}});return r}),define("stache!feeds/lib/ui/threads/thread_view_toolbar",["mustache"],function(a){var b='<button type="button" class="yj-thread-view-toolbar--action yj-thread-view-toolbar--back yj-btn yj-btn-alt">\n  <span class="yamicon yamicon-left-arrow yamicon-xxx-small" aria-hidden="true"></span>\n  {{backLabel}}\n</button>\n<button type="button" class="yj-thread-view-toolbar--action yj-thread-view-toolbar--unread yj-btn yj-btn-alt">\n  {{unreadLabel}}\n</button>\n<button type="button" class="yj-thread-view-toolbar--action yj-thread-view-toolbar--follow yj-btn yj-btn-alt">\n  {{followLabel}}\n</button>\n{{#canMove}}\n  <button type="button" class="yj-thread-view-toolbar--action yj-thread-view-toolbar--move yj-btn yj-btn-alt">\n    {{moveLabel}}\n  </button>\n{{/canMove}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/threads/thread_view_toolbar",[],function(){}),define("feeds/lib/ui/threads/thread_view_toolbar",["require","underscore","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/inbox_follow_delegate","common-ui/lib/ui/general/lightbox_manager","feeds/lib/ui/inbox/move_dialog","common-ui/lib/ui/keyboard/keyboard_shortcuts","backbone","core/lib/location_helper","core/lib/tr","core/lib/treatment","core/lib/yammer_uri","html!./thread_view_toolbar","css!./thread_view_toolbar.css"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_base_view"),e=a("core/lib/inbox_follow_delegate"),f=a("common-ui/lib/ui/general/lightbox_manager"),g=a("feeds/lib/ui/inbox/move_dialog"),h=a("common-ui/lib/ui/keyboard/keyboard_shortcuts"),i=a("backbone"),j=a("core/lib/location_helper"),k=a("core/lib/tr"),l=a("core/lib/treatment"),m=a("core/lib/yammer_uri"),n=a("html!./thread_view_toolbar");return a("css!./thread_view_toolbar.css"),d.extend({mixins:[c],className:"yj-thread-view-toolbar yj-clearfix",template:n,events:{"click .yj-thread-view-toolbar--back":"navigateBack","click .yj-thread-view-toolbar--unread":"markAsUnread","click .yj-thread-view-toolbar--follow":"toggleFollow","click .yj-thread-view-toolbar--move":"moveToGroup"},initialize:function(a){this._search=a.search,this._inboxFollowDelegate=new e({model:this.model}),this.listenTo(this._inboxFollowDelegate,"follow",this.render),this.listenTo(this._inboxFollowDelegate,"unfollow",this.navigateBack),l.treatment("keyboardshortcuts2")?(this.listenTo(h,"item_toggle_unread",this.markAsUnread),this.listenTo(h,"item_unfollow",this.toggleFollow)):(this.listenTo(h,"markAsUnread",this.markAsUnread),this.listenTo(h,"removeFromInbox",this.toggleFollow))},getTemplateData:function(){var a,b,c;return l.usePriorityCopy()?(this.model.direct_message?(a=this.model.isFollowedInInbox()?k.t("unfollow"):k.t("mark_as_priority"),b=k.t("mark_as_unread")):(a=this.model.isFollowedInInbox()?k.t("remove_from_priority"):k.t("mark_as_priority"),b=k.t("mark_as_unread")),c=k.t("priority_conversations")):(a=this.model.isFollowedInInbox()?k.t("stop_following_in_inbox"):k.t("follow_in_inbox"),b=k.t("mark_as_unread"),c=k.t("inbox")),{backLabel:this._search?k.t("back_to_search"):c,unreadLabel:b,followLabel:a,canMove:this._canMoveToGroup(),moveLabel:k.t("move_to_group")}},_canMoveToGroup:function(){var a=this.model;return a&&a.direct_message&&!a.isForeign()},render:function(){return i.trigger("/ui/tooltip/add",{target:this.$(".yj-thread-view-toolbar--move"),text:k.t("move_this_conversation_from_a_private_message_to_a_group")}),this},remove:function(){return this._inboxFollowDelegate.remove(),d.prototype.remove.call(this)},navigateBack:function(){var a="",b=this._search;if(b){if(l.treatment("make_search_fast_ab"))return window.history.back();a="global"===b.search_origin?m.app("/#/Threads/Search",{search:b.search}):m.app("/#/inbox/search",{search:b.search})}else a="inboxAll"===yam.router.getPreviousRoute()?m.app("/#/inbox/all"):"inboxUnread"===yam.router.getPreviousRoute()?m.app("/#/inbox/unread"):m.app("/#/inbox/index");j.assign(a)},markAsUnread:function(){var a={success:function(){i.trigger("/ui/alert/show","notice",k.t("the_conversation_has_been_marked_as_unread"))},error:function(){i.trigger("/ui/alert/show","error",k.t("there_was_an_error_marking_the_conversation_as_unread"))}};this.options.logReadToggleOrigin&&(a.log_data={source:"inbox_conversation_view_button"}),this.model.markAsUnread(a),this.navigateBack()},toggleFollow:function(){this._inboxFollowDelegate.toggleFollow()},moveToGroup:function(){i.on("/ui/share/success",this._handleMove,this),f.openComponent(new g({model:this.model}),"yj-share-lightbox",{},{title:k.t("move_this_conversation"),overlayClose:!1,scrolling:!1,onClosed:function(){i.off("/ui/share/success",this._handleMove,this)},onOpen:function(){i.trigger("/ui/tooltip/hide")}})},_handleMove:function(a){var c=b.filter(a.references,function(a){return"group"===a.type})[0];i.trigger("/ui/alert/show","notice",k.t("youve_now_moved_this_conversation_to_group_reloading_page",{group:c&&c.full_name||"All Company"})),setTimeout(function(){location.reload()},1e3)}})}),define("stache!workfeed/lib/app/views/threads/show",["mustache"],function(a){var b='<div class="page-header" role="region" style="display: block">\n  <h2 class="yj-conversation-view-title header-content">{{{titleHtml}}}</h2>\n  {{#fromInbox}}<ThreadViewToolbar key="thread-view-toolbar"/>{{/fromInbox}}\n</div>\n<div class="yk-row">\n  {{#errorText}}\n    <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n      <p class="yj-message-list-notice">{{errorText}}</p>\n    </div>\n  {{/errorText}}\n  {{#hasThread}}\n    <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n      {{#searchText}}\n        <h4 class="yj-search-back yj-back" role="presentation">\n          <a href="{{searchUrl}}">\n            <span class="yamicon yamicon-left-arrow yamicon-small yj-suppress-underline yamicon-inline"></span>\n            {{searchText}}\n          </a>\n        </h4>\n      {{/searchText}}\n      <ThreadDetail key="thread-detail"/>\n    </div>\n    <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6">\n      <ThreadSidebar key="thread-sidebar"/>\n    </div>\n  {{/hasThread}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/threads/show",["require","jquery","underscore","core/lib/backbone_with_auto_render","core/lib/backbone_base_view","core/lib/backbone_with_subviews","models/lib/events","models/group","components/network_label/index","workfeed/lib/app/views/threads/search","feeds/lib/ui/threads/future/thread_detail","feeds/lib/ui/threads/thread_sidebar","feeds/lib/ui/threads/thread_view_toolbar","models/lib/helper/feed_factory","workfeed/lib/app/helpers/layout","models/lib/orm-models","feeds/lib/helper/parameter_helper","backbone","core/lib/session","feeds/lib/ui/util/title_updater","core/lib/tr","core/lib/treatment","core/lib/uri_helper","core/lib/yammer_uri","models/helpers/group","models/helpers/network","html!./show"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_subviews"),g=a("models/lib/events"),h=a("models/group"),i=a("components/network_label/index"),j=a("workfeed/lib/app/views/threads/search"),k=a("feeds/lib/ui/threads/future/thread_detail"),l=a("feeds/lib/ui/threads/thread_sidebar"),m=a("feeds/lib/ui/threads/thread_view_toolbar"),n=a("models/lib/helper/feed_factory"),o=a("workfeed/lib/app/helpers/layout"),p=a("models/lib/orm-models"),q=a("feeds/lib/helper/parameter_helper"),r=a("backbone"),s=a("core/lib/session"),t=a("feeds/lib/ui/util/title_updater"),u=a("core/lib/tr"),v=a("core/lib/treatment"),w=a("core/lib/uri_helper"),x=a("core/lib/yammer_uri"),y=a("models/helpers/group"),z=a("models/helpers/network"),A=a("html!./show");return e.extend({mixins:[d,f],template:A,className:o.twoColumnMainClass,attributes:{role:"main"},views:{ThreadDetail:"_createThreadDetail",ThreadSidebar:"_createThreadSidebar",ThreadViewToolbar:"_createThreadViewToolbar"},id:"threadsShow",_getSearchOptions:function(a){for(var b,c,d,e=j.prototype.validSearchOpts.concat(["search","search_type","search_origin"]),f=0,g=e.length;g>f;f++)b=e[f],c=a[b],c&&(d=d||{},d["search_type"===b?"type":b]=c);return d},isConnected:function(a){return a.hasKeyType("inboxRead")||a.isRealtimeConnected()},initialize:function(){var a=q.filterTrackingParams(this.options);this.search=this._getSearchOptions(a),this.threadId=a.threadId;var c=p.Thread().findById(this.threadId),d=c&&c.getAnyFeed();if(d&&this.isConnected(d)&&c.isFullThread())this._feed=d,this._showThread(c);else{var e=n.findOrCreate("thread",this.threadId);this._feed=e,this.listenTo(g,"ThreadFeedDelivery/"+e.id+"/create",this._showThread),this.listenTo(g,"ThreadFeedDelivery/"+e.id+"/update",this._showThread),e.fetch().then(e.connectToRealtime.bind(e)).fail(this._onFeedFetchFailure.bind(this))}t.setTitle(u.t("view_conversation")),this.$el.on("deleteThread",this.displayThreadDeleted.bind(this)),setTimeout(function(){b("html,body").animate({scrollTop:0},1)},100)},_onFeedFetchFailure:function(a,b,c){switch(c){case"Forbidden":this.displayPermissionsDenied();break;case"Not Found":this.displayThreadDeleted();break;default:this.displayUnknownError()}},remove:function(){return this._thread&&this._thread.unlisten(),e.prototype.remove.apply(this,arguments)},_showThread:function(a){this.threadId==a.id&&(this._thread||(a.isFollowedInInbox()&&r.trigger("/ui/nav/activeViewChange","inbox"),a.direct_message&&(a.listen(),this.listenTo(r,"/threads/"+a.id,this._handleThreadEvent)),this._thread=a,this.render()))},getTemplateData:function(){var a,b,c=this._thread,d=c&&c.isFollowedInInbox(),e=this.search;return!e||d||v.treatment("make_search_fast_ab")||(a=x.app()+"/#/Threads/Search?"+w.paramify(e),b=u.t("return_to_search_results_for_term",{term:e.search})),{errorText:this._errorText,hasThread:c&&!this._errorText,titleHtml:c&&this._createTitleHtml(c),fromInbox:d,searchUrl:a,searchText:b}},_supportsReadStateToggle:function(){return this._thread.isFollowedInInbox()},_createThreadViewToolbar:function(){return new m({model:this._thread,search:this.search,logReadToggleOrigin:this._supportsReadStateToggle()})},_createThreadDetail:function(){return new k({thread:this._thread,feed:this._feed,logReadToggleOrigin:this._supportsReadStateToggle()})},_createTitleHtml:function(a){var b,d,e,f,g;return a.isFollowedInInbox()?a.direct_message?b=v.usePriorityCopy()?u.t("direct_message"):u.t("private_message"):(d=a.getThreadStarter().getGroup(),d?e=y.getFullName(d):(d=h.ALL_COMPANY(),d.set("network_id",a.get("network_id")),e=z.getCompanyGroupName(s.getCurrentNetwork())),f=new i({model:d,className:"yj-network-label is-header"}),g=c.escape(e)+f.render().el.outerHTML,b=v.usePriorityCopy()?u.t("conversation_in_the_groupname_group",{groupName:g}):u.t("message_in_the_groupname_group",{groupName:g})):b=u.t("view_conversation"),b},_createThreadSidebar:function(){var a=this._thread.isFollowedInInbox();return new l({model:{threadId:this.threadId},showInboxFollowLink:!a})},_handleThreadEvent:function(a){if("move_to_group"===a.type&&a.data.user.id!=s.getCurrentUser().id){var b=a.data;r.trigger("/ui/alert/show","notice",u.t("user_moved_this_conversation_to_the_group_group_reloading_page",{user:b.user.full_name,group:b.group_name})),setTimeout(function(){window.location.reload()},1e3)}},displayThreadDeleted:function(){this.displayError(u.t("this_thread_has_been_deleted"))},displayUnknownError:function(){this.displayError(u.t("sorry_something_went_wrong_please_refresh"))},displayPermissionsDenied:function(){this.displayError(u.t("you_do_not_have_access_to_view_this_thread"))},displayError:function(a){this._errorText=a,this.render()}})}),define("workfeed/lib/app/views/threads/to_user",["require","jquery","core/lib/backbone_base_class","feeds/lib/ui/threads/future/thread_list","models/lib/helper/feed_factory","common-ui/lib/helper/ui"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_base_class"),d=a("feeds/lib/ui/threads/future/thread_list"),e=a("models/lib/helper/feed_factory"),f=a("common-ui/lib/helper/ui");return c.extend({initialize:function(){var a=this.options,c=a.appId;f.setSelectedTabForFeed(c);var g=a.feedId,h=new d({feed:e.findOrCreate("userPraise",g),feedId:g,hideThreadStarter:!0});b(".yj-main-messagelist-container:first").append(h.render().$el),this.threadList=h},remove:function(){this.threadList.remove()}})}),define("stache!components/dogfood/src/dogfood_switcher",["mustache"],function(a){var b='<h1>Frontend Dogfood Status</h1>\n\n<button class="yj-dogfood-switcher--toggle {{optedClass}}">\n  {{#optedIn}}Dogfooding :){{/optedIn}}\n  {{^optedIn}}Not Dogfooding :({{/optedIn}}\n</button>\n\n<p class="yj-dogfood-switcher--notice">\n  You are currently <strong>{{^optedIn}}not{{/optedIn}} dogfooding</strong>. Click the above button to toggle.\n</p>\n<p class="yj-dogfood-switcher--notice">\n  If you clear cookies you\'ll need to opt-in again using this page.\n</p>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/dogfood/src/dogfood_switcher",[],function(){}),define("components/dogfood/src/dogfood_switcher",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/cookie_helper","workfeed/lib/app/helpers/layout","core/lib/yammer_uri","core/lib/location_helper","html!./dogfood_switcher","css!./dogfood_switcher"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/cookie_helper"),e=a("workfeed/lib/app/helpers/layout"),f=a("core/lib/yammer_uri"),g=a("core/lib/location_helper"),h="frontend_release",i=b.extend({mixins:[c],template:a("html!./dogfood_switcher"),styles:a("css!./dogfood_switcher"),className:e.twoColumnMainClass+" yj-dogfood-switcher",events:{"click .yj-dogfood-switcher--toggle":"_toggle"},getTemplateData:function(){return{optedIn:this._isOptedIn(),optedClass:this._optedClass()}},_isOptedIn:function(){return!!d.get(h)},_optedClass:function(){return this._isOptedIn()?"opted-in":"opted-out"},_toggle:function(){this._isOptedIn()?d.unset({name:h,domain:this._getCookieDomain()}):d.set({name:h,domain:this._getCookieDomain(),value:"dogfood",days:365}),this.render()},_getCookieDomain:function(){var a=f.base()||this._baseFromLocation(),b=new RegExp("^"+g.protocol()+"//(www.)*");return"."+a.replace(b,"")},_baseFromLocation:function(){return g.protocol()+"//"+g.host()+"/"}});return i}),define("components/dogfood/index",["require","./src/dogfood_switcher"],function(a){"use strict";return a("./src/dogfood_switcher")}),define("stache!components/sidebar_actions/src/sidebar_actions",["mustache"],function(a){var b='{{#hasActions}}\n<h2 class="yj-sidebar-actions--header">{{actions_header}}</h2>\n<ul class="yj-sidebar-actions--list">\n  {{#can_goto}}\n  <li class="yj-sidebar-actions--action">\n    <span class="yamicon yamicon-rd_right_arrow yj-dark-gray"></span><a href="{{goto_href}}" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-goto">{{goto_label}}</a>\n  </li>\n  {{/can_goto}}\n  {{#can_return}}\n  <li class="yj-sidebar-actions--action">\n    <span class="yamicon yamicon-rd_reply yj-dark-gray"></span><a href="{{return_href}}" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-return">{{return_label}}</a>\n  </li>\n  {{/can_return}}\n  {{#can_revert}}\n  <li class="yj-sidebar-actions--action">\n    <span class="yamicon yamicon-rd_revert yj-dark-gray"></span><a href="javascript://" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-revert">{{revert_label}}</a>\n  </li>\n  {{/can_revert}}\n  {{#can_download}}\n  <li class="yj-sidebar-actions--action">\n    <span class="yamicon yamicon-rd_download yj-dark-gray"></span><a href="{{download_href}}" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-download">{{download_label}}</a> <span data-qaid="size">({{size_label}})</span>\n  </li>\n  {{/can_download}}\n  {{#can_upload}}\n  <li class="yj-sidebar-actions--action">\n    <span class="yamicon yamicon-rd_upload yj-dark-gray"></span><a href="javascript://" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-upload" data-qaid="upload">{{upload_label}}</a>\n  </li>\n  {{/can_upload}}\n  {{#can_edit}}\n  <li class="yj-sidebar-actions--action">\n    <span class="yamicon yamicon-rd_edit yj-dark-gray"></span><a href="{{edit_href}}" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-edit" data-qaid="edit" {{#edit_in_new_window}}target="blank"{{/edit_in_new_window}}>{{edit_label}}{{#show_contributors}}<div class="yj-sidebar-actions--action-link yj-sidebar-actions--contributors">{{#contributors}}<Contributor key="{{.}}" />{{/contributors}}</div>{{/show_contributors}}</a>\n  </li>\n  {{/can_edit}}\n  {{#can_delete}}\n  <li class="yj-sidebar-actions--action">\n    <span class="yamicon yamicon-rd_delete yj-dark-gray"></span><a href="javascript://" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-delete" data-qaid="delete">{{delete_label}}</a>\n  </li>\n  {{/can_delete}}\n  {{#can_view_fullscreen}}\n  <li class="yj-sidebar-actions--action">\n    <span class="yamicon yamicon-rd_expand yj-dark-gray"></span><a href="javascript://" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-view-fullscreen">{{view_fullscreen_label}}</a>\n  </li>\n  {{/can_view_fullscreen}}\n  {{#can_mark_official}}\n  <li class="yj-sidebar-actions--action">\n    {{^is_official}}<span class="yamicon yamicon-add-star yj-dark-gray"></span><a href="javascript://" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-official" data-qaid="mark_official">{{mark_official_label}}</a>{{/is_official}}{{#is_official}}<span class="yamicon yamicon-remove-star yj-dark-gray"></span><a href="javascript://" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-remove-official" data-qaid="remove_official">{{remove_official_label}}</a>{{/is_official}}\n  </li>\n  {{/can_mark_official}}\n  {{#can_view_published}}\n  <li class="yj-sidebar-actions--action">\n    <span class="yamicon yamicon-rd_view yj-dark-gray"></span><a href="javascript://" class="yj-sidebar-actions--action-link yj-sidebar-actions--action-view-published">{{view_published_label}}</a>\n  </li>\n  {{/can_view_published}}\n</ul>\n{{/hasActions}}';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/sidebar_actions/src/sidebar_actions",[],function(){}),define("components/sidebar_actions/src/sidebar_actions",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","models/helpers/file","components/avatar/src/avatar","models/user","core/lib/session","html!./sidebar_actions","css!./sidebar_actions"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/tr"),f=a("models/helpers/file"),g=a("components/avatar/src/avatar"),h=a("models/user"),i=a("core/lib/session"),j=a("html!./sidebar_actions");a("css!./sidebar_actions");var k=function(a,b){var c=[].concat(a.references||[],a.external_references||[]),d=c.filter(function(a){return"user"===a.type&&a.id===parseInt(b,10)});return new h(d[0])};return b.extend({tagName:"div",className:"yj-sidebar-actions",mixins:[c,d],views:{Contributor:"_getContributor"},template:j,events:{"click .yj-sidebar-actions--action-delete":"_clickDelete","click .yj-sidebar-actions--action-official":"_clickOfficial","click .yj-sidebar-actions--action-remove-official":"_clickRemoveOfficial","click .yj-sidebar-actions--action-revert":"_clickRevert","click .yj-sidebar-actions--action-view-published":"_clickViewPublished","click .yj-sidebar-actions--action-view-fullscreen":"_clickViewFullscreen","click .yj-sidebar-actions--action-upload":"_clickUpload"},getTemplateData:function(){return this.options.strategy.getTemplateData.apply(this,arguments)},_clickDelete:function(){this.options.strategy.actions.DELETE.call(this)},_clickOfficial:function(){this.options.strategy.actions.MARK_OFFICIAL.call(this)},_clickRemoveOfficial:function(){this.options.strategy.actions.REMOVE_OFFICIAL.call(this)},_clickRevert:function(){this.options.strategy.actions.REVERT.call(this)},_clickViewPublished:function(){this.options.strategy.actions.VIEW_PUBLISHED.call(this)},_clickViewFullscreen:function(){this.options.strategy.actions.VIEW_FULLSCREEN.call(this)},_clickUpload:function(){this.options.strategy.actions.UPLOAD.call(this)},_areComparing:function(){return!!this.options.endVersion},_isCurrentVersion:function(){return this.options.endVersion===this.model.latest_version.id},_showUnpublishedLink:function(){return 1===this.model.unpublished_contributor_ids.length&&this.model.unpublished_contributor_ids[0]===i.getCurrentUser().id?!1:f.hasUnpublishedChanges(this.model)},_getEditLabel:function(){return this._showUnpublishedLink()?e.t("sidebar_note_actions_edit_with"):e.t("sidebar_note_actions_edit")},_getContributor:function(a){var b=k(this.model,a);return new g({model:b,size:96})}})}),define("components/sidebar_actions/index",["require","./src/sidebar_actions"],function(a){"use strict";return a("./src/sidebar_actions")}),define("components/sidebar_actions/src/strategies/note",["require","common-ui/lib/ui/general/delete_note_confirmation","common-ui/lib/ui/general/lightbox_manager","backbone","core/lib/location_helper","core/lib/tr","core/lib/urls","core/lib/yammer_api","core/lib/session","models/helpers/file"],function(a){"use strict";var b=a("common-ui/lib/ui/general/delete_note_confirmation"),c=a("common-ui/lib/ui/general/lightbox_manager"),d=a("backbone"),e=a("core/lib/location_helper"),f=a("core/lib/tr"),g=a("core/lib/urls"),h=a("core/lib/yammer_api"),i=a("core/lib/session"),j=a("models/helpers/file"),k=function(){var a=this,h=new b({itemId:this.model.id,confirmCallback:function(){e.replace(g.groupNotes(a.options.group)),d.trigger("/ui/alert/show","notice",f.t("the_note_has_been_deleted"))}});c.openComponent(h,"",null,{title:f.t("delete_note_warning_confirm_title"),width:"370"})},l=function(){var a=this;h.makeNoteOfficial({note_id:this.model.id}).then(function(){d.trigger("/ui/alert/show","notice",f.t("this_note_has_been_marked_as_official")),a.model.official=!0}).always(function(){a.trigger("change"),a.render()})},m=function(){var a=this;h.makeNoteUnofficial({note_id:this.model.id}).then(function(){d.trigger("/ui/alert/show","notice",f.t("this_note_is_no_longer_official")),a.model.official=!1}).always(function(){a.trigger("change"),a.render()})},n=function(){var a=this.model;h.revertNoteToVersion({note_id:a.id,version_id:this.options.endVersion}).then(function(){e.assign(g.noteIndex(a))},function(){d.trigger("/ui/alert/show","error",f.t("there_was_an_error_reverting_your_note"))})},o=function(){return this.model.last_published_by?void e.assign(g.noteIndex(this.model)):void d.trigger("/ui/alert/show","error",f.t("this_note_has_not_been_published_yet_click_publish_below"))},p=function(){var a,b,c,d,e,h,k=i.getCurrentUser();this.options.isEditing?a=!0:this._areComparing()?(b=!this._isCurrentVersion(),c=!0):(d=j.canEdit(this.model,k,this.options.group),h=j.canMarkOfficial(this.model,k,this.options.group),e=j.canDelete(this.model,k,this.options.group,i));var l=d||h||e||c||b||a;return{hasActions:l,actions_header:f.t("sidebar_note_note_actions"),delete_label:f.t("about_note_delete_label"),mark_official_label:f.t("about_note_mark_official_label"),remove_official_label:f.t("about_note_remove_official_label"),is_official:this.model.official,can_edit:d,can_mark_official:h,can_delete:e,edit_label:this._getEditLabel(),edit_href:g.noteEdit(this.model),show_contributors:this._showUnpublishedLink(),contributors:this.model.unpublished_contributor_ids,can_revert:b,revert_label:f.t("note_actions_revert"),can_goto:c,goto_label:f.t("note_actions_goto"),goto_href:g.noteIndex(this.model),can_view_published:a,view_published_label:f.t("note_actions_view_published")}};return{actions:{DELETE:k,MARK_OFFICIAL:l,REMOVE_OFFICIAL:m,REVERT:n,VIEW_PUBLISHED:o},getTemplateData:p}}),define("stache!components/sidebar_followers/src/sidebar_followers",["mustache"],function(a){var b='{{#count}}\n<h2 class="yj-notes-followers--header">\n  <a href="{{url}}" class="yj-notes-followers--header-link">{{followers}} ({{count}})</a>\n</h2>\n<ul class="yj-sidebar-followers--list">\n  {{#items}}\n  <li class="yj-sidebar-followers--follower">\n    <Avatar key="{{.}}"/>\n  </li>\n  {{/items}}\n</ul>\n{{/count}}';
return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/sidebar_followers/src/sidebar_followers",[],function(){}),define("components/sidebar_followers/src/sidebar_followers",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/avatar/src/avatar","core/lib/tr","core/lib/urls","models/helpers/file","models/helpers/ogo","html!./sidebar_followers","css!./sidebar_followers"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("components/avatar/src/avatar"),f=a("core/lib/tr"),g=a("core/lib/urls"),h=a("models/helpers/file"),i=a("models/helpers/ogo"),j=a("html!./sidebar_followers");return a("css!./sidebar_followers"),b.extend({tagName:"div",className:"yj-sidebar-followers",mixins:[c,d],template:j,views:{Avatar:"_getAvatar"},initialize:function(){this.collection=this.model.featured_users||[]},getTemplateData:function(){var a;return h.isFile(this.model)?a=g.fileFollowers(this.model):h.isPage(this.model)?a=g.noteFollowers(this.model):i.isOpenGraphObject(this.model)&&(a=g.ogoFollowers(this.model)),{items:this.collection.map(function(a){return a.id}),followers:f.t("sidebar_followers_followers"),count:this.model.stats.followers,url:a}},_getAvatar:function(a){var b=this.collection.filter(function(b){return b.id===parseInt(a,10)});return new e({model:b[0],size:32})}})}),define("components/sidebar_followers/index",["require","./src/sidebar_followers"],function(a){"use strict";return a("./src/sidebar_followers")}),define("stache!components/sidebar_versions/src/sidebar_versions",["mustache"],function(a){var b='<h2 class="yj-sidebar-versions--header">\n  <a href="{{url}}" class="yj-sidebar-versions--header-link">{{recent_changes}}</a>\n</h2>\n<div class="yj-sidebar-versions--list">\n  {{#items}}\n  <div class="yj-sidebar-versions--item" data-qaid=\'file_version\'>\n    <div class="yj-sidebar-versions--item-avatar">\n      <Avatar />\n    </div>\n    <div class="yj-sidebar-versions--item-description">\n      <div class="yj-sidebar-versions--item-link">\n        <a href="{{link_href}}">{{link_text}}</a>\n      </div>\n      {{#subheader}}\n      <div class="yj-sidebar-versions--item-subheader">{{subheader}}</div>\n      {{/subheader}}\n      <div class="yj-sidebar-versions--item-published-by">{{{by_publisher}}}</div>\n    </div>\n  </div>\n  {{/items}}\n  {{#show_see_changes}}\n  <div class="yj-sidebar-versions--see-changes">\n    <a href="{{see_changes_href}}" class="yj-sidebar-versions--see-changes-link">{{see_changes}}</a>\n  </div>\n  {{/show_see_changes}}\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/sidebar_versions/src/sidebar_versions",[],function(){}),define("components/sidebar_versions/src/sidebar_versions",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/avatar/src/avatar","components/hovercard_link/index","models/user","core/lib/tr","core/lib/urls","core/lib/date_helper","html!./sidebar_versions","css!./sidebar_versions"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("components/avatar/src/avatar"),f=a("components/hovercard_link/index"),g=a("models/user"),h=a("core/lib/tr"),i=a("core/lib/urls"),j=a("core/lib/date_helper"),k=a("html!./sidebar_versions");a("css!./sidebar_versions");var l=function(a,b){return new Date(b.created_at)-new Date(a.created_at)},m=function(a,b){var c=[].concat(a.references||[],a.external_references||[]),d=c.filter(function(a){return"user"===a.type&&a.id===parseInt(b,10)});return new g(d[0])},n=function(a){return j.formatMonthsAgo(new Date(a.created_at))};return b.extend({tagName:"div",className:"yj-sidebar-versions",mixins:[c,d],template:k,views:{Avatar:"_getAvatar",PublisherHovercardLink:"_getHovercardLink"},initialize:function(){this.collection=this.model.versions.slice(-3).sort(l)},getTemplateData:function(){return{items:this.collection.map(function(a){return{link_text:this._getLinkText(a),link_href:i.noteCompare(this.model,a),subheader:this._getSubheaderText(a),by_publisher:h.t("sidebar_versions_published_by",{user:"<PublisherHovercardLink/>"}),publisher_id:a.published_by}}.bind(this)),recent_changes:h.t("sidebar_versions_note_title"),url:i.noteFollowers(this.model),show_see_changes:this.model.versions.length>1,see_changes:h.t("sidebar_followers_see_changes"),see_changes_href:i.noteCompare(this.model,this.model.latest_version)}},_isCurrent:function(a){return a.revision_number===this.model.latest_revision},_getSubheaderText:function(a){return this._isCurrent(a)&&h.t("sidebar_versions_published_ago",{time_ago:n(a)})},_getLinkText:function(a){return this._isCurrent(a)?h.t("sidebar_versions_current_version"):h.t("sidebar_versions_published_ago",{time_ago:n(a)})},_getAvatar:function(a){var b=this.collection[a].published_by;return new e({model:m(this.model,b),size:96})},_getHovercardLink:function(a){var b=this.collection[a].published_by;return new f({model:m(this.model,b)})}})}),define("components/sidebar_versions/index",["require","./src/sidebar_versions"],function(a){"use strict";return a("./src/sidebar_versions")}),define("models/content_relationship",["require","models/yammer_model"],function(a){"use strict";var b=a("models/yammer_model");return b.extend({})}),define("collections/content_relationships",["require","collections/yammer_collection","underscore","core/lib/collection_with_yammer_request","models/content_relationship"],function(a){"use strict";var b=a("collections/yammer_collection"),c=a("underscore"),d=a("core/lib/collection_with_yammer_request"),e=a("models/content_relationship");return b.extend({model:e,mixins:[d],initialize:function(a,c){this.source_id=c.source_id,this.source_type=c.source_type,b.prototype.initialize.call(this,a,c)},url:function(){return"/api/v1/content_relationships?by_position=true&source_id="+this.source_id+"&source_type="+this.source_type},parse:function(a){if(a.content_relationships&&a.references){var b=c.filter(a.references,function(a){var b=a.type.toLowerCase();return"page"===b||"uploaded_file"==b||"open_graph_object"==b}),d=c.each(a.content_relationships,function(a){var d=c.findWhere(b,{id:a.target_id}),e=a.id;c.extend(a,d),a.type=a.target_type,delete a.target_type,a.relationship_id=e});return d}return[]}})}),define("stache!components/sidebar_related_content/src/sidebar_related_content",["mustache"],function(a){var b="{{#loaded}}<RelatedContent />{{/loaded}}";return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/sidebar_related_content/src/sidebar_related_content",[],function(){}),define("components/sidebar_related_content/src/sidebar_related_content",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","collections/groups","collections/content_relationships","workfeed/lib/app/sidebar/related_contents","core/lib/tr","models/helpers/group","html!./sidebar_related_content","css!./sidebar_related_content"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("collections/groups"),f=a("collections/content_relationships"),g=a("workfeed/lib/app/sidebar/related_contents"),h=a("core/lib/tr"),i=a("models/helpers/group"),j=a("html!./sidebar_related_content");return a("css!./sidebar_related_content"),b.extend({tagName:"div",className:"yj-sidebar-related-content",mixins:[c,d],template:j,views:{RelatedContent:"_getRelatedContent"},events:{"click .yj-related-content--add":"_clickAdd"},initialize:function(){return i.isAllCompany(this.options.group)?void this.groupLoaded():void i.fetch(this.options.group.id).done(this.groupLoaded.bind(this))},groupLoaded:function(){this._loaded=!0,this.render()},getTemplateData:function(){return{title:h.t("sidebar_related_content_title"),add:h.t("sidebar_related_content_add"),loaded:this._loaded}},_getRelatedContent:function(){var a=new f([],{source_id:this.model.id,source_type:this.model.type});a.fetch();var b=this.options.group;return i.isAllCompany(b)||(b=e.get(this.options.group.id)),new g({source:this.model,model:b,collection:a,editable:!0})}})}),define("components/sidebar_related_content/index",["require","./src/sidebar_related_content"],function(a){"use strict";return a("./src/sidebar_related_content")}),define("stache!components/attachment_feed/src/attachment_feed",["mustache"],function(a){var b="<Publisher />\n<ThreadList />";return a.parse(b),function(c){return a.render(b,c)}}),define("components/attachment_feed/src/attachment_feed",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/session","models/feed_backbone","models/uploaded_file","models/page","models/recipient","feeds/lib/ui/publisher/global/thread_starter_publisher","feeds/lib/ui/threads/future/thread_list","models/lib/helper/feed_factory","models/group","models/helpers/user","core/lib/uri_helper","models/helpers/file","models/ogo","models/helpers/ogo","html!./attachment_feed"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/session"),g=a("models/feed_backbone"),h=a("models/uploaded_file"),i=a("models/page"),j=a("models/recipient"),k=a("feeds/lib/ui/publisher/global/thread_starter_publisher"),l=a("feeds/lib/ui/threads/future/thread_list"),m=a("models/lib/helper/feed_factory"),n=a("models/group"),o=a("models/helpers/user"),p=a("core/lib/uri_helper"),q=a("models/helpers/file"),r=a("models/ogo"),s=a("models/helpers/ogo"),t=a("html!./attachment_feed");return c.extend({tagName:"div",className:"yj-note-feed",mixins:[d,e],template:t,views:{Publisher:"_getPublisher",ThreadList:"_getThreadList"},initialize:function(){q.isFile(this.model)?h.save(this.model):q.isPage(this.model)&&i.save(this.model);var a=this.options.group||n.ALL_COMPANY();a=j.fromOriginalModel(a),a.getType()===j.TYPE.PRIVATE_GROUP&&a.set("fixed",!0),this._group=a;var b=this.model.get("realId")||this.model.id;this._feed=m.findOrCreate(this.model.get("type"),b)},getTemplateData:function(){return this.model.thumbnail_url&&(this.model.thumbnail_url=p.replaceParam(this.model.thumbnail_url,"_t",Date.now())),{}},_getPublisher:function(){var a=new k({logSource:this._getFeedModel().getLogSource(),showAnnouncements:o.canAnnounce(f.getCurrentUser(),this.options.group)});a.model.set("feed",this._getFeedModel()),a.model.get("recipients").add(this._group);var b=this;return a.on("open",function(){var c=a.model.get("files"),d=a.model.get("ogos");c.reset(),d.reset();var e=b._getAttachment();q.isFile(e)||q.isPage(e)?c.add(e):s.isOpenGraphObject(e)&&d.add(e),a.model.hasNonFixedRecipients()||a.model.get("recipients").add(b._group),b.$el.hasClass("collapsed")&&b.expand()}),a},expand:function(){this.$element.removeClass("collapsed")},collapse:function(){this.$element.addClass("collapsed")},_getFeedModel:function(){return g.fromOriginalModel(this._feed)},_getAttachment:function(){return q.isFile(this.model)?new h(b.extend({fixed:!0},this.model)):q.isPage(this.model)?new i(b.extend({fixed:!0},this.model)):s.isOpenGraphObject(this.model)?new r(b.extend({fixed:!0},this.model.toJSON())):void 0},_getThreadList:function(){return new l({feed:this._feed,hideThreadStarter:!0})}})}),define("components/attachment_feed/index",["require","./src/attachment_feed"],function(a){"use strict";return a("./src/attachment_feed")}),define("feeds/lib/ui/attachments/content_topics",["require","underscore","feeds/lib/ui/threads/topics_inline","core/lib/tr","core/lib/yammer_api","feeds/lib/ui/threads/topics_inline"],function(a){var b=a("underscore"),c=a("feeds/lib/ui/threads/topics_inline"),d=a("core/lib/tr"),e=a("core/lib/yammer_api");return a("feeds/lib/ui/threads/topics_inline"),c.extend({className:"yj-thread-topics yj-topics-inline yj-file-topics",formDefaults:{tagSettings:{tagTarget:".yj-topics-container",prependToTarget:!0,itemTemplate:"spanTemplate"},data:{topics:[]},itemId:""},strings:{edit:d.t("edit_topics"),doneEditing:d.t("done")},template:'<a class="yj-add-topics-link" href="javascript://">'+d.t("add_topics")+'</a><a class="yj-edit" href="javascript://">'+d.t("edit_topics")+'</a><div class="yj-topics-container yj-clearfix"><div class="yj-add-form"><label><span class="yj-acc-hidden">{{addTopicLabel}}</span><input data-yamjs-id="{{addTopicId}}" class="yj-add-topic yj-inactive" type="text" placeholder="{{addTopicLabel}}" /></label><button class="yj-add-btn yj-btn yj-btn-alt yj-btn-disabled" disabled>'+d.t("add")+"</button></div></div>",events:function(){return b.extend(b.result(c.prototype,"events"),{"click .yj-add-topics-link":"handleAddTopicsLinkClick"})},initialize:function(a){a=b.extend({},this.formDefaults,a),b.bindAll(this,"addSuccessCallback","addFailureCallback"),c.prototype.initialize.call(this,a)},render:function(){return c.prototype.render.apply(this),this.$edit=this.$(".yj-edit"),this.$addTopicsLink=this.$(".yj-add-topics-link"),this.$el.show(),this.showHideAddTopicsLink(),this.$addForm.hide(),this},handleAddTopicsLinkClick:function(){this.handleEditClick(),this.$addTopicsLink.hide()},addTopicRequest:function(a){var b=this.options.addTopicCall||e.addFileTopic;b(a).then(this.addSuccessCallback,this.addFailureCallback)},removeTopicRequest:function(a,c){var d=this,f=function(a){"function"==typeof d.options.removeSuccess&&d.options.removeSuccess(a),c.call(d.tagList,"fast"),d.showHideEdit()},g=function(a){"function"==typeof d.options.removeFailure&&d.options.removeFailure(a),c.call(d.tagList,"fast"),d.showHideEdit()},h=this.options.removeTopicCall||e.removeFileTopic,i=b.extend({topic_id:a},b.pick(this.options.data,"thread_id","note_id","file_id","itemId"));h(i).then(f,g)},toggleEditMode:function(a){c.prototype.toggleEditMode.call(this,a,!0),this.isEditing?b.defer(b.bind(function(){this.$search.focus()},this)):this.showHideAddTopicsLink()},showHideAddTopicsLink:function(){this.tagList.isEmpty()?(this.$addTopicsLink.show(),this.$edit.hide()):(this.$addTopicsLink.hide(),this.$edit.css("visibility","hidden"))}})}),define("stache!components/share_button/src/share_button",["mustache"],function(a){var b='{{#can_share}}<a href="#" role="button" class="yj-btn yj-btn-alt" data-qaid="share_button"><span class="yamicon yj-dark-gray yamicon-inline yamicon-share yamicon-xxx-small"></span>{{label}}</a>{{/can_share}}';return a.parse(b),function(c){return a.render(b,c)}}),define("components/share_button/src/share_button",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","feeds/lib/ui/publisher/global/publisher_helper","core/lib/tr","models/helpers/group","models/helpers/ogo","html!./share_button"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("feeds/lib/ui/publisher/global/publisher_helper"),f=a("core/lib/tr"),g=a("models/helpers/group"),h=a("models/helpers/ogo"),i=a("html!./share_button");return c.extend({tagName:"span",className:"yj-share-button",mixins:[d],template:i,events:{click:"_onClick"},getTemplateData:function(){return{can_share:h.isOpenGraphObject(this.model)||g.canShareNotes(this.options.group),label:f.t("share_button_label")}},_onClick:function(a){a.preventDefault(),b.extend(this.model,{source:"page_share_button",type:this.model.type,id:this.model.id}),e.openShareLightbox(this.model,!1,!0)}})}),define("components/share_button/index",["require","./src/share_button"],function(a){"use strict";return a("./src/share_button")}),define("css!workfeed/lib/app/views/note/header",[],function(){}),define("stache!workfeed/lib/app/views/note/header",["mustache"],function(a){var b='<div class="yj-about-note--header-breadcrumbs">\n  <div class="yj-about-note--header-breadcrumb">{{{group_link}}}</div>\n  <div class="yamicon yj-dark-gray-light yamicon-right-arrow"></div>\n  <a href="{{notes_link_href}}" class="yj-about-note--header-breadcrumb">{{notes_link_text}}</a>\n  {{#show_breadcrumbs}}\n  <div class="yamicon yj-dark-gray-light yamicon-right-arrow"></div>\n  <a href="{{note_link_href}}" class="yj-about-note--header-breadcrumb">{{note_link_text}}</a>\n  <div class="yamicon yj-dark-gray-light yamicon-right-arrow"></div>\n  <div class="yj-about-note--header-breadcrumb">{{subpage_title}}</div>\n  {{/show_breadcrumbs}}\n</div>\n<div class="yj-about-note--header-row">\n  <div class="yj-about-note--header-icon">\n    <span class="yamicon yamicon-old-note yj-blue"></span>\n  </div>\n  <div class="yj-about-note--header-display-name">\n    {{#is_editing}}\n    <span class="yj-acc-hidden"><label for="yj-about-note-edit-title">{{title_label}}</label></span>\n    <input type="text" id="yj-about-note-edit-title" class="yj-about-note--header-title-edit" value="{{title}}" maxlength="255" data-qaid="note_title_input"></input>\n    {{/is_editing}}\n    {{^is_editing}}\n    <h2 class="yj-about-note--header-title" data-qaid="note_title">{{title}}</h2>\n    {{/is_editing}}\n    <div class="yj-about-note--header-details">\n      {{#is_private}}\n      <div class="yj-about-note--private">\n        <div class="yamicon yamicon-lock yamicon-small yj-dark-gray"></div>\n        <div class="yj-tooltip yj-tooltip-default yj-tooltip-with-default-arrows">\n          <div class="yj-tooltip-icon yamicon yamicon-up-arrow"></div>\n          <div class="yj-tooltip-container">{{private_tooltip}}</div>\n        </div>\n      </div>\n      <div class="pipe"></div>\n      {{/is_private}}\n      {{#is_official}}\n      <OfficialBadge />\n      <div class="pipe"></div>\n      {{/is_official}}\n      {{#is_published}}\n      <div class="yj-about-note--header-publisher">{{{publisher_link}}}{{#isOwner}} ({{owner}}){{/isOwner}}</div>\n      <div class="pipe"></div>\n      <div class="yj-about-note--header-published" title="{{published_date}}">{{published_ago}}</div>\n      {{/is_published}}\n      {{^is_published}}<div class="yj-about-note--header-published">{{not_published}}</div>{{/is_published}}\n    </div>\n  </div>\n  {{#show_actions}}\n  <div class="yj-about-note--header-actions">\n    {{#show_share}}<ShareButton />{{/show_share}}\n    {{#show_follow}}<FollowButton />{{/show_follow}}\n  </div>\n  {{/show_actions}}\n</div>\n{{#version_warning}}\n<div class="yj-about-note--header-version-warning">{{{version_warning}}}</div>\n{{/version_warning}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/note/header",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/hovercard_link/index","components/share_button/index","common-ui/lib/ui/shared/follow_button","components/official_badge/index","models/user","core/lib/urls","core/lib/tr","core/lib/session","core/lib/date_helper","models/helpers/group","core/lib/yammer_api","models/helpers/file","css!./header","html!./header"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/hovercard_link/index"),g=a("components/share_button/index"),h=a("common-ui/lib/ui/shared/follow_button"),i=a("components/official_badge/index"),j=a("models/user"),k=a("core/lib/urls"),l=a("core/lib/tr"),m=a("core/lib/session"),n=a("core/lib/date_helper"),o=a("models/helpers/group"),p=a("core/lib/yammer_api"),q=a("models/helpers/file");a("css!./header");var r=a("html!./header"),s=function(a){return a.owner_id===a.last_published_by},t=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.id===b)return d}};return c.extend({mixins:[d,e],template:r,views:{GroupLink:"_getGroupLink",PublisherHovercardLink:"_getPublisherLink",ShareButton:"_getShareButton",FollowButton:"_getFollowButton",OfficialBadge:"_getOfficialBadge"},events:{"blur .yj-about-note--header-title-edit":"_updateNoteTitle"},className:"yj-about-note--header",getTemplateData:function(){var a,b=this.model.last_published_at,c=!!this.model.last_published_by;return this.options.endVersion&&(a=t(this.model.versions,this.options.endVersion),b=a.created_at),{group_link:l.t("about_note_title",{link:"<GroupLink />"}),notes_link_href:k.groupNotes(this.options.group),notes_link_text:l.t("about_note_link_notes"),title:this.model.name,is_private:o.isPrivate(this.options.group),is_official:this.model.official,owner:l.t("about_note_owner"),isOwner:s(this.model),publisher_link:l.t("about_note_published_by",{user:'<PublisherHovercardLink key="{$0}" />',publisher_id:this.model.last_published_by||this.model.owner_id}),published_date:n.formatDateTime(new Date(b)),published_ago:l.t("about_note_published_ago",{date:n.formatMonthsAgo(new Date(b))}),show_actions:!this.options.isEditing,show_share:!q.isForeign(this.model,m)&&!this.options.endVersion,share:l.t("about_note_share"),private_tooltip:l.t("about_note_private_group_tooltip"),note_link_href:k.noteIndex(this.model),note_link_text:this.model.name,show_breadcrumbs:!!this.options.subpage_title,subpage_title:this.options.subpage_title,version_warning:this.options.version_warning,is_published:c,not_published:l.t("note_header_not_published"),is_editing:this.options.isEditing,title_label:l.t("title"),show_follow:!q.isForeign(this.model,m)}},_getOfficialBadge:function(){return new i({model:this.model})},_getGroupLink:function(){return new f({model:this.options.group})},_getPublisherLink:function(a){return new f({model:j.findById(a)})},_getShareButton:function(){return new g({model:this.model,group:this.options.group})},_getFollowButton:function(){return new h({model:b.extend({type:"page"},this.model)})},_updateNoteTitle:function(a){this.model.name=this.model.title=a.target.value,p.updateNoteTitle({note_id:this.model.id,"page[title]":a.target.value})}})}),define("css!workfeed/lib/app/views/note/index",[],function(){}),define("css!workfeed/lib/app/views/note/paddie",[],function(){}),define("stache!workfeed/lib/app/views/note/index",["mustache"],function(a){var b='{{^loading}}\n<Header key="{{model}}"/>\n<div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n  <div class="yk-row">\n    <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n      <div class="yj-selector-left-col yj-wide yj-scrollbar-fix">\n        <div class="yj-about-note--note-container" data-qaid="note_body">{{{body}}}</div>\n        <div class="yj-about-note--topics-container"><Topics /></div>\n        <div class="yj-about-note--feed-container"><Feed /></div>\n      </div>\n    </div>\n    <div class="yj-about-note--right-sidebar-container">\n      <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6">\n        <Actions />\n        <RelatedContent />\n        <Followers />\n        <Versions />\n      </div>\n    </div>\n  </div>\n</div>\n{{/loading}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/note/index",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/sidebar_actions/index","components/sidebar_actions/src/strategies/note","components/sidebar_followers/index","components/sidebar_versions/index","components/sidebar_related_content/index","models/page","models/group","models/user","components/attachment_feed/index","workfeed/lib/app/helpers/layout","core/lib/urls","core/lib/tr","core/lib/yammer_api","feeds/lib/ui/util/title_updater","feeds/lib/ui/attachments/content_topics","models/helpers/group","core/lib/location_helper","core/lib/yammer_uri","core/lib/session","models/helpers/user","./header","css!./index","css!./paddie","html!./index"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/sidebar_actions/index"),g=a("components/sidebar_actions/src/strategies/note"),h=a("components/sidebar_followers/index"),i=a("components/sidebar_versions/index"),j=a("components/sidebar_related_content/index"),k=a("models/page"),l=a("models/group"),m=a("models/user"),n=a("components/attachment_feed/index"),o=a("workfeed/lib/app/helpers/layout"),p=a("core/lib/urls"),q=a("core/lib/tr"),r=a("core/lib/yammer_api"),s=a("feeds/lib/ui/util/title_updater"),t=a("feeds/lib/ui/attachments/content_topics"),u=a("models/helpers/group"),v=a("core/lib/location_helper"),w=a("core/lib/yammer_uri"),x=a("core/lib/session"),y=a("models/helpers/user"),z=a("./header");a("css!./index"),a("css!./paddie");var A=a("html!./index"),B=function(a){var b=[].concat(a.references||[],a.external_references||[]);b.forEach(function(a){var b;"user"===a.type&&(b=m.findById(a.id),b||m.save(a))})},C=function(a){for(var b=[].concat(a.references||[],a.external_references||[]),c=0;c<b.length;c++){var d=b[c];if("group"===d.type&&d.id===a.group_id)return new l(d)}return l.ALL_COMPANY()},D=function(a){var c=[].concat(a.references||[],a.external_references||[]);return c.filter(function(a){return"topic"===a.type}).map(function(a){return a.name=b.escape(a.name),a})};return c.extend({mixins:[d,e],template:A,views:{Header:"_getHeader",Followers:"_getFollowers",Versions:"_getVersions",Actions:"_getActions",RelatedContent:"_getRelatedContent",Feed:"_getFeed",Topics:"_getTopics"},className:o.twoColumnMainClass,attributes:{role:"main"},initialize:function(){b.bindAll(this,"_getMetadata","_processMetadata"),this.group=this.options.group,this._loaded()||this._fetchNote(),s.setTitle("")},getTemplateData:function(){var a={loading:!0};return this.model&&!this.model.last_published_by?(v.replace(p.noteEdit({id:this.options.noteId})),a):this._loaded()?{body:this.model.body.rich,model:JSON.stringify(b.pick(this.model,"id","official"))}:a},_loaded:function(){return!(!this.model||!this.group)},_getHeader:function(){return new z({model:this.model,group:this.group})},_getFollowers:function(){return new h({model:this.model})},_getVersions:function(){return new i({model:this.model})},_fetchNote:function(){this._getMetadata().then(this._processMetadata).fail(function(){v.replace(w.app("/"))})},_getMetadata:function(){return r.getNote({note_id:this.options.noteId,include_body:!0,include_featured_users:!0,include_versions:!0})},_processMetadata:function(a){this.model=k.create(a),this.group=C(a),s.setTitle(q.t("about_note_page_title",{note_title:this.model.name,group:u.getFullName(this.group)}),{announce:!0}),this._topics=D(this.model),B(a),this.model.following?y.followPage(x.getCurrentUser(),this.model.id):y.unfollowPage(x.getCurrentUser(),this.model.id),this.render()},_getActions:function(){var a=new f({model:this.model,group:this.group,strategy:g});return this.listenTo(a,"change",this.render),a},_getRelatedContent:function(){return new j({model:this.model,group:this.group})},_getTopics:function(){return new t({data:{note_id:this.model.id,topics:this._topics},removeTopicCall:r.removeNoteTopic,addTopicCall:r.addNoteTopic})},_getFeed:function(){return new n({model:this.model,group:this.group})}})}),define("stache!components/sidebar_history/src/reverted_label",["mustache"],function(a){var b='<div class="yj-sidebar-history--reverted-label--container">\n  <div class="yj-tooltip yj-tooltip-default yj-tooltip-with-default-arrows">\n    <span class="yj-tooltip-icon yamicon yamicon-up-arrow"></span>\n    <span class="yj-tooltip-container">{{tooltip}}</span>\n  </div>\n  <div class="yj-sidebar-history--reverted-label--label">{{label}}</div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/sidebar_history/src/reverted_label",[],function(){}),define("components/sidebar_history/src/reverted_label",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","core/lib/date_helper","models/user","models/helpers/user","html!./reverted_label","css!./reverted_label"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/tr"),f=a("core/lib/date_helper"),g=a("models/user"),h=a("models/helpers/user"),i=a("html!./reverted_label");a("css!./reverted_label");var j=function(a){return f.formatMonthsAgo(new Date(a))},k=function(a,b){var c=[].concat(a.references||[],a.external_references||[]),d=c.filter(function(a){return"user"===a.type&&a.id===parseInt(b,10)});return new g(d[0])};return b.extend({className:"yj-sidebar-history--reverted-label",mixins:[c,d],template:i,getTemplateData:function(){var a=k(this.model,this.options.from.published_by),b=k(this.model,this.options.to.published_by);return{label:this.options.label,tooltip:e.t("sidebar_history_revert_label_tooltip",{time_ago:j(this.options.to.created_at),reverter:h.getFullName(a),username:h.getFullName(b)})}}})}),define("stache!components/sidebar_history/src/sidebar_history",["mustache"],function(a){var b='<h2 class="yj-sidebar-history--header">{{title}}</h2>\n<div class="yj-sidebar-history--list">\n  {{#items}}\n  <div class="yj-sidebar-history--item{{#selected}} highlighted{{/selected}}" data-qaid="file_version">\n    {{#show_avatar}}\n    <div class="yj-sidebar-versions--item-avatar">\n      <Avatar />\n    </div>\n    {{/show_avatar}}\n    <div class="yj-sidebar-history--item-description">\n      <div class="yj-sidebar-history--item-link">\n        <a href="{{link_href}}" title="{{date}}" data-qaid="version_time">{{{link}}}</a>\n      </div>\n      <div class="yj-sidebar-history--item-edited-by">{{by_editor}}</div>\n      <div class="yj-sidebar-history--item-contributors">\n        {{#contributors}}\n        <div class="yj-sidebar-history--item-contributor">\n          {{#show_color}}<div class="yj-sidebar-history--item-color author{{id}}"></div>{{/show_color}}<ContributorHovercardLink /><!--\n    --></div><!--\n    --><div class="yj-sidebar-history--item-contributor-comma">,</div>\n        {{/contributors}}\n      </div>\n    </div>\n  </div>\n  {{/items}}\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/sidebar_history/src/sidebar_history",[],function(){}),define("components/sidebar_history/src/sidebar_history",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/hovercard_link/index","core/lib/tr","core/lib/date_helper","./reverted_label","components/avatar/src/avatar","models/user","html!./sidebar_history","css!./sidebar_history"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("components/hovercard_link/index"),f=a("core/lib/tr"),g=a("core/lib/date_helper"),h=a("./reverted_label"),i=a("components/avatar/src/avatar"),j=a("models/user"),k=a("html!./sidebar_history");a("css!./sidebar_history");var l=function(a,b){return a.find(function(a){return a.id===parseInt(b,10)})},m=function(a){return g.formatMonthsAgo(new Date(a.created_at))};return b.extend({tagName:"div",className:"yj-sidebar-history",mixins:[c,d],template:k,attributes:{"data-qaid":"file_versions"},views:{Avatar:"_getAvatar",ContributorHovercardLink:"_getHovercardLink",RevertedLabel:"_getRevertedLabel"},initialize:function(){return this.options.strategy.initialize.apply(this,arguments)},getTemplateData:function(){return this.options.strategy.getTemplateData.apply(this,arguments)},_isCurrent:function(){return this.options.strategy.isCurrent.apply(this,arguments)},_getLinkHTML:function(a){return a.reverted_id?this._isCurrent(a)?f.t("sidebar_history_current_version_reverted",{reverted:'<RevertedLabel key="{$0}" />',from_version:a.id}):f.t("sidebar_history_version_reverted",{reverted:'<RevertedLabel key="{$0}" />',from_version:a.id,
time_ago:m(a)}):this._isCurrent(a)?f.t("sidebar_history_current_version"):f.t("sidebar_history_uploaded_ago",{time_ago:m(a)})},_getHovercardLink:function(a){var b=this.contributors[a];return new e({model:b})},_getRevertedLabel:function(a){var b,c=l(this.collection,a),d=l(this.collection,c.reverted_id);return b=this._isCurrent(c)?f.t("sidebar_history_current_reverted_label"):f.t("sidebar_history_reverted_label"),new h({to:c,from:d,label:b,model:this.model})},_getAvatar:function(a){var b=this.collection[a].published_by||this.collection[a].uploader_id;return new i({model:j.findById(b),size:96})}})}),define("components/sidebar_history/index",["require","./src/sidebar_history"],function(a){"use strict";return a("./src/sidebar_history")}),define("components/sidebar_history/src/strategies/note",["require","underscore","core/lib/urls","core/lib/tr","models/user","core/lib/date_helper"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/urls"),d=a("core/lib/tr"),e=a("models/user"),f=a("core/lib/date_helper"),g={PUBLISHED_BY:"sidebar_versions_published_by",TITLE:"sidebar_versions_note_title",PUBLISHED_AGO:"sidebar_versions_published_ago",CURRENT_VERSION:"sidebar_versions_current_version"},h=function(a,b){return new Date(b.created_at)-new Date(a.created_at)},i=function(){var a=this.model;this.collection=a.versions.sort(h),this.contributors=a.versions.reduce(function(a,b){return b.contributors=b.contributors.map(function(a){return e.findById(a)}),a.concat(b.contributors)},[])},j=function(){return{items:this.collection.map(function(a){return{selected:a.id===this.options.endVersion,show_color:a.id===this.options.endVersion,link:this._getLinkHTML(a),link_href:c.noteCompare(this.model,a),by_editor:d.t(g.PUBLISHED_BY),contributors:a.contributors,editor_id:a.published_by,date:f.formatDateTime(new Date(a.created_at))}}.bind(this)),title:d.t(g.TITLE),url:c.noteFollowers(this.model)}},k=function(a){return a.revision_number===this.model.latest_revision};return b.extend(g,{initialize:i,getTemplateData:j,isCurrent:k})}),define("css!workfeed/lib/app/views/note/compare",[],function(){}),define("stache!workfeed/lib/app/views/note/compare",["mustache"],function(a){var b='{{^loading}}\n<div class="yj-compare-note--header-container">\n  <Header />\n</div>\n<div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n  <div class="yk-row">\n    <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n      <div class="yj-selector-left-col yj-wide yj-scrollbar-fix">\n        <div class="yj-about-note--note-container" data-qaid="note_body">{{{body}}}</div>\n      </div>\n    </div>\n    <div class="yj-compare-note--right-sidebar-container">\n      <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6 ">\n        <Actions />\n        <Versions />\n      </div>\n    </div>\n  </div>\n</div>\n{{/loading}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/note/compare",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/sidebar_actions/index","components/sidebar_actions/src/strategies/note","components/sidebar_history/index","models/page","models/group","models/user","workfeed/lib/app/helpers/layout","core/lib/urls","core/lib/tr","core/lib/yammer_api","feeds/lib/ui/util/title_updater","models/helpers/group","core/lib/location_helper","core/lib/date_helper","./header","components/sidebar_history/src/strategies/note","core/lib/session","models/helpers/user","css!./compare","css!./paddie","html!./compare"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/sidebar_actions/index"),g=a("components/sidebar_actions/src/strategies/note"),h=a("components/sidebar_history/index"),i=a("models/page"),j=a("models/group"),k=a("models/user"),l=a("workfeed/lib/app/helpers/layout"),m=a("core/lib/urls"),n=a("core/lib/tr"),o=a("core/lib/yammer_api"),p=a("feeds/lib/ui/util/title_updater"),q=a("models/helpers/group"),r=a("core/lib/location_helper"),s=a("core/lib/date_helper"),t=a("./header"),u=a("components/sidebar_history/src/strategies/note"),v=a("core/lib/session"),w=a("models/helpers/user");a("css!./compare"),a("css!./paddie");var x=a("html!./compare"),y=function(a){var b=[].concat(a.references||[],a.external_references||[]);b.forEach(function(a){var b;"user"===a.type&&(b=k.findById(a.id),b||k.save(a))})},z=function(a){for(var b=[].concat(a.references||[],a.external_references||[]),c=0;c<b.length;c++){var d=b[c];if("group"===d.type&&d.id===a.group_id)return new j(d)}return j.ALL_COMPANY()},A=function(a){var c=[].concat(a.references||[],a.external_references||[]);return c.filter(function(a){return"topic"===a.type}).map(function(a){return a.name=b.escape(a.name),a})},B=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.id===b)return d}};return c.extend({mixins:[d,e],template:x,views:{Header:"_getHeader",Versions:"_getVersions",Actions:"_getActions"},className:l.twoColumnMainClass,attributes:{role:"main"},initialize:function(){b.bindAll(this,"_getMetadata","_processMetadata"),this.group=this.options.group,this._loaded()||this._fetchNote()},getTemplateData:function(){var a={loading:!0};return this.model&&!this.model.last_published_by?(r.replace(m.noteEdit({id:this.options.noteId})),a):this._loaded()?{body:this.model.difference}:a},_loaded:function(){return!(!this.model||!this.group)},_getHeader:function(){return new t({model:this.model,group:this.group,endVersion:this.options.endVersion,subpage_title:n.t("compare_note_breadcrumb"),version_warning:this._getVersionWarning()})},_getVersionWarning:function(){if(this._isCurrent())return n.t("compare_note_current_warning",{link:'<a href="'+m.noteIndex(this.model)+'" role="button">{$0}</a>'});var a=B(this.model.versions,this.options.endVersion);return n.t("compare_note_warning",{date:s.formatYearDateTime(new Date(a.created_at))})},_isCurrent:function(){return this.model.latest_version.id===this.options.endVersion},_getVersions:function(){return new h({model:this.model,endVersion:this.options.endVersion,strategy:u})},_fetchNote:function(){var a=this.options.noteId;this._getMetadata().then(this._processMetadata).fail(function(){r.replace(m.noteIndex({id:a}))})},_getMetadata:function(){return o.getNote({note_id:this.options.noteId,include_versions:!0,include_diff:!0,end_version:this.options.endVersion})},_processMetadata:function(a){this.model=i.create(a),this.group=z(a),p.setTitle(n.t("about_note_page_title",{note_title:this.model.name,group:q.getFullName(this.group)})),this._topics=A(this.model),y(a),this.model.following?w.followPage(v.getCurrentUser(),this.model.id):w.unfollowPage(v.getCurrentUser(),this.model.id),this.render()},_getActions:function(){var a=new f({model:this.model,group:this.group,endVersion:this.options.endVersion,strategy:g});return this.listenTo(a,"change",this.render),a}})}),define("paddie-client/lib/pad_utils",["require","jquery"],function(a){var b=a("jquery"),c={escapeHtml:function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},uniqueId:function(){function a(a,b){return(Array(b+1).join("0")+Number(a).toString(35)).slice(-b)}return[pad.getClientIp(),a(+new Date,7),a(Math.floor(1e9*Math.random()),4)].join(".")},uaDisplay:function(a){function b(a){var b=16;return a=a.replace(/[^a-zA-Z0-9\.]/g,""),a.length>b&&(a=a.substr(0,b)),a}function c(c){var d=a.match(RegExp(c+"\\/([\\d\\.]+)"));return d&&d.length>1?b(c+d[1]):null}var d;if(c("Firefox"))return c("Firefox");if(d=a.match(/compatible; ([^;]+);/),d&&d.length>1)return b(d[1]);if(a.match(/\(iPhone;/))return"iPhone";if(c("Chrome"))return c("Chrome");if(d=a.match(/Safari\/[\d\.]+/)){var e="?";return d=a.match(/Version\/([\d\.]+)/),d&&d.length>1&&(e=d[1]),b("Safari"+e)}var f=a.split(" ")[0];return b(f)},binarySearch:function(a,b){if(1>a)return 0;if(b(0))return 0;if(!b(a-1))return a;for(var c=0,d=a-1;d-c>1;){var e=Math.floor((c+d)/2);b(e)?d=e:c=e}return d},simpleDateTime:function(a){var b=new Date(+a),c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][b.getDay()],d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][b.getMonth()],e=b.getDate(),f=b.getFullYear(),g=b.getHours()+":"+("0"+b.getMinutes()).slice(-2);return c+" "+d+" "+e+" "+f+" "+g},findURLs:function(a){function b(a){e.lastIndex=0;for(var b,c=null;b=e.exec(a);){c=c||[];var d=b.index,f=b[0];c.push([d,f])}return c}var c=/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC]/,d=new RegExp("("+/[-:@a-zA-Z0-9_.,~%+\/?=&#;()$]/.source+"|"+c.source+")"),e=new RegExp(/(?:(?:https?|s?ftp|ftps|file|smb|afp|nfs|(x-)?man|gopher|txmt):\/\/|mailto:)/.source+d.source+"*(?![:.,;])"+d.source,"g");return b(a)},escapeHtmlWithClickableLinks:function(a,b){function d(b){b>e&&(f.push(c.escapeHtml(a.substring(e,b))),e=b)}var e=0,f=[],g=c.findURLs(a);if(g)for(var h=0;h<g.length;h++){var i=g[h][0],j=g[h][1];d(i),f.push("<a ",b?'target="'+c.escapeHtml(b)+'" ':"",'href="',c.escapeHtml(j),'">'),d(i+j.length),f.push("</a>")}return d(a.length),f.join("")},bindEnterAndEscape:function(a,b,c){b&&a.keypress(function(a){13==a.which&&b(a)}),c&&a.keydown(function(a){27==a.which&&c(a)})},timediff:function(a){function b(a,b){return a=Math.round(a),""+a+" "+b+(1!=a?"s":"")+" ago"}return a=Math.max(0,(+new Date-+a-pad.clientTimeOffset)/1e3),60>a?b(a,"second"):(a/=60,60>a?b(a,"minute"):(a/=60,24>a?b(a,"hour"):(a/=24,b(a,"day"))))},makeAnimationScheduler:function(a,b,c){function d(){e||(e=window.setTimeout(function(){e=null;for(var b=c,f=!0;f&&b>0;)f=a(),b--;f&&d()},b*c))}void 0===c&&(c=1);var e=null;return{scheduleAnimation:d}},makeShowHideAnimator:function(a,b,d,e){function f(){j=-1,a(j),m()}function g(){j=-1>j?-1:0>=j?j:Math.max(-1,Math.min(0,-j)),a(j),m()}function h(){j>=-1&&0>=j&&(j=1e-6,m())}function i(){return-1>j||0==j?!1:0>j?(j+=l,j>=0?(j=0,a(j),!1):(a(j),!0)):j>0?(j+=l,j>=1?(j=1,a(j),j=-2,!1):(a(j),!0)):void 0}var j=b?0:-2,k=1e3/d,l=k/e,m=c.makeAnimationScheduler(i,k).scheduleAnimation;return{show:f,hide:h,quickShow:g}},_nextActionId:1,uncanceledActions:{},getCancellableAction:function(a,b){var d=c.uncanceledActions[a];d||(d={},c.uncanceledActions[a]=d);var e=c._nextActionId++;return d[e]=!0,function(){var d=c.uncanceledActions[a];d&&d[e]&&b()}},cancelActions:function(a){var b=c.uncanceledActions[a];b&&delete c.uncanceledActions[a]},makeFieldLabeledWhenEmpty:function(a,c){function d(){a.addClass("editempty"),a.val(c)}return a=b(a),a.focus(function(){a.hasClass("editempty")&&a.val(""),a.removeClass("editempty")}),a.blur(function(){a.val()||d()}),{clear:d}},getCheckbox:function(a){return b(a).is(":checked")},setCheckbox:function(a,c){c?b(a).attr("checked","checked"):b(a).removeAttr("checked")},bindCheckboxChange:function(a,c){b(a).bind("click change",c)},encodeUserId:function(a){return a.replace(/[^a-y0-9]/g,function(a){return"."==a?"-":"z"+a.charCodeAt(0)+"z"})},decodeUserId:function(a){return a.replace(/[a-y0-9]+|-|z.+?z/g,function(a){return"-"==a?".":"z"==a.charAt(0)?String.fromCharCode(Number(a.slice(1,-1))):a})}};return c}),define("paddie-client/lib/chat",["require","jquery","paddie-client/lib/pad_utils"],function(a){var b=a("jquery"),c=a("paddie-client/lib/pad_utils"),d={show:function(){b("#chaticon").hide("slide",{direction:"down"},500,function(){b("#chatbox").show("slide",{direction:"down"},750,d.scrollDown),b("#chatbox").resizable({handles:"nw",start:function(a,c){b("#focusprotector").show()},stop:function(a,c){b("#focusprotector").hide(),b("#chatbox").css({right:"20px",bottom:"0px",left:"",top:""}),d.scrollDown()}})})},hide:function(){b("#chatcounter").text("0"),b("#chatbox").hide("slide",{direction:"down"},750,function(){b("#chaticon").show("slide",{direction:"down"},500)})},scrollDown:function(){"none"!=b("#chatbox").css("display")&&b("#chattext").animate({scrollTop:b("#chattext")[0].scrollHeight},"slow")},send:function(){var a=b("#chatinput").val();pad.collabClient.sendMessage({type:"CHAT_MESSAGE",text:a}),b("#chatinput").val("")},addMessage:function(a,e){a.time+=pad.clientTimeOffset;var f=""+new Date(a.time).getMinutes(),g=""+new Date(a.time).getHours();1==f.length&&(f="0"+f),1==g.length&&(g="0"+g);var h=g+":"+f,i="author-"+a.userId.replace(/[^a-y0-9]/g,function(a){return"."==a?"-":"z"+a.charCodeAt(0)+"z"}),j=c.escapeHtmlWithClickableLinks(c.escapeHtml(a.text),"_blank"),k=null==a.userName?"unnamed":c.escapeHtml(a.userName),l="<p class='"+i+"'><b>"+k+":</b><span class='time'>"+h+"</span> "+j+"</p>";if(b("#chattext").append(l),e){var m=Number(b("#chatcounter").text());m++,b("#chatcounter").text(m),b("#chatthrob").html("<b>"+k+"</b>: "+j),b("#chatthrob").effect("pulsate",{times:1,mode:"hide"},2e3)}d.scrollDown()},init:function(){b("#chatinput").keypress(function(a){13==a.which&&(a.preventDefault(),d.send())});var a=pad.clientVars;for(var c in a.chatHistory)this.addMessage(a.chatHistory[c],!1);b("#chatcounter").text(a.chatHistory.length)}};return d});/*! Socket.IO.js build:0.9.10, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */
var io="undefined"==typeof module?{}:module.exports;!function(){/*	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/
if(/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b){var c=a;c.version="0.9.10",c.protocol=1,c.transports=[],c.j=[],c.sockets={},c.connect=function(a,d){var e,f,g=c.util.parseUri(a);b&&b.location&&(g.protocol=g.protocol||b.location.protocol.slice(0,-1),g.host=g.host||(b.document?b.document.domain:b.location.hostname),g.port=g.port||b.location.port),e=c.util.uniqueUri(g);var h={host:g.host,secure:"https"==g.protocol,port:g.port||("https"==g.protocol?443:80),query:g.query||""};return c.util.merge(h,d),!h["force new connection"]&&c.sockets[e]||(f=new c.Socket(h)),!h["force new connection"]&&f&&(c.sockets[e]=f),f=f||c.sockets[e],f.of(g.path.length>1?g.path:"")}}("object"==typeof module?module.exports:this.io={},this),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b){var c=a.util={},d=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];c.parseUri=function(a){for(var b=d.exec(a||""),c={},f=14;f--;)c[e[f]]=b[f]||"";return c},c.uniqueUri=function(a){var c=a.protocol,d=a.host,e=a.port;return"document"in b?(d=d||document.domain,e=e||("https"==c&&"https:"!==document.location.protocol?443:document.location.port)):(d=d||"localhost",e||"https"!=c||(e=443)),(c||"http")+"://"+d+":"+(e||80)},c.query=function(a,b){var d=c.chunkQuery(a||""),e=[];c.merge(d,c.chunkQuery(b||""));for(var f in d)d.hasOwnProperty(f)&&e.push(f+"="+d[f]);return e.length?"?"+e.join("&"):""},c.chunkQuery=function(a){for(var b,c={},d=a.split("&"),e=0,f=d.length;f>e;++e)b=d[e].split("="),b[0]&&(c[b[0]]=b[1]);return c};var f=!1;c.load=function(a){return"document"in b&&"complete"===document.readyState||f?a():void c.on(b,"load",a,!1)},c.on=function(a,b,c,d){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,d)},c.request=function(a){if(a&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!a||c.ua.hasCORS))return new XMLHttpRequest;if(!a)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(a){}return null},"undefined"!=typeof window&&c.load(function(){f=!0}),c.defer=function(a){return c.ua.webkit&&"undefined"==typeof importScripts?void c.load(function(){setTimeout(a,100)}):a()},c.merge=function(a,b,d,e){var f,g=e||[],h="undefined"==typeof d?2:d;for(f in b)b.hasOwnProperty(f)&&c.indexOf(g,f)<0&&("object"==typeof a[f]&&h?c.merge(a[f],b[f],h-1,g):(a[f]=b[f],g.push(b[f])));return a},c.mixin=function(a,b){c.merge(a.prototype,b.prototype)},c.inherit=function(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c},c.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},c.intersect=function(a,b){for(var d=[],e=a.length>b.length?a:b,f=a.length>b.length?b:a,g=0,h=f.length;h>g;g++)~c.indexOf(e,f[g])&&d.push(f[g]);return d},c.indexOf=function(a,b,c){for(var d=a.length,c=0>c?0>c+d?0:c+d:c||0;d>c&&a[c]!==b;c++);return c>=d?-1:c},c.toArray=function(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(a[c]);return b},c.ua={},c.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var a=new XMLHttpRequest}catch(a){return!1}return void 0!=a.withCredentials}(),c.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),c.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b){function c(){}a.EventEmitter=c,c.prototype.on=function(a,c){return this.$events||(this.$events={}),this.$events[a]?b.util.isArray(this.$events[a])?this.$events[a].push(c):this.$events[a]=[this.$events[a],c]:this.$events[a]=c,this},c.prototype.addListener=c.prototype.on,c.prototype.once=function(a,b){function c(){d.removeListener(a,c),b.apply(this,arguments)}var d=this;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,c){if(this.$events&&this.$events[a]){var d=this.$events[a];if(b.util.isArray(d)){for(var e=-1,f=0,g=d.length;g>f;f++)if(d[f]===c||d[f].listener&&d[f].listener===c){e=f;break}if(0>e)return this;d.splice(e,1),d.length||delete this.$events[a]}else(d===c||d.listener&&d.listener===c)&&delete this.$events[a]}return this},c.prototype.removeAllListeners=function(a){return void 0===a?(this.$events={},this):(this.$events&&this.$events[a]&&(this.$events[a]=null),this)},c.prototype.listeners=function(a){return this.$events||(this.$events={}),this.$events[a]||(this.$events[a]=[]),b.util.isArray(this.$events[a])||(this.$events[a]=[this.$events[a]]),this.$events[a]},c.prototype.emit=function(a){if(!this.$events)return!1;var c=this.$events[a];if(!c)return!1;var d=Array.prototype.slice.call(arguments,1);if("function"==typeof c)c.apply(this,d);else{if(!b.util.isArray(c))return!1;for(var e=c.slice(),f=0,g=e.length;g>f;f++)e[f].apply(this,d)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(exports,nativeJSON){"use strict";function f(a){return 10>a?"0"+a:a}function date(a,b){return isFinite(a.valueOf())?a.getUTCFullYear()+"-"+f(a.getUTCMonth()+1)+"-"+f(a.getUTCDate())+"T"+f(a.getUTCHours())+":"+f(a.getUTCMinutes())+":"+f(a.getUTCSeconds())+"Z":null}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i instanceof Date&&(i=date(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})},JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b){var c=a.parser={},d=c.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],e=c.reasons=["transport not supported","client not handshaken","unauthorized"],f=c.advice=["reconnect"],g=b.JSON,h=b.util.indexOf;c.encodePacket=function(a){var b=h(d,a.type),c=a.id||"",i=a.endpoint||"",j=a.ack,k=null;switch(a.type){case"error":var l=a.reason?h(e,a.reason):"",m=a.advice?h(f,a.advice):"";""===l&&""===m||(k=l+(""!==m?"+"+m:""));break;case"message":""!==a.data&&(k=a.data);break;case"event":var n={name:a.name};a.args&&a.args.length&&(n.args=a.args),k=g.stringify(n);break;case"json":k=g.stringify(a.data);break;case"connect":a.qs&&(k=a.qs);break;case"ack":k=a.ackId+(a.args&&a.args.length?"+"+g.stringify(a.args):"")}var o=[b,c+("data"==j?"+":""),i];return null!==k&&void 0!==k&&o.push(k),o.join(":")},c.encodePayload=function(a){var b="";if(1==a.length)return a[0];for(var c=0,d=a.length;d>c;c++){var e=a[c];b+="�"+e.length+"�"+a[c]}return b};var i=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;c.decodePacket=function(a){var b=a.match(i);if(!b)return{};var c=b[2]||"",a=b[5]||"",h={type:d[b[1]],endpoint:b[4]||""};switch(c&&(h.id=c,b[3]?h.ack="data":h.ack=!0),h.type){case"error":var b=a.split("+");h.reason=e[b[0]]||"",h.advice=f[b[1]]||"";break;case"message":h.data=a||"";break;case"event":try{var j=g.parse(a);h.name=j.name,h.args=j.args}catch(a){}h.args=h.args||[];break;case"json":try{h.data=g.parse(a)}catch(a){}break;case"connect":h.qs=a||"";break;case"ack":var b=a.match(/^([0-9]+)(\+)?(.*)/);if(b&&(h.ackId=b[1],h.args=[],b[3]))try{h.args=b[3]?g.parse(b[3]):[]}catch(a){}break;case"disconnect":case"heartbeat":}return h},c.decodePayload=function(a){if("�"==a.charAt(0)){for(var b=[],d=1,e="";d<a.length;d++)"�"==a.charAt(d)?(b.push(c.decodePacket(a.substr(d+1).substr(0,e))),d+=Number(e)+1,e=""):e+=a.charAt(d);return b}return[c.decodePacket(a)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b){function c(a,b){this.socket=a,this.sessid=b}a.Transport=c,b.util.mixin(c,b.EventEmitter),c.prototype.heartbeats=function(){return!0},c.prototype.onData=function(a){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==a){var c=b.parser.decodePayload(a);if(c&&c.length)for(var d=0,e=c.length;e>d;d++)this.onPacket(c[d])}return this},c.prototype.onPacket=function(a){return this.socket.setHeartbeatTimeout(),"heartbeat"==a.type?this.onHeartbeat():("connect"==a.type&&""==a.endpoint&&this.onConnect(),"error"==a.type&&"reconnect"==a.advice&&(this.isOpen=!1),this.socket.onPacket(a),this)},c.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var a=this;this.closeTimeout=setTimeout(function(){a.onDisconnect()},this.socket.closeTimeout)}},c.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},c.prototype.onConnect=function(){return this.socket.onConnect(),this},c.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},c.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},c.prototype.packet=function(a){this.send(b.parser.encodePacket(a))},c.prototype.onHeartbeat=function(a){this.packet({type:"heartbeat"})},c.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},c.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},c.prototype.prepareUrl=function(){var a=this.socket.options;return this.scheme()+"://"+a.host+":"+a.port+"/"+a.resource+"/"+b.protocol+"/"+this.name+"/"+this.sessid},c.prototype.ready=function(a,b){b.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b,c){function d(a){if(this.options={port:80,secure:!1,document:"document"in c?document:!1,resource:"socket.io",transports:b.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},b.util.merge(this.options,a),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||b.util.ua.hasCORS)){var d=this;b.util.on(c,"beforeunload",function(){d.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function e(){}a.Socket=d,b.util.mixin(d,b.EventEmitter),d.prototype.of=function(a){return this.namespaces[a]||(this.namespaces[a]=new b.SocketNamespace(this,a),""!==a&&this.namespaces[a].packet({type:"connect"})),this.namespaces[a]},d.prototype.publish=function(){this.emit.apply(this,arguments);var a;for(var b in this.namespaces)this.namespaces.hasOwnProperty(b)&&(a=this.of(b),a.$emit.apply(a,arguments))},d.prototype.handshake=function(a){function c(b){b instanceof Error?(d.connecting=!1,d.onError(b.message)):a.apply(null,b.split(":"))}var d=this,f=this.options,g=["http"+(f.secure?"s":"")+":/",f.host+":"+f.port,f.resource,b.protocol,b.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!b.util.ua.hasCORS){var h=document.getElementsByTagName("script")[0],i=document.createElement("script");i.src=g+"&jsonp="+b.j.length,h.parentNode.insertBefore(i,h),b.j.push(function(a){c(a),i.parentNode.removeChild(i)})}else{var j=b.util.request();j.open("GET",g,!0),this.isXDomain()&&(j.withCredentials=!0),j.onreadystatechange=function(){4==j.readyState&&(j.onreadystatechange=e,200==j.status?c(j.responseText):403==j.status?d.onError(j.responseText):(d.connecting=!1,!d.reconnecting&&d.onError(j.responseText)))},j.send(null)}},d.prototype.getTransport=function(a){for(var c,d=a||this.transports,e=0;c=d[e];e++)if(b.Transport[c]&&b.Transport[c].check(this)&&(!this.isXDomain()||b.Transport[c].xdomainCheck(this)))return new b.Transport[c](this,this.sessionid);return null},d.prototype.connect=function(a){if(this.connecting)return this;var c=this;return c.connecting=!0,this.handshake(function(d,e,f,g){function h(a){return c.transport&&c.transport.clearTimeouts(),c.transport=c.getTransport(a),c.transport?void c.transport.ready(c,function(){c.connecting=!0,c.publish("connecting",c.transport.name),c.transport.open(),c.options["connect timeout"]&&(c.connectTimeoutTimer=setTimeout(function(){if(!c.connected&&(c.connecting=!1,c.options["try multiple transports"])){for(var a=c.transports;a.length>0&&a.splice(0,1)[0]!=c.transport.name;);a.length?h(a):c.publish("connect_failed")}},c.options["connect timeout"]))}):c.publish("connect_failed")}c.sessionid=d,c.closeTimeout=1e3*f,c.heartbeatTimeout=1e3*e,c.transports||(c.transports=c.origTransports=g?b.util.intersect(g.split(","),c.options.transports):c.options.transports),c.setHeartbeatTimeout(),h(c.transports),c.once("connect",function(){clearTimeout(c.connectTimeoutTimer),a&&"function"==typeof a&&a()})}),this},d.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var a=this;this.heartbeatTimeoutTimer=setTimeout(function(){a.transport.onClose()},this.heartbeatTimeout)}},d.prototype.packet=function(a){return this.connected&&!this.doBuffer?this.transport.packet(a):this.buffer.push(a),this},d.prototype.setBuffer=function(a){this.doBuffer=a,!a&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},d.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},d.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},d.prototype.disconnectSync=function(){var a=b.util.request(),c=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,b.protocol,"",this.sessionid].join("/")+"/?disconnect=1";a.open("GET",c,!1),a.send(null),this.onDisconnect("booted")},d.prototype.isXDomain=function(){var a=c.location.port||("https:"==c.location.protocol?443:80);return this.options.host!==c.location.hostname||this.options.port!=a},d.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},d.prototype.onOpen=function(){this.open=!0},d.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},d.prototype.onPacket=function(a){this.of(a.endpoint).onPacket(a)},d.prototype.onError=function(a){a&&a.advice&&"reconnect"===a.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",a&&a.reason?a.reason:a)},d.prototype.onDisconnect=function(a){var b=this.connected,c=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(b||c)&&(this.transport.close(),this.transport.clearTimeouts(),b&&(this.publish("disconnect",a),"booted"!=a&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},d.prototype.reconnect=function(){function a(){if(c.connected){for(var a in c.namespaces)c.namespaces.hasOwnProperty(a)&&""!==a&&c.namespaces[a].packet({type:"connect"});c.publish("reconnect",c.transport.name,c.reconnectionAttempts)}clearTimeout(c.reconnectionTimer),c.removeListener("connect_failed",b),c.removeListener("connect",b),c.reconnecting=!1,delete c.reconnectionAttempts,delete c.reconnectionDelay,delete c.reconnectionTimer,delete c.redoTransports,c.options["try multiple transports"]=e}function b(){return c.reconnecting?c.connected?a():c.connecting&&c.reconnecting?c.reconnectionTimer=setTimeout(b,1e3):void(c.reconnectionAttempts++>=d?c.redoTransports?(c.publish("reconnect_failed"),a()):(c.on("connect_failed",b),c.options["try multiple transports"]=!0,c.transports=c.origTransports,c.transport=c.getTransport(),c.redoTransports=!0,c.connect()):(c.reconnectionDelay<f&&(c.reconnectionDelay*=2),c.connect(),c.publish("reconnecting",c.reconnectionDelay,c.reconnectionAttempts),c.reconnectionTimer=setTimeout(b,c.reconnectionDelay))):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var c=this,d=this.options["max reconnection attempts"],e=this.options["try multiple transports"],f=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(b,this.reconnectionDelay),this.on("connect",b)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b){function c(a,b){this.socket=a,this.name=b||"",this.flags={},this.json=new d(this,"json"),this.ackPackets=0,this.acks={}}function d(a,b){this.namespace=a,this.name=b}a.SocketNamespace=c,b.util.mixin(c,b.EventEmitter),c.prototype.$emit=b.EventEmitter.prototype.emit,c.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},c.prototype.packet=function(a){return a.endpoint=this.name,this.socket.packet(a),this.flags={},this},c.prototype.send=function(a,b){var c={type:this.flags.json?"json":"message",data:a};return"function"==typeof b&&(c.id=++this.ackPackets,c.ack=!0,this.acks[c.id]=b),this.packet(c)},c.prototype.emit=function(a){var b=Array.prototype.slice.call(arguments,1),c=b[b.length-1],d={type:"event",name:a};return"function"==typeof c&&(d.id=++this.ackPackets,d.ack="data",this.acks[d.id]=c,b=b.slice(0,b.length-1)),d.args=b,this.packet(d)},c.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},c.prototype.onPacket=function(a){function c(){d.packet({type:"ack",args:b.util.toArray(arguments),ackId:a.id})}var d=this;switch(a.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(a.reason||"booted"):this.$emit("disconnect",a.reason);break;case"message":case"json":var e=["message",a.data];"data"==a.ack?e.push(c):a.ack&&this.packet({type:"ack",ackId:a.id}),this.$emit.apply(this,e);break;case"event":var e=[a.name].concat(a.args);"data"==a.ack&&e.push(c),this.$emit.apply(this,e);break;case"ack":this.acks[a.ackId]&&(this.acks[a.ackId].apply(this,a.args),delete this.acks[a.ackId]);break;case"error":a.advice?this.socket.onError(a):"unauthorized"==a.reason?this.$emit("connect_failed",a.reason):this.$emit("error",a.reason)}},d.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},d.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b,c){function d(a){b.Transport.apply(this,arguments)}a.websocket=d,b.util.inherit(d,b.Transport),d.prototype.name="websocket",d.prototype.open=function(){var a,d=b.util.query(this.socket.options.query),e=this;return a||(a=c.MozWebSocket||c.WebSocket),this.websocket=new a(this.prepareUrl()+d),this.websocket.onopen=function(){e.onOpen(),e.socket.setBuffer(!1)},this.websocket.onmessage=function(a){e.onData(a.data)},this.websocket.onclose=function(){e.onClose(),e.socket.setBuffer(!0)},this.websocket.onerror=function(a){e.onError(a)},this},b.util.ua.iDevice?d.prototype.send=function(a){var b=this;return setTimeout(function(){b.websocket.send(a)},0),this}:d.prototype.send=function(a){return this.websocket.send(a),this},d.prototype.payload=function(a){for(var b=0,c=a.length;c>b;b++)this.packet(a[b]);return this},d.prototype.close=function(){return this.websocket.close(),this},d.prototype.onError=function(a){this.socket.onError(a)},d.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},d.check=function(){return"WebSocket"in c&&!("__addTask"in WebSocket)||"MozWebSocket"in c},d.xdomainCheck=function(){return!0},b.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b){function c(){b.Transport.websocket.apply(this,arguments)}a.flashsocket=c,b.util.inherit(c,b.Transport.websocket),c.prototype.name="flashsocket",c.prototype.open=function(){var a=this,c=arguments;return WebSocket.__addTask(function(){b.Transport.websocket.prototype.open.apply(a,c)}),this},c.prototype.send=function(){var a=this,c=arguments;return WebSocket.__addTask(function(){b.Transport.websocket.prototype.send.apply(a,c)}),this},c.prototype.close=function(){return WebSocket.__tasks.length=0,b.Transport.websocket.prototype.close.call(this),this},c.prototype.ready=function(a,d){function e(){var b=a.options,e=b["flash policy port"],g=["http"+(b.secure?"s":"")+":/",b.host+":"+b.port,b.resource,"static/flashsocket","WebSocketMain"+(a.isXDomain()?"Insecure":"")+".swf"];c.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=g.join("/")),843!==e&&WebSocket.loadFlashPolicyFile("xmlsocket://"+b.host+":"+e),WebSocket.__initialize(),c.loaded=!0),d.call(f)}var f=this;return document.body?e():void b.util.load(e)},c.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},c.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),b.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function a(){if(!R){try{var a=K.getElementsByTagName("body")[0].appendChild(q("span"));a.parentNode.removeChild(a)}catch(a){return}R=!0;for(var b=N.length,c=0;b>c;c++)N[c]()}}function b(a){R?a():N[N.length]=a}function c(a){if(typeof J.addEventListener!=C)J.addEventListener("load",a,!1);else if(typeof K.addEventListener!=C)K.addEventListener("load",a,!1);else if(typeof J.attachEvent!=C)r(J,"onload",a);else if("function"==typeof J.onload){var b=J.onload;J.onload=function(){b(),a()}}else J.onload=a}function d(){M?e():f()}function e(){var a=K.getElementsByTagName("body")[0],b=q(D);b.setAttribute("type",G);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=C){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),U.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(10>d)return d++,void setTimeout(arguments.callee,10);a.removeChild(b),c=null,f()}()}else f()}function f(){var a=O.length;if(a>0)for(var b=0;a>b;b++){var c=O[b].id,d=O[b].callbackFn,e={success:!1,id:c};if(U.pv[0]>0){var f=p(c);if(f)if(!s(O[b].swfVersion)||U.wk&&U.wk<312)if(O[b].expressInstall&&h()){var k={};k.data=O[b].expressInstall,k.width=f.getAttribute("width")||"0",k.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(k.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(k.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;n>o;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));i(k,l,c,d)}else j(f),d&&d(e);else u(c,!0),d&&(e.success=!0,e.ref=g(c),d(e))}else if(u(c,!0),d){var q=g(c);q&&typeof q.SetVariable!=C&&(e.success=!0,e.ref=q),d(e)}}}function g(a){var b=null,c=p(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=C)b=c;else{var d=c.getElementsByTagName(D)[0];d&&(b=d)}return b}function h(){return!S&&s("6.0.65")&&(U.win||U.mac)&&!(U.wk&&U.wk<312)}function i(a,b,c,d){S=!0,y=d||null,z={success:!1,id:c};var e=p(c);if(e){"OBJECT"==e.nodeName?(w=k(e),x=null):(w=e,x=c),a.id=H,(typeof a.width==C||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==C||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),K.title=K.title.slice(0,47)+" - Flash Player Installation";var f=U.ie&&U.win?["Active"].concat("").join("X"):"PlugIn",g="MMredirectURL="+J.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+K.title;if(typeof b.flashvars!=C?b.flashvars+="&"+g:b.flashvars=g,U.ie&&U.win&&4!=e.readyState){var h=q("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}l(a,b,c)}}function j(a){if(U.ie&&U.win&&4!=a.readyState){var b=q("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(k(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(k(a),a)}function k(a){var b=q("div");if(U.win&&U.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(D)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;e>f;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function l(a,b,c){var d,e=p(c);if(U.wk&&U.wk<312)return d;if(e)if(typeof a.id==C&&(a.id=c),U.ie&&U.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",P[P.length]=a.id,d=p(a.id)}else{var j=q(D);j.setAttribute("type",G);for(var k in a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&m(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function m(a,b,c){var d=q("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function n(a){var b=p(a);b&&"OBJECT"==b.nodeName&&(U.ie&&U.win?(b.style.display="none",function(){4==b.readyState?o(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function o(a){var b=p(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function p(a){var b=null;try{b=K.getElementById(a)}catch(a){}return b}function q(a){return K.createElement(a)}function r(a,b,c){a.attachEvent(b,c),Q[Q.length]=[a,b,c]}function s(a){var b=U.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]}function t(a,b,c,d){if(!U.ie||!U.mac){var e=K.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(A=null,B=null),!A||B!=f){var g=q("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),A=e.appendChild(g),U.ie&&U.win&&typeof K.styleSheets!=C&&K.styleSheets.length>0&&(A=K.styleSheets[K.styleSheets.length-1]),B=f}U.ie&&U.win?A&&typeof A.addRule==D&&A.addRule(a,b):A&&typeof K.createTextNode!=C&&A.appendChild(K.createTextNode(a+" {"+b+"}"))}}}function u(a,b){if(T){var c=b?"visible":"hidden";R&&p(a)?p(a).style.visibility=c:t("#"+a,"visibility:"+c)}}function v(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c&&typeof encodeURIComponent!=C?encodeURIComponent(a):a}var w,x,y,z,A,B,C="undefined",D="object",E="Shockwave Flash",F="ShockwaveFlash.ShockwaveFlash",G="application/x-shockwave-flash",H="SWFObjectExprInst",I="onreadystatechange",J=window,K=document,L=navigator,M=!1,N=[d],O=[],P=[],Q=[],R=!1,S=!1,T=!0,U=function(){var a=typeof K.getElementById!=C&&typeof K.getElementsByTagName!=C&&typeof K.createElement!=C,b=L.userAgent.toLowerCase(),c=L.platform.toLowerCase(),d=c?/win/.test(c):/win/.test(b),e=c?/mac/.test(c):/mac/.test(b),f=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,g=!1,h=[0,0,0],i=null;if(typeof L.plugins!=C&&typeof L.plugins[E]==D)i=L.plugins[E].description,!i||typeof L.mimeTypes!=C&&L.mimeTypes[G]&&!L.mimeTypes[G].enabledPlugin||(M=!0,g=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof J[["Active"].concat("Object").join("X")]!=C)try{var j=new(window[["Active"].concat("Object").join("X")])(F);j&&(i=j.GetVariable("$version"),i&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(a){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();(function(){U.w3&&((typeof K.readyState!=C&&"complete"==K.readyState||typeof K.readyState==C&&(K.getElementsByTagName("body")[0]||K.body))&&a(),R||(typeof K.addEventListener!=C&&K.addEventListener("DOMContentLoaded",a,!1),U.ie&&U.win&&(K.attachEvent(I,function(){"complete"==K.readyState&&(K.detachEvent(I,arguments.callee),a())}),J==top&&!function(){if(!R){try{K.documentElement.doScroll("left")}catch(a){return void setTimeout(arguments.callee,0)}a()}}()),U.wk&&!function(){return R?void 0:/loaded|complete/.test(K.readyState)?void a():void setTimeout(arguments.callee,0)}(),c(a)))})(),function(){U.ie&&U.win&&window.attachEvent("onunload",function(){for(var a=Q.length,b=0;a>b;b++)Q[b][0].detachEvent(Q[b][1],Q[b][2]);for(var c=P.length,d=0;c>d;d++)n(P[d]);for(var e in U)U[e]=null;U=null;for(var f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(a,b,c,d){if(U.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,O[O.length]=e,u(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){return U.w3?g(a):void 0},embedSWF:function(a,c,d,e,f,g,j,k,m,n){var o={success:!1,id:c};U.w3&&!(U.wk&&U.wk<312)&&a&&c&&d&&e&&f?(u(c,!1),b(function(){d+="",e+="";var b={};if(m&&typeof m===D)for(var p in m)b[p]=m[p];b.data=a,b.width=d,b.height=e;var q={};if(k&&typeof k===D)for(var r in k)q[r]=k[r];if(j&&typeof j===D)for(var t in j)typeof q.flashvars!=C?q.flashvars+="&"+t+"="+j[t]:q.flashvars=t+"="+j[t];if(s(f)){var v=l(b,q,c);b.id==c&&u(c,!0),o.success=!0,o.ref=v}else{if(g&&h())return b.data=g,void i(b,q,c,n);u(c,!0)}n&&n(o)})):n&&n(o)},switchOffAutoHideShow:function(){T=!1},ua:U,getFlashPlayerVersion:function(){return{major:U.pv[0],minor:U.pv[1],release:U.pv[2]}},hasFlashPlayerVersion:s,createSWF:function(a,b,c){return U.w3?l(a,b,c):void 0},showExpressInstall:function(a,b,c,d){U.w3&&h()&&i(a,b,c,d)},removeSWF:function(a){U.w3&&n(a)},createCSS:function(a,b,c,d){U.w3&&t(a,b,c,d)},addDomLoadEvent:b,addLoadEvent:c,getQueryParamValue:function(a){var b=K.location.search||K.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return v(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return v(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(S){var a=p(H);a&&w&&(a.parentNode.replaceChild(w,a),x&&(u(x,!0),U.ie&&U.win&&(w.style.display="block")),y&&y(z)),S=!1}}}}();
// Copyright: Hiroshi Ichikawa <http://gimite.net/en/>
// License: New BSD License
!function(){if("undefined"!=typeof window&&!window.WebSocket){var a=window.console;if(a&&a.log&&a.error||(a={log:function(){},error:function(){}}),!swfobject.hasFlashPlayerVersion("10.0.0"))return void a.error("Flash Player >= 10.0.0 is required.");"file:"==location.protocol&&a.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(a,b,c,d,e){var f=this;f.__id=WebSocket.__nextId++,WebSocket.__instances[f.__id]=f,f.readyState=WebSocket.CONNECTING,f.bufferedAmount=0,f.__events={},b?"string"==typeof b&&(b=[b]):b=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(f.__id,a,b,c||null,d||0,e||null)})},0)},WebSocket.prototype.send=function(a){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var b=WebSocket.__flash.send(this.__id,encodeURIComponent(a));return 0>b?!0:(this.bufferedAmount+=b,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(a,b,c){a in this.__events||(this.__events[a]=[]),this.__events[a].push(b)},WebSocket.prototype.removeEventListener=function(a,b,c){if(a in this.__events)for(var d=this.__events[a],e=d.length-1;e>=0;--e)if(d[e]===b){d.splice(e,1);break}},WebSocket.prototype.dispatchEvent=function(a){for(var b=this.__events[a.type]||[],c=0;c<b.length;++c)b[c](a);var d=this["on"+a.type];d&&d(a)},WebSocket.prototype.__handleEvent=function(a){"readyState"in a&&(this.readyState=a.readyState),"protocol"in a&&(this.protocol=a.protocol);var b;if("open"==a.type||"error"==a.type)b=this.__createSimpleEvent(a.type);else if("close"==a.type)b=this.__createSimpleEvent("close");else{if("message"!=a.type)throw"unknown event type: "+a.type;var c=decodeURIComponent(a.message);b=this.__createMessageEvent("message",c)}this.dispatchEvent(b)},WebSocket.prototype.__createSimpleEvent=function(a){if(document.createEvent&&window.Event){var b=document.createEvent("Event");return b.initEvent(a,!1,!1),b}return{type:a,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(a,b){if(document.createEvent&&window.MessageEvent&&!window.opera){var c=document.createEvent("MessageEvent");return c.initMessageEvent("message",!1,!1,b,null,null,window,null),c}return{type:a,data:b,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(a){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(a)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return void a.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");var b=document.createElement("div");b.id="webSocketContainer",b.style.position="absolute",WebSocket.__isFlashLite()?(b.style.left="0px",b.style.top="0px"):(b.style.left="-100px",b.style.top="-100px");var c=document.createElement("div");c.id="webSocketFlash",b.appendChild(c),document.body.appendChild(b),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(b){b.success||a.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var a=0;a<WebSocket.__tasks.length;++a)WebSocket.__tasks[a]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var b=WebSocket.__flash.receiveEvents(),c=0;c<b.length;++c)WebSocket.__instances[b[c].webSocketId].__handleEvent(b[c])}catch(b){a.error(b)}},0),!0},WebSocket.__log=function(b){a.log(decodeURIComponent(b))},WebSocket.__error=function(b){a.error(decodeURIComponent(b))},WebSocket.__addTask=function(a){WebSocket.__flash?a():WebSocket.__tasks.push(a)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var a=window.navigator.mimeTypes["application/x-shockwave-flash"];return a&&a.enabledPlugin&&a.enabledPlugin.filename?!!a.enabledPlugin.filename.match(/flashlite/i):!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))}}(),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b,c){function d(a){a&&(b.Transport.apply(this,arguments),this.sendBuffer=[])}function e(){}a.XHR=d,b.util.inherit(d,b.Transport),d.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},d.prototype.payload=function(a){for(var c=[],d=0,e=a.length;e>d;d++)c.push(b.parser.encodePacket(a[d]));this.send(b.parser.encodePayload(c))},d.prototype.send=function(a){return this.post(a),this},d.prototype.post=function(a){function b(){4==this.readyState&&(this.onreadystatechange=e,f.posting=!1,200==this.status?f.socket.setBuffer(!1):f.onClose())}function d(){this.onload=e,f.socket.setBuffer(!1)}var f=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),c.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=d:this.sendXHR.onreadystatechange=b,this.sendXHR.send(a)},d.prototype.close=function(){return this.onClose(),this},d.prototype.request=function(a){var c=b.util.request(this.socket.isXDomain()),d=b.util.query(this.socket.options.query,"t="+ +new Date);if(c.open(a||"GET",this.prepareUrl()+d,!0),"POST"==a)try{c.setRequestHeader?c.setRequestHeader("Content-type","text/plain;charset=UTF-8"):c.contentType="text/plain"}catch(a){}return c},d.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},d.check=function(a,d){try{var e=b.util.request(d),f=c.XDomainRequest&&e instanceof XDomainRequest,g=a&&a.options&&a.options.secure?"https:":"http:",h=g!=c.location.protocol;if(e&&(!f||!h))return!0}catch(a){}return!1},d.xdomainCheck=function(a){return d.check(a,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b){function c(a){b.Transport.XHR.apply(this,arguments)}a.htmlfile=c,b.util.inherit(c,b.Transport.XHR),c.prototype.name="htmlfile",c.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var a=this.doc.createElement("div");a.className="socketio",this.doc.body.appendChild(a),this.iframe=this.doc.createElement("iframe"),a.appendChild(this.iframe);var c=this,d=b.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+d,b.util.on(window,"unload",function(){c.destroy()})},c.prototype._=function(a,b){this.onData(a);try{var c=b.getElementsByTagName("script")[0];c.parentNode.removeChild(c)}catch(a){}},c.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(a){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},c.prototype.close=function(){return this.destroy(),b.Transport.XHR.prototype.close.call(this)},c.check=function(a){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var c=new(window[["Active"].concat("Object").join("X")])("htmlfile");return c&&b.Transport.XHR.check(a)}catch(a){}return!1},c.xdomainCheck=function(){return!1},b.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b,c){function d(){b.Transport.XHR.apply(this,arguments)}function e(){}a["xhr-polling"]=d,b.util.inherit(d,b.Transport.XHR),b.util.merge(d,b.Transport.XHR),d.prototype.name="xhr-polling",d.prototype.heartbeats=function(){return!1},d.prototype.open=function(){var a=this;return b.Transport.XHR.prototype.open.call(a),!1},d.prototype.get=function(){function a(){4==this.readyState&&(this.onreadystatechange=e,200==this.status?(f.onData(this.responseText),f.get()):f.onClose())}function b(){this.onload=e,this.onerror=e,f.onData(this.responseText),f.get()}function d(){f.onClose()}if(this.isOpen){var f=this;this.xhr=this.request(),c.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=b,this.xhr.onerror=d):this.xhr.onreadystatechange=a,this.xhr.send(null)}},d.prototype.onClose=function(){if(b.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=e;try{this.xhr.abort()}catch(a){}this.xhr=null}},d.prototype.ready=function(a,c){var d=this;b.util.defer(function(){c.call(d)})},b.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */
function(a,b,c){function d(a){b.Transport["xhr-polling"].apply(this,arguments),this.index=b.j.length;var c=this;b.j.push(function(a){c._(a)})}var e=c.document&&"MozAppearance"in c.document.documentElement.style;a["jsonp-polling"]=d,b.util.inherit(d,b.Transport["xhr-polling"]),d.prototype.name="jsonp-polling",d.prototype.post=function(a){function c(){d(),e.socket.setBuffer(!1)}function d(){e.iframe&&e.form.removeChild(e.iframe);try{g=document.createElement('<iframe name="'+e.iframeId+'">')}catch(a){g=document.createElement("iframe"),g.name=e.iframeId}g.id=e.iframeId,e.form.appendChild(g),e.iframe=g}var e=this,f=b.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var g,h=document.createElement("form"),i=document.createElement("textarea"),j=this.iframeId="socketio_iframe_"+this.index;h.className="socketio",h.style.position="absolute",h.style.top="0px",h.style.left="0px",h.style.display="none",h.target=j,h.method="POST",h.setAttribute("accept-charset","utf-8"),i.name="d",h.appendChild(i),document.body.appendChild(h),this.form=h,this.area=i}this.form.action=this.prepareUrl()+f,d(),this.area.value=b.JSON.stringify(a);try{this.form.submit()}catch(a){}this.iframe.attachEvent?g.onreadystatechange=function(){"complete"==e.iframe.readyState&&c()}:this.iframe.onload=c,this.socket.setBuffer(!0)},d.prototype.get=function(){var a=this,c=document.createElement("script"),d=b.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),c.async=!0,c.src=this.prepareUrl()+d,c.onerror=function(){a.onClose()};var f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(c,f),this.script=c,e&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a),document.body.removeChild(a)},100)},d.prototype._=function(a){return this.onData(a),this.isOpen&&this.get(),this},d.prototype.ready=function(a,c){var d=this;return e?void b.util.load(function(){c.call(d)}):c.call(this)},d.check=function(){return"document"in c},d.xdomainCheck=function(){return!0},b.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this)}(),define("socket.io",function(){}),define("paddie-client/lib/collab_client",["require","jquery","paddie-client/lib/chat","common-ui/lib/helper/environment","backbone","socket.io"],function(a){/**
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function b(a,b,f,g){function h(a){"string"==typeof window.ajlog&&(window.ajlog+=a+"\n"),T.push(a)}function i(){if(!pad.socket||"CONNECTING"==K)return void("CONNECTING"==K&&+new Date-N>2e4?u("DISCONNECTED","initsocketfail"):setTimeout(l("setTimeout(handleUserChanges)",i),1e3));var a=+new Date;if("IDLE"!=J)return void("COMMITTING"==J&&a-M>2e4?u("DISCONNECTED","slowcommit"):"COMMITTING"==J&&a-M>5e3?U.onConnectionTrouble("SLOW"):setTimeout(l("setTimeout(handleUserChanges)",i),3e3));var b=M+500;if(b>a)return void setTimeout(l("setTimeout(handleUserChanges)",i),b-a);var c=!1,d=H.prepareUserChangeset();d.changeset&&(M=a,J="COMMITTING",E={type:"USER_CHANGES",baseRev:I,changeset:d.changeset,apool:d.apool,references:yam.ui.pages.refBank.getReferences()},yam.ui.pages.refBank.clearReferences(),F=G,k(E),c=!0,U.onInternalAction("commitPerformed")),c&&setTimeout(l("setTimeout(handleUserChanges)",i),3e3)}function j(){V=0,u("CONNECTED"),x(),N=+new Date}function k(a){pad.socket.json.send({type:"COLLABROOM",component:"pad",data:a})}function l(a,b){return function(){try{return b.apply(this,Array.prototype.slice.call(arguments))}catch(b){throw Q.push(b),R.push(a),S.push(+new Date),b}}}function m(a,b){try{l(a,b)()}catch(a){}}function n(a){if(pad.socket&&a.data){var b=a;if("COLLABROOM"==b.type){var c=b.data;if("NEW_CHANGES"==c.type){var f=c.newRev,g=c.changeset,j=c.author||"",k=c.apool;if(f!=I+1)return h("bad message revision on NEW_CHANGES: "+f+" not "+(I+1)),void u("DISCONNECTED","badmessage_newchanges");I=f,e.trigger("/ui/pages/newRevision",I,c.references),H.applyChangesToBase(g,j,k)}else if("ACCEPT_COMMIT"==c.type){var f=c.newRev;if(f!=I+1)return h("bad message revision on ACCEPT_COMMIT: "+f+" not "+(I+1)),void u("DISCONNECTED","badmessage_acceptcommit");I=f,e.trigger("/ui/pages/newRevision",I),H.applyPreparedChangesetToBase(),B(),m("onInternalAction",function(){U.onInternalAction("commitAcceptedByServer")}),m("onConnectionTrouble",function(){U.onConnectionTrouble("OK")}),i()}else if("NO_COMMIT_PENDING"==c.type)"COMMITTING"==J&&(B(),i());else if("USER_NEWINFO"==c.type){var l=c.userInfo,n=l.userId;P[n]?(P[n]=l,U.onUpdateUserInfo(l),t()):(P[n]=l,U.onUserJoin(l),t()),l.userId=n,p(l)}else if("USER_LEAVE"==c.type){var l=c.userInfo,n=l.userId;P[n]&&(delete P[l.userId],U.onUserLeave(l),t())}else if("PAD_PUBLISH"==c.type){var j;j=P[c.authorID]?P[c.authorID]:{userId:c.authorID,name:c.authorName},U.onPadPublish(c.newRev,j)}else"DISCONNECT_REASON"==c.type?L=c.reason:"CLIENT_MESSAGE"==c.type?U.onClientMessage(c.payload):"CHAT_MESSAGE"==c.type?d.addMessage(c,!0):"SERVER_MESSAGE"==c.type&&U.onServerMessage(c.payload)}}}function o(a){a.userId=O,P[O]=a,p(a),pad.socket&&k({type:"USERINFO_UPDATE",userInfo:a})}function p(a){q(a.userId,a.colorId)}function q(a,b,c){if("number"==typeof b&&(b=pad.clientVars.colorPalette[b]),pad.getIsHighlightingEnabled(a)){var d=b;c?H.setAuthorInfo(a,{bgcolor:d,fade:.5}):H.setAuthorInfo(a,{bgcolor:d})}else H.setAuthorInfo(a)}function r(){return v(P)}function s(a){for(var b in a){var c=a[b];P[b]||q(b,c.colorId,!0)}}function t(){}function u(a,b){a!=K&&(K=a,U.onChannelStateChange(K,b))}function v(a){var b=[];return c.each(a,function(a,c){b.push(c)}),b}function w(a,b){return function(){function c(){a.apply(d,e)}var d=this,e=arguments;c.tag=b,"CONNECTING"==K?W.push(c):c()}}function x(a){for(var b=[],c=0;c<W.length;c++){var d=W[c];a&&a!=d.tag?b.push(d):d()}W=b}function y(a){k({type:"CLIENT_MESSAGE",payload:a})}function z(){return I}function A(){var a={};a.userInfo=P[O],a.baseRev=I,"COMMITTING"==J&&E&&(a.committedChangeset=E.changeset,a.committedChangesetAPool=E.apool,a.committedChangesetSocketId=F,H.applyPreparedChangesetToBase());var b=H.prepareUserChangeset();return b.changeset&&(a.furtherChangeset=b.changeset,a.furtherChangesetAPool=b.apool),a}function B(){J="IDLE",U.onInternalAction("newlyIdle"),D()}function C(a){X.push(a),D()}function D(){setTimeout(function(){if("IDLE"==J)for(;X.length>0;){var a=X.shift();a()}},0)}var E,F,G,H=a,I=b.rev,J=(b.padId,b.globalPadId,"IDLE"),K="CONNECTING",L=null,M=0,N=0,O=f.userId,P={};P[O]=f;var Q=[],R=[],S=[],T=[];s(b.historicalAuthorData),p(f);var U={onUserJoin:function(){},onUserLeave:function(){},onUpdateUserInfo:function(){},onPadPublish:function(){},onChannelStateChange:function(){},onClientMessage:function(){},onInternalAction:function(){},onConnectionTrouble:function(){},onServerMessage:function(){}};c(window).bind("unload",function(){pad.socket&&u("DISCONNECTED","unload")}),c.browser.mozilla&&c(window).bind("keydown",function(a){27==a.which&&a.preventDefault()}),H.setProperty("userAuthor",O),H.setBaseAttributedText(b.initialAttributedText,b.apool),H.setUserChangeNotificationCallback(l("handleUserChanges",i));var V=0,W=[],X=[],Y={setOnUserJoin:function(a){U.onUserJoin=a},setOnUserLeave:function(a){U.onUserLeave=a},setOnUpdateUserInfo:function(a){U.onUpdateUserInfo=a},setOnPadPublish:function(a){U.onPadPublish=a},setOnChannelStateChange:function(a){U.onChannelStateChange=a},setOnClientMessage:function(a){U.onClientMessage=a},setOnInternalAction:function(a){U.onInternalAction=a},setOnConnectionTrouble:function(a){U.onConnectionTrouble=a},setOnServerMessage:function(a){U.onServerMessage=a},updateUserInfo:w(o),handleMessageFromServer:n,getConnectedUsers:r,sendClientMessage:y,sendMessage:k,getCurrentRevisionNumber:z,getMissedChanges:A,callWhenNotCommitting:C,addHistoricalAuthors:s,setChannelState:u};return c(document).ready(j),Y}var c=a("jquery"),d=a("paddie-client/lib/chat"),e=(a("common-ui/lib/helper/environment"),a("backbone"));return a("socket.io"),b}),define("paddie-client/lib/pad_docbar",["require","jquery","paddie-client/lib/pad_utils"],function(a){function b(a,b){function c(b){f("#docbar").removeClass(h).removeClass(i).removeClass(j),"closed"!=b&&f("#docbar").addClass("docbar"+a+"-"+b)}function d(a){function d(a){return a=1-a,a*=a*a,1-a}if(-1==a)c("opening"),e.css("height","0");else if(0>a){var f=Math.round(d(a+1)*(b-1))+"px";e.css("height",f)}else if(0==a)c("open"),e.css("height",b-1);else if(1>a){c("closing");var f=Math.round((1-d(a))*(b-1))+"px";e.css("height",f)}else 1==a&&(c("closed"),e.css("height","0"))}var e=f("#"+a+"-wrapper"),h="docbar"+a+"-opening",i="docbar"+a+"-open",j="docbar"+a+"-closing";return g.makeShowHideAnimator(d,!1,25,500)}function c(a){l!=a&&(l=a,g.cancelActions("hide-docbar-panel"))}function d(a){(a||null)!=(m.password||null)&&(m.password=a||null,pad.notifyChangePassword(a)),m.renderPassword()}var e,f=a("jquery"),g=a("paddie-client/lib/pad_utils"),h=!1,i=!1,j=!1,k=!1,l=null,m={title:null,password:null,init:function(a){e={impexp:{animator:b("impexp",160)},savedrevs:{animator:b("savedrevs",79)},options:{animator:b("options",114)},security:{animator:b("security",130)}},h=a.isTitleEditable,m.title=a.initialTitle,m.password=a.initialPassword,f("#docbarimpexp").click(function(){m.togglePanel("impexp")}),f("#docbarsavedrevs").click(function(){m.togglePanel("savedrevs")}),f("#docbaroptions").click(function(){m.togglePanel("options")}),f("#docbarsecurity").click(function(){m.togglePanel("security")}),f("#docbarrenamelink").click(m.editTitle),f("#padtitlesave").click(function(){m.closeTitleEdit(!0)}),f("#padtitlecancel").click(function(){m.closeTitleEdit(!1)}),g.bindEnterAndEscape(f("#padtitleedit"),function(){f("#padtitlesave").trigger("click")},function(){f("#padtitlecancel").trigger("click")}),f("#options-close").click(function(){m.setShownPanel(null)}),f("#security-close").click(function(){m.setShownPanel(null)}),pad.getIsProPad()&&m.initPassword(),k=!0,m.render(),f("#security-access input").bind("change click",function(a){pad.changePadOption("guestPolicy",f("#security-access input[name='padaccess']:checked").val())}),m.setGuestPolicy(a.guestPolicy)},setGuestPolicy:function(a){f("#security-access input[value='"+a+"']").attr("checked","checked"),m.render()},initPassword:function(){m.renderPassword(),f("#password-clearlink").click(function(){d(null)}),f("#password-setlink, #password-display").click(function(){m.enterPassword()}),f("#password-cancellink").click(function(){m.exitPassword(!1)}),f("#password-savelink").click(function(){m.exitPassword(!0)}),g.bindEnterAndEscape(f("#security-passwordedit"),function(){m.exitPassword(!0)},function(){m.exitPassword(!1)})},enterPassword:function(){j=!0,f("#security-passwordedit").val(m.password||""),m.renderPassword(),f("#security-passwordedit").focus().select()},exitPassword:function(a){j=!1,a?d(f("#security-passwordedit").val()):m.renderPassword()},renderPassword:function(){j?(f("#password-nonedit").hide(),f("#password-inedit").show()):(f("#password-nonedit").toggleClass("nopassword",!m.password),f("#password-setlink").html(m.password?"Change...":"Set..."),m.password?f("#password-display").html(m.password.replace(/./g,"&#8226;")):f("#password-display").html("None"),f("#password-inedit").hide(),f("#password-nonedit").show())},togglePanel:function(a){a in e&&(l==a?m.setShownPanel(null):m.setShownPanel(a))},setShownPanel:function(a){function b(a,b){var c=0;"options"==a&&j&&(m.exitPassword(!1),c=500),window.setTimeout(function(){e[a].animator.hide(),b&&b()},c)}a?a in e&&l!=a&&(l?b(l,function(){e[a].animator.show(),c(a)}):(e[a].animator.show(),c(a))):l&&(b(l),c(null))},isPanelShown:function(a){return a?a==l:!l},changeTitle:function(a){m.title=a,m.render()},editTitle:function(){k&&(f("#padtitleedit").val(m.title),i=!0,m.render(),f("#padtitleedit").focus().select())},closeTitleEdit:function(a){if(k){if(a){var b=f("#padtitleedit").val();b&&(b=b.substring(0,80),m.title=b,pad.notifyChangeTitle(b))}i=!1,m.render()}},changePassword:function(a){a?m.password=a:m.password=null,m.renderPassword()},render:function(){if(i)f("#docbarpadtitle").hide(),f("#docbarrenamelink").hide(),f("#padtitleedit").show(),f("#padtitlebuttons").show(),k?f("#padtitleedit").removeAttr("disabled"):f("#padtitleedit").attr("disabled","disabled");else{f("#padtitleedit").hide(),f("#padtitlebuttons").hide();var a=f("#docbarpadtitle span");if(a.html(g.escapeHtml(m.title)),f("#docbarpadtitle").attr("title",(pad.isPadPublic()?"Public Pad: ":"")+m.title),f("#docbarpadtitle").show(),h){var b=f("#docbarpadtitle").position().left+f("#docbarpadtitle span").position().left+Math.min(f("#docbarpadtitle").width(),f("#docbarpadtitle span").width());f("#docbarrenamelink").css("left",b+10).show()}pad.isPadPublic()?f("#docbar").addClass("docbar-public"):f("#docbar").removeClass("docbar-public")}},disable:function(){k=!1,m.render()},handleResizePage:function(){padsavedrevs.handleResizePage()},hideLaterIfNoOtherInteraction:function(){return g.getCancellableAction("hide-docbar-panel",function(){m.setShownPanel(null)})}};return m}),define("paddie-client/lib/pad_modals",["require","jquery","paddie-client/lib/pad_docbar","paddie-client/lib/pad_utils"],function(a){function b(a){a=!!a,g!=a&&(g=a,a?d(".sharebox-send").css("opacity",.75):d("#sharebox-send").css("opacity",1))}function c(){h()}var d=a("jquery"),e=a("paddie-client/lib/pad_docbar"),f=a("paddie-client/lib/pad_utils"),g=!1,h=function(){},i={init:function(){i.initFeedback(),i.initShareBox()},initFeedback:function(){d("#feedbackbox-hide").click(function(){i.hideModal()}),d("#feedbackbutton").click(function(){i.showFeedback()})},initShareBox:function(){d("#sharebutton").click(function(){i.showShareBox()}),d("#sharebox-hide").click(function(){i.hideModal()}),d("#sharebox-send").click(function(){i.sendInvite()}),d("#sharebox-url").click(function(){d("#sharebox-url").focus().select()}),h=f.makeFieldLabeledWhenEmpty(d("#sharebox-to"),"(email addresses)").clear,c(),d("#sharebox-subject").val(i.getDefaultShareBoxSubjectForName(pad.getUserName())),d("#sharebox-message").val(i.getDefaultShareBoxMessageForName(pad.getUserName())),d("#sharebox-stripe .setsecurity").click(function(){i.hideModal(),e.setShownPanel("security")})},getDefaultShareBoxMessageForName:function(a){return(a||"Somebody")+" has shared an EtherPad document with you.\n\nView it here:\n\n"+f.escapeHtml(d(".sharebox-url").val()+"\n")},getDefaultShareBoxSubjectForName:function(a){return(a||"Somebody")+" invited you to an EtherPad document"},relayoutWithBottom:function(a){d("#modaloverlay").height(a),d("#sharebox").css("left",Math.floor((d(window).width()-d("#sharebox").outerWidth())/2)),d("#feedbackbox").css("left",Math.floor((d(window).width()-d("#feedbackbox").outerWidth())/2))},showFeedback:function(){i.showModal("#feedbackbox")},showShareBox:function(){var a=d("#sharebox-message");a.val()==i.getDefaultShareBoxMessageForName(null)&&a.val(i.getDefaultShareBoxMessageForName(pad.getUserName()));var b=d("#sharebox-subject");b.val()==i.getDefaultShareBoxSubjectForName(null)&&b.val(i.getDefaultShareBoxSubjectForName(pad.getUserName())),pad.isPadPublic()?d("#sharebox-stripe").get(0).className="sharebox-stripe-public":d("#sharebox-stripe").get(0).className="sharebox-stripe-private",i.showModal("#sharebox",500),d("#sharebox-url").focus().select()},showModal:function(a,b){d(".modaldialog").hide(),d(a).show().css({opacity:0}).animate({opacity:1},b),d("#modaloverlay").show().css({opacity:0}).animate({opacity:1},b)},hideModal:function(a){f.cancelActions("hide-feedbackbox"),f.cancelActions("hide-sharebox"),d("#sharebox-response").hide(),d(".modaldialog").animate({opacity:0},a,function(){d("#modaloverlay").hide()}),d("#modaloverlay").animate({opacity:0},a,function(){d("#modaloverlay").hide()})},hideFeedbackLaterIfNoOtherInteraction:function(){return f.getCancellableAction("hide-feedbackbox",function(){i.hideModal()})},hideShareboxLaterIfNoOtherInteraction:function(){return f.getCancellableAction("hide-sharebox",function(){i.hideModal()})},sendInvite:function(){function a(a){b(!1),d("#sharebox-response").html("Email invitation sent!").get(0).className="goodresponse",d("#sharebox-response").show(),window.setTimeout(function(){d("#sharebox-response").fadeOut("slow",function(){q()})},1500)}function c(a){setSendingFeedback(!1),d("#sharebox-response").html("An error occurred; no email was sent.").get(0).className="badresponse",d("#sharebox-response").show()}function e(a){d("#sharebox-response").html(a).get(0).className="badresponse",d("#sharebox-response").show()}if(!g){if(!pad.isFullyConnected())return void e("Error: Connection to the server is down or flaky.");var h=d("#sharebox-message").val();if(!h)return void e("Please enter a message body before sending.");var j=(d("#sharebox-to").hasClass("editempty")?"":d("#sharebox-to").val())||"",k=j.match(/[^\s,:;<>\"\'\/\(\)\[\]{}]+/g)||[];if(0==k.length)return e('Please enter at least one "To:" address.'),void d("#sharebox-to").focus().select();for(var l=0;l<k.length;l++){var m=k[l];if(!m.match(/^[\w\.\_\+\-]+\@[\w\_\-]+\.[\w\_\-\.]+$/))return void e('"'+f.escapeHtml(m)+'" does not appear to be a valid email address.')}var n=d("#sharebox-subject").val();n||(n=i.getDefaultShareBoxSubjectForName(pad.getUserName()),d("#sharebox-subject").val(n));var o=pad.getPadId(),p=pad.getUserName();b(!0),d("#sharebox-response").html("Sending...").get(0).className="",d("#sharebox-response").show(),d.ajax({type:"post",url:"/ep/pad/emailinvite",data:{message:h,toEmails:k.join(","),subject:n,username:p,padId:o},success:a,error:c});var q=i.hideShareboxLaterIfNoOtherInteraction()}}};return i}),define("paddie-client/lib/pad_connectionstatus",["require","jquery","paddie-client/lib/pad_modals","backbone"],function(a){var b=a("jquery"),c=a("paddie-client/lib/pad_modals"),d=a("backbone"),e={what:"connecting"},f={init:function(){b("button#forcereconnect").click(function(){window.location.reload()})},connected:function(){e={what:"connected"},c.hideModal(500),b("#connectionbox").removeClass("cboxreconnecting"),b("#connectionbox").css("opacity","0"),b("#connectionbox").css("display","none"),d.trigger("/ui/pages/activity","")},reconnecting:function(){e={what:"reconnecting"},b("#connectionbox").addClass("cboxreconnecting"),d.trigger("/ui/pages/activity","reconnecting"),c.showModal("#connectionbox",500)},disconnected:function(a){if("disconnected"!=e.what){e={what:"disconnected",why:a};var f=String(a).toLowerCase();"userdup"!=f&&"deleted"!=f&&"looping"!=f&&"slowcommit"!=f&&"initsocketfail"!=f&&"unauth"!=f&&(f="unknown");var g="modaldialog cboxdisconnected cboxdisconnected_"+f;b("#connectionbox").get(0).className=g,c.showModal("#connectionbox",500),b("button#forcereconnect").click(function(){window.location.reload()}),d.trigger("/ui/pages/activity","")}},isFullyConnected:function(){return"connected"==e.what},getStatus:function(){return e}};return f}),define("paddie-client/lib/pad_cookie",[],function(){/**
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function a(){if(!document.cookie)return null;var a=document.cookie.match(/(?:^|;)\s*prefs=([^;]*)(?:;|$)/);return a&&a[1]?a[1]:null}function b(a){var b=new Date;b.setFullYear(3e3),document.cookie="prefs="+a+";expires="+b.toGMTString()}function c(a){try{var b=JSON.parse(unescape(a));return b}catch(a){return null}}function d(a){return escape(JSON.stringify(a))}function e(){i&&(b(d(g)),!pad.getIsProPad()||a()||h||(alert("Warning: it appears that your browser does not have cookies enabled. EtherPad uses cookies to keep track of unique users for the purpose of putting a quota on the number of active users.  Using EtherPad without  cookies may fill up your server's user quota faster than expected."),h=!0))}var f=!0,g={},h=!1,i=!1,j={init:function(b){var d=a();if(d){var h=c(d);h&&(f=!1,delete h.userId,delete h.name,delete h.colorId,g=h)}for(var j in b)g[j]=b[j];i=!0,e()},wasNoCookie:function(){return f},getPref:function(a){return g[a]},setPref:function(a,b){g[a]=b,e()}};return j}),define("paddie-client/lib/plugins",["require"],function(a){var b={callHook:function(a,b){var c=pad.clientVars.hooks[a];if(void 0===c)return[];for(var d=[],e=0,f=c.length;f>e;e++){var g=c[e],h=g.process(b);void 0!==h&&null!==h&&(d=d.concat(h))}return d},callHookStr:function(a,c,d,e,f){return void 0==d&&(d=""),void 0==e&&(e=""),void 0==f&&(f=""),b.callHook(a,c).map(function(a){return e+a+f}).join(d||"")}};return window.plugins=b,b}),define("paddie-client/lib/ace",["require","paddie-client/lib/plugins"],function(a){function b(){function a(a,b){return function(){function c(){a.apply(d,e)}var d=this,e=arguments;b&&b.apply(d,e),j?c():k.push(c)}}function d(){for(var a=0;a<k.length;a++)k[a]();k=[]}var e,f="Ace2Editor",g=b,h={},i={editor:h,id:g.registry.nextId++},j=!1,k=[];g.registry[i.id]=i,h.importText=a(function(a,b){i.ace_importText(a,b)}),h.importAText=a(function(a,b,c){i.ace_importAText(a,b,c)}),h.exportText=function(){return j?i.ace_exportText():"(awaiting init)\n"},h.getFrame=function(){return i.frame||null},h.focus=a(function(){i.ace_focus()}),h.setEditable=a(function(a){i.ace_setEditable(a)}),h.getFormattedCode=function(){return i.ace_getFormattedCode()},h.setOnKeyPress=a(function(a){i.ace_setOnKeyPress(a)}),h.setOnKeyDown=a(function(a){i.ace_setOnKeyDown(a)}),h.setNotifyDirty=a(function(a){i.ace_setNotifyDirty(a)}),h.setProperty=a(function(a,b){i.ace_setProperty(a,b)}),h.getDebugProperty=function(a){return i.ace_getDebugProperty(a)},h.setBaseText=a(function(a){i.ace_setBaseText(a)}),h.setBaseAttributedText=a(function(a,b){i.ace_setBaseAttributedText(a,b)}),h.applyChangesToBase=a(function(a,b,c){i.ace_applyChangesToBase(a,b,c)}),h.prepareUserChangeset=function(){return j?i.ace_prepareUserChangeset():null},h.applyPreparedChangesetToBase=a(function(){i.ace_applyPreparedChangesetToBase()}),h.setUserChangeNotificationCallback=a(function(a){i.ace_setUserChangeNotificationCallback(a)}),h.setAuthorInfo=a(function(a,b){i.ace_setAuthorInfo(a,b)}),h.setAuthorSelectionRange=a(function(a,b,c){i.ace_setAuthorSelectionRange(a,b,c)}),h.getUnhandledErrors=function(){return j?i.ace_getUnhandledErrors():[]},h.callWithAce=a(function(a,b,c){return i.ace_callWithAce(a,b,c)}),h.execCommand=a(function(a,b){i.ace_execCommand(a,b)}),h.replaceRange=a(function(a,b,c){i.ace_replaceRange(a,b,c)});var l=function(a){var b=e.paddieURL||"../";return'<link rel="stylesheet" type="text/css" href="'+b+a+'"/>'},m=function(a){var b=e.paddieURL||"../";return'\'<link rel="stylesheet" type="text/css" href="'+b+a+"\"/>'"},n=function(a){var b=e.paddieURL||"../";return'\'\\x3cscript type="text/javascript" src="'+b+a+"\">\\x3c/script>'"};return h.destroy=a(function(){i.ace_dispose(),i.frame.parentNode.removeChild(i.frame),delete g.registry[i.id],i=null}),h.init=function(a,b,g){h.importText(b),i.onEditorReady=function(){j=!0,d(),g()},function(){e=window.pad&&pad.getYammerConfig()||{};var b="<!doctype html>",d=["'"+b+"<html><head>'"];c.callHook("aceInitInnerdocbodyHead",{iframeHTML:d});e.paddieURL||"../";d.push(m("static/css/iframe_editor.css")),d.push(m("static/css/pad.css")),d.push(m("static/custom/pad.css")),d.push(n("static/js/ace2_common.js")),d.push(n("static/js/skiplist.js")),d.push(n("static/js/virtual_lines.js")),d.push(n("static/js/easysync2.js")),d.push(n("static/js/cssmanager.js")),d.push(n("static/js/colorutils.js")),d.push(n("static/js/undomodule.js")),d.push(n("static/js/unorm.js")),d.push(n("static/js/contentcollector.js")),d.push(n("static/js/changesettracker.js")),d.push(n("static/js/linestylefilter.js")),d.push(n("static/js/domline.js")),d.push(n("static/js/ace2_inner.js")),d.push('\'\\n<style type="text/css" title="dynamicsyntax"></style>\\n\''),d.push('\'</head><body id="innerdocbody" class="syntax" spellcheck="false">&nbsp;</body></html>\'');var g='editorId = "'+i.id+'"; editorInfo = parent.'+f+'.registry[editorId]; window.onload = function() { window.onload = null; setTimeout(function() { var iframe = document.createElement("IFRAME"); iframe.scrolling = "no"; var outerdocbody = document.getElementById("outerdocbody"); iframe.id = "innerPadFrame"; iframe.frameBorder = 0; iframe.allowTransparency = true; outerdocbody.insertBefore(iframe, outerdocbody.firstChild); iframe.ace_outerWin = window; readyFunc = function() { editorInfo.onEditorReady(); readyFunc = null; editorInfo = null; }; var doc = iframe.contentWindow.document; doc.open(); var text = ('+d.join("+")+").replace(/\\\\x3c/g, '<');doc.write(text); doc.close(); }, 0); }",h=[b,"<html><head>",l("static/css/iframe_editor.css"),l("static/css/pad.css"),l("static/custom/pad.css"),'<link rel="stylesheet" type="text/css" href=""/>',"<script>\n",g,"\n</script>",'</head><body id="outerdocbody"><div id="sidediv"><!-- --></div><div id="linemetricsdiv">x</div><div id="overlaysdiv"><!-- --></div></body></html>'];Array.prototype.map||(Array.prototype.map=function(a){if("function"!=typeof a)throw new TypeError;for(var b=this.length,c=new Array(b),d=arguments[1],e=0;b>e;e++)e in this&&(c[e]=a.call(d,this[e],e,this));return c});var j=document.createElement("IFRAME");j.frameBorder=0,j.id="outerPadFrame",i.frame=j,document.getElementById(a).appendChild(j);var k=j.contentWindow.document;k.open(),k.write(h.join("")),k.close()}()},h}var c=a("paddie-client/lib/plugins");/**
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return b.registry={nextId:1},window.Ace2Editor=b,b}),define("paddie-client/lib/pad_editor",["require","jquery","paddie-client/lib/ace","paddie-client/lib/pad_cookie","paddie-client/lib/pad_utils"],function(a){var b=a("jquery"),c=a("paddie-client/lib/ace"),d=a("paddie-client/lib/pad_cookie"),e=a("paddie-client/lib/pad_utils"),f={ace:null,viewZoom:100,init:function(a,d){function e(){b("#editorloadingbox").hide(),a&&a()}f.ace=new c,f.ace.init("editorcontainer","",e),f.ace.setProperty("wraps",!0),pad.getIsDebugEnabled()&&f.ace.setProperty("dmesg",pad.dmesg),f.initViewOptions(),f.setViewOptions(d),f.initViewZoom(),b("#viewbarcontents").show()},initViewOptions:function(){e.bindCheckboxChange(b("#options-linenoscheck"),function(){pad.changeViewOption("showLineNumbers",e.getCheckbox(b("#options-linenoscheck")))}),e.bindCheckboxChange(b("#options-colorscheck"),function(){pad.changeViewOption("showAuthorColors",e.getCheckbox("#options-colorscheck"))}),b("#viewfontmenu").change(function(){pad.changeViewOption("useMonospaceFont","monospace"==b("#viewfontmenu").val())})},setViewOptions:function(a){function c(b,c){var d=String(a[b]);return"true"==d?!0:"false"==d?!1:c}var d;d=c("showLineNumbers",!0),f.ace.setProperty("showslinenumbers",d),e.setCheckbox(b("#options-linenoscheck"),d),d=c("showAuthorColors",!0),f.ace.setProperty("showsauthorcolors",d),e.setCheckbox(b("#options-colorscheck"),d),d=c("useMonospaceFont",!1),f.ace.setProperty("textface",d?"monospace":"Arial, sans-serif"),b("#viewfontmenu").val(d?"monospace":"normal")},initViewZoom:function(){var a=Number(d.getPref("viewZoom"));a&&!isNaN(a)||(a=100),f.setViewZoom(a),b("#viewzoommenu").change(function(a){f.setViewZoom(Number(b("#viewzoommenu").val().substring(1)))})},setViewZoom:function(a){if(a>=50&&1e3>=a){f.viewZoom=a,b("#viewzoommenu").val("z"+a);var c=13;f.ace.setProperty("textsize",Math.round(c*f.viewZoom/100)),d.setPref("viewZoom",a)}},dispose:function(){f.ace&&f.ace.destroy()},disable:function(){f.ace&&(f.ace.setProperty("grayedOut",!0),f.ace.setEditable(!1))},restoreRevisionText:function(a){pad.addHistoricalAuthors(a.historicalAuthorData),f.ace.importAText(a.atext,a.apool,!0)}};return f}),define("paddie-client/lib/pad_savedrevs",["require","jquery","paddie-client/lib/pad_docbar","paddie-client/lib/pad_editor","paddie-client/lib/pad_utils"],function(a){/**
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function b(a){var b=a.slice();return b.reverse(),b}function c(a,b){var c=y('<div class="srouterbox"><div class="srinnerbox"><a href="javascript:void(0)" class="srname"><!-- --></a><div class="sractions"><a class="srview" href="javascript:void(0)" target="_blank">view</a> | <a class="srrestore" href="javascript:void(0)">restore</a></div><div class="srtime"><!-- --></div><div class="srauthor"><!-- --></div><img class="srtwirly" src="static/img/misc/status-ball.gif"></div></div>');d(c,a.label),e(c,a.timestamp),c.find(".srauthor").html("by "+B.escapeHtml(a.savedBy));var f="/ep/pad/view/"+pad.getPadId()+"/"+a.id;c.find(".srview").attr("href",f);var h="javascript:void padsavedrevs.restoreRevision("+b+");";return c.find(".srrestore").attr("href",h),c.find(".srname").click(function(a){g(b,c)}),c}function d(a,b){a.find(".srname").html(B.escapeHtml(b)).attr("title",b)}function e(a,b){a.find(".srtime").html(B.escapeHtml(B.timediff(new Date(b))))}function f(a){return y("#savedrevisions .srouterbox").eq(a)}function g(a,b){function c(){d.remove(),e.css("opacity",1)}var d=y('<input type="text" class="srnameedit"/>');b.find(".srnameedit").remove();var e=b.find(".srname");d.width(e.width()),d.height(e.height()),d.css("top",e.position().top),d.css("left",e.position().left),e.after(d),e.css("opacity",0);var f=C[a],g=f.label;d.blur(function(){var b=d.val();b&&b!=g&&h(a,b),c()}),d.val(f.label).focus().select(),B.bindEnterAndEscape(d,function(){d.blur()},function(){d.val("").blur()})}function h(a,c){function d(a){var d=JSON.parse(a);L.newRevisionList(d),pad.sendClientMessage({type:"revisionLabel",revisionList:b(C),savedBy:pad.getUserName(),newLabel:c})}function e(a){alert("Oops! There was an error saving that revision label.  Please try again later.")}var f=C[a];y.ajax({type:"post",url:"/ep/pad/saverevisionlabel",data:{userId:pad.getUserId(),padId:pad.getPadId(),revId:f.id,newLabel:c},success:d,error:e})}function i(a,b){for(var e=0;e<C.length;e++){var g=C[e],h=a[e];h.label!=g.label&&d(f(e),h.label)}for(var i=C.length;i<a.length;i++){var j=c(a[i],i);y("#savedrevs-scrollinner").append(j),j.css("left",i*E)}var l=a.length>C.length;if(C=a,l&&(q(o()),b&&p(G),!b)){var m=C[C.length-1].label;k(m)}}function j(){for(var a=0;a<C.length;a++){var b=C[a],c=f(a);e(c,b.timestamp)}}function k(a){y("#revision-notifier .name").html(B.escapeHtml(a)),D.show(),B.cancelActions("hide-revision-notifier");var b=B.getCancellableAction("hide-revision-notifier",function(){D.hide()});window.setTimeout(b,3e3)}function l(){return E*C.length}function m(){return y("#savedrevs-scrollouter").width()}function n(){return Math.min(m(),l())}function o(){return l()}function p(a){F=a,y("#savedrevs-scrollinner").css("right",a),s()}function q(a,b){G=Math.min(o(),Math.max(n(),a)),b||r()}function r(){s(),H.scheduleAnimation()}function s(){y("#savedrevs-scrollleft").toggleClass("disabledscrollleft",G<=n()),y("#savedrevs-scrollright").toggleClass("disabledscrollright",G>=o())}function t(a){I=a,v()}function u(){var a=pad.getPrivilege("maxRevisions");return!(0>a||a>C.length)}function v(){I||!pad.isFullyConnected()||u()?y("#savedrevs-savenow").css("opacity",.75):y("#savedrevs-savenow").css("opacity",1)}function w(a){x(),K=+new Date,J=window.setTimeout(function b(){if(J){L.scroll(a);var c=+new Date-K,d=c>2e3?50:300;J=window.setTimeout(b,d)}},300),y(document).bind("mouseup",x)}function x(){J&&(window.clearTimeout(J),J=null),y(document).unbind("mouseup",x)}var y=a("jquery"),z=a("paddie-client/lib/pad_docbar"),A=a("paddie-client/lib/pad_editor"),B=a("paddie-client/lib/pad_utils"),C=[],D=B.makeShowHideAnimator(function(a){-1==a?y("#revision-notifier").css("opacity",0).css("display","block"):0==a?y("#revision-notifier").css("opacity",1):1==a?y("#revision-notifier").css("opacity",0).css("display","none"):0>a?y("#revision-notifier").css("opacity",1):a>0&&y("#revision-notifier").css("opacity",1-a)},!1,25,300),E=120,F=0,G=0,H=B.makeAnimationScheduler(function(){return q(G,!0),Math.abs(G-F)<1?(p(G),!1):(p(F+.5*(G-F)),!0)},50,2),I=!1,J=null,K=0,L={init:function(a){L.newRevisionList(a,!0),y("#savedrevs-savenow").click(function(){L.saveNow()}),y("#savedrevs-scrollleft").mousedown(function(){L.scroll("left"),w("left")}),y("#savedrevs-scrollright").mousedown(function(){L.scroll("right"),w("right")}),y("#savedrevs-close").click(function(){z.setShownPanel(null)}),window.setInterval(function(){j()},6e4)},restoreRevision:function(a){function b(a){d();var b=JSON.parse(a);A.restoreRevisionText(b),window.setTimeout(function(){h()},0)}function c(a){d(),alert("Oops!  There was an error retreiving the text (revNum= "+e.revNum+"; padId="+pad.getPadId())}function d(){i.find(".srtwirly").hide()}var e=C[a],g="Restoring this revision will overwrite the current text of the pad. Are you sure you want to continue?",h=z.hideLaterIfNoOtherInteraction(),i=f(a);confirm(g)&&(i.find(".srtwirly").show(),y.ajax({type:"get",url:"/ep/pad/getrevisionatext",data:{padId:pad.getPadId(),revId:e.id},success:b,error:c}))},showReachedLimit:function(){alert("Sorry, you do not have privileges to save more than "+pad.getPrivilege("maxRevisions")+" revisions.")},newRevisionList:function(a,c){var d=b(a);i(d,c),v()},saveNow:function(){function a(){y.ajax({type:"post",url:"/ep/pad/saverevision",data:{padId:pad.getPadId(),savedBy:d,savedById:pad.getUserId(),revNum:pad.getCollabRevisionNumber()},success:b,error:c})}function b(a){t(!1);var b=JSON.parse(a);L.newRevisionList(b),pad.sendClientMessage({type:"newRevisionList",revisionList:b,savedBy:d})}function c(a){t(!1),alert("Oops!  The server failed to save the revision.  Please try again later.")}if(!I&&pad.isFullyConnected()){if(u())return void L.showReachedLimit();t(!0);var d=pad.getUserName()||"unnamed";pad.callWhenNotCommitting(a)}},handleResizePage:function(){s()},handleIsFullyConnected:function(a){v()},scroll:function(a){var b=n(),c=o();if("left"==a){if(G>b){var d=Math.floor((G-1-b)/E);q(Math.max(0,d)*E+b)}}else if("right"==a&&c>G){var d=Math.floor((c-G-1)/E);q(c-Math.max(0,d)*E)}}};return window.padsavedrevs=L,L}),/*
 * UnicodeNormalizer 1.0.0
 * Copyright (c) 2008 Matsuza
 * Dual licensed under the MIT (MIT-LICENSE.txt) and GPL (GPL-LICENSE.txt) licenses.
 * $Date: 2008-06-05 16:44:17 +0200 (Thu, 05 Jun 2008) $
 * $Rev: 13309 $
 */
function(){var DEFAULT_FEATURE=[null,0,{}],CACHE_THRESHOLD=10,SBase=44032,LBase=4352,VBase=4449,TBase=4519,LCount=19,VCount=21,TCount=28,NCount=VCount*TCount,SCount=LCount*NCount,UChar=function(a,b){this.codepoint=a,this.feature=b};UChar.fromCharCode=function(cp,needFeature){function fromCache(a,b,c){if(!ctx.cache){ctx.cache={},ctx.counter=[];for(var d=0;255>=d;++d)ctx.counter[d]=0}var e=ctx.cache[b];return e||(e=a(b,c),e.feature&&++ctx.counter[b>>8&255]>CACHE_THRESHOLD&&(ctx.cache[b]=e)),e}function fromData(next,cp,needFeature){var hash=65280&cp,dunit=UChar.udata[hash];null==dunit?dunit=UChar.udata[hash]={}:"string"==typeof dunit&&(dunit=UChar.udata[hash]=eval("("+dunit+")"));var f=dunit[cp];return f?new UChar(cp,f):new UChar(cp,DEFAULT_FEATURE)}function fromCpOnly(a,b,c){return c?a(b,c):new UChar(b,null)}function fromRuleBasedJamo(a,b,c){if(LBase>b||b>=LBase+LCount&&SBase>b||b>SBase+SCount)return a(b,c);if(b>=LBase&&LBase+LCount>b){for(var d={},e=(b-LBase)*VCount,f=0;VCount>f;++f)d[VBase+f]=SBase+TCount*(f+e);return new UChar(b,[,,d])}var g=b-SBase,h=g%TCount,i=[];if(0!=h)i[0]=[SBase+g-h,TBase+h];else{i[0]=[LBase+Math.floor(g/NCount),VBase+Math.floor(g%NCount/TCount)],i[2]={};for(var f=1;TCount>f;++f)i[2][TBase+f]=b+f}return new UChar(b,i)}function fromCpFilter(a,b,c){return 60>b||b>13311&&42607>b?new UChar(b,DEFAULT_FEATURE):a(b,c)}var ctx=arguments.callee;if(!ctx.strategy){var strategies=[fromCpFilter,fromCache,fromCpOnly,fromRuleBasedJamo,fromData];for(UChar.fromCharCode.strategy=null;strategies.length>0;)ctx.strategy=function(a,b,c,d){return function(c,d){return b(a,c,d)}}(ctx.strategy,strategies.pop(),cp,needFeature)}return ctx.strategy(cp,needFeature)},UChar.isHighSurrogate=function(a){return a>=55296&&56319>=a},UChar.isLowSurrogate=function(a){return a>=56320&&57343>=a},UChar.prototype.prepFeature=function(){this.feature||(this.feature=UChar.fromCharCode(this.codepoint,!0).feature)},UChar.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var a=this.codepoint-65536;return String.fromCharCode(Math.floor(a/1024)+55296,a%1024+56320)},UChar.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},UChar.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&256&this.feature[1]},UChar.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&512&this.feature[1]},UChar.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?255&this.feature[1]:0},UChar.prototype.getComposite=function(a){if(this.prepFeature(),!this.feature[2])return null;var b=this.feature[2][a.codepoint];return null!=b?UChar.fromCharCode(b):null};var UCharIterator=function(a){this.str=a,this.cursor=0};UCharIterator.prototype.next=function(){if(this.str&&this.cursor<this.str.length){var a,b=this.str.charCodeAt(this.cursor++);return UChar.isHighSurrogate(b)&&this.cursor<this.str.length&&UChar.isLowSurrogate(a=this.str.charCodeAt(this.cursor))&&(b=1024*(b-55296)+(a-56320)+65536,++this.cursor),UChar.fromCharCode(b)}return this.str=null,null};var RecursDecompIterator=function(a,b){this.it=a,this.canonical=b,this.resBuf=[]};RecursDecompIterator.prototype.next=function(){function a(b,c){var d=c.getDecomp();if(!d||b&&c.isCompatibility())return[c];for(var e=[],f=0;f<d.length;++f)for(var g=a(b,UChar.fromCharCode(d[f])),h=0;h<g.length;++h)e.push(g[h]);return e}if(0==this.resBuf.length){var b=this.it.next();if(!b)return null;this.resBuf=a(this.canonical,b)}return this.resBuf.shift()};var DecompIterator=function(a){this.it=a,this.resBuf=[]};DecompIterator.prototype.next=function(){var a;if(0==this.resBuf.length)do{var b=this.it.next();if(!b)break;a=b.getCanonicalClass();var c=this.resBuf.length;if(0!=a)for(;c>0;--c){var d=this.resBuf[c-1],e=d.getCanonicalClass();if(a>=e)break}this.resBuf.splice(c,0,b)}while(0!=a);return this.resBuf.shift()};var CompIterator=function(a){this.it=a,this.procBuf=[],this.resBuf=[],this.lastClass=null};CompIterator.prototype.next=function(){for(;0==this.resBuf.length;){var a=this.it.next();if(!a){this.resBuf=this.procBuf,this.procBuf=[];break}if(0==this.procBuf.length)this.lastClass=a.getCanonicalClass(),this.procBuf.push(a);else{var b=this.procBuf[0],c=b.getComposite(a),d=a.getCanonicalClass();c&&(this.lastClass<d||0==this.lastClass)?this.procBuf[0]=c:(0==d&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=d,this.procBuf.push(a))}}return this.resBuf.shift()};var createIterator=function(a,b){switch(a){case"NFD":return new DecompIterator(new RecursDecompIterator(new UCharIterator(b),!0));case"NFKD":return new DecompIterator(new RecursDecompIterator(new UCharIterator(b),!1));case"NFC":return new CompIterator(new DecompIterator(new RecursDecompIterator(new UCharIterator(b),!0)));case"NFKC":return new CompIterator(new DecompIterator(new RecursDecompIterator(new UCharIterator(b),!1)))}throw a+" is invalid"},normalize=function(a,b){for(var c,d=createIterator(a,b),e="";c=d.next();)e+=c.toString();return e},nfd=function(a){return normalize("NFD",a)},nfkd=function(a){return normalize("NFKD",a)},nfc=function(a){return normalize("NFC",a)},nfkc=function(a){return normalize("NFKC",a)};this.UNorm=this.UNorm||{};var ns=this.UNorm;ns.UChar=UChar,ns.normalize=normalize,ns.createIterator=createIterator,ns.nfd=nfd,ns.nfkd=nfkd,ns.nfc=nfc,ns.nfkc=nfkc}.call(this);var UNorm=this.UNorm;if(!this.UNorm||!this.UNorm.UChar)throw"must include unorm.js prior to unormdata.js";UNorm.UChar.udata={0:"{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]}",256:"{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]}",512:"{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256]}",768:"{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8000,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256]}",1024:"{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]}",1280:"{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]}",1536:"{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]}",1792:"{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]}",2304:"{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]}",2560:"{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9]}",2816:"{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]}",3072:"{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]}",3328:"{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]}",3584:"{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]}",3840:"{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]}",4096:"{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256]}",4864:"{4959:[,230]}",5888:"{5908:[,9],5940:[,9],6098:[,9],6109:[,230]}",6144:"{6313:[,228]}",6400:"{6457:[,222],6458:[,230],6459:[,220]}",6656:"{6679:[,230],6680:[,220]}",6912:"{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9]}",7168:"{7223:[,7]}",7424:"{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7678:[,230],7679:[,220]}",7680:"{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]}",7936:"{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8000:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8000,768]],8003:[[8001,768]],8004:[[8000,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]}",
8192:"{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]}",8448:"{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]}",8704:"{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]}",8960:"{9001:[[12296]],9002:[[12297]]}",9216:"{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]}",10752:"{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]}",11264:"{11388:[[106],256],11389:[[86],256]}",11520:"{11631:[[11617],256],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]}",11776:"{11935:[[27597],256],12019:[[40863],256]}",12032:"{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[30000],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]}",12288:"{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]}",12544:"{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]}",12800:"{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13000:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]}",13056:"{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]}",42496:"{42607:[,230],42620:[,230],42621:[,230]}",42752:"{42864:[[42863],256]}",43008:"{43014:[,9],43204:[,9]}",43264:"{43307:[,220],43308:[,220],43309:[,220],43347:[,9]}",53504:"{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]}",53760:"{119362:[,230],119363:[,230],119364:[,230]}",54272:"{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],120000:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]}",
54528:"{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]}",54784:"{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]}",55040:"{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]}",63488:"{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23000]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]}",63744:"{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149000]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32000]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195000:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]}",64e3:"{64000:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[40000]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]}",64256:"{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]}",
64512:"{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]}",64768:"{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]}",65024:"{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]}",65280:"{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}"},define("paddie-client/lib/unorm",function(){}),define("paddie-client/lib/pad_editbar",["require","jquery","underscore","mustache","common-ui/lib/ui/general/lightbox_manager","core/lib/log","core/lib/model_helper","paddie-client/lib/pad_editor","paddie-client/lib/pad_savedrevs","paddie-client/lib/pad_utils","backbone","core/lib/string_helper","core/lib/tr","common-ui/lib/ui/shared/type_ahead","core/lib/uri_helper","common-ui/lib/helper/environment","feeds/lib/ui/attachments/selector","paddie-client/lib/unorm"],function(a){var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("common-ui/lib/ui/general/lightbox_manager"),f=a("core/lib/log"),g=a("core/lib/model_helper"),h=a("paddie-client/lib/pad_editor"),i=a("paddie-client/lib/pad_savedrevs"),j=a("paddie-client/lib/pad_utils"),k=a("backbone"),l=a("core/lib/string_helper"),m=a("core/lib/tr"),n=a("common-ui/lib/ui/shared/type_ahead"),o=a("core/lib/uri_helper"),p=a("common-ui/lib/helper/environment"),q=a("feeds/lib/ui/attachments/selector");a("paddie-client/lib/unorm");/**
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var r=function(){var a=-100,c=100,d=c,e=25,f=1/e,g=-.5,h=1,i=1.5,k=j.makeAnimationScheduler(function(){return d==a||d==c?!1:d>=i?(d=c,b("#syncstatussyncing").css("display","none"),b("#syncstatusdone").css("display","none"),!1):0>d?(d+=f,d>=0&&(b("#syncstatussyncing").css("display","none"),b("#syncstatusdone").css("display","block").css("opacity",1)),!0):(d+=f,d>=h&&b("#syncstatusdone").css("opacity",(i-d)/(i-h)),!0)},1e3*f);return{syncing:function(){d=a,b("#syncstatussyncing").css("display","block"),b("#syncstatusdone").css("display","none")},done:function(){d=g,k.scheduleAnimation()}}}(),s={init:function(){b("#editbar .editbarbutton").attr("unselectable","on"),b("#editbar").removeClass("disabledtoolbar").addClass("enabledtoolbar"),this._initMentionButton(),this._initLinkerButton(),this._initFileButton(),this._initPageButton(),this._initFormatSelect(),this._watchSelection(),k.on("/ui/pages/selectionAttributesChanged",this._watchSelection,this)},isEnabled:function(){return!0},disable:function(){b("#editbar").addClass("disabledtoolbar").removeClass("enabledtoolbar")},toolbarClick:function(a){if(s.isEnabled())if("showusers"==a)s.toogleDropDown("users");else if("embed"==a){var c=window.location.href.split("?")[0];b("#embedinput").val("<iframe src='"+c+"?showControls=true&showChat=true&showLineNumbers=true&useMonospaceFont=false' width=600 height=400>"),s.toogleDropDown("embed"),b("#embedinput").focus().select()}else if("import_export"==a)s.toogleDropDown("importexport");else if("readonly"==a){var d=document.location.href.substring(0,document.location.href.indexOf("/p/")),e=d+"/ro/"+pad.clientVars.readOnlyId;b("#readonlyImage").attr("src","https://chart.googleapis.com/chart?chs=200x200&cht=qr&chld=H|0&chl="+e),b("#readonlyInput").val(e),s.toogleDropDown("readonly"),b("#readonlyInput").focus().select()}else"save"==a?i.saveNow():h.ace.callWithAce(function(b){var c=b.ace_getAttributeLookup();c[a]?"inline"==c[a]&&b.ace_toggleAttributeOnSelection(a):"undo"==a||"redo"==a?b.ace_doUndoRedo(a):"insertunorderedlist"==a?b.ace_doInsertUnorderedList():"indent"==a?b.ace_doIndentOutdent(!1)||b.ace_doInsertUnorderedList():"outdent"==a?b.ace_doIndentOutdent(!0):"clearauthorship"==a&&(b.ace_getRep().selStart&&b.ace_getRep().selEnd&&!b.ace_isCaret()?b.ace_setAttributeOnSelection("author",""):window.confirm("Clear authorship colors on entire document?")&&b.ace_performDocumentApplyAttributesToCharRange(0,b.ace_getRep().alltext.length,[["author",""]]))},a,!0);h.ace.focus()},toogleDropDown:function(a){var c=["embed","users","readonly","importexport"];if("none"==a){for(var d=0;d<c.length;d++)if("users"!=c[d]){var e=b("#"+c[d]);"none"!=e.css("display")&&e.slideUp("fast")}}else for(var d=0;d<c.length;d++){var e=b("#"+c[d]);"none"!=e.css("display")?e.slideUp("fast"):c[d]==a&&e.slideDown("fast")}},setSyncStatus:function(a){"syncing"==a?r.syncing():"done"==a&&r.done()},_removeEmoji:function(a){return a.replace(/(\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]|\uD83D[\uDE80-\uDEFF])/g,"")},_insertTextLink:function(a,b,c){var d=[["url",a]];this._insertTextAtCursor(b,d)},_insertReferenceLink:function(a,b){b.type=b.type.replace(/s$/,""),yam.modelController.initReferences([b]);var c=g.objectForReference(b);if(c){var d=c.full_name||c.name,e="["+l.camelize(b.type,!0)+":"+b.id+"]",h=[["yammer",e]],i=d;this._insertTextAtCursor(i,h)}else f.log("pages","[Error] attachment failed ",b)},_insertTextAtCursor:function(a,b){a=this._removeEmoji(a);var d=UNorm.nfc(a),e=(yam.ui.pages.lastSelStart,yam.ui.pages.lastSelEnd),f=setInterval(function(){if(h.ace.focus(),yam.ui.pages.hasFocus()){clearInterval(f);var a=yam.ui.pages.lastSelStart,g=!0;c.isEqual(a,yam.ui.pages.lastSelEnd)||(g=!1);var i=setInterval(function(){if(g?yam.ui.pages.setCaret(a[0],a[1]):yam.ui.pages.setSelection(a[0],a[1],e[0],e[1]),c.isEqual(yam.ui.pages.rep.selStart,a)&&(clearInterval(i),h.ace.callWithAce(function(a){a.ace_insertText(d,b),a.ace_insertText(" ")},"setText",!0),yam.ui.pages.isSelectionLost()))var f=0,j=a[1]+d.length+1,k=setInterval(function(){if(yam.ui.pages.hasFocus()){yam.ui.pages.setCaret(a[0],j);var b=c(c.zip(yam.ui.pages.rep.selStart,[a[0],j])).every(function(a){return a[0]===a[1]});b?(f++,5==f&&clearInterval(k)):f=0}else h.ace.focus()},20)},20)}},20)},_initFormatSelect:function(){var a=p.isIE();this.$select=b("#menu_left").find(".heading-select"),this.$select.change(this._onFormatChange.bind(this)),a&&11===a.version&&this.$select.click(c.bind(function(){b("iframe")[0].contentWindow.window.blur()},this))},_onFormatChange:function(a){if(this.isEnabled()){var c=b(a.target),d=c.find("option:selected").val();if(d){d=d.split(":");var e=d.shift(),f=d.join("");this._changeTextFormat(e,f)}}},_changeTextFormat:function(a,b){h.ace.callWithAce(function(c){var d=c.ace_getAttributeLookup();d[a]&&(b?c.ace_setAttributeOnSelection(a,b):c.ace_setAttributeOnSelection(a,""))},a,!0),h.ace.focus()},_initMentionButton:function(){var a=this,c=b("#menu_right").find(".mention-icon-btn"),d=c.attr("title"),e=a.mentioner={buttonText:m.t("link"),template:'<div class="yj-lightbox-content yj-editor-lightbox yj-mention-lightbox">                       <div class="yj-editor-lightbox-field-wrap">                         <label><span class="yj-acc-hidden">'+m.t("person_to_link_to")+'</span>                           <input type="text" class="yj-mention-field" wrap="off" />                         </label>                       </div>                     </div>'},f=6,g=n.MODEL_USER,h=n.MODEL_DOMAIN,i={onSelect:function(b,c){return a._onMentionSubmit(b)},minSize:200,width:220,allowWide:!1,maxResults:f,completableModels:this.includeEmails?[g,h]:[g],includeEmails:this.includeEmails};this.includeEmails&&(i.earlyModelResults={},i.earlyModelResults[g]=4,i.earlyModelResults[h]=2),c.click(function(){e.$content=b(e.template),e.$mentionField=e.$content.find(".yj-mention-field"),n.registerField(e.$mentionField,i);var a={title:d,width:500,html:e.$content,transition:"none",onClosed:function(){e.$mentionField&&n.removeField(e.$mentionField),e.$content&&e.$content.empty().remove()}};k.trigger("/ui/lightbox/open",a),e.$mentionField.focus()})},_onMentionSubmit:function(a){return a?(this._insertReferenceLink("user",a),void k.trigger("/ui/lightbox/close")):!1},_initLinkerButton:function(){var a=this,c=b("#menu_right").find(".link-app-icon-btn"),e=c.attr("title"),f=a.linker={buttonText:m.t("ok"),template:'<div class="yj-lightbox-content yj-editor-lightbox yj-linker-lightbox">                      <form class="yj-linker-form">                       <div class="yj-editor-lightbox-field-wrap">                         <label class="yj-editor-lightbox-label">{{textLabel}}                           <input type="text" name="link_text" class="yj-link-text yj-editor-lightbox-field" wrap="off" />                         </label>                         <div class="clear"></div>                       </div>                       <div class="yj-editor-lightbox-field-wrap">                         <label class="yj-editor-lightbox-label">{{ urlLabel }}                           <input type="text" name="link_url" class="yj-link-url yj-editor-lightbox-field" wrap="off" />                         </label>                         <div class="clear"></div>                       </div>                       <div class="yj-editor-submit-wrap">                         <button type="button" class="yj-btn yj-linker-form-submit yj-btn-disabled" disabled>{{ buttonText }}</button>                       </div>                      </form>                     </div>',hasInput:function(){var a=this;if(!a.$content)return!1;var c=b.trim(a.$urlInput.val()),d=b.trim(a.$textInput.val());return!(!c||!d)},isDisabled:function(){return f.$submitBtn.hasClass("yj-btn-disabled")},enable:function(){f.$submitBtn.removeClass("yj-btn-disabled").prop("disabled",!1)},disable:function(){f.$submitBtn.addClass("yj-btn-disabled").prop("disabled",!0)},check:function(){f.hasInput()?f.enable():f.disable()}};c.click(function(){var c=!1,g=function(){c||(c=!0,this._onLinkerSubmit()===!1&&(c=!1))};f.$content=b(d.to_html(f.template,{buttonText:f.buttonText,textLabel:m.t("text_to_display"),urlLabel:m.t("url")})),f.$textInput=f.$content.find(".yj-link-text"),f.$urlInput=f.$content.find(".yj-link-url"),f.$submitBtn=f.$content.find(".yj-linker-form-submit").click(g.bind(a)),f.$form=f.$content.find(".yj-linker-form").submit(g.bind(a)).keydown(function(b){13==b.which&&g.bind(a)(b)});var h=f.check.bind(f);f.$content.find("input").bind("blur",h),f.checkTimer=setInterval(h,400),f.check();var i=yam.ui.pages.getSelectedText(!0);i&&f.$textInput.val(i);var j={title:e,width:500,html:f.$content,transition:"none",onClosed:function(){f.$content&&(f.$content.empty().remove(),f.$content=null,f.$textInput=null,f.$urlInput=null,f.$submitBtn=null,clearInterval(f.checkTimer))}};k.trigger("/ui/lightbox/open",j),f.$content.find(".yj-link-text").focus()})},_onLinkerSubmit:function(a){var c,d=this.linker,e=b.trim(d.$urlInput.val()),f=d.$textInput.val();if(!d.hasInput()||d.isDisabled())return!1;if(e){c=o.parse(e||""),"http"!=c.protocol&&"https"!=c.protocol&&(c.protocol="http");var g=/[a-z0-9%]|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}/;c.host&&g.test(c.host)||(c=null,e=null)}return c&&(e=o.stringify(c)),e?f?(this._insertTextLink(e,f),void k.trigger("/ui/lightbox/close")):(alert("Please enter or select text to link."),!1):(alert("Please enter a valid url."),!1)},_initFileButton:function(){var a=this,c=b("#menu_right").find(".file-icon-btn"),d=(c.attr("title"),{inLightbox:!0,groupId:pad.getYammerConfig().groupId,defaultSelector:q.FILES});c.click(function(){var b=new q(d);a.attacher=e.openComponent(b,"yj-attachment-selector-lightbox",void 0,{title:m.t("create_a_link"),width:"810",height:"480",overlayClose:!1,onClose:function(){a.attacher=null,b.remove()},onComplete:function(){b.addUploader()}}),a.attacher.on("select",a._onAttach.bind(a))})},_initPageButton:function(){var a=this,c=b("#menu_right").find(".page-pen-icon-btn"),d=(c.attr("title"),{inLightbox:!0,groupId:pad.getYammerConfig().groupId,defaultSelector:q.PAGES}),f={title:m.t("create_a_link"),width:"810",height:"480",overlayClose:!1,onClose:function(){a.attacher=null}};c.click(function(){a.attacher=e.openComponent(new q(d),"yj-attachment-selector-lightbox",void 0,f),a.attacher.on("select",a._onAttach.bind(a))})},_onAttach:function(a){if(!a)return!1;var b,c=this.attacher;return c?("files"==c.currentSelector?b="uploaded_file":"pages"==c.currentSelector&&(b="page"),this._insertReferenceLink(b,a),void k.trigger("/ui/lightbox/close")):!1},_watchSelection:function(){var a,d,e=c(arguments).detect(function(a){return a&&"heading"==a.key});e?(a=parseInt(e.val,10),d=this.$select.children()[a],d&&b(d).prop("selected",!0)):this.$select.children().first().prop("selected",!0)}};return window.padeditbar=s,s}),define("paddie-client/lib/pad_impexp",["require","jquery","paddie-client/lib/pad_docbar"],function(a){function b(){m("#import .importframe").remove();var a=m('<iframe style="display: none;" name="importiframe" class="importframe"></iframe>');m("#import").append(a)}function c(){m("#importformfilediv").addClass("importformenabled"),m("#importsubmitinput").removeAttr("disabled"),m("#importmessagefail").fadeOut("fast"),m("#importarrow").show(),m("#importarrow").animate({paddingLeft:"0px"},500).animate({paddingLeft:"10px"},150,"swing").animate({paddingLeft:"0px"},150,"swing").animate({paddingLeft:"10px"},150,"swing").animate({paddingLeft:"0px"},150,"swing").animate({paddingLeft:"10px"},150,"swing").animate({paddingLeft:"0px"},150,"swing")}function d(){m("#importmessagefail").fadeOut("fast");var a=window.confirm("Importing a file will overwrite the current text of the pad. Are you sure you want to proceed?");return a&&(p=n.hideLaterIfNoOtherInteraction(),o=window.setTimeout(function(){o&&(o=null,e("Request timed out."))},25e3),m("#importsubmitinput").attr({disabled:!0}).val("Importing..."),window.setTimeout(function(){m("#importfileinput").attr({disabled:!0})},0),m("#importarrow").stop(!0,!0).hide(),m("#importstatusball").show(),m("#import .importframe").load(function(){f()})),a}function e(a){h(a),f(),b()}function f(){m("#importsubmitinput").removeAttr("disabled").val("Import Now"),window.setTimeout(function(){m("#importfileinput").removeAttr("disabled")},0),m("#importstatusball").hide(),g()}function g(){o&&(window.clearTimeout(o),o=null)}function h(a){function b(b){m("#importmessagefail").html('<strong style="color: red">Import failed:</strong> '+(a||"Please try a different file."))[b?"fadeIn":"show"]()}m("#importexport .importmessage").is(":visible")?(m("#importmessagesuccess").fadeOut("fast"),m("#importmessagefail").fadeOut("fast",function(){b(!0)})):b()}function i(a){m.ajax({type:"post",url:"/ep/pad/impexp/import2",data:{token:a,padId:pad.getPadId()},success:k,error:j,timeout:25e3}),b()}function j(a,b,c){h("Error during conversion."),f()}function k(a,b){"ok"==a.substr(0,2)?(m("#importexport .importmessage").is(":visible")&&m("#importexport .importmessage").hide(),m("#importmessagesuccess").html('<strong style="color: green">Import successful!</strong>').show(),m("#importformfilediv").hide(),window.setTimeout(function(){m("#importmessagesuccess").fadeOut("slow",function(){m("#importformfilediv").show()}),p&&p()},3e3)):"fail"==a.substr(0,4)?h('Couldn\'t update pad contents. This can happen if your web browser has "cookies" disabled.'):"msg:"==a.substr(0,4)&&h(a.substr(4)),f()}function l(){var a=m(this);return a=a.hasClass("exporthrefpdf")?"PDF":a.hasClass("exporthrefdoc")?"Microsoft Word":a.hasClass("exporthrefodt")?"OpenDocument":"this file",alert("Exporting as "+a+" format is disabled. Please contact your system administrator for details."),!1}var m=a("jquery"),n=a("paddie-client/lib/pad_docbar"),o=null,p=null,q={init:function(){m("#exporthtmla").attr("href",document.location.pathname+"/export/html"),m("#exportplaina").attr("href",document.location.pathname+"/export/txt");var a=pad.clientVars;"no"==a.abiwordAvailable?(m("#exportworda").remove(),m("#exportpdfa").remove(),m("#exportopena").remove(),m("#importexport").css({height:"95px"}),m("#importexportline").css({height:"95px"}),m("#import").html("Import is not available")):"withoutPDF"==a.abiwordAvailable?(m("#exportpdfa").remove(),m("#exportworda").attr("href",document.location.pathname+"/export/doc"),m("#exportopena").attr("href",document.location.pathname+"/export/odt"),m("#importexport").css({height:"142px"}),m("#importexportline").css({height:"142px"}),m("#importform").get(0).setAttribute("action",document.location.href+"/import")):(m("#exportworda").attr("href",document.location.pathname+"/export/doc"),m("#exportpdfa").attr("href",document.location.pathname+"/export/pdf"),m("#exportopena").attr("href",document.location.pathname+"/export/odt"),m("#importform").get(0).setAttribute("action",document.location.pathname+"/import")),m("#impexp-close").click(function(){n.setShownPanel(null)}),b(),m("#importfileinput").change(c),m("#importform").submit(d),m(".disabledexport").click(l)},handleFrameCall:function(a,b){"importFailed"==a?e(b[0]):"importSuccessful"==a&&i(b[0])},disable:function(){m("#impexp-disabled-clickcatcher").show(),m("#import").css("opacity",.5),m("#impexp-export").css("opacity",.5)},enable:function(){m("#impexp-disabled-clickcatcher").hide(),m("#import").css("opacity",1),m("#impexp-export").css("opacity",1)}};return q}),define("paddie-client/lib/pad_userlist",["require","jquery","paddie-client/lib/pad_utils"],function(a){function b(a){return e("#colorpickerswatches li").index(a)}function c(a){if(a){var b=e("#mycolorpickerpreview").css("background-color"),c=b.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);delete c[0];for(var d=1;3>=d;++d)c[d]=parseInt(c[d]).toString(16),1==c[d].length&&(c[d]="0"+c[d]);var b="#"+c.join("");g.colorId=b,pad.notifyChangeColor(b),k.renderMyUserInfo()}h=!1,e("#mycolorpicker").fadeOut("fast")}function d(){if(j=g.colorId,!h){var a=pad.getColorPalette();if(!i){for(var c=e("#colorpickerswatches"),d=0;d<a.length;d++){var f=e("<li>",{style:"background: "+a[d]+";"});f.appendTo(c),f.bind("click",function(a){e("#colorpickerswatches li").removeClass("picked"),e(a.target).addClass("picked");var c=b(e("#colorpickerswatches .picked"));pad.notifyChangeColor(c)})}i=!0}e("#mycolorpicker").fadeIn(),h=!0,e("#colorpickerswatches li").removeClass("picked"),e(e("#colorpickerswatches li")[g.colorId]).addClass("picked")}}var e=a("jquery"),f=a("paddie-client/lib/pad_utils"),g={},h=!1,i=!1,j=0,k=function(){function a(a,c){i(a,function(){var a=b(c);return a>=0?l[a].name||"":""},function(b){b?(a.attr("disabled","disabled"),pad.suggestUserName(c,b)):(a.addClass("editempty"),a.val("unnamed"))})}function b(a){for(var b=-1,c=0;c<l.length;c++)if(l[c].userId==a){b=c;break}return b}function i(a,b,c){a.bind("focus",function(c){var d=b();a.val()!==d&&a.val(d),a.addClass("editactive").removeClass("editempty")}),a.bind("blur",function(b){var d=a.removeClass("editactive").val();c(d)}),f.bindEnterAndEscape(a,function(){a.blur()},function(){a.val(b()).blur()}),a.removeAttr("disabled").addClass("editable")}function j(){0==l.length?(e("#otheruserstable").hide(),e("#nootherusers").show()):(e("#nootherusers").hide(),e("#otheruserstable").show())}var k=function(){function b(){return"usertr"+b.counter++}function c(a,b){var c=Math.abs(a/12);return 2==b?c*=c:3==b?c=c*c*c:4==b?c=c*c*c*c:b>=5&&(c=c*c*c*c*c),Math.round(26*(1-c))}function d(a){return'<td colspan="'+C+'" style="border:0;height:'+a+'px"><!-- --></td>'}function g(a){return!a.name&&"Disconnected"!=a.status}function h(a,b,c){var d=i(b,c).match(/<td.*?<\/td>/gi);if(g(c)&&a.find("td.usertdname input:enabled").length>0)for(var f=0;f<d.length;f++){var h=e(a.find("td").get(f));h.hasClass("usertdname")||h.replaceWith(d[f])}else a.html(d.join(""));return a}function i(a,b){var c,d="p"!=b.id.charAt(0);return b.name?(c=f.escapeHtml(b.name),d&&pad.getIsProPad()&&(c+=" (Guest)")):c='<input type="text" class="editempty newinput" value="unnamed" '+(g(b)?"":'disabled="disabled" ')+"/>",['<td style="height:',a,'px" class="usertdswatch"><div class="swatch" style="background:'+b.color+'">&nbsp;</div></td>','<td style="height:',a,'px" class="usertdname">',c,"</td>",'<td style="height:',a,'px" class="usertdstatus">',f.escapeHtml(b.status),"</td>",'<td style="height:',a,'px" class="activity">',f.escapeHtml(b.activity),"</td>"].join("")}function j(a,b){return'<tr id="'+a+'">'+b+"</tr>"}function k(a){return e("#"+a.domId)}function l(a){a.data&&"Disconnected"==a.data.status?a.opacity=.5:delete a.opacity}function m(a,b){if(b.titleText){b.titleText;window.setTimeout(function(){},0)}else a.removeAttr("title")}function n(){e("#otheruserstable input.newinput").each(function(){var b=e(this),c=b.closest("tr");if(c.length>0){var d=c.parent().children().index(c);if(d>=0){var f=v[d].data.id;a(e(this),f)}}}).removeClass("newinput")}function o(a,f,g){a=Math.max(0,Math.min(v.length,a)),g=void 0===g?4:g;var h=b(),o={data:f,animationStep:w,domId:h,animationPower:g};l(o),v.splice(a,0,o);var p;return 0==g?(p=e(j(h,i(c(0),f))),o.animationStep=0):(u.push(o),p=e(j(h,d(c(w))))),m(p,f),0==a?e("table#otheruserstable").prepend(p):k(v[a-1]).after(p),0!=g&&B(),n(),o}function p(a,b){var d=v[a];if(d&&(d.data=b,l(d),0==d.animationStep)){var e=k(d);h(e,c(0),d.data).find("td").css("opacity",void 0===d.opacity?1:d.opacity),m(e,b),n()}}function q(a,b){b=void 0===b?4:b;var c=v[a];c&&(v.splice(a,1),0==b?k(c).remove():(c.animationStep=-c.animationStep,c.animationPower=b,t.push(c),B()))}function r(a,b,c){c=void 0===c?1:c;var d=v[a];if(d&&a!=b){var e=d.data;q(a,c),o(b,e,c)}}function s(){for(var a=u.length-1;a>=0;a--){var b=u[a],e=++b.animationStep,f=c(e,b.animationPower),g=k(b),h=void 0===b.opacity?1:b.opacity;-y>=e?g.find("td").height(f):e==-y+1?(g.html(i(f,b.data)).find("td").css("opacity",1*h/y),m(g,b.data)):0>e?g.find("td").css("opacity",h*(y- -e)/y).height(f):0==e&&(g.html(i(f,b.data)).find("td").css("opacity",1*h).height(f),m(g,b.data),u.splice(a,1))}for(var a=t.length-1;a>=0;a--){var b=t[a],e=++b.animationStep,g=k(b),f=c(e,b.animationPower),h=void 0===b.opacity?1:b.opacity;y>e?g.find("td").css("opacity",h*(y-e)/y).height(f):e==y?g.html(d(f)):x>=e?g.find("td").height(f):(t.splice(a,1),g.remove())}return n(),u.length>0||t.length>0}b.counter=1;var t=[],u=[],v=[],w=-12,x=12,y=6,z=20,A=2,B=f.makeAnimationScheduler(s,z,A).scheduleAnimation,C=4,D={insertRow:o,removeRow:q,moveRow:r,updateRow:p};return D}(),l=[],m=[],n={},o=0,p=f.makeAnimationScheduler(function(){var a=e("#guestprompts .guestprompt");return 0==a.length?!1:(o=1-o,o?a.css("background","#ffa"):a.css("background","#ffe"),!0)},1e3),q={init:function(a){q.setMyUserInfo(a),e("#otheruserstable tr").remove(),pad.getUserIsGuest()&&(e("#myusernameedit").addClass("myusernameedithoverable"),i(e("#myusernameedit"),function(){return g.name||yam.currentUser.id},function(a){g.name=a,pad.notifyChangeName(a),window.setTimeout(function(){q.renderMyUserInfo()},0)})),e("#myswatchbox").click(d),e("#mycolorpicker .pickerswatchouter").click(function(){e("#mycolorpicker .pickerswatchouter").removeClass("picked"),e(this).addClass("picked")}),e("#mycolorpickersave").click(function(){c(!0)}),e("#mycolorpickercancel").click(function(){c(!1)})},setMyUserInfo:function(a){"number"==typeof a.colorId&&(a.colorId=pad.clientVars.colorPalette[a.colorId]),g=e.extend({},a),q.renderMyUserInfo()},userJoinOrUpdate:function(a){if(a.userId&&a.userId!=g.userId){var c={};c.color="number"==typeof a.colorId?pad.clientVars.colorPalette[a.colorId]:a.colorId,c.name=a.name,c.status="",c.activity="",c.id=a.userId,c.titleText=[a.userAgent||"",a.ip||""].join(" \n");var d=b(a.userId),e=l.length;d>=0&&e--;var h=f.binarySearch(e,function(b){d>=0&&b>=d&&b++;var c=l[b],e=(c.name||"").toLowerCase(),f=(a.name||"").toLowerCase(),g=c.userId,h=a.userId;return e>f||e==f&&g>h});d>=0?d==h?(l[d]=a,m[d]=c,k.updateRow(d,c)):(l.splice(d,1),m.splice(d,1),l.splice(h,0,a),m.splice(h,0,c),k.updateRow(d,c),k.moveRow(d,h)):(l.splice(h,0,a),m.splice(h,0,c),k.insertRow(h,c)),j(),q.updateNumberOfOnlineUsers()}},updateNumberOfOnlineUsers:function(){for(var a=1,b=0;b<m.length;b++)""==m[b].status&&a++;return e("#online_count").text(a),a},userLeave:function(a){var c=b(a.userId);if(c>=0){var d=m[c];d.status="Disconnected",k.updateRow(c,d),d.leaveTimer&&window.clearTimeout(d.leaveTimer);var e=a.userId,f=window.setTimeout(function(){var a=b(e);if(a>=0){var c=m[a];"Disconnected"==c.status&&c.leaveTimer==f&&(l.splice(a,1),m.splice(a,1),k.removeRow(a),j())}},8e3);d.leaveTimer=f}j(),q.updateNumberOfOnlineUsers()},showGuestPrompt:function(a,b){if(!n[a]){var c=f.encodeUserId(a),d="hide-guest-prompt-"+c;f.cancelActions(d);var g=e("#guestprompt-"+c);0==g.length?(g=e('<div id="guestprompt-'+c+'" class="guestprompt"><div class="choices"><a href="javascript:void(paduserlist.answerGuestPrompt(\''+c+"',false))\">Deny</a> <a href=\"javascript:void(paduserlist.answerGuestPrompt('"+c+'\',true))">Approve</a></div><div class="guestname"><strong>Guest:</strong> '+f.escapeHtml(b)+"</div></div>"),e("#guestprompts").append(g)):g.find(".guestname").html("<strong>Guest:</strong> "+f.escapeHtml(b));var h=f.getCancellableAction(d,function(){q.removeGuestPrompt(a)});window.setTimeout(h,15e3),p.scheduleAnimation()}},removeGuestPrompt:function(a){var b=e("#guestprompt-"+f.encodeUserId(a));b.removeAttr("id").fadeOut("fast",function(){b.remove()}),n[a]=!0,window.setTimeout(function(){delete n[a]},5e3)},answerGuestPrompt:function(a,b){var c=f.decodeUserId(a),d={type:"guestanswer",authId:pad.getUserId(),guestId:c,answer:b?"approved":"denied"};pad.sendClientMessage(d),q.removeGuestPrompt(c)},renderMyUserInfo:function(){g.name?e("#myusernameedit").removeClass("editempty").val(g.name):e("#myusernameedit").addClass("editempty").val("Enter your name"),h?e("#myswatchbox").addClass("myswatchboxunhoverable").removeClass("myswatchboxhoverable"):e("#myswatchbox").addClass("myswatchboxhoverable").removeClass("myswatchboxunhoverable"),e("#myswatch").css({"background-color":g.colorId})}};return q}();return window.paduserlist=k,k}),/*
// Copyright 2006 Google Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
*/
document.createElement("canvas").getContext||!function(){function a(){return this.context_||(this.context_=new j(this))}function b(a,b,c){var d=x.call(arguments,2);return function(){return a.apply(b,d.concat(x.call(arguments)))}}function c(a){var b=a.srcElement;switch(a.propertyName){case"width":b.style.width=b.attributes.width.nodeValue+"px",b.getContext().clearRect();break;case"height":b.style.height=b.attributes.height.nodeValue+"px",b.getContext().clearRect()}}function d(a){var b=a.srcElement;b.firstChild&&(b.firstChild.style.width=b.clientWidth+"px",b.firstChild.style.height=b.clientHeight+"px")}function e(){return[[1,0,0],[0,1,0],[0,0,1]]}function f(a,b){for(var c=e(),d=0;3>d;d++)for(var f=0;3>f;f++){for(var g=0,h=0;3>h;h++)g+=a[d][h]*b[h][f];c[d][f]=g}return c}function g(a,b){b.fillStyle=a.fillStyle,b.lineCap=a.lineCap,b.lineJoin=a.lineJoin,b.lineWidth=a.lineWidth,b.miterLimit=a.miterLimit,b.shadowBlur=a.shadowBlur,b.shadowColor=a.shadowColor,b.shadowOffsetX=a.shadowOffsetX,b.shadowOffsetY=a.shadowOffsetY,b.strokeStyle=a.strokeStyle,b.globalAlpha=a.globalAlpha,b.arcScaleX_=a.arcScaleX_,b.arcScaleY_=a.arcScaleY_,b.lineScale_=a.lineScale_}function h(a){var b,c=1;if(a=String(a),"rgb"==a.substring(0,3)){var d=a.indexOf("(",3),e=a.indexOf(")",d+1),f=a.substring(d+1,e).split(",");b="#";for(var g=0;3>g;g++)b+=z[Number(f[g])];4==f.length&&"a"==a.substr(3,1)&&(c=f[3])}else b=a;return{color:b,alpha:c}}function i(a){switch(a){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function j(a){this.m_=e(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.strokeStyle="#000",this.fillStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*v,this.globalAlpha=1,this.canvas=a;var b=a.ownerDocument.createElement("div");b.style.width=a.clientWidth+"px",b.style.height=a.clientHeight+"px",b.style.overflow="hidden",b.style.position="absolute",a.appendChild(b),this.element_=b,this.arcScaleX_=1,this.arcScaleY_=1,this.lineScale_=1}function k(a,b,c,d){a.currentPath_.push({type:"bezierCurveTo",cp1x:b.x,cp1y:b.y,cp2x:c.x,cp2y:c.y,x:d.x,y:d.y}),a.currentX_=d.x,a.currentY_=d.y}function l(a){for(var b=0;3>b;b++)for(var c=0;2>c;c++)if(!isFinite(a[b][c])||isNaN(a[b][c]))return!1;return!0}function m(a,b,c){if(l(b)&&(a.m_=b,c)){var d=b[0][0]*b[1][1]-b[0][1]*b[1][0];a.lineScale_=u(t(d))}}function n(a){this.type_=a,this.x0_=0,this.y0_=0,this.r0_=0,this.x1_=0,this.y1_=0,this.r1_=0,this.colors_=[]}function o(){}var p=Math,q=p.round,r=p.sin,s=p.cos,t=p.abs,u=p.sqrt,v=10,w=v/2,x=Array.prototype.slice,y={init:function(a){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var c=a||document;c.createElement("canvas"),c.attachEvent("onreadystatechange",b(this.init_,this,c))}},init_:function(a){if(a.namespaces.g_vml_||a.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML"),a.namespaces.g_o_||a.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML"),!a.styleSheets.ex_canvas_)try{var b=a.createStyleSheet();b.owningElement.id="ex_canvas_",b.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}catch(a){}for(var c=a.getElementsByTagName("canvas"),d=0;d<c.length;d++)this.initElement(c[d])},initElement:function(b){if(!b.getContext){b.getContext=a,b.innerHTML="",b.attachEvent("onpropertychange",c),b.attachEvent("onresize",d);var e=b.attributes;e.width&&e.width.specified?b.style.width=e.width.nodeValue+"px":b.width=b.clientWidth,e.height&&e.height.specified?b.style.height=e.height.nodeValue+"px":b.height=b.clientHeight}return b}};y.init();for(var z=[],A=0;16>A;A++)for(var B=0;16>B;B++)z[16*A+B]=A.toString(16)+B.toString(16);var C=j.prototype;C.clearRect=function(){this.element_.innerHTML=""},C.beginPath=function(){this.currentPath_=[]},C.moveTo=function(a,b){var c=this.getCoords_(a,b);this.currentPath_.push({type:"moveTo",x:c.x,y:c.y}),this.currentX_=c.x,this.currentY_=c.y},C.lineTo=function(a,b){var c=this.getCoords_(a,b);this.currentPath_.push({type:"lineTo",x:c.x,y:c.y}),this.currentX_=c.x,this.currentY_=c.y},C.bezierCurveTo=function(a,b,c,d,e,f){var g=this.getCoords_(e,f),h=this.getCoords_(a,b),i=this.getCoords_(c,d);k(this,h,i,g)},C.quadraticCurveTo=function(a,b,c,d){var e=this.getCoords_(a,b),f=this.getCoords_(c,d),g={x:this.currentX_+2/3*(e.x-this.currentX_),y:this.currentY_+2/3*(e.y-this.currentY_)},h={x:g.x+(f.x-this.currentX_)/3,y:g.y+(f.y-this.currentY_)/3};k(this,g,h,f)},C.arc=function(a,b,c,d,e,f){c*=v;var g=f?"at":"wa",h=a+s(d)*c-w,i=b+r(d)*c-w,j=a+s(e)*c-w,k=b+r(e)*c-w;h!=j||f||(h+=.125);var l=this.getCoords_(a,b),m=this.getCoords_(h,i),n=this.getCoords_(j,k);this.currentPath_.push({type:g,x:l.x,y:l.y,radius:c,xStart:m.x,yStart:m.y,xEnd:n.x,yEnd:n.y})},C.rect=function(a,b,c,d){this.moveTo(a,b),this.lineTo(a+c,b),this.lineTo(a+c,b+d),this.lineTo(a,b+d),this.closePath()},C.strokeRect=function(a,b,c,d){var e=this.currentPath_;this.beginPath(),this.moveTo(a,b),this.lineTo(a+c,b),this.lineTo(a+c,b+d),this.lineTo(a,b+d),this.closePath(),this.stroke(),this.currentPath_=e},C.fillRect=function(a,b,c,d){var e=this.currentPath_;this.beginPath(),this.moveTo(a,b),this.lineTo(a+c,b),this.lineTo(a+c,b+d),this.lineTo(a,b+d),this.closePath(),this.fill(),this.currentPath_=e},C.createLinearGradient=function(a,b,c,d){var e=new n("gradient");return e.x0_=a,e.y0_=b,e.x1_=c,e.y1_=d,e},C.createRadialGradient=function(a,b,c,d,e,f){var g=new n("gradientradial");return g.x0_=a,g.y0_=b,g.r0_=c,g.x1_=d,g.y1_=e,g.r1_=f,g},C.drawImage=function(a,b){var c,d,e,f,g,h,i,j,k=a.runtimeStyle.width,l=a.runtimeStyle.height;a.runtimeStyle.width="auto",a.runtimeStyle.height="auto";var m=a.width,n=a.height;if(a.runtimeStyle.width=k,a.runtimeStyle.height=l,3==arguments.length)c=arguments[1],d=arguments[2],g=h=0,i=e=m,j=f=n;else if(5==arguments.length)c=arguments[1],d=arguments[2],e=arguments[3],f=arguments[4],g=h=0,i=m,j=n;else{if(9!=arguments.length)throw Error("Invalid number of arguments");g=arguments[1],h=arguments[2],i=arguments[3],j=arguments[4],c=arguments[5],d=arguments[6],e=arguments[7],f=arguments[8]}var o=this.getCoords_(c,d),r=[],s=10,t=10;if(r.push(" <g_vml_:group",' coordsize="',v*s,",",v*t,'"',' coordorigin="0,0"',' style="width:',s,"px;height:",t,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]){var u=[];u.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",q(o.x/v),",","Dy=",q(o.y/v),"");var w=o,x=this.getCoords_(c+e,d),y=this.getCoords_(c,d+f),z=this.getCoords_(c+e,d+f);w.x=p.max(w.x,x.x,y.x,z.x),w.y=p.max(w.y,x.y,y.y,z.y),r.push("padding:0 ",q(w.x/v),"px ",q(w.y/v),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",u.join(""),", sizingmethod='clip');")}else r.push("top:",q(o.y/v),"px;left:",q(o.x/v),"px;");r.push(' ">','<g_vml_:image src="',a.src,'"',' style="width:',v*e,"px;"," height:",v*f,'px;"',' cropleft="',g/m,'"',' croptop="',h/n,'"',' cropright="',(m-g-i)/m,'"',' cropbottom="',(n-h-j)/n,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",r.join(""))},C.stroke=function(a){var b=[],c=h(a?this.fillStyle:this.strokeStyle),d=c.color,e=c.alpha*this.globalAlpha,f=10,g=10;b.push("<g_vml_:shape",' filled="',!!a,'"',' style="position:absolute;width:',f,"px;height:",g,'px;"',' coordorigin="0 0" coordsize="',v*f," ",v*g,'"',' stroked="',!a,'"',' path="');for(var j={x:null,y:null},k={x:null,y:null},l=0;l<this.currentPath_.length;l++){var m,n=this.currentPath_[l];switch(n.type){case"moveTo":m=n,b.push(" m ",q(n.x),",",q(n.y));break;case"lineTo":b.push(" l ",q(n.x),",",q(n.y));break;case"close":b.push(" x "),n=null;break;case"bezierCurveTo":b.push(" c ",q(n.cp1x),",",q(n.cp1y),",",q(n.cp2x),",",q(n.cp2y),",",q(n.x),",",q(n.y));break;case"at":case"wa":b.push(" ",n.type," ",q(n.x-this.arcScaleX_*n.radius),",",q(n.y-this.arcScaleY_*n.radius)," ",q(n.x+this.arcScaleX_*n.radius),",",q(n.y+this.arcScaleY_*n.radius)," ",q(n.xStart),",",q(n.yStart)," ",q(n.xEnd),",",q(n.yEnd))}n&&((null==j.x||n.x<j.x)&&(j.x=n.x),(null==k.x||n.x>k.x)&&(k.x=n.x),(null==j.y||n.y<j.y)&&(j.y=n.y),(null==k.y||n.y>k.y)&&(k.y=n.y))}if(b.push(' ">'),a)if("object"==typeof this.fillStyle){var o=this.fillStyle,r=0,s={x:0,y:0},t=0,u=1;if("gradient"==o.type_){var w=o.x0_/this.arcScaleX_,x=o.y0_/this.arcScaleY_,y=o.x1_/this.arcScaleX_,z=o.y1_/this.arcScaleY_,A=this.getCoords_(w,x),B=this.getCoords_(y,z),C=B.x-A.x,D=B.y-A.y;r=180*Math.atan2(C,D)/Math.PI,0>r&&(r+=360),1e-6>r&&(r=0)}else{var A=this.getCoords_(o.x0_,o.y0_),E=k.x-j.x,F=k.y-j.y;s={x:(A.x-j.x)/E,y:(A.y-j.y)/F},E/=this.arcScaleX_*v,F/=this.arcScaleY_*v;var G=p.max(E,F);t=2*o.r0_/G,u=2*o.r1_/G-t}var H=o.colors_;H.sort(function(a,b){return a.offset-b.offset});for(var I=H.length,J=H[0].color,K=H[I-1].color,L=H[0].alpha*this.globalAlpha,M=H[I-1].alpha*this.globalAlpha,N=[],l=0;I>l;l++){var O=H[l];N.push(O.offset*u+t+" "+O.color)}b.push('<g_vml_:fill type="',o.type_,'"',' method="none" focus="100%"',' color="',J,'"',' color2="',K,'"',' colors="',N.join(","),'"',' opacity="',M,'"',' g_o_:opacity2="',L,'"',' angle="',r,'"',' focusposition="',s.x,",",s.y,'" />')}else b.push('<g_vml_:fill color="',d,'" opacity="',e,'" />');else{var P=this.lineScale_*this.lineWidth;1>P&&(e*=P),b.push("<g_vml_:stroke",' opacity="',e,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',i(this.lineCap),'"',' weight="',P,'px"',' color="',d,'" />')}b.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",b.join(""))},C.fill=function(){this.stroke(!0)},C.closePath=function(){this.currentPath_.push({type:"close"})},C.getCoords_=function(a,b){var c=this.m_;return{x:v*(a*c[0][0]+b*c[1][0]+c[2][0])-w,y:v*(a*c[0][1]+b*c[1][1]+c[2][1])-w}},C.save=function(){var a={};g(this,a),this.aStack_.push(a),this.mStack_.push(this.m_),this.m_=f(e(),this.m_)},C.restore=function(){g(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},C.translate=function(a,b){var c=[[1,0,0],[0,1,0],[a,b,1]];m(this,f(c,this.m_),!1)},C.rotate=function(a){var b=s(a),c=r(a),d=[[b,c,0],[-c,b,0],[0,0,1]];m(this,f(d,this.m_),!1)},C.scale=function(a,b){this.arcScaleX_*=a,this.arcScaleY_*=b;var c=[[a,0,0],[0,b,0],[0,0,1]];m(this,f(c,this.m_),!0)},C.transform=function(a,b,c,d,e,g){var h=[[a,b,0],[c,d,0],[e,g,1]];m(this,f(h,this.m_),!0)},C.setTransform=function(a,b,c,d,e,f){var g=[[a,b,0],[c,d,0],[e,f,1]];m(this,g,!0)},C.clip=function(){},C.arcTo=function(){},C.createPattern=function(){return new o},n.prototype.addColorStop=function(a,b){b=h(b),this.colors_.push({offset:a,color:b.color,alpha:b.alpha})},G_vmlCanvasManager=y,CanvasRenderingContext2D=j,CanvasGradient=n,CanvasPattern=o}(),define("paddie-client/lib/excanvas",function(){}),define("paddie-client/lib/farbtastic",["require","common-ui/lib/helper/environment"],function(a){var b=a("common-ui/lib/helper/environment");!function(a){var c=!1,d=.5;a.fn.farbtastic=function(b){return a.farbtastic(this,b),this},a.farbtastic=function(b,c){var b=a(b)[0];return b.farbtastic||(b.farbtastic=new a._farbtastic(b,c))},a._farbtastic=function(e,f){var g=this;g.linkTo=function(b){return"object"==typeof g.callback&&a(g.callback).unbind("keyup",g.updateValue),g.color=null,"function"==typeof b?g.callback=b:"object"!=typeof b&&"string"!=typeof b||(g.callback=a(b),g.callback.bind("keyup",g.updateValue),g.callback[0].value&&g.setColor(g.callback[0].value)),this},g.updateValue=function(a){this.value&&this.value!=g.color&&g.setColor(this.value)},g.setColor=function(a){var b=g.unpack(a);return g.color!=a&&b&&(g.color=a,g.rgb=b,g.hsl=g.RGBToHSL(g.rgb),g.updateDisplay()),this},g.setHSL=function(a){g.hsl=a;var b=[a[0]];return b[1]=a[1]*d+(1-d)/2,b[2]=a[2]*d+(1-d)/2,g.rgb=g.HSLToRGB(b),g.color=g.pack(g.rgb),g.updateDisplay(),this},g._makeCanvas=function(b){var c=document.createElement("canvas");return c.getContext||(c=window.G_vmlCanvasManager.initElement(c),c.getContext()),a(c).addClass(b),c},g.initWidget=function(){var b={width:f.width,height:f.width};a(e).html('<div class="farbtastic" style="position: relative"><div class="farbtastic-solid"></div></div>').children(".farbtastic").append(g._makeCanvas("farbtastic-mask")).append(g._makeCanvas("farbtastic-overlay")).end().find("*").attr(b).css(b).end().find("div>*").css("position","absolute"),g.radius=(f.width-f.wheelWidth)/2-1,g.square=Math.floor(.7*(g.radius-f.wheelWidth/2))-1,g.mid=Math.floor(f.width/2),g.markerSize=.3*f.wheelWidth,g.solidFill=a(".farbtastic-solid",e).css({width:2*g.square-1,height:2*g.square-1,left:g.mid-g.square,top:g.mid-g.square}),g.cnvMask=a(".farbtastic-mask",e),g.ctxMask=g.cnvMask[0].getContext("2d"),g.cnvOverlay=a(".farbtastic-overlay",e),g.ctxOverlay=g.cnvOverlay[0].getContext("2d"),g.ctxMask.translate(g.mid,g.mid),g.ctxOverlay.translate(g.mid,g.mid),g.drawCircle(),g.drawMask()},g.drawCircle=function(){var d,e,h=+new Date,i=24,j=g.radius,k=f.wheelWidth,l=8/j/i*Math.PI,m=g.ctxMask,n=0;m.save(),m.lineWidth=k/j,m.scale(j,j);for(var o=0;i>=o;++o){var p=o/i,q=p*Math.PI*2,r=Math.sin(n),s=-Math.cos(n);if(x2=Math.sin(q),y2=-Math.cos(q),am=(n+q)/2,tan=1/Math.cos((q-n)/2),xm=Math.sin(am)*tan,ym=-Math.cos(am)*tan,color2=g.pack(g.HSLToRGB([p,1,.5])),o>0)if(b.isOlderIE()){var t=(1+Math.min(Math.abs(Math.tan(n)),Math.abs(Math.tan(Math.PI/2-n))))/i;d=g.pack(g.HSLToRGB([e-.15*t,1,.5])),color2=g.pack(g.HSLToRGB([p+.15*t,1,.5]));var u=m.createLinearGradient(r,s,x2,y2);u.addColorStop(0,d),u.addColorStop(1,color2),m.fillStyle=u;var v=(j+k/2)/j,w=(j-k/2)/j;m.beginPath(),m.moveTo(r*v,s*v),m.quadraticCurveTo(xm*v,ym*v,x2*v,y2*v),m.lineTo(x2*w,y2*w),m.quadraticCurveTo(xm*w,ym*w,r*w,s*w),m.fill()}else{var u=m.createLinearGradient(r,s,x2,y2);u.addColorStop(0,d),u.addColorStop(1,color2),m.strokeStyle=u,m.beginPath(),m.moveTo(r,s),m.quadraticCurveTo(xm,ym,x2,y2),m.stroke()}n=q-l,d=color2,e=p}m.restore(),c&&a("body").append("<div>drawCircle "+(+new Date-h)+"ms")},g.drawMask=function(){function e(a,b,c){for(var e=1/a,f=1/b,g=0;b>=g;++g)for(var h=1-g*f,i=0;a>=i;++i){var j=1-i*e,k=1-2*Math.min(h*j,(1-h)*j),l=k>0?.5*(2*h-1+k)/k:0;k=k*d+(1-d)/2,l=l*d+(1-d)/2,c(i,g,l,k)}}var f=+new Date,h=2*g.square,i=g.square;if(g.ctxMask.getImageData){var j=Math.floor(h/2),k=document.createElement("canvas");k.width=k.height=j+1;var l=k.getContext("2d"),m=l.getImageData(0,0,j+1,j+1),n=0;e(j,j,function(a,b,c,d){m.data[n++]=m.data[n++]=m.data[n++]=255*c,m.data[n++]=255*d}),l.putImageData(m,0,0),g.ctxMask.drawImage(k,0,0,j+1,j+1,-i,-i,2*i,2*i)}else if(b.isOlderIE()){var o,p,q=6,r=Math.floor(h/q);e(r,6,function(b,c,d,e){if(0==b&&(o=p,p=[]),d=Math.round(255*d),e=Math.round(255*e),c>0){var f=o[b][0],h=o[b][1],j=g.packDX(f,h),k=g.packDX(d,e),l=Math.round(g.mid+(.333*(c-1)-1)*i),m=Math.round(g.mid+(.333*c-1)*i);a("<div>").css({position:"absolute",filter:"progid:DXImageTransform.Microsoft.Gradient(StartColorStr="+j+", EndColorStr="+k+", GradientType=0)",top:l,height:m-l,left:g.mid+(b*q-i-1),width:q-(b==r?Math.round(q/2):0)}).appendTo(g.cnvMask)}p.push([d,e])})}else{var j=Math.floor(h/2);e(j,j,function(a,b,c,d){c=Math.round(255*c),g.ctxMask.fillStyle="rgba("+c+", "+c+", "+c+", "+d+")",g.ctxMask.fillRect(2*a-i-1,2*b-i-1,2,2)})}c&&a("body").append("<div>drawMask "+(+new Date-f)+"ms")},g.drawMarkers=function(){var a=f.width,b=Math.ceil(g.markerSize/4),c=g.markerSize-b+1,d=6.28*g.hsl[0],e=Math.sin(d)*g.radius,h=-Math.cos(d)*g.radius,j=2*g.square*(.5-g.hsl[1]),k=2*g.square*(.5-g.hsl[2]),l=g.invert?"#fff":"#000",m=g.invert?"#000":"#fff",n=[{x:e,y:h,r:c,c:"#000",lw:b+1},{x:e,y:h,r:g.markerSize,c:"#fff",lw:b},{x:j,y:k,r:c,c:m,lw:b+1},{x:j,y:k,r:g.markerSize,c:l,lw:b}];g.ctxOverlay.clearRect(-g.mid,-g.mid,a,a);for(i in n){var o=n[i];g.ctxOverlay.lineWidth=o.lw,g.ctxOverlay.strokeStyle=o.c,g.ctxOverlay.beginPath(),g.ctxOverlay.arc(o.x,o.y,o.r,0,2*Math.PI,!0),g.ctxOverlay.stroke()}},g.updateDisplay=function(){g.invert=.3*g.rgb[0]+.59*g.rgb[1]+.11*g.rgb[2]<=.6,g.solidFill.css("backgroundColor",g.pack(g.HSLToRGB([g.hsl[0],1,.5]))),g.drawMarkers(),"object"==typeof g.callback?(a(g.callback).css({backgroundColor:g.color,color:g.invert?"#fff":"#000"}),a(g.callback).each(function(){"string"==typeof this.value&&this.value!=g.color&&(this.value=g.color)})):"function"==typeof g.callback&&g.callback.call(g,g.color)},g.widgetCoords=function(a){return{x:a.pageX-g.offset.left-g.mid,y:a.pageY-g.offset.top-g.mid}},g.mousedown=function(b){a._farbtastic.dragging||(a(document).bind("mousemove",g.mousemove).bind("mouseup",g.mouseup),a._farbtastic.dragging=!0),g.offset=a(e).offset();var c=g.widgetCoords(b);return g.circleDrag=Math.max(Math.abs(c.x),Math.abs(c.y))>g.square+2,g.mousemove(b),!1},g.mousemove=function(a){var b=g.widgetCoords(a);if(g.circleDrag){var c=Math.atan2(b.x,-b.y)/6.28;g.setHSL([(c+1)%1,g.hsl[1],g.hsl[2]])}else{var d=Math.max(0,Math.min(1,-(b.x/g.square/2)+.5)),e=Math.max(0,Math.min(1,-(b.y/g.square/2)+.5));g.setHSL([g.hsl[0],d,e])}return!1},g.mouseup=function(){a(document).unbind("mousemove",g.mousemove),a(document).unbind("mouseup",g.mouseup),a._farbtastic.dragging=!1},g.dec2hex=function(a){return(16>a?"0":"")+a.toString(16)},g.packDX=function(a,b){return"#"+g.dec2hex(b)+g.dec2hex(a)+g.dec2hex(a)+g.dec2hex(a)},g.pack=function(a){var b=Math.round(255*a[0]),c=Math.round(255*a[1]),d=Math.round(255*a[2]);return"#"+g.dec2hex(b)+g.dec2hex(c)+g.dec2hex(d)},g.unpack=function(a){function b(b){return parseInt(a.substring(b,b+2),16)/255}function b(b){return parseInt(a.substring(b,b+1),16)/15}return 7==a.length?[b(1),b(3),b(5)]:4==a.length?[b(1),b(2),b(3)]:void 0},g.HSLToRGB=function(a){var b,c,d=a[0],e=a[1],f=a[2];return c=.5>=f?f*(e+1):f+e-f*e,b=2*f-c,[this.hueToRGB(b,c,d+.33333),this.hueToRGB(b,c,d),this.hueToRGB(b,c,d-.33333)]},g.hueToRGB=function(a,b,c){return c=(c+1)%1,1>6*c?a+(b-a)*c*6:1>2*c?b:2>3*c?a+(b-a)*(.66666-c)*6:a},g.RGBToHSL=function(a){var b=a[0],c=a[1],d=a[2],e=Math.min(b,c,d),f=Math.max(b,c,d),g=f-e,h=0,i=0,j=(e+f)/2;return j>0&&1>j&&(i=g/(.5>j?2*j:2-2*j)),g>0&&(f==b&&f!=c&&(h+=(c-d)/g),f==c&&f!=d&&(h+=2+(d-b)/g),f==d&&f!=b&&(h+=4+(b-c)/g),h/=6),[h,i,j]},f.callback||(f={callback:f}),f=a.extend({width:300,wheelWidth:(f.width||300)/10,callback:null},f),g.initWidget(),a("canvas.farbtastic-overlay",e).mousedown(g.mousedown),f.callback&&g.linkTo(f.callback),g.setColor("#808080")}}($)}),/**
 * Copyright 2009 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
window._orig_windowOpen&&(window.open=_orig_windowOpen),window._orig_windowSetTimeout&&(window.setTimeout=_orig_windowSetTimeout),window._orig_windowSetInterval&&(window.setInterval=_orig_windowSetInterval),define("paddie-client/lib/undo-xpopup",function(){}),define("css!paddie-client/lib/pad2",[],function(){}),/*! jQuery UI - v1.9.2 - 2014-01-15
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.resizable.js, jquery.ui.effect.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-slide.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */
function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().andSelf().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.ui.version||(a.extend(a.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return"number"==typeof b?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));c.offsetHeight,a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=100===c.offsetHeight,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),function(){var b=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];a.ui.ie=!!b.length,a.ui.ie6=6===parseFloat(b[1],10)}(),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;e.length>d;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},contains:a.contains,hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},isOverAxis:function(a,b,c){return a>b&&b+c>a},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}}))}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(a){}e(b)},a.widget=function(c,d,e){var f,g,h,i,j=c.split(".")[0];c=c.split(".")[1],f=j+"-"+c,e||(e=d,d=a.Widget),a.expr[":"][f.toLowerCase()]=function(b){return!!a.data(b,f)},a[j]=a[j]||{},g=a[j][c],h=a[j][c]=function(a,c){return this._createWidget?(arguments.length&&this._createWidget(a,c),b):new h(a,c)},a.extend(h,g,{version:e.version,_proto:a.extend({},e),_childConstructors:[]}),i=new d,i.options=a.widget.extend({},i.options),a.each(e,function(b,c){a.isFunction(c)&&(e[b]=function(){var a=function(){return d.prototype[b].apply(this,arguments)},e=function(a){return d.prototype[b].apply(this,a)};return function(){var b,d=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=c.apply(this,arguments),this._super=d,this._superApply=f,b}}())}),h.prototype=a.widget.extend(i,{widgetEventPrefix:g?i.widgetEventPrefix:c},e,{constructor:h,namespace:j,widgetName:c,widgetBaseClass:f,widgetFullName:f}),g?(a.each(g._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,h,c._proto)}),delete g._childConstructors):d._childConstructors.push(h),a.widget.bridge(c,h)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):b):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetName,this),a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;e.length-1>g;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(c,d,e){var f,g=this;"boolean"!=typeof c&&(e=d,d=c,c=!1),e?(d=f=a(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,f=this.widget()),a.each(e,function(e,h){function i(){return c||g.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof h?g[h]:h).apply(g,arguments):b}"string"!=typeof h&&(i.guid=h.guid=h.guid||i.guid||a.guid++);var j=e.match(/^(\w+)\s*(.*)$/),k=j[1]+g.eventNamespace,l=j[2];l?f.delegate(l,k,i):d.bind(k,i)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&(a.effects.effect[h]||a.uiBackCompat!==!1&&a.effects[h])?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.uiBackCompat!==!1&&(a.Widget.prototype._getCreateOptions=function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]})}(jQuery),function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){return!a.ui.ie||document.documentMode>=9||b.button?this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted):this._mouseUp(b)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a){a.widget("ui.resizable",a.ui.mouse,{version:"1.9.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var b=this,c=this.options;if(this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!c.aspectRatio,aspectRatio:c.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:c.helper||c.ghost||c.animate?c.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=c.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var d=this.handles.split(",");this.handles={};for(var e=0;d.length>e;e++){var f=a.trim(d[e]),g="ui-resizable-"+f,h=a('<div class="ui-resizable-handle '+g+'"></div>');h.css({zIndex:c.zIndex}),"se"==f&&h.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[f]=".ui-resizable-"+f,this.element.append(h)}}this._renderAxis=function(b){b=b||this.element;for(var c in this.handles){if(this.handles[c].constructor==String&&(this.handles[c]=a(this.handles[c],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var d=a(this.handles[c],this.element),e=0;e=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth();var f=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join("");b.css(f,e),this._proportionallyResize()}a(this.handles[c]).length}},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!b.resizing){if(this.className)var a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=a&&a[1]?a[1]:"se"}}),c.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){c.disabled||(a(this).removeClass("ui-resizable-autohide"),b._handles.show())}).mouseleave(function(){c.disabled||b.resizing||(a(this).addClass("ui-resizable-autohide"),b._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var b=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){b(this.element);var c=this.element;this.originalElement.css({position:c.css("position"),width:c.outerWidth(),height:c.outerHeight(),top:c.css("top"),left:c.css("left")}).insertAfter(c),c.remove()}return this.originalElement.css("resize",this.originalResizeStyle),b(this.originalElement),this},_mouseCapture:function(b){var c=!1;for(var d in this.handles)a(this.handles[d])[0]==b.target&&(c=!0);return!this.options.disabled&&c},_mouseStart:function(c){var d=this.options,e=this.element.position(),f=this.element;this.resizing=!0,this.documentScroll={top:a(document).scrollTop(),left:a(document).scrollLeft()},(f.is(".ui-draggable")||/absolute/.test(f.css("position")))&&f.css({position:"absolute",top:e.top,left:e.left}),this._renderProxy();var g=b(this.helper.css("left")),h=b(this.helper.css("top"));d.containment&&(g+=a(d.containment).scrollLeft()||0,h+=a(d.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:g,top:h},this.size=this._helper?{width:f.outerWidth(),height:f.outerHeight()}:{width:f.width(),height:f.height()},this.originalSize=this._helper?{width:f.outerWidth(),height:f.outerHeight()}:{width:f.width(),height:f.height()},this.originalPosition={left:g,top:h},this.sizeDiff={width:f.outerWidth()-f.width(),height:f.outerHeight()-f.height()},this.originalMousePosition={left:c.pageX,top:c.pageY},this.aspectRatio="number"==typeof d.aspectRatio?d.aspectRatio:this.originalSize.width/this.originalSize.height||1;var i=a(".ui-resizable-"+this.axis).css("cursor");return a("body").css("cursor","auto"==i?this.axis+"-resize":i),f.addClass("ui-resizable-resizing"),this._propagate("start",c),!0},_mouseDrag:function(a){var b=this.helper,c=(this.options,this.originalMousePosition),d=this.axis,e=a.pageX-c.left||0,f=a.pageY-c.top||0,g=this._change[d];if(!g)return!1;var h=g.apply(this,[a,e,f]);return this._updateVirtualBoundaries(a.shiftKey),(this._aspectRatio||a.shiftKey)&&(h=this._updateRatio(h,a)),h=this._respectSize(h,a),this._propagate("resize",a),b.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(h),this._trigger("resize",a,this.ui()),!1},_mouseStop:function(b){this.resizing=!1;var c=this.options,d=this;if(this._helper){var e=this._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&a.ui.hasScroll(e[0],"left")?0:d.sizeDiff.height,h=f?0:d.sizeDiff.width,i={width:d.helper.width()-h,height:d.helper.height()-g},j=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null,k=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null;c.animate||this.element.css(a.extend(i,{top:k,left:j})),d.helper.height(d.size.height),d.helper.width(d.size.width),this._helper&&!c.animate&&this._proportionallyResize()}return a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(a){var b,d,e,f,g,h=this.options;g={minWidth:c(h.minWidth)?h.minWidth:0,maxWidth:c(h.maxWidth)?h.maxWidth:1/0,minHeight:c(h.minHeight)?h.minHeight:0,maxHeight:c(h.maxHeight)?h.maxHeight:1/0},(this._aspectRatio||a)&&(b=g.minHeight*this.aspectRatio,e=g.minWidth/this.aspectRatio,d=g.maxHeight*this.aspectRatio,f=g.maxWidth/this.aspectRatio,b>g.minWidth&&(g.minWidth=b),e>g.minHeight&&(g.minHeight=e),g.maxWidth>d&&(g.maxWidth=d),g.maxHeight>f&&(g.maxHeight=f)),this._vBoundaries=g},_updateCache:function(a){this.options,this.offset=this.helper.offset(),c(a.left)&&(this.position.left=a.left),c(a.top)&&(this.position.top=a.top),c(a.height)&&(this.size.height=a.height),c(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=(this.options,this.position),d=this.size,e=this.axis;return c(a.height)?a.width=a.height*this.aspectRatio:c(a.width)&&(a.height=a.width/this.aspectRatio),"sw"==e&&(a.left=b.left+(d.width-a.width),a.top=null),"nw"==e&&(a.top=b.top+(d.height-a.height),a.left=b.left+(d.width-a.width)),a},_respectSize:function(a,b){var d=(this.helper,this._vBoundaries),e=(this._aspectRatio||b.shiftKey,this.axis),f=c(a.width)&&d.maxWidth&&d.maxWidth<a.width,g=c(a.height)&&d.maxHeight&&d.maxHeight<a.height,h=c(a.width)&&d.minWidth&&d.minWidth>a.width,i=c(a.height)&&d.minHeight&&d.minHeight>a.height;h&&(a.width=d.minWidth),i&&(a.height=d.minHeight),f&&(a.width=d.maxWidth),g&&(a.height=d.maxHeight);var j=this.originalPosition.left+this.originalSize.width,k=this.position.top+this.size.height,l=/sw|nw|w/.test(e),m=/nw|ne|n/.test(e);h&&l&&(a.left=j-d.minWidth),f&&l&&(a.left=j-d.maxWidth),i&&m&&(a.top=k-d.minHeight),g&&m&&(a.top=k-d.maxHeight);var n=!a.width&&!a.height;return n&&!a.left&&a.top?a.top=null:n&&!a.top&&a.left&&(a.left=null),a},_proportionallyResize:function(){if(this.options,this._proportionallyResizeElements.length)for(var b=this.helper||this.element,c=0;this._proportionallyResizeElements.length>c;c++){var d=this._proportionallyResizeElements[c];if(!this.borderDif){var e=[d.css("borderTopWidth"),d.css("borderRightWidth"),d.css("borderBottomWidth"),d.css("borderLeftWidth")],f=[d.css("paddingTop"),d.css("paddingRight"),d.css("paddingBottom"),d.css("paddingLeft")];this.borderDif=a.map(e,function(a,b){var c=parseInt(a,10)||0,d=parseInt(f[b],10)||0;return c+d})}d.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=this.element,c=this.options;if(this.elementOffset=b.offset(),this._helper){this.helper=this.helper||a('<div style="overflow:hidden;"></div>');var d=a.ui.ie6?1:0,e=a.ui.ie6?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+e,height:this.element.outerHeight()+e,position:"absolute",left:this.elementOffset.left-d+"px",top:this.elementOffset.top-d+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=(this.options,this.originalSize),d=this.originalPosition;return{left:d.left+b,width:c.width-b}},n:function(a,b,c){var d=(this.options,this.originalSize),e=this.originalPosition;return{top:e.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),"resize"!=b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).data("resizable"),c=b.options,d=function(b){a(b).each(function(){var b=a(this);b.data("resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};"object"!=typeof c.alsoResize||c.alsoResize.parentNode?d(c.alsoResize):c.alsoResize.length?(c.alsoResize=c.alsoResize[0],d(c.alsoResize)):a.each(c.alsoResize,function(a){d(a)})},resize:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,d){a(b).each(function(){var b=a(this),e=a(this).data("resizable-alsoresize"),f={},g=d&&d.length?d:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,b){var c=(e[b]||0)+(h[b]||0);c&&c>=0&&(f[b]=c||null)}),b.css(f)})};"object"!=typeof e.alsoResize||e.alsoResize.nodeType?i(e.alsoResize):a.each(e.alsoResize,function(a,b){i(a,b)})},stop:function(){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).data("resizable"),d=c.options,e=c._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&a.ui.hasScroll(e[0],"left")?0:c.sizeDiff.height,h=f?0:c.sizeDiff.width,i={width:c.size.width-h,height:c.size.height-g},j=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,k=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};e&&e.length&&a(e[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var c=a(this).data("resizable"),d=c.options,e=c.element,f=d.containment,g=f instanceof a?f.get(0):/parent/.test(f)?e.parent().get(0):f;if(g)if(c.containerElement=a(g),/document/.test(f)||f==document)c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight};else{var h=a(g),i=[];a(["Top","Right","Left","Bottom"]).each(function(a,c){i[a]=b(h.css("padding"+c))}),c.containerOffset=h.offset(),c.containerPosition=h.position(),c.containerSize={height:h.innerHeight()-i[3],width:h.innerWidth()-i[1]};var j=c.containerOffset,k=c.containerSize.height,l=c.containerSize.width,m=a.ui.hasScroll(g,"left")?g.scrollWidth:l,n=a.ui.hasScroll(g)?g.scrollHeight:k;c.parentData={element:g,left:j.left,top:j.top,width:m,height:n}}},resize:function(b){var c=a(this).data("resizable"),d=c.options,e=(c.containerSize,c.containerOffset),f=(c.size,c.position),g=c._aspectRatio||b.shiftKey,h={top:0,left:0},i=c.containerElement;i[0]!=document&&/static/.test(i.css("position"))&&(h=e),f.left<(c._helper?e.left:0)&&(c.size.width=c.size.width+(c._helper?c.position.left-e.left:c.position.left-h.left),g&&(c.size.height=c.size.width/c.aspectRatio),c.position.left=d.helper?e.left:0),f.top<(c._helper?e.top:0)&&(c.size.height=c.size.height+(c._helper?c.position.top-e.top:c.position.top),g&&(c.size.width=c.size.height*c.aspectRatio),c.position.top=c._helper?e.top:0),c.offset.left=c.parentData.left+c.position.left,c.offset.top=c.parentData.top+c.position.top;var j=Math.abs((c._helper?c.offset.left-h.left:c.offset.left-h.left)+c.sizeDiff.width),k=Math.abs((c._helper?c.offset.top-h.top:c.offset.top-e.top)+c.sizeDiff.height),l=c.containerElement.get(0)==c.element.parent().get(0),m=/relative|absolute/.test(c.containerElement.css("position"));l&&m&&(j-=c.parentData.left),j+c.size.width>=c.parentData.width&&(c.size.width=c.parentData.width-j,g&&(c.size.height=c.size.width/c.aspectRatio)),k+c.size.height>=c.parentData.height&&(c.size.height=c.parentData.height-k,g&&(c.size.width=c.size.height*c.aspectRatio))},stop:function(){var b=a(this).data("resizable"),c=b.options,d=(b.position,b.containerOffset),e=b.containerPosition,f=b.containerElement,g=a(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,j=g.outerHeight()-b.sizeDiff.height;b._helper&&!c.animate&&/relative/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j}),b._helper&&!c.animate&&/static/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j})}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).data("resizable"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).data("resizable");b.options,b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).data("resizable");b.options,b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(b){var c=a(this).data("resizable"),d=c.options,e=c.size,f=c.originalSize,g=c.originalPosition,h=c.axis;d._aspectRatio||b.shiftKey,d.grid="number"==typeof d.grid?[d.grid,d.grid]:d.grid;var i=Math.round((e.width-f.width)/(d.grid[0]||1))*(d.grid[0]||1),j=Math.round((e.height-f.height)/(d.grid[1]||1))*(d.grid[1]||1);/^(se|s|e)$/.test(h)?(c.size.width=f.width+i,c.size.height=f.height+j):/^(ne)$/.test(h)?(c.size.width=f.width+i,c.size.height=f.height+j,c.position.top=g.top-j):/^(sw)$/.test(h)?(c.size.width=f.width+i,c.size.height=f.height+j,c.position.left=g.left-i):(c.size.width=f.width+i,c.size.height=f.height+j,c.position.top=g.top-j,c.position.left=g.left-i)}});var b=function(a){return parseInt(a,10)||0},c=function(a){return!isNaN(parseInt(a,10))}}(jQuery),jQuery.effects||function(a,b){var c=a.uiBackCompat!==!1,d="ui-effects-";a.effects={effect:{}},function(b,c){function d(a,b,c){var d=m[b.type]||{};return null==a?c||!b.def?null:b.def:(a=d.floor?~~a:parseFloat(a),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:a>d.max?d.max:a)}function e(a){var d=k(),e=d._rgba=[];return a=a.toLowerCase(),p(j,function(b,f){var g,h=f.re.exec(a),i=h&&f.parse(h),j=f.space||"rgba";return i?(g=d[j](i),d[l[j].cache]=g[l[j].cache],e=d._rgba=g._rgba,!1):c}),e.length?("0,0,0,0"===e.join()&&b.extend(e,g.transparent),d):g[a]}function f(a,b,c){return c=(c+1)%1,1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}var g,h="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),i=/^([\-+])=\s*(\d+\.?\d*)/,j=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)];
}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],k=b.Color=function(a,c,d,e){return new b.Color.fn.parse(a,c,d,e)},l={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},m={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},n=k.support={},o=b("<p>")[0],p=b.each;o.style.cssText="background-color:rgba(1,1,1,.5)",n.rgba=o.style.backgroundColor.indexOf("rgba")>-1,p(l,function(a,b){b.cache="_"+a,b.props.alpha={idx:3,type:"percent",def:1}}),k.fn=b.extend(k.prototype,{parse:function(f,h,i,j){if(f===c)return this._rgba=[null,null,null,null],this;(f.jquery||f.nodeType)&&(f=b(f).css(h),h=c);var m=this,n=b.type(f),o=this._rgba=[];return h!==c&&(f=[f,h,i,j],n="array"),"string"===n?this.parse(e(f)||g._default):"array"===n?(p(l.rgba.props,function(a,b){o[b.idx]=d(f[b.idx],b)}),this):"object"===n?(f instanceof k?p(l,function(a,b){f[b.cache]&&(m[b.cache]=f[b.cache].slice())}):p(l,function(b,c){var e=c.cache;p(c.props,function(a,b){if(!m[e]&&c.to){if("alpha"===a||null==f[a])return;m[e]=c.to(m._rgba)}m[e][b.idx]=d(f[a],b,!0)}),m[e]&&0>a.inArray(null,m[e].slice(0,3))&&(m[e][3]=1,c.from&&(m._rgba=c.from(m[e])))}),this):c},is:function(a){var b=k(a),d=!0,e=this;return p(l,function(a,f){var g,h=b[f.cache];return h&&(g=e[f.cache]||f.to&&f.to(e._rgba)||[],p(f.props,function(a,b){return null!=h[b.idx]?d=h[b.idx]===g[b.idx]:c})),d}),d},_space:function(){var a=[],b=this;return p(l,function(c,d){b[d.cache]&&a.push(c)}),a.pop()},transition:function(a,b){var c=k(a),e=c._space(),f=l[e],g=0===this.alpha()?k("transparent"):this,h=g[f.cache]||f.to(g._rgba),i=h.slice();return c=c[f.cache],p(f.props,function(a,e){var f=e.idx,g=h[f],j=c[f],k=m[e.type]||{};null!==j&&(null===g?i[f]=j:(k.mod&&(j-g>k.mod/2?g+=k.mod:g-j>k.mod/2&&(g-=k.mod)),i[f]=d((j-g)*b+g,e)))}),this[e](i)},blend:function(a){if(1===this._rgba[3])return this;var c=this._rgba.slice(),d=c.pop(),e=k(a)._rgba;return k(b.map(c,function(a,b){return(1-d)*e[b]+d*a}))},toRgbaString:function(){var a="rgba(",c=b.map(this._rgba,function(a,b){return null==a?b>2?1:0:a});return 1===c[3]&&(c.pop(),a="rgb("),a+c.join()+")"},toHslaString:function(){var a="hsla(",c=b.map(this.hsla(),function(a,b){return null==a&&(a=b>2?1:0),b&&3>b&&(a=Math.round(100*a)+"%"),a});return 1===c[3]&&(c.pop(),a="hsl("),a+c.join()+")"},toHexString:function(a){var c=this._rgba.slice(),d=c.pop();return a&&c.push(~~(255*d)),"#"+b.map(c,function(a){return a=(a||0).toString(16),1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),k.fn.parse.prototype=k.fn,l.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b,c,d=a[0]/255,e=a[1]/255,f=a[2]/255,g=a[3],h=Math.max(d,e,f),i=Math.min(d,e,f),j=h-i,k=h+i,l=.5*k;return b=i===h?0:d===h?60*(e-f)/j+360:e===h?60*(f-d)/j+120:60*(d-e)/j+240,c=0===l||1===l?l:.5>=l?j/k:j/(2-k),[Math.round(b)%360,c,l,null==g?1:g]},l.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],e=a[3],g=.5>=d?d*(1+c):d+c-d*c,h=2*d-g;return[Math.round(255*f(h,g,b+1/3)),Math.round(255*f(h,g,b)),Math.round(255*f(h,g,b-1/3)),e]},p(l,function(a,e){var f=e.props,g=e.cache,h=e.to,j=e.from;k.fn[a]=function(a){if(h&&!this[g]&&(this[g]=h(this._rgba)),a===c)return this[g].slice();var e,i=b.type(a),l="array"===i||"object"===i?a:arguments,m=this[g].slice();return p(f,function(a,b){var c=l["object"===i?a:b.idx];null==c&&(c=m[b.idx]),m[b.idx]=d(c,b)}),j?(e=k(j(m)),e[g]=m,e):k(m)},p(f,function(c,d){k.fn[c]||(k.fn[c]=function(e){var f,g=b.type(e),h="alpha"===c?this._hsla?"hsla":"rgba":a,j=this[h](),k=j[d.idx];return"undefined"===g?k:("function"===g&&(e=e.call(this,k),g=b.type(e)),null==e&&d.empty?this:("string"===g&&(f=i.exec(e),f&&(e=k+parseFloat(f[2])*("+"===f[1]?1:-1))),j[d.idx]=e,this[h](j)))})})}),p(h,function(a,c){b.cssHooks[c]={set:function(a,d){var f,g,h="";if("string"!==b.type(d)||(f=e(d))){if(d=k(f||d),!n.rgba&&1!==d._rgba[3]){for(g="backgroundColor"===c?a.parentNode:a;(""===h||"transparent"===h)&&g&&g.style;)try{h=b.css(g,"backgroundColor"),g=g.parentNode}catch(a){}d=d.blend(h&&"transparent"!==h?h:"_default")}d=d.toRgbaString()}try{a.style[c]=d}catch(a){}}},b.fx.step[c]=function(a){a.colorInit||(a.start=k(a.elem,c),a.end=k(a.end),a.colorInit=!0),b.cssHooks[c].set(a.elem,a.start.transition(a.end,a.pos))}}),b.cssHooks.borderColor={expand:function(a){var b={};return p(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a}),b}},g=b.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function c(){var b,c,d=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,e={};if(d&&d.length&&d[0]&&d[d[0]])for(c=d.length;c--;)b=d[c],"string"==typeof d[b]&&(e[a.camelCase(b)]=d[b]);else for(b in d)"string"==typeof d[b]&&(e[b]=d[b]);return e}function d(b,c){var d,e,g={};for(d in c)e=c[d],b[d]!==e&&(f[d]||(a.fx.step[d]||!isNaN(parseFloat(e)))&&(g[d]=e));return g}var e=["add","remove","toggle"],f={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,c){a.fx.step[c]=function(a){("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)&&(jQuery.style(a.elem,c,a.end),a.setAttr=!0)}}),a.effects.animateClass=function(b,f,g,h){var i=a.speed(f,g,h);return this.queue(function(){var f,g=a(this),h=g.attr("class")||"",j=i.children?g.find("*").andSelf():g;j=j.map(function(){var b=a(this);return{el:b,start:c.call(this)}}),f=function(){a.each(e,function(a,c){b[c]&&g[c+"Class"](b[c])})},f(),j=j.map(function(){return this.end=c.call(this.el[0]),this.diff=d(this.start,this.end),this}),g.attr("class",h),j=j.map(function(){var b=this,c=a.Deferred(),d=jQuery.extend({},i,{queue:!1,complete:function(){c.resolve(b)}});return this.el.animate(this.diff,d),c.promise()}),a.when.apply(a,j.get()).done(function(){f(),a.each(arguments,function(){var b=this.el;a.each(this.diff,function(a){b.css(a,"")})}),i.complete.call(g[0])})})},a.fn.extend({_addClass:a.fn.addClass,addClass:function(b,c,d,e){return c?a.effects.animateClass.call(this,{add:b},c,d,e):this._addClass(b)},_removeClass:a.fn.removeClass,removeClass:function(b,c,d,e){return c?a.effects.animateClass.call(this,{remove:b},c,d,e):this._removeClass(b)},_toggleClass:a.fn.toggleClass,toggleClass:function(c,d,e,f,g){return"boolean"==typeof d||d===b?e?a.effects.animateClass.call(this,d?{add:c}:{remove:c},e,f,g):this._toggleClass(c,d):a.effects.animateClass.call(this,{toggle:c},d,e,f)},switchClass:function(b,c,d,e,f){return a.effects.animateClass.call(this,{add:c,remove:b},d,e,f)}})}(),function(){function e(b,c,d,e){return a.isPlainObject(b)&&(c=b,b=b.effect),b={effect:b},null==c&&(c={}),a.isFunction(c)&&(e=c,d=null,c={}),("number"==typeof c||a.fx.speeds[c])&&(e=d,d=c,c={}),a.isFunction(d)&&(e=d,d=null),c&&a.extend(b,c),d=d||c.duration,b.duration=a.fx.off?0:"number"==typeof d?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,b.complete=e||c.complete,b}function f(b){return!b||"number"==typeof b||a.fx.speeds[b]?!0:"string"!=typeof b||a.effects.effect[b]?!1:!c||!a.effects[b]}a.extend(a.effects,{version:"1.9.2",save:function(a,b){for(var c=0;b.length>c;c++)null!==b[c]&&a.data(d+b[c],a[0].style[b[c]])},restore:function(a,c){var e,f;for(f=0;c.length>f;f++)null!==c[f]&&(e=a.data(d+c[f]),e===b&&(e=""),a.css(c[f],e))},setMode:function(a,b){return"toggle"===b&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),float:b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:b.width(),height:b.height()},f=document.activeElement;try{f.id}catch(a){f=document.body}return b.wrap(d),(b[0]===f||a.contains(b[0],f))&&a(f).focus(),d=b.parent(),"static"===b.css("position")?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(e),d.css(c).show()},removeWrapper:function(b){var c=document.activeElement;return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===c||a.contains(b[0],c))&&a(c).focus()),b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);f[0]>0&&(e[c]=f[0]*d+f[1])}),e}}),a.fn.extend({effect:function(){function b(b){function c(){a.isFunction(f)&&f.call(e[0]),a.isFunction(b)&&b()}var e=a(this),f=d.complete,g=d.mode;(e.is(":hidden")?"hide"===g:"show"===g)?c():h.call(e[0],d,c)}var d=e.apply(this,arguments),f=d.mode,g=d.queue,h=a.effects.effect[d.effect],i=!h&&c&&a.effects[d.effect];return a.fx.off||!h&&!i?f?this[f](d.duration,d.complete):this.each(function(){d.complete&&d.complete.call(this)}):h?g===!1?this.each(b):this.queue(g||"fx",b):i.call(this,{options:d,duration:d.duration,callback:d.complete,mode:d.mode})},_show:a.fn.show,show:function(a){if(f(a))return this._show.apply(this,arguments);var b=e.apply(this,arguments);return b.mode="show",this.effect.call(this,b)},_hide:a.fn.hide,hide:function(a){if(f(a))return this._hide.apply(this,arguments);var b=e.apply(this,arguments);return b.mode="hide",this.effect.call(this,b)},__toggle:a.fn.toggle,toggle:function(b){if(f(b)||"boolean"==typeof b||a.isFunction(b))return this.__toggle.apply(this,arguments);var c=e.apply(this,arguments);return c.mode="toggle",this.effect.call(this,c)},cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}})}(),function(){var b={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,c){b[c]=function(b){return Math.pow(b,a+2)}}),a.extend(b,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;((b=Math.pow(2,--c))-1)/11>a;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}}),a.each(b,function(b,c){a.easing["easeIn"+b]=c,a.easing["easeOut"+b]=function(a){return 1-c(1-a)},a.easing["easeInOut"+b]=function(a){return.5>a?c(2*a)/2:1-c(-2*a+2)/2}})}()}(jQuery),function(a){a.effects.effect.pulsate=function(b,c){var d,e=a(this),f=a.effects.setMode(e,b.mode||"show"),g="show"===f,h="hide"===f,i=g||"hide"===f,j=2*(b.times||5)+(i?1:0),k=b.duration/j,l=0,m=e.queue(),n=m.length;for((g||!e.is(":visible"))&&(e.css("opacity",0).show(),l=1),d=1;j>d;d++)e.animate({opacity:l},k,b.easing),l=1-l;e.animate({opacity:l},k,b.easing),e.queue(function(){h&&e.hide(),c()}),n>1&&m.splice.apply(m,[1,0].concat(m.splice(n,j+1))),e.dequeue()}}(jQuery),function(a){a.effects.effect.slide=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","width","height"],g=a.effects.setMode(e,b.mode||"show"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i,l={};a.effects.save(e,f),e.show(),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0),a.effects.createWrapper(e).css({overflow:"hidden"}),h&&e.css(j,k?isNaN(d)?"-"+d:-d:d),l[j]=(h?k?"+=":"-=":k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})}}(jQuery),define("paddie-client/lib/jquery-ui",function(){}),define("paddie-client/lib/pad2",["require","jquery","paddie-client/lib/chat","paddie-client/lib/collab_client","paddie-client/lib/pad_connectionstatus","paddie-client/lib/pad_cookie","paddie-client/lib/pad_docbar","paddie-client/lib/pad_editbar","paddie-client/lib/pad_editor","paddie-client/lib/pad_impexp","paddie-client/lib/pad_modals","paddie-client/lib/pad_savedrevs","paddie-client/lib/pad_userlist","paddie-client/lib/pad_utils","core/lib/uri_helper","core/lib/tr","common-ui/lib/helper/environment","backbone","paddie-client/lib/excanvas","paddie-client/lib/farbtastic","paddie-client/lib/undo-xpopup","socket.io","css!./pad2","paddie-client/lib/jquery-ui"],function(a){function b(a,b,c,d){if(c)var e=new Date(Date.now()+24*c*60*60*1e3),f="; expires="+e.toGMTString();else var f="";d||(d="/"),document.cookie=a+"="+b+f+"; path="+d}function c(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null}function d(){var a=e().showControls,b="false",c=e().userName,d="false",f="false";a&&"false"==a&&(g("#editbar").hide(),g("#editorcontainer").css({top:"0px"})),b&&"false"==b&&g("#chaticon").hide(),d&&"false"==d&&(x=!0),f&&"true"==f&&(y=!0),c&&(z=c)}function e(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b}function f(a){function b(a,b){var d=B.getYammerConfig(),e=document.location.pathname.substring(document.location.pathname.lastIndexOf("/")+1);d.padId&&(e=d.padId),e=unescape(e),token=window.yam?B.yammerUser.id+"":void 0;var f=c("sessionID"),g=c("password"),h=window.yam?B.yammerUser.id+"":void 0,i=window.yam?B.yammerUser.web_oauth_access_token+"":void 0,j={component:"pad",type:"CLIENT_READY",padId:e,last_published_rev:d.lastPublishedRevision,sessionID:f,password:g,token:token,user_id:h,authtoken:i,pageIsActive:d.pageIsActive||!1,protocolVersion:2};B.socket.json.send(j)}var d=B.getYammerConfig(),e=document.location;d.paddieURL&&(e=t.parse(d.paddieURL),e.hostname=e.host,e.pathname=e.path,e.protocol.indexOf(":")<0&&(e.protocol+=":"));var f=80==e.port?"":e.port,h=e.protocol+"//"+e.hostname+":"+f+"/",i=e.pathname.substr(1,e.pathname.indexOf("/p/"))+"socket.io",k=io.connect(h,{resource:i,"defer connection":!1,"reconnection delay":1e3,"max reconnection attempts":6,"force new connection":!!a});B.socket=k,k.once("connect",function(){b(!1)});var l=!1,m=!1,n=!1;k.on("reconnect",function(){B.collabClient.setChannelState("CONNECTED"),b(!0)}),k.on("reconnecting",function(a,b){b>=this.socket.options["max reconnection attempts"]&&B.collabClient.setChannelState("DISCONNECTED","reconnect_timeout")}),k.on("disconnect",function(a){delete B.socket,k=null,B.collabClient&&("booted"==a&&B.collabClient.setChannelState("DISCONNECTED"),A||B.collabClient.setChannelState("RECONNECTING"))}),k.on("message",function(a){if(!n)if(!l&&a.accessStatus)"deny"==a.accessStatus&&(n=!0,g("#editorloadingbox").html("<b>"+u.t("you_do_not_have_access_to_this_note")+"</b>"),g(".yj-current-collaborators .yj-spinner").hide(),B.collabClient.setChannelState("DISCONNECTED","deny")),"padFull"==a.accessStatus?(n=!0,g("#editorloadingbox").html("<b>"+u.t("note_has_reached_its_maximum_number_of_editors")+"</b>"),g(".yj-current-collaborators .yj-spinner").hide(),B.collabClient.setChannelState("DISCONNECTED","padFull")):"needPassword"==a.accessStatus?g("#editorloadingbox").html("<b>"+u.t("you_need_a_password_to_access_this_note")+"</b><br><input id='passwordinput' type='password' name='password'><button type='button' onclick='savePassword()'>ok</button>"):"wrongPassword"==a.accessStatus&&g("#editorloadingbox").html("<b>"+u.t("your_password_to_access_this_note_was_wrong")+"</b><br><input id='passwordinput' type='password' name='password'><button type='button' onclick='savePassword()'>ok</button>");else if(l){if(a.disconnect)return console&&console.log&&console.log(a.disconnect),j.disconnected(a.disconnect),void B.collabClient.setChannelState("DISCONNECTED","reset_by_server");B.collabClient.handleMessageFromServer(a)}else l=!0,B.clientVars=a,a.userAgent="Anonymous",a.collab_client_vars.clientAgent="Anonymous",B.init(),w.trigger("/ui/pages/padInit",a),m=!0,1==x&&B.changeViewOption("showLineNumbers",!1),1==y&&B.changeViewOption("useMonospaceFont",!0),z!==!1&&(B.notifyChangeName(z),B.myUserInfo.name=z,g("#myusernameedit").attr({value:z}))})}var g=a("jquery"),h=a("paddie-client/lib/chat"),i=a("paddie-client/lib/collab_client"),j=a("paddie-client/lib/pad_connectionstatus"),k=a("paddie-client/lib/pad_cookie"),l=a("paddie-client/lib/pad_docbar"),m=a("paddie-client/lib/pad_editbar"),n=a("paddie-client/lib/pad_editor"),o=a("paddie-client/lib/pad_impexp"),p=a("paddie-client/lib/pad_modals"),q=a("paddie-client/lib/pad_savedrevs"),r=a("paddie-client/lib/pad_userlist"),s=a("paddie-client/lib/pad_utils"),t=a("core/lib/uri_helper"),u=a("core/lib/tr"),v=a("common-ui/lib/helper/environment"),w=a("backbone");a("paddie-client/lib/excanvas"),a("paddie-client/lib/farbtastic"),a("paddie-client/lib/undo-xpopup"),a("socket.io"),a("css!./pad2"),a("paddie-client/lib/jquery-ui");/**
 * Copyright 2009 Google Inc., 2011 Peter 'Pita' Martischka (Primary Technology Ltd)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS-IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var x=!1,y=!1,z=!1,A=!1;g(document).ready(function(){"function"==typeof customStart&&customStart(),d()}),g(window).bind("beforeunload",function(){A=!0}),g(window).unload(function(){B.dispose()});var B={collabClient:null,myUserInfo:null,diagnosticInfo:{},initTime:0,clientTimeOffset:null,preloadedImages:!1,padOptions:{},connect:function(a,b,c){B.yammerUser=a,B.getYammerConfig=b,f(c)},getClientVars:function(){return B.clientVars},getPadId:function(){return B.clientVars.padId},getClientIp:function(){return B.clientVars.clientIp},getIsProPad:function(){return B.clientVars.isProPad},getColorPalette:function(){return B.clientVars.colorPalette},getDisplayUserAgent:function(){return s.uaDisplay(B.clientVars.userAgent)},getIsDebugEnabled:function(){return B.clientVars.debugEnabled},getIsHighlightingEnabled:function(a){return a==B.myUserInfo.userId?B.myUserInfo.showHighlighting:!0},getPrivilege:function(a){return B.clientVars.accountPrivs[a]},getUserIsGuest:function(){return B.clientVars.userIsGuest},getUserId:function(){return B.myUserInfo.userId},getUserName:function(){return B.myUserInfo.name},sendClientMessage:function(a){B.collabClient.sendClientMessage(a)},init:function(){function a(){w.trigger("/ui/pages/postAceInit"),m.init();var a=g(document.activeElement);a.is("input:text, textarea")||setTimeout(function(){n.ace.focus()},0)}var b=B.clientVars;if(B.clientTimeOffset=Date.now()-b.serverTimestamp,h.init(),B.initTime=Date.now(),B.padOptions=b.initialOptions,v.isOlderIE()||g.browser.mozilla&&0==g.browser.version.indexOf("1.8.")||(document.domain=document.domain),v.isOlderIE())try{doc.execCommand("BackgroundImageCache",!1,!0)}catch(a){}k.init(b.cookiePrefsToSet),g("#widthprefcheck").click(B.toggleWidthPref),g("#sidebarcheck").click(B.toggleSidebar),B.myUserInfo={userId:b.userId,name:b.userName,ip:B.getClientIp(),colorId:b.userColor,userAgent:B.getDisplayUserAgent(),showHighlighting:b.showHighlighting},b.specialKey&&(B.myUserInfo.specialKey=b.specialKey,b.specialKeyTranslation&&g("#specialkeyarea").html("mode: "+String(b.specialKeyTranslation).toUpperCase())),l.init({isTitleEditable:B.getIsProPad(),initialTitle:b.initialTitle,initialPassword:b.initialPassword,guestPolicy:B.padOptions.guestPolicy}),o.init(),q.init(b.initialRevisionList),n.init(a,B.padOptions.view||{}),j.init(),p.init(),B.collabClient=i(n.ace,b.collab_client_vars,B.myUserInfo,{colorPalette:B.getColorPalette()}),B.collabClient.setOnUserJoin(B.handleUserJoin),B.collabClient.setOnUpdateUserInfo(B.handleUserUpdate),B.collabClient.setOnUserLeave(B.handleUserLeave),B.collabClient.setOnPadPublish(B.handlePadPublish),B.collabClient.setOnClientMessage(B.handleClientMessage),B.collabClient.setOnServerMessage(B.handleServerMessage),B.collabClient.setOnChannelStateChange(B.handleChannelStateChange),B.collabClient.setOnInternalAction(B.handleCollabAction),w.trigger("/ui/pages/currentUserReady",B.myUserInfo),w.trigger("/ui/pages/newRevision",b.collab_client_vars.rev||0)},dispose:function(){n.dispose()},notifyChangeName:function(a){B.myUserInfo.name=a,B.collabClient.updateUserInfo(B.myUserInfo)},notifyChangeColor:function(a){B.myUserInfo.colorId=a,B.collabClient.updateUserInfo(B.myUserInfo)},notifyChangeHighlighting:function(a){B.myUserInfo.showHighlighting=a,B.collabClient.updateUserInfo(B.myUserInfo)},notifyChangeTitle:function(a){B.collabClient.sendClientMessage({type:"padtitle",title:a,changedBy:B.myUserInfo.name})},notifyChangePassword:function(a){B.collabClient.sendClientMessage({type:"padpassword",password:a,changedBy:B.myUserInfo.name})},changePadOption:function(a,b){var c={};c[a]=b,B.handleOptionsChange(c),B.collabClient.sendClientMessage({type:"padoptions",options:c,changedBy:B.myUserInfo.name})},changeViewOption:function(a,b){var c={view:{}};c.view[a]=b,B.handleOptionsChange(c),"showLineNumbers"!=a&&"useMonospaceFont"!=a&&B.collabClient.sendClientMessage({type:"padoptions",options:c,changedBy:B.myUserInfo.name})},handleOptionsChange:function(a){if(a.view){B.padOptions.view||(B.padOptions.view={});for(var b in a.view)B.padOptions.view[b]=a.view[b];n.setViewOptions(B.padOptions.view)}a.guestPolicy&&(B.padOptions.guestPolicy=a.guestPolicy,l.setGuestPolicy(a.guestPolicy))},getPadOptions:function(){return B.padOptions},isPadPublic:function(){return!B.getIsProPad()||"allow"==B.getPadOptions().guestPolicy},suggestUserName:function(a,b){B.collabClient.sendClientMessage({type:"suggestUserName",unnamedId:a,newName:b})},handleUserJoin:function(a){-1!==a.userId.indexOf(".")&&b("token","",0),w.trigger("/ui/pages/addOrUpdateUser",a),r.userJoinOrUpdate(a)},handleUserUpdate:function(a){-1!==a.userId.indexOf(".")&&b("token","",0),w.trigger("/ui/pages/addOrUpdateUser",a),r.userJoinOrUpdate(a)},handleUserLeave:function(a){-1!==a.userId.indexOf(".")&&b("token","",0),w.trigger("/ui/pages/removeUser",a),r.userLeave(a)},handlePadPublish:function(a,b){b=b||{},w.trigger("/ui/pages/published",a,b.userId,b.name)},handleClientMessage:function(a){if("suggestUserName"==a.type)a.unnamedId==B.myUserInfo.userId&&a.newName&&!B.myUserInfo.name&&(B.notifyChangeName(a.newName),r.setMyUserInfo(B.myUserInfo));else if("chat"==a.type);else if("padtitle"==a.type)w.trigger("/ui/pages/titleChange",a.title),l.changeTitle(a.title);else if("padpassword"==a.type)l.changePassword(a.password);else if("newRevisionList"==a.type)q.newRevisionList(a.revisionList);else if("revisionLabel"==a.type)q.newRevisionList(a.revisionList);else if("padoptions"==a.type){var b=a.options;B.handleOptionsChange(b)}else"guestanswer"==a.type&&r.removeGuestPrompt(a.guestId)},editbarClick:function(a){m&&m.toolbarClick(a)},editbarFormatChange:function(a){if(m&&a){var b=a.options[a.selectedIndex];b=b?b.value:"",m.formatChange(b)}},dmesg:function(a){if(B.getIsDebugEnabled()){var b=g("#djs").get(0),c=b.scrollTop-(b.scrollHeight-g(b).height())>=-20;g("#djs").append("<p>"+a+"</p>"),c&&(b.scrollTop=b.scrollHeight)}},handleServerMessage:function(a){"NOTICE"==a.type?(a.text&&C.displayMessage(function(b){b.find("#servermsgdate").html(" ("+s.simpleDateTime(new Date)+")"),b.find("#servermsgtext").html(a.text)}),a.js&&window.eval(a.js)):"GUEST_PROMPT"==a.type&&r.showGuestPrompt(a.userId,a.displayName)},handleChannelStateChange:function(a,b){var c=!!j.isFullyConnected(),d="connecting"==j.getStatus().what;if(B.socket){"CONNECTED"==a?j.connected():"RECONNECTING"==a?j.reconnecting():"DISCONNECTED"!=a||A||(B.diagnosticInfo.disconnectedMessage=b,B.diagnosticInfo.padId=B.getPadId(),B.diagnosticInfo.sessionId=B.socket.socket.sessionid,B.diagnosticInfo.userId=B.myUserInfo.userId,B.asyncSendDiagnosticInfo(),"string"==typeof window.ajlog&&(window.ajlog+="Disconnected: "+b+"\n"),n.disable(),m.disable(),l.disable(),o.disable(),j.disconnected(b));var e=!!j.isFullyConnected();e!=c&&B.handleIsFullyConnected(e,d)}},handleIsFullyConnected:function(a,b){a&&!B.preloadedImages&&window.setTimeout(function(){B.preloadedImages||(B.preloadImages(),B.preloadedImages=!0)},1e3),q.handleIsFullyConnected(a),B.determineSidebarVisibility(a&&!b)},determineSidebarVisibility:function(a){if(B.isFullyConnected()){var b=s.getCancellableAction("set-sidebar-visibility",function(){g("body").toggleClass("hidesidebar",!!k.getPref("hideSidebar"))});window.setTimeout(b,a?3e3:0)}else s.cancelActions("set-sidebar-visibility"),g("body").removeClass("hidesidebar")},handleCollabAction:function(a){"commitPerformed"==a?(m.setSyncStatus("syncing"),w.trigger("/ui/pages/activity","committing")):"newlyIdle"==a?m.setSyncStatus("done"):"commitAcceptedByServer"==a&&w.trigger("/ui/pages/activity","commit_accepted")},hideServerMessage:function(){C.hideMessage()},asyncSendDiagnosticInfo:function(){var a=B.getYammerConfig(),b="ep/pad/connection-diagnostic-info";a.paddieURL&&(b=a.paddieURL+b,window.setTimeout(function(){g.ajax({dataType:"jsonp",url:b,data:B.diagnosticInfo,success:function(){},error:function(){}})},0))},forceReconnect:function(){g("form#reconnectform input.padId").val(B.getPadId()),B.diagnosticInfo.collabDiagnosticInfo=B.collabClient.getDiagnosticInfo(),g("form#reconnectform input.diagnosticInfo").val(JSON.stringify(B.diagnosticInfo)),g("form#reconnectform input.missedChanges").val(JSON.stringify(B.collabClient.getMissedChanges())),g("form#reconnectform").submit()},toggleWidthPref:function(){var a=!k.getPref("fullWidth");k.setPref("fullWidth",a),g("#widthprefcheck").toggleClass("widthprefchecked",!!a).toggleClass("widthprefunchecked",!a),B.handleWidthChange()},toggleSidebar:function(){var a=!k.getPref("hideSidebar");k.setPref("hideSidebar",a),g("#sidebarcheck").toggleClass("sidebarchecked",!a).toggleClass("sidebarunchecked",!!a),B.determineSidebarVisibility()},handleWidthChange:function(){var a=k.getPref("fullWidth");if(a)g("body").addClass("fullwidth").removeClass("limwidth").removeClass("squish1width").removeClass("squish2width");else{g("body").addClass("limwidth").removeClass("fullwidth");var b=g(window).width();g("body").toggleClass("squish1width",912>b&&b>812).toggleClass("squish2width",812>=b)}},handleImportExportFrameCall:function(a,b){o.handleFrameCall.call(o,a,Array.prototype.slice.call(arguments,1))},callWhenNotCommitting:function(a){B.collabClient.callWhenNotCommitting(a)},getCollabRevisionNumber:function(){return B.collabClient.getCurrentRevisionNumber()},isFullyConnected:function(){return j.isFullyConnected()},addHistoricalAuthors:function(a){B.collabClient?B.collabClient.addHistoricalAuthors(a):window.setTimeout(function(){B.addHistoricalAuthors(a)},1e3)},preloadImages:function(){function a(){if(0!=c.length){var a=new Image;a.src=c.shift(),a.complete?b():g(a).bind("error load onreadystatechange",b)}}function b(){window.setTimeout(a,0)}var c=[];b()}},C=function(){function a(a){-1==a?g("#alertbar").css("opacity",0).css("display","block"):0==a?g("#alertbar").css("opacity",1):1==a?g("#alertbar").css("opacity",0).css("display","none"):0>a?g("#alertbar").css("opacity",a+1):a>0&&g("#alertbar").css("opacity",1-a)}var b=s.makeShowHideAnimator(a,!1,25,400),c={displayMessage:function(a){b.show(),a(g("#alertbar"))},hideMessage:function(){b.hide()}};return c}();return window.pad=B,B}),define("stache!common-ui/lib/ui/shared/add_member_type_ahead",["mustache"],function(a){var b='<label><span class="yj-acc-hidden">{{labelText}}</span><input type="text" class="yj-invite-members-field yj-inactive" /></label><div class="yj-ta-spinner"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/shared/add_member_type_ahead_table",["mustache"],function(a){var b='<tr>\n  <td class="picture">\n    <a title="{{link_title}}" class="yj-ava-small-container" href="{{web_url}}"><img src="{{mugshot_url}}" alt=""></a>\n  </td>\n  <td class="identity">\n    <span title="offline" class="yamicon yamicon-chat-here yj-status-gray yamicon-xy-small"></span>\n    <a title="{{link_title}}" class="primary" href="{{web_url}}">{{full_name}}</a>\n    <p class="job-title">{{job_title}}</p>\n  </td>\n  <td class="actions">\n  </td>\n</tr>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!common-ui/lib/ui/shared/add_member_type_ahead_new_member",["mustache"],function(a){var b='<li class="yj-user">\n  <a href="{{web_url}}" class="yj-user-link" title="offline">\n    <span class="yj-status yj-offline">offline</span>{{full_name}}</a>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("common-ui/lib/ui/shared/add_member_type_ahead",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/session","core/lib/tr","common-ui/lib/ui/shared/type_ahead","core/lib/yammer_api","core/lib/yammer_uri","collections/groups","core/lib/urls","models/network","html!./add_member_type_ahead","html!./add_member_type_ahead_table","html!./add_member_type_ahead_new_member"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("backbone"),g=a("core/lib/session"),h=a("core/lib/tr"),i=a("common-ui/lib/ui/shared/type_ahead"),j=a("core/lib/yammer_api"),k=a("core/lib/yammer_uri"),l=a("collections/groups"),m=a("core/lib/urls");a("models/network");var n=a("html!./add_member_type_ahead"),o=a("html!./add_member_type_ahead_table"),p=a("html!./add_member_type_ahead_new_member");return d.extend({mixins:[e],tagName:"div",template:n,tableTemplate:o,newMemberTemplate:p,defaults:{id:"addMemberTypeAhead",target:".yj-invite-members-module",watermarkText:"Add members by name or email...",watermarkIcon:k.cdn("assets/images/icons/add-icon.png"),showWatermarkIcon:!0,typeaheadType:"add-member",isCompanyGroup:!1,models:[],includeEmails:!1,excludeEmails:!1},initialize:function(a){a=c.extend({},this.defaults,a),c.bindAll(this,"handleAddInviteSuccess","handleAddInviteError"),this.id=a.id,this.target=a.target,this.watermarkText=a.watermarkText,this.watermarkIcon=a.watermarkIcon,this.showWatermarkIcon=a.showWatermarkIcon,this.typeaheadType=a.typeaheadType,this.isCompanyGroup=a.isCompanyGroup,this.models=a.models,this.includeEmails=a.includeEmails,this.excludeEmails=a.excludeEmails,this.inviteSection=a.inviteSection},events:{".yj-invite-members-field focus":"_handleInviteFieldFocus",".yj-invite-members-field blue":"_handleInviteFieldBlur"},getTemplateData:function(){return{labelText:this.watermarkText}},render:function(){this.$target=b(this.target),this.$inviteSpinner=this.$el.find(".yj-ta-spinner"),this.$inviteField=this.$el.find(".yj-invite-members-field");var a={completableModels:this.emailsOnly?[i.MODEL_DOMAIN]:[i.MODEL_USER,i.MODEL_DOMAIN],triggerStrings:{},includeEmails:this.includeEmails,maxResults:6,onSelect:this.handleRecipientSelect.bind(this),allowWide:!1,excludeEmails:this.excludeEmails,watermarkText:this.watermarkText,watermarkIcon:this.showWatermarkIcon&&this.watermarkIcon,hintMessage:h.t("type_a_persons_name")};this.emailsOnly||(a.earlyModelResults={},a.earlyModelResults[i.MODEL_USER]=4,a.earlyModelResults[i.MODEL_DOMAIN]=2);var d=this;return g.getCurrentNetwork().community&&(a.onNoSelection=function(a){-1!=a.indexOf("@")&&d.handleRecipientSelect({name:a,id:1,type:i.MODEL_DOMAIN})}),a.triggerStrings[i.MODEL_USER]="@",c.defer(c.bind(function(){this.$inviteField.length&&i.registerField(this.$inviteField,a)},this)),this},_handleInviteFieldFocus:function(){this.$inviteField.removeClass("yj-inactive")},_handleInviteFieldBlur:function(){this.$inviteField.addClass("yj-inactive")},handleRecipientSelect:function(a){var b=[],c=[];switch(this.recipient=a,this.$inviteSpinner.show(),this.$inviteField.val(a.full_name||a.name||"").attr("disabled","disabled"),"email"==a.type||a.type==i.MODEL_DOMAIN?c.push(a.name):b.push(a.id),this.typeaheadType){case"add-member":this.isCompanyGroup?(this.errorMessage=h.t("there_was_an_error_sending_the_invite"),j.inviteToGroup({email:c.join(","),section:this.$target.attr("data-section")||"",source:this.$target.attr("data-source")||""}).then(this.handleAddInviteSuccess,this.handleAddInviteError)):(this.errorMessage=h.t("there_was_an_error_adding_the_user_to_the_group"),j.addToGroup({group_id:this.$target.attr("data-group-id"),invite_section:this.inviteSection,invites:{ids:b,emails:{addresses:c.join(",")}}}).then(this.handleAddInviteSuccess,this.handleAddInviteError));break;case"page-invite":this.successMessage=h.t("the_invite_was_sent_successfully"),this.errorMessage=h.t("there_was_an_error_sending_the_invite");var d=l.get(this.model.group_id);j.inviteToCollaborateOnNote({note_id:this.model.id,group_permalink:d&&d.get("name"),user_ids:b}).then(this.handleAddInviteSuccess,this.handleAddInviteError);break;default:throw new Error("typeahead type must be specified")}},handleAddInviteSuccess:function(a){if(this.$inviteSpinner.hide(),this.$inviteField.removeAttr("disabled").val("").blur(),"add-member"==this.typeaheadType)if(a.already_member)f.trigger("/ui/alert/show","error",h.t("user_is_already_a_member_of_this_group",{user:this.recipient.full_name||this.recipient.name||"User"}));else{var d=this.recipient.full_name||this.recipient.name||"User";if(f.trigger("/ui/alert/show","notice",this.isCompanyGroup?h.t("an_invitation_was_sent_to_user",{user:d}):h.t("user_was_added_to_the_group_successfully",{user:d})),"users"==this.recipient.type||"user"==this.recipient.type){var e;b(this.newMemberTemplate({full_name:this.recipient.full_name,web_url:m.userIndex(this.recipient,g),mugshot_url:a.mugshot_url})).hide().appendTo(b(".yj-participants ul")).fadeIn("slow"),e=b(this.tableTemplate({full_name:this.recipient.full_name,web_url:a.web_url,mugshot_url:a.mugshot_url,job_title:a.job_title,link_title:h.t("view_profile")})),e.prependTo(b(".yj-members-grid tbody"))}}else f.trigger("/ui/alert/show","notice",this.successMessage||h.t("success"));c.defer(c.bind(function(){this.$inviteField.focus()},this))},handleAddInviteError:function(){f.trigger("/ui/alert/show","error",this.errorMessage||h.t("there_was_an_error")),this.$inviteSpinner.hide(),this.$inviteField.removeAttr("disabled")}})}),define("css!feeds/lib/ui/pages/current_collaborators",[],function(){}),define("stache!feeds/lib/ui/pages/current_collaborators",["mustache"],function(a){var b='<h2 class="yj-notes-collaborators--header" aria-level="2">\n  {{label}}\n</h2>\n<AddMembersTypeAhead />\n<ul class="yj-current-collaborators-list">\n  <Spinner />\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/pages/current_collaborator",["mustache"],function(a){var b='{{#users}}\n  <li class="yj-collaborator yj-notes-collaborators--list-item yk-clearfix {{#current_user}}current-user{{/current_user}}" id="user-{{user_id}}">\n    <div class="yj-mug-placeholder">\n      <span class="yj-notes-collaborators--list-item-color" style="background-color: {{edit_color}};"></span>\n    </div>\n    <div class="yj-notes-collaborators--list-item-name">\n      <a class="yj-notes-collaborators--list-item-name-link" href="{{web_url}}">{{full_name}}</a>\n      {{#current_user}}\n        <p class="yj-highlight">\n          <input type="checkbox" name="show_highlighting" id="show_highlighting"\'\n          \' class="yj-notes-collaborators--list-item-name-checkbox yj-checkbox yj-highlight-cb" {{#show_highlighting}}checked="checked"{{/show_highlighting}}/>\n          <label for="show_highlighting">{{highlighting_toggle_text}}</label>\n        </p>\n      {{/current_user}}\n      {{^current_user}}\n        <p class="yj-time-stamp" data-time-stamp="{{timestamp}}">\n          {{last_updated}}\n        </p>\n      {{/current_user}}\n    </div>\n  </li>\n{{/users}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/pages/current_collaborators",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/date_helper","common-ui/lib/ui/shared/spinner","components/avatar/index","paddie-client/lib/pad2","backbone","core/lib/session","core/lib/tr","models/user","core/lib/yammer_api","models/helpers/user","common-ui/lib/ui/shared/add_member_type_ahead","core/lib/urls","css!feeds/lib/ui/pages/current_collaborators","html!./current_collaborators","html!./current_collaborator"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/backbone_with_subviews"),g=a("core/lib/date_helper"),h=a("common-ui/lib/ui/shared/spinner"),i=a("components/avatar/index"),j=a("paddie-client/lib/pad2"),k=a("backbone"),l=a("core/lib/session"),m=a("core/lib/tr"),n=a("models/user"),o=a("core/lib/yammer_api"),p=a("models/helpers/user"),q=a("common-ui/lib/ui/shared/add_member_type_ahead"),r=a("core/lib/urls");return a("css!feeds/lib/ui/pages/current_collaborators"),d.extend({mixins:[e,f],events:{"change .yj-current-collaborators-list .yj-highlight-cb":"_toggleHighlighting"},className:"yj-current-collaborators",id:"currentCollaborators",template:a("html!./current_collaborators"),itemTemplate:a("html!./current_collaborator"),views:{Spinner:"_getSpinner",AddMembersTypeAhead:"_getAddMembersTypeAhead"},initialize:function(){this.subscribe(),this._intervalHandle=setInterval(function(){b(".yj-collaborator .yj-time-stamp").each(function(){var a=parseInt(b(this).attr("data-time-stamp"),10);a>0&&b(this).text(g.formatAgo(new Date(a),new Date))})},3e4)},render:function(){return this.$list=this.$(".yj-current-collaborators-list"),this},getTemplateData:function(){return{label:m.t("current_collaborators")}},subscribe:function(){k.on("/ui/pages/addOrUpdateUser",this.handleAddOrUpdateUser,this),k.on("/ui/pages/removeUser",this.removeUser,this)},removeUser:function(a){if(a.userId=a.userId.indexOf(".")>-1?a.name:a.userId,a.userId!=l.getCurrentUser().id&&!a.isDuplicate){this.$list.find("#user-"+a.userId+" .yj-time-stamp").attr("data-time-stamp",Date.now());var b=parseInt(this.$list.find("#user-"+a.userId+" .yj-time-stamp").attr("data-time-stamp"),10);this.$list.find("#user-"+a.userId+" .yj-time-stamp").text(g.formatAgo(new Date(b),new Date)),this.$list.find("#user-"+a.userId+" .pencil-edit-icon").hide(),this.$list.find('.yj-collaborator:contains("Currently Editing"):last').after(this.$list.find("#user-"+a.userId))}},populateUsers:function(a,b){this.populateCurrentUser(a),this.populateHistoricUsers(b)},populateHistoricUsers:function(a){var b=c.sortBy(a,function(a){return a.last_updated});c.each(b,function(a){a.userId=a.id,this.handleAddOrUpdateUser(a)},this)},populateCurrentUser:function(a){var b=l.getCurrentUser(),c=this._renderUser(b,a);this.spinner&&this.spinner.$el.hide(),this.$list.prepend(c),k.trigger("/ui/hovercard/add",c.find(".yj-mug-link, .yj-name"),{type:"user",id:b.id,orientation:"left"})},handleAddOrUpdateUser:function(a){var b=this;-1!==a.userId.indexOf(".")&&(a.userId=a.name),o.getUser({id:a.userId}).then(function(c){c=n.save(c);var d=b._renderUser(c,a);b.$list.find("#user-"+c.id).remove(),b.$list.find(".current-user").length<1?b.$list.prepend(d):b.$list.find(".current-user").after(d),k.trigger("/ui/hovercard/add",d.find(".yj-mug-link, .yj-name"),{type:"user",id:c.id,orientation:"left"})},function(a){throw new Error("Failed to load user: "+a.message)})},_renderUser:function(a,c){var d,e=a.id==l.getCurrentUser().id,f=e||!c.last_updated,h=f?m.t("currently_editing"):g.formatAgo(new Date(c.last_updated),new Date),i=[{web_url:r.userIndex(a,l),current_user:e,show_highlighting:c.showHighlighting,highlighting_toggle_text:m.t("highlight_my_changes"),mugshot_url:a.mugshot_url,full_name:a.full_name,currently_editing:f,last_updated:h,timestamp:e?"":c.last_updated,edit_color:j.getColorPalette()[c.colorId],user_id:a.id,isNew:!e&&p.isNew(a,l)}];return d=b(this.itemTemplate({users:i})),this._addAvatarToHtml(a,d),d},_getSpinner:function(){return this.spinner=new h,this.spinner},_addAvatarToHtml:function(a,b){var c=new i({model:a,withHovercard:"left",hideFromAccessibility:!0});b.find(".yj-mug-placeholder").append(c.render().$el)},_getAddMembersTypeAhead:function(){var a={watermarkText:"+   "+m.t("add_collaborators"),typeaheadType:"page-invite",excludeEmails:!0,showWatermarkIcon:!1,model:this.model};return new q(a)},_toggleHighlighting:function(a){var c=!!b(a.target).attr("checked");j.notifyChangeHighlighting(c)},remove:function(){clearInterval(this._intervalHandle),k.off("/ui/pages/addOrUpdateUser",this.handleAddOrUpdateUser,this),k.off("/ui/pages/removeUser",this.removeUser,this)}})}),define("feeds/lib/ui/pages/editor_plugins",["require","underscore","mustache","common-ui/lib/ui/keyboard/keyboard_shortcuts","core/lib/log","core/lib/model_helper","core/lib/namespace","paddie-client/lib/pad_editor","backbone","models/helpers/user","components/hovercard_link/index","core/lib/urls"],function(a){var b=a("underscore"),c=a("mustache"),d=a("common-ui/lib/ui/keyboard/keyboard_shortcuts"),e=a("core/lib/log"),f=a("core/lib/model_helper"),g=a("core/lib/namespace"),h=a("paddie-client/lib/pad_editor"),i=a("backbone"),j=a("models/helpers/user"),k=a("components/hovercard_link/index"),l=a("core/lib/urls");g.ns("yam.ui.pages");var m=!1,n=["id","type","state","name","permalink","full_name","url","web_url","mugshot_url","thumbnail_url","image","file","content_class","content_type","description","privacy"],o=[],p={getReferences:function(){return o},clearReferences:function(){o=[]},addReference:function(a){a&&(a=p._toWireFormat(a),o.push(a))},updateReferences:function(a,b){var c,d;if(b&&b.length)try{for(var g=0,h=b.length;h>g;g++)c=b[g],d=f.getModelByType(c.type),d&&d.save(c)}catch(a){e.log("pages","[Error] could not update references")}},_toWireFormat:function(a){var c={};return b.each(n,function(b){c[b]=a[b]}),c}};yam.ui.pages.refBank=p;var q="\\[(\\w+):(\\d+)\\]",r=new RegExp(q);i.on("/ui/pages/newRevision",p.updateReferences);var s=yam.ui.pages.getAttributesAtIndex=function(a,b){var c=yam.ui.pages.rep,d=yam.ui.pages.changeset,e=c.alines[a],f=d.opIterator(e),g=c.apool,h=0,i=function(a){for(;a.hasNext();){var c=a.next();if(h+=c.chars,h>=b){var e,f,i=[];return d.eachAttribNumber(c.attribs,function(a){e=g.getAttribKey(a),f=g.getAttribValue(a),i.push({key:e,val:f,chars:c.chars})}),i}}};return i(f)},t=yam.ui.pages.yamAttrsAroundIndex=function(a,b){var c=yam.ui.pages.rep,d=yam.ui.pages.changeset,e=c.alines[a],f=d.opIterator(e),g=c.apool,h=0,i=b-1,j=!1,k=b,l=!1,m=b+2,n=!1,o={},p=function(a){for(;a.hasNext();){var b=a.next();h+=b.chars,h>=i&&!j&&(d.eachAttribNumber(b.attribs,function(a){"yammer"===g.getAttribKey(a)&&(o.before=!0)}),j=!0),h>=k&&!l&&(d.eachAttribNumber(b.attribs,function(a){"yammer"===g.getAttribKey(a)&&(o.at=!0)}),l=!0),h>=m&&!n&&(d.eachAttribNumber(b.attribs,function(a){"yammer"===g.getAttribKey(a)&&(o.after=!0)}),n=!0)}return o};return p(f)};yam.ui.pages.getValidIndex=function(a,b,c){c=c||!1;var d=yam.ui.pages.rep,e=yam.ui.pages.changeset,f=d.alines[a],g=e.opIterator(f),h=0,i=function(a){for(;a.hasNext();){var d=a.next();if(h+=d.chars,h>=b)return c&&(h-=d.chars),h}};return i(g)};var u=function(){var a=yam.ui.pages.rep;return a.selStart&&a.selEnd&&a.selStart[0]===a.selEnd[0]&&a.selStart[1]===a.selEnd[1]};yam.ui.pages.getSelectedText=function(a){var b=yam.ui.pages.rep;if(u())return null;if(a&&b.selStart[0]!==b.selEnd[0])return null;var c=b.selStart[0],d=b.lines.atIndex(c),e=d.text;if(e=e.substring(b.selStart[1],b.selEnd[1]),a)return e;var f=b.selEnd[0];for(c++;f>c;c++)d=b.lines.atIndex(c),e+="\n"+d.text.substring(d.lineMarker,b.selEnd[1]);return d=b.lines.atIndex(c),e+="\n"+d.text.substring(d.lineMarker,b.selEnd[1])};var v,w=function(a){return b.detect(a,function(a){return a.key.indexOf("yammer")>-1||"url"===a.key})},x=function(a,b){var c=s(a,b),d=w(c),e=!!d;return e},y=function(a){var b=yam.ui.pages.rep,c=37===a,d=39===a?2:0,e=yam.ui.pages.getValidIndex(b.selStart[0],b.selStart[1]+d,c);c||e++,h.ace.callWithAce(function(a){var c=a.ace_getPointForLineAndChar([b.selStart[0],e]);a.ace_setSelection({startPoint:c,endPoint:c})})},z=!1,A=function(a){var b=!0;switch(a){case 8:b=!1;break;case 13:b=!1;break;case 46:b=!1;break;case 37:b=!1;break;case 38:b=!1;break;case 39:b=!1;break;case 40:b=!1}return b},B=function(){var a=yam.ui.pages.rep;D()||(yam.ui.pages.lastSelStart=a.selStart,yam.ui.pages.lastSelEnd=a.selEnd,setTimeout(function(){yam.ui.pages.lastSelStart=a.selStart,yam.ui.pages.lastSelEnd=a.selEnd},50))},C=yam.ui.pages.isSelectionLost=function(){var a=yam.ui.pages.lastSelStart,c=yam.ui.pages.lastSelEnd,d=yam.ui.pages.rep.selStart,e=yam.ui.pages.rep.selEnd;return!b.isEqual(a,d)||!b.isEqual(c,e)},D=yam.ui.pages.isSelectionReset=function(){var a=yam.ui.pages.rep.selStart;return 0===a[0]&&0===a[1]&&C()},E=yam.ui.pages.setCaret=function(a,b){h.ace.callWithAce(function(c){var d=c.ace_getPointForLineAndChar([a,b]);c.ace_setSelection({startPoint:d,endPoint:d})})};yam.ui.pages.setSelection=function(a,b,c,d){h.ace.callWithAce(function(e){var f=e.ace_getPointForLineAndChar([a,b]),g=e.ace_getPointForLineAndChar([c,d]);e.ace_setSelection({startPoint:f,endPoint:g})})},yam.ui.pages.focus=function(){h.ace.callWithAce(function(a){a.ace_focus()})},yam.ui.pages.hasFocus=function(){return!!yam.ui.pages.focused},yam.ui.pages.fixSelection=function(){if(C()){var a=yam.ui.pages.lastSelStart;return E(a[0],a[1]),[a[0],a[1]]}return yam.ui.pages.rep.selStart};var F=function(a){var b=yam.ui.pages.rep,c=function(){if(v=a.which||v,"keydown"!==a.type||37!==a.which&&39!==a.which||(z=!0),!z||"keyup"!==a.type||37!==a.which&&39!==a.which&&91!==a.which&&92!==a.which&&224!==a.which||(z=!1),A(v)){if(z)return!1;if(x(b.selStart[0],b.selStart[1]))if(0!==b.selStart[1]){var c=t(b.selStart[0],b.selStart[1]);if(c.after)return!1;u()&&h.ace.callWithAce(function(a){a.ace_insertText(" ")},"insertNotAttrSpace",!0)}else u()&&h.ace.callWithAce(function(a){a.ace_insertText(" ")},"insertNotAttrSpace",!0)}return!0};return c},G=function(a){var d='<a title="" href="{{{web_url}}}">{{ full_name }}</a>',e=c.render(d,{web_url:l.indexForModel(a),full_name:a.full_name}),f=e.replace(">#<","><"),g=b.escape(a.full_name||a.name);return g=g.replace(/\//,"&#x2F;"),f.split(g)};g.ns("yam.ui.pages.plugins",{attribsToClasses:{yammer:function(a){return a.key+":"+a.value},url:function(a){return a.key+":"+a.value}},getFilterStack:function(){},createDomLine:function(a){var b,c=a.cls;return c=c.replace(/(^| )yammer:(\S+)/g,function(a,c,d){var g=d.match(r);if(!g||g.length<3)return void e.log("pages","[Error] Invalid yammer attribute: "+d);var h=g[1],i=g[2],l=f.objectForReference({id:i,type:h});if(!l)return void e.log("pages","[Error] no model found for reference: "+d);var m;if("uploaded_file"===l.type||"page"===l.type)m=G(l);else{if(!j.isUser(l))throw new Error("Can't get page permalink html");var n=new k({model:l});m=n.render().$el.children().html('"""').prop("outerHTML").split('"""')}return b={extraOpenTags:'<span class="yj-page-link ">'+m[0],extraCloseTags:m[1]+"</span>"},c+"yammer-"+h+" yammer:"+d}),b&&(b.cls=c),b},handleClick:function(){var a=yam.ui.pages.rep,b=function(){x(a.selStart[0],a.selStart[1])&&y()};return setTimeout(b,200),!1}});var H,I={aceAttribsToClasses:[{process:function(a){var b=yam.ui.pages.plugins.attribsToClasses;return b&&b[a.key]?b[a.key](a):a.key}}],aceGetFilterStack:[{process:function(a){var b=yam.ui.pages.plugins.getFilterStack;return b?b(a):void 0}}],aceCreateDomLine:[{process:function(a){var b=yam.ui.pages.plugins.createDomLine;return a.cls&&/yammer/.test(a.cls)&&b?b(a):void 0}}],aceHandleClick:[{process:function(a){setTimeout(B,333);var b,c=a.target,d=yam.ui.pages.plugins.handleClick;if(d){for(;c&&c.parentNode;){if(c.className&&/yammer/.test(c.className)){b=function(a){return d(a,c)};break}c=c.parentNode}return b}}}],aceHandleMouseDown:[{process:function(){m=!0}}],aceHandleMouseUp:[{process:function(){m=!1}}],handleDeleteKey:[{process:function(){return J}}],handleKeyEvent:[{process:function(a){return B(),F(a)}}],aceHandleFocus:[{process:function(){yam.ui.pages.focused=!0}}],aceHandleBlur:[{process:function(){yam.ui.pages.focused=!1,B()}}],aceHandlePaste:[{process:function(){yam.ui.pages.pasteInProgress=!0,clearTimeout(H),H=setTimeout(function(){yam.ui.pages.pasteInProgress=!1},2e3)}}]},J=function(){var a=yam.ui.pages.rep,c=yam.ui.pages.getAttributesAtIndex(a.selStart[0],a.selStart[1]),d=b.detect(c,function(a){return a.key.indexOf("yammer")>-1||"url"===a.key});if(d&&0!==a.selStart[1]){var e=a.selStart,f=[a.selStart[0],a.selStart[1]-d.chars];return h.ace.callWithAce(function(a){a.ace_performDocumentReplaceRange(f,e,"")}),!1}return!0},K=function(){var a,c,d;setInterval(function(){var e=yam.ui.pages.rep,f=yam.ui.pages.getValidIndex,g=e.selStart,j=e.selEnd,k=s(g[0],g[1]);if(b.isEqual(k,d)||(i.trigger("/ui/pages/selectionAttributesChanged",k),d=k),b.isEqual(g,j))x(g[0],g[1])&&8!==v&&13!==v&&y(v);else{var l=g[1],n=j[1],o=!1;x(g[0],g[1])&&(l=f(g[0],g[1],!0),o=!0),x(j[0],j[1])&&(n=f(j[0],j[1]),o=!0),o&&!m&&h.ace.callWithAce(function(b){var d=b.ace_getPointForLineAndChar([g[0],l]),e=b.ace_getPointForLineAndChar([j[0],n]);a===l&&c===n||(a=l,c=n,b.ace_setSelection({startPoint:d,endPoint:e}))})}},100)};i.on("/ui/pages/padInit",function(a){
var c=g.val(yam,"ui.pages.plugins");c&&(a.hooks||(a.hooks={}),b.extend(a.hooks,I),h.ace.callWithAce(function(a){yam.ui.pages.rep=a.ace_getRep(),yam.ui.pages.changeset=a.ace_getChangeset(),K()}),yam.ui.pages.lastSelStart=[0,0],yam.ui.pages.lastSelEnd=[0,0],d.disable())})}),define("stache!components/paddie_editor/src/paddie_editor",["mustache"],function(a){var b='<link href="{{paddieHost}}/static/css/pad.css" rel="stylesheet">\n<link href="https://pad0.assets-yammer.com/static/custom/pad.css" rel="stylesheet">\n<style>\n  body {\n    font-family: \'Segoe\', Helvetica, Arial, sans-serif;\n  }\n</style>\n<div class="yj-pad-container">\n  <div id="editbar">\n    <ul id="menu_left">\n      <li class="select">\n        <label>\n          <span class="yj-acc-hidden">{{text_style_label}}</span>\n          <select class="heading-select">\n            <option value="heading">{{normal_text_label}}</option>\n            <option value="heading:1">{{heading_1_label}}</option>\n            <option value="heading:2">{{heading_2_label}}</option>\n            <option value="heading:3">{{heading_3_label}}</option>\n            <option value="heading:4">{{heading_4_label}}</option>\n          </select>\n        </label>\n      </li>\n      <li>\n        <a href="javascript://" role="button" onClick="window.pad&&pad.editbarClick(\'bold\');return false;" title="{{bold_label}}">\n          <div class="buttonicon bold"><span class="yj-acc-hidden">{{bold_label}}</span></div>\n        </a>\n      </li>\n      <li>\n        <a href="javascript://" role="button" onClick="window.pad&&pad.editbarClick(\'italic\');return false;" title="{{italics_label}}">\n          <div class="buttonicon italic"><span class="yj-acc-hidden">{{italics_label}}</span></div>\n        </a>\n      </li>\n      <li>\n        <a href="javascript://" role="button" onClick="window.pad&&pad.editbarClick(\'underline\');return false;" title="{{underline_label}}">\n          <div class="buttonicon underline"><span class="yj-acc-hidden">{{underline_label}}</span></div>\n        </a>\n      </li>\n      <li>\n        <a href="javascript://" role="button" onClick="window.pad&&pad.editbarClick(\'strikethrough\');return false;" title="{{strikethrough_label}}">\n          <div class="buttonicon strikethrough"><span class="yj-acc-hidden">{{strikethrough_label}}</span></div>\n        </a>\n      </li>\n      <li aria-hidden="true" class="separator"></li>\n      <li>\n        <a href="javascript://" role="button" onClick="window.pad&&pad.editbarClick(\'insertunorderedlist\');return false;" title="{{toggle_bullet_label}}">\n          <div class="buttonicon insertunorderedlist"><span class="yj-acc-hidden">{{toggle_bullet_label}}</span></div>\n        </a>\n      </li>\n      <li>\n        <a href="javascript://" role="button" onClick="window.pad&&pad.editbarClick(\'indent\');return false;" title="{{indent_label}}">\n          <div class="buttonicon indent"><span class="yj-acc-hidden">{{indent_label}}</span></div>\n        </a>\n      </li>\n      <li>\n        <a href="javascript://" role="button" onClick="window.pad&&pad.editbarClick(\'outdent\');return false;" title="{{unindent_label}}">\n          <div class="buttonicon outdent"><span class="yj-acc-hidden">{{unindent_label}}</span></div>\n        </a>\n      </li>\n     </ul>\n    <ul id="menu_right">\n      <li class="editor-button-text">{{link_to_label}}</li>\n      <li>\n        <a href="javascript://" title="{{link_to_person_label}}" class="mention-icon-btn" role="button" data-speechtip>\n          <span class="yamicon yamicon-at yj-dark-gray yamicon-regular"><span class="yj-acc-hidden">{{link_to_person_label}}</span></span>\n        </a>\n      </li>\n      <li>\n        <a href="javascript://" title="{{link_to_www_label}}" class="link-app-icon-btn" role="button" data-speechtip>\n          <span class="yamicon yamicon-link yj-dark-gray yamicon-regular"><span class="yj-acc-hidden">{{link_to_www_label}}</span></span>\n        </a>\n      </li>\n      <li>\n        <a href="javascript://" title="{{link_to_file_label}}" class="file-icon-btn" role="button" data-speechtip>\n          <span class="yamicon yamicon-paperclip yj-dark-gray yamicon-regular"><span class="yj-acc-hidden">{{link_to_file_label}}</span></span>\n        </a>\n      </li>\n      <li>\n        <a href="javascript://" title="{{link_to_note_label}}" class="page-pen-icon-btn" role="button" data-speechtip>\n          <span class="yamicon yamicon-old-note yj-dark-gray yamicon-regular"><span class="yj-acc-hidden">{{link_to_note_label}}</span></span>\n        </a>\n      </li>\n    </ul>\n  </div>\n  <div id="editorcontainerbox">\n    <div id="editorcontainer">\n    </div>\n    <div id="editorloadingbox">{{large_loading_label}}</div>\n  </div>\n  <div id="focusprotector">&nbsp;</div>\n  <div id="modaloverlay">\n    <div id="modaloverlay-inner">\n    </div>\n  </div>\n  <div id="mainmodals">\n    <div id="connectionbox" class="modaldialog">\n      <div id="connectionboxinner" class="modaldialog-inner">\n        <div class="connecting">{{large_connecting_label}}</div>\n        <div class="reconnecting">{{large_reconnecting_label}}</div>\n        <div class="disconnected">\n          <div id="disconnected_looping">\n            <p>\n              <span class="yamicon yamicon-danger page-error"></span><b>{{lost_connection_label}}</b>\n            </p>\n          </div>\n          <div id="disconnected_initsocketfail">\n            <p>\n              <span class="yamicon yamicon-danger page-error"></span><b>{{lost_connection_label}}</b>\n            </p>\n          </div>\n          <div id="disconnected_userdup">\n            <p>\n              <span class="yamicon yamicon-danger page-error"></span><b>{{dupe_edit_label}}</b>\n            </p>\n          </div>\n          <div id="disconnected_unknown">\n            <p>\n              <span class="yamicon yamicon-danger page-error"></span><b>{{lost_connection_label}}</b>\n            </p>\n          </div>\n          <div id="disconnected_slowcommit">\n            <p>\n              <span class="yamicon yamicon-danger page-error"></span><b>{{lost_connection_label}}</b>\n            </p>\n          </div>\n          <div id="disconnected_unauth">\n            <p>\n              <span class="yamicon yamicon-danger page-error"></span><b>{{perms_error_label}}</b>\n            </p>\n          </div>\n          <div id="disconnected_deleted">\n            <p>\n              <span class="yamicon yamicon-danger page-error"></span><b>{{perms_error_label}}</b>\n            </p>\n          </div>\n          <div id="reconnect_advise">\n          </div>\n          <div id="reconnect_form">\n            <button id="forcereconnect">{{try_again_label}}</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <form id="reconnectform" method="post" action="/ep/pad/reconnect" accept-charset="UTF-8" style="display: none;">\n      <input type="hidden" class="padId" name="padId"/>\n      <input type="hidden" class="diagnosticInfo" name="diagnosticInfo"/>\n      <input type="hidden" class="missedChanges" name="missedChanges"/>\n    </form>\n  </div>\n</div>\n <div class="yj-paddie-editor--footer">\n  <div class="yj-paddie-editor--status-container">\n    {{#hints}}<span class="yj-paddie-editor--hint">{{.}}</span>{{/hints}}\n    <span class="yj-paddie-editor--status committing">{{saving_label}}</span>\n    <span class="yj-paddie-editor--status reconnecting">{{reconnecting_label}}</span>\n    <span class="yj-paddie-editor--status commit_accepted">{{draft_auto_saved_label}}</span>\n  </div>\n  <button type="submit" class="yj-paddie-editor--publish yj-btn pad-publish-button" disabled="disabled" data-qaid="publish_note">{{publish_label}}</button>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/paddie_editor/src/paddie_editor",[],function(){}),define("components/paddie_editor/src/paddie_editor",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","paddie-client/lib/pad2","core/lib/session","backbone","core/lib/tr","core/lib/yammer_api","core/lib/yammer_config","models/user","models/helpers/user","feeds/lib/ui/pages/editor_plugins","html!./paddie_editor","css!./paddie_editor"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("paddie-client/lib/pad2"),f=a("core/lib/session"),g=a("backbone"),h=a("core/lib/tr"),i=a("core/lib/yammer_api"),j=a("core/lib/yammer_config"),k=a("models/user"),l=a("models/helpers/user");a("feeds/lib/ui/pages/editor_plugins");var m=a("html!./paddie_editor");a("css!./paddie_editor");var n=500,o=[h.t("hint_edits_are_auto_saved_click_publish_when_ready_to"),h.t("hint_multiple_users_can_edit_this_note_at_the_same")],p=function(a){$(".yj-paddie-editor--hint").hide(),$(".yj-paddie-editor--status").hide(),a&&($(".yj-paddie-editor--status").hide(),$(".yj-paddie-editor--status."+a).show())},q=function(){var a=Math.floor(o.length*Math.random())+1;$(".yj-paddie-editor--hint").hide(),$(".yj-paddie-editor--hint:nth-child("+a+")").show()};return c.extend({template:m,mixins:[d],className:"yj-paddie-editor content-redesign",initialize:function(){if(!this.model)throw new Error("Official Badge requires a note model");b.bindAll(this,"_onNewRevision","_onActivity","_onPublished"),this._setupPaddie()},events:{"click .yj-paddie-editor--publish":"_clickPublish"},getTemplateData:function(){return{paddieHost:j.config().paddieHost,hints:o,text_style_label:h.t("paddie_text_style"),normal_text_label:h.t("paddie_normal_text"),heading_1_label:h.t("paddie_heading_1_style"),heading_2_label:h.t("paddie_heading_2_style"),heading_3_label:h.t("paddie_heading_3_style"),heading_4_label:h.t("paddie_heading_4_style"),saving_label:h.t("saving"),reconnecting_label:h.t("reconnecting"),draft_auto_saved_label:h.t("draft_auto_saved"),publish_label:h.t("publish_note"),lost_connection_label:h.t("paddie_warning_lost_connection"),dupe_edit_label:h.t("paddie_warning_dupe_edit"),perms_error_label:h.t("paddie_warning_perms_error"),large_connecting_label:h.t("paddie_warning_connecting"),large_reconnecting_label:h.t("paddie_warning_reconnecting"),large_loading_label:h.t("paddie_warning_loading"),try_again_label:h.t("paddie_button_try_again"),bold_label:h.t("paddie_style_bold"),italics_label:h.t("paddie_style_italics"),underline_label:h.t("paddie_style_underline"),strikethrough_label:h.t("paddie_style_strikethrough"),toggle_bullet_label:h.t("paddie_style_toggle_bullet_list"),indent_label:h.t("paddie_style_indent"),unindent_label:h.t("paddie_style_unindent"),link_to_label:h.t("paddie_link_to"),link_to_person_label:h.t("paddie_link_to_person"),link_to_www_label:h.t("paddie_link_to_www"),link_to_file_label:h.t("paddie_link_to_file"),link_to_note_label:h.t("paddie_link_to_note")}},_setupPaddie:function(){var a=this;e.connect(f.getCurrentUser(),function(){return a._initPaddie(),{paddieURL:this.model.paddie_host,padId:this.model.paddie_id,pageIsActive:this.model.active,groupId:this.model.group_id,lastPublishedRevision:this.model.latest_revision}}.bind(this),!0)},_initPaddie:function(){this._listenForPaddieEvents(),q()},_subs:[],_listenForPaddieEvents:function(){g.on("/ui/pages/newRevision",this._onNewRevision,this),g.on("/ui/pages/activity",this._onActivity,this),g.on("/ui/pages/published",this._onPublished,this)},_onNewRevision:function(a,b){yam.modelController.initReferences(b),this.model.latest_collab_version=a,this._refreshPublishButton()},_onPublished:function(a,b){this.model.last_published_at=(new Date).toUTCString(),this.model.latest_revision=parseInt(a,10),this._refreshPublishButton();var c=h.t("the_note_has_been_published"),d=k.findById(b);l.isCurrentUser(d,f)||(c=h.t("user_has_published_this_note",{user:l.getFullName(d)})),g.trigger("/ui/alert/show","notice",c),this._refreshPublishButton()},_onActivity:function(a){"commit_accepted"===a?this._saveTimeout=setTimeout(p.bind(null,a),n):(clearTimeout(this._saveTimeout),p(a)),this._refreshPublishButton()},_clickPublish:function(){var a=this;i.publishNote({note_id:this.model.id,revision_number:e.getCollabRevisionNumber()}).then(function(){a.trigger("user-published")}).fail(function(b){var c=b.responseJSON&&b.responseJSON.error||h.t("note_publish_fail");a.trigger("user-published-failed",c)})},_refreshPublishButton:function(){$(".yj-paddie-editor--publish").attr("disabled",!this._canPublish())},_canPublish:function(){return this.model.latest_revision<e.getCollabRevisionNumber()},remove:function(){return g.off("/ui/pages/newRevision",this._onNewRevision,this),g.off("/ui/pages/activity",this._onActivity,this),g.off("/ui/pages/published",this._onPublished,this),e.socket.disconnect(),c.prototype.remove.call(this)}})}),define("components/paddie_editor/index",["require","./src/paddie_editor"],function(a){"use strict";return a("./src/paddie_editor")}),define("css!workfeed/lib/app/views/note/edit",[],function(){}),define("stache!workfeed/lib/app/views/note/edit",["mustache"],function(a){var b='{{^loading}}\n<Header />\n<div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n  <div class="yk-row">\n    <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n      <div class="yj-selector-left-col yj-wide yj-scrollbar-fix">\n        <div class="yj-edit-note--note-container"><PaddieEditor /></div>\n        <div class="yj-edit-note--topics-container"><Topics /></div>\n        <div class="yj-edit-note--feed-container"><Feed /></div>\n      </div>\n    </div>\n    <div class="yj-edit-note--right-sidebar-container">\n      <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6">\n        <Actions />\n        {{#show_collaborators}}\n          <div class="yj-notes-collaborators fie"><CurrentCollaborators /></div>\n        {{/show_collaborators}}\n        <Followers />\n      </div>\n    </div>\n  </div>\n</div>\n{{/loading}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/note/edit",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/sidebar_actions/index","components/sidebar_actions/src/strategies/note","components/sidebar_followers/index","models/page","models/group","models/user","components/attachment_feed/index","feeds/lib/ui/attachments/content_topics","feeds/lib/ui/pages/current_collaborators","workfeed/lib/app/helpers/layout","core/lib/tr","core/lib/yammer_api","feeds/lib/ui/util/title_updater","models/helpers/group","core/lib/location_helper","./header","components/paddie_editor/index","backbone","core/lib/urls","core/lib/yammer_uri","css!./edit","css!./paddie","html!./edit"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/sidebar_actions/index"),g=a("components/sidebar_actions/src/strategies/note"),h=a("components/sidebar_followers/index"),i=a("models/page"),j=a("models/group"),k=a("models/user"),l=a("components/attachment_feed/index"),m=a("feeds/lib/ui/attachments/content_topics"),n=a("feeds/lib/ui/pages/current_collaborators"),o=a("workfeed/lib/app/helpers/layout"),p=a("core/lib/tr"),q=a("core/lib/yammer_api"),r=a("feeds/lib/ui/util/title_updater"),s=a("models/helpers/group"),t=a("core/lib/location_helper"),u=a("./header"),v=a("components/paddie_editor/index"),w=a("backbone"),x=a("core/lib/urls"),y=a("core/lib/yammer_uri");a("css!./edit"),a("css!./paddie");var z=a("html!./edit"),A=function(a){var b=[].concat(a.references||[],a.external_references||[]);b.forEach(function(a){var b;"user"===a.type&&(b=k.findById(a.id),b||k.save(a))})},B=function(a){for(var b=[].concat(a.references||[],a.external_references||[]),c=0;c<b.length;c++){var d=b[c];if("group"===d.type&&d.id===a.group_id)return new j(d)}return j.ALL_COMPANY()},C=function(a){var c=[].concat(a.references||[],a.external_references||[]);return c.filter(function(a){return"topic"===a.type}).map(function(a){return a.name=b.escape(a.name),a})};return c.extend({mixins:[d,e],template:z,views:{Header:"_getHeader",Followers:"_getFollowers",Actions:"_getActions",Feed:"_getFeed",Topics:"_getTopics",PaddieEditor:"_getPaddieEditor",CurrentCollaborators:"_getCurrentCollaborators"},className:o.twoColumnMainClass,attributes:{role:"main"},initialize:function(){b.bindAll(this,"_getMetadata","_processMetadata"),this.group=this.options.group,this._loaded()||this._fetchNote()},getTemplateData:function(){var a={loading:!0};return this._loaded()?{show_collaborators:!s.isExternal(this.group)}:a},_loaded:function(){return!(!this.model||!this.group)},_getHeader:function(){return new u({model:this.model,group:this.group,isEditing:!0})},_getFollowers:function(){return new h({model:this.model})},_fetchNote:function(){this._getMetadata().then(this._processMetadata).fail(function(){t.replace(y.app("/"))})},_getMetadata:function(){return q.getNote({note_id:this.options.noteId,include_featured_users:!0,include_head_revision:!0})},_processMetadata:function(a){this.model=i.create(a),this.group=B(a),r.setTitle(p.t("about_note_page_title",{note_title:this.model.name,group:s.getFullName(this.group)})),this._topics=C(this.model),A(a),this.render()},_getActions:function(){return new f({model:this.model,group:this.group,isEditing:!0,strategy:g})},_getTopics:function(){return new m({data:{note_id:this.model.id,topics:this._topics},removeTopicCall:q.removeNoteTopic,addTopicCall:q.addNoteTopic})},_getFeed:function(){return new l({model:this.model,group:this.group})},_getPaddieEditor:function(){var a=new v({model:this.model});return this.listenTo(a,"user-published",this._onUserPublish),this.listenTo(a,"user-published-failed",this._onPublishFail),a},_onUserPublish:function(){t.assign(x.noteIndex(this.model))},_onPublishFail:function(a){w.trigger("/ui/alert/show","error",a)},_subs:[],_getCurrentCollaborators:function(){var a=new n({model:this.model});return w.on("/ui/pages/padInit",function(b){var c=b.collab_client_vars.historicalAuthorData||[];a&&a.populateUsers(pad.myUserInfo,c)},this),a},remove:function(){return w.off("/ui/pages/padInit",null,this),c.prototype.remove.call(this)}})}),define("common-ui/lib/ui/general/delete_file_confirmation",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","backbone","core/lib/yammer_api","html!./delete_confirmation"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("backbone"),f=a("core/lib/yammer_api"),g=a("html!./delete_confirmation");return b.extend({mixins:[c],events:{"click #cancel-action":"_cancelDelete","click #confirm-action":"_confirmDelete"},className:"yj-colorbox",template:g,initialize:function(a){this._confirmCallback=a.confirmCallback,this.itemId=a.itemId},getTemplateData:function(){return{negative_action:d.t("dont_delete"),positive_action:d.t("delete"),confirm_message:d.t("delete_file_warning_confirm")}},_confirmDelete:function(){f.deleteFile({file_id:this.itemId}).then(this._confirmCallback,function(){e.trigger("/ui/alert/show","error",d.t("there_was_an_error_deleting_your_file"))}),e.trigger("/ui/lightbox/close")},_cancelDelete:function(){e.trigger("/ui/lightbox/close")}})}),define("components/sidebar_actions/src/strategies/file",["require","underscore","common-ui/lib/ui/general/delete_file_confirmation","common-ui/lib/ui/general/lightbox_manager","backbone","core/lib/location_helper","core/lib/tr","core/lib/urls","core/lib/yammer_api","core/lib/session","models/helpers/file","feeds/lib/ui/attachments/yamio_preview","backbone","feeds/lib/ui/files/upload_dialog","core/lib/filename_helper","core/lib/uri_helper","collections/group_memberships"],function(a){"use strict";var b=a("underscore"),c=a("common-ui/lib/ui/general/delete_file_confirmation"),d=a("common-ui/lib/ui/general/lightbox_manager"),e=a("backbone"),f=a("core/lib/location_helper"),g=a("core/lib/tr"),h=a("core/lib/urls"),i=a("core/lib/yammer_api"),j=a("core/lib/session"),k=a("models/helpers/file"),l=a("feeds/lib/ui/attachments/yamio_preview"),e=a("backbone"),m=a("feeds/lib/ui/files/upload_dialog"),n=a("core/lib/filename_helper"),o=a("core/lib/uri_helper"),p=a("collections/group_memberships"),q=function(a){return"Image"===a.content_class},r=function(a,b,c){return k.canEdit(a,b,c)&&!k.canEditInO365(a,b,c)},s=function(a,b){return b&&a.latest_version_id!==b},t=function(a,c){for(var d=0;d<a.versions.length;d++)if(a.versions[d].id===c)return b.extend({},a,a.versions[d]);return a},u=function(){var a,b,c,d,e=j.getCurrentUser(),f=k.isReadOnly(this.model,j,p),i=s(this.model,this.options.version);i||f||(b=k.canMarkOfficial(this.model,e,this.options.group),a=k.canDelete(this.model,e,this.options.group,j),c=k.canEditInO365(this.model,e,this.options.group),d=r(this.model,e,this.options.group));var l=t(this.model,this.options.version);return{hasActions:!0,actions_header:g.t("sidebar_file_file_actions"),delete_label:g.t("sidebar_actions_delete_file"),mark_official_label:g.t("about_note_mark_official_label"),remove_official_label:g.t("about_note_remove_official_label"),is_official:this.model.official,can_mark_official:b,can_delete:a,can_revert:i&&!k.canEditInO365(this.model,e,this.options.group),revert_label:g.t("file_actions_revert"),goto_label:g.t("note_actions_goto"),goto_href:h.fileIndex(this.model),can_download:!0,download_label:i?g.t("file_actions_download_version"):g.t("download"),size_label:k.bytesToSize(l.size),download_href:l.download_url,can_edit:c,edit_label:g.t("sidebar_actions_edit_file"),edit_href:h.fileEdit(this.model),edit_in_new_window:!0,can_view_fullscreen:!!l.post_processed_id,view_fullscreen_label:q(this.model)?g.t("sidebar_actions_view_fullscreen_image"):g.t("sidebar_actions_view_fullscreen"),can_upload:d,upload_label:g.t("sidebar_actions_upload"),can_return:i,return_label:g.t("file_actions_return"),return_href:h.fileIndex(this.model)}},v=function(){var a=this,b=new c({itemId:this.model.id,confirmCallback:function(){f.replace(h.groupFiles(a.options.group)),e.trigger("/ui/alert/show","notice",g.t("the_file_has_been_deleted"))}});d.openComponent(b,"",null,{title:g.t("delete_file_warning_confirm_title"),width:"370"})},w=function(){var a=this;i.makeFileOfficial({file_id:this.model.id}).then(function(){e.trigger("/ui/alert/show","notice",g.t("this_file_has_been_marked_as_official")),a.model.official=!0}).always(function(){a.trigger("change"),a.render()})},x=function(){var a=this;i.makeFileUnofficial({file_id:this.model.id}).then(function(){e.trigger("/ui/alert/show","notice",g.t("this_file_is_no_longer_official")),a.model.official=!1}).always(function(){a.trigger("change"),a.render()})},y=function(){var a=this.model;i.revertFileToVersion({file_id:a.id,version_id:this.options.version}).then(function(){f.assign(h.fileIndex(a))},function(){e.trigger("/ui/alert/show","error",g.t("there_was_an_error_reverting_your_file"))})},z=function(){if(this.model.transcoded){var a="video-player/"+this.model.id+"/fullscreen";e.trigger(a)}else{var b=t(this.model,this.options.version);b.preview_url=o.replaceParam(b.preview_url,"_t",Date.now()),l.showOverlayForAttachment(b)}},A=function(){d.openComponent(new m({file:this.model.id,extensions:n.getExtension(this.model.path)}),"yj-quick-link-lightbox yj-scrollbar-fix",void 0,{title:g.t("sidebar_actions_upload"),overlayClose:!1,scrolling:!1})};return{actions:{DELETE:v,MARK_OFFICIAL:w,REMOVE_OFFICIAL:x,REVERT:y,VIEW_FULLSCREEN:z,UPLOAD:A},getTemplateData:u}}),define("components/sidebar_history/src/strategies/file",["require","underscore","core/lib/urls","core/lib/tr","models/user","core/lib/date_helper"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/urls"),d=a("core/lib/tr"),e=a("models/user"),f=a("core/lib/date_helper"),g={PUBLISHED_BY:"sidebar_versions_uploaded_by",TITLE:"sidebar_versions_file_title",PUBLISHED_AGO:"sidebar_versions_uploaded_ago",CURRENT_VERSION:"sidebar_versions_current_version"},h=function(a,b){return new Date(b.created_at)-new Date(a.created_at)},i=function(){var a=this.model;this.collection=a.versions.sort(h),this.contributors=a.versions.reduce(function(a,b){return a.concat(e.findById(b.uploader_id))},[])},j=function(){return{items:this.collection.map(function(a){return{show_avatar:!0,show_color:!1,selected:this._isCurrent(a)&&!this.options.version||a.id===this.options.version,link:this._getLinkHTML(a),link_href:c.fileCompare(this.model,a),by_editor:d.t(g.PUBLISHED_BY),editor_id:a.uploader_id,contributors:[a.uploader_id],date:f.formatDateTime(new Date(a.created_at))}}.bind(this)),title:d.t(g.TITLE),url:c.noteFollowers(this.model)}},k=function(a){return a.id===this.model.latest_version_id};return b.extend(g,{initialize:i,getTemplateData:j,isCurrent:k})}),define("stache!components/spinner/src/spinner",["mustache"],function(a){var b='<i></i>\n<span class="yk-acc-hidden">\n  {{loading_label}}\n</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("components/spinner/src/spinner",["require","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./spinner"],function(a){"use strict";var b=a("core/lib/tr"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("html!./spinner"),f={loading_label:b.t("loading")};return c.extend({mixins:[d],className:"yk-spinner-dots",template:e,getTemplateData:function(){return f}})}),define("components/spinner/index",["require","./src/spinner"],function(a){"use strict";return a("./src/spinner")}),define("stache!components/editable_file_description/src/editable_file_description",["mustache"],function(a){var b='{{^updating}}\n{{#editing}}\n<textarea class="yj-editable-file-description--textarea">{{description}}</textarea>\n{{/editing}}\n{{^editing}}\n<div class="yj-editable-file-description--placeholder">{{^description}}{{placeholder_label}}{{/description}}</div>\n{{description}}\n<div class="yamicon yj-dark-gray-light yamicon-rd_edit"></div><a href="javascript://" role="button">{{edit_label}}</a>\n{{/editing}}\n{{/updating}}\n{{#updating}}\n<Spinner />\n{{/updating}}';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/editable_file_description/src/editable_file_description",[],function(){}),define("components/editable_file_description/src/editable_file_description",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","core/lib/yammer_api","components/spinner/index","html!./editable_file_description","css!./editable_file_description"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/tr"),f=a("core/lib/yammer_api"),g=a("components/spinner/index"),h=a("html!./editable_file_description");return a("css!./editable_file_description"),b.extend({className:"yj-editable-file-description",mixins:[c,d],template:h,views:{Spinner:"_getSpinner"},events:{click:"_onClick","blur .yj-editable-file-description--textarea":"_onBlur"},getTemplateData:function(){return{editing:this._editing,description:this.model.description,edit_label:e.t("editable_file_description_edit"),placeholder_label:e.t("editable_file_description_placeholder"),updating:this._updating}},_getSpinner:function(){return new g},_onClick:function(){this._editing=!0,this.render(),$(".yj-editable-file-description--textarea",this.$el).focus()},_onBlur:function(a){this._editing=!1;var b=a.target.value;return b===this.model.description?void this.render():(this._updating=!0,this.render(),void f.updateFileDescription({id:this.model.id,description:b}).then(function(){this.model.description=b}.bind(this)).always(function(){this._updating=!1,this.render()}.bind(this)))}})}),define("components/editable_file_description/index",["require","./src/editable_file_description"],function(a){"use strict";return a("./src/editable_file_description")}),define("css!workfeed/lib/app/views/file/header",[],function(){}),define("stache!workfeed/lib/app/views/file/header",["mustache"],function(a){var b='<div class="yj-about-file--header-breadcrumbs">\n  <div class="yj-about-file--header-breadcrumb">{{{group_link}}}</div>\n  {{^is_readonly}}\n  <div class="yamicon yj-dark-gray-light yamicon-right-arrow" aria-hidden="true"></div>\n  <a href="{{files_link_href}}" class="yj-about-file--header-breadcrumb">{{files_link_text}}</a>\n  {{#show_breadcrumbs}}\n  <div class="yamicon yj-dark-gray-light yamicon-right-arrow" aria-hidden="true"></div>\n  <a href="{{file_link_href}}" class="yj-about-file--header-breadcrumb file-link">{{file_link_text}}</a>\n  <div class="yamicon yj-dark-gray-light yamicon-right-arrow" aria-hidden="true"></div>\n  <div class="yj-about-file--header-breadcrumb">{{subpage_title}}</div>\n  {{/show_breadcrumbs}}\n  {{/is_readonly}}\n</div>\n<div class="yj-about-file--header-row">\n  <div class="yj-about-file--header-icon">\n    <FileThumbnail />\n    <span class="yj-acc-hidden">{{icon_alt_text}}</span>\n  </div>\n  <div class="yj-about-file--header-display-name" data-qaid="header-name">\n    <span class="yj-acc-hidden"><label for="yj-about-file-edit-title">{{title_label}}</label></span>\n    <input type="text" id="yj-about-file-edit-title" class="yj-about-file--header-title-edit" value="{{title}}" maxlength="255" data-qaid="header_name" {{#is_readonly}}disabled{{/is_readonly}}></input>\n    <div class="yj-about-file--header-details">\n      {{#is_private}}\n      <div class="yj-about-file--private">\n        <div class="yamicon yamicon-lock yamicon-small yj-dark-gray"></div>\n        <div class="yj-tooltip yj-tooltip-default yj-tooltip-with-default-arrows">\n          <div class="yj-tooltip-icon yamicon yamicon-up-arrow"></div>\n          <div class="yj-tooltip-container">{{private_tooltip}}</div>\n        </div>\n      </div>\n      <div class="pipe"></div>\n      {{/is_private}}\n      {{#is_official}}\n      <OfficialBadge />\n      <div class="pipe"></div>\n      {{/is_official}}\n      <div class="yj-about-file--header-uploader">{{{uploader_link}}}{{#isOwner}} ({{owner}}){{/isOwner}}</div>\n      {{^is_readonly}}\n      <div class="pipe"></div>\n      <div class="yj-about-file--header-uploaded" title="{{uploaded_date}}">{{uploaded_ago}}</div>\n      {{/is_readonly}}\n    </div>\n  </div>\n  {{^is_readonly}}\n  <div class="yj-about-file--header-actions">\n    {{#show_share}}<ShareButton />{{/show_share}}\n    <FollowButton />\n  </div>\n  {{/is_readonly}}\n</div>\n{{^is_readonly}}\n{{^version_warning}}\n{{#is_not_other}}\n<DescriptionEditor/>\n{{/is_not_other}}\n{{/version_warning}}\n{{/is_readonly}}\n{{#version_warning}}\n<div class="yj-about-file--header-version-warning">{{{version_warning}}}</div>\n{{/version_warning}}\n{{#is_readonly}}\n<div class="yj-about-file--header-readonly">\n  <i class="yamicon yamicon-empty-circle-italic"></i> <span>{{readonly_warning}}</span>\n</div>\n{{/is_readonly}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/file/header",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/hovercard_link/index","components/share_button/index","common-ui/lib/ui/shared/follow_button","components/official_badge/index","models/user","core/lib/urls","core/lib/tr","core/lib/date_helper","core/lib/yammer_api","core/lib/filename_helper","components/editable_file_description/index","models/helpers/group","collections/group_memberships","core/lib/session","models/helpers/file","models/network","components/file_thumbnail/index","css!./header","html!./header"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("components/hovercard_link/index"),f=a("components/share_button/index"),g=a("common-ui/lib/ui/shared/follow_button"),h=a("components/official_badge/index"),i=a("models/user"),j=a("core/lib/urls"),k=a("core/lib/tr"),l=a("core/lib/date_helper"),m=a("core/lib/yammer_api"),n=a("core/lib/filename_helper"),o=a("components/editable_file_description/index"),p=a("models/helpers/group"),q=a("collections/group_memberships"),r=a("core/lib/session"),s=a("models/helpers/file"),t=a("models/network"),u=a("components/file_thumbnail/index");
a("css!./header");var v=a("html!./header"),w=function(a){return a.owner_id===a.last_uploaded_by_id},x=function(a){return"Other"===a.content_class};return b.extend({mixins:[c,d],template:v,views:{GroupLink:"_getGroupLink",UploaderHovercardLink:"_getUploaderLink",ShareButton:"_getShareButton",FollowButton:"_getFollowButton",OfficialBadge:"_getOfficialBadge",DescriptionEditor:"_getDescriptionEditor",FileThumbnail:"_getFileThumbnail"},events:{"blur .yj-about-file--header-title-edit":"_updateFileTitle"},className:"yj-about-file--header",getTemplateData:function(){var a,b=this.model.last_uploaded_at,c=n.getFileIconClass(this.model.name),d=n.getFileIconClassAltText(c),e=s.isReadOnly(this.model,r,q);return e&&(a=t.findById(this.model.network_id)),{group_link:k.t("about_file_title",{link:a&&a.name||"<GroupLink />"}),files_link_href:j.groupFiles(this.options.group),files_link_text:k.t("about_file_link_files"),title:this.model.full_name,is_private:p.isPrivate(this.options.group),is_official:this.model.official,owner:k.t("about_file_owner"),isOwner:w(this.model),uploader_link:k.t("about_file_uploaded_by",{user:'<UploaderHovercardLink key="{$0}" />',uploader_id:this.model.last_uploaded_by_id||this.model.owner_id}),uploaded_date:l.formatDateTime(new Date(b)),uploaded_ago:k.t("about_file_uploaded_ago",{date:l.formatMonthsAgo(new Date(b))}),show_share:!s.isForeign(this.model,r)&&!this.options.version,private_tooltip:k.t("about_file_private_group_tooltip"),file_link_href:j.fileIndex(this.model),file_link_text:this.model.name,show_breadcrumbs:!this._isCurrent(),subpage_title:this.options.subpage_title,title_label:k.t("title"),icon_alt_text:d,is_not_other:!x(this.model),version_warning:this.options.version_warning,is_readonly:e,readonly_warning:k.t("file_read_only")}},_isCurrent:function(){return!this.options.version||this.options.version===this.model.latest_version_id},_getFileThumbnail:function(){return new u({model:this.model})},_getOfficialBadge:function(){return new h({model:this.model})},_getGroupLink:function(){return new e({model:this.options.group})},_getUploaderLink:function(a){return new e({model:i.findById(a)})},_getShareButton:function(){return new f({model:this.model,group:this.options.group})},_getFollowButton:function(){return new g({model:this.model})},_updateFileTitle:function(a){this.model.name=this.model.title=a.target.value,m.updateFileTitle({id:this.model.id,name:a.target.value})},_getDescriptionEditor:function(){return new o({model:this.model})}})}),define("css!workfeed/lib/app/views/file/index",[],function(){}),define("stache!workfeed/lib/app/views/file/index",["mustache"],function(a){var b='{{^loading}}\n<Header key="{{model}}"/>\n<div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n  <div class="yk-row">\n    <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n      <div class="yj-selector-left-col yj-wide yj-scrollbar-fix">\n       {{#is_image}}\n        <div class="yj-about-file--file-container" data-qaid="preview">\n          <img class="yj-about-file--image" src="{{preview_url}}" title="{{title}}" alt="{{description}}"/>\n        </div>\n        {{/is_image}}\n        {{#is_document}}\n        <div class="content-redesign">\n          <div class="file-contents yj-clearfix file-contents-document">\n            <div class="file-preview--wac-preview-link">\n              <div class="large-file-icon"><FileThumbnail /></div>\n              <a href="javascript://" class="fullscreen-link">{{preview_label}}</a>\n            </div>\n            <iframe class="yj-about-file--document file-doc" src="{{preview_url}}"/>\n          </div>\n        </div>\n        {{/is_document}}\n        {{#is_video}}<div class="yj-about-file--video"></div>{{/is_video}}\n        {{#is_other}}\n        <div class="file-contents yj-clearfix yj-about-file--other">\n          <div class="large-file-icon">{{{icon}}}</div>\n          <DescriptionEditor/>\n        </div>\n        {{/is_other}}\n        {{^is_readonly}}\n        {{#is_current}}\n        <div class="yj-about-file--topics-container"><Topics /></div>\n        <div class="yj-about-file--feed-container"><Feed /></div>\n        {{/is_current}}\n        {{/is_readonly}}\n      </div>\n    </div>\n    <div class="yj-about-file--right-sidebar-container">\n      <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6">\n        <Actions key="{{model}}"/>\n        {{^is_readonly}}\n        {{#is_current}}\n        <RelatedContent />\n        <Followers />\n        {{/is_current}}\n        <VersionHistory key="{{model}}"/>\n        {{/is_readonly}}\n      </div>\n    </div>\n  </div>\n</div>\n{{/loading}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/file/index",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/sidebar_actions/index","components/sidebar_actions/src/strategies/file","components/sidebar_history/src/strategies/file","components/sidebar_followers/index","components/sidebar_history/index","components/sidebar_related_content/index","models/uploaded_file","models/group","models/user","models/network","components/attachment_feed/index","workfeed/lib/app/helpers/layout","core/lib/tr","core/lib/yammer_api","feeds/lib/ui/util/title_updater","feeds/lib/ui/attachments/content_topics","models/helpers/group","core/lib/location_helper","core/lib/yammer_uri","core/lib/session","models/helpers/user","models/helpers/file","./header","feeds/lib/ui/attachments/yamio_preview","backbone","feeds/lib/modules/attachments","components/editable_file_description/index","core/lib/date_helper","collections/group_memberships","components/file_thumbnail/index","css!./index","html!./index"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/sidebar_actions/index"),g=a("components/sidebar_actions/src/strategies/file"),h=a("components/sidebar_history/src/strategies/file"),i=a("components/sidebar_followers/index"),j=a("components/sidebar_history/index"),k=a("components/sidebar_related_content/index"),l=a("models/uploaded_file"),m=a("models/group"),n=a("models/user"),o=a("models/network"),p=a("components/attachment_feed/index"),q=a("workfeed/lib/app/helpers/layout"),r=a("core/lib/tr"),s=a("core/lib/yammer_api"),t=a("feeds/lib/ui/util/title_updater"),u=a("feeds/lib/ui/attachments/content_topics"),v=a("models/helpers/group"),w=a("core/lib/location_helper"),x=a("core/lib/yammer_uri"),y=a("core/lib/session"),z=a("models/helpers/user"),A=a("models/helpers/file"),B=a("./header"),C=a("feeds/lib/ui/attachments/yamio_preview"),D=a("backbone"),E=a("feeds/lib/modules/attachments"),F=a("components/editable_file_description/index"),G=a("core/lib/date_helper"),H=a("collections/group_memberships"),I=a("components/file_thumbnail/index");a("css!./index");var J=a("html!./index"),K={404:r.t("about_file_not_found"),403:r.t("about_file_forbidden"),default:r.t("about_file_forbidden")},L=function(a){var b=[].concat(a.references||[],a.external_references||[]);b.forEach(function(a){var b,c;"user"===a.type&&(b=n.findById(a.id),b||n.save(a)),"network"===a.type&&(c=o.findById(a.id),c||o.save(a))})},M=function(a){for(var b=[].concat(a.references||[],a.external_references||[]),c=0;c<b.length;c++){var d=b[c];if("group"===d.type&&d.id===a.files[0].group_id)return new m(d)}return m.ALL_COMPANY()},N=function(a){var c=[].concat(a.references||[],a.external_references||[]);return c.filter(function(a){return"topic"===a.type}).map(function(a){return a.name=b.escape(a.name),a})},O=function(a){return"Image"===a.content_class},P=function(a){return"Video"===a.content_class},Q=function(a){return!A.canViewInO365(a)&&"Other"===a.content_class},R=function(a,c){for(var d=0;d<a.versions.length;d++)if(a.versions[d].id===c)return b.extend({},a,a.versions[d],{id:a.id,versionId:c});return a},S=function(a){D.trigger("/ui/alert/show","error",a),w.replace(x.app("/#/home"))};return c.extend({mixins:[d,e],template:J,events:{"click .fullscreen-link":"_onClickPreview"},views:{Header:"_getHeader",FileThumbnail:"_getFileThumbnail",Followers:"_getFollowers",VersionHistory:"_getVersionHistory",Actions:"_getActions",RelatedContent:"_getRelatedContent",Feed:"_getFeed",Topics:"_getTopics",DescriptionEditor:"_getDescriptionEditor"},className:q.twoColumnMainClass,attributes:{role:"main"},initialize:function(){var a=y.getCurrentUser().web_preferences.network_settings.allow_attachments;return JSON.parse(a)?(b.bindAll(this,"_getMetadata","_processMetadata","_fetchFile"),this.group=this.options.group,this._loaded()||this._fetchFile(),D.on("/ui/lightbox/close",this._fetchFile),void t.setTitle("")):S(r.t("about_file_network_settings"))},getTemplateData:function(){var a={loading:!0};if(!this._loaded())return a;var c=R(this.model,this.options.version);return P(c)&&b.defer(this._playVideo.bind(this,c),0),{model:JSON.stringify(b.pick(c,"id","official","latest_version_id")),is_image:O(c),preview_url:c.preview_url,is_document:A.canViewInO365(c),title:c.full_name,description:c.description,preview_label:r.t("about_file_preview_document"),is_video:P(c),is_other:Q(c),is_current:this._isCurrent(),is_readonly:A.isReadOnly(this.model,y,H)}},_loaded:function(){return!(!this.model||!this.group)},_isCurrent:function(){return!this.options.version||this.options.version===this.model.latest_version_id},_getHeader:function(){var a=R(this.model,this.options.version);return new B({model:this.model,group:this.group,subpage_title:r.t("compare_file_breadcrumb"),version_warning:!this._isCurrent()&&r.t("compare_file_warning",{date:G.formatYearDateTime(new Date(a.created_at))}),version:this.options.version})},_getFileThumbnail:function(){return new I({model:this.model})},_getFollowers:function(){return new i({model:this.model})},_getVersionHistory:function(){return new j({model:this.model,strategy:h,version:this.options.version})},_fetchFile:function(){this._getMetadata().then(this._processMetadata).fail(function(a){S(K[a.status]||K.default)})},_getMetadata:function(){return s.getUploadedFile({id:this.options.fileId,include_featured_users:!0})},_processMetadata:function(a){this.model=l.create(a.files[0]),this.model.preview_url+="?_t="+Date.now(),this.model.thumbnail_url+="?_t="+Date.now(),this.group=M(a),t.setTitle(r.t("about_note_page_title",{note_title:this.model.name,group:v.getFullName(this.group)}),{announce:!0}),this._topics=N(this.model),L(a);var b=a.meta.followed_file_ids||[];-1!==b.indexOf(this.model.id)?z.followFile(y.getCurrentUser(),this.model.id):z.unfollowFile(y.getCurrentUser(),this.model.id),this.render()},_getActions:function(){var a=new f({model:this.model,group:this.group,strategy:g,version:this.options.version});return this.listenTo(a,"change",this.render),a},_getRelatedContent:function(){return new k({model:this.model,group:this.group})},_getTopics:function(){return new u({data:{file_id:this.model.id,topics:this._topics},removeTopicCall:s.removeFileTopic,addTopicCall:s.addFileTopic})},_getFeed:function(){return new p({model:this.model,group:this.group})},_getDescriptionEditor:function(){return new F({model:this.model})},_onClickPreview:function(){if(this.model.transcoded){var a="video-player/"+this.model.id+"/fullscreen";D.trigger(a)}else C.showOverlayForAttachment(this.model)},_playVideo:function(a){E.playVideoInContainer($(".yj-about-file--video"),a,{width:"100%",height:"100%",autostart:!1})},remove:function(){return D.off("/ui/lightbox/close",this._fetchFile),c.prototype.remove.call(this)}})}),define("common-ui/lib/ui/general/delete_ogo_confirmation",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","backbone","core/lib/yammer_api","html!./delete_confirmation"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("backbone"),f=a("core/lib/yammer_api"),g=a("html!./delete_confirmation");return b.extend({mixins:[c],events:{"click #cancel-action":"_cancelDelete","click #confirm-action":"_confirmDelete"},className:"yj-colorbox",template:g,initialize:function(a){this._confirmCallback=a.confirmCallback,this.itemId=a.itemId},getTemplateData:function(){return{negative_action:d.t("dont_delete"),positive_action:d.t("delete"),confirm_message:d.t("delete_ogo_warning_confirm")}},_confirmDelete:function(){f.deleteOpenGraphObject({ogo_id:this.itemId}).then(this._confirmCallback,function(){e.trigger("/ui/alert/show","error",d.t("there_was_an_error_deleting_your_ogo"))}),e.trigger("/ui/lightbox/close")},_cancelDelete:function(){e.trigger("/ui/lightbox/close")}})}),define("components/sidebar_actions/src/strategies/ogo",["require","common-ui/lib/ui/general/delete_ogo_confirmation","common-ui/lib/ui/general/lightbox_manager","backbone","core/lib/location_helper","core/lib/tr","core/lib/yammer_uri","core/lib/session","models/helpers/user"],function(a){"use strict";var b=a("common-ui/lib/ui/general/delete_ogo_confirmation"),c=a("common-ui/lib/ui/general/lightbox_manager"),d=a("backbone"),e=a("core/lib/location_helper"),f=a("core/lib/tr"),g=a("core/lib/yammer_uri"),h=a("core/lib/session"),i=a("models/helpers/user"),j=function(){var a=h.getCurrentUser(),b=a.id===this.model.get("creator_id"),c=i.isAdmin(a),d=b||c;return{hasActions:d,actions_header:f.t("sidebar_ogo_ogo_actions"),delete_label:f.t("sidebar_actions_delete_ogo"),can_delete:d}},k=function(){var a=new b({itemId:this.model.get("realId")||this.model.id,confirmCallback:function(){e.replace(g.app("/#/home")),d.trigger("/ui/alert/show","notice",f.t("the_ogo_has_been_deleted"))}});c.openComponent(a,"",null,{title:f.t("delete_ogo_warning_confirm_title"),width:"370"})};return{actions:{DELETE:k},getTemplateData:j}}),define("css!workfeed/lib/app/views/ogo/header",[],function(){}),define("stache!workfeed/lib/app/views/ogo/header",["mustache"],function(a){var b='<div class="yj-about-ogo--header-breadcrumbs">\n</div>\n<div class="yj-about-file--header-row">\n  {{#icon}}\n  <div class="yj-about-ogo--header-icon">\n    <div class="yj-about-ogo--header-img" style="background-image: url({{icon}})"></div>\n    <span class="yj-acc-hidden">{{icon_alt_text}}</span>\n  </div>\n  {{/icon}}\n  <div class="yj-about-ogo--header-display-name" data-qaid="header-name">\n    <div class="yj-about-ogo--header-title">{{title}}</div>\n    <div class="yj-about-ogo--header-details">\n      <div class="yj-about-ogo--header-description">{{description}}</div><div class="pipe"></div><div class="yj-about-ogo--header-uploaded" title="{{created_date}}">{{created_at}}</div>\n      <a href="{{web_url}}" class="yj-about-ogo--header-url">{{web_url}}</a>\n    </div>\n  </div>\n  <div class="yj-about-ogo--header-actions">\n    <ShareButton />\n    <FollowButton />\n  </div>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/ogo/header",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/share_button/index","common-ui/lib/ui/shared/follow_button","core/lib/tr","core/lib/date_helper","core/lib/string_helper","css!./header","html!./header"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/share_button/index"),g=a("common-ui/lib/ui/shared/follow_button"),h=a("core/lib/tr"),i=a("core/lib/date_helper"),j=a("core/lib/string_helper");a("css!./header");var k=a("html!./header");return c.extend({mixins:[d,e],template:k,views:{ShareButton:"_getShareButton",FollowButton:"_getFollowButton"},className:"yj-about-ogo--header",getTemplateData:function(){var a=this.model.get("created_at");return{title:this.model.get("full_name"),created_date:i.formatDateTime(new Date(a)),created_at:h.t("about_ogo_created_at",{date:i.formatMonthsAgo(new Date(a))}),title_label:h.t("title"),icon:this.model.get("image"),description:this._getDescription(),web_url:this.model.get("web_url")}},_getDescription:function(){var a=j.capitalize(this.model.get("object_type"));return a+" ("+this.model.get("site_name")+")"},_getShareButton:function(){return new f({model:b.extend({},this.model.toJSON(),{id:this.model.get("realId")})})},_getFollowButton:function(){return new g({model:b.extend({},this.model.toJSON(),{id:this.model.get("realId")})})}})}),define("css!workfeed/lib/app/views/ogo/index",[],function(){}),define("stache!workfeed/lib/app/views/ogo/index",["mustache"],function(a){var b='{{^loading}}\n<Header />\n<div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n  <div class="yk-row">\n    <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n      <div class="yj-selector-left-col yj-wide yj-scrollbar-fix">\n      <!-- The following is one line otherwise CSS :empty wont work :( -->\n      <div class="yj-about-ogo--preview">{{#is_video}}<iframe width="600" height="338" src="{{video_url}}" frameborder="0" allowfullscreen></iframe>{{/is_video}}{{^is_video}}{{#is_image}}<img src="{{image_url}}" alt=""/>{{/is_image}}{{/is_video}}{{#description}}<div class="yj-about-ogo--description">{{description}}</div>{{/description}}</div>\n      <div class="yj-about-ogo--feed-container"><Feed /></div>\n      </div>\n    </div>\n    <div class="yj-about-ogo--right-sidebar-container">\n      <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6">\n        <Actions />\n        <Followers />\n      </div>\n    </div>\n  </div>\n</div>\n{{/loading}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/ogo/index",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","components/sidebar_actions/index","components/sidebar_actions/src/strategies/ogo","components/sidebar_followers/index","models/ogo","components/attachment_feed/index","workfeed/lib/app/helpers/layout","core/lib/tr","core/lib/yammer_api","feeds/lib/ui/util/title_updater","core/lib/location_helper","core/lib/yammer_uri","./header","models/group","core/lib/session","models/helpers/user","backbone","css!./index","html!./index"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("components/sidebar_actions/index"),g=a("components/sidebar_actions/src/strategies/ogo"),h=a("components/sidebar_followers/index"),i=a("models/ogo"),j=a("components/attachment_feed/index"),k=a("workfeed/lib/app/helpers/layout"),l=a("core/lib/tr"),m=a("core/lib/yammer_api"),n=a("feeds/lib/ui/util/title_updater"),o=a("core/lib/location_helper"),p=a("core/lib/yammer_uri"),q=a("./header"),r=a("models/group"),s=a("core/lib/session"),t=a("models/helpers/user"),u=a("backbone");a("css!./index");var v=a("html!./index"),w={404:l.t("about_ogo_not_found"),default:l.t("about_ogo_not_found")},x=function(a){u.trigger("/ui/alert/show","error",a),o.replace(p.app("/#/home"))};return c.extend({mixins:[d,e],template:v,views:{Header:"_getHeader",Followers:"_getFollowers",Actions:"_getActions",Feed:"_getFeed"},className:k.twoColumnMainClass,attributes:{role:"main"},initialize:function(){b.bindAll(this,"_getMetadata","_processMetadata","_fetchOgo"),this._loaded()||this._fetchOgo()},getTemplateData:function(){var a={loading:!0};return this._loaded()?{is_image:"image"===this.model.get("media_type"),is_video:!!this.model.get("video_url"),image_url:this.model.get("media_url"),description:this.model.get("description"),video_url:this.model.get("video_url")}:a},_loaded:function(){return!!this.model},_getHeader:function(){return new q({model:this.model})},_getFollowers:function(){return new h({model:this.model.toJSON()})},_fetchOgo:function(){this._getMetadata().then(this._processMetadata).fail(function(a){x(w[a.status]||w.default)})},_getMetadata:function(){return m.getOpenGraphObject({id:this.options.ogoId,include_featured_users:!0,url:"dummy"})},_processMetadata:function(a){this.model=new i(a),n.setTitle(a.full_name),this.model.get("following")?t.followOgo(s.getCurrentUser(),this.options.ogoId):t.unfollowOgo(s.getCurrentUser(),this.options.ogoId),this.render()},_getActions:function(){return new f({model:this.model,group:r.ALL_COMPANY(),strategy:g})},_getFeed:function(){return new j({model:this.model,group:r.ALL_COMPANY()})}})}),define("stache!workfeed/lib/app/views/user_profile/action_tabs",["mustache"],function(a){var b='<div class="yj-action-bar-with-tabs">\n  <div class="yj-action-bar-tabs">\n    <ul class="yj-tabs">\n      <li class="yj-filter-tab yj-selected" data-from-user-type="from_user">\n        <a href="{{userPath}}" class="yj-filter-tab-link" data-user>\n          {{conversations}}\n          <span class="yj-acc-hidden">{{tab}}</span>\n          <span class="yj-acc-selectedstate">{{selected}}</span>\n        </a>\n      </li>\n      \n      {{#infoTab}}\n        <li class="yj-filter-tab" data-from-user-type="info">\n          <a href="{{infoPath}}" class="yj-filter-tab-link">\n            {{info}}\n            <span class="yj-acc-hidden">{{tab}}</span>\n            <span class="yj-acc-selectedstate">{{selected}}</span>\n          </a>\n        </li>\n      {{/infoTab}}\n\n      <li class="yj-filter-tab" data-from-user-type="files">\n        <a href="{{filesPath}}" class="yj-filter-tab-link">\n          {{files}}\n          <span class="yj-acc-hidden">{{tab}}</span>\n          <span class="yj-acc-selectedstate">{{selected}}</span>\n        </a>\n      </li>\n\n      <li class="yj-filter-tab" data-from-user-type="images">\n        <a href="{{imagesPath}}" class="yj-filter-tab-link">{{images}}\n          <span class="yj-acc-hidden">{{tab}}</span>\n          <span class="yj-acc-selectedstate">{{selected}}</span>\n        </a>\n      </li>\n\n      <li class="yj-filter-tab" data-from-user-type="videos">\n        <a href="{{videosPath}}" class="yj-filter-tab-link">{{videos}}\n          <span class="yj-acc-hidden">{{tab}}</span>\n          <span class="yj-acc-selectedstate">{{selected}}</span>\n        </a>\n      </li>\n\n      {{#isCurrentUser}}\n        <li class="yj-filter-tab" data-from-user-type="bookmarked_by">\n          <a href="{{bookmarkPath}}" class="yj-filter-tab-link">{{bookmarks}}\n            <span class="yj-acc-hidden">{{tab}}</span>\n            <span class="yj-acc-selectedstate">{{selected}}</span>\n          </a>\n        </li>\n      {{/isCurrentUser}}\n\n      {{#moreMenu}}\n        <li class="yj-tab-more yj-filter-tab yj-click-menu-trigger" data-attach-menu="true">\n          <a href="javascript://" class="yj-filter-tab-link" role="button" aria-haspopup="true"> \n            <small class="yj-down-arrow" aria-hidden="true">&#9660;</small>\n          </a>\n          <ul class="yj-tab-dropdown yj-menu yj-menu-shadow yj-click-menu yj-click-menu-content">\n\n          </ul>\n        </li>\n      {{/moreMenu}}\n    </ul>\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/action_tabs",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","core/lib/session","models/helpers/user","core/lib/yammer_uri","core/lib/namespace","html!./action_tabs"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g=a("core/lib/session"),h=a("models/helpers/user"),i=a("core/lib/yammer_uri"),j=a("core/lib/namespace"),k={conversations:f.t("group_tab_conversations_label"),tab:f.t("group_tab_label"),selected:f.t("group_tab_selected_label"),info:f.t("group_tab_info_label"),files:f.t("group_tab_files_label"),images:f.t("images"),videos:f.t("videos"),bookmarks:f.t("bookmarks")};return c.extend({mixins:[d,e],template:a("html!./action_tabs"),className:"yj-user-profile--action-bar-tabs",getTemplateData:function(){var a=j.val(g.getCurrentNetwork(),"profile_fields_config.enable_work_history"),c=j.val(g.getCurrentNetwork(),"profile_fields_config.enable_education"),d=this.model.previous_companies.length>0,e=this.model.schools.length>0,f=a&&d||c&&e,l=j.val(this.model,"web_preferences.network_settings.allow_attachments");return b.extend({infoTab:f,isCurrentUser:h.isCurrentUser(this.model,g),allowAttachments:l,userPath:i.app("/#/users/"+this.model.id),infoPath:i.app("/#/users/"+this.model.id+"/info"),filesPath:i.app("/#/users/"+this.model.id+"/files"),imagesPath:i.app("/#/users/"+this.model.id+"/images"),videosPath:i.app("/#/users/"+this.model.id+"/videos"),bookmarkPath:i.app("/#/users/"+this.model.id+"/bookmarked")},k)},render:function(){this._tabArranger()},_tabArranger:function(){var a=this.$(".yj-action-bar-with-tabs li"),b=this.options.currentTab;a.removeClass("yj-selected"),a.filter("[data-from-user-type="+b+"]").addClass("yj-selected")}})}),define("stache!workfeed/lib/app/views/user_profile/header",["mustache"],function(a){var b='<div class="page-header-container yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block">\n  <div class="page-header profile {{^isForeign}}has-tabs{{/isForeign}} {{#isForeign}}foreign-page-header{{/isForeign}} {{#isAdmin}}is-admin{{/isAdmin}} two-actions" role="region">\n\n  <div class="header-actions">\n    {{#isOtherActiveUser}}\n      <button class="yj-btn yj-btn-alt message-btn yj-chat-button yj-btn-profile-inline" role="button">\n        <span>{{sendMessage}}</span>\n      </button>\n      {{^isForeign}}\n        <div class="follow-links-container">\n          <FollowButton key="user_profile_follow_button" />\n        </div>\n      {{/isForeign}}\n    {{/isOtherActiveUser}}\n    \n    {{#isCurrentUser}}\n      <a href="{{editProfileUrl}}" class="yj-btn yj-btn-alt yj-edit-profile">\n        <span class="yamicon yamicon-pencil" style="padding-right: 4px"></span>{{editProfile}}\n      </a>\n    {{/isCurrentUser}}\n  </div>\n  {{^isForeign}}\n    <div class="thumbnail">\n      <a href="{{mugshot_url}}" title="{{viewImage}}" class="tightbox avatar">\n        <Avatar key="user_profile_avatar" />\n      </a>\n    </div>\n  {{/isForeign}}\n  {{#isForeign}}\n    <div class="thumbnail tightbox avatar">\n      <Avatar key="user_profile_avatar" />\n    </div>\n  {{/isForeign}}\n  <div class="header-content">\n    <div class="header-cell-container">\n      <div class="header-cell">\n        <h2>{{userFullName}}</h2>\n\n        {{^isForeign}}\n          {{#isInactive}}\n            <p>{{formerMember}}\n              {{#userJobTitle}}\n                ({{userJobTitle}})\n              {{/userJobTitle}}\n            </p>\n          {{/isInactive}}\n          {{^isInactive}}\n            <p class="title" title="{{userJobTitle}}">\n              {{userJobTitle}}\n            </p>\n            {{#isAdmin}}\n              <div class="yj-admin-badge--user-profile">\n                {{{svgIconAdmin}}} {{admin}}\n              </div>\n            {{/isAdmin}}\n          {{/isInactive}}\n        {{/isForeign}}\n\n        {{#isForeign}}\n          <p class="network-name">\n            <span class="network-icon yamicon yamicon-network">\n              <span class="yj-acc-hidden">{{foreignNetworkIconAltText}}</span>\n            </span>\n            {{networkName}}\n          </p>\n          {{#userJobTitle}}\n            <p class="job-title">\n              {{userJobTitle}}\n            </p>\n          {{/userJobTitle}}\n          {{#userEmail}}\n            <p class="email">\n              <label class="email-label">{{email}}:</label>\n              {{userEmail}}\n            </p>\n          {{/userEmail}}\n        {{/isForeign}}\n      </div>\n    </div>\n  </div>\n  {{^isForeign}}\n    <UserProfileActionTabs key="user_profile_action_tabs" />\n  {{/isForeign}}\n</div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/header",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./action_tabs","common-ui/lib/ui/shared/follow_button","models/message_backbone","models/recipient","components/avatar/src/avatar","models/network","models/user","core/lib/tr","core/lib/session","common-ui/lib/helper/svg_icon","models/helpers/user","feeds/lib/ui/publisher/global/publisher_helper","core/lib/yammer_uri","html!./header"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("./action_tabs"),g=a("common-ui/lib/ui/shared/follow_button"),h=a("models/message_backbone"),i=a("models/recipient"),j=a("components/avatar/src/avatar"),k=a("models/network"),l=a("models/user"),m=a("core/lib/tr"),n=a("core/lib/session"),o=a("common-ui/lib/helper/svg_icon"),p=a("models/helpers/user"),q=a("feeds/lib/ui/publisher/global/publisher_helper"),r=a("core/lib/yammer_uri"),s={admin:m.t("admin"),sendMessage:m.t("send_message"),viewImage:m.t("group_mugshot_title"),viewImageLarge:m.t("group_mugshot_large_title"),formerMember:m.t("former_member"),editProfile:m.t("signup_edit_profile_label"),foreignNetworkIconAltText:m.t("foreignNetworkIconAltText"),email:m.t("email")};return c.extend({mixins:[d,e],template:a("html!./header"),views:{UserProfileActionTabs:"_getActionTabs",Avatar:"_getAvatar",FollowButton:"_getFollowButton"},events:{"click .yj-chat-button":"_openChat"},className:"yj-user-profile--header",getTemplateData:function(){var a=p.isCurrentUser(this.model,n),c=p.isActive(this.model),d=this.options.isForeign;return b.extend({isAdmin:p.isAdmin(this.model),isForeign:d,svgIconAdmin:o("avatar-badge-admin",{width:16,height:16}),isCurrentUser:a,isOtherActiveUser:!a&&c||d,isInactive:!c,mugshot_url:this.model.mugshot_url_template.replace("/{width}x{height}",""),userFullName:p.getUserName(this.model),userJobTitle:this.model.job_title,userEmail:d?this.model.email:p.getPrimaryEmailAddress(this.model),editProfileUrl:r.app("account/profile_info?from=profile_info_edit"),adminDirectoryUrl:r.app("admin/directory"),adminNetwork:m.t("admin_network",{user:p.getUserName(this.model),network:n.getCurrentNetwork().name,link:r.app("admin/directory")}),networkName:p.getNetworkName(this.model,k)},s)},_getAvatar:function(){var a,b=p.isAdmin(this.model);return b?a="admin":this.model.is_new_user&&(a="new"),new j({model:this.model,withHovercard:!1,hideFromAccessibility:!1,size:75,badge:a})},_getFollowButton:function(){return new g({model:this.model})},_getActionTabs:function(){return new f({model:this.model,currentTab:this.options.currentTab})},_openChat:function(){var a=yam.ui.chatManager,b=l.findById(this.model.id);if(b||l.save(this.model),a&&n.getUserSetting("enable_chat"))a.handleContact(this.model);else{var c=new h,d=c.get("recipients");d.add(i.fromOriginalModel(this.model)),q.openComposeLightbox(c,"profile")}return!1}})}),define("css!workfeed/lib/app/sidebar/user_profile_about",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_about",["mustache"],function(a){var b='<h2 class="yj-user-profile--about-header">\n  {{heading}}\n</h2>\n\n<div class="yj-user-profile--about-summary">\n  {{{summary}}}\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_about",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","common-ui/lib/helper/html_truncator","core/lib/tr","css!./user_profile_about","html!./user_profile_about"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("common-ui/lib/helper/html_truncator"),e=a("core/lib/tr");a("css!./user_profile_about");var f=b.extend({className:"yj-user-profile--about",mixins:[c],template:a("html!./user_profile_about"),
events:{"click .expand-body":function(){this.$(".remaining-body").show(),this.$(".expand-body").hide(),this.$(".collapse-body").show(),this.$(".truncated-body").hide()},"click .collapse-body":function(){this.$(".remaining-body").hide(),this.$(".expand-body").show(),this.$(".collapse-body").hide(),this.$(".truncated-body").show()}},getTemplateData:function(){var a=this.model,b={length:500,ellipsis:"..."},c=d.truncateWithLink(a.summary,b);return{summary:c,heading:e.t("about_name",{name:a.first_name})}}});return f}),define("css!workfeed/lib/app/sidebar/user_profile_info",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_info",["mustache"],function(a){var b='<div class="yj-header-extra-link">\n  <h2 class="yj-user-profile--groups-header">\n    <span>{{heading}}</span>\n  </h2>\n  <a class="see-all-link" href="{{vcard_url}}">{{vcard_label}}</a>\n</div>\n\n{{#department}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{department_label}}</span>\n  <span class="yj-user-profile-info-value">{{department}}</span>\n</p>\n{{/department}}\n\n{{#location}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{location_label}}</span>\n  <span class="yj-user-profile-info-value">{{location}}</span>\n</p>\n{{/location}}\n\n{{#significant_ospaner}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{significant_ospaner_label}}</span>\n  <span class="yj-user-profile-info-value">{{significant_ospaner}}</span>\n</p>\n{{/significant_ospaner}}\n\n{{#kids_names}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{kids_names_label}}</span>\n  <span class="yj-user-profile-info-value">{{kids_names}}</span>\n</p>\n{{/kids_names}}\n\n{{#birspan_date}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{birspan_date_label}}</span>\n  <span class="yj-user-profile-info-value">{{birspan_date}}</span>\n</p>\n{{/birspan_date}}\n\n{{#expertise}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{expertise_label}}</span>\n  <span class="yj-user-profile-info-value">{{expertise}}</span>\n</p>\n{{/expertise}}\n\n{{#interests}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{interests_label}}</span>\n  <span class="yj-user-profile-info-value">{{interests}}</span>\n</p>\n{{/interests}}\n\n{{#email}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{email_label}}</span>\n  <span class="yj-user-profile-info-value">\n    <a class="yj-user-profile-info-value--website" href="mailto:{{email}}" title="{{email}}">{{email}}</a>\n  </span>\n</p>\n{{/email}}\n\n{{#inviter}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{inviter_label}}</span>\n  <span class="yj-user-profile-info-value"><a class="yj-user-profile-info-value--website yj-user-profile--short-width" href="{{inviter_url}}">{{full_name}}</a></span>\n</p>\n{{/inviter}}\n\n{{#work}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{work_label}}</span>\n  <span class="yj-user-profile-info-value yj-user-profile-info-value--work">{{work}}</span>\n</p>\n{{/work}}\n\n{{#mobile}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{mobile_label}}</span>\n  <span class="yj-user-profile-info-value">{{mobile}}</span>\n</p>\n{{/mobile}}\n\n{{#im}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{im_provider}}:</span>\n  <span class="yj-user-profile-info-value">\n    {{#im_is_aim}}<a class="yj-user-profile-info-value--website" href="aim:goim?screenname={{im}}">{{im}}</a>{{/im_is_aim}}\n    {{^im_is_aim}}{{im}}{{/im_is_aim}}\n  </span>\n</p>\n{{/im}}\n\n{{#twitter}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{twitter_label}}</span>\n  <span class="yj-user-profile-info-value">\n    <a class="yj-user-profile-info-value--website" href="http://www.twitter.com/{{twitter}}" target="_blank">{{twitter}}</a>\n  </span>\n</p>\n{{/twitter}}\n\n{{#skype}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{skype_label}}</span>\n  <span class="yj-user-profile-info-value">{{skype}}</span>\n</p>\n{{/skype}}\n\n{{#has_websites}}\n<p class="yj-user-profile--section">\n  <span class="yj-user-profile-info-key">{{websites_label}}</span>\n  <span class="yj-user-profile-info-value">\n    <ul class="yj-users-profile--websites-list">\n      {{#websites}}\n        <li class="yj-users-profile--websites-list-item">\n          <a class="yj-users-profile--websites-link" href="{{url}}" rel="noreferrer" target="_blank" title="{{url}}">\n              {{url}}\n          </a>\n        </li>\n      {{/websites}}\n    </ul>\n  </span>\n</p>\n{{/has_websites}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_info",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/report","core/lib/tr","models/helpers/user","core/lib/urls","models/user","css!./user_profile_info","html!./user_profile_info"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/report"),f=a("core/lib/tr"),g=a("models/helpers/user"),h=a("core/lib/urls");a("models/user"),a("css!./user_profile_info");var i={heading:f.t("info"),vcard_label:f.t("download_vcard"),department_label:f.t("department"),location_label:f.t("location"),significant_other_label:f.t("sig_other"),kids_names_label:f.t("kids_names"),birth_date_label:f.t("birthday"),expertise_label:f.t("expertise"),interests_label:f.t("interests"),email_label:f.t("email_2"),inviter_label:f.t("added_by"),work_label:f.t("work"),mobile_label:f.t("mobile"),twitter_label:f.t("twitter"),skype_label:f.t("skype"),websites_label:f.t("websites")},j=c.extend({className:"yj-user-profile--info",events:{"click .see-all-link":"_clickHandler"},mixins:[d],template:a("html!./user_profile_info"),getTemplateData:function(){var a,c,d={aim:"AIM",gtalk:"GTalk",yahoo:"Yahoo",msn:"MSN",icq:"ICQ",jabber:"Jabber",lync:"Lync"},e=yam.model.User.save(this.model),f=e.external_urls.length,j=new Array(f);for(a=0;f>a;a++)c=e.external_urls[a],j[a]={url:c};return e.inviter_full_name=e.inviter?e.inviter.user.full_name:"",e.inviter_web_url=e.inviter?h.userIndex(e.inviter.user):"",b.extend({full_name:e.inviter_full_name,inviter_url:e.inviter_web_url,vcard_url:"/vcards/"+e.name+"?permalink="+e.name,department:e.department,location:e.location,significant_other:e.significant_other,kids_names:e.kids_names,birth_date:e.birth_date,expertise:e.expertise,interests:e.interests,email:!e.contact.has_fake_email&&g.getPrimaryEmailAddress(e),inviter:e.inviter,work:g.getWorkPhoneNumber(e),mobile:g.getMobilePhoneNumber(e),im:e.contact.im.username,im_provider:d[e.contact.im.provider],im_is_aim:"aim"===e.contact.im.provider,twitter:e.twitter,skype:e.skype,has_websites:j.length>0,websites:j},i)},_clickHandler:function(){e.event("rr_user_profile_info")}});return j}),define("css!workfeed/lib/app/sidebar/user_profile_groups",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_groups",["mustache"],function(a){var b='<h2 class="yj-user-profile--groups-header">\n  <a class="yj-user-profile--groups-header-link" href="javascript://" title="{{see_all_tooltip}}">\n    <span>\n      {{heading}}\n    </span>\n  </a>\n</h2>\n<ul class="yj-users-profile--groups-list">\n  {{#groups}}\n    <li class="yj-users-profile--groups-list-item">\n      <a href="{{web_url}}" class="yj-users-profile--groups-link">\n        <img src="{{mugshot_url}}" class="yj-users-profile--group-mugshot" alt=""/>\n        {{#external}}<span class="yamicon yamicon-network yj-users-profile--group-icon"></span>{{/external}}\n        <span class="yj-users-profile--groups-name">\n          {{full_name}}<NetworkLabel/>\n        </span>\n      </a>\n    </li>\n  {{/groups}}\n</ul>\n\n{{#has_more_groups}}\n<a class="yj-user-profile--groups-see-all" href="javascript://" title="{{see_all_tooltip}}">\n  <span class="yj-users-profile--groups-count">{{more_groups}}</span>\n</a>\n{{/has_more_groups}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_groups",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/report","core/lib/tr","collections/groups","models/group","components/network_label/index","models/helpers/group","core/lib/urls","common-ui/lib/ui/general/lightbox_manager","components/groups_list/index","models/helpers/user","css!./user_profile_groups","html!./user_profile_groups"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/report"),g=a("core/lib/tr"),h=a("collections/groups"),i=a("models/group"),j=a("components/network_label/index"),k=a("models/helpers/group"),l=a("core/lib/urls"),m=a("common-ui/lib/ui/general/lightbox_manager"),n=a("components/groups_list/index"),o=a("models/helpers/user");a("css!./user_profile_groups");var p={heading:g.t("groups"),see_all_label:g.t("see_all_3")};return c.extend({className:"yj-user-profile--groups",events:{"click .group-photo":"_clickHandlerGroupPhoto","click .group-link":"_clickHandlerGroupLink","click .yj-user-profile--groups-header-link":"_clickHandlerSeeAll","click .yj-user-profile--groups-see-all":"_clickHandlerSeeAll"},mixins:[d,e],views:{NetworkLabel:"_getNetworkLabel"},template:a("html!./user_profile_groups"),initialize:function(){this.groups=b.map(this.model.top_groups,function(a){var b=h.get(a.id);return{web_url:b?l.groupIndex(b):l.groupIndex(a),id:a.id,mugshot_url:a.mugshot_url,full_name:a.full_name,count_text:g.t("count_members",{count:a.members}),network_id:a.network_id,network_name:a.network_name,external:b?k.isExternal(b):!1}})},getTemplateData:function(){var a=this.model;return b.extend({has_more_groups:a.groups_count>5,all_groups_count:a.groups_count,see_all_url:"/users/"+a.name+"/groups?lightbox=true",groups:this.groups,see_all_tooltip:g.t("users_groups",{user:a.full_name}),more_groups:g.t("more_groups",{count:a.groups_count})},p)},_getNetworkLabel:function(a){return new j({model:new i(this.groups[a])})},_clickHandlerSeeAll:function(){m.openComponent(new n({fetch:o.getGroups.bind(null,this.model)}),"yj-user-profile--groups-all",void 0,{title:g.t("users_groups",{user:this.model.full_name}),overlayClose:!0,width:580}),f.event("rr_user_profile_groups_list",{event_action:"see-all"})},_clickHandlerGroupLink:function(){f.event("rr_user_profile_groups_list",{event_action:"group-link-click"})},_clickHandlerGroupPhoto:function(){f.event("rr_user_profile_groups_list",{event_action:"group-photo-click"})}})}),define("css!workfeed/lib/app/sidebar/user_profile_home_network",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_home_network",["mustache"],function(a){var b='<h2 class="yj-user-profile--home-network-header">\n  {{heading}}\n</h2>\n<p class="yj-user-profile--home-network-domain">\n  {{domain}}\n</p>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_home_network",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","core/lib/session","css!./user_profile_home_network","html!./user_profile_home_network"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("core/lib/session");a("css!./user_profile_home_network");var f=b.extend({mixins:[c],className:"yj-user-profile--home-network",template:a("html!./user_profile_home_network"),getTemplateData:function(){var a=this.model;return{domain:a.canonical_network_name,heading:e.getCurrentNetwork().community?d.t("home_network"):d.t("related_networks")}}});return f}),define("css!workfeed/lib/app/sidebar/user_profile_networks",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_networks",["mustache"],function(a){var b='<h2 class="yj-user-profile--networks-header">\n  <span>{{heading}}</span>\n</h2>\n<ul class="yj-users-profile--networks-list">\n  {{#networks}}\n    <li class="yj-users-profile--networks-list-item">\n      <a href="{{web_url}}" class="yj-users-profile--networks-link">\n        <img src="{{mugshot_url}}" class="group-photo-img" alt=""/>\n        <span class="yj-users-profile--networks-name">\n          {{name}}\n        </span>\n      </a>\n    </li>\n  {{/networks}}\n</ul>\n\n{{#has_more_networks}}\n  <a class="yj-user-profile--networks-see-all tightbox" href="{{see_all_url}}" title="{{see_all_tooltip}}">\n    <span class="yj-count badge">{{more_networks}}</span>\n  </a>\n{{/has_more_networks}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_networks",["require","underscore","core/lib/report","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","css!./user_profile_networks","html!./user_profile_networks"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/report"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/tr");a("css!./user_profile_networks");var g={heading:f.t("external_networks"),see_all_label:f.t("see_all_3")},h=d.extend({className:"yj-user-profile--networks",events:{"click .see-all-link":"_clickHandlerSeeAll","click .group-photo":"_clickHandlerGroupPhoto","click .group-link":"_clickHandlerGroupLink"},mixins:[e],template:a("html!./user_profile_networks"),getTemplateData:function(){for(var a,c=this.model,d=c.featured_networks.length,e=new Array(d),h=0;d>h;h++){a=c.featured_networks[h];var i=a.web_url;a&&i&&(i="/"===i.charAt(0)?i:"/"+i),e[h]={web_url:i,mugshot_url:a.mugshot_url,name:a.name,count_text:f.t("count_members",{count:a.active_users_count})}}return b.extend({has_more_networks:c.network_count>5,all_networks_count:c.network_count,see_all_url:"/users/"+c.name+"/communities?lightbox=true",networks:e,see_all_tooltip:f.t("users_external_networks",{user:c.full_name}),more_networks:f.t("more_networks",{count:c.network_count})},g)},_clickHandlerSeeAll:function(){c.event("rr_user_profile_external_network_list",{event_action:"see-all"})},_clickHandlerGroupLink:function(){c.event("rr_user_profile_external_network_list",{event_action:"network-link-click"})},_clickHandlerGroupPhoto:function(){c.event("rr_user_profile_external_network_list",{event_action:"network-photo-click"})}});return h}),define("css!workfeed/lib/app/sidebar/user_profile_following",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_following",["mustache"],function(a){var b='<h2 class="yj-user-profile--following-header">\n  <a href="{{see_all_url}}" class="yj-user-profile--following-link">\n    <span>\n      {{heading}}\n      {{#all_followees_count}}\n        <span class="yj-count badge">\n          ({{all_followees_count}})\n        </span>\n      {{/all_followees_count}}\n    </span>\n  </a>\n</h2>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_following",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","core/lib/report","common-ui/lib/ui/shared/face_pile","underscore","css!./user_profile_following","html!./user_profile_following"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("core/lib/report"),f=a("common-ui/lib/ui/shared/face_pile"),g=a("underscore");a("css!./user_profile_following");var h={heading:d.t("following"),see_all_label:d.t("see_all_3")},i=b.extend({className:"yj-user-profile--following",attributes:{"data-qaid":"user-profile-following"},events:{"click .see-all-link":"_clickHandlerSeeAll","click .yj-face-item":"_clickHandlerAvatarClick"},mixins:[c],template:a("html!./user_profile_following"),initialize:function(){var a=this.model;this.facepile=new f({collection:g.first(a.followed_users,6),withHovercard:"left"})},getTemplateData:function(){var a=this.model;return g.extend({all_followees_count:a.stats.following,has_more_followees:a.stats.following>10,see_all_url:"/users/"+a.name+"/users?is_profile=true"},h)},render:function(){this.facepile.render(),this.el.appendChild(this.facepile.el)},_clickHandlerSeeAll:function(){e.event("rr_user_profile_following_users",{event_action:"see-all"})},_clickHandlerAvatarClick:function(){e.event("rr_user_profile_following_users",{event_action:"avatar_click"})}});return i}),define("css!workfeed/lib/app/sidebar/user_profile_followed_by",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_followed_by",["mustache"],function(a){var b='<h2 class="yj-user-profile--followed-by-header">\n  <a href="{{see_all_url}}" class="yj-user-profile--followed-by-link">\n    <span>\n      {{heading}}\n      {{#all_followers_count}}\n        <span class="yj-count badge">\n          ({{all_followers_count}})\n        </span>\n      {{/all_followers_count}}\n    </span>\n  </a>\n</h2>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_followed_by",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","core/lib/report","common-ui/lib/ui/shared/face_pile","css!./user_profile_followed_by","html!./user_profile_followed_by"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/tr"),f=a("core/lib/report"),g=a("common-ui/lib/ui/shared/face_pile");a("css!./user_profile_followed_by");var h={heading:e.t("followers"),see_all_label:e.t("see_all_3")},i=c.extend({className:"yj-user-profile--followed-by",attributes:{"data-qaid":"user-profile-followed-by"},events:{"click .see-all-link":"_clickHandlerSeeAll","click .yj-face-item":"_clickHandlerAvatarClick"},mixins:[d],template:a("html!./user_profile_followed_by"),initialize:function(){var a=this.model;this.facepile=new g({collection:b.first(a.user_followers,6),withHovercard:"left"})},getTemplateData:function(){var a=this.model;return b.extend({all_followers_count:a.stats.followers,has_more_followers:a.stats.followers>10,see_all_url:"/users/"+a.name+"/users?followed_by=true&is_profile=true"},h)},render:function(){this.facepile.render(),this.el.appendChild(this.facepile.el)},_clickHandlerSeeAll:function(){f.event("rr_user_profile_followers",{event_action:"see-all"})},_clickHandlerAvatarClick:function(){f.event("rr_user_profile_followers",{event_action:"avatar_click"})}});return i}),define("css!workfeed/lib/app/user_profile/followed_topics_lightbox",[],function(){}),define("stache!workfeed/lib/app/user_profile/followed_topics_lightbox",["mustache"],function(a){var b='<div class="yj-subscriptions">\n  <div class="yj-tab-content">\n    <Spinner />\n    <ul class="yj-follow-list yj-topics"></ul>\n    <div class="yj-more-button-container" >\n      <a class="yj-more-button" href="javascript://"><span>{{more_label}}</span></a>\n    </div>\n  </div>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/user_profile/followed_topics_lightbox",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/namespace","backbone","core/lib/session","core/lib/tr","common-ui/lib/ui/shared/spinner","css!./followed_topics_lightbox","html!./followed_topics_lightbox"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/namespace"),f=a("backbone"),g=a("core/lib/session"),h=a("core/lib/tr"),i=a("common-ui/lib/ui/shared/spinner");return a("css!./followed_topics_lightbox"),e.ns("yam.workfeed.userProfile"),yam.workfeed.userProfile.FollowedTopicsLightbox=b.extend({className:"yj-config-feed",events:{"click .yj-more-button-container":"_fetchMoreTopics"},mixins:[c,d],template:a("html!./followed_topics_lightbox"),views:{Spinner:"_getSpinner"},initialize:function(a){this._topicCount=a.topicCount,this._page=1,this._fetchMoreTopics()},getTemplateData:function(){return{more_label:h.t("more_2")}},_getSpinner:function(){return this.spinner=new i,this.spinner},_fetchMoreTopics:function(){jQuery.ajax({url:"/users/"+this.model.name+"/topics.js",data:{network_id:g.getCurrentNetwork().id,page:this._page},dataType:"html",beforeSend:function(){this.$(".yj-more-button").addClass("yj-loading")}.bind(this),success:function(a){this.spinner&&this.spinner.remove(),this.$(".yj-follow-list").append(a),this.$(".yj-more-button").removeClass("yj-loading");var b=this.$(".yj-more-button-container");this.$(".yj-follow-item").length<this._topicCount?b.show():b.hide()}.bind(this),error:function(){f.trigger("/ui/alert/show","error",h.t("topics_could_not_be_loaded"))}}),this._page++}})}),define("css!workfeed/lib/app/sidebar/user_profile_topics",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_topics",["mustache"],function(a){var b='<h2 class="yj-user-profile--topics-header">\n  <span>{{heading}}</span>\n  <span>{{#has_more_topics}}<a class="see-all-link" href="javascript://">{{see_all_label}}</a>{{/has_more_topics}}</span>\n</h2>\n{{#topics}}\n  <a class="yj-user-profile--topics-tag-name" href="{{web_url}}">#{{name}}</a><span class="yj-user-profile--topics-comma">,</span>\n{{/topics}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_topics",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/report","core/lib/string_helper","core/lib/tr","workfeed/lib/app/user_profile/followed_topics_lightbox","common-ui/lib/ui/general/lightbox_manager","css!./user_profile_topics","html!./user_profile_topics"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/report"),f=a("core/lib/string_helper"),g=a("core/lib/tr"),h=a("workfeed/lib/app/user_profile/followed_topics_lightbox"),i=a("common-ui/lib/ui/general/lightbox_manager");a("css!./user_profile_topics");var j={heading:g.t("following_topics"),see_all_label:g.t("see_all_3")},k=c.extend({className:"yj-user-profile--topics",events:{"click .see-all-link":"_openLightbox","click .yj-tag":"_clickHandlerTopic"},mixins:[d],template:a("html!./user_profile_topics"),getTemplateData:function(){for(var a,c=this.model,d=c.featured_topics.length,e=new Array(d),g=0;d>g;g++)a=c.featured_topics[g],e[g]={name:f.truncate(a.name,16),web_url:a.web_url};return b.extend({has_more_topics:c.topic_count>5,topics:e},j)},_clickHandlerTopic:function(){e.event("rr_user_profile_following_topics",{event_action:"topic_click"})},_openLightbox:function(){var a=this.model;i.openComponent(new h({model:a,topicCount:a.topic_count}),"",void 0,{title:g.t("topics_user_is_following",{user:a.full_name}),overlayClose:!1,scrolling:!1}),e.event("rr_user_profile_following_topics",{event_action:"see-all"})}});return k}),define("css!workfeed/lib/app/sidebar/user_profile_admin",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_admin",["mustache"],function(a){var b='<h2 class="yj-user-profile--admin-header">\n  {{heading}}\n</h2>\n<div data-qaid="{{qaid}}" class="yj-user-profile--admin-content">\n  {{{html}}}\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_admin",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/report","core/lib/session","core/lib/tr","css!./user_profile_admin","html!./user_profile_admin"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/report"),f=a("core/lib/session"),g=a("core/lib/tr");a("css!./user_profile_admin");var h=c.extend({className:"yj-user-profile--admin",events:{"click a":"_clickHandler"},mixins:[d],template:a("html!./user_profile_admin"),getTemplateData:function(){var a=this.model;return{heading:g.t("admin"),qaid:"user-suspend-confirm",html:g.t("if_user_is_no_longer_a_part_of_the_strong",{user:b.escape(a.full_name),network:b.escape(f.getCurrentNetwork().name),link:{1:"/users/"+a.id+"/suspend_confirm"}})}},_clickHandler:function(){e.event("rr_user_profile_admin")}});return h}),define("css!workfeed/lib/app/sidebar/user_profile_former_member",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_former_member",["mustache"],function(a){var b='<h2 class="yj-user-profile--former-member-header">\n  {{heading}}\n</h2>\n\n<p class="yj-user-profile--former-member-section">\n  <span class="yj-user-profile--former-member-text yj-user-profile--bold-label">{{started_label}}</span>\n  <span class="yj-user-profile--former-member-text">{{started}}</span>\n</p>\n<p class="yj-user-profile--former-member-section">\n  <span class="yj-user-profile--former-member-text yj-user-profile--bold-label">{{ended_label}}</span>\n  <span class="yj-user-profile--former-member-text">{{ended}}</span>\n</p>\n\n{{#deleted_by}}\n<p class="yj-user-profile--former-member-section">\n  <span class="yj-user-profile--former-member-text yj-user-profile--bold-label">{{removed_by_label}}</span>\n  <span class="yj-user-profile--former-member-text"><a href="{{web_url}}">{{full_name}}</a></span>\n</p>\n{{/deleted_by}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_former_member",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","core/lib/date_helper","css!./user_profile_former_member","html!./user_profile_former_member"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/tr"),f=a("core/lib/date_helper");a("css!./user_profile_former_member");var g={heading:e.t("former_member"),started_label:e.t("started"),ended_label:e.t("ended"),removed_by_label:e.t("removed_by")},h=c.extend({className:"yj-user-profile--former-member",mixins:[d],template:a("html!./user_profile_former_member"),getTemplateData:function(){var a=this.model;return b.extend({started:f.formatAgo(new Date(a.created_at),null,!0),ended:f.formatAgo(new Date(a.deactivated_at),null,!0),deleted_by:a.deleted_by},g)}});return h}),define("css!workfeed/lib/app/sidebar/user_profile_org_chart",[],function(){}),define("stache!workfeed/lib/app/sidebar/user_profile_org_chart",["mustache"],function(a){var b='<div class="yj-header-extra-link">\n  <h2 class="yj-user-profile--org-chart-header">\n    {{heading}}\n  </h2>\n  <a class="see-all-link" href="{{edit_url}}">{{edit_label}}</a>\n</div>\n\n{{#has_managers}}\n<p class="yj-user-profile--org-chart-section">\n  <span>{{managers_label}}</span>\n  {{#managers}}\n    <span><a href="{{web_url}}">{{full_name}}</a></span>\n  {{/managers}}\n</p>\n{{/has_managers}}\n{{#has_reports}}\n<p class="yj-user-profile--org-chart-section">\n  <span>{{reports_label}}</span>\n  {{#reports}}\n    <span><a href="{{web_url}}">{{full_name}}</a></span>\n  {{/reports}}\n</p>\n{{/has_reports}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_profile_org_chart",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","css!./user_profile_org_chart","html!./user_profile_org_chart"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr");a("css!./user_profile_org_chart");var e=b.extend({mixins:[c],className:"yj-user-profile--org-chart",template:a("html!./user_profile_org_chart"),getTemplateData:function(){var a=this.model;return{edit_url:"/users/"+this.model.name+"/org_chart",has_managers:a.bosses.length>0,has_reports:a.reports.length>0,managers:a.bosses,reports:a.reports,heading:d.t("org_chart"),edit_label:d.t("edit"),managers_label:d.t("managers",{count:a.bosses.length}),reports_label:d.t("reports",{count:a.reports.length})}}});return e}),define("stache!workfeed/lib/app/sidebar/user_sidebar",["mustache"],function(a){var b='{{#show_former_member}}\n  <UserProfileFormerMember key="user_profile_former_member" />\n{{/show_former_member}}\n\n{{^show_former_member}}\n  {{#show_user_profile_about}}\n    <UserProfileAbout key="user_profile_about" />\n  {{/show_user_profile_about}}\n\n  <UserProfileInfo key="user_profile_info" />\n\n  {{#show_top_groups}}\n    <UserProfileGroups key="user_profile_groups" />\n  {{/show_top_groups}}\n\n  {{#show_home_network}}\n    <UserProfileHomeNetwork key="user_profile_home_network" />\n  {{/show_home_network}}\n\n  {{#show_networks}}\n    <UserProfileNetworks key="user_profile_networks" />\n  {{/show_networks}}\n\n  {{#show_org_chart}}\n    <UserProfileOrgChart key="user_profile_org_chart" />\n  {{/show_org_chart}}\n\n  {{#show_followed_users}}\n    <UserProfileFollowing key="user_profile_following" />\n  {{/show_followed_users}}\n\n  {{#show_followers}}\n    <UserProfileFollowedBy key="user_profile_followed_by" />\n  {{/show_followers}}\n\n  {{#show_topics}}\n    <UserProfileTopics key="user_profile_topics" />\n  {{/show_topics}}\n\n  {{#show_admin}}\n    <UserProfileAdmin key="user_profile_admin" />\n  {{/show_admin}}\n{{/show_former_member}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/sidebar/user_sidebar",["require","core/lib/backbone_base_view","core/lib/backbone_with_subviews","core/lib/backbone_with_auto_render","core/lib/session","./user_profile_about","./user_profile_info","./user_profile_groups","./user_profile_home_network","./user_profile_networks","./user_profile_following","./user_profile_followed_by","./user_profile_topics","./user_profile_admin","./user_profile_former_member","./user_profile_org_chart","models/helpers/user","models/user","html!./user_sidebar"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_subviews"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/session"),f=a("./user_profile_about"),g=a("./user_profile_info"),h=a("./user_profile_groups"),i=a("./user_profile_home_network"),j=a("./user_profile_networks"),k=a("./user_profile_following"),l=a("./user_profile_followed_by"),m=a("./user_profile_topics"),n=a("./user_profile_admin"),o=a("./user_profile_former_member"),p=a("./user_profile_org_chart"),q=a("models/helpers/user");a("models/user");var r=b.extend({mixins:[d,c],template:a("html!./user_sidebar"),views:{UserProfileAbout:"_getUserProfileAbout",UserProfileInfo:"_getUserProfileInfo",UserProfileGroups:"_getUserProfileGroups",UserProfileHomeNetwork:"_getUserProfileHomeNetwork",UserProfileNetworks:"_getUserProfileNetworks",UserProfileFollowing:"_getUserProfileFollowing",UserProfileFollowedBy:"_getUserProfileFollowedBy",UserProfileTopics:"_getUserProfileTopics",UserProfileAdmin:"_getUserProfileAdmin",UserProfileFormerMember:"_getUserProfileFormerMember",UserProfileOrgChart:"_getUserProfileOrgChart"},getTemplateData:function(){var a=yam.model.User.save(this.model),b=a.id!==e.getCurrentUser().id&&"false"===a.admin&&q.isActive(a)&&!e.getCurrentNetwork().community;return{show_user_profile_about:a.summary,show_top_groups:a.top_groups.length,show_topics:a.featured_topics.length,show_home_network:a.show_home_network&&a.canonical_network_name,show_networks:a.featured_networks,show_followed_users:a.followed_users,show_followers:a.user_followers,show_admin:b,show_former_member:q.isInactive(a),show_org_chart:e.getCurrentNetwork().is_org_chart_enabled&&(a.bosses||a.reports)}},_getUserProfileAbout:function(){return new f({model:this.model})},_getUserProfileInfo:function(){return new g({model:this.model})},_getUserProfileGroups:function(){return new h({model:this.model})},_getUserProfileHomeNetwork:function(){
return new i({model:this.model})},_getUserProfileNetworks:function(){return new j({model:this.model})},_getUserProfileFollowing:function(){return new k({model:this.model})},_getUserProfileFollowedBy:function(){return new l({model:this.model})},_getUserProfileTopics:function(){return new m({model:this.model})},_getUserProfileAdmin:function(){return new n({model:this.model})},_getUserProfileFormerMember:function(){return new o({model:this.model})},_getUserProfileOrgChart:function(){return new p({model:this.model})}});return r}),define("stache!workfeed/lib/app/views/user_profile/index",["mustache"],function(a){var b='{{^loading}}\n  <UserProfileHeader key="{{model}}"/>\n  <div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n    <div class="yk-row">\n      <div class="column-two-left yk-col-sm-13 yk-col-md-17 yk-col-lg-19">\n        <div class="yj-announcements yj-scrollbar-fix"></div>\n        <div class="yj-main-content yj-scrollbar-fix">\n          <div class="column-two-left">\n            <div class="yj-main-messagelist-container yj-scrollbar-fix">\n              {{^isForeign}}\n                <UserProfileThreadList key="user_profile_thread_list" />\n              {{/isForeign}}\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="yj-selector-right-sidebar yk-col-sm-5 yk-col-md-6 yk-col-lg-6">\n        {{^isForeign}}\n          <div id="user-details" role="complementary">\n            <UserProfileSidebar key="user_profile_sidebar" />\n          </div>\n        {{/isForeign}}\n      </div>\n    </div>\n  </div>\n{{/loading}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/index",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./header","feeds/lib/ui/threads/future/thread_list","workfeed/lib/app/sidebar/user_sidebar","models/lib/helper/feed_factory","models/helpers/feed","workfeed/lib/app/helpers/layout","core/lib/session","models/helpers/user","core/lib/util/route_helper","feeds/lib/ui/util/title_updater","html!./index"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./header"),f=a("feeds/lib/ui/threads/future/thread_list"),g=a("workfeed/lib/app/sidebar/user_sidebar"),h=a("models/lib/helper/feed_factory"),i=a("models/helpers/feed"),j=a("workfeed/lib/app/helpers/layout"),k=a("core/lib/session"),l=a("models/helpers/user"),m=a("core/lib/util/route_helper"),n=a("feeds/lib/ui/util/title_updater");return b.extend({mixins:[c,d],template:a("html!./index"),views:{UserProfileHeader:"_getHeader",UserProfileThreadList:"_getThreadList",UserProfileSideBar:"_getUserSideBar"},className:j.twoColumnMainClass,initialize:function(){this._loaded()||(n.setTitle(""),this.fetchUserPromise=l.fetch(this.options.feedId),this.fetchUserPromise.then(m.executeInCurrentFragment(this._processUserData,this)))},getTemplateData:function(){var a={loading:!0};return this._loaded()?{isForeign:l.isForeign(this.user,k)}:a},_loaded:function(){return!!this.user},_processUserData:function(a){this.user=a,n.setTitle(l.getUserName(this.user),{announce:!0}),this.render()},_getHeader:function(){return new e({model:this.user,currentTab:this.options.type,isForeign:l.isForeign(this.user,k)})},_getThreadList:function(){var a,b=this.options.type,c=this.options.appId,d=this.options.feedId;if("bookmarked_by"===b)a=h.findOrCreate("bookmarks",d);else{var e=i.getAppId("links"),g=i.getAppId("polls"),j=i.getAppId("announcements");a=e&&e===c?h.findOrCreate("userLinks",d):g&&g===c?h.findOrCreate("userPolls",d):j&&j===c?h.findOrCreate("userAnnouncements",d):h.findOrCreate("user",d)}return new f({feed:a,feedId:d,hideThreadStarter:!0})},_getUserSideBar:function(){return new g({model:this.user})}})}),define("css!workfeed/lib/app/views/user_profile/company_item",[],function(){}),define("stache!workfeed/lib/app/views/user_profile/company_item",["mustache"],function(a){var b='<div class="section yj-user-profile--company-item-section">\n  <table role="presentation" class="dataview yj-user-profile--company-item-table" cellspacing="0">\n    <tr>\n      <th role="presentation">{{employerLabel}}:</th>\n      <td>{{employer}}</td>\n    </tr>\n    {{#hasPosition}}\n      <tr>\n        <th role="presentation">{{positionLabel}}:</th>\n        <td>{{position}}</td>\n      </tr>\n    {{/hasPosition}}\n    {{#jobDates}}\n      <tr>\n        <th role="presentation">{{datesLabel}}</th>\n        <td>{{start}} - {{end}}</td>\n      </tr>\n    {{/jobDates}}\n    {{#hasDescription}}\n      <tr>\n        <th role="presentation">{{descriptionLabel}}:</th>\n        <td>{{description}}</td>\n      </tr>\n    {{/hasDescription}}\n  </table>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/company_item",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","css!./company_item","html!./company_item"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g={formerMember:f.t("former_member"),started:f.t("started"),ended:f.t("ended"),removed_by:f.t("removed_by"),work:f.t("work"),employerLabel:f.t("employer"),positionLabel:f.t("position"),descriptionLabel:f.t("group_description_header"),datesLabel:f.t("dates")};return a("css!./company_item"),c.extend({mixins:[d,e],template:a("html!./company_item"),className:"yj-user-profile--company-item-table",getTemplateData:function(){return b.extend({employer:this.model.employer,hasPosition:this.model.position.length,position:this.model.position,jobDates:this.model.start_year||this.model.end_year,start:this.model.start_year,end:0===this.model.end_year?"present":this.model.end_year,hasDescription:this.model.description.length,description:this.model.description},g)}})}),define("stache!workfeed/lib/app/views/user_profile/companies",["mustache"],function(a){var b='{{#companies}}\n  <CompanyItem key="{{.}}" />\n{{/companies}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/companies",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","workfeed/lib/app/views/user_profile/company_item","html!./companies"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("workfeed/lib/app/views/user_profile/company_item");return c.extend({mixins:[d,e],views:{CompanyItem:"_getCompanyView"},template:a("html!./companies"),getTemplateData:function(){return{companies:b.pluck(this.collection,"employer")}},_getCompanyView:function(a){var c=b.findWhere(this.collection,{employer:a});return new f({model:c})}})}),define("css!workfeed/lib/app/views/user_profile/school_item",[],function(){}),define("stache!workfeed/lib/app/views/user_profile/school_item",["mustache"],function(a){var b='<div class="section yj-user-profile--school-item-section">\n  <table role="presentation" class="dataview yj-user-profile--school-item-table" cellspacing="0">\n    <tr>\n      <th role="presentation">{{schoolLabel}}</th>\n      <td>{{school}}</td>\n    </tr>\n    {{#hasDegree}}\n      <tr>\n        <th role="presentation">{{degreeLabel}}</th>\n        <td>{{degree}}</td>\n      </tr>\n    {{/hasDegree}}\n    {{#schoolDates}}\n      <tr>\n        <th role="presentation">{{datesLabel}}:</th>\n        <td>{{start}} - {{end}}</td>\n      </tr>\n    {{/schoolDates}}\n    {{#hasDescription}}\n      <tr>\n        <th role="presentation">{{descriptionLabel}}:</th>\n        <td>{{description}}</td>\n      </tr>\n    {{/hasDescription}}\n  </table>\n</div>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/school_item",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","css!./school_item","html!./school_item"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/tr"),g={schoolLabel:f.t("school"),degreeLabel:f.t("degree"),datesLabel:f.t("dates"),descriptionLabel:f.t("group_description_header")};return a("css!./school_item"),c.extend({mixins:[d,e],template:a("html!./school_item"),className:"yj-user-profile--school-item-table",getTemplateData:function(){return b.extend({school:this.model.school,hasDegree:this.model.degree.length,degree:this.model.degree,schoolDates:this.model.start_year||this.model.end_year,start:this.model.start_year,end:0===this.model.end_year?f.t("present"):this.model.end_year,hasDescription:this.model.description.length,description:this.model.description},g)}})}),define("stache!workfeed/lib/app/views/user_profile/schools",["mustache"],function(a){var b='{{#schools}}\n  <SchoolItem key="{{.}}" />\n{{/schools}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/schools",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","workfeed/lib/app/views/user_profile/school_item","html!./schools"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("workfeed/lib/app/views/user_profile/school_item");return c.extend({mixins:[d,e],views:{SchoolItem:"_getSchoolView"},template:a("html!./schools"),getTemplateData:function(){return{schools:b.pluck(this.collection,"school")}},_getSchoolView:function(a){var c=b.findWhere(this.collection,{school:a});return new f({model:c})}})}),define("css!workfeed/lib/app/views/user_profile/info",[],function(){}),define("stache!workfeed/lib/app/views/user_profile/info",["mustache"],function(a){var b='{{^loading}}\n  <UserProfileHeader key="{{model}}"/>\n  <div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n    <div id="info-tab">\n      {{#isInactive}}\n        <h4 role="heading" aria-level="3" class="yj-user-profile--info-heading">{{formerMember}}</h4>\n        <div class="section yj-user-profile--info-section">\n          <table role="presentation" class="dataview yj-user-profile--info-table" cellspacing="0">\n            <tr>\n              <th role="presentation">{{started}}:</th>\n              <td>{{startDate}}</td>\n            </tr>\n            <tr>\n              <th role="presentation">{{ended}}:</th>\n              <td>{{endDate}}</td>\n            </tr>\n            {{#deletedBy}}\n              <tr>\n                <th role="presentation">{{removed_by}}:</th>\n                <td>{{deletedByUser}}</td>\n              </tr>\n            {{/deletedBy}}\n          </table>\n        </div>\n      {{/isInactive}}\n\n      {{#enableWorkHistory}}\n        <h4 role="heading" aria-level="3" class="yj-user-profile--info-heading">{{workHeader}}</h4>\n        <div class="section yj-user-profile--info-section">\n          {{#hasCompanies}}\n            <UserProfileCompanies key="user_profile_companies"/>\n          {{/hasCompanies}}\n          {{^hasCompanies}}\n            {{noWorkHistory}}\n          {{/hasCompanies}}\n        </div>\n      {{/enableWorkHistory}}\n\n      {{#enableEducation}}\n        <h4 role="heading" aria-level="3" class="yj-user-profile--info-heading">{{educationHeader}}</h4>\n        <div class="section yj-user-profile--info-section">\n          {{#hasSchools}}\n            <UserProfileSchools key="user_profile_schools"/>\n          {{/hasSchools}}\n          {{^hasSchools}}\n            {{noEducationHistory}}\n          {{/hasSchools}}\n        </div>\n      {{/enableEducation}}\n    </div>\n  </div>\n{{/loading}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/info",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./header","./companies","./schools","core/lib/tr","core/lib/date_helper","workfeed/lib/app/helpers/layout","core/lib/session","models/helpers/user","core/lib/namespace","core/lib/util/route_helper","css!./info","html!./info"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("./header"),g=a("./companies"),h=a("./schools"),i=a("core/lib/tr"),j=a("core/lib/date_helper"),k=a("workfeed/lib/app/helpers/layout"),l=a("core/lib/session"),m=a("models/helpers/user"),n=a("core/lib/namespace"),o=a("core/lib/util/route_helper"),p={formerMember:i.t("former_member"),started:i.t("started"),ended:i.t("ended"),removed_by:i.t("removed_by"),workHeader:i.t("work"),employer:i.t("employer"),position:i.t("position"),description:i.t("group_description_header"),educationHeader:i.t("education"),noWorkHistory:i.t("no_work_history"),noEducationHistory:i.t("no_education_history")};return a("css!./info"),c.extend({mixins:[d,e],template:a("html!./info"),views:{UserProfileHeader:"_getHeader",UserProfileCompanies:"_getCompanies",UserProfileSchools:"_getSchools"},className:k.twoColumnMainClass,initialize:function(){this._loaded()||(this.fetchUserPromise=m.fetch(this.options.feedId),this.fetchUserPromise.then(o.executeInCurrentFragment(this._processUserData,this)))},getTemplateData:function(){var a={loading:!0};return this._loaded()?b.extend({isInactive:!m.isActive(this.user),startDate:j.formatAgo(new Date(this.user.created_at),null,!0),endDate:j.formatAgo(new Date(this.user.deactivated_at),null,!0),deletedBy:this.user.deleted_by,deletedByUser:this.user.deleted_by?m.getUserName(this.user.deleted_by):"nil",enableWorkHistory:n.val(l.getCurrentNetwork(),"profile_fields_config.enable_work_history"),enableEducation:n.val(l.getCurrentNetwork(),"profile_fields_config.enable_education"),hasCompanies:this.user.previous_companies.length>0,hasSchools:this.user.schools.length>0},p):a},_loaded:function(){return!!this.user},_processUserData:function(a){this.user=a,this.render()},_getHeader:function(){return new f({model:this.user,currentTab:"info"})},_getCompanies:function(){var a=b.sortBy(this.user.previous_companies,function(a){return a.end_year});return new g({collection:a})},_getSchools:function(){var a=b.sortBy(this.user.schools,function(a){return a.end_year});return new h({collection:a})}})}),define("stache!workfeed/lib/app/views/user_profile/files",["mustache"],function(a){var b='{{^loading}}\n  <UserProfileHeader key="{{model}}"/>\n  <div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n    <div class="canvas">\n      <UserProfileFiles key="user_profile_files"/>\n    </div>\n  </div>\n{{/loading}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/files",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./header","feeds/lib/ui/files/selector","workfeed/lib/app/helpers/layout","models/helpers/user","core/lib/util/route_helper","html!./files"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./header"),f=a("feeds/lib/ui/files/selector"),g=a("workfeed/lib/app/helpers/layout"),h=a("models/helpers/user"),i=a("core/lib/util/route_helper");return b.extend({mixins:[c,d],template:a("html!./files"),className:g.twoColumnMainClass,views:{UserProfileHeader:"_getHeader",UserProfileFiles:"_getFiles"},initialize:function(){this._loaded()||(this.fetchUserPromise=h.fetch(this.options.feedId),this.fetchUserPromise.then(i.executeInCurrentFragment(this._processUserData,this)))},getTemplateData:function(){var a={loading:!0};return this._loaded()?{}:a},_loaded:function(){return!!this.user},_processUserData:function(a){this.user=a,this.render()},_getHeader:function(){return new e({model:this.user,currentTab:"files"})},_getFiles:function(){var a={filterGroup:null,filterTopic:null,filterUser:this.user,hasFilter:!0,showSidebarIcons:!0};return new f(a)}})}),define("feeds/lib/ui/files/image_selector",["require","feeds/lib/ui/files/selector","core/lib/tr"],function(a){var b=a("feeds/lib/ui/files/selector"),c=a("core/lib/tr");return b.extend(new function(){this.defaults={id:"fileSelector",_dataName:"files",_dataType:"images",_createLinkText:c.t("upload_an_image"),_createLinkIcon:"inbox-upload-icon",_navSections:[{id:"all",header:null,items:[{id:"files-all",title:c.t("all_images"),api:"uploaded_files.json"}]},{id:"user",header:c.t("my_images"),items:[{id:"files-user-accessed",title:c.t("recently_accessed"),api:"uploaded_files/recently_accessed.json"},{id:"files-user-follow",title:c.t("images_i_follow"),api:"uploaded_files/followed_by/:user_id.json"},{id:"files-user-uploaded",title:c.t("images_i_uploaded"),api:"uploaded_files/uploaded_by/:user_id.json"}]},{id:"group",header:c.t("my_groups"),items:[{id:"files-all-company",title:"",api:"uploaded_files/in_group/company.json"}]}],_prototypeLazyInit:!1,_viewType:"thumbnail",_groupApiBase:"uploaded_files/in_group/",_userApiBase:"uploaded_files/uploaded_by/",_topicApiBase:"uploaded_files/with_topic/",_filterComponentId:"fileSelectorFilter",_selectorComponentId:"fileSelectorItems"}})}),define("stache!workfeed/lib/app/views/user_profile/images",["mustache"],function(a){var b='{{^loading}}\n  <UserProfileHeader key="{{model}}"/>\n  <div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n    <div class="canvas">\n      <UserProfileImages key="user_profile_images"/>\n    </div>\n  </div>\n{{/loading}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/images",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./header","feeds/lib/ui/files/image_selector","workfeed/lib/app/helpers/layout","models/helpers/user","core/lib/util/route_helper","html!./images"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./header"),f=a("feeds/lib/ui/files/image_selector"),g=a("workfeed/lib/app/helpers/layout"),h=a("models/helpers/user"),i=a("core/lib/util/route_helper");return b.extend({mixins:[c,d],template:a("html!./images"),className:g.twoColumnMainClass,views:{UserProfileHeader:"_getHeader",UserProfileImages:"_getImages"},initialize:function(){this._loaded()||(this.fetchUserPromise=h.fetch(this.options.feedId),this.fetchUserPromise.then(i.executeInCurrentFragment(this._processUserData,this)))},getTemplateData:function(){var a={loading:!0};return this._loaded()?{}:a},_loaded:function(){return!!this.user},_processUserData:function(a){this.user=a,this.render()},_getHeader:function(){return new e({model:this.user,currentTab:"images"})},_getImages:function(){var a={filterGroup:null,filterTopic:null,filterUser:this.user,hasFilter:!0,showSidebarIcons:!0};return new f(a)}})}),define("feeds/lib/ui/files/video_selector",["require","feeds/lib/ui/files/selector","core/lib/tr"],function(a){var b=a("feeds/lib/ui/files/selector"),c=a("core/lib/tr");return b.extend(new function(){this.defaults={id:"fileSelector",_dataName:"files",_dataType:"videos",_createLinkText:c.t("upload_a_video"),_createLinkIcon:"inbox-upload-icon",_navSections:[{id:"all",header:null,items:[{id:"files-all",title:c.t("all_videos"),api:"uploaded_files.json"}]},{id:"user",header:c.t("my_videos"),items:[{id:"files-user-accessed",title:c.t("recently_accessed"),api:"uploaded_files/recently_accessed.json"},{id:"files-user-follow",title:c.t("videos_i_follow"),api:"uploaded_files/followed_by/:user_id.json"},{id:"files-user-uploaded",title:c.t("videos_i_uploaded"),api:"uploaded_files/uploaded_by/:user_id.json"}]},{id:"group",header:c.t("my_groups"),items:[{id:"files-all-company",title:"",api:"uploaded_files/in_group/company.json"}]}],_prototypeLazyInit:!1,_viewType:"thumbnail",_groupApiBase:"uploaded_files/in_group/",_userApiBase:"uploaded_files/uploaded_by/",_topicApiBase:"uploaded_files/with_topic/",_filterComponentId:"fileSelectorFilter",_selectorComponentId:"fileSelectorItems"}})}),define("stache!workfeed/lib/app/views/user_profile/videos",["mustache"],function(a){var b='{{^loading}}\n  <UserProfileHeader key="{{model}}"/>\n  <div class="yk-col-sm-19 yk-col-md-24 yk-col-lg-26 yk-center-block yk-clearfix" role="main">\n    <div class="canvas">\n      <UserProfileVideos key="user_profile_videos"/>\n    </div>\n  </div>\n{{/loading}}';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/user_profile/videos",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","./header","feeds/lib/ui/files/video_selector","workfeed/lib/app/helpers/layout","models/helpers/user","core/lib/util/route_helper","html!./videos"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("./header"),f=a("feeds/lib/ui/files/video_selector"),g=a("workfeed/lib/app/helpers/layout"),h=a("models/helpers/user"),i=a("core/lib/util/route_helper");return b.extend({mixins:[c,d],template:a("html!./videos"),className:g.twoColumnMainClass,views:{UserProfileHeader:"_getHeader",UserProfileVideos:"_getVideos"},initialize:function(){this._loaded()||(this.fetchUserPromise=h.fetch(this.options.feedId),this.fetchUserPromise.then(i.executeInCurrentFragment(this._processUserData,this)))},getTemplateData:function(){var a={loading:!0};return this._loaded()?{}:a},_loaded:function(){return!!this.user},_processUserData:function(a){this.user=a,this.render()},_getHeader:function(){return new e({model:this.user,currentTab:"videos"})},_getVideos:function(){var a={filterGroup:null,filterTopic:null,filterUser:this.user,hasFilter:!0,showSidebarIcons:!0};return new f(a)}})}),define("workfeed/lib/app/routing/router",["require","backbone","core/lib/jam/backbone_router_with_before_events","workfeed/lib/app/routing/general_route_handler","core/lib/uri_helper","core/lib/routing/group_viewed_routing_helper","core/lib/routing/inbox_routing_helper","workfeed/lib/app/views/groups/index","workfeed/lib/app/views/group/info","workfeed/lib/app/views/group/list","workfeed/lib/app/views/group/settings","workfeed/lib/app/views/group/delete","workfeed/lib/app/views/inbox/index","workfeed/lib/app/views/inbox/search","workfeed/lib/app/views/messages/bookmarklet","workfeed/lib/app/views/notifications/index","workfeed/lib/app/views/invitations/index","workfeed/lib/app/views/threads/about_topic","workfeed/lib/app/views/threads/company","workfeed/lib/app/views/threads/from_user","workfeed/lib/app/views/threads/in_group","workfeed/lib/app/views/threads/index","workfeed/lib/app/views/threads/search","workfeed/lib/app/views/threads/show","workfeed/lib/app/views/threads/to_user","components/dogfood/index","workfeed/lib/app/views/note/index","workfeed/lib/app/views/note/compare","workfeed/lib/app/views/note/edit","workfeed/lib/app/views/file/index","workfeed/lib/app/views/ogo/index","workfeed/lib/app/views/user_profile/index","workfeed/lib/app/views/user_profile/info","workfeed/lib/app/views/user_profile/files","workfeed/lib/app/views/user_profile/images","workfeed/lib/app/views/user_profile/videos"],function(a){var b=a("backbone"),c=a("core/lib/jam/backbone_router_with_before_events"),d=a("workfeed/lib/app/routing/general_route_handler"),e=a("core/lib/uri_helper"),f=a("core/lib/routing/group_viewed_routing_helper"),g=a("core/lib/routing/inbox_routing_helper"),h=a("workfeed/lib/app/views/groups/index"),i=a("workfeed/lib/app/views/group/info"),j=a("workfeed/lib/app/views/group/list"),k=a("workfeed/lib/app/views/group/settings"),l=a("workfeed/lib/app/views/group/delete"),m=a("workfeed/lib/app/views/inbox/index"),n=a("workfeed/lib/app/views/inbox/search"),o=a("workfeed/lib/app/views/messages/bookmarklet"),p=a("workfeed/lib/app/views/notifications/index"),q=a("workfeed/lib/app/views/invitations/index"),r=a("workfeed/lib/app/views/threads/about_topic"),s=a("workfeed/lib/app/views/threads/company"),t=a("workfeed/lib/app/views/threads/from_user"),u=a("workfeed/lib/app/views/threads/in_group"),v=a("workfeed/lib/app/views/threads/index"),w=a("workfeed/lib/app/views/threads/search"),x=a("workfeed/lib/app/views/threads/show"),y=a("workfeed/lib/app/views/threads/to_user"),z=a("components/dogfood/index"),A=a("workfeed/lib/app/views/note/index"),B=a("workfeed/lib/app/views/note/compare"),C=a("workfeed/lib/app/views/note/edit"),D=a("workfeed/lib/app/views/file/index"),E=a("workfeed/lib/app/views/ogo/index"),F=a("workfeed/lib/app/views/user_profile/index"),G=a("workfeed/lib/app/views/user_profile/info"),H=a("workfeed/lib/app/views/user_profile/files"),I=a("workfeed/lib/app/views/user_profile/images"),J=a("workfeed/lib/app/views/user_profile/videos");return c.extend({routes:{"/Messages/bookmarklet":"bookmarklet","/Threads/AboutTopic":"topic","/Threads/Search":"threadSearch","/Threads/fromUser":"user","/Threads/index":"landing","/Threads/show":"thread","/groups":"groupsAll","/groups/mine":"groupsMine","/groups/suggested":"groupsSuggests","/groups/:id/files":"groupFiles","/groups/:id/info":"groupInfo","/groups/:id/notes":"groupNotes","/groups/:id/settings":"groupSettings","/groups/:id/delete":"groupDelete","/home":"home","/inbox/index":"inboxIndex","/inbox/unread":"inboxUnread","/inbox/all":"inboxAll","/inbox/search":"inboxSearch","/inbox/show":"thread","/notifications/index":"notifications","/threads/AboutTopic":"topic","/threads/AboutTopicAttachments":"topic","/threads/FromUser":"user","/threads/FromUserAttachments":"user","/threads/ToUserAttachments":"userPraise","/threads/company":"company","/threads/inGroup":"group","/threads/index":"landing","/threads/show":"thread","/invitations/by_email":"invitations","/dogfood":"dogfood","/notes/:noteId":"note","/notes/:noteId/compare/:endId":"noteCompare","/notes/:noteId/edit":"noteEdit","/files/:fileId":"file","/users/:userId":"userIndex","/users/:userId/info":"userInfo","/users/:userId/bookmarked":"userBookmarks","/users/:userId/files":"userFiles","/users/:userId/images":"userImages","/users/:userId/videos":"userVideos","/graph/:ogoId":"graph"},bookmarklet:function(a){this._load(o,a)},company:function(a){this._loadDefaultGroupView(s,a,"general")},dogfood:function(){this._load(z)},groupsSuggests:function(a){this._load(h,a,{tab:"suggested"})},groupsMine:function(a){this._load(h,a,{tab:"mine"})},groupsAll:function(a){this._load(h,a)},group:function(a){this._loadDefaultGroupView(u,a,"group")},groupFiles:function(a){this._load(j,{groupId:a,type:"files"})},groupInfo:function(a){this._load(i,{groupId:a})},groupNotes:function(a){this._load(j,{groupId:a,type:"notes"})},groupSettings:function(a){this._load(k,{groupId:a})},groupDelete:function(a){this._load(l,{groupId:a})},home:function(a){this._load(v,a)},inboxIndex:function(a){this._loadDefaultInboxView(a)},inboxUnread:function(a){var b={view:"unread"};this._load(m,a,b)},inboxAll:function(a){var b={view:"all"};this._load(m,a,b)},inboxSearch:function(a){this._load(n,a)},invitations:function(a){this._load(q,a)},landing:function(a){this._loadLandingView(a)},notifications:function(a){this._load(p,a)},thread:function(a){this._load(x,a)},threadSearch:function(a){this._load(w,a)},topic:function(a){this._load(r,a)},user:function(a){this._load(t,a)},userPraise:function(a){this._load(y,a)},note:function(a){this._load(A,{noteId:a})},noteCompare:function(a,b){this._load(B,{noteId:a,endVersion:b})},noteEdit:function(a){this._load(C,{noteId:a})},file:function(a,b){this._load(D,b,{fileId:a})},graph:function(a,b){this._load(E,b,{ogoId:a})},userIndex:function(a){this._load(F,{type:"from_user",feedId:a})},userInfo:function(a){this._load(G,{type:"info",feedId:a})},userBookmarks:function(a){this._load(F,{type:"bookmarked_by",feedId:a})},userFiles:function(a){this._load(H,{type:"files",feedId:a})},userImages:function(a){this._load(I,{type:"images",feedId:a})},userVideos:function(a){this._load(J,{type:"videos",feedId:a})},_loadLandingView:function(){var a="/home",b="",c=window.location.href.indexOf("?");c>=0&&(b=window.location.href.substring(c));var d=a+b;this.navigate(d,{replace:!0,trigger:!0})},_loadDefaultInboxView:function(a){this._loaded=!0,g.getDefaultFeedView().always(function(b){var c="unread"===b.view?"inboxUnread":"inboxAll";this[c](a)}.bind(this))},_loadDefaultGroupView:function(a,b,c){this._loaded=!0;var d=e.objectify(b),g={groupType:c};d.view&&(g.view=d.view),"group"===c&&(g.groupId=this.handler.processParameter(d.feedId,"feedId")),f.getDefaultFeedView(g).always(function(c){this._load(a,b,{view:c.view})}.bind(this))},_load:function(a,b,c){return this._loaded=!0,"string"==typeof b&&(b=e.objectify(b)),this.handler.handleRoute(a,b,c)},initialize:function(){c.prototype.initialize.call(this),this._previousRoute=null,this.listenTo(this,"before-route",this._savePreviousRoute),this.handler=new d},getPreviousRoute:function(){return this._previousRoute},_savePreviousRoute:function(a){this._previousRoute=a.currentRouteName},getCurrentFragment:function(){return b.history.fragment},getFragment:function(){return b.history.getFragment()},hasLoadedView:function(){return this._loaded}})}),define("common-ui/lib/ui/shared/suggestion_queue",["require","jquery","underscore","core/lib/ctor"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/ctor");return d(null,{defaults:{capacity:10,excludedIds:[]},init:function(a){a=c.defaults({},a,this.defaults),this._provider=a.provider,this._capacity=a.capacity,this._excludedIds=c.clone(a.excludedIds),this._queue=[],this._promise=null,this._suspended=!1},provider:function(){return this._provider},capacity:function(){return this._capacity},excludedIds:function(){return c.clone(this._excludedIds)},length:function(){return this._queue.length},isEmpty:function(){return 0===this.length()},suspend:function(){this._suspended=!0},resume:function(){this._suspended=!1},isSuspended:function(){return this._suspended},isRefillable:function(){return(null==this._promise||"resolved"===this._promise.state())&&!this.isSuspended()&&this.length()<=this.capacity()/2},remove:function(a){a=c.defaults({},a,{useFallbacks:!1,excludedIds:[]});var d=new b.Deferred,e=this._remove(a),f=c.bind(function(){"resolved"!==d.state()&&d.resolve(this._remove(a))},this),g=c.bind(function(){"resolved"!==d.state()&&d.reject.apply(d,arguments)},this);return null!=e&&d.resolve(e),this.isRefillable()?b.when(this.refill()).then(f,g):f(),d.promise()},_remove:function(a){var b=this.element(a);return null!=b&&(this._queue=c.without(this._queue,b)),b},element:function(a){a=c.defaults({},a,{useFallbacks:!1,excludedIds:[]});var b;return b=null!=a.excludedIds?c.find(this._queue,function(b){return!c.contains(a.excludedIds,b.suggested.id)}):c.first(this._queue)},cleanup:function(a,b){this._queue=c.reduce(this._queue,function(c,d){return a.call(b,d)||c.push(d),c},[],this)},refill:function(a){if(a=c.defaults({},a,{delay:0}),this.isRefillable()){var d=new b.Deferred,e=c.bind(function(){this._refill(function(){d.resolve.apply(d,arguments)},function(){d.reject.apply(d,arguments)})},this);a.delay>0?setTimeout(e,a.delay):e(),this._promise=d.promise()}return this._promise},_refill:function(a,d){if(null==this._provider)throw new Error("No provider specified");b.when(this._provider.get({limit:this._capacity,exclude_ids:this._excludedIds})).then(c.wrap(a,this._onRefillSuccess.bind(this)),c.wrap(d,this._onRefillError.bind(this)))},_onRefillSuccess:function(a,b){(null==b||b.length<this.capacity()/2)&&this.suspend(),
this._enqueueSuggestions(b),this._excludeSuggestionIds(c.reduce(b,function(a,b){return null!=b&&null!=b.suggested&&a.push(b.suggested.id),a},[],this)),"function"==typeof a&&a.apply(null,c.toArray(arguments).slice(1))},_onRefillError:function(a){"function"==typeof a&&a.apply(null,c.toArray(arguments).slice(1))},_enqueueSuggestions:function(a){this._queue.push.apply(this._queue,c.compact(a))},_excludeSuggestionIds:function(a){this._excludedIds.push.apply(this._excludedIds,c.compact(a))},toString:function(){return c.map(this._queue,function(a){return a.suggested.full_name||a.suggested.name},this).join(", ")}})}),define("common-ui/lib/ui/shared/srcset_polyfill",["require","jquery","underscore","core/lib/namespace"],function(a){function b(a,b){a.height=a.height,a.width=a.width,a.src=b}var c=a("jquery"),d=a("underscore"),e=a("core/lib/namespace");return e.ns("yam.polyfill",{srcset:function(a){var e=window.devicePixelRatio;if(e&&1!==Math.ceil(e)){var f=a?c(a).find("img"):c("img"),g=/[0-9\.]+/g,h=/[^\s]+/g,i=Math.ceil(e);f.each(function(){var a=this,e=a.getAttribute("srcset");if(e){var f,j,k,l=e.split(","),m=a.src,n=0,o=0;d.each(l,function(a){if(j=c.trim(a).split(/[\s]+/),j&&!(j.length<2)&&(f=j[0].match(h),k=j[1],f=f&&f[0],f&&k&&k.indexOf("x"))){if(o=k.match(g),o=o&&+o[0],!o)return;i>=o&&o>n&&(n=o,m=f)}}),c(a).removeAttr("srcset"),a.complete?b(a,m):c(a).one("load",function(){b(a,m)})}})}}}),yam.polyfill.srcset}),define("common-ui/lib/ui/shared/suggestion_queue_provider",["require","underscore","jquery","core/lib/ctor","core/lib/yammer_api"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/ctor"),e=a("core/lib/yammer_api"),f={UserSuggestionProvider:"getUserSuggestions",GroupSuggestionProvider:"getGroupSuggestions"},g={};return b.each(f,function(a,f){g[f]=d(null,{init:function(a){this._params=a},get:function(a){var b=new c.Deferred;return this._get(function(){b.resolve.apply(b,arguments)},function(){b.reject.apply(b,arguments)},a),b.promise()},_get:function(c,d,f){e[a](b.defaults({},f,this._params)).then(c,d)}})}),g}),define("common-ui/lib/ui/shared/user_suggestion_provider",["require","common-ui/lib/ui/shared/suggestion_queue_provider"],function(a){var b=a("common-ui/lib/ui/shared/suggestion_queue_provider");return b.UserSuggestionProvider}),define("common-ui/lib/ui/shared/group_suggestion_provider",["require","common-ui/lib/ui/shared/suggestion_queue_provider"],function(a){var b=a("common-ui/lib/ui/shared/suggestion_queue_provider");return b.GroupSuggestionProvider}),define("workfeed/lib/hashed_url_redirector",[],function(){"use strict";var a=function(){};return a.redirectPatterns=["/uploaded_files/"],a.prototype={threadRegex:new RegExp("threadId=(\\d+)","i"),isForeignRegex:new RegExp("foreign=true","i"),redirectIfNecessary:function(a){""!==a.hash&&(this.isForeignNote(a)?this.redirectToForeignNote(a):this.redirectWithPatterns(a))},redirectWithPatterns:function(b){for(var c=a.redirectPatterns,d=0,e=c.length;e>d;d++)if(1===b.hash.indexOf(c[d])){b.replace(b.href.replace(/\/?(users\/[^\/]+)?#/,""));break}},isForeignNote:function(a){return null!==a.href.match(this.threadRegex)&&null!==a.href.match(this.isForeignRegex)},redirectToForeignNote:function(a){var b=a.hash.match(this.threadRegex);a.replace(a.origin+"/threads/"+b[1])}},a}),define("models/lib/client/refresh_client",["require","jquery","core/lib/ctor","backbone","core/lib/yammer_api"],function(a){var b,c=a("jquery"),d=a("core/lib/ctor"),e=a("backbone"),f=a("core/lib/yammer_api"),g=d(null,{init:function(){this._refreshTokens={},this._pollTimeout=null,this._interval=6e5,this._isStarted=!1,this._isPaused=!1,this._request=null},start:function(){this._isStarted=!0,this._poll()},stop:function(){this.pause(),this._isStarted=!1,this._isPaused=!1},pause:function(){this._request&&this._request.abort(),this._clear(),this._isPaused=!0},resume:function(){this._start()},isStarted:function(){return this._isStarted},isPaused:function(){return this._isPaused},isConnected:function(){return!1},watch:function(a,b){this._refreshTokens[a]=b},_poll:function(){this._clear(),this._pollTimeout=window.setTimeout(this._execute.bind(this),this._interval)},_execute:function(){this._request=f.getYamjsToken(),this._request.then(this._onData.bind(this)),this._poll()},_onData:function(a){var b=!1,d=this,f=a.refresh_tokens;if(f||(b=!0),c.each(this._refreshTokens,function(a,c){c!==f[a]&&(b=!0)}),b){this.stop();var g=600;window.setTimeout(function(){a.hard_refresh?d._hardReload():e.trigger("/application/reload")},1e3*Math.floor(Math.random()*g))}},_clear:function(){window.clearTimeout(this._pollTimeout)},_hardReload:function(){window.location.reload(!0)}});return g.getInstance=function(){return b||(b=new g,b.start()),b},g}),define("workfeed/lib/app/bundles/app_bundle",["require","underscore","jquery","emojione","backbone","models/lib/helper/inbox_manager","models/lib/client/base_realtime_client","workfeed/lib/app/forms","workfeed/lib/app/routing/router","common-ui/lib/ui/shared/suggestion_queue","common-ui/lib/ui/shared/srcset_polyfill","models/lib/domain_controller","core/lib/report","core/lib/session","common-ui/lib/ui/shared/tooltip","core/lib/yammer_config","core/lib/yammer_uri","common-ui/lib/ui/shared/user_suggestion_provider","common-ui/lib/ui/shared/group_suggestion_provider","workfeed/lib/hashed_url_redirector","core/lib/uri_helper","core/lib/location_helper","core/lib/yammer_api","models/lib/client/refresh_client","common-ui/lib/ui/keyboard/keyboard_shortcuts"],function(a){"use strict";var b=a("underscore"),c=a("jquery"),d=a("emojione"),e=a("backbone"),f=a("models/lib/helper/inbox_manager"),g=a("models/lib/client/base_realtime_client"),h=a("workfeed/lib/app/forms"),i=a("workfeed/lib/app/routing/router"),j=a("common-ui/lib/ui/shared/suggestion_queue"),k=a("common-ui/lib/ui/shared/srcset_polyfill"),l=a("models/lib/domain_controller"),m=a("core/lib/report"),n=a("core/lib/session"),o=a("common-ui/lib/ui/shared/tooltip"),p=a("core/lib/yammer_config"),q=a("core/lib/yammer_uri"),r=a("common-ui/lib/ui/shared/user_suggestion_provider"),s=a("common-ui/lib/ui/shared/group_suggestion_provider"),t=a("workfeed/lib/hashed_url_redirector"),u=a("core/lib/uri_helper"),v=a("core/lib/location_helper"),w=a("core/lib/yammer_api"),x=a("models/lib/client/refresh_client");a("common-ui/lib/ui/keyboard/keyboard_shortcuts");var y=function(a){return a?a:q.isHomeLocation()?{model:"Threads",action:"index"}:void 0};return{createSuggestions:function(){var a=new j({capacity:20,provider:new r({type:"follow_user",log_suggestions:!1})}),b=new j({provider:new r({type:"contact_invite",log_suggestions:!1})}),c=new j({provider:new s({type:"user",log_suggestions:!1})});return a.refill({delay:5e3}),b.refill({delay:5e3}),{activeUsers:a,pendingUsers:b,groups:c}},setUpAutoPoll:function(){setTimeout(function(){w.getRequests().then(function(a){e.trigger("/stream/requests",a)})},15e3);var a=p.config().refreshTokens;null!=a&&x.getInstance().watch("yamjs",a.yamjs)},createRouter:function(a){var b=new i,d=a;if(e.history.start(),this._shouldLoadDefaultRoute(b)){var f,g=b.handler.getDefaultFragment(d.model,d.action,d.params),h=v.hash().substring(1);if(h){var j=u.objectify(h);f=g+"?"+c.param(j)}else f=g;b.navigate(f,{replace:!0,trigger:!0})}return b},_shouldLoadDefaultRoute:function(a){return!(a.hasLoadedView()||this._isRedirectFragment())},_isRedirectFragment:function(){var a=t.redirectPatterns;return b.any(a,function(a){return 0===e.history.fragment.indexOf(a)})},run:function(a){d.imagePathPNG=q.cdn(d.imagePathPNG);var b,i=v.hash(),j=v.protocol(),p=v.hostname(),r=v.pathname();if(i.indexOf("#/threads/index?type=all")>=0){var s="/"===r.charAt(r.length-1)?"":"/";return b=j+"//"+p+r+s+"groups/company/#/threads/company?type=general",void v.assign(b)}if(i.indexOf("#/feeds?type=")>=0)return b=j+"//"+p+r,void v.assign(b);yam.suggestions=this.createSuggestions(),yam.modelController=new l(n.getCurrentUser()),yam.modelController.listen(),k(),g.fetchUri(),f.start(),o.subscribe();var t=y(a);t&&(yam.router=this.createRouter(t)),this.setUpAutoPoll(),m.register(),c(function(){c("form").each(function(){h.buildForm(this)})}),e.trigger("/keyboard/shortcuts")}}}),define("stache!components/connect_with_coworkers/src/connect_with_coworkers",["mustache"],function(a){var b='<div class="yj-connect-with-coworkers--header">\n  <div class="yj-connect-with-coworkers--title">{{title}}</div>\n  <div class="yj-connect-with-coworkers--description">{{description}}</div>\n</div>\n<div class="yj-connect-with-coworkers--content">\n  <InvitationsByEmail />\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!components/connect_with_coworkers/src/connect_with_coworkers",[],function(){}),define("components/connect_with_coworkers/src/connect_with_coworkers",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","collections/banners","components/invitations_by_email/index","html!./connect_with_coworkers","css!./connect_with_coworkers"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/tr"),f=a("collections/banners"),g=a("components/invitations_by_email/index"),h=a("html!./connect_with_coworkers"),i="connect-with-coworkers-lightbox";a("css!./connect_with_coworkers");var j=b.extend({mixins:[c,d],template:h,className:"yj-connect-with-coworkers",views:{InvitationsByEmail:"_getInvitationsByEmail"},initialize:function(){this.invitationsByEmail=new g({emailInputPlaceholder:e.t("connect_with_coworkers_input_placeholder"),inviteLabel:e.t("done"),successMessage:e.t("connect_with_coworkers_success")}),this.listenTo(this.invitationsByEmail,"success",this._triggerClose)},getTemplateData:function(){return{title:e.t("connect_with_coworkers_title"),description:e.t("connect_with_coworkers_description")}},_getInvitationsByEmail:function(){return this.invitationsByEmail},_optOut:function(){f.getOrFetch(i).optOut()},_triggerClose:function(){this.trigger("close")},onLightboxClose:function(){this._optOut()}});return j}),define("components/connect_with_coworkers/index",["require","./src/connect_with_coworkers"],function(a){"use strict";return a("./src/connect_with_coworkers")}),define("components/connect_with_coworkers/src/connect_with_coworkers_lightbox",["require","jquery","core/lib/backbone_base_class","collections/banners","core/lib/session","components/simple_lightbox/index","components/connect_with_coworkers/index"],function(a){"use strict";var b=a("jquery"),c=a("core/lib/backbone_base_class"),d=a("collections/banners"),e=a("core/lib/session"),f=a("components/simple_lightbox/index"),g=a("components/connect_with_coworkers/index"),h="connect-with-coworkers-lightbox",i=c.extend({run:function(){return this._runPromise=new b.Deferred,this._autoActivatedUser()?this._listenToBanners():this._rejectPromise(),this._runPromise},_listenToBanners:function(){d.hasFetched()?this._tryShow():(this.listenTo(d,"sync",this._tryShow.bind(this)),this.listenTo(d,"error",this._tryShow.bind(this)))},_tryShow:function(){return this.stopListening(),this._hasSeenLightbox()?this._rejectPromise():void this._show()},_listenForLightboxClose:function(){this.listenToOnce(this.simpleLightbox,"close",this._rejectPromise.bind(this))},_autoActivatedUser:function(){return e.getCurrentUser().auto_activated},_hasSeenLightbox:function(){return d.getOrFetch(h).isOptedOut()},_rejectPromise:function(){this._runPromise.reject()},_show:function(){var a=new g;this.simpleLightbox=new f({component:a}),this._listenForLightboxClose(),this.simpleLightbox.show()}});return i}),define("workfeed/lib/app/helpers/usage_policy_lightbox",["require","jquery","underscore","core/lib/backbone_base_class","core/lib/session","backbone","core/lib/tr","core/lib/urls","core/lib/yammer_api"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_class"),e=a("core/lib/session"),f=a("backbone"),g=a("core/lib/tr"),h=a("core/lib/urls"),i=a("core/lib/yammer_api"),j=d.extend({initialize:function(){c.bindAll(this,"_lightboxOnOpen","_lightboxOnClosed")},run:function(){this._runPromise=new b.Deferred;var a=e.getCurrentNetwork().get("usage_policy");a?this._displayUsagePolicy(a):i.getUsagePolicy().done(c.bind(this._displayUsagePolicy,this))},_displayUsagePolicy:function(a){return a&&a.needs_to_accept_usage_policy?(this._showUsagePolicyLightbox(a),this._runPromise.resolve()):void this._runPromise.reject()},_showUsagePolicyLightbox:function(a){var b=window.innerWidth>840?"780px":"90%",c={href:h.usagePolicyTask(),initialWidth:b,innerWidth:b,title:a.policy.title||g.t("network_usage_policy_title"),overlayClose:!1,escKey:!1,closeButton:!1,onOpen:this._lightboxOnOpen,onClosed:this._lightboxOnClosed};f.trigger("/ui/lightbox/open",c)},_lightboxOnOpen:function(){b("#yj-colorbox").addClass("usage-policy-box")},_lightboxOnClosed:function(){this.trigger("close"),b("#yj-colorbox").removeClass("usage-policy-box")}});return j}),define("workfeed/lib/app/helpers/add_colleagues_lightbox",["require","jquery","underscore","core/lib/backbone_base_class","core/lib/session","backbone","core/lib/tr","core/lib/urls"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_class"),e=a("core/lib/session"),f=a("backbone"),g=a("core/lib/tr"),h=a("core/lib/urls"),i=d.extend({initialize:function(){c.bindAll(this,"_lightboxOnOpen","_lightboxOnClosed")},run:function(){this._runPromise=new b.Deferred;var a=e.getCurrentUser();return a.get("show_invite_lightbox")?(this._showUsagePolicyLightbox(),this._runPromise.resolve()):this._runPromise.reject()},_showUsagePolicyLightbox:function(){var a={href:h.addColleaguesLightbox(),initialWidth:"610px",innerWidth:"610px",title:g.t("invite_new_members_title"),overlayClose:!0,onOpen:this._lightboxOnOpen,onClosed:this._lightboxOnClosed};f.trigger("/ui/lightbox/open",a)},_lightboxOnOpen:function(){b("#yj-colorbox").addClass("add-colleagues-lightbox")},_lightboxOnClosed:function(){b("#yj-colorbox").removeClass("add-colleagues-lightbox")}});return i}),define("common-ui/lib/helper/ms_tracking",[],function(){"use strict";return function(a){!!a&&$(function(){try{window.MscomCustomEvent("cot",0,"ms.ocpub.assetid",a)}catch(a){}})}}),define("common-ui/lib/ui/shared/type_ahead_tag_list_inviter",["require","underscore","common-ui/lib/ui/shared/type_ahead_tag_list"],function(a){var b=a("underscore"),c=a("common-ui/lib/ui/shared/type_ahead_tag_list");return c.extend({defaults:b.defaults({excludeEmails:!1,emailsOnly:!0,allowNonCanonicalEmails:!1,displayNonCanonicalEmails:!0},c.prototype.defaults),events:b.defaults({"paste .yj-bubble-field":"handleEntryFieldPaste"},c.prototype.events),id:"typeAheadTagListInviter",className:"yj-bubbles-container yj-bubbles-inviter",template:'      <div class="yj-bubbles">        <textarea class="yj-bubble-field yj-bubble-textarea" rows="1" wrap="off" />      </div>    ',handleEntryFieldPaste:function(a){a.stopPropagation(),b.defer(b.bind(function(){this._addEntriesFromString(this.content()),this._resetEntryField(),this._scrollToEntryField()},this))},_scrollToEntryField:function(){this.$entryField.blur().focus()}})}),define("common-ui/lib/ui/shared/task_list",["require","backbone","core/lib/backbone_base_view"],function(a){var b=a("backbone"),c=a("core/lib/backbone_base_view");return c.extend({initialize:function(){this.listenTo(b,"taskListComplete",this._complete)},_complete:function(a){var b=this.$el.find('[data-name="'+a+'"]'),c=this.$el.find(".top-progress-meter");if(b.length){var d=parseInt(c.data("completion"),10),e=parseInt(c.data("tasks"),10),f=Math.floor(100/e);d+=f,1===this.$el.find(".task").length&&(d=100),c.data("completion",d),c.find(".pm-label").text(d+"%"),c.find("#pm-progress").animate({width:d/100*170+"px"},"slow"),d>=100?this.$el.fadeOut("slow",this.remove.bind(this)):b.fadeOut("slow",b.remove.bind(b))}}})}),define("workfeed/lib/app/draggable_list",["require","jquery","underscore","mustache","common-ui/lib/helper/environment","core/lib/jam/component2","core/lib/ctor","backbone","core/lib/session","core/lib/string_helper","core/lib/yammer_api","jquery-dragsort"],function(a){var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("common-ui/lib/helper/environment"),f=a("core/lib/jam/component2"),g=a("core/lib/ctor"),h=a("backbone"),i=a("core/lib/session"),j=a("core/lib/string_helper"),k=a("core/lib/yammer_api");return a("jquery-dragsort"),g(null,f,{id:"draggableList",itemTemplate:'<li class="yj-draggable-list-item yj-clearfix {{last}}" data-item-id="{{id}}"><span class="yj-dnd-handle"><span class="yj-inline-icon dnd-handle-icon"></span></span><a href="javascript://" class="yj-close-link yj-menu-shadow-top"title="{{remove}}"><span class=yamicon yamicon-x"></span></a><span class="yj-name"><a class="yj-item-link" href="{{web_url}}">{{#name}}<span title="{{originalName}}">{{name}}</span>{{/name}}</a></span></li>',target:"",requireAdmin:!1,truncateNameAt:30,apiUrl:"",apiId:"id",getDeleteData:function(){},getPutData:function(){},createControls:function(){},fetchItems:function(){},onTemplating:function(){for(var a=0;a<this.items.length;a++)this.processItem(this.items[a]);return{model:{items:this.items,customClassName:this.customClassName},template:'<ul class="yj-draggable-list {{customClassName}} yj-clearfix yj-hide">{{#items}}'+this.itemTemplate+"{{/items}}</ul>"}},onLoad:function(){this.items=this.items||[],this.items.length||this.fetchItems(c.bind(function(){this.attachTo(b(this.target))},this))},canOrder:function(){return"undefined"==typeof this._canOrder&&(this._canOrder=!this.requireAdmin||this.requireAdmin&&j.convertStringyBoolean(i.getCurrentUser().admin)),this._canOrder},onRendered:function(){this.showHideByCount(),c.each(this.items,c.bind(function(a){this.addItemComponents(a)},this)),this.canOrder()&&(this.$el.addClass("yj-draggable"),this.$el.dragsort({dragSelector:".yj-draggable-list-item",dragEnd:c.partial(this.dragEnd,this)}))},dragEnd:function(a){var c=b(this),d=c.data(a.apiId),e=a.getPutData(c)||{};e.relationship_id=d,k.updateContentRelationship(e)},onAttach:function(){this.createControls()},processItem:function(a){a.originalName=a.official_name||a.full_name||a.name,a.name=j.truncate(a.originalName,this.truncateNameAt)},addItemComponents:function(a){e.isIOS()||this.addHovercard(a)},addHovercard:function(a){a.id&&a.type&&h.trigger("/ui/hovercard/add",this.$el.find('.yj-draggable-list-item[data-id="'+a.id+'"] .yj-item-link'),{id:a.id,type:a.type,orientation:"left"})},showHideByCount:function(){this.items.length>0?(this.$title&&this.$title.removeClass("yj-hide"),this.$el.removeClass("yj-hide")):(this.$title&&this.$title.addClass("yj-hide"),this.$el.addClass("yj-hide"))},events:{"mouseenter .yj-draggable-list-item":function(a){if(this.canOrder()&&0===this.$el.find(".yj-hover").length){var c=b(a.target).closest(".yj-draggable-list-item");c.addClass("yj-hover")}},"mouseleave .yj-draggable-list-item":function(a){if(this.canOrder()){var c=b(a.target).closest(".yj-draggable-list-item");c.removeClass("yj-hover")}},"click .yj-draggable-list-item":function(){return this.wasDragging?(this.wasDragging=!1,!1):void 0},"click .yj-close-link":function(a){a.preventDefault();var d=b(a.target).closest(".yj-close-link"),e=d.closest(".yj-draggable-list-item"),f=e.data("id"),g=e.data(this.apiId),h=this.getDeleteData(e)||{};h.relationship_id=g,k.deleteContentRelationship(h).then(c.bind(function(a){e.fadeOut("slow").remove(),c.each(this.items,c.bind(function(a){a.id==f&&this.items.splice(this.items.indexOf(a),1)},this)),this.$el.trigger("itemRemoved",a)},this))},itemAdded:function(a,c){this.showHideByCount(),this.processItem(c),b(d.render(this.itemTemplate,c)).appendTo(this.$el),this.addItemComponents(c)},itemRemoved:function(){this.showHideByCount()}},onDestroy:function(){b("body").off("mouseup.draggableList")}})}),define("workfeed/lib/app/draggable_resource_list",["require","jquery","core/lib/ctor","workfeed/lib/app/draggable_list"],function(a){var b=a("jquery"),c=a("core/lib/ctor"),d=a("workfeed/lib/app/draggable_list");return c(null,d,{id:"draggableResourceList",trackingParam:"draggable_resource_list_action",itemTemplate:'<li class="yj-draggable-list-item yj-file-list-item yj-clearfix {{last}}{{#og_icon}} yj-og-file-list-item{{/og_icon}}" data-id="{{id}}" data-content-rel-id="{{cid}}" data-type="{{type}}">         <span class="yj-dnd-handle"><span class="yj-inline-icon dnd-handle-icon"></span></span>         <a href="javascript://" class="yj-close-link yj-menu-shadow-top" title="{{remove}}">           <span class="yamicon yamicon-x"></span>         </a>         {{#og_icon}}         <a class="yj-item-link" {{#is_first_party}}target="_blank"{{/is_first_party}} href="{{web_url}}" tabindex="-1" aria-hidden="true">            <span class="yj-image yj-file-type">              <img class="yj-og-file-type-icon" alt="{{type}}" height="40" width="40" src="{{og_icon}}">            </span>         </a>         {{/og_icon}}         {{^og_icon}}         <a class="yj-thumbnail-container yj-file-type yj-item-link" {{#is_first_party}}target="_blank"{{/is_first_party}} href="{{web_url}}" tabindex="-1" aria-hidden="true">             {{#yamicon}}               <span class="yamicon yamicon-{{yamicon}} {{#title}}yj-page-icon{{/title}} {{#site_name}}yj-ogo-icon{{/site_name}}"></span>             {{/yamicon}}             {{#icon}}               <img class="yj-thumbnail {{#title}}yj-page-icon{{/title}} {{#site_name}}yj-ogo-icon{{/site_name}}" src="{{icon}}" alt="">             {{/icon}}         </a>         {{/og_icon}}        <span class="yj-name"><a class="file-link yj-item-link" {{#is_first_party}}target="_blank"{{/is_first_party}} href="{{web_url}}">          {{#name}}<span title="{{originalName}}">{{name}}</span>{{/name}}        </a></span>        <span class="yj-byline">{{ago}}</span>      </li>',title:"",sourceType:"network",listedTypes:"page,uploaded_file,open_graph_object",customClassName:"yj-file-list",apiUrl:"/api/v1/content_relationships/",apiId:"content-rel-id",onLoad:function(){if(!this.sourceId)throw new Error('param "sourceId" is required for DraggableResourceList');d.prototype.onLoad.apply(this,arguments)},onRendered:function(){this.$title=b(this.title),d.prototype.onRendered.apply(this,arguments)},getDeleteData:function(){var a={};return a[this.trackingParam]="remove",a},getPutData:function(a){var b={source_type:this.sourceType,source_id:this.sourceId,listed_types:this.listedTypes,position:this.$el.find("li").index(a),target_id:a.data("id"),target_type:a.data("type")};return b[this.trackingParam]="update",b},processItem:function(a){d.prototype.processItem.call(this,a),this.addIcon(a)},addIcon:function(a){"group"===a.type?a.icon=a.mugshot_url:"page-pen-icon"===a.content_class?a.yamicon="old-note":"open_graph_object"===a.type&&(a.yamicon="link")}})}),define("workfeed/lib/modules/link_lightbox_url_util",["require","jquery","underscore","core/lib/backbone_base_class","core/lib/date_helper","core/lib/session","core/lib/uri_helper","core/lib/yammer_request","core/lib/yammer_uri","core/lib/urls","core/lib/yammer_api"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_class"),e=a("core/lib/date_helper"),f=a("core/lib/session"),g=a("core/lib/uri_helper"),h=a("core/lib/yammer_request"),i=a("core/lib/yammer_uri"),j=a("core/lib/urls"),k=a("core/lib/yammer_api"),l="!INTRANET_URL!",m=d.extend({previewLink:function(a){this._isInternal(a)&&!this._getThreadIdForCurrentYammerNetwork(g.parse(a))?this.trigger("previewLinkEnd",{description:"Yammer",official_name:"Yammer",object_type:"page"}):this._fetchData(b.trim(a,"\\s "))},_fetchData:function(a){var c=function(a){return a.object=a.object||a.oembed,a.app_data=a.app_data||{},a.app_data.type||(a.app_data.type="embedly"),a.full_name=b.trim(a.full_name),a.description=b.trim(a.description),a},d=this;this._retrieveEmbedData(a,function(a){var b=c(a);d.trigger("previewLinkEnd",b)},function(a){d.trigger("previewLinkEnd",{error:!0,message:a})})},_isInternal:function(a){var b=!1,d=g.parse(a).host,e=["www.yammer.dev","www.yammer.com","www.staging.yammer.com"];return c.each(e,function(a){d===a&&(b=!0)}),b},_stringIsAcceptableURL:function(a){var b=g.HREF_PATTERN,c=a.match(b);return c?-1!==c[0].indexOf(".")?!0:l:!1},_getThreadIdForCurrentYammerNetwork:function(a){var b,c,d=a.protocol+"://"+a.authority+a.path,e=f.getCurrentNetwork();return d===j.networkIndex(e)+"/"&&(b=a.anchor.match(/threadId=(\d+)/),c=b&&b.length&&b[1]),c},_retrieveEmbedData:function(a,c,d){var f=function(a){var b=g.parse(a),c=[];null!=b.protocol&&c.push(b.protocol.toLowerCase()+":"),null!=b.authority&&c.push("//"+b.authority);for(var d=(b.path||"/").split("/"),e=[],f=0;f<d.length;f++){var h=d[f];"."!==h&&(".."===h?e.pop():h&&e.push(h))}return c.push("/"+(e.length>0?e.join("/"):"")),b.query&&c.push("?"+b.query),b.anchor&&c.push("#"+b.anchor),c.join("")},j=new function(){var a=null,b=null;this.availableToFetch=function(){return a},this.fetch=function(c,d,e){var f,g;this.availableToFetch&&(f=function(){clearTimeout(a),a=null,b=null,e()},g=function(e){null!=a&&b!==c||(clearTimeout(a),a=null,b=null,d(e))},b=c,a=setTimeout(f,5e3),setTimeout(function(){h.send({type:"PUT",dataType:"json",url:i.base("/api/v1/open_graph_objects/update"),data:{url:c},success:g,error:f})},0))}};a.match(/^[^:\/?#]+:\/\/.*/)||(a="http://"+a);var m=this._stringIsAcceptableURL(a);if(!m)return void d("Please insert a properly formatted url like http://my-link.com");if(m===l)return void c({url:a});var n,o,p=380,q=g.parse(a);if(q.authority.match(/flickr\.(?:com|[^\.]{2,3}\.[^\.]{2})(?::\d+)?$/)||q.authority.match(/slideshare.net/))p=600;else if(n=q.authority.match(/^(.*)\.google\.com$/));else if(o=this._getThreadIdForCurrentYammerNetwork(q)){var r=function(d){if(!d.messages||!d.messages.length)return void c({url:a});var f=d.references,g=b.grep(f,function(a){return"group"===a.type})[0],h=d.messages[0],i=b.grep(f,function(a){return"user"===a.type&&a.id===h.sender_id})[0],j="Yammer conversation started by "+i.full_name;"undefined"!=typeof g&&(j+=" to "+g.full_name);var k;k="private"!==h.privacy?h.body.plain+"\n at "+e.formatDateTime(new Date(h.created_at)):"Private conversation",c({web_url:a,full_name:j,official_name:j,description:k,internal_shared_thread_id:o,object_type:"page"})};return void k.getThread({threadId:o,threaded:!0}).then(r,function(){c({url:a})})}var s=f(a);j.fetch(s,function(b){"error"===b.type?c({url:a}):(b.web_url.match(/box.net\/shared/)&&(b.description=void 0),c(b))},function(){c({url:a})})}});return m}),define("stache!workfeed/lib/modules/add_link_lightbox",["mustache"],function(a){var b='<div class="yj-lightbox-content yj-add-link-lightbox">\n  <form class="yj-add-link-form">\n    <div class="yj-add-link-lightbox-field-wrap">\n      <span class="yj-error">{{invalidUrlError}}</span>\n      <label class="yj-add-link-lightbox-label">{{urlLabel}}\n        <input type="text" name="link_url" class="yj-link-text yj-add-link-lightbox-field-url yj-add-link-lightbox-field" aria-required="true">\n      </label>\n      <div class="clear"></div>\n    </div>\n    {{#editTitle}}<div class="yj-add-link-lightbox-field-wrap">\n      <label class="yj-add-link-lightbox-label">{{titleLabel}}\n        <input type="text" name="link_title" placeholder="{{optionalLabel}}" class="yj-link-text yj-add-link-lightbox-field yj-add-link-lightbox-field-title">\n      </label>\n      <span class="yj-add-link-lightbox-spinner-container"><span class="yj-add-link-lightbox-spinner yj-inline-spinner" style="display: none;"></span></span>\n      <div class="clear"></div>\n      <div class="yj-add-link-preview" style="display: none;"></div>\n\n    </div>{{/editTitle}}\n    <div class="yj-add-link-submit-wrap">\n      <button class="yj-btn yj-add-link-form-submit yj-btn-disabled unstyle-button-as-span" disabled>{{submitBtnText}}</button>\n    </div>\n  </form>\n</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/modules/add_link_lightbox",["require","jquery","underscore","workfeed/lib/modules/link_lightbox_url_util","backbone","core/lib/tr","core/lib/uri_helper","core/lib/yammer_request","html!./add_link_lightbox"],function(a){var b=a("jquery"),c=a("underscore"),d=a("workfeed/lib/modules/link_lightbox_url_util"),e=a("backbone"),f=a("core/lib/tr"),g=a("core/lib/uri_helper"),h=a("core/lib/yammer_request"),i=a("html!./add_link_lightbox");return function(){var a={invalidUrlError:f.t("please_enter_a_valid_url"),urlLabel:f.t("url"),titleLabel:f.t("title"),optionalLabel:f.t("optional_field")},j=function(a){this.template=i;var c={triggerElement:"",lightboxTitle:f.t("add_a_link"),submitBtnText:f.t("add"),editTitle:!1,readOnlyTitle:f.t("this_title_cannot_be_edited"),template:this.template};return this._settings=b.extend(c,a),this._linkPublisher=new d,this._currentUrl=null,this};return j.prototype.init=function(){var a=this._settings,c=this.renderTemplate(),d=this;return b(a.triggerElement).on("click",function(){e.trigger("/ui/lightbox/open",{html:c,initialWidth:"450px",innerWidth:"450px",title:a.lightboxTitle,onComplete:function(){d.onRender()}})}),this},j.prototype.renderTemplate=function(){return this._settings.template(c.extend(a,{submitBtnText:this._settings.submitBtnText,editTitle:this._settings.editTitle}))},j.prototype._addLinkPublisherListeners=function(){var a=this;a._linkPublisher.on("previewLinkEnd",function(c){b(".yj-add-link-lightbox-spinner").hide();var d=a.$element.find(".yj-add-link-lightbox-field-title");d.prop("readOnly",!1),d.removeClass("yj-disabled"),c&&c.description&&c.description.length>0&&d.val(c.official_name),c.object_type||setTimeout(function(){d.addClass("yj-disabled").prop("readOnly",!0).val(a._settings.readOnlyTitle)},10)})},j.prototype.onRender=function(){var a,c=this;c.$element=b(".yj-add-link-lightbox"),c._addLinkPublisherListeners(),c._isValid=!1,c._isProcessing=!1;var d=c.$element.find(".yj-add-link-form");c.$element.find(".yj-add-link-lightbox-field-url").focus().val("http://").on("blur",function(){c.validate()}).on("keyup",function(){clearTimeout(a),a=setTimeout(function(){c.validate()},300)}),d.on("submit",function(){return c.validate(),c._isValid&&c.ogoRequest(d.find(".yj-add-link-lightbox-field-url").val()),!1}),d.on("keypress",function(a){return c._isValid&&13==a.keyCode?(a.preventDefault(),a.stopImmediatePropagation(),c.ogoRequest(d.find(".yj-add-link-lightbox-field-url").val()),!1):void 0}),d.find(".yj-btn").on("click",function(a){a.preventDefault(),a.stopPropagation(),c._isValid&&!b(this).hasClass("yj-btn-disabled")&&c.ogoRequest(d.find(".yj-add-link-lightbox-field-url").val())})},j.prototype.validate=function(){var a=this.$element,d=a.find(".yj-btn"),e=this,f=!1;if(!this._isProcessing){var h,i,j=a.find(".yj-add-link-lightbox-field-url").val();if(h=j.match(g.HREF_PATTERN)){if(i=h[0],i!=this._currentUrl&&(this._currentUrl=i),this._settings.editTitle){f||(this._linkPublisher.previewLink=c.throttle(this._linkPublisher.previewLink,1e3),f=!0),b(".yj-add-link-lightbox-spinner").show();var k=b(".yj-add-link-lightbox-field-title");k.addClass("yj-disabled"),k.prop("readOnly",!0),this._linkPublisher.previewLink(i)}d.removeClass("yj-btn-disabled").prop("disabled",!1),a.find(".yj-error").hide(),a.find(".yj-add-link-lightbox-field-url").removeAttr("aria-invalid"),e._isValid=!0}else d.addClass("yj-btn-disabled").prop("disabled",!0),a.find(".yj-error").show(),a.find(".yj-add-link-lightbox-field-url").attr("aria-invalid",!0),e._isValid=!1;this._prevLength=j.length}return this},j.prototype.ogoRequest=function(a){var c=this,d=c._settings,g=b(".yj-add-link-lightbox-field-title").val(),i=c.$element.find(".yj-btn").text(),j={url:a};c._isProcessing=!0,c.$element.find(".yj-btn").addClass("yj-btn-disabled").prop("disabled",!0).text(f.t("adding")+"..."),g&&/\S/.test(g)&&g!=d.readOnlyTitle&&(j.official_title=g);var k=function(a){e.trigger("/ui/lightbox/close"),b(d.triggerElement).trigger("linkAdded",a);
},l=function(a){var b=a.responseJSON&&a.responseJSON.open_graph_object;return b?void k(b):(e.trigger("/ui/alert/show","error",f.t("there_was_a_problem_processing_your_request_please_try_again")),c._isProcessing=!1,c.validate(),void c.$element.find(".yj-btn").text(i))};h.send({url:"/api/v1/open_graph_objects/update",type:"PUT",dataType:"json",data:j,success:k,error:l})},j}()}),define("workfeed/lib/modules/related_content",["require","jquery","underscore","mustache","workfeed/lib/modules/add_link_lightbox","core/lib/date_helper","common-ui/lib/ui/general/lightbox_manager","core/lib/namespace","backbone","core/lib/filename_helper","core/lib/secure_opener","core/lib/tr","core/lib/yammer_api","feeds/lib/ui/attachments/selector","common-ui/lib/helper/svg_icon","core/lib/urls","core/lib/yammer_uri"],function(a){var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("workfeed/lib/modules/add_link_lightbox"),f=a("core/lib/date_helper"),g=a("common-ui/lib/ui/general/lightbox_manager"),h=a("core/lib/namespace"),i=a("backbone"),j=a("core/lib/filename_helper"),k=a("core/lib/secure_opener"),l=a("core/lib/tr"),m=a("core/lib/yammer_api"),n=a("feeds/lib/ui/attachments/selector"),o=a("common-ui/lib/helper/svg_icon"),p=a("core/lib/urls"),q=a("core/lib/yammer_uri");return h.ns("yam.workfeed"),yam.workfeed.RelatedContentController=function(a){var h=this;a.addToDom=void 0===a.addToDom,this.$list=a.ListId?b(a.ListId):a.parentObj.$el,this.onRelationshipCreated=function(b,e){var g=c.findWhere(b.references,{id:e.id})||{};"page"===g.type?g.content_class="page-pen-icon":"uploaded_file"===g.type?g.content_class="document-"+j.getCanonicalExtension(g.name)+"-icon":"open_graph_object"===g.type&&(g.content_class="link-icon");var i;i="uploaded_file"===g.type?j.getCanonicalExtension(g.name):"page"===g.type?"note":"link",g.og_icon=q.cdn("assets/images/file_icons/types/og_40/doc-"+i+".png");var k=g.created_at||g.last_published_at||g.updated_at;k?"uploaded_file"===g.type?g.ago=l.t("uploaded_time",{time:f.formatAgo(new Date(k),new Date,!1)}):g.ago=l.t("published_time",{time:f.formatAgo(new Date(k),new Date,!1)}):g.ago=l.t("draft"),g.remove=l.t("remove_from_list"),"uploaded_file"===g.type?g.name=h.fileName(g.name,g.type):"page"===g.type?g.name=g.name:"open_graph_object"===g.type&&(g.name=g.official_name||g.name||g.site_name||p.ogoIndex(g));var m=c.findWhere(b.content_relationships,{source_id:a.source_id,target_id:e.id});if(m&&(g.cid=m.id),g.is_first_party||(g.web_url=g.internal_url),a.addToDom){var n,t=j.getFileIconClass(g.preview_url),u="docicon-"+t,v=o(u,{classList:"related-content--svg-icon-thumbnail"});if(n=d.render(a.itemTemplate,{items:[g],svgIconThumbnail:v}),h.$list.append(n),"page"===g.type){var w='<a class="file-link" href="'+c.escape(g.web_url)+'"><span title="'+c.escape(g.name)+'">'+c.escape(g.name)+"</span></a>";h.$list.find("li:last .yj-name").html(w)}}else a.parentObj.items.push(g);if(h.$list.trigger("itemAdded",g),r(),"page"===g.type||"uploaded_file"===g.type){var x=h.$list.find('.yj-file-list-item[data-id="'+g.id+'"]');s(x)}},this.fileName=function(a){return a.substr(0,a.lastIndexOf("."))||a},b(".popular-content").delegate("li","click",function(a){var c=b(a.target);if(!c.hasClass("yj-trending-posted-by")&&!c.parents(".yj-name").length){a.preventDefault();var d=b(this).find(".yj-name a").attr("href");window.location=d}}),a.inDraggableList||this.$list.delegate("li","click",function(a){var c=b(a.target).closest("a"),d=c.data("content-rel-id"),e={relationship_id:d,related_content_action:"remove"};if(c.hasClass("yj-close-link"))return a.preventDefault(),void m.deleteContentRelationship(e).then(function(c){h.$list.trigger("itemRemoved",c),b(a.currentTarget).remove(),r()});if((c.hasClass("yj-detail")||0===c.length||c.hasClass("file-link"))&&!b(a.target).closest("a").length){a.preventDefault();var f=b(this).find(".yj-name a"),g=f.attr("href");return void("_blank"===f.attr("target")?k.open(g):window.location=g)}}),b(a.buttons).bind("click",function(c){var d={};d.id=a.source_id,d.type=a.source_type;var e,f={inLightbox:!0,defaultSelector:b(c.currentTarget).attr("id").match("get-page")?n.PAGES:n.FILES,groupId:a.group_id,sourceId:d.id},j=new n(f),k={title:l.t("select_an_attachment"),width:"800",height:"480",overlayClose:!1,onComplete:function(){j.addUploader()}},o=h.onRelationshipCreated.bind(h),p=function(b){if(d.id===b.id&&d.type===b.type){var c="page"===d.type?l.t("a_note_cannot_be_related_to_itself"):l.t("a_file_cannot_be_related_to_itself");return void i.trigger("/ui/alert/show","error",c)}var e={source_id:d.id,source_type:d.type,target_id:b.id,target_type:b.type};a.inDraggableList?e.company_resources_action="add":e.related_content_action="add",m.createContentRelationship(e).then(function(a){o(a,b)})};e=g.openComponent(j,"yj-attachment-selector-lightbox",void 0,k),e.on("select",p),c.stopPropagation()}),new e({triggerElement:"#get-link",editTitle:!0}).init(),b("#get-link").on("linkAdded",function(b,d){if(a.source_id===d.id&&a.source_type===d.type)return void i.trigger("/ui/alert/show","error",l.t("a_page_cannot_be_related_to_itself"));var e=h.onRelationshipCreated.bind(h);m.createContentRelationship({source_type:a.source_type,source_id:a.source_id,target_type:"open_graph_object",target_id:d.id}).then(c.partial(e,c,d))});var r=function(){for(var a=h.$list.find("li"),c=b(".popular-content li"),d=0,e=c.length;e>d;d++)b(c[d]).removeClass("last-item"),d+1===e&&b(c[d]).addClass("last-item");for(var f=0,g=a.length;g>f;f++)b(a[f]).removeClass("last-item"),f+1===g&&b(a[f]).addClass("last-item");var i=b(".related-content-header, .related-content h6");c.length&&a.length?i.show():i.hide();var j=b("#related-alt-content");c.length||a.length?j.hide():j.show()};r();var s=function(a){i.trigger("/ui/hovercard/add",a,{id:a.data("id"),type:a.data("contentType"),orientation:"left"})};b(".related-content li").each(function(){s(b(this))})}}),define("workfeed/lib/modules/company_resources_list",["require","core/lib/ctor","workfeed/lib/app/draggable_resource_list","workfeed/lib/modules/related_content"],function(a){var b=a("core/lib/ctor"),c=a("workfeed/lib/app/draggable_resource_list"),d=a("workfeed/lib/modules/related_content");return b(null,c,{customClassName:"yj-file-list",trackingParam:"company_resources_action",createControls:function(){new d({parentObj:this,source_type:"network",source_id:this.sourceId,buttons:"#get-page, #get-file",itemTemplate:this.itemTemplate,addToDom:!1,inDraggableList:!0})}})}),define("workfeed/lib/app/related_groups_list",["require","jquery","underscore","core/lib/ctor","workfeed/lib/app/draggable_resource_list","common-ui/lib/ui/shared/type_ahead","core/lib/tr","core/lib/yammer_api","core/lib/yammer_uri","core/lib/urls"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/ctor"),e=a("workfeed/lib/app/draggable_resource_list"),f=a("common-ui/lib/ui/shared/type_ahead"),g=a("core/lib/tr"),h=a("core/lib/yammer_api"),i=a("core/lib/yammer_uri"),j=a("core/lib/urls");return d("yam.workfeed.RelatedGroupsList",e,{id:"relatedGroupsList",cssClass:"yj-related-groups-list",trackingParam:"related_groups_action",truncateNameAt:25,maxItems:5,sourceType:"group",listedTypes:"group",onRendered:function(){e.prototype.onRendered.apply(this,arguments),c.extend(this.events,this.customEvents)},onAttach:function(){if(e.prototype.onAttach.apply(this,arguments),this.items.length>this.maxItems+1){var a=this.items.length-this.maxItems;this.setExpanded(!0),this.toggleItems(!1),this.$othersLink=b('<div class="yj-others-link"><a href="javascript://">'+g.t("count_others",{count:a})+"</a></div>"),this.$el.append(this.$othersLink),this.$seeAllLink=b('<a class="yj-see-all-link '+this.redesignInitTypographyContent+'" href="javascript://">'+g.t("see_all_2")+"</a>"),this.$seeAllLink.click(this.toggleItems.bind(this)),this.$title.append(this.$seeAllLink)}yam.router.once("route",this.destroy,this)},customEvents:{"click .yj-others-link":function(){this.toggleItems(!0)}},isExpanded:function(){return"undefined"==typeof this._isExpanded&&(this._isExpanded=!1),this._isExpanded},setExpanded:function(a){this._isExpanded=a},toggleItems:function(a){var b=a?"slideToggle":"toggle";this.isExpanded()?this.$el.find(".yj-file-list-item").slice(this.maxItems,this.items.length+1)[b]():(this.$el.find(".yj-file-list-item:hidden")[b](),this.$seeAllLink&&this.$seeAllLink.hide(),this.$othersLink&&this.$othersLink.hide()),this.setExpanded(!this.isExpanded())},fetchItems:function(a){var b=this;h.getContentRelationships({source_type:this.sourceType,source_id:this.sourceId,by_position:!0}).then(function(d){var e=c.chain(d.references).compact().where({type:"group"}).value();b.items=c.chain(d.content_relationships).where({target_type:"group"}).map(function(a){var b=c.findWhere(e,{id:a.target_id});return b&&(b.cid=a.id),b}).compact().value(),a()})},createControls:function(){var a={completableModels:["group"],scrollResults:!0,showTopRankings:!0,onSelect:this.handleSelect.bind(this),noCache:!1,noResultsAction:!0,noResultsMessage:g.t("sorry_unlisted_groups_cant_be_added"),watermarkText:g.t("add_a_related_group"),watermarkIcon:i.cdn("assets/images/icons/add-icon.png"),filter:c.bind(function(a,b){var d=!1;return c.each(this.items,function(a){a.id==b.id&&(d=!0)}),!d&&b.id!==this.sourceId&&b.show_in_directory},this)};this.$inputDiv=b('<div class="yj-related-groups-ta yj-padded-ta yj-ta-spinner-wrap"><label for="'+this.getId()+'-input" class="yj-acc-hidden"></label><input id="'+this.getId()+'-input" type="text" class="yj-related-groups-field" autocomplete="off"><div class="yj-ta-spinner"></div></div>'),this.$input=this.$inputDiv.find(".yj-related-groups-field"),this.$spinner=this.$inputDiv.find(".yj-ta-spinner"),this.$el.after(this.$inputDiv),this.$inputDiv.find("label").text(a.watermarkText),f.registerField(this.$input,a)},handleSelect:function(a){var b=this,d={source_type:this.sourceType,source_id:this.sourceId,target_id:a.id,target_type:"group"};d[this.trackingParam]="add",c.findWhere(this.items,{id:parseInt(a.id,10)})||(this.$spinner.show(),h.createContentRelationship(d).then(function(a){var e=c.findWhere(a.references,{type:"group",id:parseInt(d.target_id,10)}),f=c.findWhere(a.content_relationships,{target_type:"group",target_id:parseInt(d.target_id,10)});e&&f&&(e.cid=f.id,b.items.push(e),b.items.length>b.maxItems+1&&!b.isExpanded()&&b.toggleItems(!0),b.$el.trigger("itemAdded",e)),b.$spinner.hide()}),c.delay(this.$input.blur.bind(this.$input)))},showHideByCount:function(){this.items.length>0?this.$el.removeClass("yj-hide"):this.$el.addClass("yj-hide")},onDestroy:function(){e.prototype.onDestroy.apply(this,arguments),f.removeField(this.$input),this.$inputDiv.remove(),yam.router.off("route",this.destroy,this)},processItem:function(a){e.prototype.processItem.call(this,a),a.web_url=j.groupIndex(a)}})}),define("workfeed/lib/modules/quick_links",["require","jquery","underscore","common-ui/lib/ui/general/lightbox_manager","core/lib/namespace","core/lib/string_helper","common-ui/lib/helper/environment","core/lib/uri_helper"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/general/lightbox_manager"),e=a("core/lib/namespace"),f=a("core/lib/string_helper"),g=a("common-ui/lib/helper/environment"),h=a("core/lib/uri_helper");return e.ns("yam.workfeed"),yam.workfeed.QuickLinks={init:function(){var a=".yj-quick-link[data-component-class]";b(window.document).on("click",a,function(){for(var a,b={},c=0,g=this.attributes.length;g>c;c++)a=this.attributes.item(c),b[a.nodeName]=a.nodeValue;var i,j,k={},l={};for(i in b)(i.match(/data-component-opts-/)||i.match(/data-lightbox-opts-/))&&(j=b[i],"true"==j||"false"==j?j=f.convertStringyBoolean(j):j.match(/"^[0-9]+$"/)&&(j=parseInt(j,10)),i.match(/data-component-opts-/)?k[f.camelize(i.replace("data-component-opts-",""))]=j:i.match(/data-lightbox-opts-/)&&(l[f.camelize(i.replace("data-lightbox-opts-",""))]=j));k.postToFeed&&(k.postToFeedId=h.objectify(document.location.href).feedId);var m=b["data-lightbox-opts-class-override"]||"yj-quick-link-lightbox yj-scrollbar-fix",n=e.ns(b["data-component-class"]);d.openComponent(new n(k),m,void 0,l)}),b(".yj-quick-links-list").has("li").length||b(".yj-quick-links").hide(),g.isIOS()&&b(".yj-quick-link-upload-file").hide()}},yam.workfeed.QuickLinks.init=c.once(yam.workfeed.QuickLinks.init),yam.workfeed.QuickLinks}),define("workfeed/lib/modules/windows_notifier",["require","jquery","core/lib/ctor","common-ui/lib/helper/environment"],function(a){var b=a("jquery"),c=a("core/lib/ctor"),d=a("common-ui/lib/helper/environment");return c("yam.workfeed.WindowsNotifier",{init:function(){var a=b(".windows-notifier .yj-btn"),c=navigator.userAgent,e="https://assets.yammer.com/application_support/windows_notifier/Yammer.Notifier.application",f="https://assets.yammer.com/application_support/windows_notifier/setup.exe";a.on({mouseenter:function(){b(this).addClass("yj-mouseover")},mouseleave:function(){b(this).removeClass("yj-mouseover")}}),c.match(/NET[4-9]/)||d.isIE()&&d.isIE().version>9?a.attr("href",e):a.attr("href",f)}})}),define("workfeed/lib/app/bundles/home_bundle",["require","core/lib/session","feeds/lib/modules/attachments","components/connect_with_coworkers/src/connect_with_coworkers_lightbox","workfeed/lib/app/helpers/usage_policy_lightbox","workfeed/lib/app/helpers/add_colleagues_lightbox","common-ui/lib/helper/ms_tracking","common-ui/lib/ui/groups/group_privacy_controls","common-ui/lib/ui/groups/member_list","common-ui/lib/ui/shared/type_ahead_tag_list_add_members","common-ui/lib/ui/shared/type_ahead_tag_list_inviter","common-ui/lib/ui/shared/task_list","workfeed/lib/modules/company_resources_list","workfeed/lib/modules/observe_field","workfeed/lib/app/related_groups_list","workfeed/lib/modules/quick_links","workfeed/lib/modules/windows_notifier","workfeed/lib/app/embed_group_feed_dialog"],function(a){"use strict";var b=a("core/lib/session"),c=a("feeds/lib/modules/attachments"),d=a("components/connect_with_coworkers/src/connect_with_coworkers_lightbox"),e=a("workfeed/lib/app/helpers/usage_policy_lightbox"),f=a("workfeed/lib/app/helpers/add_colleagues_lightbox"),g=a("common-ui/lib/helper/ms_tracking");a("common-ui/lib/ui/groups/group_privacy_controls"),a("common-ui/lib/ui/groups/member_list"),a("common-ui/lib/ui/shared/type_ahead_tag_list_add_members"),a("common-ui/lib/ui/shared/type_ahead_tag_list_inviter"),a("common-ui/lib/ui/shared/task_list"),a("workfeed/lib/modules/company_resources_list"),a("workfeed/lib/modules/observe_field"),a("workfeed/lib/app/related_groups_list"),a("workfeed/lib/modules/quick_links"),a("workfeed/lib/modules/windows_notifier"),a("workfeed/lib/app/embed_group_feed_dialog");var h=function(){var a=b.getCurrentUser();c.init(a.attachments),i(),g("Yammer Home")},i=function(){j()&&k()},j=function(){var a=yam.router;return a&&a.hasLoadedView()},k=function(){var a=l(d);a().then(m,l(e)).then(m,l(f))},l=function(a){return function(){return(new a).run()}},m=function(){};return{run:h}}),define("core/lib/util/sorted_dictionary",["require","core/lib/ctor"],function(a){var b=a("core/lib/ctor");return b(null,{init:function(a){this._hash={},this._keys=[],a&&this.mixin(a)},count:function(){return this._keys.length},put:function(a,b){this.exists(a)||this._keys.push(a),this._hash[a]=b},get:function(a){return this._hash[a]},remove:function(a){if(this.exists(a)){delete this._hash[a];for(var b=this._keys,c=0,d=b.length;d>c;++c)if(a==b[c]){b.splice(c,1);break}}},putByIndex:function(a,b,c){this._keys.splice(a,0,b),this._hash[b]=c},getByIndex:function(a){return this._hash[this._keys[a]]},removeByIndex:function(a){var b=this._keys[a];"undefined"!=typeof this._hash[b]&&(delete this._hash[b],this._keys.splice(a,1))},push:function(a,b){return this.putByIndex(this._keys.length,a,b),this._keys.length},pop:function(){var a=this._keys.length-1,b=this._hash[this._keys[a]];return"undefined"!=typeof b?(this.removeByIndex(a),b):void 0},unshift:function(a,b){return this.putByIndex(0,a,b),this._keys.length},shift:function(){var a=this._hash[this._keys[0]];return"undefined"!=typeof a?(this.removeByIndex(0),a):void 0},exists:function(a){return void 0!==this._hash[a]},keys:function(){return this._keys.sort()},rawKeys:function(){return this._keys},values:function(){for(var a=[],b=this._hash,c=this.keys(),d=0,e=c.length;e>d;++d)a.push(b[c[d]]);return a},rawValues:function(){for(var a=[],b=this._hash,c=this.rawKeys(),d=0,e=c.length;e>d;++d)a.push(b[c[d]]);return a},mixin:function(a){for(var b in a)a.hasOwnProperty(b)&&this.put(b,a[b])},toHash:function(){return this._hash},each:function(a){for(var b,c=this._hash,d=this._keys,e=0,f=d.length;f>e;e++)b=d[e],a(b,c[b])},sort:function(a){for(var b,c=this._keys,d=[],e=a||function(a,b){return a.val>=b.val?1:-1},f=0,g=c.length;g>f;f++)b=c[f],d[f]={key:b,val:this._hash[b]};for(d.sort(e),this._keys=[],f=0,g=d.length;g>f;f++)this._keys.push(d[f].key)},sortByKey:function(){return this.sort(function(a,b){return a.key>=b.key?1:-1})}})}),define("stache!feeds/lib/ui/chat/chat_settings_menu",["mustache"],function(a){var b='<div class="yj-chat-settings-menu-arrow-border"></div>\n<div class="yj-chat-settings-menu-arrow"></div>\n<ul class="yj-chat-settings-menu-list"></ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/chat/chat_settings_menu_item",["mustache"],function(a){var b='{{#items}}<li class="yj-item"><a href="javascript:void(0)" class="yj-item-anchor {{selectedClass}}" role="checkbox"\n  aria-checked="{{selectedBool}}" data-chat-settings-item="{{id}}">{{text}}</a></li>\n{{/items}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/chat/chat_settings_menu",["require","jquery","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./chat_settings_menu","html!./chat_settings_menu_item"],function(a){var b=a("jquery"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("html!./chat_settings_menu"),f=a("html!./chat_settings_menu_item");return c.extend({mixins:[d],tagName:"div",template:e,itemTemplate:f,className:"yj-chat-settings-menu           yj-chat-clickmenu yj-click-menu yj-click-menu-content           yj-menu-shadow yj-menu yj-settings",attributes:{"data-yamjs":"chat-settings"},events:{click:"handleClick"},render:function(){var a,c,d;return this.items.count()&&(a=this.items.rawValues(),c={items:a},d=b(this.itemTemplate(c)),this.$el.find("ul").append(d)),this},initialize:function(a){var b=this;this.items=a.items,this.context=a.context,this.items.each(function(a,c){c.selectedClass=c.isSelected.call(b.context)?"yj-selected":"",c.selectedBool=c.isSelected.call(b.context)})},handleClick:function(a){var c,d=b(a.target),e=d.attr("data-chat-settings-item");e&&(d.hasClass("yj-selected")?(c="off",this.removeSelection(e),d.attr("aria-checked",!1)):(c="on",this.addSelection(e),d.attr("aria-checked",!0)),this.trigger("settings",{id:e,state:c}))},toggleSelection:function(a){var b=a.attr("data-chat-settings-item");b&&(a.hasClass("yj-selected")?(this.removeSelection(b),a.attr("aria-checked",!1)):(this.addSelection(b),a.attr("aria-checked",!0)))},addSelection:function(a){this.setSelection("add",a)},removeSelection:function(a){this.setSelection("remove",a)},setSelection:function(a,b){var c=this.$el.find("[data-chat-settings-item="+b+"]");c[a+"Class"]("yj-selected")}})}),define("feeds/lib/ui/chat/chat_window",["require","underscore","core/lib/backbone_legacy_integration","core/lib/util/sorted_dictionary","feeds/lib/ui/chat/chat_settings_menu","core/lib/tr"],function(a){var b=a("underscore"),c=a("core/lib/backbone_legacy_integration"),d=a("core/lib/util/sorted_dictionary"),e=a("feeds/lib/ui/chat/chat_settings_menu"),f=a("core/lib/tr");return c.extend({initialize:function(a){this._open=!0,this._settingsItems=null,a.items&&(this._settingsItemsData=a.items),this._createSettingsMenu()},render:function(){this.settingsMenu&&(this.$el.append(this.settingsMenu.render().$el),this.$(".yj-chat-clickmenu").attr("data-yamjs-id","chat-session-options-"+this.uuid),this.$(".yj-settings").attr("data-content-id","chat-session-options-"+this.uuid))},remove:function(){this.settingsMenu&&this.settingsMenu.remove&&(this.settingsMenu.remove(),this.settingsMenu=null),this._settingsItemsData=null,this._settingsItems=null,c.prototype.remove.apply(this,arguments)},_createSettingsMenu:function(){this.settingsMenu&&this.settingsMenu.remove&&(this.settingsMenu.remove(),this.settingsMenu=null),this._settingsItems=this._createSettingsItems(),this._settingsItems.count()&&(this.settingsMenu=new e({items:this._settingsItems,context:this}),this.settingsMenu.on("settings",this.handleSettings.bind(this)))},_createSettingsItems:function(){var a=this,c=new d;return b.each(this._settingsItemsData,function(b){var d=!0;"function"==typeof b.shouldInclude&&(d=b.shouldInclude.call(a)),d&&c.put(b.id,b)}),c},handleSettings:function(a){this._settingsItems.get(a.id).handler.call(this,a.state)},toggleOpenState:function(){this.isOpen()?this.minimize():this.open(),this.trigger("toggle",this)},open:function(){this._open||(this._open=!0,this.$el.addClass("is-open"),this.trigger("open"),this.$el.find(".yj-acc-window-status").text(" "+f.t("pane_open")))},minimize:function(){this._open&&(this._open=!1,this.$el.removeClass("is-open"),this.trigger("minimize"),this.$el.find(".yj-acc-window-status").text(" "+f.t("pane_minimized")))},isOpen:function(){return this._open},generateKey:function(a){return(a||"")+Date.now()}})}),define("css!feeds/lib/ui/chat/contact_list",[],function(){}),define("stache!feeds/lib/ui/chat/contact_list",["mustache"],function(a){var b="<div class='yj-chat-contact-list-header'>\n  <h2 class='yj-chat-status unstyle-heading-as-div' aria-label='{{windowTitle}}'>\n    <button type='button' class='yj-chat-contact-list-header--button unstyle-button-as-span'>\n      <div class='yj-presence yj-status-green yamicon yamicon-circle yamicon-xy-small'></div>\n      {{windowTitle}}\n      <span class='yj-acc-hidden yj-acc-window-status'></span>\n    </button>\n  </h2>\n  <div class='yj-chat-contact-list-header--buttons'>\n    <div class='yj-button yj-settings yj-click-menu-trigger' data-attach-menu='true' data-content-id='chat-settings' data-position-menu='right' >\n      <button class='unstyle-button-as-span' data-position-menu='right' data-speechtip>\n        <span class=\"yamicon yamicon-settings\"></span>\n        <span class='yj-acc-hidden'>{{settingsText}}</span>\n      </button>\n    </div>\n    <button class='yj-button yj-minimize unstyle-button-as-span' data-speechtip>\n      <span class=\"yamicon yamicon-minimize\"></span>\n      <span class='yj-acc-hidden'>{{minimizeText}}</span>\n    </button>\n  </div>\n</div>\n\n<div class='yj-chat-search'>\n  <label>\n    <span class='yj-acc-hidden'>{{accText}}</span>\n    <input class='yj-chat-search-field blur'>\n    <span class='yamicon yamicon-search yamicon-med'></span>\n  </label>\n</div>\n<div class='yj-chat-initiation-lists yj-loading'>\n  <div class='yj-chat-recent-list-items'></div>\n  <div class='yj-chat-contact-list-items'></div>\n  <div class='yj-spinner'>\n    <span class='yj-inline-icon'></span>\n  </div>\n</div>\n";return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/chat/contact_list",["require","jquery","underscore","mustache","feeds/lib/ui/chat/chat_window","common-ui/lib/ui/shared/scroller","backbone","models/helpers/user","core/lib/yammer_api","common-ui/lib/ui/shared/autocompletion","common-ui/lib/ui/shared/autocompletion/autocomplete_models","common-ui/lib/ui/accessibility/screenreader_announcer","core/lib/session","core/lib/adapters/store_adapter","core/lib/tr","core/lib/yammer_uri","models/helpers/avatar","models/user","models/lib/events","jquery-watermark","css!./contact_list","html!./contact_list"],function(a){var b=a("jquery"),c=a("underscore"),d=a("mustache"),e=a("feeds/lib/ui/chat/chat_window"),f=a("common-ui/lib/ui/shared/scroller"),g=a("backbone"),h=a("models/helpers/user"),i=a("core/lib/yammer_api"),j=a("common-ui/lib/ui/shared/autocompletion"),k=a("common-ui/lib/ui/shared/autocompletion/autocomplete_models"),l=a("common-ui/lib/ui/accessibility/screenreader_announcer"),m=a("core/lib/session"),n=a("core/lib/adapters/store_adapter"),o=a("core/lib/tr"),p=a("core/lib/yammer_uri"),q=a("models/helpers/avatar"),r=a("models/user"),s=a("models/lib/events");a("jquery-watermark"),a("css!./contact_list");var t=function(a,b){var c=this,d=function(a){var d,e=a===!1?"on":"off";d="on"===e?o.t("conversation_windows_are_now_hidden_new_messages_will_only_appear"):o.t("conversation_windows_are_now_visible_again_you_can_still_access"),g.trigger("/ui/alert/show","notice",d),c.trigger("settings",{toInbox:e});var f=!a;n.set("yj-chat-contact-list",{sounds_enabled:c.soundsEnabled(),hide_messages:f,minimized:!c.isOpen()}),"function"==typeof b&&b(),c._settingsChangeLock=!1};this._settingsChangeLock||(this._settingsChangeLock=!0,"on"===a&&(c.$el.find("[data-yamjs-id=chat-settings]").hide(),c.toggleOpenState(),c.store()),u("on"!==a,d))},u=function(a,b){i.updateCurrentMetaUser({meta_user:{enable_chat:a?"1":"0"}}).then(function(){var c=m.getCurrentUser().web_preferences;c.enable_chat=a,b(a)},function(a){g.trigger("/ui/alert/show","error","Error updating chat settings: "+a.statusText)})},v=function(){this.toggleSoundsEnabled(),this.store()};return e.extend({NUM_OF_CONTACTS:9,SCROLLER_HEIGHT:333,className:"yj-chat-contact-list is-open",events:{"click .yj-chat-menu-user":"handleUserSelect","keyup .yj-chat-search-field":"handleSearchKey","click .yj-chat-contact-list-header":"onHeaderClick"},_settingsItemsData:[{id:"sounds",text:o.t("sounds"),selectedClass:"",isSelected:function(){return this.soundsEnabled()},handler:v,shouldInclude:function(){return!0}},{id:"toInbox",text:o.t("hide_messages"),selectedClass:"",isSelected:function(){return this.hideMessages()},handler:t,shouldInclude:function(){return!0}}],initialize:function(a){this.feed=a.feed,this.autoComplete=j,this.getSettingsFromStore(),this.listenTo(n,"storageEvent:yj-chat-contact-list",this.applySettings.bind(this)),this.listenTo(this,"toggle",this.onToggleWindow.bind(this)),e.prototype.initialize.apply(this,arguments),a.uuid?this.uuid=a.uuid:this.uuid=this.generateKey("yamjs"),this.listenTo(s,"User/update",function(a,b){b.before.presence!==b.after.presence&&this.$el.find('.yj-presence[data-yj-user-id="'+a.id+'"]').removeClass("yamicon-circle yj-status-green yamicon-chat-here yj-status-gray yamicon-smartphone yamicon-xy-small yamicon-regular").addClass(h.getPresenceCssClass(a,m))}.bind(this))},remove:function(){e.prototype.remove.apply(this,arguments),this.settingsMenu=null,this.autoComplete=null,this.feed=null,this.ac=null},getTemplateData:function(){return{windowTitle:o.t("online_now"),minimizeText:o.t("minimize_minimize_to_collapse_this_section"),settingsText:o.t("settings"),accText:o.t("search_for_people")}},render:function(){this.renderTemplate(this.getTemplateData()),m.getUserSetting("enable_chat")||(this.$el.removeClass("is-open"),this.$el.addClass("yj-chat-closed")),this.$el.hide(),this.$listItemsContainer=this.$el.find(".yj-chat-initiation-lists"),this.$listItems=this.$el.find(".yj-chat-contact-list-items"),this.$spinner=this.$el.find(".yj-spinner"),this.$searchField=this.$(".yj-chat-search-field"),this.$minimizeLink=this.$(".yj-minimize"),this.$settingsLink=this.$(".yj-settings"),this.$header=this.$(".yj-chat-contact-list-header"),this.$currPresence=this.$header.find(".yj-presence"),this.$searchField.watermark(o.t("search_for_people")),this.$searchField.focus(function(){b(this).removeClass("blur")});var a=this.SCROLLER_HEIGHT;return this.yammerNow&&(a-=76,this.yammerNow.on("close",function(){this.scroller&&this.scroller.updateHeight(this.SCROLLER_HEIGHT)},this)),this.scroller=f(this.$listItemsContainer,a,5),this.minimized()&&this.toggleOpenState(),this.$el.show(),this.handleFilter(""),e.prototype.render.apply(this,arguments),window.__phantomas&&window.__phantomas.setMarkerMetric("chatRendered"),this},handleAutocompletePayload:function(a,b){var e=null,f=m.getCurrentNetwork().id;b=b||"",this.$listItemsContainer.removeClass("yj-loading"),this.$listItems.empty(),this.$spinner.remove();var g;a&&(g=c.first(c.filter(a.user,function(a){return a.full_name}),this.NUM_OF_CONTACTS),c.each(g,function(a){a.mugshot_url=a.photo,a.id=parseInt(a.id,10),null!=a.network_id&&(a.network_id=parseInt(a.network_id,10)),a.presence||delete a.presence,e=r.save(a);var b={showJobTitle:!0,showNetworkName:!1};if(null!=e.get("network_id")&&e.get("network_id")!==f&&(b.showJobTitle=!1,b.showNetworkName=!0,null==e.get("network_name"))){var c={network_name:a.email.substr(a.email.indexOf("@")+1)};e.update(c)}this.insertUser(e,b)},this),this._buildHovercards()),(0===b.length||a&&a.user&&a.user.length>=20)&&this.$listItems.append(d.render(this.errorItem,{message:o.t("search_above_for_more_people")})),a&&a.user&&0===a.user.length&&this.$listItems.append(d.render(this.inviteItem,{message:o.t("cant_find_someone"),linkCopy:o.t("add_them"),link:p.app("/#/invitations/by_email")}))},store:function(){c.defer(c.bind(function(){n.set("yj-chat-contact-list",{sounds_enabled:this._soundsEnabled,hide_messages:this._hideMessages,minimized:!this.isOpen()})},this))},getSettingsFromStore:function(){var a=n.get("yj-chat-contact-list");if(a)this._minimized=a.minimized,this._soundsEnabled=a.sounds_enabled,this._hideMessages=a.hide_messages;else{this._minimized=!1,this._soundsEnabled=!0;var b=m.getUserSetting("enable_chat");this._hideMessages="undefined"==typeof b?!1:!b,this.store()}},applySettings:function(a){var c,d=a.newValue;if(d.minimized!==this._minimized&&(this.toggleOpenState(),this._minimized=d.minimized),d.sounds_enabled!==this._soundsEnabled&&(c=b("[data-chat-settings-item=sounds]",this.$el),this.settingsMenu.toggleSelection(c),this._soundsEnabled=d.sounds_enabled),d.hide_messages===m.getUserSetting("enable_chat")){c=b("[data-chat-settings-item=toInbox]",this.$el),this.settingsMenu.toggleSelection(c),this._hideMessages=d.hideMessages;var e=m.getCurrentUser().web_preferences;e.enable_chat=!d.hide_messages}},toggleSoundsEnabled:function(){this._soundsEnabled=!this._soundsEnabled},soundsEnabled:function(){return this._soundsEnabled},hideMessages:function(){return this._hideMessages},minimized:function(){return this._minimized},onHeaderClick:function(a){b(a.target).is(".yj-settings")||b(a.target).parents(".yj-settings").length||(this.toggleOpenState(),this.store())},onToggleWindow:function(){if(this.isOpen())this.$el.removeClass("yj-chat-closed"),this.$el.attr("aria-expanded","true"),this.$searchField.length&&this.$searchField.focus(),g.trigger("/ui/tooltip/remove",{target:this.$header});else{var a=b.contains(this.$el[0],document.activeElement);this.$el.addClass("yj-chat-closed"),this.$el.attr("aria-expanded","false"),a&&this.$(".yj-chat-contact-list-header--button").focus(),g.trigger("/ui/tooltip/add",{target:this.$header,text:o.t("click_here_to_see_whos_online_now_and_start_a")})}},handleUserSelect:function(a){var c=this,d=b(a.currentTarget).data("yj-user"),e=m.getUserSetting("enable_chat"),f=function(){c.settingsMenu.removeSelection("toInbox"),c._selectUser(d)};e?this._selectUser(d):this._settingsItems.get("toInbox").handler.apply(this,["off",f])},handleSearchKey:function(a){if(38==a.keyCode||40==a.keyCode)return this.handleArrow(38==a.keyCode?"up":"down");if(13==a.keyCode){var b=this.$listItems.find(".yj-kbd-selected").removeClass("yj-kbd-selected").data("yj-user");if(b)return this._selectUser(b)}this.handleFilter(this.$searchField.val())},_selectUser:function(a){this.$searchField.val(""),this.handleFilter(""),this.trigger("contact",a)},handleArrow:function(a){var b=this.$listItems.find(".yj-kbd-selected:first").removeClass("yj-kbd-selected")["up"===a?"prev":"next"](".yj-chat-menu-user");if(b.length||(b=this.$listItems.find(".yj-chat-menu-user").first()),b.length){var c=this.$listItems.parent();c.animate({scrollTop:c.scrollTop()+b.position().top+"px"},200);
}b.addClass("yj-kbd-selected"),l.announceText(b.text())},handleFilter:function(a){this.autoComplete.throttleGet({prefix:a,models:[k.USER.id],fetchSize:50,data:{presence:!0,includePendingUsers:!1},success:this.handleAutocompletePayload.bind(this),error:this.handleAutocompletePayload.bind(this,null,a,null),lookcache:!0})},insertUser:function(a,e){if(a.get("id")!=m.getCurrentUser().id){var f={mugshot:q.getAvatarUrl(a),presence_class:h.getPresenceCssClass(a,m),presence_type:h.getPresenceLabel(a,m),id:a.get("id"),full_name:a.get("full_name"),job_title:a.get("job_title"),network_name:a.get("network_name"),network_icon_alt_text:o.t("other_network_icon_alttext")};"user"!==a.get("model")&&"user"!==a.get("type")||c.extend(f,q.determineAvatarReplacementInfo(a,m)),e&&(f.showJobTitle=e.showJobTitle,f.showNetworkName=e.showNetworkName),this.$listItems.append(b(d.render(this.userTemplate,f)).data("yj-user",a))}},_buildHovercards:function(){g.trigger("/ui/hovercard/build",this.$el,".yj-chat-menu-user",{orientation:"left"})},template:a("html!./contact_list"),userTemplate:["<div class='yj-chat-menu-user' data-resource-id='{{ id }}'>"," <button class='yj-chat-menu-item unstyle-button-as-div'>","   {{#replaceAvatar}}",'   <span class="yj-avatar--thumb yj-avatar--replacement yj-avatar--replacement-color-{{avatarColorClass}} yj-avatar--replacement-letters-{{letterCount}}" aria-hidden="true">',"     {{#hasLetters}}","       {{firstLetter}}{{lastLetter}}","     {{/hasLetters}}","     {{^hasLetters}}",'       <img src="{{transparentAvatarUrl}}" class="yj-avatar--image" alt="" />',"     {{/hasLetters}}","   </span>","   {{/replaceAvatar}}","   {{^replaceAvatar}}","     <img class='yj-avatar--thumb yj-avatar--image' src = '{{ mugshot }}' alt=''/>","   {{/replaceAvatar}}","   <div class='yj-presence yj-chat-user-presence {{presence_class}} yamicon' data-yj-user-id='{{ id }}'>","     <span class='yj-acc-hidden'> {{presence_type}} &nbsp; </span>","   </div>","   <div class='yj-chat-user-name'>{{ full_name }}</div>","   {{#showJobTitle}}<div class='yj-chat-user-job'>{{ job_title }}</div>{{/showJobTitle}}","   {{#showNetworkName}}","     <div class='yj-chat-user-network'>","       <span class='yamicon yamicon-network'>","         <span class='yj-acc-hidden'> &nbsp; {{network_icon_alt_text}} </span>","       </span>","       {{network_name}}","     </div>","   {{/showNetworkName}}"," </button>"," </div>"].join(""),errorItem:["<div class='yj-chat-warn-item'>{{ message }}</div>"].join(""),inviteItem:["<div class='yj-chat-warn-item'>{{ message }} <a href=\"{{ link }}\">{{ linkCopy }}</a></div>"].join("")})}),define("stache!feeds/lib/ui/chat/chat_add_member",["mustache"],function(a){var b='<button class="yj-btn yj-addpeople-spacer">foo</button>\n<label>\n  <span class="yj-acc-hidden">{{type_a_persons_name}}</span>\n  <div class="yj-added-people"></div>\n  <input type="text" class="yj-chat-add-member-groupconv"/>\n</label>\n<span class="yj-chat-horizontal-ruler"></span>\n<button class="yj-btn yj-addpeople">{{add_label}}</button>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/chat/chat_add_member",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/log","backbone","core/lib/session","core/lib/tr","core/lib/yammer_api","common-ui/lib/ui/shared/type_ahead","common-ui/lib/ui/shared/tag_list","html!./chat_add_member"],function(a){var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/log"),f=a("backbone"),g=a("core/lib/session"),h=a("core/lib/tr"),i=a("core/lib/yammer_api"),j=a("common-ui/lib/ui/shared/type_ahead"),k=a("common-ui/lib/ui/shared/tag_list"),l=a("html!./chat_add_member");return c.extend({mixins:[d],className:"yj-chat-add-member-container-groupconv",template:l,events:{"click .yj-addpeople":"handleAddButton","keydown .yj-chat-add-member-groupconv":"handleKeyEvents"},initialize:function(a){this.users=a.users,this.threadId=a.threadId,this.id=a.id},getTemplateData:function(){return{type_a_persons_name:h.t("type_a_persons_name"),add_label:h.t("add")}},render:function(){return this.$addPeople=this.$el.find(".yj-addpeople"),this.$addPeopleSpacer=this.$el.find(".yj-addpeople-spacer"),this.createTypeAhead(),this.createTagList(),this.prepareExclusions(),this.setExclusions(),this},prepareExclusions:function(){this.exclusions=b.pluck(this.users,"id"),this.exclusions.push(g.getCurrentUser().id)},focus:function(){this.$search.focus()},setExclusions:function(){this.typeAhead.exclude(this.$search,this._formatExclusionsForTypeAhead(this.exclusions))},_formatExclusionsForTypeAhead:function(a){var c={};return c[j.MODEL_USER]=b.map(a,function(a){return a.toString()}),c},createTagList:function(){this.tagList=new k({itemTemplate:"userTemplate",className:"yj-tag-list-lg"}),this.$el.find(".yj-added-people").append(this.tagList.render().$el)},handleRemoveClick:function(a){this.tagList.removeTagIndex(a),this.tagList.removeTagElement(a),this.exclusions&&(this.exclusions=b.without(this.exclusions,a),this.setExclusions()),0===this.tagList.tags.length&&(this.$addPeople.hide(),this.$addPeopleSpacer.hide()),this.$search.focus()},handleKeyEvents:function(a){var b=""===this.$search.val();if(13===a.keyCode&&b){var c=this.$(".yj-selected");(c.hasClass("yj-first")||0===c.length)&&this.handleAddButton(null)}else 27===a.keyCode?this.trigger("hide"):8===a.keyCode&&b&&this.removeLastTag()},removeLastTag:function(){if(this.tagList.tags.length>0){var a=this.tagList.tags.length-1,b=this.tagList.tags[a];this.handleRemoveClick(b.id)}},handleAddButton:function(){for(var a=this,b=0;b<this.tagList.tags.length;b++){var c=this.tagList.tags[b];this.threadId&&i.addThreadParticipant({threadId:this.threadId,include_user_ids:c.id}).then(void 0,function(){f.trigger("/ui/alert/show","error",h.t("error_adding_new_recipient_to_chat"))})}a.trigger("member",this.tagList.tags)},handleClearButton:function(){this.clearFields(),this.trigger("hide")},clearFields:function(){this.tagList.clear(),this.$search.val(""),this.$addPeople.hide(),this.$addPeopleSpacer.hide(),this.prepareExclusions(),this.setExclusions()},createTypeAhead:function(){if(!this.users[0])return void e.log("add-member doesnt have users");var a="";a=".yj-chat-add-member-groupconv";var b,c=this,d=[String(g.getCurrentUser().id),String(this.users[0].id)],f=this.$el.find(a);b={prepend_to_search:"@",completableModels:[j.MODEL_USER],inline:!0,maxResults:4,hintMessage:"",scrollResults:!0,showTopRankings:!0,selectFirst:!1,watermarkText:" "+h.t("add_more_people"),allowForeignUsers:!0,excludes:{user:d},onSelect:function(){j.defaultOnSelect.apply(j,arguments),f.val(""),c.handleRecipientSelect(arguments[0])}},f.get(0).id=this.getId()+"-search",j.registerField(f,b),this.typeAhead=j,this.typeAheadOpts=b,this.$search=f},handleThreadId:function(a,c){this.threadId=c;var d=this;b.defer(function(){d.trigger&&d.trigger("hide")})},handleRecipientSelect:function(a){"none"!==this.$el.css("display")&&(this.exclusions.push(a.id),this.setExclusions(),this.tagList.addTags(a),this.$search.val(""),this.$search.focus(),this.$addPeople.show(),this.$addPeopleSpacer.show())},getId:function(){return this.id||this.cid},remove:function(){this.typeAhead&&this.$search&&this.typeAhead.removeField(this.$search)},show:function(){this.$el.show()},hide:function(){this.$el.hide()}})}),define("common-ui/lib/helper/twemoji_dictionary",[],function(){var a={"1f004":"Mahjong tile red dragon","1f0cf":"Playing card black joker","1f170":"Negative squared latin capital letter a","1f171":"Negative squared latin capital letter b","1f17e":"Negative squared latin capital letter o","1f17f":"Negative squared latin capital letter p","1f18e":"Negative squared ab","1f191":"Squared cl","1f192":"Squared cool","1f193":"Squared free","1f194":"Squared id","1f195":"Squared new","1f196":"Squared ng","1f197":"Squared ok","1f198":"Squared sos","1f199":"Squared up with exclamation mark","1f19a":"Squared vs","1f1e8-1f1f3":"Flag for China","1f1e9-1f1ea":"Flag for Germany","1f1ea-1f1f8":"Flag for Spain","1f1eb-1f1f7":"Flag for France","1f1ec-1f1e7":"Flag for United Kingdom","1f1ee-1f1f9":"Flag for Italy","1f1ef-1f1f5":"Flag for Japan","1f1f0-1f1f7":"Flag for South Korea","1f1f7-1f1fa":"Flag for Russia","1f1fa-1f1f8":"Flag for United States","1f201":"Squared katakana koko","1f202":"Squared katakana sa","1f21a":"Squared cjk unified ideograph-7121","1f22f":"Squared cjk unified ideograph-6307","1f232":"Squared cjk unified ideograph-7981","1f233":"Squared cjk unified ideograph-7a7a","1f234":"Squared cjk unified ideograph-5408","1f235":"Squared cjk unified ideograph-6e80","1f236":"Squared cjk unified ideograph-6709","1f237":"Squared cjk unified ideograph-6708","1f238":"Squared cjk unified ideograph-7533","1f239":"Squared cjk unified ideograph-5272","1f23a":"Squared cjk unified ideograph-55b6","1f250":"Circled ideograph advantage","1f251":"Circled ideograph accept","1f300":"Cyclone","1f301":"Foggy","1f302":"Closed umbrella","1f303":"Night with stars","1f304":"Sunrise over mountains","1f305":"Sunrise","1f306":"Cityscape at dusk","1f307":"Sunset over buildings","1f308":"Rainbow","1f309":"Bridge at night","1f30a":"Water wave","1f30b":"Volcano","1f30c":"Milky way","1f30d":"Earth globe europe-africa","1f30e":"Earth globe americas","1f30f":"Earth globe asia-australia","1f310":"Globe with meridians","1f311":"New moon symbol","1f312":"Waxing crescent moon symbol","1f313":"First quarter moon symbol","1f314":"Waxing gibbous moon symbol","1f315":"Full moon symbol","1f316":"Waning gibbous moon symbol","1f317":"Last quarter moon symbol","1f318":"Waning crescent moon symbol","1f319":"Crescent moon","1f31a":"New moon with face","1f31b":"First quarter moon with face","1f31c":"Last quarter moon with face","1f31d":"Full moon with face","1f31e":"Sun with face","1f31f":"Glowing star","1f320":"Shooting star","1f330":"Chestnut","1f331":"Seedling","1f332":"Evergreen tree","1f333":"Deciduous tree","1f334":"Palm tree","1f335":"Cactus","1f337":"Tulip","1f338":"Cherry blossom","1f339":"Rose","1f33a":"Hibiscus","1f33b":"Sunflower","1f33c":"Blossom","1f33d":"Ear of maize","1f33e":"Ear of rice","1f33f":"Herb","1f340":"Four leaf clover","1f341":"Maple leaf","1f342":"Fallen leaf","1f343":"Leaf fluttering in wind","1f344":"Mushroom","1f345":"Tomato","1f346":"Aubergine","1f347":"Grapes","1f348":"Melon","1f349":"Watermelon","1f34a":"Tangerine","1f34b":"Lemon","1f34c":"Banana","1f34d":"Pineapple","1f34e":"Red apple","1f34f":"Green apple","1f350":"Pear","1f351":"Peach","1f352":"Cherries","1f353":"Strawberry","1f354":"Hamburger","1f355":"Slice of pizza","1f356":"Meat on bone","1f357":"Poultry leg","1f358":"Rice cracker","1f359":"Rice ball","1f35a":"Cooked rice","1f35b":"Curry and rice","1f35c":"Steaming bowl","1f35d":"Spaghetti","1f35e":"Bread","1f35f":"French fries","1f360":"Roasted sweet potato","1f361":"Dango","1f362":"Oden","1f363":"Sushi","1f364":"Fried shrimp","1f365":"Fish cake with swirl design","1f366":"Soft ice cream","1f367":"Shaved ice","1f368":"Ice cream","1f369":"Doughnut","1f36a":"Cookie","1f36b":"Chocolate bar","1f36c":"Candy","1f36d":"Lollipop","1f36e":"Custard","1f36f":"Honey pot","1f370":"Shortcake","1f371":"Bento box","1f372":"Pot of food","1f373":"Cooking","1f374":"Fork and knife","1f375":"Teacup without handle","1f376":"Sake bottle and cup","1f377":"Wine glass","1f378":"Cocktail glass","1f379":"Tropical drink","1f37a":"Beer mug","1f37b":"Clinking beer mugs","1f37c":"Baby bottle","1f380":"Ribbon","1f381":"Wrapped present","1f382":"Birthday cake","1f383":"Jack-o-lantern","1f384":"Christmas tree","1f385":"Father christmas","1f386":"Fireworks","1f387":"Firework sparkler","1f388":"Balloon","1f389":"Party popper","1f38a":"Confetti ball","1f38b":"Tanabata tree","1f38c":"Crossed flags","1f38d":"Pine decoration","1f38e":"Japanese dolls","1f38f":"Carp streamer","1f390":"Wind chime","1f391":"Moon viewing ceremony","1f392":"School satchel","1f393":"Graduation cap","1f3a0":"Carousel horse","1f3a1":"Ferris wheel","1f3a2":"Roller coaster","1f3a3":"Fishing pole and fish","1f3a4":"Microphone","1f3a5":"Movie camera","1f3a6":"Cinema","1f3a7":"Headphone","1f3a8":"Artist palette","1f3a9":"Top hat","1f3aa":"Circus tent","1f3ab":"Ticket","1f3ac":"Clapper board","1f3ad":"Performing arts","1f3ae":"Video game","1f3af":"Direct hit","1f3b0":"Slot machine","1f3b1":"Billiards","1f3b2":"Game die","1f3b3":"Bowling","1f3b4":"Flower playing cards","1f3b5":"Musical note","1f3b6":"Multiple musical notes","1f3b7":"Saxophone","1f3b8":"Guitar","1f3b9":"Musical keyboard","1f3ba":"Trumpet","1f3bb":"Violin","1f3bc":"Musical score","1f3bd":"Running shirt with sash","1f3be":"Tennis racquet and ball","1f3bf":"Ski and ski boot","1f3c0":"Basketball and hoop","1f3c1":"Chequered flag","1f3c2":"Snowboarder","1f3c3":"Runner","1f3c4":"Surfer","1f3c6":"Trophy","1f3c7":"Horse racing","1f3c8":"American football","1f3c9":"Rugby football","1f3ca":"Swimmer","1f3e0":"House building","1f3e1":"House with garden","1f3e2":"Office building","1f3e3":"Japanese post office","1f3e4":"European post office","1f3e5":"Hospital","1f3e6":"Bank","1f3e7":"Automated teller machine","1f3e8":"Hotel","1f3e9":"Love hotel","1f3ea":"Convenience store","1f3eb":"School","1f3ec":"Department store","1f3ed":"Factory","1f3ee":"Izakaya lantern","1f3ef":"Japanese castle","1f3f0":"European castle","1f400":"Rat","1f401":"Mouse","1f402":"Ox","1f403":"Water buffalo","1f404":"Cow","1f405":"Tiger","1f406":"Leopard","1f407":"Rabbit","1f408":"Cat","1f409":"Dragon","1f40a":"Crocodile","1f40b":"Whale","1f40c":"Snail","1f40d":"Snake","1f40e":"Horse","1f40f":"Ram","1f410":"Goat","1f411":"Sheep","1f412":"Monkey","1f413":"Rooster","1f414":"Chicken","1f415":"Dog","1f416":"Pig","1f417":"Boar","1f418":"Elephant","1f419":"Octopus","1f41a":"Spiral shell","1f41b":"Bug","1f41c":"Ant","1f41d":"Honeybee","1f41e":"Lady beetle","1f41f":"Fish","1f420":"Tropical fish","1f421":"Blowfish","1f422":"Turtle","1f423":"Hatching chick","1f424":"Baby chick","1f425":"Front-facing baby chick","1f426":"Bird","1f427":"Penguin","1f428":"Koala","1f429":"Poodle","1f42a":"Dromedary camel","1f42b":"Bactrian camel","1f42c":"Dolphin","1f42d":"Mouse face","1f42e":"Cow face","1f42f":"Tiger face","1f430":"Rabbit face","1f431":"Cat face","1f432":"Dragon face","1f433":"Spouting whale","1f434":"Horse face","1f435":"Monkey face","1f436":"Dog face","1f437":"Pig face","1f438":"Frog face","1f439":"Hamster face","1f43a":"Wolf face","1f43b":"Bear face","1f43c":"Panda face","1f43d":"Pig nose","1f43e":"Paw prints","1f440":"Eyes","1f442":"Ear","1f443":"Nose","1f444":"Mouth","1f445":"Tongue","1f446":"White up pointing backhand index","1f447":"White down pointing backhand index","1f448":"White left pointing backhand index","1f449":"White right pointing backhand index","1f44a":"Fisted hand sign","1f44b":"Waving hand sign","1f44c":"Ok hand sign","1f44d":"Thumbs up sign","1f44e":"Thumbs down sign","1f44f":"Clapping hands sign","1f450":"Open hands sign","1f451":"Crown","1f452":"Womans hat","1f453":"Eyeglasses","1f454":"Necktie","1f455":"T-shirt","1f456":"Jeans","1f457":"Dress","1f458":"Kimono","1f459":"Bikini","1f45a":"Womans clothes","1f45b":"Purse","1f45c":"Handbag","1f45d":"Pouch","1f45e":"Mans shoe","1f45f":"Athletic shoe","1f460":"High-heeled shoe","1f461":"Womans sandal","1f462":"Womans boots","1f463":"Footprints","1f464":"Bust in silhouette","1f465":"Busts in silhouette","1f466":"Boy","1f467":"Girl","1f468":"Man","1f469":"Woman","1f46a":"Family","1f46b":"Man and woman holding hands","1f46c":"Two men holding hands","1f46d":"Two women holding hands","1f46e":"Police officer","1f46f":"Woman with bunny ears","1f470":"Bride with veil","1f471":"Person with blond hair","1f472":"Man with gua pi mao","1f473":"Man with turban","1f474":"Older man","1f475":"Older woman","1f476":"Baby","1f477":"Construction worker","1f478":"Princess","1f479":"Japanese ogre","1f47a":"Japanese goblin","1f47b":"Ghost","1f47c":"Baby angel","1f47d":"Extraterrestrial alien","1f47e":"Alien monster","1f47f":"Imp","1f480":"Skull","1f481":"Information desk person","1f482":"Guardsman","1f483":"Dancer","1f484":"Lipstick","1f485":"Nail polish","1f486":"Face massage","1f487":"Haircut","1f488":"Barber pole","1f489":"Syringe","1f48a":"Pill","1f48b":"Kiss mark","1f48c":"Love letter","1f48d":"Ring","1f48e":"Gem stone","1f48f":"Kiss","1f490":"Bouquet","1f491":"Couple with heart","1f492":"Wedding","1f493":"Beating heart","1f494":"Broken heart","1f495":"Two hearts","1f496":"Sparkling heart","1f497":"Growing heart","1f498":"Heart with arrow","1f499":"Blue heart","1f49a":"Green heart","1f49b":"Yellow heart","1f49c":"Purple heart","1f49d":"Heart with ribbon","1f49e":"Revolving hearts","1f49f":"Heart decoration","1f4a0":"Diamond shape with a dot inside","1f4a1":"Electric light bulb","1f4a2":"Anger symbol","1f4a3":"Bomb","1f4a4":"Sleeping symbol","1f4a5":"Collision symbol","1f4a6":"Splashing sweat symbol","1f4a7":"Droplet","1f4a8":"Dash symbol","1f4a9":"Pile of poo","1f4aa":"Flexed biceps","1f4ab":"Dizzy symbol","1f4ac":"Speech balloon","1f4ad":"Thought balloon","1f4ae":"White flower","1f4af":"Hundred points symbol","1f4b0":"Money bag","1f4b1":"Currency exchange","1f4b2":"Heavy dollar sign","1f4b3":"Credit card","1f4b4":"Banknote with yen sign","1f4b5":"Banknote with dollar sign","1f4b6":"Banknote with euro sign","1f4b7":"Banknote with pound sign","1f4b8":"Money with wings","1f4b9":"Chart with upwards trend and yen sign","1f4ba":"Seat","1f4bb":"Personal computer","1f4bc":"Briefcase","1f4bd":"Minidisc","1f4be":"Floppy disk","1f4bf":"Optical disc","1f4c0":"Dvd","1f4c1":"File folder","1f4c2":"Open file folder","1f4c3":"Page with curl","1f4c4":"Page facing up","1f4c5":"Calendar","1f4c6":"Tear-off calendar","1f4c7":"Card index","1f4c8":"Chart with upwards trend","1f4c9":"Chart with downwards trend","1f4ca":"Bar chart","1f4cb":"Clipboard","1f4cc":"Pushpin","1f4cd":"Round pushpin","1f4ce":"Paperclip","1f4cf":"Straight ruler","1f4d0":"Triangular ruler","1f4d1":"Bookmark tabs","1f4d2":"Ledger","1f4d3":"Notebook","1f4d4":"Notebook with decorative cover","1f4d5":"Closed book","1f4d6":"Open book","1f4d7":"Green book","1f4d8":"Blue book","1f4d9":"Orange book","1f4da":"Books","1f4db":"Name badge","1f4dc":"Scroll","1f4dd":"Memo","1f4de":"Telephone receiver","1f4df":"Pager","1f4e0":"Fax machine","1f4e1":"Satellite antenna","1f4e2":"Public address loudspeaker","1f4e3":"Cheering megaphone","1f4e4":"Outbox tray","1f4e5":"Inbox tray","1f4e6":"Package","1f4e7":"E-mail symbol","1f4e8":"Incoming envelope","1f4e9":"Envelope with downwards arrow above","1f4ea":"Closed mailbox with lowered flag","1f4eb":"Closed mailbox with raised flag","1f4ec":"Open mailbox with raised flag","1f4ed":"Open mailbox with lowered flag","1f4ee":"Postbox","1f4ef":"Postal horn","1f4f0":"Newspaper","1f4f1":"Mobile phone","1f4f2":"Mobile phone with rightwards arrow at left","1f4f3":"Vibration mode","1f4f4":"Mobile phone off","1f4f5":"No mobile phones","1f4f6":"Antenna with bars","1f4f7":"Camera","1f4f9":"Video camera","1f4fa":"Television","1f4fb":"Radio","1f4fc":"Videocassette","1f500":"Twisted rightwards arrows","1f501":"Clockwise rightwards and leftwards open circle arrows","1f502":"Clockwise rightwards and leftwards open circle arrows with circled one overlay","1f503":"Clockwise downwards and upwards open circle arrows","1f504":"Anticlockwise downwards and upwards open circle arrows","1f505":"Low brightness symbol","1f506":"High brightness symbol","1f507":"Speaker with cancellation stroke","1f508":"Speaker","1f509":"Speaker with one sound wave","1f50a":"Speaker with three sound waves","1f50b":"Battery","1f50c":"Electric plug","1f50d":"Left-pointing magnifying glass","1f50e":"Right-pointing magnifying glass","1f50f":"Lock with ink pen","1f510":"Closed lock with key","1f511":"Key","1f512":"Lock","1f513":"Open lock","1f514":"Bell","1f515":"Bell with cancellation stroke","1f516":"Bookmark","1f517":"Link symbol","1f518":"Radio button","1f519":"Back with leftwards arrow above","1f51a":"End with leftwards arrow above","1f51b":"On with exclamation mark with left right arrow above","1f51c":"Soon with rightwards arrow above","1f51d":"Top with upwards arrow above","1f51e":"No one under eighteen symbol","1f51f":"Keycap ten","1f520":"Input symbol for latin capital letters","1f521":"Input symbol for latin small letters","1f522":"Input symbol for numbers","1f523":"Input symbol for symbols","1f524":"Input symbol for latin letters","1f525":"Fire","1f526":"Electric torch","1f527":"Wrench","1f528":"Hammer","1f529":"Nut and bolt","1f52a":"Hocho","1f52b":"Pistol","1f52c":"Microscope","1f52d":"Telescope","1f52e":"Crystal ball","1f52f":"Six pointed star with middle dot","1f530":"Japanese symbol for beginner","1f531":"Trident emblem","1f532":"Black square button","1f533":"White square button","1f534":"Large red circle","1f535":"Large blue circle","1f536":"Large orange diamond","1f537":"Large blue diamond","1f538":"Small orange diamond","1f539":"Small blue diamond","1f53a":"Up-pointing red triangle","1f53b":"Down-pointing red triangle","1f53c":"Up-pointing small red triangle","1f53d":"Down-pointing small red triangle","1f550":"Clock face one oclock","1f551":"Clock face two oclock","1f552":"Clock face three oclock","1f553":"Clock face four oclock","1f554":"Clock face five oclock","1f555":"Clock face six oclock","1f556":"Clock face seven oclock","1f557":"Clock face eight oclock","1f558":"Clock face nine oclock","1f559":"Clock face ten oclock","1f55a":"Clock face eleven oclock","1f55b":"Clock face twelve oclock","1f55c":"Clock face one-thirty","1f55d":"Clock face two-thirty","1f55e":"Clock face three-thirty","1f55f":"Clock face four-thirty","1f560":"Clock face five-thirty","1f561":"Clock face six-thirty","1f562":"Clock face seven-thirty","1f563":"Clock face eight-thirty","1f564":"Clock face nine-thirty","1f565":"Clock face ten-thirty","1f566":"Clock face eleven-thirty","1f567":"Clock face twelve-thirty","1f5fb":"Mount fuji","1f5fc":"Tokyo tower","1f5fd":"Statue of liberty","1f5fe":"Silhouette of japan","1f5ff":"Moyai","1f600":"Grinning face","1f601":"Grinning face with smiling eyes","1f602":"Face with tears of joy","1f603":"Smiling face with open mouth","1f604":"Smiling face with open mouth and smiling eyes","1f605":"Smiling face with open mouth and cold sweat","1f606":"Smiling face with open mouth and tightly-closed eyes","1f607":"Smiling face with halo","1f608":"Smiling face with horns","1f609":"Winking face","1f60a":"Smiling face with smiling eyes","1f60b":"Face savouring delicious food","1f60c":"Relieved face","1f60d":"Smiling face with heart-shaped eyes","1f60e":"Smiling face with sunglasses","1f60f":"Smirking face","1f610":"Neutral face","1f611":"Expressionless face","1f612":"Unamused face","1f613":"Face with cold sweat","1f614":"Pensive face","1f615":"Confused face","1f616":"Confounded face","1f617":"Kissing face","1f618":"Face throwing a kiss","1f619":"Kissing face with smiling eyes","1f61a":"Kissing face with closed eyes","1f61b":"Face with stuck-out tongue","1f61c":"Face with stuck-out tongue and winking eye","1f61d":"Face with stuck-out tongue and tightly-closed eyes","1f61e":"Disappointed face","1f61f":"Worried face","1f620":"Angry face","1f621":"Pouting face","1f622":"Crying face","1f623":"Persevering face","1f624":"Face with look of triumph","1f625":"Disappointed but relieved face","1f626":"Frowning face with open mouth","1f627":"Anguished face","1f628":"Fearful face","1f629":"Weary face","1f62a":"Sleepy face","1f62b":"Tired face","1f62c":"Grimacing face","1f62d":"Loudly crying face","1f62e":"Face with open mouth","1f62f":"Hushed face","1f630":"Face with open mouth and cold sweat","1f631":"Face screaming in fear","1f632":"Astonished face","1f633":"Flushed face","1f634":"Sleeping face","1f635":"Dizzy face","1f636":"Face without mouth","1f637":"Face with medical mask","1f638":"Grinning cat face with smiling eyes","1f639":"Cat face with tears of joy","1f63a":"Smiling cat face with open mouth","1f63b":"Smiling cat face with heart-shaped eyes","1f63c":"Cat face with wry smile","1f63d":"Kissing cat face with closed eyes","1f63e":"Pouting cat face","1f63f":"Crying cat face","1f640":"Weary cat face","1f645":"Face with no good gesture","1f646":"Face with ok gesture","1f647":"Person bowing deeply","1f648":"See-no-evil monkey","1f649":"Hear-no-evil monkey","1f64a":"Speak-no-evil monkey","1f64b":"Happy person raising one hand","1f64c":"Person raising both hands in celebration","1f64d":"Person frowning","1f64e":"Person with pouting face","1f64f":"Person with folded hands","1f680":"Rocket","1f681":"Helicopter","1f682":"Steam locomotive","1f683":"Railway car","1f684":"High-speed train","1f685":"High-speed train with bullet nose","1f686":"Train","1f687":"Metro","1f688":"Light rail","1f689":"Station","1f68a":"Tram","1f68b":"Tram car","1f68c":"Bus","1f68d":"Oncoming bus","1f68e":"Trolleybus","1f68f":"Bus stop","1f690":"Minibus","1f691":"Ambulance","1f692":"Fire engine","1f693":"Police car","1f694":"Oncoming police car","1f695":"Taxi","1f696":"Oncoming taxi","1f697":"Automobile","1f698":"Oncoming automobile","1f699":"Recreational vehicle","1f69a":"Delivery truck","1f69b":"Articulated lorry","1f69c":"Tractor","1f69d":"Monorail","1f69e":"Mountain railway","1f69f":"Suspension railway","1f6a0":"Mountain cableway","1f6a1":"Aerial tramway","1f6a2":"Ship","1f6a3":"Rowboat","1f6a4":"Speedboat","1f6a5":"Horizontal traffic light","1f6a6":"Vertical traffic light","1f6a7":"Construction sign","1f6a8":"Police cars revolving light","1f6a9":"Triangular flag on post","1f6aa":"Door","1f6ab":"No entry sign","1f6ac":"Smoking symbol","1f6ad":"No smoking symbol","1f6ae":"Put litter in its place symbol","1f6af":"Do not litter symbol","1f6b0":"Potable water symbol","1f6b1":"Non-potable water symbol","1f6b2":"Bicycle","1f6b3":"No bicycles","1f6b4":"Bicyclist","1f6b5":"Mountain bicyclist","1f6b6":"Pedestrian","1f6b7":"No pedestrians","1f6b8":"Children crossing","1f6b9":"Mens symbol","1f6ba":"Womens symbol","1f6bb":"Restroom","1f6bc":"Baby symbol","1f6bd":"Toilet","1f6be":"Water closet","1f6bf":"Shower","1f6c0":"Bath","1f6c1":"Bathtub","1f6c2":"Passport control","1f6c3":"Customs","1f6c4":"Baggage claim","1f6c5":"Left luggage","203c":"Double exclamation mark",2049:"Exclamation question mark",2122:"Trade mark sign",2139:"Information source",2194:"Left right arrow",2195:"Up down arrow",2196:"North west arrow",2197:"North east arrow",2198:"South east arrow",2199:"South west arrow","21a9":"Leftwards arrow with hook","21aa":"Rightwards arrow with hook","23-20e3":"Keycap number sign","231a":"Watch","231b":"Hourglass","23e9":"Black right-pointing double triangle","23ea":"Black left-pointing double triangle","23eb":"Black up-pointing double triangle","23ec":"Black down-pointing double triangle","23f0":"Alarm clock","23f3":"Hourglass with flowing sand","24c2":"Circled latin capital letter m","25aa":"Black small square","25ab":"White small square","25b6":"Black right-pointing triangle","25c0":"Black left-pointing triangle","25fb":"White medium square","25fc":"Black medium square","25fd":"White medium small square","25fe":"Black medium small square",2600:"Black sun with rays",2601:"Cloud","260e":"Black telephone",2611:"Ballot box with check",2614:"Umbrella with rain drops",2615:"Hot beverage","261d":"White up pointing index","263a":"White smiling face",2648:"Aries",2649:"Taurus","264a":"Gemini","264b":"Cancer","264c":"Leo","264d":"Virgo","264e":"Libra","264f":"Scorpius",2650:"Sagittarius",2651:"Capricorn",2652:"Aquarius",2653:"Pisces",2660:"Black spade suit",2663:"Black club suit",2665:"Black heart suit",2666:"Black diamond suit",2668:"Hot springs","267b":"Black universal recycling symbol","267f":"Wheelchair symbol",2693:"Anchor","26a0":"Warning sign","26a1":"High voltage sign","26aa":"Medium white circle","26ab":"Medium black circle","26bd":"Soccer ball","26be":"Baseball","26c4":"Snowman without snow","26c5":"Sun behind cloud","26ce":"Ophiuchus","26d4":"No entry","26ea":"Church","26f2":"Fountain","26f3":"Flag in hole","26f5":"Sailboat","26fa":"Tent","26fd":"Fuel pump",2702:"Black scissors",2705:"White heavy check mark",2708:"Airplane",2709:"Envelope","270a":"Raised fist","270b":"Raised hand","270c":"Victory hand","270f":"Pencil",2712:"Black nib",2714:"Heavy check mark",2716:"Heavy multiplication x",2728:"Sparkles",2733:"Eight spoked asterisk",2734:"Eight pointed black star",2744:"Snowflake",2747:"Sparkle","274c":"Cross mark","274e":"Negative squared cross mark",2753:"Black question mark ornament",2754:"White question mark ornament",2755:"White exclamation mark ornament",2757:"Heavy exclamation mark symbol",2764:"Heavy black heart",2795:"Heavy plus sign",2796:"Heavy minus sign",2797:"Heavy division sign","27a1":"Black rightwards arrow","27b0":"Curly loop","27bf":"Double curly loop",2934:"Arrow pointing rightwards then curving upwards",2935:"Arrow pointing rightwards then curving downwards","2b05":"Leftwards black arrow","2b06":"Upwards black arrow","2b07":"Downwards black arrow","2b1b":"Black large square","2b1c":"White large square","2b50":"White medium star","2b55":"Heavy large circle","30-20e3":"Keycap digit zero",3030:"Wavy dash","303d":"Part alternation mark","31-20e3":"Keycap digit one","32-20e3":"Keycap digit two",3297:"Circled ideograph congratulation",3299:"Circled ideograph secret","33-20e3":"Keycap digit three","34-20e3":"Keycap digit four","35-20e3":"Keycap digit five","36-20e3":"Keycap digit six","37-20e3":"Keycap digit seven","38-20e3":"Keycap digit eight","39-20e3":"Keycap digit nine",a9:"Copyright sign",ae:"Registered sign"};return a}),define("common-ui/lib/helper/twemoji_accfixer",["require","jquery","underscore","./twemoji_dictionary"],function(a){var b=a("jquery"),c=a("underscore"),d=a("./twemoji_dictionary"),e=function(a){if(!/<img/i.test(a))return a;var e=b("<div />").html(a),f=e.find("img.emojione");return c.each(f,function(a){var b=a.src,c=b.match(/\/([0-9a-f-]+)\.[^/]*/)[1],e=d[c];e&&a.setAttribute("aria-label",e)}),e.html()};return e}),define("feeds/lib/ui/chat/emoticon_converter",["require","underscore","core/lib/util/emoji_helper","core/lib/string_helper","core/lib/uri_helper"],function(a){var b,c=a("underscore"),d=a("core/lib/util/emoji_helper"),e=a("core/lib/string_helper"),f=a("core/lib/uri_helper"),g={":)":"1F603",":D":"1F600",":o":"1F62F",":O":"1F62F",":p":"1F61B",":P":"1F61B",";)":"1F609",":(":"1F61F",":S":"1F616",":s":"1F616",":/":"1F615",":*":"1F61A",":|":"1F610",":'(":"1F622","<3":"2764","</3":"1F494","(n)":"1F44E","(N)":"1F44E","(y)":"1F44D","(Y)":"1F44D"},h=[];c.each(g,function(a,b){h.push(e.escapeRegExp(c.escape(b)))});var i=h.join("|");b=new RegExp("(?:^|>)("+i+")(?=$|[!,.?]|<)","g");var j=function(a){var b=a.split(" ");return c.map(b,k).join(" ")},k=function(a){var c=-1!==a.search(f.HREF_PATTERN);return c?a:a.replace(b,l)},l=function(a,b){return d.convert(g[c.unescape(b)])};return{replaceText:j,emoticonRegex:b,mappings:g}}),define("stache!feeds/lib/ui/chat/chat_message_list_item",["mustache"],function(a){var b='<div class="yj-chat-message-container" role="heading" aria-level="3">\n  <div class="yj-chat-byline" data-resource-id="{{sender_id}}">\n    <a href="{{sender_url}}" {{^avatarAltText}}aria-hidden="true" tabindex="-1"{{/avatarAltText}} class="yj-chat-message-avatar">\n    {{#replaceAvatar}}\n      <span class="yj-chat-message-list-item--avatar yj-avatar--thumb yj-avatar--replacement yj-avatar--replacement-color-{{avatarColorClass}} yj-avatar--replacement-letters-{{letterCount}}" alt="{{image_alt_text}}" aria-label=" ">\n      {{#hasLetters}}\n        {{firstLetter}}{{lastLetter}}\n      {{/hasLetters}}\n      {{^hasLetters}}\n        <img src="{{transparentAvatarUrl}}" class="yj-chat-message-list-item--avatar yj-avatar--thumb yj-avatar--replacement-transparent" alt="{{avatarAltText}}" />\n      {{/hasLetters}}\n      </span>\n    {{/replaceAvatar}}\n    {{^replaceAvatar}}\n      <img src="{{avatar}}" class="yj-chat-message-list-item--avatar" alt="{{avatarAltText}}" width="32" />\n    {{/replaceAvatar}}\n    </a>\n    <a class="yj-chat-message-sender" href="{{sender_url}}">{{sender_name}}</a>\n  </div>\n  {{^sticker}}\n    <div class="yj-chat-message-body-container">\n      <p class="yj-chat-message-body">{{{body}}}</p>\n\n      {{#attachmentCount}}\n      <ul class="yj-chat-attachments">\n      {{#attachments}}\n        <li class="yj-chat-attachment-item">\n          <a href="{{attachmentUrl}}" title="{{title}}" data-item-id="{{id}}"\n          {{#preview_url}}class="yj-chat-attachment-preview"{{/preview_url}}>\n          {{#thumbnail_url}}\n            <img src="{{thumbnail_url}}" class="yj-chat-attachment-{{type}}" alt="{{attachmentAltText}}" title="{{attachmentName}}" />\n          {{/thumbnail_url}}\n          {{^thumbnail_url}}\n            <span class="yj-icon yamicon yamicon-paperclip">\n              <span class="yj-acc-hidden">{{attachmentsIndicatorAltText}}</span>\n            </span>\n            {{attachmentName}}\n          {{/thumbnail_url}}\n          </a>\n        </li>\n      {{/attachments}}\n      </ul>\n      {{/attachmentCount}}\n\n      <span class="yj-like-container {{#likeCount}}has-likes{{/likeCount}}">\n        <button title="{{likeTitle}}" class="yj-chat-like-btn unstyle-button-as-span" data-speechtip aria-label="{{likeTitle}}">\n          <span class="yamicon {{likeIcon}}"></span>\n        </button>\n        <span class="yj-like-count">{{likeCount}}</span>\n      </span>\n\n    </div>\n  {{/sticker}}\n  {{#sticker}}\n    {{{sticker}}}\n  {{/sticker}}\n  <div class="yj-chat-details-wrapper">\n    <span class="yj-chat-message-details">\n      <span class="yj-chat-message-sender-span">{{sender_name_truncated}}</span>\n      <span class="yj-chat-message-details-separator"> &bull; </span>\n      {{#timestamp}}\n        <span class="yj-chat-timestamp">{{timestamp}}</span>\n      {{/timestamp}}\n    </span>\n  </div>\n  {{#failed}}\n    <a class="yj-chatfail" href="javascript://" role="button">Failed. Click to retry</a>\n  {{/failed}}\n</div>\n';
return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/chat/chat_message_list_item",["require","jquery","underscore","core/lib/util/emoji_helper","common-ui/lib/helper/twemoji_accfixer","core/lib/backbone_legacy_integration","mustache","models/attachment","feeds/lib/modules/video_encoding_progress","feeds/lib/ui/attachments/yamio_preview","core/lib/date_helper","feeds/lib/helper/i18n_helper","feeds/lib/ui/chat/emoticon_converter","backbone","core/lib/session","core/lib/string_helper","core/lib/tr","core/lib/report","feeds/lib/ui/shared/stickers","models/helpers/user","models/helpers/avatar","models/helpers/attachment","common-ui/lib/ui/accessibility/screenreader_announcer","core/lib/yammer_uri","html!./chat_message_list_item"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/util/emoji_helper"),e=a("common-ui/lib/helper/twemoji_accfixer"),f=a("core/lib/backbone_legacy_integration"),g=a("mustache"),h=a("models/attachment"),i=a("feeds/lib/modules/video_encoding_progress"),j=a("feeds/lib/ui/attachments/yamio_preview"),k=a("core/lib/date_helper"),l=a("feeds/lib/helper/i18n_helper"),m=a("feeds/lib/ui/chat/emoticon_converter"),n=a("backbone"),o=a("core/lib/session"),p=a("core/lib/string_helper"),q=a("core/lib/tr"),r=a("core/lib/report"),s=a("feeds/lib/ui/shared/stickers"),t=a("models/helpers/user"),u=a("models/helpers/avatar"),v=a("models/helpers/attachment"),w=a("common-ui/lib/ui/accessibility/screenreader_announcer"),x=a("core/lib/yammer_uri"),y=a("html!./chat_message_list_item");return f.extend({tagName:"li",className:"yj-chat-message yj-chat-message-list-item yj-want-focuswithin",template:y,events:{"click .yj-chat-attachment-preview":"onChatAttachmentPreview",mouseenter:"onHoverOver",mouseleave:"onHoverOut","click .yj-chat-like-btn":"onToggleLike"},initialize:function(a){this.options=c.extend({},this.options,a),this._videoEncodingProgresses={}},remove:function(){f.prototype.remove.call(this),c.invoke(this._videoEncodingProgresses,"destroy"),this._videoEncodingProgresses={}},onChatAttachmentPreview:function(a){a.preventDefault();var d=b(a.target),e=d.is(".yj-chat-attachment-preview")?d:d.closest(".yj-chat-attachment-preview"),f=e.data("item-id"),g=c(this.model.attachments).find(function(a){return a.id===f});j.showOverlayForAttachment(g)},onToggleLike:function(a){a.preventDefault(),a.stopPropagation();var b=this.model;if(b){this.trigger("like");var c;b.isLikedBy(o.getCurrentUser())?b.unlike():(b.like(),c=!0),this.render(),w.announceText(c?q.t("you_like_this_message"):q.t("you_no_longer_like_this_message"))}},getMessage:function(){return this.model},getMessageId:function(){return this.options.messageId},getSenderId:function(){return this.model?this.model.sender_id:o.getCurrentUser().id},getTime:function(){return this.model?this.model.getTime():this.getMessageId()},isPending:function(){return!this.model},_getAttachmentAltText:function(a){var b;return b="image"===a.type?q.t("uploaded_image")+": "+(a.description||q.t("no_description_set")):"Video"===a.content_class?q.t("uploaded_video"):q.t("uploaded_file")},processAttachment:function(a){a.attachmentUrl=a.preview_url||a.download_url||a.web_url,a.title=a.full_name||a.name,a.attachmentName=p.truncate(a.title,30),a.attachmentAltText=this._getAttachmentAltText(a),this._isUnencodedVideo(a)&&(a.thumbnail_url=null)},_generateOGOLink:function(a){return g.render('<a class="linkified" href="{{url}}" target="_blank" rel="nofollow noreferrer">{{url}}</a>',{url:a})},_isOgoAttachment:function(a){var b=h.findOrCreate(a);return v.isOgo(b)},_convertEmoticons:function(a){return a=m.replaceText(a),a=d.parse(a),a=e(a)},getTemplateData:function(){var a,b,d,e=this.model;if(e){a=e.findSender(),b=e.getRichBody()||"";var f=c.find(e.attachments,this._isOgoAttachment);if(f&&-1===b.lastIndexOf(f.web_url)){var g=this._generateOGOLink(f.web_url);b=c.compact([b,g]).join(" ")}b=this._convertEmoticons(b);var h,i=e.getLikes().length||"",j=e.isLikedBy(o.getCurrentUser()),l=c.filter(e.attachments,function(a){return"page"===a.real_type||"uploaded_file"===a.real_type}),m=e.getSticker();c.each(l,this.processAttachment,this),m&&(h=new s(m).render());var n="yamicon-rd_like",r=t.getFullName(a);return d={avatar:u.getAvatarUrl(a),avatarAltText:"",sender_name:r,sender_name_truncated:p.truncate(r,15),sender_url:a.web_url,sender_id:a.id,timestamp:k.formatDateTimeShortMonth(new Date(e.getTime())),body:b,sticker:h?h.$el.html():null,attachments:l,attachmentCount:l.length,attachmentsIndicatorAltText:q.t("has_attachments"),likeIcon:n+(j?" yj-blue":" yj-dark-gray"),likeCount:i,likeTitle:j?q.t("unlike"):q.t("like")},"user"!==a.model&&"user"!==a.type||c.extend(d,u.determineAvatarReplacementInfo(a,o)),d}return a=o.getCurrentUser(),b=this._convertEmoticons(this.options.body),d={body:b,avatar:u.getAvatarUrl(a),avatarAltText:"",sender_name:a.full_name,sender_name_truncated:p.truncate(a.full_name,15),sender_url:a.web_url,pending:this.options.pending,failed:this.options.failed},d.pending&&this.options.attachments&&(d.attachmentCount=this.options.attachments.length,d.attachmentsIndicatorAltText=q.t("has_attachments"),d.attachments=this.options.attachments,c.each(d.attachments,this.processAttachment,this)),"user"!=a.model&&"user"!=a.type||c.extend(d,u.determineAvatarReplacementInfo(a,o)),d},render:function(){var a=this.getTemplateData(),b=document.activeElement===this.$(".yj-chat-like-btn")[0];this.renderTemplate(a),b&&this.$(".yj-chat-like-btn").focus(),n.trigger("/ui/hovercard/build",this.$el,".yj-chat-byline, .yammer-object",{orientation:"left"});var c=this.model?this.model.getTextDirection():void 0;if(l.addDirectionSupportToElement(this.$el.find(".yj-chat-message-body"),c),this.getMessageId()&&this.$el.attr("data-chat-id",this.getMessageId()),this.options.pending?this.$el.addClass("yj-chat-message-pending"):this.options.failed&&this.$el.addClass("yj-chat-failed-message"),this._handleEncodingAttachments(a.attachments),this.$timestamp=this.$(".yj-chat-timestamp"),this.$likeContainer=this.$(".yj-like-container"),this.$likeIcon=this.$(".yamicon-like"),this.senderless?(this._hideSenderDetails(),this.$el.removeClass("userdetailed")):this.$el.addClass("userdetailed"),this.limitless&&this._hideLimits(),this.timestamped&&this._showTimestamp(),a.attachments&&a.attachments.length>0){this.$el.addClass("has-attachment");var d=this.$el.find(".yj-chat-attachment-preview img");d.length&&d.on("error",this._showPlaceholderImage.bind(this)),0===a.body.length&&this.$el.addClass("attachment-only")}return this},_handleEncodingAttachments:function(a){c.each(a,function(a){var b=a.id;if(this._isUnencodedVideo(a)){var c=i.create({fileId:b,versionId:a.latest_version_id});c.handleEncodingStatusChange({onEncoded:this._handleVideoEncodingComplete.bind(this,b),onError:this._handleVideoEncodingFailure.bind(this,b)},5e3),this._videoEncodingProgresses[b]=c}},this)},_handleVideoEncodingComplete:function(a,d){for(var e=".yj-chat-attachments",f=0;f<this.model.attachments.length;f++){var g=this.model.attachments[f];if(g.id===a){c.extend(this.model.attachments[f],d),this.model.attachments[f].transcoded=!0,h.save(this.model.attachments[f]);var i=this.getTemplateData(),j=b(y(i)),k=j.find(e);this.$el.find(e).replaceWith(k)}}this._destroyVideoEncodingProgress(a)},_handleVideoEncodingFailure:function(a){this._destroyVideoEncodingProgress(a)},_destroyVideoEncodingProgress:function(a){this._videoEncodingProgresses[a]&&(this._videoEncodingProgresses[a].destroy(),delete this._videoEncodingProgresses[a])},_showPlaceholderImage:function(a){try{throw new Error("ChatMessageListItem fileville image error")}catch(a){r.info({message:a.message},a)}var c=b(a.target);c.unbind("error"),c.addClass("yj-chat-preview-error"),c.attr("src",x.cdn("assets/images/image_preview_default.png"))},showTimestamp:function(){this.timestamped=!0,this._showTimestamp()},_showTimestamp:function(){this.$el.find(".yj-chat-details-wrapper").show(),this.$el.addClass("timestamped")},hideTimestamp:function(){this.timestamped=!1,this._hideTimestamp()},_hideTimestamp:function(){this.$el.find(".yj-chat-details-wrapper").hide(),this.$el.removeClass("timestamped")},hideSenderDetails:function(){this.senderless=!0,this._hideSenderDetails(),this.$el.removeClass("userdetailed")},_hideSenderDetails:function(){this.$el.find(".yj-chat-message-avatar").hide(),this.$el.find(".yj-chat-message-sender").hide(),this.$el.find(".yj-chat-message-container").attr({role:"heading","aria-level":"4"})},showSenderDetails:function(){this.senderless=!1,this._showSenderDetails()},_showSenderDetails:function(){this.$el.find(".yj-chat-message-avatar").show(),this.$el.find(".yj-chat-message-sender").css({display:"inline-block"})},hideLimits:function(){this.limitless=!0,this._hideLimits()},_hideLimits:function(){this.$el.find(".yj-chat-details-wrapper").hide(),this.$el.addClass("not-last-message")},showLimits:function(){this.limitless=!1,this._showLimits()},_showLimits:function(){this.$el.find(".yj-chat-details-wrapper").show(),this.$el.removeClass("not-last-message")},_isUnencodedVideo:function(a){return a.status===i.EncodingStatus.ENCODING||a.status===i.EncodingStatus.FAILED}})}),define("stache!feeds/lib/ui/chat/chat_message_list",["mustache"],function(a){var b='<div class="yj-pending-chat-attachment">\n    <h5>{{uploadingLabel}} <span class="upload-name">Filename</span>&hellip;</h5>\n    <div class="upload-track"><div class="upload-progress"></div></div>\n</div>\n<div class="yj-chat-attachment-error">\n    <h5>{{attachmentError}}</h5>\n    <div class="upload-track"><div class="upload-progress"></div></div>\n</div>\n<ul class="yj-chat-message-list--content">\n  <li>\n    <div class="yj-get-older yj-hide"><a href="javascript://" role="button">{{get_older_messages}}</a></div>\n  </li>\n</ul>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/chat/chat_message_list",["require","jquery","underscore","core/lib/backbone_legacy_integration","feeds/lib/ui/chat/chat_message_list_item","core/lib/tr","common-ui/lib/ui/shared/scroller","html!./chat_message_list"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_legacy_integration"),e=a("feeds/lib/ui/chat/chat_message_list_item"),f=a("core/lib/tr"),g=a("common-ui/lib/ui/shared/scroller");return d.extend({className:"yj-chat-message-list",template:a("html!./chat_message_list"),events:{"click .yj-chat-failed-message":"onFailedMessageClick"},defaults:{timestampTimeout:3e5},initialize:function(a){var b=c.defaults({},a,this.defaults);b.delegate&&this.setDelegate(b.delegate),c.bindAll(this,"clearAttachment","updateFileUpload","_savePendingAttachment"),this.listenTo(this,"fileUploaded",this.clearAttachment),this.listenTo(this,"fileUploaded",this._savePendingAttachment),this.listenTo(this,"uploadError",this._displayAttachmentError),this.listenTo(this,"uploadStart",this.updateFileUpload),this.listenTo(this,"uploadProgress",this.updateFileUpload),this.listenTo(this,"scrollToBottom",this._scrollToBottom),this.itemByMessageId={},this.pendingMessages=[],this.lastPendingMessage=null,this.lastResolvedMessage=null,this.timestampTimeout=b.timestampTimeout},remove:function(){c.each(this.itemByMessageId,function(a,b){delete this.itemByMessageId[b]},this),this.itemByMessageId=null,this.pendingMessages=null,this._delegate=null,this.lastPendingMessage=null,this.lastResolvedMessage=null,this.clearTimeouts()},clearAttachment:function(a){a&&a.preventDefault&&(a.preventDefault(),a.stopPropagation()),this.$uploadProgress.width("0%"),this.$pendingAttachment.removeClass("on uploading")},updateFileUpload:function(a){this.$pendingAttachment.addClass("on uploading"),this.$uploadProgress.width(a.percent+"%"),this.$uploadName.text(a.name)},setDelegate:function(a){this._delegate=a},_savePendingAttachment:function(a){this.pendingAttachments=this.pendingAttachments||[],this.pendingAttachments.push(a)},_consumePendingAttachments:function(a){var b=c.map(a,function(a){var b=a.split(":")[1];return c.findWhere(this.pendingAttachments,{id:parseInt(b,10)})},this);return this.pendingAttachments=[],b},_displayAttachmentError:function(){var a=this.$el.find(".yj-chat-attachment-error");this.clearAttachment(),a.show(),setTimeout(function(){a.hide()},5e3)},handlePendingMessage:function(a,b){var c={messageId:a,body:b.escaped_body,pending:!0,timestamp:new Date,attachments:this._consumePendingAttachments(b.attached_objects)};this.pendingMessages.push(c),this.addListItem(c),this.render(),this.scrollList()},clearPendingMessage:function(a){this.removeItemByMessageId(a)},getPendingMessagesCount:function(){return this.pendingMessages.length},handleFailedMessage:function(a,b){var c={messageId:a,body:b.escaped_body,failed:!0};this.addListItem(c),this.render(),this.scrollList()},onFailedMessageClick:function(a){var c=b(a.target).parents(".yj-chat-failed-message"),d=c.data("chat-id");this.removeItemByMessageId(d),this.trigger("resend",d)},addListItem:function(a,b){if(!this.getItemByMessageId(a.messageId)){b=b||"append";var c=new e(a);return this.listenTo(c,"like",this.handleLike.bind(this)),this[b](c,".yj-chat-message-list--content"),this.itemByMessageId[a.messageId]=c,c}},handleLike:function(){this.trigger("like")},getTemplateData:function(){return{uploadingLabel:f.t("uploading_2"),get_older_messages:f.t("get_older_messages"),attachmentError:f.t("an_error_occurred_while_uploading_the_file")}},render:function(){return this._delegate&&c.each(this._delegate.getMessages(),function(a){var b=this._delegate.getMessageAttachMethod(a);this.addListItem({messageId:a.id,model:a},b)},this),this.pendingMessages.length>0&&c.each(this.pendingMessages,function(a){this.addListItem(a)},this),this._children=c.sortBy(this._children,function(a){return a.view.getMessageId()},this),this.$ul||(this.renderTemplate(this.getTemplateData()),this.$ul=this.$(".yj-chat-message-list--content"),this.scroller=g(this.$ul,this.$el.height(),0,260),this.$getOlderLink=this.$(".yj-get-older"),this.$pendingAttachment=this.$(".yj-pending-chat-attachment"),this.$uploadProgress=this.$pendingAttachment.find(".upload-progress"),this.$uploadName=this.$pendingAttachment.find(".upload-name")),this.formatMessagesInBubbles(),this._delegate&&this._delegate.hasOlder()&&!this.findLastPrependChild().view.$el.hasClass("not-last-message")?this.$getOlderLink.addClass("after-last-message"):this.$getOlderLink.removeClass("after-last-message"),this._delegate&&(this._delegate.hasOlder()?this.$getOlderLink.show():this.$getOlderLink.hide()),this},findLastPrependChild:function(){for(var a=null,b=0,c=this._children.length;c>b;b++){if(a&&"prepend"===a.method&&"prepend"!==this._children[b])return a;a=this._children[b]}},formatMessagesInBubbles:function(){if(this._children.length>0&&(this.clearTimeouts(),this.setTimeout(this.showTimestampOnLastMessage.bind(this),this.timestampTimeout)),1===this._children.length)this._children[0].view.showSenderDetails(),this._children[0].view.showLimits(),new Date-this._children[0].view.getTime()>=this.timestampTimeout?this._children[0].view.showTimestamp():this._children[0].view.hideTimestamp();else for(var a=0,b=this._children.length;b>a;a++){var c=a>0?this._children[a-1].view:null,d=this._children[a].view,e=a<this._children.length-1?this._children[a+1].view:null;if(c){var f=c.getSenderId()===d.getSenderId(),g=d.getTime()-c.getTime()<this.timestampTimeout;f&&g?d.hideSenderDetails():d.showSenderDetails()}if(e){var h=d.getSenderId()===e.getSenderId(),i=e.getTime()-d.getTime()<this.timestampTimeout;h&&i?d.hideLimits():d.showLimits(),i?d.hideTimestamp():d.showTimestamp()}else new Date-d.getTime()>this.timestampTimeout?d.showTimestamp():d.hideTimestamp()}},showTimestampOnLastMessage:function(){this._children[this._children.length-1].view.showTimestamp()},renderMessage:function(a){var b=this.getItemByMessageId(a);b&&b.render()},removeItemByMessageId:function(a){var b=this.getItemByMessageId(a);return b?(b.remove(),this.pendingMessages=c.reject(this.pendingMessages,function(b){return b.messageId==a}),this._children=c.reject(this._children,function(b){return b.view&&b.view.getMessageId()==a}),this.lastPendingMessage&&this.lastPendingMessage.getMessageId()===a&&(this.lastPendingMessage=null),delete this.itemByMessageId[a],!0):!1},getItemByMessageId:function(a){return this.itemByMessageId[a]},getLastRenderedMessageId:function(){var a=c.find(this._children.reverse(),function(a){var b=a.view;return!b.pending&&!b.failed});return a&&a.view&&a.view.getMessageId()},setHeight:function(a){this.$el&&this.$el.height(a),this.scroller&&this.scroller.updateHeight(a)},_scrollToBottom:function(){this.scroller.atBottom&&this.scroller.scrollToBottom()},scrollList:function(){this.scroller&&c.defer(this.scroller.scrollToBottom)}})}),define("stache!feeds/lib/ui/chat/chat_session_notifications",["mustache"],function(a){var b='<div class="yj-chat-session-notifications--content">{{ content }}</div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("css!feeds/lib/ui/chat/chat_session_notifications",[],function(){}),define("feeds/lib/ui/chat/chat_session_notifications",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","backbone","core/lib/session","core/lib/tr","models/user","models/thread","html!./chat_session_notifications","css!./chat_session_notifications"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("backbone"),g=a("core/lib/session"),h=a("core/lib/tr"),i=a("models/user");a("models/thread");var j=a("html!./chat_session_notifications");return a("css!./chat_session_notifications"),d.extend({mixins:[e],TYPING_NOTIFICATION_DURATION:8e3,TYPING_NAME_LENGTH:20,threadEvents:{TYPING:"typing"},className:"yj-chat-session-notifications",template:j,_typingEventDispatched:!0,initialize:function(a){this.usersTyping={},a.threadId&&this.setThreadId(a.threadId)},remove:function(){this.typingNotificationTimeout&&clearTimeout(this.typingNotificationTimeout),this.usersTyping=null,d.prototype.remove.call(this)},getTemplateData:function(){if(!this.threadId)return{};var a="",b=yam.model.Thread.findById(this.threadId);if(b){var d=c.keys(this.usersTyping),e=d.length;if(e>0)switch(this.trigger("typing_notifications"),e){case 1:a=h.t("name_is_typing",{name1:this._getTruncatedName(i.findById(d[0]))});break;case 2:a=h.t("name_and_name_are_typing",{name1:this._getTruncatedName(i.findById(d[0])),name2:this._getTruncatedName(i.findById(d[1]))});break;default:a=h.t("name_name_and_count_others_are_typing_2",{name1:this._getTruncatedName(i.findById(d[0])),name2:this._getTruncatedName(i.findById(d[1])),count:e-2})}else this.trigger("empty_notifications")}return{content:a}},_getTruncatedName:function(a){var c="";return a&&(a.get("first_name")&&a.get("first_name").length>0?c=a.get("first_name"):a.get("full_name")&&a.get("full_name").length>0&&(c=a.get("full_name").match(/\S+/)[0]),c.length>this.TYPING_NAME_LENGTH)?b.trim(c.substr(0,this.TYPING_NAME_LENGTH))+"…":c},render:function(){return this.$realtimeNotification=this.$(".yj-chat-session-notifications--content"),this},setThreadId:function(a){if(this.threadId=a,this.threadId){var b="/threads/"+a;this.listenTo(f,b,this.handleThreadEvent.bind(this))}},handleThreadEvent:function(a){switch(a.type){case this.threadEvents.TYPING:var b=a.from_user_id;if(b&&b!==g.getCurrentUser().id){var c=Date.now()+this.TYPING_NOTIFICATION_DURATION;this.setUsersTyping(b,c)}}},updateTypingNotification:function(){this.typingNotificationTimeout&&(clearTimeout(this.typingNotificationTimeout),this.typingNotificationTimeout=null);var a=this._findNextExpiringNotification();if(a){var b=a-Date.now();this.typingNotificationTimeout=c.delay(this.updateTypingNotification.bind(this),b)}this.render()},_deleteExpiredNotifications:function(){var a=Date.now();c.each(this.usersTyping,function(b,c){a>b&&delete this.usersTyping[c]},this)},_findNextExpiringNotification:function(){return this._deleteExpiredNotifications(),c.reduce(this.usersTyping,function(a,b){return a?a>b?b:a:b},null)},setUsersTyping:function(a,b){b?this.usersTyping[a]=b:delete this.usersTyping[a],this.updateTypingNotification()}})}),define("feeds/lib/ui/chat/thread_messages_delegate",["require","core/lib/ctor","models/lib/helper/feed_factory"],function(a){var b=a("core/lib/ctor"),c=a("models/lib/helper/feed_factory");return b(null,{init:function(a,b){this.feed=a,this.thread=b},getMessages:function(){return this.thread.getSortedMessages()},getMessageAttachMethod:function(a){return a.isThreadStarter()?"prepend":"append"},hasOlder:function(){var a=this.thread.getFirstLocalReply();return!(!a||a.id===this.thread.stats.first_reply_id)},markSeen:function(){var a=this.thread;a.isSeen()||a.markAsRead();var b=c.findOrCreate("inboxChat");b.markSeen(a)},getUnseenCount:function(){return this.feed.getUnseenCountFor(this.thread.id)},destroy:function(){this.thread=null}})}),define("css!feeds/lib/ui/chat/chat_publisher",[],function(){}),define("stache!feeds/lib/ui/chat/chat_publisher",["mustache"],function(a){var b='<label class="yj-textarea-container">\n  <span class="yamicon yamicon-chat"></span>\n  <span class="yj-acc-hidden yj-acc-chat-publisher-label"></span>\n  <TextInputView key="text-input" />\n</label>\n{{#allowAttachments}}\n<button class="unstyle-button-as-span add-attachment" data-speechtip>\n  <span class="yamicon yamicon-paperclip">\n    <span class="yj-acc-hidden">{{uploadButtonAlt}}</span>\n  </span>\n</button>\n{{/allowAttachments}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/chat/chat_publisher",["require","jquery","underscore","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/backbone_base_view","common-ui/lib/ui/shared/input/direction_aware_text_input","feeds/lib/ui/publisher/global/publisher_errors","backbone","core/lib/tr","common-ui/lib/helper/ui","css!./chat_publisher","html!./chat_publisher"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("core/lib/backbone_base_view"),g=a("common-ui/lib/ui/shared/input/direction_aware_text_input"),h=a("feeds/lib/ui/publisher/global/publisher_errors"),i=a("backbone"),j=a("core/lib/tr"),k=a("common-ui/lib/helper/ui");a("css!./chat_publisher");var l={};return f.extend({template:a("html!./chat_publisher"),mixins:[d,e],className:"yj-chat-publisher",views:{TextInputView:"_getTextInputView"},events:{"mouseover .add-attachment":"_onUploaderHover"},initialize:function(a){c.extend(this,a),this._chatClientSequence=null},val:function(a){a=a||{};var b,d=[];return b=!this.$textInput||a.onlyAttachments?{message_type:"chat",body:"",escaped_body:"",chat_client_sequence:this._chatClientSequence}:{message_type:"chat",body:this.$textInput.val(),escaped_body:c.escape(this.$textInput.val()),chat_client_sequence:this._chatClientSequence},this.replyTo?b.replied_to_id=this.replyTo:this.users&&(b.direct_to_user_ids=c.map(this.users,function(a){return a.id})),this._staticAttachments&&this._staticAttachments.length&&(d=d.concat(this._staticAttachments),b.attached_objects=d),b},setVal:function(a){"string"==typeof a&&(this.$textInput.val(a),this._toggleOverflowClass())},submit:function(a){if(!this._quickDisabled&&this._isValid()&&(this._chatClientSequence=Date.now(),!this._submitted)){this._submitted=!0;var b=this.val(a);!c.has(b,"group_id")||null!=b.group_id&&"recipients"!==b.group_id||delete b.group_id,this.storeSnapshot(),this.trigger("submitting"),this.trigger("submit",b),this.disable(),this._doSubmit(b),this.resetImmediately(a)}},storeSnapshot:function(a){l[this.getSnapshotId()]=a||this.val()},getSnapshot:function(a){return l[a||this.getSnapshotId()]},focus:function(){this.$textInput.focus()},deleteSnapshot:function(a){delete l[a]},sendStaticAttachment:function(a){var b=this._staticAttachments||[];b.push(a.type+":"+a.id),this._staticAttachments=b,this.submit({onlyAttachments:!0})},clearStaticAttachments:function(){this._staticAttachments=void 0},remove:function(){return this.$textInput&&this.$textInput.off(),f.prototype.remove.call(this)},getTemplateData:function(){var a={allowAttachments:this.allowAttachments,uploadButtonAlt:j.t("add_file")};return a},render:function(){return this.allowAttachments&&this._createTooltip(),this.trigger("render"),this},handleSubmit:function(a,b){a?this._handleError(a):(this._handleSuccess(b),this.trigger("submitted")),this.enable()},resetImmediately:function(a){a=a||{},a.onlyAttachments||this.$textInput.val(""),this.clearStaticAttachments(),this._submitted=!1,this._chatClientSequence=null},forceDisable:function(){this.$textInput.val("").prop("disabled",!0).addClass("yj-disabled yj-disabled-input"),this._quickDisabled=!0},disable:function(){this.replyTo||(this._quickDisabled=!0)},enable:function(){delete this._quickDisabled},handleThreadId:function(a,b){this.replyTo=b},getSnapshotId:function(){return this._chatClientSequence},getMessageLength:function(){return this.$textInput.val().length},submitSnapshot:function(a){var b=this.getSnapshot(a);if(!b)throw new Error("No snapshot found for request id "+a);this._chatClientSequence=a,this._doSubmit(b)},isOpen:function(){return this.$el.hasClass("is-publisher-open")},_getTextInputView:function(){var a={tagName:"textarea",className:"yj-chat-session-input",attributes:{width:"100"}},b=g,c=new b(a);return this.$textInput=c.$el,this.allowAttachments&&this.$textInput.on("keyup",this._toggleOverflowClass.bind(this)),this.$textInput.on("keyup",this.trigger.bind(this,"keyup")).on("keydown",this._onEditorKeyDown.bind(this)),c},_onEditorKeyDown:function(a){return 27===a.keyCode?void this.trigger("escapeKeyPressed"):(13===a.keyCode&&(this._isValid()&&this.submit(),a.preventDefault()),void this.trigger("change",a))},_toggleOverflowClass:function(){this.$el.toggleClass("yj-chat-overflowed",this._isOverflowing())},_isOverflowing:function(){return this.$textInput.prop("scrollHeight")>this.$textInput.outerHeight()},_doSubmit:function(a){var b=this,c=this.getSnapshotId(),d=0;setTimeout(function(){var d=b._getFeedModel();d.postMessage(a).then(function(a){var d=a.getRaw();b.handleSubmit(null,{requestId:c,data:d})},function(a){var d=h.parseErrorMessage(a);b.handleSubmit({requestId:c,message:d.message},null)})},d)},_handleSuccess:function(a){if(this.trigger("submitSuccess",a),i.trigger("/message/posted",a.data),this.deleteSnapshot(a.requestId),void 0!==a.data&&void 0!==a.data.messages){var b,d=a.data.messages[0];void 0!==d.attachments&&(b=c.filter(d.attachments,function(a,b){return new Date(a.created_at).getTime()>Date.now()-3e5*(b+1)}),k.shiftCount("#yj-group-files-link .yj-tab-counter",b.length))}},_handleError:function(a){this.trigger("submitError",a),i.trigger("/ui/alert/show","error",a.message)},_createTooltip:function(){i.trigger("/ui/tooltip/add",{target:this.$el.find(".add-attachment"),validHTML:!0,text:j.t("click_to_attach_and_send_files")})},_isValid:function(){var a=this.$textInput.val();return!(0===b.trim(a).length&&!this._staticAttachments)},_getFeedId:function(){return this._getFeedModel().id},_getFeedObject:function(){return this._getFeedModel()},_getFeedModel:function(){return this.feed||yam.ui.chatManager.feed},_onUploaderHover:function(){this.trigger("chatuploader:hover")}})}),define("common-ui/lib/ui/shared/beep",["require","core/lib/log","core/lib/yammer_uri"],function(a){"use strict";function b(){try{f=new Audio(""),f.canPlayType("audio/mpeg")?f=new Audio(h.cdn("assets/misc/beep.mp3")):f.canPlayType("audio/x-wav")&&(f=new Audio(h.cdn("assets/misc/beep.wav")))}catch(a){j=!1,g.log("beep","Failed to initialize the Audio API")}}function c(){i=!0;try{j=!("undefined"==typeof Audio||!new Audio("").canPlayType),j&&b()}catch(a){j=!1}}function d(){j&&4===f.readyState&&(f.play(),f=new Audio(f.currentSrc))}function e(){i||c(),d()}var f,g=a("core/lib/log"),h=a("core/lib/yammer_uri"),i=!1,j=!1;return{beep:e}}),define("css!feeds/lib/ui/chat/chat_session",[],function(){}),define("stache!feeds/lib/ui/chat/chat_session",["mustache"],function(a){var b='<div class="yj-chat-session--header">\n  <h2 class="yj-chat-title unstyle-heading-as-div">\n    <button type="button" class="yj-chat-session--header-button unstyle-button-as-span"></button>\n  </h2>\n  <div class="yj-head-count yj-chat-zero"></div>\n  <div class="yj-chat-session--header-buttons">\n    <button class="yj-button yj-add-member unstyle-button-as-span" data-speechtip="{{addMemberTextShort}}">\n      <span class="yamicon yamicon-regular yamicon-add-user-MSFT"></span>\n      <span class="yj-acc-hidden">{{addMemberText}}</span>\n    </button>\n    <button class="yj-button yj-minimize unstyle-button-as-span" data-speechtip>\n      <span class="yamicon yamicon-minimize"></span>\n      <span class="yj-acc-hidden">{{minimizeText}}</span>\n    </button>\n    <button class="yj-button yj-close unstyle-button-as-span" data-speechtip>\n      <span class="yamicon yamicon-big-x"></span>\n      <span class="yj-acc-hidden">{{closeText}}</span>\n    </button>\n  </div>\n</div>\n<div class="yj-chat-session--main-content">\n  <div class="yj-external-chat-info"></div>\n  <div class="yj-offline-chat-info"></div>\n</div>\n<div class="yj-chat-session--publisher"></div>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/chat/chat_session_title",["mustache"],function(a){var b='{{#oneOther}}\n  <button type="button" class="yj-chat-session--header-button unstyle-button-as-span">\n    <span class="yj-presence yamicon {{presence_class}}" data-yj-user-id="{{uid}}">\n      <span class="yj-acc-hidden">{{presence_type}} </span>\n    </span>\n    <span class="yj-chat-title-inner">{{title}}</span>\n    <span class="yj-acc-hidden yj-acc-window-status"> {{windowStatus}}</span>\n  </button>\n{{/oneOther}}\n{{^oneOther}}\n  <button type="button" class="yj-chat-session--header-button unstyle-button-as-span">\n    {{title}} <span class="yj-acc-hidden yj-acc-window"> {{windowStatus}}</span>\n  </button>\n{{/oneOther}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/chat/chat_session_users_tooltip",["mustache"],function(a){var b="{{#users}}\n  <div>{{! `buildPresensce` returns HTML }}{{{ presence_html }}} {{ full_name }}</div>\n{{/users}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/chat/chat_session_move_to_group",["mustache"],function(a){var b='<li class="yj-chat-message">\n  <div class="yj-chat-message-container">\n    <a href="{{sender_url}}"><img src="{{avatar}}" alt="" width="32" /></a>\n    <p>\n      <a class="yj-chat-message-sender" href="{{sender_url}}">{{sender_name}}</a>\n      {{{body}}}\n    </p>\n    <p><a class="yj-continue-chat" href="{{link}}" title="">{{linkText}}</a></p>\n    <div class="yj-chat-details-wrapper">\n      <span class="yj-chat-message-details">\n        <span class="yj-chat-timestamp">{{timestamp}}</span>\n      </span>\n    </div>\n  </div>\n</li>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/chat/chat_session",["require","jquery","underscore","core/lib/date_helper","feeds/lib/ui/chat/chat_add_member","feeds/lib/ui/chat/chat_window","feeds/lib/ui/chat/chat_message_list","feeds/lib/ui/chat/chat_session_notifications","feeds/lib/ui/chat/thread_messages_delegate","feeds/lib/ui/chat/chat_publisher","common-ui/lib/ui/accessibility/screenreader_announcer","components/network_label/index","common-ui/lib/ui/shared/beep","models/helpers/user","backbone","core/lib/report","core/lib/session","core/lib/adapters/store_adapter","core/lib/string_helper","feeds/lib/ui/util/title_updater","core/lib/tr","core/lib/yammer_uri","core/lib/util/clipboard","models/user","models/helpers/conversation","core/lib/urls","models/lib/events","feeds/lib/ui/attachments/uploader","models/thread","models/message","css!./chat_session","html!./chat_session","html!./chat_session_title","html!./chat_session_users_tooltip","html!./chat_session_move_to_group"],function(a){
var b=a("jquery"),c=a("underscore"),d=a("core/lib/date_helper"),e=a("feeds/lib/ui/chat/chat_add_member"),f=a("feeds/lib/ui/chat/chat_window"),g=a("feeds/lib/ui/chat/chat_message_list"),h=a("feeds/lib/ui/chat/chat_session_notifications"),i=a("feeds/lib/ui/chat/thread_messages_delegate"),j=a("feeds/lib/ui/chat/chat_publisher"),k=a("common-ui/lib/ui/accessibility/screenreader_announcer"),l=a("components/network_label/index"),m=a("common-ui/lib/ui/shared/beep"),n=a("models/helpers/user"),o=a("backbone"),p=a("core/lib/report"),q=a("core/lib/session"),r=a("core/lib/adapters/store_adapter"),s=a("core/lib/string_helper"),t=a("feeds/lib/ui/util/title_updater"),u=a("core/lib/tr"),v=a("core/lib/yammer_uri"),w=a("core/lib/util/clipboard"),x=a("models/user"),y=a("models/helpers/conversation"),z=a("core/lib/urls"),A=a("models/lib/events");a("feeds/lib/ui/attachments/uploader"),a("models/thread"),a("models/message"),a("css!./chat_session");var B={chat_session:a("html!./chat_session"),chat_session_title:a("html!./chat_session_title"),chat_session_users_tooltip:a("html!./chat_session_users_tooltip"),chat_session_move_to_group:a("html!./chat_session_move_to_group")};return f.extend({TYPING_EVENT_THROTTLE:5e3,className:"yj-chat-session is-open yj-want-focuswithin",others:[],template:B.chat_session,events:{click:"handleSelfClick","click .yj-close":"handleClose","click .yj-add-member":"toggleAddMembers","click .yj-chat-session--header":"onHeaderClick","click .yj-chat-session--main-content":"onChatMainClick","click .yj-get-older":"loadOlder","focusin .yj-chat-session-input":"openPublisher","focusout .yj-chat-session-input":"closePublisher","keyup .yj-bubble-field":"handleAddmemberKey",paste:"handlePaste"},threadEvents:{TYPING:"typing",MOVE_TO_GROUP:"move_to_group",LIKES:"likes"},_settingsItemsData:[],initialize:function(a){f.prototype.initialize.apply(this,arguments),this.feed=a.feed,c.bindAll(this,"reflow","handleMessage"),this.listenTo(A,"Message/create",this.handleMessage),a.delegate&&(this._delegate=a.delegate),this._users=[],this.min=a.min||!1,this.message_draft=a.message_draft||"",this.firstLoadOlder=!0;var b=q.getCurrentUser(),d=b&&b.web_preferences,e=d&&d.network_settings;this._allowAttachments=e?s.convertStringyBoolean(e.allow_attachments):!0,this._addUsers(a.users),this._createAddMember(),this._createMessageList(),this._createNotifications(),this._createPublisher(),this._thread=null,this._threadId=null;var g=a.threadId;g&&this.setThreadId(g),this.listenTo(this,"open",this.onToggleWindow),this.listenTo(this,"minimize",this.onToggleWindow)},remove:function(){c.each(this.mainContentElements,function(a){var b=this[a];b&&b.stop(!0)}),f.prototype.remove.apply(this,arguments),this.uploader&&this.uploader.destroy(),this.stopListening();var a=this.getThread();a&&a.unlisten(),this._delegate&&(this._delegate.destroy(),this._delegate=null),this._thread=null,this._threadId=null,this._users=null,this.feed=null,this.addMember=null,this.messageList=null,this.publisher=null,this.notifications=null},_createUploader:function(){if(!this.uploader){var a={button:this.$publisher.find(".add-attachment"),container:this.$publisher},b=this.getThread();b&&c.extend(a,{networkId:b.network_id});var d=new yam.ui.attachments.FileVilleUploader(a);this.uploader=d,this.listenTo(d,"uploadStart",c.partial(this._notifyMessageList,"uploadStart")),this.listenTo(d,"uploadError",c.partial(this._notifyMessageList,"uploadError")),this.listenTo(d,"uploadProgress",c.partial(this._notifyMessageList,"uploadProgress")),this.listenTo(d,"fileUpload",this._handleFileUpload),this.listenTo(d,"encodingComplete",this._handleEncodingComplete),this.listenTo(d,"uploadStart",function(){p.event("chat_attachment_upload_start")}),this.listenTo(this.publisher,"chatuploader:hover",this._refreshUploader)}},_refreshUploader:function(){this.uploader.refresh()},_notifyMessageList:function(){this.messageList.trigger.apply(this.messageList,arguments)},_handleEncodingComplete:function(a,b){this._handleFileUpload(a,b,!0)},_handleFileUpload:function(a,b,d){d?(this._notifyMessageList("fileUploaded",b),this.publisher.sendStaticAttachment(b)):this._notifyMessageList("uploadProgress",c.extend({percent:99},a))},_createAddMember:function(){this._addMemberState="show",this._addMemberShowLock=!1,this.addMember=new e({users:this._users,threadId:this.getThreadId()}),this.addMember.on("member",this.handleMembers.bind(this)),this.addMember.on("hide",this.handleHideAddMember.bind(this)),this.add(this.addMember,".yj-chat-session--main-content")},handleAddmemberKey:function(a){13==a.keyCode?this.handleMembers(this.addMember.tagList.tags):27==a.keyCode&&this.toggleAddMembers()},handlePaste:function(a){var b=w.getFileFromPaste(a);this.uploader._uploader.addFile(b),this.uploader._uploader.start()},_createMessageList:function(){var a={delegate:this.getDelegate()};this.messageList=new g(a),this.listenTo(this.messageList,"resend",this.handleResend),this.listenTo(this.messageList,"like",this.handleLike),this.add(this.messageList,".yj-chat-session--main-content")},getDelegate:function(){var a=this.getThread();return!this._delegate&&a&&(this._delegate=new i(this.feed,a)),this._delegate},_createNotifications:function(){this.notifications=new h({threadId:this.getThreadId()}),this.listenTo(this.notifications,"empty_notifications",function(){this.hideNotification(this.$notifications)}),this.add(this.notifications,".yj-chat-session--main-content")},_createPublisher:function(){this.publisher=new j({replyTo:null,users:this._users,feed:this.feed,allowAttachments:this._allowAttachments}),this._allowAttachments&&this.listenTo(this.publisher,"render",this._createUploader),this.listenTo(this.publisher,"render",this.setTitle),this.listenTo(this.publisher,"submit",this.handleSubmitImmediately),this.listenTo(this.publisher,"submitSuccess",this.handleSubmitSuccess),this.listenTo(this.publisher,"submitError",this.handleSubmitError);var a=c.throttle(this.markAsRead.bind(this),250);this.listenTo(this.publisher,"change",a),this.add(this.publisher,".yj-chat-session--publisher"),this.listenTo(this.publisher,"escapeKeyPressed",this.handleClose),this.listenTo(this.publisher,"change",function(){this._isDirty=!0}.bind(this))},handleClose:function(a){p.event("chat_close",{thread_id:this._threadId}),c.isUndefined(a)||(a.stopPropagation(),a.preventDefault()),this.markAsRead(),this.handleTooltips("remove"),this.trigger("close",this)},handleSelfClick:function(){this.markAsRead()},getTemplateData:function(){return{closeText:u.t("close_close_window"),minimizeText:u.t("minimize_minimize_to_collapse_this_section"),addMemberText:u.t("add_someone_to_this_conversation"),addMemberTextShort:u.t("add_someone_to_this_conversation_short")}},render:function(){this.renderTemplate(this.getTemplateData()),this.$headCount=this.$(".yj-head-count"),this.$minimize=this.$(".yj-minimize"),this.$chatTitle=this.$(".yj-chat-title"),this.$addMember=this.$(".yj-add-member"),this.addMember&&(this.$addMemberContainer=this.addMember.$el),this.$header=this.$(".yj-chat-session--header"),this.$offlineMsg=this.$(".yj-offline-chat-info").addClass("notification-is-hidden"),this.$externalMsg=this.$(".yj-external-chat-info").addClass("notification-is-hidden"),this.messageList.render().$el.appendTo(this.$el),this.$notifications=this.notifications.$el.addClass("notification-is-hidden"),this.$publisher=this.publisher.$el,this.min?this.minimize():this.onToggleWindow(),this.updateWarn(),this.checkForForeignUsers(),this.setTitle(),this.addUsersTooltip(),this.handleTooltips(),this.toggleUnreadColors()},getTooltipItems:function(){return{addButton:{text:u.t("add_someone_to_this_conversation"),target:this.$addMember},closeButton:{text:u.t("close_close_online_now_window"),target:this.$(".yj-close")},minimizeButton:{text:u.t("minimize_minimize_online_now_window"),target:this.$(".yj-minimize")}}},handleTooltips:function(a){var b=this.getTooltipItems();a=a||"add";for(var c in b){var d={target:b[c].target,text:b[c].text,delay:300,fadeTime:100,orientation:"top",tooltipSize:"small"};o.trigger("/ui/tooltip/"+a,d)}},align:function(a){this.$el.css("right",a)},serializeForLocalStorage:function(){var a,b="";return this.getThreadId()&&(a=this.feed.getUnseenCount(this.getThreadId())),this.publisher&&(b=this.publisher.val().body),"undefined"==typeof this.windowOrder&&(this.windowOrder=-1),{threadId:this.getThreadId(),participants:c.reject(c.map(this._users,function(a){return parseInt(a.id,10)}),function(a){return a===q.getCurrentUser().id}),minimized:this.minimized(),position:this.windowOrder,message_draft:b,unseen_count:a}},toggleAddMembers:function(a){a&&a.stopPropagation(),"show"===this._addMemberState?(this.setAddMembersState("hide"),this.addMember.clearFields()):this.setAddMembersState("show")},handleHideAddMember:function(){"show"===this._addMemberState&&this.toggleAddMembers()},setAddMembersState:function(a){var b=this,d=this.messageList.$el;this._addMemberState!==a&&d&&d.length&&(this._addMemberShowLock||(this._addMemberShowLock=!0,setTimeout(function(){b._addMemberShowLock=!1},50),"show"===this._addMemberState?(this._addMemberState="hide",this.addMember.hide()):(this._addMemberState="show",this.addMember.show(),c.defer(function(){b.addMember.focus()})),c.defer(this.reflow),this.messageList.scrollList()))},openPublisher:function(){this.publisher.isOpen()||(this.$publisher.addClass("is-publisher-open"),this.$publisher.addClass("has-content"),this.messageList.scrollList())},closePublisher:function(){if(this.publisher.isOpen()){this.$publisher.removeClass("is-publisher-open");var a=this.publisher.val().body;this._isDirty&&(yam.ui.chatManager.chatBridge.sendAndApply("updateSessionPublisher",this.getUniqueId(),a),yam.ui.chatManager.store(),this._isDirty=!1),""===a?this.$publisher.removeClass("has-content"):this.$publisher.addClass("has-content")}},onChatMainClick:function(a){var c=b(a.target),d="div, p, span, :header",e=window.getSelection().toString().length>0;c.is(d)&&!e&&this.publisher.focus()},onHeaderClick:function(a){a.stopPropagation(),a.preventDefault(),b(a.target).hasClass("yj-click-menu-trigger")||(this.toggleOpenState(),this.isOpen()&&this.publisher.focus(),yam.ui.chatManager.store())},onToggleWindow:function(){if(o.trigger("/ui/tooltip/hide",{target:this.$header}),this.isOpen())this.$el.removeClass("is-closed"),this.$el.attr("aria-expanded","true"),this.$(".yj-close").show(),this.messageList.scrollList(),this.updateWarn(),this.reflow(),this.uploader&&this._refreshUploader();else{var a=b.contains(this.$el[0],document.activeElement);this.$el.addClass("is-closed"),this.$el.attr("aria-expanded","false"),a&&this.$(".yj-chat-session--header-button").focus()}},addUsersTooltip:function(){o.trigger("/ui/tooltip/remove",{target:this.$chatTitle}),this.others.length<=1||o.trigger("/ui/tooltip/add",{target:this.$chatTitle,validHTML:!0,text:B.chat_session_users_tooltip({users:c.map(this.others,function(a){return{presence_html:n.buildPresence(a,q),full_name:a.get("full_name")}})})})},minimized:function(){return!this.$el.hasClass("is-open")},unreadCount:function(){return this._delegate?this.getDelegate().getUnseenCount():0},toggleUnreadColors:function(){if(this.$el){var a=this.unreadCount()>0?"unread":"read";this.$el.removeClass("is-unread").removeClass("is-read").addClass("is-"+a)}},getOtherParticipants:function(){var a=c.map(this._users,function(a){return x.findById(a.id)});return c.reject(a,function(a){return!a.id||a.id===q.getCurrentUser().id})},setTitle:function(){var a;if(this.others=this.getOtherParticipants(),this._users&&this._users.length>0){var b;if(1===this.others.length){var d=c.first(this.others);b=new l({model:d}),a=n.getFullName(d)}else a=u.tlist(c.map(this.others,n.getFirstName));this.$publisher&&this.$publisher.find(".yj-acc-chat-publisher-label").text(u.t("send_message_to_recipients",{recipients:a})),this.title=B.chat_session_title({presence_class:n.getPresenceCssClass(this.others[0],q),presence_type:n.getPresenceLabel(this.others[0],q),uid:this.others[0].id,title:a,oneOther:1===this.others.length,windowStatus:this.minimized()?u.t("pane_minimized"):u.t("pane_open")}),this.$chatTitle.html(this.title),b&&this.$(".yj-chat-title-inner").append(b.render().$el)}},headCount:function(){var a=this.unreadCount();this.$headCount.removeClass("yj-chat-zero").text(""+a),a&&0!==a||this.$headCount.addClass("yj-chat-zero"),c.defer(this.toggleUnreadColors.bind(this))},focus:function(){this.minimized()&&this.toggleOpenState(),this.$("textarea").focus(),this.markAsRead()},getSoundSettingFromStore:function(){var a=r.get("yj-chat-contact-list");return a?a.sounds_enabled:!1},_isSoundEnabled:function(){var a=yam.ui.chatManager.soundsEnabled();return a&&this.unreadCount()>0&&!this.$("textarea").is(":focus")},shouldHandleMessage:function(a){if(a.is_reference||!a.direct_message)return!1;var b=this.getThreadId();return b&&a.thread_id==b},handleMessage:function(a){if(!this._loadingOlder&&this.shouldHandleMessage(a)){var b=this.getThread(),c=q.getCurrentUser(),e=a.getSender().getUser(),f=a.sender_id===c.id;if(f&&this.messageList.clearPendingMessage(a.chat_client_sequence),this.messageList.render(),(this.firstLoadOlder||this.firstLocalReplyId<a.id)&&this.messageList.scrollList(),this._users=[],a.getConversation()&&this._addUsers(y.getParticipants(a.getConversation()).map(x.save.bind(x))),!f&&this._isSoundEnabled()&&m.beep(),!f&&a.isFromRealtime){var g=d.formatDateTime(new Date(a.getTime()));k.announceText(u.t("from_name_message_at_time",{name:e.get("full_name"),message:a.getPlainBody(),time:g}),"assertive")}this.handleRecipientsChange(),this.notifications&&(f||this.notifications.setUsersTyping(e.id,null),this.notifications.render()),f||(this.headCount(),b&&!b.isSeen()&&t.flashChat());var h=a.getThread().thread_starter_id==a.id,i=a.getThread().local_latest_reply_id==a.id;f&&h&&i&&this.messageList.getPendingMessagesCount()&&yam.ui.chatManager.store()}},handleSubmitSuccess:function(a){var b=a.data,c=!this.getThreadId();c&&(this.setThreadId(b.messages[0].thread_id),yam.ui.chatManager.store(),yam.ui.chatManager.chatBridge.send(["reloadSessions"],0));var d=yam.model.Message.findOrCreate(b.messages[0]);this.messageList.clearPendingMessage(d.chat_client_sequence),this.handleMessage(d),this.notifications&&this.notifications.render()},handleSubmitError:function(a){var b=a.requestId,c=this.publisher.getSnapshot(b),d=this.messageList;d.clearPendingMessage(b),d.handleFailedMessage(b,c)},loadOlder:function(){var a=this.getThread();a&&a.getFirstLocalReply()&&(this._loadingOlder=!0,this.firstLocalReplyId=a.getFirstLocalReply().id,this.feed.fetchThread(a.id,{threaded:!1,older_than:a.getFirstLocalReply().id}).then(c.bind(function(){this.messageList&&(this.messageList.render(),this.firstLoadOlder&&this.messageList.scrollList()),this._loadingOlder=!1,this.firstLoadOlder=!1,this.firstLocalReplyId=a.getFirstLocalReply().id},this)))},getThread:function(){return this._thread},getThreadId:function(){return this._threadId},getUniqueId:function(){return null!==this._threadId?this._threadId:"participants-"+c.sortBy(c.pluck(this._users,"id"),function(a){return a}).join("-")},setThreadId:function(a){if(this._threadId!=a){if(this._threadId=a,this._thread=yam.model.Thread.findById(a),this.addMember&&this.addMember.handleThreadId(null,a),this.publisher&&this.publisher.handleThreadId(null,a),this.notifications&&this.notifications.setThreadId(a),this._thread){this.messageList&&this.messageList.setDelegate(this.getDelegate());var b=this._thread.getSortedMessages();b.length<=20&&this._thread.getReplyCount()>1?this.loadOlder():this.messageList.render(),this._thread.isListening()||this.addThreadEventListeners(),this.listenTo(A,"Thread/"+this._thread.id+"/update",function(){this._thread.isSeen()&&this.$el.hasClass("is-unread")&&this.markAsRead()}.bind(this))}this.trigger("threadId",a)}},addThreadEventListeners:function(){var a=this.getThread();if(a){a.listen();var b="/threads/"+this.getThreadId();this.listenTo(o,b,this.handleThreadEvent);var d=c.throttle(this.notifyTyping.bind(this),this.TYPING_EVENT_THROTTLE);this.listenTo(this.publisher,"keyup",d),this.listenTo(this.publisher,"keyup",this.notifyTypingOnceOnNewMessage)}},markAsRead:function(){this._delegate&&(this._delegate.getUnseenCount()>0&&yam.ui.chatManager.chatBridge.send(["markSessionAsRead",this.getUniqueId()]),this._delegate.markSeen(),this.headCount(),t.clearFlash())},notifyTyping:function(a){a&&"keyup"===a.type&&13!==a.keyCode&&this._broadcastTypingEventToThread()},notifyTypingOnceOnNewMessage:function(a){a&&"keyup"===a.type&&(13===a.keyCode?this._typingEventDispatched=!1:this._typingEventDispatched||this._broadcastTypingEventToThread())},_broadcastTypingEventToThread:function(){if(this.publisher&&this.publisher.getMessageLength&&this.publisher.getMessageLength()>0&&this._users.length>1){var a=this.getThread();a&&c.defer(a.broadcast.bind(a,"typing")),this._typingEventDispatched=!0}},handleThreadEvent:function(a){switch(a.type){case this.threadEvents.TYPING:a.from_user_id!==q.getCurrentUser().id&&(this.hideNotification(this.$offlineMsg),this.showNotification(this.$notifications));break;case this.threadEvents.MOVE_TO_GROUP:this.handleMoveToGroup(a.data);break;case this.threadEvents.LIKES:var b=a.data,c=x.findById(b.user_id),d=yam.model.Message.findById(b.message_id);c&&d&&("like"===b.action?d.addLike(c):"unlike"===b.action&&d.removeLike(c),this.messageList.renderMessage(b.message_id))}},handleMoveToGroup:function(a){var e=this.$el.find(".yj-chat-message-list"),f=a.user,g=!!f.get;e.append(B.chat_session_move_to_group({sender_url:g?z.userIndex(f,q):z.userIndex(f,q),avatar:g?f.get("mugshot_url"):f.mugshot_url,sender_name:g?f.get("full_name"):f.full_name,body:u.t("moved_this_conversation_from_a_private_message_to_the_group",{group:a.group_name}),link:v.app("/#/Threads/show?threadId="+a.thread_id),linkText:u.t("continue_this_conversation"),timestamp:d.formatDateTimeShortMonth(new Date)})),e.find(".yj-continue-chat").click(c.bind(function(a){this.handleClose(a),window.location=b(a.target).attr("href")},this)),this.publisher.forceDisable(),this.messageList.scrollList(),this.trigger("moveToGroup",this)},_addUsers:function(a){var b=!c.isArray(a);a=b?[a]:c.clone(a),this._users.push.apply(this._users,a);var d=this.getOtherParticipants();(d||[]).forEach(function(){this.stopListening(A,"User/"+d[0].id+"/update")}.bind(this)),1===d.length&&this.listenTo(A,"User/"+d[0].id+"/update",function(a,b){b.before.presence!==b.after.presence&&this.handleRecipientsChange()}.bind(this))},handleMembers:function(a){for(var b=0;b<a.length;b++){var c=x.save(a[b]);this._addUsers(c)}this.addMember.users=this._users,this.toggleAddMembers(),this.handleRecipientsChange(),yam.ui.chatManager.store(),this.checkForForeignUsers(),this.updateWarn(),this.focus()},handleSubmitImmediately:function(a){"show"===this._addMemberState&&this.toggleAddMembers();var b=a.chat_client_sequence;this.messageList.handlePendingMessage(b,a),k.announceText(u.t("from_name_message",{name:q.getCurrentUser().full_name,message:a.body}),"assertive")},handleResend:function(a){var b=a;this.publisher.submitSnapshot(b)},handleLike:function(){this.markAsRead()},handleRecipientsChange:function(){this._users&&(this.updateWarn(),this.checkForForeignUsers(),this.setTitle(),this.addUsersTooltip())},updateWarn:function(){if(this.others=this.getOtherParticipants(),!this.others)throw new Error("No Other Users in chat");if(1===this.others.length){var a=this.others[0];this._hasForeignUsers()||"offline"!==n.getPresenceStatus(a,q)?(this.hideNotification(this.$offlineMsg),this.$el.hasClass("yj-with-offline-msg")&&this.$el.removeClass("yj-with-offline-msg")):(this.showNotification(this.$offlineMsg,a.get("full_name")+" is currently offline."),this.addMember&&(this.setAddMembersState("hide"),this.addMember.hide()))}else this.hideNotification(this.$offlineMsg)},_hasForeignUsers:function(){return c.some(this._users,function(a){return n.isForeign(a,q)})},checkForForeignUsers:function(){if(this._hasForeignUsers()){var a=u.t("this_conversation_includes_external_participants");this.hideNotification(this.$offlineMsg),this.showNotification(this.$externalMsg,a)}},showNotification:function(a,b){a&&(c.isString(b)&&b.length>0&&a.text(b),a.is(":not(.notification-is-visible)")&&(a.removeClass("notification-is-hidden").addClass("notification-is-visible"),this.reflow()))},hideNotification:function(a){a&&a.is(":not(.notification-is-hidden)")&&(a.addClass("notification-is-hidden").removeClass("notification-is-visible"),this.reflow())},mainContentElements:["$offlineMsg","$externalMsg","$addMemberContainer","$notifications"],reflow:function(){var a=this.$(".yj-chat-session--main-content").height();c.each(this.mainContentElements,function(b){var c=this[b];if(c&&c.is(":visible")){var d=c.outerHeight();a-=d}},this),this.messageList&&(this.messageList.setHeight(a),this.messageList.trigger("scrollToBottom"))},isActive:function(){return this.publisher.isOpen()}})}),define("css!feeds/lib/ui/chat/chat_aggregator",[],function(){}),define("stache!feeds/lib/ui/chat/chat_aggregator",["mustache"],function(a){var b="<ul class='yj-chat-aggregator--session-list' style='display:none' />\n<h2 class='yj-chat-aggregator--tab unstyle-heading-as-div'>\n  <button type='button' class='unstyle-button-as-span' aria-haspopup='true' data-speechtip=\"{{chatAggregatorText}}\">\n    <span class='yj-chat-aggregator--icon yamicon yamicon-chat yj-dark-gray'>\n      <span class=\"yj-acc-hidden\">{{chatAggregatorText}}</span>\n    </span>\n    <span class='yj-chat-aggregator--count'></span>\n    <span class='yj-chat-aggregator--unread-count yj-chat-unread-count'>\n      <span class=\"yj-acc-hidden\">{{unreadCountAltText}}</span>\n      {{unreadCount}}\n    </span>\n  </button>\n</h2>\n";return a.parse(b),function(c){return a.render(b,c)}}),define("stache!feeds/lib/ui/chat/chat_aggregator_session",["mustache"],function(a){var b="<li class='yj-chat-aggregator--session-item'>{{{ title }}} {{#unreadCount}}<span class='yj-chat-unread-count'>{{ unreadCount }}</span>{{/unreadCount}}</li>\n";return a.parse(b),function(c){return a.render(b,c)}}),define("feeds/lib/ui/chat/chat_aggregator",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","css!./chat_aggregator","common-ui/lib/ui/accessibility/menu_accessibility","html!./chat_aggregator","html!./chat_aggregator_session"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/tr");a("css!./chat_aggregator");var g=a("common-ui/lib/ui/accessibility/menu_accessibility");return d.extend({mixins:[e],className:"yj-chat-aggregator",template:a("html!./chat_aggregator"),sessionTemplate:a("html!./chat_aggregator_session"),initialize:function(){this.sessions=[],this.$el.hide()},events:{"click .yj-chat-aggregator--tab":"toggle","click .yj-chat-aggregator--session-item":"_toggleSession"},getTemplateData:function(){return{chatAggregatorText:f.t("chat_aggregator"),unreadCountAltText:f.t("chat_aggregator_unread_alt"),unreadCount:this._getUnreadCount()}},render:function(){return this.count=this.$(".yj-chat-aggregator--count"),this.unread=this.$(".yj-chat-aggregator--unread-count"),this.sessionsList=this.$(".yj-chat-aggregator--session-list"),this.tab=this.$(".yj-chat-aggregator--tab"),this},_toggleSession:function(a){this._close();var c=b(a.currentTarget).data("yj-session");yam.ui.chatManager.switchSession(c),c&&c.focus()},toggle:function(){this.tab.hasClass("is-open")?this._close():this._open()},_open:function(){if(!this.tab.hasClass("is-open")){var a=this,d=this.sessionsList.empty();c.each(this.sessions,function(c){var e=a.sessionTemplate({title:c.title,unreadCount:c.unreadCount()}),f=b(e).data("yj-session",c);f.find(".yj-acc-window-status").remove(),d.append(f)},this),this.tab.addClass("is-open"),d.show(),g.afterMenuShow(d[0],this._close.bind(this)),b(document.body).on("mousedown.chat_aggregator_menu",function(c){b.contains(a.$el[0],c.target)||a.$el[0]===c.target||a._close()})}},_close:function(){this.tab.hasClass("is-open")&&(this.tab.removeClass("is-open"),this.sessionsList.hide(),g.afterMenuDone(this.sessionsList[0]),b(document.body).off("mousedown.chat_aggregator_menu"))},empty:function(){this.sessions=[]},push:function(a){this.sessions.push(a)},_getUnreadCount:function(){return c.reduce(this.sessions,function(a,b){return(b.unreadCount()||0)+a},0)},update:function(){this._close();var a=this._getUnreadCount();a>0?this.unread.show().text(a):this.unread.hide(),this.count.text(this.length()),this.$el[this.length()>0?"show":"hide"]()},length:function(){return this.sessions.length},align:function(a){this.$el.css("right",a)}})}),define("feeds/lib/ui/chat/local_storage_bridge",["require","underscore","backbone","core/lib/log","core/lib/adapters/store_adapter","feeds/lib/ui/util/title_updater"],function(a){var b=a("underscore"),c=a("backbone"),d=a("core/lib/log"),e=a("core/lib/adapters/store_adapter"),f=a("feeds/lib/ui/util/title_updater");return c.Model.extend({send:function(a,c){"undefined"==typeof c&&(c=500),a&&b.delay(b.bind(function(){e.set(this.get("key"),JSON.stringify(a))},this),c)},sendAndApply:function(){var a=Array.prototype.slice.apply(arguments);this.applyCommand.apply(this,a),this.send(a)},onStorageEvent:function(a){d.log("onStorageEvent",a.newValue);var b=JSON.parse(a.newValue);this.applyCommand.apply(this,b)},applyCommand:function(){var a=Array.prototype.slice.apply(arguments),b=a.shift();this[b]&&this[b].apply(this,a)},markSessionAsRead:function(a){var b=this.findSessionByUniqueId(a);if(b){var c=b.getThread();c&&(this.chatManager.feed.setUnseenCountFor(c,0),b.headCount(),f.clearFlash())}}})}),define("feeds/lib/ui/chat/chat_bridge",["require","feeds/lib/ui/chat/local_storage_bridge","core/lib/adapters/store_adapter"],function(a){var b=a("feeds/lib/ui/chat/local_storage_bridge"),c=a("core/lib/adapters/store_adapter");return b.extend({defaults:{key:"yj-chat-bridge"},initialize:function(){this.chatManager=this.get("chatManager");var a="storageEvent:"+this.get("key");this.listenTo(c,a,this.onStorageEvent.bind(this))},destroy:function(){this.stopListening(),this.chatManager=null,this.set("chatManager",null)},findSessionByUniqueId:function(a){return this.chatManager.findSessionByUniqueId(a)},reloadSessions:function(){this.chatManager.reloadSessions()},closeSession:function(a){var b=this.findSessionByUniqueId(a);b&&(this.chatManager.removeSession(b),this.chatManager.reflow())},minimizeSession:function(a){var b=this.findSessionByUniqueId(a);b&&b.minimize()},maximizeSession:function(a){var b=this.findSessionByUniqueId(a);b&&b.open()},updateSessionPublisher:function(a,b){var c=this.findSessionByUniqueId(a);c&&c.publisher.setVal(b)}})}),define("feeds/lib/ui/chat/chat_manager",["require","jquery","underscore","core/lib/backbone_legacy_integration","models/user","feeds/lib/ui/chat/contact_list","feeds/lib/ui/chat/chat_session","feeds/lib/ui/chat/chat_aggregator","feeds/lib/ui/chat/chat_bridge","models/lib/helper/feed_factory","core/lib/log","core/lib/report","core/lib/session","core/lib/adapters/store_adapter","common-ui/lib/ui/keyboard/keyboard_shortcuts","models/helpers/conversation","core/lib/yammer_api","models/lib/events","models/user","models/thread"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_legacy_integration"),e=a("models/user"),f=a("feeds/lib/ui/chat/contact_list"),g=a("feeds/lib/ui/chat/chat_session"),h=a("feeds/lib/ui/chat/chat_aggregator"),i=a("feeds/lib/ui/chat/chat_bridge"),j=a("models/lib/helper/feed_factory"),k=a("core/lib/log"),l=a("core/lib/report"),m=a("core/lib/session"),n=a("core/lib/adapters/store_adapter"),o=a("common-ui/lib/ui/keyboard/keyboard_shortcuts"),p=a("models/helpers/conversation"),q=a("core/lib/yammer_api"),r=a("models/lib/events");a("models/user"),a("models/thread");var s=10;return d.extend({className:"yj-chatmanager zindex-t2 yj-fixed-bottom",template:"<div class='yj-chatmanager--contactlist' /><div class='yj-chatmanager--sessions'/><div class='yj-chatmanager--aggregator'/>",initialize:function(){c.bindAll(this,"handleThread","onAfterProcess"),this._subscriptions=[],this.feed=j.findOrCreate("inboxChat"),this.feed.fetch().then(this.feed.connectToRealtime.bind(this.feed)),this.listenToOnce(this.feed,"onAfterProcess",this.onAfterProcess),this.sessions=[],this.localSessions={},this.contactList=new f({feed:this.feed}),this.listenTo(this.contactList,"settings",this.handleSettings.bind(this)),this.listenTo(this.contactList,"contact",this.handleContact.bind(this)),this.add(this.contactList,".yj-chatmanager--contactlist"),this.aggregator=new h,this.width=0,this.chatBridge=new i({chatManager:this}),this._debouncedStore=c.debounce(this._store.bind(this),250),this._throttledResize=c.throttle(this.handleResize.bind(this),100),b(window).on("resize",this._throttledResize),this.listenTo(o,"chat_list",this._commandOnlineNow),this.listenTo(o,"chat_prev",this._commandPrevWindow),this.listenTo(o,"chat_next",this._commandNextWindow)},onAfterProcess:function(){this.listenTo(r,"ThreadFeedDelivery/"+this.feed.id+"/create",this.handleThread),this.listenTo(r,"ThreadFeedDelivery/"+this.feed.id+"/update",this.handleThread),this.loadFromLocalStorage()},render:function(){this.$el.html(this.template),this.$sessions=this.$el.find(".yj-chatmanager--sessions"),this.aggregator&&this.$el.find(".yj-chatmanager--aggregator").append(this.aggregator.render().el)},remove:function(){d.prototype.remove.apply(this,arguments),b(window).off("resize",this._throttledResize),this.stopListening(),this.feed=null,this.localSessions=null,this.contactList=null,this.aggregator&&this.aggregator.destroy&&(this.aggregator.destroy(),this.aggregator=null),this.chatBridge&&this.chatBridge.destroy(),this.chatBridge=null,this._throttledResize=null},soundsEnabled:function(){return this.contactList?this.contactList.soundsEnabled():!1},handleResize:function(){var a=this.$el.width();a!==this.width&&(this.width=a,this.reflow())},createSession:function(a){var b=m.getUserSetting("enable_chat");if(b){var c=this.findSessionByUsers(a.users);return c||(a.feed=this.feed,c=new g(a),this.$sessions.append(c.$el),this.listenTo(c,"close",this.onSessionClose),this.listenTo(c,"toggle",this.onSessionToggle),this.listenTo(c,"moveToGroup",this.onMoveToGroup),this.sessions.push(c),c.render(),a.message_draft&&(c.publisher.setVal(a.message_draft),c.publisher.$el.addClass("has-content"))),c}},removeSession:function(a){this.sessions=c.reject(this.sessions,function(b){return b.getUniqueId()===a.getUniqueId()}),delete this.localSessions[a.getThreadId()],this.stopListening(a),a.remove()},onMoveToGroup:function(a){delete this.localSessions[a.id]},onSessionClose:function(a){var b=a.getUniqueId();this.removeSession(a),this.reflow(),this.chatBridge.sendAndApply("closeSession",b),this.store()},onSessionToggle:function(a){var b=a.isOpen()?"maximizeSession":"minimizeSession";this.chatBridge.sendAndApply(b,a.getUniqueId()),this.store()},findSessionByUsers:function(a){if(a&&a.length){var b=c.pluck(a,"id").sort();return c.find(this.sessions,function(a){var d=c.pluck(a.getOtherParticipants(),"id").sort();return c.isEqual(b,d)})}},findSessionByMessage:function(a){return c.find(this.sessions,function(b){return b.getThreadId()===a.thread_id})},findSessionByUniqueId:function(a){return c.find(this.sessions,function(b){return b.getUniqueId()===a})},reloadSessions:function(){c.invoke(this.sessions,"remove"),this.sessions=[],this.aggregator&&this.aggregator.length()>0&&(this.aggregator.empty(),this.aggregator.update()),this.loadFromLocalStorage()},removeAllSessions:function(){for(var a;a=this.sessions.pop();)this.removeSession(a);this.store()},hasLocalStorageDupesByThreadId:function(){var a=c.map(n.get("yj-chatsessions"),function(a){return a.threadId});return this.hasDuplicateThreadIds(a)},hasSessionDupesByThreadId:function(){var a=c.map(this.sessions,function(a){return a.getThreadId()});return this.hasDuplicateThreadIds(a);
},hasDuplicateThreadIds:function(a){var b=c.reject(a,function(a){return null===a}),d=c.uniq(b);return b.length!==d.length},blockingStore:function(a){var b=this,d=c.map(b.sessions,function(a){return a.serializeForLocalStorage()});try{if(this.hasLocalStorageDupesByThreadId())throw new Error("Duplicate chat session(s) in local_storage.")}catch(a){l.info({message:a.message},a)}try{if(this.hasSessionDupesByThreadId())throw new Error("Duplicate chat session(s) in manager (client-side).")}catch(a){l.info({message:a.message},a)}n.set("yj-chatsessions",d,a)},store:function(a){this._debouncedStore(a)},_store:function(a){c.defer(c.bind(function(){this.blockingStore(a)},this))},closeWindow:function(){window.close()},loadFromLocalStorage:function(){function a(){0===g&&b.createLoadedSessions(d)}var b=this,d=n.get("yj-chatsessions");if(void 0!==d){d=d.sort(function(a,b){return a.position-b.position});var f=c.uniq(c.flatten(c.pluck(d,"participants"))),g=0;c.each(f,function(c){var d=e.findById(c);d||(g++,b._fetchUser(c).fail(function(){k.log("Could not load user "+c+" for chat.")}).always(function(){g--,a()}))}),a()}},createLoadedSessions:function(a){this.localSessions={},c.each(a,function(a){if(a.threadId){var b,d=a.threadId,f=yam.model.Thread.findById(d);f?(this.localSessions[d]=!0,b=f.getLastMessage(),this.handleMessageCreate(b,a,!0)):this.feed&&this.feed.fetchThread(a.threadId,{threaded:"extended"}).then(c.bind(function(){this.localSessions[d]=!0;try{var b=yam.model.Thread.findById(d),c=b.getLastMessage();this.handleMessageCreate(c,a,!0)}catch(a){k.log("Failed to find thread with id "+d+" - error: "+a.message)}},this))}else{var g=c.map(a.participants,e.findById.bind(e));if(0===g.length||-1!==c.indexOf(g,void 0))return void k.log("Missing user in chat, not creating session.");var h={users:g,min:a.minimized,message_draft:a.message_draft,minimized:!1};this.createSession(h)}},this),this.reflow()},_shouldCreateSession:function(a){if(this.findSessionByMessage(a))return!1;if(!this.localSessions[a.thread_id]){if(this.feed.isSeen(a.getThread()))return!1;if(!yam.model.repository.inTransaction())return!1}var b=a.getTime(),c=Date.now()-6048e5;return!(c>b)},_fetchUser:function(a){return q.getUser({include_presence:!0,id:a}).then(e.save.bind(e))},handleThread:function(a){var b=a.getLastMessage();this.handleMessageCreate(b)},handleMessageCreate:function(a,b){if(!a.is_reference&&a.isChat()&&a.direct_message){if(!this._shouldCreateSession(a))return void this.aggregator.update();var d=[];if(a.getConversation()&&(d=c.compact(c.map(a.getConversation().participating_names,function(a){return e.findById(a.id)}))),!d)throw"CHAT: USERS FAILED";var f=a.getThread(),g={threadId:f.id,users:d,message_draft:""};b&&c.extend(g,{message_draft:b.message_draft,min:b.minimized});var h=this.createSession(g);if(h&&(h.handleMessage(a),this.switchSession(h),this.aggregator&&this.aggregator.update(),h.getThreadId())){var i=n.get("yj-chatsessions"),j=c.find(i,function(a){return a.threadId===h.getThreadId()});j||this.store(!0)}this.aggregator.update()}},switchSession:function(a){this.adjustNewChatLocation(a),this.reflow(),a.reflow(),a.messageList.scrollList()},adjustNewChatLocation:function(a){var b,d,e=this.sessions;if(this.reflow(),b=c.indexOf(e,a),d=this.visibleSessionCount()-1,b!==d&&d>-1){var f=e[d];if(f.isActive()){if(0!==d){var g=e[b];e[b]=e[0],e[0]=g}}else e.splice(b,1),e.splice(d,0,a)}},visibleSessionCount:function(){return this.sessions.length-this.aggregator.length()},reflow:function(){var a=100,b=this.$el.width()-a-s,d=this.contactList.$el.outerWidth()+30,e=d;b=b>1400?1300:b-130,this.aggregator.empty(),c.each(this.sessions,function(a,c){var f=a.$el;a.align(d),a.windowOrder=c,d+=f.outerWidth()+s,b>d?(e=d,f.show(),a.reflow()):(f.hide(),this.aggregator.push(a))},this),this.aggregator.align(e),this.aggregator.update()},unreadCount:function(a){return this.feed.getUnseenCountFor(a)},handleSettings:function(a){a.toInbox&&(this.removeAllSessions(),this.aggregator.empty(),this.aggregator.update(),this.chatBridge.send(["reloadSessions"]))},handleContact:function(a){var b=this.findSessionByUsers([a]);b||(b=this.createSession({users:[a]})),b.focus(),this.switchSession(b),this.store(),this.chatBridge.send(["reloadSessions"])},handleConversation:function(a){var b=a.thread,c=m.getCurrentUser(),d=this.findSessionByUniqueId(b.id);d||(d=this.createSession({threadId:b.id,users:p.getParticipantsExcluding(b.getConversation(),c)})),d.focus(),this.switchSession(d),this.store(),this.chatBridge.send(["reloadSessions"])},_commandOnlineNow:function(){this.contactList.$el.hasClass("yj-chat-closed")&&this.contactList.toggleOpenState(),this.contactList.$searchField.focus()},_commandPrevWindow:function(){this._commandNextPrevWindow(-1)},_commandNextWindow:function(){this._commandNextPrevWindow(1)},_commandNextPrevWindow:function(a){var d,e=c.find(this.sessions,function(a){return b.contains(a.$el[0],document.activeElement)},this);if(e){var f=this.sessions.indexOf(e);if(d=f-a,0>d)return;d>=this.visibleSessionCount()&&(d=this.sessions.length-1)}else d=a>0?0:this.visibleSessionCount()-1;var g=this.sessions[d];d>=this.visibleSessionCount()&&this.switchSession(g),g.minimized()&&g.toggleOpenState(),g.focus()}})}),define("css!feeds/lib/ui/chat/chat",[],function(){}),define("workfeed/lib/app/bundles/chat_bundle",["require","jquery","feeds/lib/ui/chat/chat_manager","backbone","core/lib/session","common-ui/lib/helper/environment","core/lib/uri_helper","core/lib/yammer_uri","css!feeds/lib/ui/chat/chat"],function(a){"use strict";var b=a("jquery"),c=a("feeds/lib/ui/chat/chat_manager"),d=a("backbone"),e=a("core/lib/session"),f=a("common-ui/lib/helper/environment"),g=a("core/lib/uri_helper"),h=a("core/lib/yammer_uri");a("css!feeds/lib/ui/chat/chat");var i=0;return{isChatEnabled:function(){return e.getUserNetworkSetting("enable_chat")&&this._validPlatform()&&this._validScreenSize()},_validPlatform:function(){return!f.isMobile()},_validScreenSize:function(){return b(window).width()>=i},run:function(){var a=this;yam.ready(function(){var e=function(){var a=g.parse(location.href),b=a.anchor,c=h.app();switch(!0){case location.href===c||location.href===c+"/":return!0;case/threads\/index/i.test(b):return!0;case/conversations\/index/i.test(b):return!0;case/inbox\/index/i.test(b):return!0}return!1},f=function(){yam.ui.chatManager||(yam.ui.chatManager=new c({}),b("body").append(yam.ui.chatManager.render().$el))};a.isChatEnabled()&&(e()?(d.on("/ui/view/afterListRendered",f),yam.router.on("route",f)):f())})}}}),define("components/suite_nav/index",["require","./src/suite_nav"],function(a){"use strict";return a("./src/suite_nav")}),define("workfeed/lib/app/bundles/suite_nav_bundle",["require","components/suite_nav/index"],function(a){"use strict";var b=a("components/suite_nav/index");return{run:function(a){b.run({polarisHost:a})}}}),define("workfeed/lib/app/bundles/banners_bundle",["require","collections/banners"],function(a){var b=a("collections/banners"),c=function(a){b.bootstrap(["educational-popup-recipient","educational-popup-thread-starter","tom_inbox_web_wording","external-group-banner","connect-with-coworkers-lightbox","expiring-announcements"],a)};return{run:c}}),define("css!common-ui/lib/ui/groups/group_description_editor",[],function(){}),define("common-ui/lib/ui/groups/group_description_editor",["require","underscore","core/lib/backbone_base_view","core/lib/backbone_with_legacy_subviews","core/lib/backbone_with_subviews","common-ui/lib/ui/shared/inline_edit","backbone","core/lib/tr","core/lib/yammer_api","css!./group_description_editor"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/backbone_base_view"),d=a("core/lib/backbone_with_legacy_subviews"),e=a("core/lib/backbone_with_subviews"),f=a("common-ui/lib/ui/shared/inline_edit"),g=a("backbone"),h=a("core/lib/tr"),i=a("core/lib/yammer_api");return a("css!./group_description_editor"),c.extend({mixins:[d,e],tagName:"p",className:"yj-group-description description",initialize:function(a){this._description=a.description,this._groupId=a.groupId,this._createEditor(),this._setEditorEvents()},change:function(a){this._editor.trigger("change",a)},_createEditor:function(){this._editor=new f({type:"editable",maxLength:150,data_id:this._groupId,editType:"input",defaultText:h.t("default_group_description"),text:this._description,fieldLabel:h.t("group_description_form_label"),editLabel:h.t("edit_group_description")}),this.add(this._editor)},_setEditorEvents:function(){b.bindAll(this,"_onEditorChange"),this._editor.on("change",this._onEditorChange)},_onEditorChange:function(a){a&&(this._description=a.value,i.updateGroup({description:this._description,id:this._groupId}),g.trigger("/ui/group/descriptionEdit/"+this._groupId,this._description))}})}),define("stache!components/admin/src/private_content_mode",["mustache"],function(a){var b='<ul class="radiolist">\n  <li class="bold-labels">\n    <label>\n      <input class="radio choose-content-mode" name="is-private-content-mode" type="radio" value="false">\n      {{default_mode_label}}\n    </label>\n  </li>\n\n  <li class="bold-labels">\n    <label>\n      <input class="radio choose-content-mode" name="is-private-content-mode" type="radio" value="true">\n      {{private_content_mode_label}}\n    </label>\n    <div class="sub_form">{{private_content_mode_description}}</div>\n  </li>\n</ul>\n\n<button type="button" class="yj-btn yj-private-content-mode-save">{{save_button_label}}</button>';return a.parse(b),function(c){return a.render(b,c)}}),define("components/admin/src/private_content_mode",["require","underscore","core/lib/tr","core/lib/session","backbone","core/lib/yammer_api","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","html!./private_content_mode","models/helpers/user"],function(a){"use strict";var b=a("underscore"),c=a("core/lib/tr"),d=a("core/lib/session"),e=a("backbone"),f=a("core/lib/yammer_api"),g=a("core/lib/backbone_base_view"),h=a("core/lib/backbone_with_auto_render"),i=a("html!./private_content_mode"),j=a("models/helpers/user"),k={default_mode_label:c.t("default_content_mode"),private_content_mode_label:c.t("private_content_mode"),private_content_mode_description:c.t("private_content_mode_description"),save_button_label:c.t("admin_settings_save")},l='input[type="radio"][name="is-private-content-mode"]';return g.extend({mixins:[h],template:i,className:"yj-private-content-mode",events:{"click .yj-private-content-mode-save":"_onSave"},getTemplateData:function(){return b.extend({},k)},render:function(){return this._updateRadioButtons(j.isSupervisorAdmin(d.getCurrentUser())),this},_updateRadioButtons:function(a){this.$(l+'[value="'+a+'"]').prop("checked",!0)},_onSave:function(){var a="",b=this.$(l+":checked");return b.length>0&&(a=b.val()),"true"!==a&&"false"!==a?void this._onError():void f.setPrivateContentMode({enabled:a}).then(this._onSuccess.bind(this),this._onError.bind(this))},_onSuccess:function(a){switch(a&&a.supervisor_mode){case"true":break;case"false":e.trigger("/ui/stop_private_content_mode");break;default:return void this._onError()}e.trigger("/ui/alert/show","notice",c.t("private_content_mode_save_success"))},_onError:function(){e.trigger("/ui/alert/show","error",c.t("private_content_mode_save_error"))}})}),define("feeds/lib/ui/files/pages_files_selector",["require","jquery","underscore","core/lib/backbone_legacy_integration","mustache","components/avatar/index","core/lib/date_helper","collections/groups","backbone","feeds/lib/ui/files/selector","feeds/lib/ui/shared/simple_menu","feeds/lib/ui/shared/tabular_item_viewer","feeds/lib/ui/shared/thumbnail_item_viewer","models/unknown","feeds/lib/ui/attachments/yamio_preview","core/lib/filename_helper","core/lib/session","core/lib/string_helper","core/lib/tr","common-ui/lib/helper/ui","core/lib/uri_helper","core/lib/yammer_request","core/lib/yammer_uri","core/lib/yammer_api","feeds/lib/ui/selectors/templates_helper","common-ui/lib/ui/general/delete_note_confirmation","common-ui/lib/ui/general/lightbox_manager","html!feeds/lib/ui/selectors/group","models/helpers/user"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_legacy_integration"),e=a("mustache"),f=a("components/avatar/index"),g=a("core/lib/date_helper"),h=a("collections/groups"),i=a("backbone"),j=a("feeds/lib/ui/files/selector"),k=a("feeds/lib/ui/shared/simple_menu"),l=a("feeds/lib/ui/shared/tabular_item_viewer"),m=a("feeds/lib/ui/shared/thumbnail_item_viewer"),n=a("models/unknown"),o=a("feeds/lib/ui/attachments/yamio_preview"),p=a("core/lib/filename_helper"),q=a("core/lib/session"),r=a("core/lib/string_helper"),s=a("core/lib/tr"),t=a("common-ui/lib/helper/ui"),u=a("core/lib/uri_helper"),v=a("core/lib/yammer_request"),w=a("core/lib/yammer_uri"),x=a("core/lib/yammer_api"),y=a("feeds/lib/ui/selectors/templates_helper"),z=a("common-ui/lib/ui/general/delete_note_confirmation"),A=a("common-ui/lib/ui/general/lightbox_manager"),B=a("html!feeds/lib/ui/selectors/group"),C=a("models/helpers/user");return j.extend(new function(){this.defaults={id:"fileSelector",_dataName:"files",_createLinkText:s.t("upload_file"),_createPageText:s.t("create_note"),_createLinkIcon:"inbox-upload-icon",_navSections:[{id:"all",header:null,items:[{id:"files-all",title:s.t("all_files"),api:"uploaded_files.json"}]},{id:"user",header:s.t("my_files"),items:[{id:"files-user-accessed",title:s.t("recently_accessed_my_files_that_i_have_recently_accessed"),api:"uploaded_files/recently_accessed.json"},{id:"files-user-follow",title:s.t("following_my_files_that_i_follow"),api:"uploaded_files/followed_by/:user_id.json"},{id:"files-user-uploaded",title:s.t("updated_by_me"),api:"uploaded_files/uploaded_by/:user_id.json"}]},{id:"group",header:s.t("my_groups_my_groups_header"),items:[{id:"files-all-company",title:"",api:"uploaded_files/in_group/company.json"}]}],_prototypeLazyInit:!1,_tableCols:[{title:s.t("name_header_for_file_name_column"),source:function(a,b,d){var f,g,h,i="";if("page"===a.type)f='<span class="yj-inline-icon document-default-icon"></span>&nbsp;',g=this.inLightbox?e.render("<span>{{name}}</span>",{name:a.name}):e.render('<a href="{{web_url}}">{{name}}</a>',{name:a.name,web_url:a.web_url});else{f='<span class="yj-inline-icon document-'+p.getCanonicalExtension(a.name)+'-icon"></span>&nbsp;';var j=p.getExtension(a.name),k=new RegExp("\\."+r.escapeRegExp(j)+"$"),l=h?"yj-private-name":"";h=this.getLockedStatus(a).locked,i=""!==j?c.escape(a.name).replace(k,""):c.escape(a.name),g=this.inLightbox?'<span class="'+c.escape(l)+'">'+i+"</span>":'<a class="'+c.escape(l)+'" href="'+c.escape(a.web_url)+'">'+i+"</a>"}d.attr("title",i),a.official&&(f+='<span class="official-badge-small yj-inline-icon yj-align-icon yj-enhanced-tooltip"></span>&nbsp;'),f+=g,h&&(f+=' <span class="yamicon-lock yamicon yamicon-xx-small yj-dark-gray"></span>'),d.html(f)}},{title:s.t("type_2"),source:function(a,b,c){if("page"==a.type)return void c.html(a.type);var d=p.getExtension(a.name)||"";c.html(d)},headerStyle:"width: 50px;",dataStyle:"text-align: center;"},{title:s.t("group_2"),source:function(a,b,d){if(a.external_share)return void d.html('<span><em style="color:#999">'+s.t("external_file")+"</em></span>");var e=y.getGroupTemplateData(a),f=B(c.extend({in_lightbox:this.inLightbox},e));d.html(f)},headerStyle:"width: 15%;"},{title:s.t("last_updated_by"),source:function(a,b,d){if(!a.external_share){var e=this._getLastUpdatedUserForItem(a)||q.getCurrentUser(),g=new f({model:e,withHovercard:"left",hideFromAccessibility:!0}),h=c.escape(e.full_name),i=this.inLightbox?'<span class="yj-hovercard-link" data-resource-id="'+e.id+'">'+h+"</span>":'<a class="yj-tabular-user-link yj-hovercard-link" href="'+c.escape(e.web_url)+'" data-resource-id="'+e.id+'">'+h+"</a>";d.append(g.render().$el),d.append(i)}},headerStyle:"width: 20%;"},{title:s.t("last_updated_on"),source:function(a,b,c){var d,f=null===a.last_published_at&&"page"==a.type;d=f?s.t("draft"):g.formatAgo(new Date(a.last_uploaded_at||a.last_published_at),null,!0),c.attr("title",d),c.html(e.render('<div class="yj-tabular-last-uploaded-wrap"><div title="{{dt}}" class="yj-tabular-last-uploaded">{{#isDraft}}<em>{{dt}}</em>{{/isDraft}}{{^isDraft}}{{dt}}{{/isDraft}}</div>{{#show}} <button aria-haspopup="true" class="yj-simple-menu-trigger unstyle-button-as-span" data-selector-menu-link="true" data-speechtip><span class="yj-inline-icon selector-icon"><span class="yj-acc-hidden">'+s.t("actions")+"</span></span></button>{{/show}}</div>",{dt:d,isDraft:f,show:!this.inLightbox&&!a.external_share}))},headerStyle:"width: 20%;",dataStyle:"overflow: visible; padding: 0 3px 0 0;"}],_methods:{preview:function(){var a=this.currentItem;i.trigger("/ui/fancy-lightbox/open",{attachmentId:a.id,type:a.type,instance:a})},share:function(){var a=this.currentItem,b=c.extend({},a,{id:a.id,type:a.type,source:"directory_dropdown"});i.trigger("/ui/publisher/share-lightbox/open",{excerptOptions:b})},follow:function(){var a=this.currentItem,b=function(){i.trigger("/ui/alert/show","notice",s.t("you_are_now_following_name",{name:a.name})),C.follow(q.getCurrentUser(),a.type,a.id),this._followedIds[a.id]=!0};x.subscribeToTarget({target_type:a.type,target_id:a.id}).then(b.bind(this))},unfollow:function(){var a=this.currentItem,b=function(){i.trigger("/ui/alert/show","notice",s.t("you_are_no_longer_following_name",{name:a.name})),C.unfollowPage(q.getCurrentUser(),a.id),delete this._followedIds[a.id]};x.unsubscribeFromTarget({target_type:a.type,target_id:a.id}).then(b.bind(this))},delete:function(a){var c,d=this.currentItem;if("page"!==d.type)c=window.confirm(s.t("delete_file_warning_confirm")),c&&v.send({type:"delete",dataType:"text",url:d.url,success:function(){void 0!==t.shiftCount&&t.shiftCount("#yj-group-files-link .yj-tab-counter",-1),i.trigger("/ui/alert/show","notice",s.t("the_file_has_been_deleted")),b("[data-row-id="+a+"]").fadeOut("slow")},error:function(){i.trigger("/ui/alert/show","error",s.t("there_was_an_error_deleting_your_file"))}});else{var e=new z({itemId:d.id,confirmCallback:function(){t.shiftCount("#yj-group-notes-link .yj-tab-counter",-1),i.trigger("/ui/alert/show","notice",s.t("the_note_has_been_deleted")),b("[data-row-id="+a+"]").fadeOut("slow")}});A.openComponent(e,"",null,{title:s.t("delete_note_warning_confirm_title"),width:"370",onComplete:function(){b("#cancel-action").focus()}})}}},_groupApiBase:"uploaded_files/in_group/",_userApiBase:"uploaded_files/uploaded_by/",_topicApiBase:"uploaded_files/with_topic/",_filterComponentId:"fileSelectorFilter",_selectorComponentId:"fileSelectorItems",showTypeFilter:!0,_typeFilterComponentId:"fileSelectorTypeFilter",_typeFilterText:s.t("all_file_types"),_typeFilterClickHandler:function(a){var c=b(a.target).closest(".yj-type-filter-item"),d=c.closest(".yj-type-filter");if(c.length){var e=c.attr("data-type");this.selectorComponentChanged=!1,this.filterClass="all"==e?null:e,this.resetSelectorComponent(),this.filterComponent?this.filterComponent.trigger("navigate",this.currentFilterId):this.filterForView(),this.selectorComponentChanged=!0,d.find(".yj-type-filter-text").text(c.text())}}},this.simpleMenuTemplate='<ul class="yj-action-list">{{#canPreview}}<li class="yj-selector-action yj-action-list-item" data-action="selector-method-preview" data-selector-menu-link="true"><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-search yamicon-inline"></span> '+s.t("preview_2")+'</a></li>{{/canPreview}}{{#canEdit}}<li class="yj-selector-action yj-action-list-item" data-selector-menu-link="true"><a href="{{editUrl}}" target="_blank" class="yj-action-list-link"><span class="yamicon yamicon-pencil yamicon-inline"></span> '+s.t("edit")+'</a></li>{{/canEdit}}<li class="yj-selector-action yj-action-list-item yj-selector-follow-link" data-action="selector-method-unfollow" data-selector-menu-link="true" {{^following}}style="display: none;"{{/following}}><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-dash yamicon-inline"></span> '+s.t("unfollow")+'</a></li><li class="yj-selector-action yj-action-list-item yj-selector-follow-link" data-action="selector-method-follow" data-selector-menu-link="true" {{#following}}style="display: none;"{{/following}}><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-plus yamicon-inline"></span> '+s.t("follow")+'</a></li>{{#share}}<li class="yj-selector-action yj-action-list-item" data-action="selector-method-share" data-selector-menu-link="true"><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-share yamicon-inline"></span> '+s.t("share_2")+'</a></li>{{/share}}{{#canDownload}}<li class="yj-action-list-item"><a href="{{downloadUrl}}" class="yj-action-list-link"><span class="yamicon yamicon-download yamicon-inline"></span> '+s.t("download_2")+'</a></li>{{/canDownload}}{{#canDelete}}<li class="yj-selector-action yj-action-list-item" data-action="selector-method-delete" data-selector-menu-link="true"><a href="javascript://" class="yj-action-list-link"><span class="yamicon yamicon-stop yamicon-inline"></span> '+s.t("delete")+"</a></li>{{/canDelete}}</ul>",this.createActionsMenu=function(a){var d=this._refs.group,f=d&&h.get(this.currentItem.group_id),g={id:"selectorActions",className:"yj-selector-simple-menu yj-file-dropdown-container",align:"right",button:'<span class="yj-inline-icon selector-icon"></span>',menuContent:e.render(this.simpleMenuTemplate,{canPreview:o.previewable(this.currentItem)||"page"==this.currentItem.type,canEdit:this.currentItem.edit_url,editUrl:this.currentItem.web_url+"/edit",following:this._followedIds[this.currentItem.id],downloadUrl:this.currentItem.download_url,canDelete:r.convertStringyBoolean(q.getCurrentUser().id==this.currentItem.owner_id||"true"==q.getCurrentUser().admin||f&&C.isAdminOf(q.getCurrentUser(),f)),share:"private"!=this.currentItem.privacy,canDownload:"page"!=this.currentItem.type})};this.menu&&this.menu.remove(),this.menu=new k(g,this),this.$actionsMenu=this.menu.render().$el,this.listener.listenTo(this.menu,"showMenu",c.bind(function(){this.menu.$buttonContainer.find(".yj-inline-icon").addClass("active"),b("[data-row-id="+a+"]").find(".yj-simple-menu-trigger").addClass("active"),this.menu.$buttonContainer.css("z-index","2"),this.menu.$buttonContainer.show()},this)),this.listener.listenTo(this.menu,"hideMenu",c.bind(function(){this.$element.find(".yj-simple-menu-trigger").removeClass("active"),this.menu.$buttonContainer.hide()},this))},this.generateNextPageUrl=function(){var a=this._filterMap[this.currentFilterId],b=a.api,d=b.split("?"),e=d[0],f=u.objectify(d[1]||"");switch(c.extend(f,{page:this.page,content_class:this.filterClass}),e.indexOf("recently_accessed.json")>-1&&(f.order="recent"),this.filterClass){case"official":f.official=!0;break;case"pages":e=e.replace("uploaded_files","notes"),e=e.replace("uploaded_by","authored_by");break;case void 0:case null:e=e.replace("uploaded_files","content"),f.combined=!0,f.content_class="documents"}return w.api(e,f)},this.handleFilter=function(a){var e=this._filterMap[a],f=e.api,g=f.split("?"),h=g[0],j=u.objectify(g[1]||""),k={page:1};if(this.page=1,f){switch(this.$element.find(".yj-type-filter-text").text(e.title),this.selectorComponentChanged&&(this.filterClass=null,this.resetSelectorComponent(),this.typeFilterComponent&&(this.typeFilterComponent instanceof d?this.typeFilterComponent.$(".yj-type-filter-text").text(e.title):this.typeFilterComponent.$element.find(".yj-type-filter-text").text(e.title))),this.filterClass&&(j.content_class=this.filterClass),h.indexOf("recently_accessed.json")>-1&&(k.order="recent"),this.filterClass){case"official":k.official=!0;break;case"pages":h=h.replace("uploaded_files","notes"),h=h.replace("uploaded_by","authored_by");break;case void 0:case null:h=h.replace("uploaded_files","content"),k.combined=!0,k.content_class="documents"}this.currentFilterId=a,this.adjustSelectorComponent(),k=c.extend(k,j),this.$element.offset().top<b(window).scrollTop()&&b("html,body").scrollTop(0);var l=c.bind(function(){this.data=[],this._triggeredMore=!1,this._clickedMore=!1,this.onSelect(null),this.infiniteScroll.restart()},this);this._getData(w.api(h),k,l)}else i.trigger("/ui/alert/show","error","No API endpoint defined.")},this.parseData=function(a){var b,d,e,f=c.union(a.references,a.external_references),g=a.meta;if(b="pages"==this.filterClass?a.pages:a.content?a.content:a.files,!b||!b.length)return this.handleNoData(1===this.page),{data:b,meta:g};for(var i=0,j=f.length;j>i;i++)d=f[i],e=this._refs[d.type]||{},e[d.id]=d,this._refs[d.type]=e;return c.each(f,function(a){"group"===a.type&&h.add(a)}),c.each(b,function(a){n.save(a)}),{data:b,meta:g}},this.resetSelectorComponent=function(){var a,b=this._createLinkText,c=this._tableCols;switch(this.filterClass){case"images":b=s.t("upload_image");break;case"videos":b=s.t("upload_video");break;case"documents":b=s.t("upload_document")}if("pages"!==this.filterClass)a=c;else{a=[];for(var d=0,e=c.length;e>d;d++)c[d].title!==s.t("type_2")&&a.push(c[d])}var f=this.filterClass&&("images"==this.filterClass||"videos"==this.filterClass),g={id:this._selectorComponentId,target:".yj-selector-list",columns:a,createLinkText:b,canCreatePage:!0,createPageText:this._createPageText,showGroup:!1,minItems:10,createLinkIcon:this._createLinkIcon,tableClass:"yj-"+this.defaults._dataName+"-selector",showSelection:this.inLightbox,showCreateLink:this._showCreateLink,parent:this},h=f?new m(g,this):new l(g,this);this.unhookSelectorComponent(),this.selectorComponent.remove(),this.selectorComponent=h,this.$element.find(h.target).append(h.render().$el),this.hookSelectorComponent()},this._getLastUpdatedUserForItem=function(a){return this._refs.user[a.last_uploaded_by_id||a.last_published_by||a.owner_id]}})}),define("platform-embed/lib/emitter",["require","underscore"],function(a){var b=a("underscore");return function(){var a,c={};return a={emit:function(a){var d,e;if(c[a]){e=b.rest(arguments);for(var f=0,g=c[a].length;g>f;f++)d=c[a][f],d&&d.apply(this,e)}},on:function(a,b){return"function"==typeof b?(c[a]||(c[a]=[]),c[a].push(b),!0):!1},once:function(a,b){if("function"==typeof b){var c=function(){this.remove(a,c),b&&b.apply(this,arguments)};return this.on(a,c)}return!1},remove:function(a,d){return c[a]?(c[a]=b.without(c[a],d),!0):!1},receiveMessage:function(b){b&&b.method&&a.emit(b.method,b.data)}}}}),define("platform-embed/lib/open_graph",["require","underscore","platform-embed/lib/emitter","core/lib/log","backbone","core/lib/yammer_api"],function(a){var b=a("underscore"),c=a("platform-embed/lib/emitter"),d=a("core/lib/log"),e=a("backbone"),f=a("core/lib/yammer_api");return new function(){b.extend(this,new c);var a={};this.getOgProperties=function(a){var c={url:"",title:"",type:"page",image:"",description:"",site_name:"",fetch:!0,ignore_canonical_url:!0};return c=b.extend(c,a)},this.mergeOgoPropertiesToOgoData=function(a,c){return b.extend(a,c),a},this.getOgoData=function(b,c){var g=this,h=this.getOgProperties(b.objectProperties),i=h.url,j=a[i],k={url:i,properties:h,private:b.private||!1,users:b.users||[]},l=function(d){g.mergeOgoPropertiesToOgoData(d,b.objectProperties);var e={props:h,data:d};a[i]=e,g.emit("data",e),c(e)},m=function(a){d.log("Embed error",a),e.trigger("error",a)};j?c(j):f.getOpenGraphObject(k).then(void 0,function(a){return 404==a.status?f.fetchOpenGraphObject(k):void 0}).then(l,m)}}}),define("platform-embed/lib/platform_session",["require","jquery","core/lib/session","core/lib/yammer_config","core/lib/yammer_request"],function(a){function b(){}function c(){return!K||"connected"!=K.status}function d(a){a?(K=a,K.authResponse=!0,K.status="connected"):K={status:"notConnected",access_token:"",perms:""}}function e(a){var b=a.originalEvent.origin,c=a.data.expectedOrigin;return b===c}function f(a){try{return z.parseJSON(a)}catch(a){return}}function g(a,b){C.getAuthenticator({auth:"oauth2"}).setAuthToken(a),null===a?K=!1:d({access_token:{token:a}}),"function"==typeof b&&D.request({url:B.config().apiBaseURI+"/api/v1/"+F,data:B.config().appId?{client_id:B.config().appId}:{},success:h,error:i,complete:function(){b(K)}})}function h(a){a.token?d({access_token:a}):i(a)}function i(){g(null),d(null)}function j(a){K?a(K):D.request({url:B.config().baseURI+"/"+G,type:"POST",success:k,error:l,complete:function(){a(K)}})}function k(a){a.web_preferences.network_settings.allow_attachments=!1,A.setCurrentUser(a),a.web_oauth_access_token&&(a.authResponse=!0,g(a.web_oauth_access_token))}function l(){d(null)}function m(a,b){"function"==typeof a&&(b=a,a=void 0),a=a||{},z(window).on("message",{callback:b,expectedOrigin:B.config().baseURI},o);var c=B.config().baseURI+"/"+n(a)+(a.loginType&&"session"==a.loginType?H:I)+"?display=popup",d=B.config().appId;d&&(c+="&client_id="+d),p(c)}function n(a){var b=a&&a.network;return b&&!/^\s*\d+\s*$/.test(b)?b+"/":""}function o(a){var c,h,i;e(a)&&(c=f(a.originalEvent.data)||{},h=c.data||{},i=a.data.callback||b,c&&"login"==c.method&&(q(),g(h.access_token?h.access_token.token:null),d(h.access_token?h:null),z(window).off("message",o),!h.access_token&&h.reason&&window.console&&"function"==typeof console.log&&console.log("[yammer] Login failed: "+h.reason),i(K)))}function p(a){var b=["width=800","height=480","resizable=yes","status=yes","location=yes","toolbar=no"].join(",");q(),L=window.open("about:blank","",b),w(function(){L&&(L.focus(),L.location.href=a)})}function q(){L&&L.close()}function r(a){B.config().csrf_token?D.request({url:B.config().baseURI+"/"+E,type:"POST",data:{authenticity_token:B.config().csrf_token,_method:"delete"},success:t,error:u,complete:function(){a(c())}}):w(function(b){z(window).on("message",{callback:a,expectedOrigin:B.config().baseURI},s),b.postMessage('{ "method": "yam.logOut" }',B.config().baseURI)})}function s(a){var d,g;e(a)&&(d=f(a.originalEvent.data)||{},g=a.data.callback||b,"yam.logOut"==d.method&&(t(d),g(c())),z(window).off("message",s))}function t(a){"success"==a.data?(g(null),d(null)):u()}function u(){}function v(a){var b=z.extend({},a);return K&&(b.headers=b.headers||{},b.headers.authorization="Bearer "+K.access_token.token),/^https?:\/\//.test(b.url)||0===b.url.indexOf("/")||(b.url=B.config().apiBaseURI+"/api/v1/"+b.url),z.ajax(b)}function w(a){if(x)return a(x);var b=B.config().baseURI+"/"+J+"?ts="+Date.now();B.config().appId&&(b+="&client_id="+B.config().appId),y.data("initialized")||(y.data("initialized",!0).attr("src",b),z(document).ready(function(){z("body").append(y)})),y.load(function(){return a(x=window.frames["yam-xdr-proxy"])})}var x,y,z=a("jquery"),A=a("core/lib/session"),B=a("core/lib/yammer_config"),C=a("core/lib/yammer_request"),D={},E="logout",F="oauth2/token.json",G="account_activity/validate_session",H="dialog/weblogin",I="dialog/oauth",J="platform_embed/js_sdk_login_proxy",K=!1,L=!1;return y=z("<iframe></iframe>").attr({id:"yam-xdr-proxy",name:"yam-xdr-proxy"}).css("display","none"),D.setAuthToken=g,D.getSessionStatus=j,D.login=m,D.logout=r,D.request=v,D}),define("platform-embed/lib/connect/index",["require","core/lib/namespace","core/lib/session","core/lib/yammer_config","core/lib/yammer_request","workfeed/lib/app/bundles/banners_bundle"],function(a){"use strict";var b=a("core/lib/namespace"),c=a("core/lib/session"),d=a("core/lib/yammer_config"),e=a("core/lib/yammer_request"),f=a("workfeed/lib/app/bundles/banners_bundle");b.ns("yam.connect"),yam.connect.initPlatformApp=function(a,b){d.config({authMethod:"oauth2"});var g=e.getAuthenticator({auth:"oauth2"});b&&c.setCurrentNetwork(b),a&&g&&"function"==typeof g.setAuthToken&&g.setAuthToken(a.web_oauth_access_token),a&&(a.web_preferences&&(a.web_preferences.network_settings.allow_attachments=!1),c.setCurrentUser(a),f.run(a))}}),define("stache!platform-embed/lib/ui/embed/action_button_performed",["mustache"],function(a){var b='<span class="yj-action-button-mouseout">\n  <span class="yj-btn-text">{{actionDoneText}}</span>\n</span>\n<span class="yj-action-button-mouseover">\n  <span class="yj-btn-text">{{undoActionText}}</span>\n</span>\n';
return a.parse(b),function(c){return a.render(b,c)}}),define("stache!platform-embed/lib/ui/embed/action_button_not_performed",["mustache"],function(a){var b='<span class="yj-btn-text">{{doActionText}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("platform-embed/lib/ui/embed/action_button",["require","core/lib/backbone_base_view","core/lib/namespace","html!./action_button_performed","html!./action_button_not_performed"],function(a){var b=a("core/lib/backbone_base_view"),c=a("core/lib/namespace");return c.ns("yam.ui.embed"),yam.ui.embed.ActionButton=b.extend({events:{mouseover:"_onMouseOver",mouseout:"_onMouseOut"},tagName:"a",className:"yj-btn yj-tristate-button yam-ui-embed-action-button",attributes:{href:"javascript://"},templates:{performed:a("html!./action_button_performed"),notPerformed:a("html!./action_button_not_performed")},initialize:function(a){var b=this.performed?1:0;this.buttonText=a.buttonText,this.model={buttonText:this.buttonText[b]}},_displayState:function(a){var b,c,d,e=a||{},f=this.$el;f.removeClass("yj-click-transition"),this.performed?(b="add",c=this.templates.performed,d={actionDoneText:this.buttonText[1],undoActionText:this.buttonText[2]},e.transition&&f.addClass("yj-click-transition")):(b="remove",c=this.templates.notPerformed,d={doActionText:this.buttonText[0]}),f[b+"Class"]("yj-action-button"),f.html(c(d))},_onMouseOut:function(){var a=this;this.$el.removeClass("yj-mouseover"),setTimeout(function(){a.$el.removeClass("yj-click-transition")},500)},_onMouseOver:function(){this.$el.addClass("yj-mouseover")},setState:function(a){this.performed=a.performed,this._displayState({transition:!!a.transition})},hide:function(){this.$el[0].style.visibility="hidden"},show:function(){this.$el[0].style.visibility="visible"}})}),function(a){if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var b=require("jquery");module.exports=a(b)}else if("function"==typeof define&&define.amd)define("jquery-deparam",["jquery"],function(b){return a(b)});else{var c;try{c=(0,eval)("this")}catch(a){c=window}c.deparam=a(jQuery)}}(function(a){var b=function(b,c){var d={},e={true:!0,false:!1,null:null};return a.each(b.replace(/\+/g," ").split("&"),function(b,f){var g,h=f.split("="),i=decodeURIComponent(h[0]),j=d,k=0,l=i.split("]["),m=l.length-1;if(/\[/.test(l[0])&&/\]$/.test(l[m])?(l[m]=l[m].replace(/\]$/,""),l=l.shift().split("[").concat(l),m=l.length-1):m=0,2===h.length)if(g=decodeURIComponent(h[1]),c&&(g=g&&!isNaN(g)&&+g+""===g?+g:"undefined"===g?void 0:void 0!==e[g]?e[g]:g),m)for(;m>=k;k++)i=""===l[k]?j.length:l[k],j=j[i]=m>k?j[i]||(l[k+1]&&isNaN(l[k+1])?{}:[]):g;else a.isArray(d[i])?d[i].push(g):{}.hasOwnProperty.call(d,i)?d[i]=[d[i],g]:d[i]=g;else i&&(d[i]=c?void 0:"")}),d};return a.fn.deparam=a.deparam=b,b}),define("platform-embed/lib/connect/embed_action",["require","jquery","underscore","core/lib/backbone_base_class","core/lib/log","core/lib/namespace","platform-embed/lib/open_graph","platform-embed/lib/platform_session","backbone","core/lib/session","core/lib/uri_helper","core/lib/yammer_api","core/lib/tr","platform-embed/lib/connect/index","platform-embed/lib/ui/embed/action_button","jquery-deparam"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_class"),e=a("core/lib/log"),f=a("core/lib/namespace"),g=a("platform-embed/lib/open_graph"),h=a("platform-embed/lib/platform_session"),i=a("backbone"),j=a("core/lib/session"),k=a("core/lib/uri_helper"),l=a("core/lib/yammer_api"),m=a("core/lib/tr");a("platform-embed/lib/connect/index"),a("platform-embed/lib/ui/embed/action_button"),a("jquery-deparam"),f.ns("yam.connect"),yam.connect.reload=function(){location.reload()};var n={like:{buttonText:[m.t("like"),m.t("liked"),m.t("unlike_stop_liking_this_message")],checkStatus:function(a){var b=this;l.getLikesForOpenGraphObject({id:this._ogoData.id}).then(function(c){b._actionPerformed=!0,b._actionId=c.id,a()},function(c){404==c.status?a():401==c.status?yam.connect.reload():b.trigger("/embed/like/error",c)})},performAction:function(a){var b=this,c=j.getCurrentUser();l.createOpenGraphActivity({activity:{action:"like",actor:{name:c.full_name,email:c.contact.email_addresses[0].address},object:this._ogoProperties}}).then(function(){b._actionPerformed=!0,n.like.checkStatus.call(b,a)},function(a){401==a.status?yam.connect.reload():b.trigger("/embed/like/error",a)})},undoAction:function(a){var b=this;l.removeLikeForOpenGraphObject({id:this._actionId}).then(function(){b._actionPerformed=!1,b._actionId=null,a()},function(a){401==a.status?yam.connect.reload():b.trigger("/embed/like/error",a)})}},follow:{buttonText:[m.t("signup_follow_label"),m.t("signup_followed_label"),m.t("signup_unfollow_label")],checkStatus:function(a){var b=this;l.getSubscriptionToOpenGraphObject({id:this._ogoData.id}).then(function(c){var d=c.url.split("/").pop();b._actionPerformed=!0,b._actionId=d,a()},function(c){404==c.status?a():401==c.status?yam.connect.reload():b.trigger("/embed/follow/error",c)})},performAction:function(a){var b=this,c=j.getCurrentUser();l.createOpenGraphActivity({activity:{action:"follow",actor:{name:c.full_name,email:c.contact.email_addresses[0].address},object:this._ogoProperties}}).then(function(){b._actionPerformed=!0,n.follow.checkStatus.call(b,a)},function(a){401==a.status?yam.connect.reload():b.trigger("/embed/follow/error",a)})},undoAction:function(a){var b=this;l.unsubscribeFromTarget({id:this._actionId}).then(function(){b._actionPerformed=!1,a()},function(a){b.button.setState({performed:!0}),401==a.status?yam.connect.reload():b.trigger("/embed/follow/error",a)})}}},o=d.extend({_displayOpenGraphActionButton:function(a,b){var c=this,d=function(){c.button.setState({performed:c._actionPerformed}),c.button.show(),c.trigger("/embed/button/resize"),"function"==typeof b&&b()},e=n[this._actionType].checkStatus;g.getOgoData(a,function(a){c._ogoProperties=a.props,c._ogoData=a.data,e.call(c,d)})},_createButton:function(){this.button=new yam.ui.embed.ActionButton({buttonText:n[this._actionType].buttonText},this),this.button.hide(),this.options.buttonId=this.button.id,this._target.append(this.button.$el),this.button.$el.on("click",this.handleButtonClick.bind(this))},_setupEventPropagationToParent:function(){c.each(["/button/loggedIn","/button/loggedOut","/embed/like/error","/embed/follow/error","error"],function(a){i.on(a,function(b){this._proxyEvent(a,b)}.bind(this))}.bind(this))},_postMessageToParent:function(a){this._parent&&a&&(a.uniqueToken=this._uniqueToken,this._parent.postMessage(JSON.stringify({data:a}),"*"))},_proxyEvent:function(a,b){"error"===a&&b&&(b=b.responseText||b.statusText),this._postMessageToParent({method:"yam.trigger",eventId:a,msg:b||""})},initialize:function(a){this._actionPerformed=!1,this._ogoProperties=null,this._ogoData=null,this._actionId=null,this._actionLocked=!1,this._uniqueToken=a.uniqueToken,this._parent=window.parent,this._actionType=a.action||"like",this._selector="string"==typeof a?a:a.container,this._target=b(this._selector||document.body),this._setupEventPropagationToParent(),yam.connect.initPlatformApp(a.user,a.network),a.view={$element:this._target},this._createButton(),a.user?this.handleLoggedIn():this.handleLoggedOut(),i.on("loggedIn",this.handleLoggedIn,this),i.on("loggedOut",this.handleLoggedOut,this),this.on("/embed/button/resize",function(){var a=b(this._selector);this._postMessageToParent({method:"yam.resize",width:Math.ceil(a.width()),height:Math.ceil(a.height())})}.bind(this))},handleLoggedIn:function(a){this._loggedIn!==!0&&(this._loggedIn=!0,i.trigger("/button/loggedIn"),this._displayOpenGraphActionButton(this.options,a))},handleLoggedOut:function(){this._loggedIn!==!1&&(this._loggedIn=!1,i.trigger("/button/loggedOut"),this._actionPerformed=!1,this.button&&(this.button.setState({performed:!1}),this.button.show()))},handleButtonClick:function(){var a,b=this,c="";if(!this._actionLocked){this._actionLocked=!0,setTimeout(function(){b._actionLocked=!1},3e3),a=function(){var a,d;c||(c=b._actionPerformed?"no-op":"do"),"do"==c?a="performAction":"undo"==c&&(a="undoAction"),a?(d=n[b._actionType][a],d.call(b,function(){b._actionLocked=!1}),b.button.setState({performed:"do"==c,transition:!0}),b.trigger("/embed/button/resize")):b._actionLocked=!1};var d=function(){c=b._actionPerformed?"undo":"do",a()};this._loggedIn===!0?d():h.getSessionStatus(function(c){c.authResponse?d():h.login({loginType:"session"},function(c){c.access_token&&b.handleLoggedIn(a)},b.options)})}}});return yam.connect.actionButtonInPage=function(a){var d=k.parse(document.location.href).query,f=b.deparam(d,!0);try{c.extend(f,a)}catch(a){e.log("Could not parse passed opts for Embed button")}return f.container="#embedded-button",new o(f)}}),define("workfeed/lib/admin/color_preview",["require","jquery"],function(a){var b=a("jquery"),c="#uni-header-wrapper",d="#uni-header";return{setElementColors:function(a){var e,f=a.headerBackgroundColor,g=a.headerTextColor;this.setSelectors(),(f||g)&&(e=this.isDark(f),f&&b(c).css({"background-color":f}),b(d).removeClass("light-bg dark-bg").addClass(e?"dark-bg":"light-bg"))},handleColorPicker:function(a){var e=b(a.target),f=e.val();switch(e=e&&e[0],this.setSelectors(),e.id){case"header-background-color":b(c).css({"background-color":f}),b(d).removeClass("light-bg dark-bg").addClass(this.isDark(f)?"dark-bg":"light-bg");break;case"header-text-color":}},setColorScheme:function(a){var c=b(a.target);c=c.hasClass("prim-color")?c:c.find(".prim-color");var d=this.rgb2hex(c.css("background-color")),e=this.rgb2hex(c.css("color"));b("#header-background-color").css({"background-color":d,color:e}).val(d),b("#header-text-color").css({"background-color":"#FFFFFF",color:"#000000"}).val(e),this.setElementColors({headerBackgroundColor:d,headerTextColor:e})},isDark:function(a){var b=parseInt(a.substring(1,3),16)+parseInt(a.substring(3,5),16)+parseInt(a.substring(5,7),16);return 382>b},rgb2hex:function(a){if("#"===a.charAt(0))return a;a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);var b=function(a){var b=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];return isNaN(a)?"00":b[(a-a%16)/16]+b[a%16]};return"#"+b(a[1])+b(a[2])+b(a[3])},setSelectors:function(){c="#masthead-container",d="#masthead-container"},init:function(){b(".color-schemes").delegate(".color-theme","click",this.setColorScheme.bind(this)),b(".color-input").change(this.handleColorPicker.bind(this))}}}),define("workfeed/lib/app/app_directory_carousel",["require","jquery","underscore","core/lib/ctor"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/ctor");return d(null,{init:function(){var a=b(".app-carousel"),d={width:"474px",height:"189px",marginTop:"41px",marginLeft:"-235px",marginRight:"235px"},e={width:"686px",height:"275px",marginTop:"0",marginLeft:"-339px",marginRight:"127px"},f=function(a,d){var e=this,f=c.pluck(a,"src").slice(0,3),g=f.length;b.each(f,function(){var a=b("<img/>",{load:function(){0===--g&&d.apply(e)}});a.attr("src",this)})},g=function(a,c,e){var f=b(a[1]),g=e?500:200;f.find("div").fadeOut(g,function(){f.animate(d,500,"swing",function(){f.removeClass("active"),"function"==typeof c&&c.apply(this,a.toArray())})})},h=function(a,c,d){var f=b(a[1]),g=d?500:200;f.addClass("active").animate(e,500,"swing",function(){f.find("div").fadeIn(g),"function"==typeof c&&c.apply(this,a.toArray())})},i=function(){a.find(".carousel-preloader").remove();var b=a.find("ul li:last").detach();a.find("ul").prepend(b),a.jCarouselLiteMod({auto:12e3,circular:!0,beforeStart:g,afterEnd:h,btnNext:".app-store .gallery .carousel-navigation-next",btnPrev:".app-store .gallery .carousel-navigation-previous",start:0,speed:500}),a.find("ul li:eq(4)").addClass("active").css(e),a.find("ul li:not(:eq(4)) div").hide(),a.find(".carousel-navigation").hide(),a.mouseenter(function(){a.jCarouselLiteMod("disable"),a.find(".carousel-navigation").fadeIn()}).mouseleave(function(){a.jCarouselLiteMod("enable"),a.find(".carousel-navigation").fadeOut()}).click(function(b){return"A"!==b.srcElement.nodeName&&a.jCarouselLiteMod("isRunning")?(b.preventDefault(),b.stopPropagation(),!1):void 0})};f(b.makeArray(a.find(".carousel img")),i)}})}),define("workfeed/lib/app/face_pile_wrapper",["require","core/lib/jam/component2","common-ui/lib/ui/shared/face_pile","core/lib/ctor","core/lib/tr"],function(a){var b=a("core/lib/jam/component2"),c=a("common-ui/lib/ui/shared/face_pile"),d=a("core/lib/ctor"),e=a("core/lib/tr");return d(null,b,{template:'<div>                <div class="app-directory-lightbox-facepile"></div>                <span>{{text}}</span>              </div>',_getText:function(a,b){var c=b-a;return c>0?e.t("and_count_others_are_using_this_app",{count:c}):e.t("are_using_this_app",{count:a})},onTemplating:function(a){if(this.users&&this.totalCount){var b=new c({collection:this.users});b.attachPoint=".app-directory-lightbox-facepile",this.add("facePile",b),a.model.text=this._getText(this.users.length,this.totalCount)}else this.template="";return a}})}),define("workfeed/lib/app/screenshot_viewer",["require","jquery","underscore","core/lib/ctor","core/lib/jam/component2","core/lib/tr"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/ctor"),e=a("core/lib/jam/component2"),f=a("core/lib/tr");return d(null,e,{template:'<div class="screenshot-main">        <img class="screenshot-main-preview" src="{{main.url}}" alt="'+f.t("screenshot")+'">      </div>      <ul class="screenshot-preview-list">        {{#screenshots}}          <li class="screenshot-preview-list-item {{cssClass}}">            <img src="{{url}}" alt="'+f.t("screenshot")+'">          </li>        {{/screenshots}}      </ul>',onLoad:function(){c.bindAll(this,"onItemClick")},onTemplating:function(a){var b=c.filter(this.screenshots,function(a){return a.is_placeholder===!1});return b.length>0?a.model={main:b[0],screenshots:b}:a.template="",a},onRendered:function(){this.items=this.$element.find(".screenshot-preview-list-item"),this.items.eq(0).addClass("active-screenshot-preview-list-item"),this.items.on("click",this.onItemClick)},onItemClick:function(a){var c=b(a.currentTarget);this.items.removeClass("active-screenshot-preview-list-item"),c.addClass("active-screenshot-preview-list-item"),this.$element.find("img.screenshot-main-preview").attr("src",c.find("img").attr("src"))}})}),define("workfeed/lib/app/app_directory_sso",["require","underscore","core/lib/date_helper","core/lib/jam/component2","core/lib/ctor","core/lib/session","core/lib/tr"],function(a){var b=a("underscore"),c=a("core/lib/date_helper"),d=a("core/lib/jam/component2"),e=a("core/lib/ctor"),f=a("core/lib/session"),g=a("core/lib/tr");return e(null,d,{template:"<h3>"+g.t("important_youll_need_this_to_log_in")+":</h3>      <p>"+g.t("because_your_company_has_enabled_single_sign_on_for_your")+":</p>      <ul>        <li><span>"+g.t("email_address")+': </span> <span class="pertinent" data-qaid="mobile-app-login-email-address">{{emailAddress}}</span></li>        <li><span>'+g.t("temporary_password")+': </span> <span class="pertinent" data-qaid="mobile-app-login-password">{{ephemeralPass}}</span></li>      </ul>      <p class="password-expiry"><em>'+g.t("this_password_will_expire_at_expirytime",{expiryTime:"{{passwordExpiryTime}}"})+"</em></p>",_getUserEmailAddress:function(){return f.getCurrentUser()?b.find(f.getCurrentUser().contact.email_addresses,function(a){return"primary"===a.type}).address:!1},onTemplating:function(a){var d=this._getUserEmailAddress();return d&&this.show_sso?b.extend(a.model,{emailAddress:d,ephemeralPass:this.show_sso.ephemeral_pass,passwordExpiryTime:c.formatTime(new Date(this.show_sso.ephemeral_pass_expires_at))}):a.template="",a}})}),define("stache!workfeed/lib/app/action_button_standard",["mustache"],function(a){var b="{{text}}\n";return a.parse(b),function(c){return a.render(b,c)}}),define("stache!workfeed/lib/app/action_button_installed",["mustache"],function(a){var b='{{#iconclass}}\n  <span class="yj-inline-icon yj-align-icon {{iconclass}}"></span>\n{{/iconclass}}\n<span class="yj-label">{{text}}</span>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/action_button",["require","underscore","jquery","core/lib/tr","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","workfeed/lib/app/app_directory_oauth_dialog","html!./action_button_standard","html!./action_button_installed"],function(a){var b=a("underscore"),c=a("jquery"),d=a("core/lib/tr"),e=a("core/lib/backbone_base_view"),f=a("core/lib/backbone_with_auto_render"),g=a("workfeed/lib/app/app_directory_oauth_dialog"),h=a("html!./action_button_standard"),i=a("html!./action_button_installed"),j={OAUTH_NOT_INSTALLED:0,NON_OAUTH_OR_DISABLED:1,INSTALLED:2,MANUALLY_INSTALLED:3},k={0:d.t("try_it_2"),1:d.t("learn_more"),2:d.t("open"),3:d.t("reinstall")},l="yammer_app_";return e.extend({mixins:[f],tagName:"a",className:"yj-btn yj-btn-alt try-it",events:{click:"handleClick"},defaults:{enabled:!0},_setState:function(){this.enabled?this.installed&&!this.manuallyInstalled?this.state=j.INSTALLED:this.installed&&this.manuallyInstalled?this.state=j.MANUALLY_INSTALLED:this.usesOauth?this.state=j.OAUTH_NOT_INSTALLED:this.state=j.NON_OAUTH_OR_DISABLED:this.state=j.NON_OAUTH_OR_DISABLED},_setTemplate:function(){this.template=this.state===j.INSTALLED||this.state===j.MANUALLY_INSTALLED?i:h},initialize:function(a){b.extend(this,a),this._setState(),this._setTemplate()},getTemplateData:function(){return{text:this._getButtonText(),iconclass:this.state===j.INSTALLED?"":"download-grey-icon"}},render:function(){return this.$el.attr({href:this._getButtonAction(),target:this._getButtonTarget()}),this},handleClick:function(a){if(this.state==j.OAUTH_NOT_INSTALLED){a.preventDefault();var b=c(this).attr("href"),d=c(this).data("app-id");new g(b,d)}},_getButtonAction:function(){return this.state===j.MANUALLY_INSTALLED||this.state===j.INSTALLED?this.baseAppURL:this.url},_getButtonTarget:function(){return this.state===j.NON_OAUTH_OR_DISABLED&&this.appId?l+this.appId.toString():this.state===j.MANUALLY_INSTALLED||this.state===j.INSTALLED?"_blank":""},_getButtonText:function(){return k[this.state]}})}),define("workfeed/lib/app/app_directory_lightbox",["require","underscore","mustache","core/lib/jam/component2","core/lib/ctor","workfeed/lib/app/face_pile_wrapper","core/lib/log","workfeed/lib/app/screenshot_viewer","core/lib/yammer_uri","core/lib/tr","core/lib/yammer_request","workfeed/lib/app/app_directory_sso","workfeed/lib/app/action_button"],function(a){var b=a("underscore"),c=a("mustache"),d=a("core/lib/jam/component2"),e=a("core/lib/ctor"),f=a("workfeed/lib/app/face_pile_wrapper"),g=a("core/lib/log"),h=a("workfeed/lib/app/screenshot_viewer"),i=a("core/lib/yammer_uri"),j=a("core/lib/tr"),k=a("core/lib/yammer_request"),l=a("workfeed/lib/app/app_directory_sso"),m=a("workfeed/lib/app/action_button");return e(null,d,{template:'<div class="preload-spinner"></div>',_actionButtonTargetSelector:".action-button-target",_templates:{success:'<div class="app-directory-lightbox-banner">          <img class="app-directory-lightbox-icon" src="{{large_icon_url}}" title="{{name}}" alt="">          <div class="app-directory-lightbox-title" role="heading" aria-level="1">            <h4 role="presentation">{{name}}</h4><span>'+j.t("from")+' {{organization}}</span>          </div>          <div class="app-directory-lightbox-colleagues"></div>          <span class="action-button-target"></span>        </div>        <div class="app-directory-lightbox-content">          <div class="app-directory-lightbox-description">{{long_description}}</div>          <div class="app-directory-lightbox-sso-description"></div>          <div class="app-directory-lightbox-screenshot-viewer">          </div>        </div>',error:'<div class="app-directory-lightbox-error">          <div class="vertical-align-wrapper">            <a href="javascript://">              <h4>Something went wrong</h4>              <p>Please click here to try again</p>            </a>          </div>        </div>'},onLoad:function(){b.bindAll(this,"_reRenderSuccess","_reRenderError")},onRendered:function(){this._requestData()},onDestroy:function(){this.$requestHandle&&this.$requestHandle.abort(),this.screenshotViewer&&this.screenshotViewer.destroy(),this.actionButton&&this.actionButton.destroy(),this.facePileWrapper&&this.facePileWrapper.destroy(),this.userText&&this.userText.destroy(),this.ssoAlert&&this.ssoAlert.destroy()},_reRenderSuccess:function(a){var b=c.render(this._templates.success,a.app);this.$element.html(b),this.facePileWrapper=new f({users:a.facepile.mugshots,totalCount:a.facepile.overall_count}),this.facePileWrapper.attachTo(this.$el.find(".app-directory-lightbox-colleagues")),this.screenshotViewer=new h({screenshots:a.app.screenshots}),this.$element.find(".app-directory-lightbox-screenshot-viewer").append(this.screenshotViewer.render()),this.actionButton=new m({appId:a.app.id,enabled:a.app.allowed_on_network,usesOauth:a.app.uses_oauth,installed:a.installed,manuallyInstalled:a.app.manually_installed,url:a.app.action_url,baseAppURL:a.app.base_app_url}),this.$el.find(this._actionButtonTargetSelector).html(this.actionButton.render()),"object"==typeof a.app.show_sso&&(this.$element.find(".app-directory-lightbox-content").addClass("app-directory-lightbox-sso"),this.ssoAlert=new l(a.app),this.ssoAlert.attachPoint=".app-directory-lightbox-sso-description",this.add("sso",this.ssoAlert))},_reRenderError:function(){var a=this,b=c.render(this._templates.error,this.clientApplication);this.$element.html(b),this.$element.find("a").click(function(){a._requestData()})},_requestData:function(){"number"==typeof this.appId?this.requestHandle=k.send({url:i.app()+"/apps/"+this.appId+".json",method:"GET",error:this._reRenderError,success:this._reRenderSuccess.bind(this)}):g.log("Wasn't provided with a valid app id")}})}),define("workfeed/lib/app/app_directory_tabs",["require","jquery","core/lib/ctor","core/lib/tr","common-ui/lib/ui/shared/tabs"],function(a){var b=a("jquery"),c=a("core/lib/ctor"),d=a("core/lib/tr"),e=a("common-ui/lib/ui/shared/tabs");return c(null,{init:function(){function a(a){b(".apps-tab-item:not(#"+a+")").hide(),b("#"+a).show()}var c={target:".yj-action-bar-tabs",data:{tabs:[{label:"<span> "+d.t("all")+"</span>",tabId:"apps-tab-all-apps",selected:!0},{label:"<span>"+d.t("yammer")+"</span>",tabId:"apps-tab-first-party-apps",selected:!1}]},handleTabSwitch:a},f=new e(c);b(".yj-action-bar-tabs").html(f.render().$el),b(".apps-tab-item").hide(),b(".apps-tab-item:first").show()}})}),define("workfeed/lib/app/app_request_form",["require","jquery","core/lib/ctor"],function(a){var b=a("jquery"),c=a("core/lib/ctor");return c(null,{init:function(a){this.options=a},attach:function(){this.options.$changeTarget&&this.options.$changeTarget.change(this._onFieldChange.bind(this))},_onFieldChange:function(){this.options.elementsToToggleSelector&&this.options.disabledClass&&(b(this.options.elementsToToggleSelector).toggleClass(this.options.disabledClass),b(this.options.elementsToToggleSelector).find("textarea").each(function(){this.disabled=!this.disabled}))}})}),define("workfeed/lib/app/views/threads/file_thread_view",["require","underscore","jquery","core/lib/backbone_base_class","models/feed_backbone","models/file_backbone","models/group","models/recipient","feeds/lib/ui/threads/future/thread_list","feeds/lib/ui/publisher/global/thread_starter_publisher","models/lib/helper/feed_factory","models/lib/orm-models","core/lib/session","models/helpers/user"],function(a){"use strict";var b=a("underscore"),c=a("jquery"),d=a("core/lib/backbone_base_class"),e=a("models/feed_backbone"),f=a("models/file_backbone"),g=a("models/group"),h=a("models/recipient"),i=a("feeds/lib/ui/threads/future/thread_list"),j=a("feeds/lib/ui/publisher/global/thread_starter_publisher"),k=a("models/lib/helper/feed_factory"),l=a("models/lib/orm-models"),m=a("core/lib/session"),n=a("models/helpers/user");return d.extend({initialize:function(){var a=this.options;this.$element=c(a.target);var b=a.file;this._file=b,l.UploadedFile().save(b);var d=a.group||g.ALL_COMPANY();d=h.fromOriginalModel(d),d.getType()===h.TYPE.PRIVATE_GROUP&&d.set("fixed",!0),this._group=d,this._feed=k.findOrCreate("file",b.id),this.afterRender()},getFeedModel:b.memoize(function(){return e.fromOriginalModel(this._feed)}),_isFileForeign:function(){var a=m.getCurrentNetwork();return this._file.network_id!==a.id},getFile:function(){return new f.fromOriginalModel(this._file)},afterRender:function(){var a=this,b=m.getCurrentUser(),c=this._group.getId?{id:this._group.getId()}:this._group;if(!this._isFileForeign()||n.isMemberOf(b,c)){var d=new j({logSource:this.getFeedModel().getLogSource(),showAnnouncements:n.canAnnounce(m.getCurrentUser(),this._group)});d.model.set("feed",a.getFeedModel()),this._isFileForeign()&&this._group.set("fixed",!0),d.model.get("recipients").add(this._group),d.on("open",function(){d.model.get("files").add(a.getFile()),d.model.hasNonFixedRecipients()||d.model.get("recipients").add(a._group)}),this.$element.append(d.render().$el),this._publisher=d}this._loadThreadList()},_loadThreadList:function(){this._threadList=new i({feed:this._feed,hideThreadStarter:!0}),this.$element.append(this._threadList.render().$el)},remove:function(){this._publisher&&this._publisher.remove(),this._threadList.remove()}})}),define("workfeed/lib/app/controllers/file_controller",["require","jquery","workfeed/lib/app/views/threads/file_thread_view","resig-class"],function(a){var b=a("jquery"),c=a("workfeed/lib/app/views/threads/file_thread_view"),d=a("resig-class");return d.extend(new function(){this.init=function(){this._file=void 0,this._threadView=void 0},this.setFile=function(a){this._file=a},this.setGroup=function(a){this._group=a},this.enterShowMode=function(){var a=b('<div id="feed-container"></div>');b("#column-two #main-column .yj-selector-left-col").append(a).addClass("yj-scrollbar-fix"),this._threadView=new c({file:this._file,group:this._group,target:"#feed-container"})}})}),define("stache!workfeed/lib/app/experiment_editor",["mustache"],function(a){var b="<div class='yj-experiment-editor--settings-section'>\n <div>\n   <input type='radio' name='filter' value='search' checked class='yj-experiment-editor--filter'/>\n   <input type='text' class='yj-experiment-editor--search' placeholder='Search all experiments...'/>\n </div>\n <div>\n   <label>\n     <input type='radio' name='filter' value='noncontrol' class='yj-experiment-editor--filter'/> Show only \n     <span class='yj-experiment-editor--noncontrol'>non-control treatments</span>\n   </label>\n </div>\n <div>\n   <label>\n     <input type='radio' name='filter' value='user' class='yj-experiment-editor--filter'/> Show only \n     <span class='yj-experiment-editor--user-override'>your user's overrides</span>\n   </label>\n </div>\n <div>\n   <label>\n     <input type='radio' name='filter' value='network' class='yj-experiment-editor--filter'/> Show only \n     <span class='yj-experiment-editor--network-override'>your network's overrides</span>\n   </label>\n </div>\n\n <select class='yj-experiment-editor--sort-select'>\n   <option value='updated'>Sort by last update</option>\n   <option value='key'>Sort by experiment name</option>\n   <option value='created'>Sort by creation date</option>\n </select>\n\n <div class='yj-experiment-editor--buttons'>\n   <button type='button' class='yj-experiment-editor--show-import-section yj-btn yj-btn-alt'>\n     Copy treatments between users\n   </button>\n   <button type='button' class='yj-experiment-editor--show-compare-section yj-btn yj-btn-alt'>\n     Compare users\n   </button>\n   <button type='button' class='yj-experiment-editor--save yj-btn'>Save changes</button>\n </div>\n</div>\n\n<div class='yj-experiment-editor--import-section' style='display:none'>\n <div>\n   Below are your treatments in JSON. Users without dev tools can see theirs at\n   <a href='https://www.yammer.com/api/v1/experiments/treatments' target='_blank'>\n     https://www.yammer.com/api/v1/experiments/treatments\n   </a>.\n </div>\n <input type='text' disabled class='yj-experiment-editor--json-export'/>\n <input type='text' class='yj-experiment-editor--json-import'\n    placeholder='Paste another user&apos;s JSON here to copy their treatments' />\n</div>\n\n<div class='yj-experiment-editor--compare-section' style='display:none'>\n  Paste another user's id here to see what treatments are different between you and him/her<br/>\n  <input type='text' class='yj-experiment-editor--compare-user-id' />\n  <button type='button' class='yj-experiment-editor--diff-treatments yj-btn'>Show</button>\n  <div class='yj-experiment-editor--treatment-differences'>\n  </div>\n</div>\n\n<table class='yj-experiment-editor--table'>\n <tr>\n   <th class='yj-experiment-editor--key-head-cell'>\n     Experiment name (mouseover for description)\n   </th>\n   <th class='yj-experiment-editor--value-head-cell'>\n     Your user's treatment\n   </th>\n   <th class='yj-experiment-editor--updated-head-cell'>\n     Last update\n   </th>\n <tr>\n</table>\n";return a.parse(b),function(c){return a.render(b,c)}}),define("stache!workfeed/lib/app/experiment_editor_row",["mustache"],function(a){var b="<tr class='yj-experiment-editor--row {{#userOverride}} yj-experiment-editor--user-override{{/userOverride}} {{#networkOverride}} yj-experiment-editor--network-override{{/networkOverride}}'>\n <td class='yj-experiment-editor--key-cell'>\n   <span class='yj-experiment-editor--key {{^enabled}} yj-experiment-editor--disabled{{/enabled}}'>{{key}}</span>\n </td>\n\n <td class='yj-experiment-editor--value-cell'>\n   <span class='yj-experiment-editor--treatment-current {{^treatment.control}} yj-experiment-editor--noncontrol{{/treatment.control}}'>\n     <span class='yj-experiment-editor--edit-icon yamicon yamicon-pencil'></span>\n     {{treatment.name}} (<!--\n     -->{{#enabled}}{{treatment.proportion}}{{/enabled}}<!--\n     -->{{^enabled}}<!--\n       -->{{#treatment.control}}100{{/treatment.control}}<!--\n       -->{{^treatment.control}}0{{/treatment.control}}<!--\n     -->{{/enabled}}<!--\n     -->%{{#treatment.control}} control{{/treatment.control}})\n   </span>\n\n   <span class='yj-experiment-editor--cancel yamicon yamicon-stop' style='display:none'></span>\n   <select class='yj-experiment-editor--treatment-select' style='display:none'>\n     <option value=''>(No user override)</option>\n     {{#treatment_groups}}\n       <option value='{{id}}'>\n         {{name}} (<!--\n         -->{{#enabled}}{{proportion}}{{/enabled}}<!--\n         -->{{^enabled}}<!--\n           -->{{#control}}100{{/control}}<!--\n           -->{{^control}}0{{/control}}<!--\n         -->{{/enabled}}<!--\n         -->%{{#control}} control{{/control}})\n       </option>\n     {{/treatment_groups}}\n   </select>\n </td>\n\n <td class='yj-experiment-editor--updated-cell'>{{updated_at}}</td>\n</tr>\n";return a.parse(b),function(c){return a.render(b,c)}}),define("css!workfeed/lib/app/experiment_editor",[],function(){}),define("workfeed/lib/app/experiment_editor",["require","jquery","underscore","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/date_helper","backbone","core/lib/session","core/lib/yammer_request","core/lib/yammer_uri","html!./experiment_editor","html!./experiment_editor_row","css!./experiment_editor"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/backbone_base_view"),e=a("core/lib/backbone_with_auto_render"),f=a("core/lib/date_helper"),g=a("backbone"),h=a("core/lib/session"),i=a("core/lib/yammer_request"),j=a("core/lib/yammer_uri"),k=a("html!./experiment_editor"),l=a("html!./experiment_editor_row");return a("css!./experiment_editor"),d.extend({mixins:[e],className:"yj-experiment-editor",template:k,rowTemplate:l,initialize:function(){var a=this;this._initialPayload={},i.send({url:"/"+h.getCurrentNetwork().permalink+"/developer_tools/experiments/all.json",
success:function(b){a._initialPayload.experiments=b,a.renderIfReady()}}),i.send({url:"/"+h.getCurrentNetwork().permalink+"/developer_tools/experiment_overrides.json",success:function(b){a._initialPayload.overrides=b,a.renderIfReady()}}),i.send({url:"/api/v1/experiments/treatments.json",success:function(b){a._initialPayload.treatments=b,a.renderIfReady()}})},render:function(){return this._isRenderCalled=!0,this.renderIfReady(),this},renderIfReady:function(){this.processInitialPayload()&&this._isRenderCalled&&(this.initializeRows(),this.renderTable(),this.$(".yj-experiment-editor--json-export").val(this._treatmentsJson),this.$(".yj-experiment-editor--show-import-section").on("click",this.showImportSection.bind(this)),this.$(".yj-experiment-editor--show-compare-section").on("click",this.showCompareSection.bind(this)),this.$(".yj-experiment-editor--save").on("click",this.saveChanges.bind(this)),this.$(".yj-experiment-editor--json-import").on("keyup change",this.importTreatments.bind(this)),this.$(".yj-experiment-editor--search").on("click keyup",this.filterBySearch.bind(this)),this.$(".yj-experiment-editor--filter").on("change",this.changeFilter.bind(this)),this.$(".yj-experiment-editor--sort-select").on("change",this.renderTable.bind(this)),this.$(".yj-experiment-editor--diff-treatments").on("click",c.bind(this.diffTreatments,this)),this.changeFilter())},renderTable:function(){var a,b,c=this._experiments,d=this._rows,e=this.$(".yj-experiment-editor--table"),f=[];this.$(".yj-experiment-editor--row").detach();for(a in c)f.push(c[a]);for(f.sort(this.sortFunctions[this.$(".yj-experiment-editor--sort-select").val()]),a=0,b=f.length;b>a;a++)e.append(d[f[a].key])},processInitialPayload:function(){if(this._experiments)return!0;var a=this._initialPayload.experiments,b=this._initialPayload.treatments,c=this._initialPayload.overrides;if(!a||!c||!b)return!1;var d,e,f,g,h={},i={},j={},k={},l={};for(d=0,e=a.length;e>d;d++)f=a[d],g=f.key,h[g]=f,i[f.id]=g,j[g]=this.getTreatmentGroupByName(f,b[g]);for(d=0,e=c.length;e>d;d++)f=c[d],(f.network_id?k:l)[i[f.experiment_id]]=f;return this._experiments=h,this._treatments=j,this._userOverrides=l,this._networkOverrides=k,this._treatmentsJson=JSON.stringify(b),delete this._initialPayload,!0},initializeRows:function(){if(!this._rows){var a,b,c=this._experiments,d={};for(a in c)b=c[a],d[b.key]=this.rowEl(b);this._rows=d}},rowEl:function(a){var c=this,d=a.key,e=this._userOverrides[d],h=b(this.rowTemplate(b.extend({},a,{treatment:this._treatments[d],updated_at:f.formatAgo(new Date(a.updated_at),void 0,!0),userOverride:!!e,networkOverride:!e&&!!this._networkOverrides[d]})));return this.resetTreatment(d,h),b(".yj-experiment-editor--treatment-current",h).on("click",function(){c.showTreatmentSelect(d)}),b(".yj-experiment-editor--cancel",h).on("click",function(){c.hideTreatmentSelect(d)}),g.trigger("/ui/tooltip/add",{target:b(".yj-experiment-editor--key",h),text:a.name}),h},filterBySearch:function(){this.$(".yj-experiment-editor--filter[value=search]").prop("checked",!0),this.changeFilter()},changeFilter:function(){var a,b,c,d=this._experiments,e=this._rows,f=this.$(".yj-experiment-editor--filter:checked").val(),g=this.filterFunctions[f].bind(this);"search"===f&&(c=this.$(".yj-experiment-editor--search").val(),this._searchRegex=c?new RegExp(c,"i"):!1);for(a in d)b=d[a],e[b.key][g(b)?"show":"hide"]()},showTreatmentSelect:function(a){var c=this._rows[a];b(".yj-experiment-editor--cancel",c).show(),b(".yj-experiment-editor--treatment-current",c).hide(),b(".yj-experiment-editor--treatment-select",c).show()},hideTreatmentSelect:function(a){var c=this._rows[a];b(".yj-experiment-editor--cancel",c).hide(),b(".yj-experiment-editor--treatment-select",c).hide(),b(".yj-experiment-editor--treatment-current",c).show(),this.resetTreatment(a,c)},resetTreatment:function(a,c){var d=this._userOverrides[a];b(".yj-experiment-editor--treatment-select",c).val(d?d.treatment_group_id:"")},getTreatmentGroupByName:function(a,b){var c,d,e,f=a.treatment_groups;for(c=0,d=f.length;d>c;c++)if(e=f[c],e.name===b)return e},saveChanges:function(){var a,c=this._experiments,d=this._rows,e={};for(a in c)e["force_treatments["+c[a].id+"]"]=b(".yj-experiment-editor--treatment-select",d[a]).val();i.send({type:"POST",url:"/"+h.getCurrentNetwork().permalink+"/developer_tools/experiments/force_treatments",data:e,complete:function(){location.reload(!0)}})},showImportSection:function(){this.$(".yj-experiment-editor--show-import-section").hide(),this.$(".yj-experiment-editor--import-section").show()},showCompareSection:function(){this.$(".yj-experiment-editor--show-compare-section").hide(),this.$(".yj-experiment-editor--compare-section").show()},diffTreatments:function(){var a=b(".yj-experiment-editor--compare-user-id").val(),d=b(".yj-experiment-editor--treatment-differences"),e={user_id:a};i.send({type:"GET",url:"/"+h.getCurrentNetwork().permalink+"/developer_tools/experiments/compare_treatments",data:e,dataType:"text",beforeSend:function(){d.children().remove(),d.append('<img src="'+j.cdn("assets/images/spinner/spinner-grey-on-white.gif")+'" width="16" height="16" />')},complete:function(){b(".yj-experiment-editor--treatment-differences img").remove()},success:function(a){var b=JSON.parse(a),e="";if(c.isEmpty(b))e+="<div> No treatment differences!";else{e+="<div><u> Experiment name --> [Your treatment, Other user's treatment] </u><br />";for(var f in b)e+=f+" --> ["+b[f]+"]<br />"}e+="</div>",d.append(e)},error:function(a){d.append('<span class="error">'+a.statusText+" Error: Try Again.</span>")}})},importTreatments:function(){var a,c,d,e,f=this._experiments,g=this._treatments,h=this._rows,i=this.$(".yj-experiment-editor--json-import");try{a=JSON.parse(i.val())}catch(a){return void i.removeClass("yj-experiment-editor--json-import-success")}for(c in f)d=a[c],g[c].name===d?this.hideTreatmentSelect(c):(e=d&&this.getTreatmentGroupByName(f[c],d),e&&(b(".yj-experiment-editor--treatment-select",h[c]).val(e.id),this.showTreatmentSelect(c)));this.$(".yj-experiment-editor--search").val(""),this.filterBySearch(),i.addClass("yj-experiment-editor--json-import-success")},filterFunctions:{noncontrol:function(a){return!this._treatments[a.key].control},user:function(a){return!!this._userOverrides[a.key]},network:function(a){return!!this._networkOverrides[a.key]},search:function(a){var b=this._searchRegex;return!b||!!a.key.match(b)||!!a.name.match(b)}},sortFunctions:{key:function(a,b){return a.key>b.key?1:-1},updated:function(a,b){return new Date(b.updated_at)-new Date(a.updated_at)},created:function(a,b){return new Date(b.created_at)-new Date(a.created_at)}}})}),define("workfeed/lib/app/form_helper",["require","jquery","underscore","core/lib/namespace","backbone","core/lib/tr"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/namespace"),e=a("backbone"),f=a("core/lib/tr");return d.ns("yam.workfeed"),yam.workfeed.FormHelper={_checkMissingFields:function(a,d,g){var h=!0;c.each(a.find(".required-field"),function(a){var c=b(a),d=c.val(),e=d&&d!=c.data("placeholder-val");!e&&c.is(":enabled")?(h=!1,c.addClass("yj-invalid").attr("aria-invalid",!0),b(c.data("sister-el")).addClass("yj-invalid")):(c.removeClass("yj-invalid").removeAttr("aria-invalid"),b(c.data("sister-el")).removeClass("yj-invalid"))}),h||(g.preventDefault(),e.trigger("/ui/alert/show","error",f.t("required_fields_are_missing")))},observeRequiredFields:function(a,b){b.on("click",c.bind(function(c){this._checkMissingFields(a,b,c)},this))},preventClickOnDisabledButton:function(a,b){a.submit(function(a){b.hasClass("yj-btn-disabled")&&a.preventDefault(),b.addClass("yj-btn-disabled").attr("disabled",!0)})}}}),define("workfeed/lib/app/field_error_type",["require","core/lib/namespace"],function(a){var b=a("core/lib/namespace");b.ns("yam.forms.FieldErrorType",{Required:"required",Invalid:"invalid",NotUnique:"not-unique"});var c=yam.forms.FieldErrorType,d={"can't be blank":c.Required,"is invalid":c.Invalid,"is already in use":c.NotUnique};return b.ns("yam.helper.form",{translateRailsErrorMessage:function(a){return a in d?d[a]:null}})}),define("workfeed/lib/app/register_new_app_form",["require","jquery","underscore","core/lib/ctor","mustache","workfeed/lib/app/field_error_type","core/lib/jam/component2","backbone","core/lib/yammer_request","core/lib/yammer_uri","core/lib/tr"],function(a){var b=a("jquery"),c=a("underscore"),d=a("core/lib/ctor"),e=a("mustache"),f=a("workfeed/lib/app/field_error_type"),g=a("core/lib/jam/component2"),h=a("backbone"),i=a("core/lib/yammer_request"),j=a("core/lib/yammer_uri"),k=a("core/lib/tr");return d(null,g,{events:{"click .cancel-button":"_onCancelButtonClicked","click .continue-button":"_onContinueButtonClicked"},template:'<div class="register-app-form"><p>'+c.escape(k.t("all_fields_are_required"))+'</p><div class="form-field"><div class="validation-fields"><span class="yj-validation-error" data-error-field="name" data-error-type="required">'+c.escape(k.t("application_name_is_a_required_field"))+'</span><span class="yj-validation-error" data-error-field="name" data-error-type="not-unique">'+c.escape(k.t("the_application_name_you_selected_is_already_in_use"))+'</span></div><label><span class="label">'+c.escape(k.t("application_name"))+'<span class="tooltip" data-tooltip-text="The application name">?</span></span><input type="text" name="name" class="yj-validate" aria-required="true"/></label></div><div class="form-field"><div class="validation-fields"><span class="yj-validation-error" data-error-field="author" data-error-type="required">'+c.escape(k.t("organization_is_a_required_field"))+'</span></div><label><span class="label">'+c.escape(k.t("organization"))+'<span class="tooltip" data-tooltip-text="The name of your organization">?</span></span><input type="text" name="author" class="yj-validate" aria-required="true"/></label></div><div class="form-field"><div class="validation-fields yj-clearfix"><span class="yj-validation-error" data-error-field="email" data-error-type="required">'+c.escape(k.t("support_e_mail_is_a_required_field"))+'</span><span class="yj-validation-error" data-error-field="email" data-error-type="invalid">'+c.escape(k.t("the_e_mail_address_you_entered_is_not_valid"))+'</span></div><label><span class="label">'+c.escape(k.t("support_e_mail"))+'<span class="tooltip" data-tooltip-text="An e-mail address users of your app can contact for application support">?</span></span><input type="text" name="email" class="yj-validate" aria-required="true"/></label></div><div class="form-field"><div class="validation-fields yj-clearfix"><span class="yj-validation-error" data-error-field="url" data-error-type="required">'+c.escape(k.t("website_is_a_required_field"))+'</span><span class="yj-validation-error" data-error-field="url" data-error-type="invalid">'+c.escape(k.t("the_website_must_start_with_http_or_https"))+'</span></div><label><span class="label">'+c.escape(k.t("website"))+'<span class="tooltip" data-tooltip-text="Your company’s website">?</span></span><input type="text" name="url" class="yj-validate" aria-required="true"/></label></div><div class="form-field"><div class="validation-fields yj-clearfix"><span class="yj-validation-error" data-error-field="auth_callback_url" data-error-type="required">'+c.escape(k.t("redirect_uri_is_a_required_field"))+'</span><span class="yj-validation-error" data-error-field="auth_callback_url" data-error-type="invalid">'+c.escape(k.t("the_redirect_uri_must_start_with_http_or_https"))+'</span></div><label><span class="label">'+c.escape(k.t("redirect_uri"))+'<span class="tooltip" data-tooltip-text="The URL to redirect the user\'s browser to after the user has linked the application to their Yammer account">?</span></span><input type="text" name="auth_callback_url" class="yj-validate" aria-required="true"/></label></div><div class="form-field terms-of-service"><div class="validation-fields yj-clearfix"><span class="yj-validation-error terms-validation-error">'+c.escape(k.t("you_must_accept_the_api_terms_of_service"))+'</span></div><label><input type="checkbox" class="checkbox terms-checkbox" name="terms-of-service"/><span class="label">'+k.t("by_checking_this_box_you_agree_that_you_have_read",{link:'<a href="https://products.office.com/yammer/api-terms" target="yammer_api_terms">{$0}</a>'})+'</label></div></div><div class="button-bar"><a href="javascript://" class="yj-btn yj-btn-alt cancel-button" role="button">'+c.escape(k.t("cancel"))+'</a><a href="javascript://" class="yj-btn continue-button" role="button">'+c.escape(k.t("continue"))+"</a></div>",onRendered:function(){this.$tooltips=this.$el.find(".tooltip"),this.$tooltips.each(this._addTooltip),this.$cancelButton=this.$el.find(".cancel-button"),this.$continueButton=this.$el.find(".continue-button")},_onCancelButtonClicked:function(){this.trigger("shouldRemove")},_getFormValues:function(){var a={};return this.$el.find("input").each(function(b,c){a["client_application["+c.getAttribute("name")+"]"]=c.value}),a},_displayValidationErrors:function(a){var c=this.$el;this.$el.find("input").each(function(d,e){var g=b(e),h=g.attr("name"),i=c.find('[data-error-field="'+h+'"]');if(a&&a.hasOwnProperty(h)){g.removeClass("valid").addClass("invalid").attr("aria-invalid",!0);var j=f.translateRailsErrorMessage(a[h][0]);i.filter('[data-error-type="'+j+'"]').show(),i.filter('[data-error-type!="'+j+'"]').hide()}else g.removeClass("invalid").addClass("valid").removeAttr("aria-invalid"),i.hide()})},_validateAcceptanceOfTerms:function(){return this.$termsCheckbox=this.$termsCheckbox||this.$el.find(".terms-checkbox"),this.$termsErrorMessage=this.$termsErrorMessage||this.$el.find(".terms-validation-error"),this.$termsCheckbox.is(":checked")?(this.$termsErrorMessage.hide(),!0):(this.$termsErrorMessage.show(),!1)},_redirectPath:"client_applications/{{id}}",_onContinueButtonClicked:function(){var a=this;this.$continueButton.hasClass("yj-btn-disabled")||this._validateAcceptanceOfTerms()&&(this.$requestHandle=i.send({url:j.app()+"/client_applications",method:"POST",data:this._getFormValues(),error:function(b){try{var c=JSON.parse(b.responseText);a._displayValidationErrors(c.errors)}catch(a){}a.$continueButton.removeClass("yj-btn-disabled")},success:function(b){a._displayValidationErrors(null),window.location.href=j.app()+"/"+e.render(a._redirectPath,{id:b.toString()})}}),this.$continueButton.addClass("yj-btn-disabled"))},onDestroy:function(){this.$requestHandle&&this.$requestHandle.abort(),this.$tooltips.each(this._removeTooltip)},_addTooltip:function(a,c){var d=c.getAttribute("data-tooltip-text");d&&h.trigger("/ui/tooltip/add",{target:b(c),text:d})},_removeTooltip:function(a,b){h.trigger("/ui/tooltip/remove",{target:b})}})}),define("workfeed/lib/app/tooltip_attacher",["require","jquery","core/lib/ctor","backbone"],function(a){var b=a("jquery"),c=a("core/lib/ctor"),d=a("backbone");return c(null,{attach:function(a,c){a&&c&&b(a).each(function(){var a=b(this).attr(c);a&&d.trigger("/ui/tooltip/add",{target:b(this),text:a})})},detach:function(a){a&&b(a).each(function(){d.trigger("/ui/tooltip/remove",{target:b(this)})})}})}),define("stache!workfeed/lib/app/views/network_security_configurations/network_security_ip_range_row",["mustache"],function(a){var b='<td>\n  <label>\n  Start:\n  <input name="network_security_configuration[ip_restrictions][][start_range]" type="text" />\n  </label>\n</td>\n<td>\n  <label>\n  End: \n    <input name="network_security_configuration[ip_restrictions][][end_range]" type="text" />\n  </label>\n</td>\n<td>\n  <label>\n  Name: \n  <input name="network_security_configuration[ip_restrictions][][name]" type="text" />\n  </label>\n</td>\n<td class="actions">\n <br />\n <a class="link-with-yamicon unstyle-link-as-span js-remove-button" title="{{remove_network_security_configuration}}" href="#" role="button"><span class="yamicon yamicon-dash yamicon-regular"></span>{{remove_network_security_configuration}}</a>\n</td>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/network_security_configurations/add_ip_range",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","html!workfeed/lib/app/views/network_security_configurations/network_security_ip_range_row"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("html!workfeed/lib/app/views/network_security_configurations/network_security_ip_range_row"),f=b.extend({mixins:[c],template:e,tagName:"tr",className:"ip_range",events:{"click .js-remove-button":"remove"},getTemplateData:function(){return{remove_network_security_configuration:d.t("remove_network_security_configuration")}}}),g=b.extend({events:{"click #add_range_button":"_addIPRange"},_addIPRange:function(){var a=(new f).render();return this.$("#add_ip_range").before(a.$el),!1},_copyLastIPRangeRow:function(){var a=this.$("tr.ip_range:last").clone();return a.find("input").val(""),a}});return g}),define("stache!workfeed/lib/app/views/network_security_configurations/etr_last_sync_check",["mustache"],function(a){var b="<span>(Last synced at: {{last_sync_time}})</span>";return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/network_security_configurations/etr_last_sync_check",["require","core/lib/backbone_base_view","core/lib/date_helper","core/lib/backbone_with_auto_render","html!workfeed/lib/app/views/network_security_configurations/etr_last_sync_check"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/date_helper"),d=a("core/lib/backbone_with_auto_render"),e=a("html!workfeed/lib/app/views/network_security_configurations/etr_last_sync_check"),f=b.extend({mixins:[d],template:e,getTemplateData:function(){return{last_sync_time:c.formatAgo(this._getTime())}},exists:function(){return this.$el.length>0},_getTime:function(){var a=this.$el.data("etrSyncedAt");return new Date(a)}});return f}),define("stache!workfeed/lib/app/views/network_security_configurations/logout_users_checkbox",["mustache"],function(a){var b='<input type="checkbox" class="yj-logout-checkbox" name="logoutCurrentUsers" id="logoutCurrentUsers"/>\n<label for="logoutCurrentUsers">{{office_auth_log_out}}</label></p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/network_security_configurations/logout_users_checkbox",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","html!workfeed/lib/app/views/network_security_configurations/logout_users_checkbox"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("html!workfeed/lib/app/views/network_security_configurations/logout_users_checkbox");return b.extend({template:e,mixins:[c],getTemplateData:function(){return{office_auth_log_out:d.t("enforce_office_auth_log_out")}},isChecked:function(){return this.$(".yj-logout-checkbox").prop("checked")}})}),define("stache!workfeed/lib/app/views/network_security_configurations/enable_office_auth_lightbox_component",["mustache"],function(a){var b='<p>\n  <strong>{{office_auth_title}}</strong>\n</p>\n<p>\n  {{office_auth_ensure}}\n  <strong class="js-active-users-count">{{office_auth_active_users}}</strong>\n  {{{office_auth_documentation_link}}}\n</p>\n<p>\n  <LogoutUsersCheckbox />\n<p>\n   {{{office_auth_body}}}\n</p>\n<p>\n  <a class="office_auth__view_example" href="#" role="button">{{office_auth_view_example}}</a>\n</p>\n<section class="office_auth__example_text">\n    <p><em>{{office_auth_dear}}</em></p>\n    <p><em>{{office_auth_example_text}}</em></p>\n    <p><em>{{office_auth_signature}}</em></p>\n</section>\n\n<p><a class="office_auth__hide_example" href="#" role="button">{{office_auth_hide_example}}</a></p>\n<p class="office_auth__btn-container">\n  <button class="yj-btn yj-office-auth-btn office_auth__yes-btn">{{office_auth_yes}}</button>\n  <button class="yj-btn yj-btn-alt yj-office-auth-btn office_auth__cancel-btn">{{cancel}}</button>\n</p>\n<p class="office_auth__save-message">\n  <em>{{{office_auth_message}}}</em>\n</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/network_security_configurations/enable_office_auth_lightbox_component",["require","core/lib/backbone_base_view","core/lib/tr","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","workfeed/lib/app/views/network_security_configurations/logout_users_checkbox","html!workfeed/lib/app/views/network_security_configurations/enable_office_auth_lightbox_component"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/tr"),d=a("core/lib/backbone_with_auto_render"),e=a("core/lib/backbone_with_subviews"),f=a("workfeed/lib/app/views/network_security_configurations/logout_users_checkbox"),g=a("html!workfeed/lib/app/views/network_security_configurations/enable_office_auth_lightbox_component"),h=100,i="http://go.microsoft.com/fwlink/?LinkId=691105",j=b.extend({template:g,className:"yj-office-enforce-auth",mixins:[d,e],views:{LogoutUsersCheckbox:"_getLogoutUsersCheckbox"},events:{"click .office_auth__cancel-btn":"_onCancelClick","click .office_auth__yes-btn":"_onYesClick","click .office_auth__view_example":"_onViewExampleClick","click .office_auth__hide_example":"_onHideExampleClick"},getTemplateData:function(){return{office_auth_title:c.t("enforce_office_auth_modal_title"),office_auth_documentation_link:c.t("enforce_office_auth_documentation_link",{link:this._getDocumentationLink()}),office_auth_ensure:c.t("enforce_office_auth_ensure_identities"),office_auth_body:c.t("enforce_office_auth_body"),office_auth_yes:c.t("enforce_office_auth_yes"),office_auth_active_users:c.t("enforce_office_auth_active_user",{count:this._getActiveUsers()}),office_auth_view_example:c.t("enforce_office_auth_view_example"),office_auth_hide_example:c.t("enforce_office_auth_hide_example"),office_auth_dear:c.t("enforce_office_auth_dear"),office_auth_signature:c.t("enforce_office_auth_signature"),office_auth_example_text:c.t("enforce_office_auth_example_message"),office_auth_message:c.t("enforce_office_auth_message"),cancel:c.t("cancel")}},_getLogoutUsersCheckbox:function(){return this.logoutUsersCheckbox=new f,this.logoutUsersCheckbox},_getActiveUsers:function(){return this.options.active_users},_onViewExampleClick:function(){var a=this.$(".office_auth__example_text"),b=this.$(".office_auth__hide_example"),c=this.$(".office_auth__view_example");c.hide(),a.slideDown(h,function(){b.show()})},_onHideExampleClick:function(){var a=this.$(".office_auth__example_text"),b=this.$(".office_auth__hide_example"),c=this.$(".office_auth__view_example");b.hide(),a.slideUp(h,function(){c.show()})},_getDocumentationLink:function(){return'<a target="_blank" href="'+i+'">{$0}</a>'},_onCancelClick:function(){this.trigger("cancelAndClose")},_onYesClick:function(){this.trigger("saveAndClose",{logOutSelected:this.logoutUsersCheckbox.isChecked()})}});return j}),define("workfeed/lib/app/views/network_security_configurations/office_auth_lightbox",["require","core/lib/backbone_base_class","components/simple_lightbox/index"],function(a){"use strict";var b=a("core/lib/backbone_base_class"),c=a("components/simple_lightbox/index"),d=b.extend({run:function(){this.officeAuthLightboxComponent&&(this.simpleLightbox=new c({component:this.officeAuthLightboxComponent,className:"yj-simple-lightbox office-auth-lightbox",title:this.title}),this._setUpEventListeners(),this.simpleLightbox.show())},_setUpEventListeners:function(){this.listenToOnce(this.officeAuthLightboxComponent,"cancelAndClose",this._unSelectCheckbox.bind(this)),this.listenToOnce(this.officeAuthLightboxComponent,"saveAndClose",this._saveAndClose.bind(this)),this.listenToOnce(this.simpleLightbox,"close",this._unSelectCheckbox.bind(this))},_unSelectCheckbox:function(){this._stopListeningAndClose(),this.trigger("cancelAndClose")},_saveAndClose:function(a){this.trigger("saveAndClose",a),this._stopListeningAndClose()},_stopListeningAndClose:function(){this.stopListening(this.simpleLightbox,"close"),this.officeAuthLightboxComponent&&this.officeAuthLightboxComponent.trigger("close")}});return d}),define("workfeed/lib/app/views/network_security_configurations/enable_office_auth_lightbox",["require","core/lib/tr","workfeed/lib/app/views/network_security_configurations/enable_office_auth_lightbox_component","workfeed/lib/app/views/network_security_configurations/office_auth_lightbox"],function(a){"use strict";var b=a("core/lib/tr"),c=a("workfeed/lib/app/views/network_security_configurations/enable_office_auth_lightbox_component"),d=a("workfeed/lib/app/views/network_security_configurations/office_auth_lightbox"),e=d.extend({initialize:function(a){this.title=b.t("enforce_office_auth_title"),this.officeAuthLightboxComponent=new c({active_users:a.active_users})}});return e}),define("stache!workfeed/lib/app/views/network_security_configurations/disable_office_auth_lightbox_component",["mustache"],function(a){var b='<p>\n  <strong>{{unenforce_office_auth_title}}</strong>\n</p>\n<p>\n  {{unenforce_office_auth_body_p1}}\n</p>\n<p>\n  {{unenforce_office_auth_body_p2}}\n</p>\n<p>\n  {{unenforce_office_auth_body_p3}}\n</p>\n<p>\n  {{{office_auth_documentation_link}}}\n</p>\n<p class="office_auth__btn-container">\n  <button class="yj-btn yj-office-auth-btn office_auth__yes-btn">{{office_auth_yes}}</button>\n  <button class="yj-btn yj-btn-alt yj-office-auth-btn office_auth__cancel-btn">{{cancel}}</button>\n</p>\n<p class="office_auth__save-message">\n  <em>{{{office_auth_message}}}</em>\n</p>';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/network_security_configurations/disable_office_auth_lightbox_component",["require","core/lib/backbone_base_view","core/lib/tr","core/lib/backbone_with_auto_render","html!workfeed/lib/app/views/network_security_configurations/disable_office_auth_lightbox_component"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/tr"),d=a("core/lib/backbone_with_auto_render"),e=a("html!workfeed/lib/app/views/network_security_configurations/disable_office_auth_lightbox_component"),f="http://go.microsoft.com/fwlink/?LinkId=691105",g=b.extend({template:e,mixins:[d],className:"yj-office-enforce-auth",events:{"click .office_auth__yes-btn":"_onYesClick","click .office_auth__cancel-btn":"_onCancelClick"},getTemplateData:function(){return{unenforce_office_auth_title:c.t("unenforce_office_auth_title"),unenforce_office_auth_body_p1:c.t("unenforce_office_auth_content_p1"),unenforce_office_auth_body_p2:c.t("unenforce_office_auth_content_p2"),unenforce_office_auth_body_p3:c.t("unenforce_office_auth_content_p3"),office_auth_message:c.t("enforce_office_auth_message"),office_auth_documentation_link:c.t("enforce_office_auth_documentation_link",{link:this._getDocumentationLink()}),office_auth_yes:c.t("enforce_office_auth_yes"),cancel:c.t("cancel")}},_onYesClick:function(){this.trigger("saveAndClose")},_onCancelClick:function(){this.trigger("cancelAndClose")},_getDocumentationLink:function(){return'<a target="_blank" href="'+f+'">{$0}</a>'}});return g}),define("workfeed/lib/app/views/network_security_configurations/disable_office_auth_lightbox",["require","core/lib/tr","workfeed/lib/app/views/network_security_configurations/disable_office_auth_lightbox_component","workfeed/lib/app/views/network_security_configurations/office_auth_lightbox"],function(a){"use strict";var b=a("core/lib/tr"),c=a("workfeed/lib/app/views/network_security_configurations/disable_office_auth_lightbox_component"),d=a("workfeed/lib/app/views/network_security_configurations/office_auth_lightbox"),e=d.extend({initialize:function(){this.title=b.t("unenforce_office_auth_title"),this.officeAuthLightboxComponent=new c}});return e}),define("stache!workfeed/lib/app/views/network_security_configurations/office_authentication",["mustache"],function(a){var b='<h3>{{office_auth_title}}</h3>\n<p>{{office_auth_content}} {{{office_auth_documentation_link}}}</p>\n<p>\n  <input type="hidden" class="js-log-out-users" name="log_out_users" value="0">\n  <input name="network_security_configuration[enforce_office_authentication]" type="hidden" value="0">\n  <input class="checkbox js-enforce-checkbox" id="network_security_configuration_enforce_office_auth" name="network_security_configuration[enforce_office_authentication]" type="checkbox" {{#office_auth_enforced}}checked{{/office_auth_enforced}} value="1">\n  <label class="checkbox-label" for="network_security_configuration_enforce_office_auth">{{office_auth_checkbox_text}}</label>\n</p>\n\n{{#show_enforce_user_licensing}}\n<EnforceUserLicensingToggle />\n{{/show_enforce_user_licensing}}\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!workfeed/lib/app/views/network_security_configurations/enforce_office_license_toggle",["mustache"],function(a){var b='\n<input type="hidden" class="enforce-office-license-checkbox-hidden" name="network_security_configuration[enforce_user_license]" value="0" />\n<input type="checkbox" id="enforce-office-license-checkbox" class="checkbox enforce-office-license-checkbox" />\n<label class="enforce-office-license-checkbox-label" for="enforce-office-license-checkbox">{{enforce_office_license_checkbox_text}}</label>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("stache!workfeed/lib/app/views/network_security_configurations/enforce_office_license_lightbox",["mustache"],function(a){var b='<p>\n  <strong>{{enforce_office_licenses_strong_body}}</strong>\n</p>\n<p>\n  {{enforce_office_licenses_ensure}}\n  {{{enforce_office_licenses_documentation_link}}}\n</p>\n<p>\n  <LogoutUsersCheckbox />\n<p>\n{{{enforce_office_licenses_body}}}\n</p>\n\n<p class="enforce_license__btn-container">\n  <button class="yj-btn yj-enforce_license-btn enforce_license__yes-btn">{{enforce_office_licenses_yes}}</button>\n  <button class="yj-btn yj-btn-alt yj-enforce_license-btn enforce_license__cancel-btn">{{cancel}}</button>\n</p>\n\n<p class="enforce_license__save-message">\n  <em>{{{enforce_office_save_message}}}</em>\n</p>\n';return a.parse(b),function(c){return a.render(b,c)}}),define("workfeed/lib/app/views/network_security_configurations/enforce_office_license_lightbox",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","workfeed/lib/app/views/network_security_configurations/logout_users_checkbox","html!workfeed/lib/app/views/network_security_configurations/enforce_office_license_lightbox"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/tr"),f=a("workfeed/lib/app/views/network_security_configurations/logout_users_checkbox"),g=a("html!workfeed/lib/app/views/network_security_configurations/enforce_office_license_lightbox"),h="https://support.office.com/article/Manage-Yammer-user-licenses-in-Office-365-34a67e3a-3fd8-4e54-bffb-dd5ad0e48590",i=b.extend({template:g,className:"yj-office-enforce-auth",mixins:[c,d],events:{"click .enforce_license__cancel-btn":"_handleCancelClick","click .enforce_license__yes-btn":"_handleAcceptClick"},views:{LogoutUsersCheckbox:"_getLogoutUsersCheckbox"},getTemplateData:function(){return{enforce_office_licenses_strong_body:e.t("enforce_office_licenses_strong_body"),enforce_office_licenses_documentation_link:e.t("enforce_office_licenses_documentation_link",{link:this._getDocumentationLink()}),enforce_office_licenses_ensure:e.t("enforce_office_licenses_ensure"),enforce_office_licenses_body:e.t("enforce_office_licenses_body"),enforce_office_auth_yes:e.t("enforce_office_auth_yes"),enforce_office_licenses_yes:e.t("enforce_office_licenses_yes"),enforce_office_save_message:e.t("enforce_office_save_message"),cancel:e.t("cancel")}},_getLogoutUsersCheckbox:function(){return this.logoutUsersCheckbox=new f,this.logoutUsersCheckbox},_getDocumentationLink:function(){
return'<a target="_blank" href="'+h+'">{$0}</a>'},_handleCancelClick:function(){this.trigger("cancel")},_handleAcceptClick:function(){this.trigger("saveAndClose",{shouldLogoutUsers:this.logoutUsersCheckbox.isChecked()})}});return i}),define("css!workfeed/lib/app/views/network_security_configurations/enforce_office_license",[],function(){}),define("workfeed/lib/app/views/network_security_configurations/enforce_office_license_toggle",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/tr","components/simple_lightbox/index","html!workfeed/lib/app/views/network_security_configurations/enforce_office_license_toggle","workfeed/lib/app/views/network_security_configurations/enforce_office_license_lightbox","css!workfeed/lib/app/views/network_security_configurations/enforce_office_license"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/tr"),e=a("components/simple_lightbox/index"),f=a("html!workfeed/lib/app/views/network_security_configurations/enforce_office_license_toggle"),g=a("workfeed/lib/app/views/network_security_configurations/enforce_office_license_lightbox");return a("css!workfeed/lib/app/views/network_security_configurations/enforce_office_license"),b.extend({template:f,mixins:[c],events:{"click .enforce-office-license-checkbox":"_showLightbox"},tagName:"p",className:"enforce-license-toggle",render:function(){return this.options.enforce_user_licensing&&this._check(),this},getTemplateData:function(){return{enforce_office_license_title:d.t("enforce_office_license_title"),enforce_office_license_checkbox_text:d.t("enforce_office_license_checkbox_text")}},_check:function(){this.$(".enforce-office-license-checkbox-hidden").val(1),this.$(".enforce-office-license-checkbox").prop("checked",!0)},_updateHiddenCheckbox:function(){var a=0;this.$(".enforce-office-license-checkbox").prop("checked")&&(a=1),this.$(".enforce-office-license-checkbox-hidden").val(a)},exists:function(){return this.$el.length>0},_createLightbox:function(){this.enforceOfficeLightbox=new g,this.listenTo(this.enforceOfficeLightbox,"cancel",this._onLightboxCancel.bind(this)),this.listenTo(this.enforceOfficeLightbox,"saveAndClose",this._onLightboxAccept.bind(this)),this.lightbox=new e({component:this.enforceOfficeLightbox,className:"yj-simple-lightbox enforce-license-lightbox",title:d.t("enforce_office_license_lightbox_title")})},_showLightbox:function(){this._updateHiddenCheckbox(),this.$(".enforce-office-license-checkbox").prop("checked")&&(this._createLightbox(),this.lightbox.show())},_onLightboxAccept:function(a){this.trigger("accept",a),this.lightbox.remove()},_onLightboxCancel:function(){this._uncheck(),this.lightbox.remove()},_uncheck:function(){this.$(".enforce-office-license-checkbox").prop("checked",!1)}})}),define("css!workfeed/lib/app/views/network_security_configurations/office_authentication",[],function(){}),define("workfeed/lib/app/views/network_security_configurations/office_authentication",["require","core/lib/backbone_base_view","core/lib/backbone_with_auto_render","core/lib/backbone_with_subviews","core/lib/tr","workfeed/lib/app/views/network_security_configurations/enable_office_auth_lightbox","workfeed/lib/app/views/network_security_configurations/disable_office_auth_lightbox","html!workfeed/lib/app/views/network_security_configurations/office_authentication","workfeed/lib/app/views/network_security_configurations/enforce_office_license_toggle","css!workfeed/lib/app/views/network_security_configurations/office_authentication"],function(a){"use strict";var b=a("core/lib/backbone_base_view"),c=a("core/lib/backbone_with_auto_render"),d=a("core/lib/backbone_with_subviews"),e=a("core/lib/tr"),f=a("workfeed/lib/app/views/network_security_configurations/enable_office_auth_lightbox"),g=a("workfeed/lib/app/views/network_security_configurations/disable_office_auth_lightbox"),h=a("html!workfeed/lib/app/views/network_security_configurations/office_authentication"),i="http://go.microsoft.com/fwlink/?LinkId=691105",j=a("workfeed/lib/app/views/network_security_configurations/enforce_office_license_toggle");a("css!workfeed/lib/app/views/network_security_configurations/office_authentication");var k=b.extend({template:h,mixins:[c,d],events:{"click .js-enforce-checkbox":"_displayLightbox"},views:{EnforceUserLicensingToggle:"getEnforceUserLicensingToggle"},getEnforceUserLicensingToggle:function(){return this.enforceUserLicensingToggle=new j({enforce_user_licensing:this.options.enforce_user_licensing}),this.listenTo(this.enforceUserLicensingToggle,"accept",this._toggleLogOutCheckbox.bind(this)),this.enforceUserLicensingToggle},getTemplateData:function(){return{office_auth_title:e.t("enforce_office_auth_title"),office_auth_content:e.t("enforce_office_auth_content"),office_auth_documentation_link:e.t("enforce_office_auth_documentation_link",{link:this._getDocumentationLink()}),office_auth_checkbox_text:e.t("enforce_office_auth_checkbox_text"),office_auth_enforced:this.options.office_auth_enforced,show_enforce_user_licensing:this.options.office_auth_enforced}},exists:function(){return this.$el.length>0},remove:function(){this.enableOfficeAuthLightbox&&this.enableOfficeAuthLightbox._stopListeningAndClose(),this.disableOfficeAuthLightbox&&this.disableOfficeAuthLightbox._stopListeningAndClose(),b.prototype.remove.call(this)},_toggleLogOutCheckbox:function(a){a.shouldLogoutUsers&&this._selectLogOutUsers({logOutSelected:!0})},_displayLightbox:function(){this._resetFlags();var a=this.$(".js-enforce-checkbox");a.prop("checked")?this._showEnableLightbox():this._showDisableLightbox()},_selectLogOutUsers:function(a){a=a||{};var b=this.$(".js-log-out-users");b.val(a.logOutSelected?"1":"0")},_setEnforceCheckbox:function(a){var b=this.$(".js-enforce-checkbox");b.prop("checked",a)},_resetFlags:function(){this.$(".js-log-out-users").val(0)},_getDocumentationLink:function(){return'<a target="_blank" href="'+i+'">{$0}</a>'},_showEnableLightbox:function(){this.enableOfficeAuthLightbox=new f({active_users:this.options.active_users}),this.listenTo(this.enableOfficeAuthLightbox,"cancelAndClose",this._setEnforceCheckbox.bind(this,!1)),this.listenTo(this.enableOfficeAuthLightbox,"saveAndClose",this._selectLogOutUsers.bind(this)),this.enableOfficeAuthLightbox.run()},_showDisableLightbox:function(){this.disableOfficeAuthLightbox=new g,this.listenTo(this.disableOfficeAuthLightbox,"cancelAndClose",this._setEnforceCheckbox.bind(this,!0)),this.disableOfficeAuthLightbox.run()}});return k}),define("workfeed/lib/modules/group_inviter",["require","jquery","underscore","common-ui/lib/ui/shared/type_ahead","core/lib/tr"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/shared/type_ahead"),e=a("core/lib/tr");return{domain_select:"",userId:null,invitees:null,allowInvites:!1,email_field_class:"partial wider",fieldCount:0,fieldName:"invites[emails][usernames][]",progressBar:!1,usePeopleTagger:!0,peopleTaggers:{},newCoworker:function(a){if(""!==a.value){b(a).unbind("keyup");var c=b('<li class="domain"></li>').hide();b("#collect-emails-list").append(c),b("#collect-emails-list").append(this.buildField(c,!0))}},buildField:function(a,d){a.html("");var f=b("<label />").attr("for","field-"+this.fieldCount);b("<span />").addClass("yj-acc-hidden").text(e.t("additional_co_worker_email")).appendTo(f);var g=b("<input />").addClass(this.email_field_class).attr("id","field-"+this.fieldCount).attr("name",this.fieldName).attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("type","text"),h=b('<span class="org_chart_domain"></span>');return d&&g.keyup(c.bind(function(){""!==g.attr("value")&&this.newCoworker(g)},this)),this.email_field_class.indexOf("partial")>-1?(h.append('<span class="org-chart-at">@</span>'+this.domain_select),a.append(g).append(h)):(h.append(g),a.append(h)),a.prepend(f),a.fadeIn(500),this.usePeopleTagger&&this.addPeopleTagger(g.attr("id")),this.fieldCount++,a},addPeopleTagger:function(a){var c=this,e={completableModels:[d.MODEL_USER],hintMessage:"Type to find co-workers",onSelect:function(e){d.defaultOnSelect.apply(this,arguments),b("#"+a).parents("li").next().find(".invite-by-email").focus(),c.updateInviteeField(a,e)}};c.peopleTaggerOpts&&b.extend(!0,e,c.peopleTaggerOpts),d.registerField(b("#"+a),e)},updateInviteeField:function(a,d){"string"==typeof a&&"#"!=a[0]&&(a="#"+a);var e=b(a).closest("li.domain"),f=b("<input />").attr("type","hidden").attr("name","invites[ids][]").attr("class","email-address").val(d.id),g=b('<a href="javascript://" class="reset">x</a>');g.click(c.bind(function(){this.buildField(e,!1)},this)),e.html(d.full_name+"<em>("+d.name+")</em>"),e.append(f),e.append(g),e.next("li.domain").find("input:text").focus(),this.progressBar&&this.updateProgressBar()},resetInviteFields:function(a){var c=this,d=b(a);d.find("li").each(function(a){return a>4?b(this).remove():void c.buildField(this,4==a)})},initProgressBar:function(){this.setProgressBar(1),b(document).on("blur",".email-address",this.updateProgressBar.bind(this)),this.progressBar=!0},updateProgressBar:function(){var a,c,d=b(".email-address"),e=1;for(a=0,c=d.length;c>a;a++)""!==b(d[a]).val()&&e++;this.setProgressBar(e)},setProgressBar:function(a){20>a&&(b("#progress-bar").css("width",9>a?20*a:181+a),b(".meter-score").html((9>=a?10*a:a+81)+"%"))}}}),define("workfeed/lib/modules/signup_group_suggestions",["require","jquery","core/lib/namespace","core/lib/yammer_request"],function(a){var b=a("jquery"),c=a("core/lib/namespace"),d=a("core/lib/yammer_request");return c.ns("yam.workfeed"),yam.workfeed.SignupGroupSuggestions={init:function(){b(document).on("click",".join-group-container .join-group",yam.workfeed.SignupGroupSuggestions.joinGroup),b(document).on("click",".join-group-container .create-group",yam.workfeed.SignupGroupSuggestions.createGroup),b(document).on("click",".join-group-container .join-private-group",yam.workfeed.SignupGroupSuggestions.joinPrivateGroup)},_doJoinGroup:function(a,c,e,f){b(e+", "+f).toggle();var g=c._method;"undefined"==typeof g&&(g="POST"),d.send({url:a,data:c,type:g,auth:!1})},createGroup:function(){var a=b(this),c="/"+a.attr("data-permalink")+"/groups/create_suggestion.json",d=a.attr("data-group-index"),e=a.attr("data-auth-token"),f=a.attr("data-group-name"),g="#join-group-"+d,h="#leave-group-"+d,i={group:{name:f},authenticity_token:e};return yam.workfeed.SignupGroupSuggestions._doJoinGroup(c,i,g,h),!1},joinGroup:function(){var a=b(this),c=a.attr("data-group-id"),d=a.attr("data-group-index"),e="/"+a.attr("data-permalink")+"/api/v1/group_suggestions/"+c+".json",f=a.attr("data-auth-token"),g="#join-group-"+d,h="#leave-group-"+d,i={authenticity_token:f,_method:"PUT"};return yam.workfeed.SignupGroupSuggestions._doJoinGroup(e,i,g,h),!1},joinPrivateGroup:function(){var a=b(this),c=a.attr("data-group-id"),d=a.attr("data-group-index"),e="/"+a.attr("data-permalink")+"/api/v1/group_suggestions/"+c+".json",f=a.attr("data-auth-token"),g="#join-group-"+d,h="#leave-group-"+d,i={authenticity_token:f,_method:"PUT"};return yam.workfeed.SignupGroupSuggestions._doJoinGroup(e,i,g,h),!1}}}),define("workfeed/lib/orgchart",["require","jquery","underscore","common-ui/lib/ui/shared/type_ahead","core/lib/namespace","backbone","core/lib/string_helper","core/lib/tr","core/lib/yammer_request","core/lib/urls","core/lib/session","core/lib/yammer_uri"],function(a){var b=a("jquery"),c=a("underscore"),d=a("common-ui/lib/ui/shared/type_ahead"),e=a("core/lib/namespace"),f=a("backbone"),g=a("core/lib/string_helper"),h=a("core/lib/tr"),i=a("core/lib/yammer_request"),j=a("core/lib/urls"),k=a("core/lib/session"),l=a("core/lib/yammer_uri");e.ns("yam.workfeed");var m=function(a,c,d,e){return this.init=function(a,c,d,e){return this.currentUser=a,this.apiURL="/api/v1/relationships",this.orgchartContainer=b(c),this.orgchartContainer.append("<div id='superior-container'></div><div id='user-container'></div><div id='subordinates-container'>").hide(),this.superiorContainer=b("#superior-container"),this.userContainer=b("#user-container"),this.subordinateContainer=b("#subordinates-container"),this.loadingSpinner=b("#loading-spinner"),this.selectedUserID,this.addUserForms=this.buildForms(["superior","colleague","subordinate"]),this.formOpen=!1,this.boundLiveEvents=!1,this.alreadySeen={},this.formAuthToken=d,this.currentlyLoadedIDs=[],this.previouslyLoadedIDs=[],this.newlyAddedUserID=null,this.reloaded=!1,this.searchedUser=null,this.addInviteButton(this.superiorContainer,"superior"),this.addInviteButton(this.userContainer,"colleague"),this.addInviteButton(this.subordinateContainer,"subordinate"),b("#orgchart-add-superior").hide(),e?void this.processUser(e):(this.getUser(this.apiURL+"?user_id="+a.id),this.loadingSpinner.hide(),void this.addSearch())},this.init(a,c,d,e)};return m.prototype.DEFAULT_ADD_MESSAGE=h.t("enter_username_or_email"),m.prototype.getUser=function(a,b){var c;c=this.selectedUserID&&this.alreadySeen[this.selectedUserID]&&!b?this.alreadySeen[this.selectedUserID]:this.request(a);var d,e;if(!this.selectedUserID)for(d=0,e=c.colleagues.length;e>d;d++)c.colleagues[d].id===this.currentUser.id&&(this.selectedUserID=c.colleagues[d].id);for(var f in c)for(d=0,e=c[f].length;e>d;d++){var g=c[f][d].id;this.currentlyLoadedIDs.push(g)}this.keepSearchedUser===!1&&(this.searchedUser=null,this.keepSearchedUser=!1),this.lastRequestedUserObject=c,this.processUser(c)},m.prototype.request=function(a,c,d,e,g,j){d=d||{};var k;"POST"===c&&(d.authenticity_token=this.formAuthToken);var l=function(a){a?f.trigger("/ui/alert/show","notice",h.t("user_has_been_addedinvited")):f.trigger("/ui/alert/show","error",h.t("that_user_was_unable_to_be_added_please_verify_that"))};return i.send({url:a,data:d,async:!1,type:c?c:"GET",dataType:e||"json",beforeSend:function(a){a.setRequestHeader("X-CSRF-Token",b('meta[name="csrf-token"]').attr("content"))},success:function(a){j?l(a):(k=a,g&&f.trigger("/ui/alert/show","notice",g))}}),k},m.prototype.processUser=function(a){this.selectedUserID&&(this.alreadySeen[this.selectedUserID]=a),this.update(a),this.bindEvents(a);var c=b("#orgchart-add-superior"),d=b("#orgchart-add-colleague");a.superiors.length>0?(c.hide(),d.show()):(c.show(),d.hide())},m.prototype.update=function(a){this.clear();var c;if(a.superiors.length>0)for(c=0;c<a.superiors.length;c++)this.superiorContainer.prepend(this.buildUserContainer(a.superiors[c]));if(a.superiors.length>0&&a.colleagues.length>0)for(c=0;c<a.colleagues.length>0;c++)this.userContainer.prepend(this.buildUserContainer(a.colleagues[c]));if(a.subordinates.length>0)for(c=0;c<a.subordinates.length;c++)this.subordinateContainer.prepend(this.buildUserContainer(a.subordinates[c]));if(0===a.colleagues.length&&this.searchedUser&&(this.selectedUserID=this.searchedUser.id,this.alreadySeen[this.selectedUserID]=this.searchedUser,this.selectedUser=this.searchedUser,this.userContainer.prepend(this.buildUserContainer(this.searchedUser))),this.selectedUserID)if(0===a.superiors.length)this.userContainer.prepend(this.selectedUser);else{var d=b("#orgchart-user-"+this.selectedUserID);this.userContainer.prepend(d)}else this.userContainer.prepend(this.buildUserContainer(this.currentUser)),this.selectedUserID=this.currentUser.id,a.colleagues.push(this.currentUser),this.alreadySeen[this.selectedUserID]=a;this.setupFirstLast(),this.addConnectors(),this.userContainer.find(".first").find(".orgchart-button").hide(),this.superiorContainer.find(".button-img").attr("src",l.cdn("assets/images/icons/arrow_left.png")).attr("alt",h.t("move_to_manager")),0===this.lastRequestedUserObject.superiors.length&&this.userContainer.children().first().find(".delete-user").hide(),this.orgchartContainer.show()},m.prototype.addRelationship=function(a,b,c,d){var e=this.selectedUserID,f=this.alreadySeen[e];0===f.superiors.length&&(this.selectedUserID=null),this.previouslyLoadedIDs=this.currentlyLoadedIDs,this.request(a,b,c,d,null,!0),this.reloaded=!0,this.keepSearchedUser=!0,this.getUser(this.apiURL+"?user_id="+e,!0)},m.prototype.removeRelationship=function(a,b){if(window.confirm("Are you sure you want remove the user from this position in the orgchart?")){var c=this.alreadySeen[this.selectedUserID],d=this.selectedUserID,e=c?c[b]:[],f={},g=0;if(e)for(g;g<e.length;g++)e[g].id===a&&e.splice(g,1);"colleagues"===b&&(d=c.superiors[0].id),b="superiors"===b?"boss":"report",f.type=b,f._method="delete",0===c.superiors.length&&(this.selectedUserID=null),this.processUser(c),this.request(this.apiURL+"/"+a+"/?user_id="+d,"POST",f,"text")}},m.prototype.addInviteButton=function(a,b){a.append(this.buildAddButtons(b))},m.prototype.buildUserContainer=function(a){var b="<strong>"+h.t("pending_2")+"</strong>",d=12;null===a.full_name?(a.full_name=g.truncate(a.name,21),a.job_title=b):(a.full_name=g.truncate(a.full_name,21),a.job_title!==b&&(a.job_title=a.job_title?g.truncate(a.job_title,d):""));var e="";return e+='<div class="orgchart-user-container" id="orgchart-user-'+a.id+'">',e+='<ul class="orgchart-user yj-want-focuswithin">',e+='<li class="orgchart-avatar"><img src="'+a.mugshot_url+'" alt="" /></li>',e+="<li>",e+='<p class="orgchart-user-name">'+c.escape(a.full_name)+"</p>",e+='<p class="orgchart-user-title">'+c.escape(a.job_title)+"</p>",e+='<p class="orgchart-view-profile">',e+='<span><a href="'+j.userIndex(a,k)+'">'+h.t("view_profile")+"</a></span>",a.id!==this.currentUser.id&&(e+='<span class="delete-user"><a href="javascript://" role="button">'+h.t("remove")+"</a></span>"),e+="</p>",e+="</li>",e+='<li id="orgchart-button-'+a.id+'" class="orgchart-button">',e+='<a href="javascript://" role="button" data-speechtip>',e+='<img src="'+l.cdn("assets/images/icons/arrow_right.png")+'" class="button-img" alt="'+h.t("move_to_reports")+'" />',e+="</a>",e+="</li>",e+="</ul>",e+="</div>"},m.prototype.buildAddButtons=function(a){var b="superior"===a?h.t("add_manager"):"subordinate"===a?h.t("add_report"):h.t("add_colleague");return"<div class='orgchart-user-container orgchart-add' id='orgchart-add-"+a+"'><div class='orgchart-user-add'><a href='javascript://' class='orgchart-add-link'>"+b+"</a></div></div>"},m.prototype.bindEvents=function(){var a=this;b(".orgchart-button").bind("click",function(){var c=b(this),d=c.parents(".orgchart-user-container");a.keepSearchedUser=!1,a.selectedUserID=d.first().attr("id").replace("orgchart-user-",""),a.selectedUser=jQuery.extend({},d),c.find(".button-img").replaceWith('<img src="'+l.cdn("assets/images/spinner/spinner-grey-on-white.gif")+'" width="16" height="16" />'),setTimeout(function(){a.getUser(a.apiURL+"?user_id="+a.selectedUserID)},1)}),a.boundLiveEvents||(b(document).on("click",".orgchart-add-link",function(){var c=b(this),d=c.parents(".orgchart-add").attr("id").replace("orgchart-add-","");a.formOpen&&a.unloadForm(b(".orgchart-add-user-form").first().parent()),a.oldAddButtonRelType=d,a.loadForm(c.parent(),d),a.formOpen=!0}),b(document).on("click",".orgchart-cancel-form",function(){var c=b(this);a.unloadForm(c.parent().parent()),a.formOpen=!1}),b(document).on("keyup blur",".orgchart-input-email",function(){var c=b(this),d=c.siblings(".yj-btn"),e=a.validateFormFields("email",c.val());e?d.attr("disabled",!1).removeClass("yj-btn-disabled"):d.attr("disabled",!0).addClass("yj-btn-disabled")}),b(document).on("click",".orgchart-add-user-form .yj-btn",function(){var c=b(this),d=a.buildAddRelationshipVars(c);if(!c.attr("disabled"))return a.unloadForm(d.parentContainer),a.addRelationship(a.apiURL+"/?user_id="+d.userID,"POST",d.params,"json"),!1}),b(document).on("click",".delete-user",function(){var c=b(this),d=parseInt(c.parents(".orgchart-user-container").attr("id").replace("orgchart-user-","")),e=c.parents(".orgchart-user-container").parent().attr("id").replace("-container","");"user"===e?e="colleagues":"superior"===e&&(e="superiors"),a.removeRelationship(d,e)}),a.boundLiveEvents=!0)},m.prototype.loadForm=function(a,c){var e=this;a.replaceWith(this.addUserForms[c]),d.registerField("#add-"+c+"-input",{completableModels:[d.MODEL_USER],styles:"minimal",onSelect:function(a){var d=b("#add-"+c+"-input"),f={},g=e.buildAddRelationshipVars(d);d.val(a.full_name),f["usernames["+g.relType+"][]"]=a.id,e.unloadForm(g.parentContainer),e.addRelationship(e.apiURL+"/?user_id="+g.userID,"POST",f,"json")}}),b(".orgchart-input-email").click(function(a){var b=a.target;b.value==e.DEFAULT_ADD_MESSAGE&&(b.value="")}),b("#add-"+c+"-input").focus()},m.prototype.buildAddRelationshipVars=function(a){var b;this.selectedUserID&&this.alreadySeen[this.selectedUserID]&&this.alreadySeen[this.selectedUserID].superiors&&this.alreadySeen[this.selectedUserID].superiors.length>0&&(b=this.alreadySeen[this.selectedUserID].superiors[0].id);var c=a.parents(".orgchart-add"),d=c.attr("id").replace("orgchart-add-",""),e={},f=b?b:this.currentUser.id,g="subordinate"===d?this.selectedUserID:f;return d="subordinate"===d||"colleague"===d?"report":"boss",e["usernames["+d+"][]"]=a.siblings(".orgchart-input-email").val(),{params:e,userID:g,relType:d,parentContainer:c}},m.prototype.unloadForm=function(a){a.find(".orgchart-input-email").length&&d.removeField(a.find(".orgchart-input-email")),a.replaceWith(this.buildAddButtons(this.oldAddButtonRelType))},m.prototype.addSearch=function(){var a=this,c=b("#orgchart-search");b("#find-user").show(),d.registerField(c,{completableModels:[d.MODEL_USER],maxResults:6,onSelect:function(b){a.searchedUser={id:b.id,full_name:b.full_name,job_title:"",mugshot_url:l.cdn("assets/images/no_photo_small.gif"),superiors:[{id:b.id}]},c.addClass("help").val(h.t("searching")).attr("disabled",!0),a.selectedUserID=b.id,a.getUser(a.apiURL+"?user_id="+b.id,!0),jQuery.colorbox.close(),c.removeClass("help").val("").attr("disabled",!1)}})},m.prototype.buildForms=function(a){for(var b={},d=0,e=a.length;e>d;d++)b[a[d]]="<form class='orgchart-add-user-form' action='"+this.apiURL+"' method='post'><input id='add-"+a[d]+"-input' class='orgchart-input-email' type='text' label='email' name='"+a[d]+"[usernames]' value='"+c.escape(this.DEFAULT_ADD_MESSAGE)+"'/><br/><button type='submit' class='yj-btn  new-small-btn yj-btn-disabled' disabled='true'><span>"+h.t("addinvite")+"</span></button><a href='javascript://' class='orgchart-cancel-form'>"+h.t("cancel_2")+"</a></form>";return b},m.prototype.validateFormFields=function(a,b){if("email"===a){var c=b.replace(/^\s+|\s+$/g,""),d=/^[a-zA-Z0-9\+._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]+$/;return!!d.test(c)}},m.prototype.clear=function(){b(".orgchart-user-container").not(".orgchart-add").remove(),this.orgchartContainer.hide()},m.prototype.setupFirstLast=function(){for(var a=[this.superiorContainer.find(".orgchart-user"),this.userContainer.find(".orgchart-user"),this.subordinateContainer.find(".orgchart-user")],c=0;c<a.length;c++){var d=a[c].length-2;b(a[c][0]).addClass("first"),b(a[c][d]).addClass("last")}},m.prototype.addConnectors=function(){var a,c,d=this.superiorContainer.find(".orgchart-user"),e=this.userContainer.find(".orgchart-user"),f=this.subordinateContainer.find(".orgchart-user");for(a=0;a<d.length;a++)1==d.length&&e.length>0&&b(d[a]).parent().addClass("connector-4 right-connector");for(a=0;a<e.length;a++)c=b(e[a]).parent(),1===e.length&&d.length>0&&(f.length>0?c.addClass("connector-middle-1"):c.addClass("connector-4")),1===e.length&&f.length>0&&c.addClass("connector-middle-3"),e.length>1&&d.length>0&&0===a&&(f.length>0?c.addClass("connector-middle-2"):c.addClass("connector-3")),e.length>1&&a!=e.length-1&&c.addClass("connector-1"),e.length>1&&a===e.length-1&&c.addClass("connector-2"),e.length>1&&0===a&&0===d.length&&(f.length>0?c.addClass("connector-middle-2"):c.addClass("connector-3"));for(a=0;a<f.length;a++)c=b(f[a]).parent(),1===f.length&&c.addClass("connector-4"),f.length>1&&f.length!=f.length-1&&0===a&&c.addClass("connector-3"),f.length>0&&a!=f.length-1&&c.addClass("connector-1"),f.length>0&&a===f.length-1&&c.addClass("connector-2")},m}),define("workfeed/lib/widget/configure",[],function(){"use strict";function a(a,b){"open-graph"===a.val()?b.show():b.hide()}function b(b,c){a(b,c),b.change(a)}return{initializeToggle:b}}),define("workfeed/lib/widget/widget_log",[],function(){"use strict";function a(){console&&"function"==typeof console.log&&(yam.on("all",function(a){console.log("========>>> yam.all =>",a,(new Date).getTime())}),yam.on("error",function(a){console.error("======>>> yam.error =>",JSON.stringify(a))}))}return{initialize:a}}),define("workfeed/lib/widget/widget",["require","workfeed/lib/widget/configure","workfeed/lib/widget/widget_log"],function(a){"use strict";function b(a){yam.connect.embedFeed(a),e.initialize()}function c(a,c,e){b(a),d.initializeToggle(c,e)}var d=a("workfeed/lib/widget/configure"),e=a("workfeed/lib/widget/widget_log");return{displayEmbedFeed:b,displayConfigurePage:c}}),define("workfeed/lib/app/app_directory_oauth_dialog_view",["require","underscore","core/lib/tr"],function(a){function b(a,b){c.each(a,function(a){var e,f=$(a),g=f.data("translation-key"),h={},i={},j="";switch(g){case"connect_appname_by_author_app_network_to_yammer_account":case"connect_appname_by_author_to_yammer_account":h={appNameLink:'<a href="'+b.appUrl+'" target="_blank" rel="noreferrer">'+b.appName+"</a>",appAuthorLink:'<a href="'+b.appUrl+'" target="_blank" rel="noreferrer">'+b.appAuthor+"</a>"};break;case"by_proceeding_you_agree_to_terms_of_service":h={link:'<a href="'+b.appTermsOfServiceUrl+'" target="_blank">{$0}</a>'};break;case"by_proceeding_you_agree_to_terms_of_service_and_privacy_policy":h={link1:'<a href="'+b.appTermsOfServiceUrl+'" target="_blank">{$0}</a>',link2:'<a href="'+b.appPrivacyPolicyUrl+'" target="_blank">{$0}</a>'};break;case"your_credentials_will_be_forwarded_to_appname":case"your_credentials_will_be_forwarded_to_appname_on_the_domain_network":h={appNameCallbackLink:'<a href="'+b.appCallbackUrl+'" target="_blank" rel="noreferrer">'+b.appName+"</a>"};break;case"appname_by_author_network":h={byAppAuthorNetworkLink:'<a href="'+b.appUrl+'" target="_blank" rel="noreferrer">'+b.appAuthor+"</a> ("+b.appNetworkDomain+")</span>"},j=d.t(g,h),e=b.appNameLink+'<br/><span class="app-author">'+j+"</span>";break;case"appname_by_author":h={byAppAuthorLink:'<a href="'+b.appUrl+'" target="_blank" rel="noreferrer">'+b.appAuthor+"</a></span>"},j=d.t(g,h),e=b.appNameLink+'<br/><span class="app-author">'+j+"</span>"}i=c.extend(b,h),e=e||d.t(g,i),f.html(e)})}var c=a("underscore"),d=a("core/lib/tr");return{translate:b}}),/*
 *	jQuery dotdotdot 1.7.0
 *
 *	Copyright (c) Fred Heusschen
 *	www.frebsite.nl
 *
 *	Plugin website:
 *	dotdotdot.frebsite.nl
 *
 *	Licensed under the MIT license.
 *	http://en.wikipedia.org/wiki/MIT_License
 */
function(a,b){function c(a,b,c){var d=a.children(),e=!1;a.empty();for(var g=0,h=d.length;h>g;g++){var i=d.eq(g);if(a.append(i),c&&a.append(c),f(a,b)){i.remove(),e=!0;break}c&&c.detach()}return e}function d(b,c,g,h,i){var j=!1,k="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",l="script, .dotdotdot-keep";return b.contents().detach().each(function(){var m=this,n=a(m);if("undefined"==typeof m||3==m.nodeType&&0==a.trim(m.data).length)return!0;if(n.is(l))b.append(n);else{if(j)return!0;b.append(n),i&&b[b.is(k)?"after":"append"](i),f(g,h)&&(j=3==m.nodeType?e(n,c,g,h,i):d(n,c,g,h,i),j||(n.detach(),j=!0)),j||i&&i.detach()}}),j}function e(b,c,d,e,h){var k=b[0];if(!k)return!1;var m=j(k),n=-1!==m.indexOf(" ")?" ":"　",o="letter"==e.wrap?"":n,p=m.split(o),q=-1,r=-1,s=0,t=p.length-1;for(e.fallbackToLetter&&0==s&&0==t&&(o="",p=m.split(o),t=p.length-1);t>=s&&(0!=s||0!=t);){var u=Math.floor((s+t)/2);if(u==r)break;r=u,i(k,p.slice(0,r+1).join(o)+e.ellipsis),f(d,e)?(t=r,e.fallbackToLetter&&0==s&&0==t&&(o="",p=p[0].split(o),q=-1,r=-1,s=0,t=p.length-1)):(q=r,s=r)}if(-1==q||1==p.length&&0==p[0].length){var v=b.parent();b.detach();var w=h&&h.closest(v).length?h.length:0;v.contents().length>w?k=l(v.contents().eq(-1-w),c):(k=l(v,c,!0),w||v.detach()),k&&(m=g(j(k),e),i(k,m),w&&h&&a(k).parent().append(h))}else m=g(p.slice(0,q+1).join(o),e),i(k,m);return!0}function f(a,b){return a.innerHeight()>b.maxHeight}function g(b,c){for(;a.inArray(b.slice(-1),c.lastCharacter.remove)>-1;)b=b.slice(0,-1);return a.inArray(b.slice(-1),c.lastCharacter.noEllipsis)<0&&(b+=c.ellipsis),b}function h(a){return{width:a.innerWidth(),height:a.innerHeight()}}function i(a,b){a.innerText?a.innerText=b:a.nodeValue?a.nodeValue=b:a.textContent&&(a.textContent=b)}function j(a){return a.innerText?a.innerText:a.nodeValue?a.nodeValue:a.textContent?a.textContent:""}function k(a){do a=a.previousSibling;while(a&&1!==a.nodeType&&3!==a.nodeType);return a}function l(b,c,d){var e,f=b&&b[0];if(f){if(!d){if(3===f.nodeType)return f;if(a.trim(b.text()))return l(b.contents().last(),c)}for(e=k(f);!e;){if(b=b.parent(),b.is(c)||!b.length)return!1;e=k(b[0])}if(e)return l(a(e),c)}return!1}function m(b,c){return b?"string"==typeof b?(b=a(b,c),b.length?b:!1):b.jquery?b:!1:!1}function n(a){for(var b=a.innerHeight(),c=["paddingTop","paddingBottom"],d=0,e=c.length;e>d;d++){var f=parseInt(a.css(c[d]),10);isNaN(f)&&(f=0),b-=f}return b}if(!a.fn.dotdotdot){a.fn.dotdotdot=function(b){if(0==this.length)return a.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){a(this).dotdotdot(b)});var e=this;e.data("dotdotdot")&&e.trigger("destroy.dot"),e.data("dotdotdot-style",e.attr("style")||""),e.css("word-wrap","break-word"),"nowrap"===e.css("white-space")&&e.css("white-space","normal"),e.bind_events=function(){return e.bind("update.dot",function(b,h){b.preventDefault(),b.stopPropagation(),i.maxHeight="number"==typeof i.height?i.height:n(e),i.maxHeight+=i.tolerance,"undefined"!=typeof h&&(("string"==typeof h||h instanceof HTMLElement)&&(h=a("<div />").append(h).contents()),h instanceof a&&(g=h)),p=e.wrapInner('<div class="dotdotdot" />').children(),p.contents().detach().end().append(g.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var k=!1,l=!1;return j.afterElement&&(k=j.afterElement.clone(!0),k.show(),j.afterElement.detach()),f(p,i)&&(l="children"==i.wrap?c(p,i,k):d(p,e,p,i,k)),p.replaceWith(p.contents()),p=null,a.isFunction(i.callback)&&i.callback.call(e[0],l,g),j.isTruncated=l,l}).bind("isTruncated.dot",function(a,b){return a.preventDefault(),a.stopPropagation(),"function"==typeof b&&b.call(e[0],j.isTruncated),j.isTruncated}).bind("originalContent.dot",function(a,b){return a.preventDefault(),a.stopPropagation(),"function"==typeof b&&b.call(e[0],g),g}).bind("destroy.dot",function(a){a.preventDefault(),a.stopPropagation(),e.unwatch().unbind_events().contents().detach().end().append(g).attr("style",e.data("dotdotdot-style")||"").data("dotdotdot",!1)}),e},e.unbind_events=function(){return e.unbind(".dot"),e},e.watch=function(){if(e.unwatch(),"window"==i.watch){var b=a(window),c=b.width(),d=b.height();b.bind("resize.dot"+j.dotId,function(){c==b.width()&&d==b.height()&&i.windowResizeFix||(c=b.width(),d=b.height(),l&&clearInterval(l),l=setTimeout(function(){e.trigger("update.dot")},100))})}else k=h(e),l=setInterval(function(){if(e.is(":visible")){var a=h(e);k.width==a.width&&k.height==a.height||(e.trigger("update.dot"),k=a)}},500);return e},e.unwatch=function(){return a(window).unbind("resize.dot"+j.dotId),l&&clearInterval(l),e};var g=e.contents(),i=a.extend(!0,{},a.fn.dotdotdot.defaults,b),j={},k={},l=null,p=null;return i.lastCharacter.remove instanceof Array||(i.lastCharacter.remove=a.fn.dotdotdot.defaultArrays.lastCharacter.remove),i.lastCharacter.noEllipsis instanceof Array||(i.lastCharacter.noEllipsis=a.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),j.afterElement=m(i.after,e),j.isTruncated=!1,j.dotId=o++,e.data("dotdotdot",!0).bind_events().trigger("update.dot"),i.watch&&e.watch(),e},a.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},a.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}},a.fn.dotdotdot.debug=function(a){};var o=1,p=a.fn.html;a.fn.html=function(c){return c!=b&&!a.isFunction(c)&&this.data("dotdotdot")?this.trigger("update",[c]):p.apply(this,arguments)};var q=a.fn.text;a.fn.text=function(c){return c!=b&&!a.isFunction(c)&&this.data("dotdotdot")?(c=a("<div />").text(c).html(),this.trigger("update",[c])):q.apply(this,arguments)}}}(jQuery),define("jquery-dotdotdot",function(){}),define("workfeed/lib/app/paragraph_expander",["require","jquery","core/lib/ctor","jquery-dotdotdot"],function(a){var b=a("jquery"),c=a("core/lib/ctor");return a("jquery-dotdotdot"),c("yam.workfeed.appDirectory.ParagraphExpander",{originalHeightAttributeName:"data-original-height",truncationPluginConfig:{wrap:"letter"},init:function(a){this.options=a},attach:function(){if(this.options.paragraphSelector){var a=this;b(this.options.paragraphSelector).each(function(c,d){d.scrollHeight>d.clientHeight&&(b(this).dotdotdot(a.truncationPluginConfig),a.options.moreLinkSelector&&(a.$moreLink=b(this).siblings(a.options.moreLinkSelector),a.$moreLink.show(),a.$moreLink.click(a._onMoreLinkClicked.bind(a))),a.options.lessLinkSelector&&(a.$lessLink=b(this).siblings(a.options.lessLinkSelector),a.$lessLink.click(a._onLessLinkClicked.bind(a))))})}},_getScrollHeight:function(a){return a[0].scrollHeight},_getOriginalHeight:function(a){return a.attr(this.originalHeightAttributeName)},_setOriginalHeight:function(a,b){a.attr(this.originalHeightAttributeName,b.toString())},_onMoreLinkClicked:function(a){var c=b(a.delegateTarget),d=c.siblings(this.options.paragraphSelector),e=c.siblings(this.options.lessLinkSelector);d.length&&e.length&&(d.trigger("destroy.dot"),this._setOriginalHeight(d,d.height()),d.css("height",this._getScrollHeight(d)),c.hide(),e.show())},_onLessLinkClicked:function(a){var c=b(a.delegateTarget),d=c.siblings(this.options.paragraphSelector),e=c.siblings(this.options.moreLinkSelector);d.length&&e.length&&(d.css("height",this._getOriginalHeight(d)),d.dotdotdot(this.truncationPluginConfig),c.hide(),e.show())}})}),define("workfeed/lib/legacy_bridge",["require","jquery","underscore","backbone","common-ui/lib/helper/svg_icon","common-ui/lib/helper/ui","common-ui/lib/ui/general/flash_alert","common-ui/lib/ui/general/lightbox_manager","common-ui/lib/ui/groups/group_description_editor","common-ui/lib/ui/groups/group_search","common-ui/lib/ui/groups/member_list","common-ui/lib/ui/shared/task_list","common-ui/lib/ui/shared/type_ahead","common-ui/lib/ui/shared/type_ahead_tag_list_add_members","components/admin/src/private_content_mode","components/avatar/index","components/network_label/src/network_label","core/lib/date_helper","core/lib/filename_helper","core/lib/location_helper","core/lib/log","core/lib/namespace","core/lib/report","core/lib/secure_opener","core/lib/session","core/lib/string_helper","core/lib/tr","core/lib/treatment","core/lib/yammer_api","core/lib/yammer_bootstrap_utils","core/lib/yammer_request","core/lib/yammer_uri","feeds/lib/ui/attachments/content_topics","feeds/lib/ui/attachments/yamio_preview","feeds/lib/ui/files/image_selector","feeds/lib/ui/files/pages_files_selector","feeds/lib/ui/files/selector","feeds/lib/ui/files/video_selector","feeds/lib/ui/publisher/global/publisher_helper","collections/content_relationships","models/group","models/message_backbone","models/recipient","models/helpers/group","models/user","models/topic","mustache","platform-embed/lib/connect/embed_action","workfeed/lib/admin/color_preview","workfeed/lib/app/app_directory_carousel","workfeed/lib/app/app_directory_lightbox","workfeed/lib/app/app_directory_oauth_dialog","workfeed/lib/app/app_directory_tabs","workfeed/lib/app/app_request_form","workfeed/lib/app/controllers/file_controller","workfeed/lib/app/experiment_editor","workfeed/lib/app/form_helper","workfeed/lib/app/forms","workfeed/lib/app/register_new_app_form","workfeed/lib/app/sidebar/related_contents","workfeed/lib/app/tooltip_attacher","workfeed/lib/app/views/network_security_configurations/add_ip_range","workfeed/lib/app/views/network_security_configurations/etr_last_sync_check","workfeed/lib/app/views/network_security_configurations/office_authentication","workfeed/lib/app/views/top_spammers/index","workfeed/lib/modules/character_counter","workfeed/lib/modules/company_resources_list","workfeed/lib/modules/file_uploader","workfeed/lib/modules/group_inviter","workfeed/lib/modules/quick_links","workfeed/lib/modules/related_content","workfeed/lib/modules/signup_group_suggestions","workfeed/lib/orgchart","models/helpers/user","workfeed/lib/widget/widget","workfeed/lib/app/app_directory_oauth_dialog_view","core/lib/ajax_form","feeds/lib/modules/attachments","workfeed/lib/app/paragraph_expander","workfeed/lib/modules/tab_arranger"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("backbone"),e=a("common-ui/lib/helper/svg_icon"),f=a("common-ui/lib/helper/ui"),g=a("common-ui/lib/ui/general/flash_alert"),h=a("common-ui/lib/ui/general/lightbox_manager"),i=a("common-ui/lib/ui/groups/group_description_editor"),j=a("common-ui/lib/ui/groups/group_search"),k=a("common-ui/lib/ui/groups/member_list"),l=a("common-ui/lib/ui/shared/task_list"),m=a("common-ui/lib/ui/shared/type_ahead"),n=a("common-ui/lib/ui/shared/type_ahead_tag_list_add_members"),o=a("components/admin/src/private_content_mode"),p=a("components/avatar/index"),q=a("components/network_label/src/network_label"),r=a("core/lib/date_helper"),s=a("core/lib/filename_helper"),t=a("core/lib/location_helper"),u=a("core/lib/log"),v=a("core/lib/namespace"),w=a("core/lib/report"),x=a("core/lib/secure_opener"),y=a("core/lib/session"),z=a("core/lib/string_helper"),A=a("core/lib/tr"),B=a("core/lib/treatment"),C=a("core/lib/yammer_api"),D=a("core/lib/yammer_bootstrap_utils"),E=a("core/lib/yammer_request"),F=a("core/lib/yammer_uri"),G=a("feeds/lib/ui/attachments/content_topics"),H=a("feeds/lib/ui/attachments/yamio_preview"),I=a("feeds/lib/ui/files/image_selector"),J=a("feeds/lib/ui/files/pages_files_selector"),K=a("feeds/lib/ui/files/selector"),L=a("feeds/lib/ui/files/video_selector"),M=a("feeds/lib/ui/publisher/global/publisher_helper"),N=a("collections/content_relationships"),O=a("models/group"),P=a("models/message_backbone"),Q=a("models/recipient"),R=a("models/helpers/group"),S=a("models/user"),T=a("models/topic"),U=a("mustache"),V=a("platform-embed/lib/connect/embed_action"),W=a("workfeed/lib/admin/color_preview"),X=a("workfeed/lib/app/app_directory_carousel"),Y=a("workfeed/lib/app/app_directory_lightbox"),Z=a("workfeed/lib/app/app_directory_oauth_dialog"),$=a("workfeed/lib/app/app_directory_tabs"),_=a("workfeed/lib/app/app_request_form"),aa=a("workfeed/lib/app/controllers/file_controller"),ba=a("workfeed/lib/app/experiment_editor"),ca=a("workfeed/lib/app/form_helper"),da=a("workfeed/lib/app/forms"),ea=a("workfeed/lib/app/register_new_app_form"),fa=a("workfeed/lib/app/sidebar/related_contents"),ga=a("workfeed/lib/app/tooltip_attacher"),ha=a("workfeed/lib/app/views/network_security_configurations/add_ip_range"),ia=a("workfeed/lib/app/views/network_security_configurations/etr_last_sync_check"),ja=a("workfeed/lib/app/views/network_security_configurations/office_authentication"),ka=a("workfeed/lib/app/views/top_spammers/index"),la=a("workfeed/lib/modules/character_counter"),ma=a("workfeed/lib/modules/company_resources_list"),na=a("workfeed/lib/modules/file_uploader"),oa=a("workfeed/lib/modules/group_inviter"),pa=a("workfeed/lib/modules/quick_links"),qa=a("workfeed/lib/modules/related_content"),ra=a("workfeed/lib/modules/signup_group_suggestions"),sa=a("workfeed/lib/orgchart"),ta=a("models/helpers/user"),ua=a("workfeed/lib/widget/widget"),va=a("workfeed/lib/app/app_directory_oauth_dialog_view");a("core/lib/ajax_form"),a("feeds/lib/modules/attachments"),a("workfeed/lib/app/paragraph_expander"),a("workfeed/lib/modules/tab_arranger");var wa={emailImportController:[b,d],activityStreamKeys:[b,A],accountsNotificationOptionsForFeed:[b,E,C,d,A],accountsPasswordForm:[da],accountsOrgChart:[b,sa,y],accountsBasics:[na,D],accountsNotifications:[b,v,O,q],accountsProfileInfoForm:[b,D],adminCustomizeNetworkForm:[na,W],adminUsagePolicy:[b,la,A],adminBlockedEmailAddresses:[b,E],adminBulkImportStatus:[b,u],adminPrivateContentMode:[b,o],adminSetAdmins:[b,p,S,ta,A,m,C,d,r],adminTopSpammers:[b,ka],adminUsers:[b,p,S,ta,A,m,C,r],analyticsStats:[b,c],appRequestsForm:[b,c,ga,_],bouncedEmailsIndex:[b,E],clientApplicationsActionType:[b,ca,A],clientApplicationsForm:[na],clientApplicationsFormAppStoreConfig:[na],clientApplicationsNav:[b,h,ea,A],clientApplicationsEdit:[b,c,na,ga],clientApplicationsObjectType:[b,ca,A],clientApplicationsIndex:[b,h,ea,A],clientApplicationsAppDirectoryConfig:[b,c,na,ga],clientApplicationsShow:[ga],clientApplicationsOpenGraph:[b,c,ga],commonAppsDirectory:[b,h,Y,d,A,v,X,$,Z],commonFollowLinks:[b],commonFollowersSidebar:[b,w],commonFollowersSidebarItem:[b,c,p,F],commonRelatedContent:[b,w,qa],commonRelatedContent2:[b,B,s,e],commonRelatedContentRR:[b,w,R,N,fa],commonReportAction:[b,w],commonShareLinks:[b,M],developerToolsExperimentsIndex:[b,ba],dialogsOauth:[b,va],directorySyncEmailSettingsEdit:[b],emailImportLightbox:[b,U,A,d,v],groupsAddMembers:[n,h],groupsAddMembers2:[b,w],groupsBasics:[b,i],groupsForeignBasics:[b,pa],groupsGroupThumbnails:[d,na,D],groupsListTr:[b,c,p,F,q,O,A],groupsLocalGroupHeader:[b,w,j,E,F,u],groupsOfficialContentModule:[b,A,E,F,d],groupsProfileSidebar:[b,h,k,d,B],homeCompanyResourcesModule:[b,ma],homeGettingStarted:[l],homeSidebarInvite:[b,m,da,A,y,w],homeInvitationsReinviteAllLightbox:[b,z],layoutsSidebarFooter:[b,f],layoutsModal:[b,g],layoutsNavMenuAccountList:[b,w],loginFormPage:[b,A],monitorList:[b,A],newUserLogin:[b,A],newUserForgottenPasswordLogin:[b,A],networkSecurityConfigurationsEditForm:[b,A,ia,ha,ja],networksForm:[na],notificationsIndex:[b,F,d,A,y,p],openGraphObjectsProfileSidebar:[b,A,E,d],platformEmbedButton:[V],searchPages:[b,A,d],searchPraises:[b,A,d],searchSidebar:[b,A,y,z,m],searchUploadedFiles:[b,A,d],searchUsers:[b,p],signupCoWorkers:[oa],signupTracking:[w],signupAddPhoto:[b,w,na],signupCompleteSignup:[b],signupCompleteSignup2:[b,D],signupCompleteSignup3:[b,A],signupCompleteSignup4:[b,w],signupJoinGroups:[w,ra],signupMobileSignupForm:[w],signupOrgChart:[b,w,ca,oa,m],topicHeader:[b,T,q],topicsProfileSidebar:[b,w],uploadedFilesBasics:[b,S,q,A],uploadedFilesBasicsForeignFile:[b,S,q,A],uploadedFilesContent:[b,d,G,H,aa],uploadedFilesContent2:[b,B,s,e],uploadedFilesDirectory:[b,I,L,J,K],uploadedFilesProfileSidebar:[b,A,E,d],uploadedFilesProfileSidebar2:[b,x,A],usagePoliciesShow:[b,t,d,D,E,F],usagePoliciesTask:[b,d,D,E],usersBasics:[b,c,S,P,Q,M,p,y,e],usersBasicsForeignUser:[b,c,S,P,Q,M,p,y],usersBouncedActionLinks:[b,E],usersShowPending:[b],usersSuspendConfirm:[b,d],widgetPage:[b,ua]};window.yam=window.yam||{},window.yam.legacyBridge=c.reduce(wa,function(a,b,c){return a[c]=function(a){a.apply(null,b)},a},{})}),define("css!requirejs/lib/yam-requirejs-base",[],function(){}),define("core/lib/yammer_bootstrap",["require","jquery","underscore","core/lib/location_helper","core/lib/cookie_helper","core/lib/yammer_request","core/lib/yammer_api","core/lib/yammer_uri","core/lib/util/authenticity_token","core/lib/yammer_bootstrap_utils"],function(a){"use strict";var b=a("jquery"),c=a("underscore"),d=a("core/lib/location_helper"),e=a("core/lib/cookie_helper"),f=a("core/lib/yammer_request"),g=a("core/lib/yammer_api"),h=a("core/lib/yammer_uri"),i=a("core/lib/util/authenticity_token"),j=a("core/lib/yammer_bootstrap_utils"),k=c.memoize(function(){var a=b.Deferred(),c={with_csrf_token:!0};return g.getTokens(c).done(function(b){a.resolve(b)}).fail(function(b){a.reject("Error fetching tokens: "+b.responseText)}),a.promise()}),l=c.memoize(function(){var a=b.Deferred(),c={include_suspended:!0,include_masthead_info:!0,with_sidebar_info:!0};return g.getNetworks(c).done(function(b){a.resolve(b)}).fail(function(b){a.reject("Error fetching networks: "+b.responseText)}),a.promise()}),m=c.memoize(function(){var a=b.Deferred(),c={with_prefs:!0,with_attachments:!0,with_treatments:!0,with_client_apps:!0,with_oauth_access_token:!0,include_group_memberships:!0,with_sidebar_info:!0};return g.getCurrentUser(c).done(function(b){a.resolve(b)}).fail(function(b){a.reject("Error fetching user: "+b.responseText)}),a.promise()}),n=c.memoize(function(){var a=b.Deferred();return g.getUsagePolicy().done(function(b){a.resolve(b)}).fail(function(b){a.reject("Error fetching usage policy:",b.responseText)}),a.promise()}),o=c.memoize(function(){var a=b.Deferred(),d=e.get("oauth_token");return c.isString(d)&&d.length?a.resolve(d):a.reject("No token from cookie"),a.promise()}),p=function(a){var d=b.Deferred();return c.isString(a)&&a.length?(i.set(a),d.resolve(a)):d.reject("No CSRF token specified"),d.promise()},q=function(a){var d=b.Deferred();return c.isString(a)&&a.length?(f.setAuthenticator("oauth2").setAuthToken(a),d.resolve(a)):d.reject("No OAuth token specified"),d.promise()},r=function(a,c,d){var e=b.Deferred();return a&&c&&d?a.user_id!=c.id||a.network_id!=d.id?e.reject("Policy did not match current user and network"):(d.usage_policy=a,e.resolve(a)):e.reject("Could not verify usage policy"),e.promise()},s=function(a){var c=b.Deferred();return a?(e.set({name:"last_network",value:a.permalink,days:365}),e.set({name:"return_to",value:"/"+a.permalink+"/",days:365}),c.resolve(a)):c.reject("No network"),c.promise()},t=c.memoize(function(){return k()}),u=c.memoize(function(){return l()}),v=c.memoize(function(a){var d=b.Deferred(),e=d.promise();return a?(u().done(function(a){var b=c.find(a,function(a){return h.isHomeLocation(a)});b?d.resolve(b):d.reject("No network for current URL")}).fail(function(a){d.reject(a)}),e):(d.reject("No location specified"),e)}),w=function(){return v(d.href())},x=c.memoize(function(a){var c=b.Deferred(),d=c.promise();return a?(m(a).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),d):(c.reject("No network specified"),d)}),y=c.memoize(function(a){return v(a).then(x)}),z=function(){return y(d.href())},A=c.memoize(function(a){var d=b.Deferred(),e=d.promise();return a?(t().done(function(b){var e=c.find(b,function(b){return b.network_id===a.id});e?d.resolve(e):d.reject("No token for network")}).fail(function(a){d.reject(a)}),e):(d.reject("No network specified"),e)}),B=c.memoize(function(a){return v(a).then(A)}),C=function(){var a=b.Deferred();return E().then(function(b){a.resolve(b.csrf)}).fail(function(b){a.reject(b)}),a.promise()},D=function(){var a=b.Deferred();return E().then(function(b){a.resolve(b.token)}).fail(function(b){a.reject(b)}),a.promise()},E=function(){return B(d.href())},F=function(){return k.cache={},l.cache={},m.cache={},n.cache={},o.cache={},t.cache={},u.cache={},v.cache={},x.cache={},y.cache={},A.cache={},B.cache={},b.Deferred().resolve().promise()},G=function(){return j.clearLocalStorage().then(j.clearStaticCookies)},H=function(){return d.assign(d.href().replace(new RegExp("(https?://[^/]+).*"),"$1/login")),b.Deferred().resolve().promise()},I=function(){return b.Deferred().resolve().promise()},J=function(){var a=arguments;return function(){var d=arguments;return b.when.apply(b,c.map(a,function(a){return a.apply(null,d)}))}},K=function(){var a=arguments;return function(){return c.reduce(a,function(a,b){return a.then(b)},b.Deferred().resolve().promise())}},L=function(a){return function(){var c=b.Deferred(),d=c.promise();return setTimeout(function(){c.resolve()},a),d}},M=function(a,b){var c=function(a){return function(){return F().then(a)}},d=function(){return o().then(q).then(I).then(J(t,u)).then(C).then(p).then(D).then(q).then(I).then(J(n,z,w)).then(r).then(I).then(J(z,w,u)).then(a).then(w).then(s).then(null,b)},e=function(){d().then(null,c(f))},f=function(){return d().then(null,K(G,H))};e()};return{fetchTokens:k,fetchNetworks:l,fetchUserForNetwork:m,getTokenFromCookie:o,getTokens:t,getNetworks:u,getNetworkForLocation:v,getNetworkForCurrentLocation:w,getUserForNetwork:x,getUserForLocation:y,getUserForCurrentLocation:z,getTokenForNetwork:A,getTokenForLocation:B,getTokenForCurrentLocation:E,setCsrfToken:p,setLastNetwork:s,setTokenOnRequest:q,setUsagePolicy:r,clearMemoization:F,clearForLogout:G,logout:H,inParallel:J,inSequence:K,delay:L,run:M}}),require(["core/lib/yammer_request","core/lib/error_handler","core/lib/secure_opener","workfeed/lib/app/bundles/token_bundle","workfeed/lib/app/bundles/resource_bundle","workfeed/lib/app/bundles/model_bundle","workfeed/lib/app/bundles/global_ui_bundle","workfeed/lib/app/bundles/header_bundle","workfeed/lib/app/bundles/nav_menu_bundle","workfeed/lib/app/bundles/app_bundle","workfeed/lib/app/bundles/home_bundle","workfeed/lib/app/bundles/chat_bundle","workfeed/lib/app/bundles/suite_nav_bundle","workfeed/lib/app/bundles/banners_bundle","workfeed/lib/legacy_bridge","css!requirejs/lib/yam-requirejs-base","common-ui/lib/ui/groups/group_description_editor","core/lib/yammer_bootstrap"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";yam.ready.initialize(function(a){d.run(a),b.toggleReporting(),c.handleLinks(),e.run(a),f.run(a.currentUser,a.currentNetwork,a.allNetworks),n.run(a.currentUser),h.run(),j.run(a.defaultRoute),g.run(),i.run(),k.run(),l.run(),m.run(a.polarisHost)})}),define("requirejs/lib/yam-requirejs-home-main",function(){}),require.config({logLevel:1,paths:{core:"core",models:"models",collections:"collections","common-ui":"common-ui",feeds:"feeds",workfeed:"workfeed","paddie-client":"paddie-client","platform-embed":"platform-embed",yamkit:"yamkit",components:"components",jquery:"core/lib/adapters/requirejs_jquery_adapter","jquery-deparam":"node_modules/jquery-deparam/jquery-deparam","jquery-migrate":"node_modules/jquery-migrate/dist/jquery-migrate","jquery-datepicker":"node_modules/eyecon-datepicker/js/jquery.datepicker-2009.05.22","jquery-dotdotdot":"node_modules/dotdotdot/src/js/jquery.dotdotdot","jquery-dragsort":"node_modules/dragsort/jquery.dragsort","jquery-truncate":"node_modules/truncate/jquery.truncate","jquery-typeahead":"node_modules/typeahead/dist/jquery.typeahead.min","jquery-watermark":"node_modules/jquery-watermark/jquery.watermark","jquery-ujs":"node_modules/jquery-ujs/src/rails",velocity:"node_modules/velocity-animate/velocity","org/cometd":"node_modules/cometd-jquery/org/cometd","jquery-cometd":"node_modules/cometd-jquery/jquery/jquery.cometd",underscore:"node_modules/underscore/underscore",backbone:"node_modules/backbone/backbone",mustache:"node_modules/mustache/mustache",rosettajs:"node_modules/rosettajs/build/rosetta","backbone-component":"node_modules/backbone-component/backbone-component",imagesloaded:"node_modules/imagesloaded/imagesloaded.pkgd",normalize:"node_modules/require-css/normalize",colorbox:"vendor/lib/colorbox-1.3.15",plupload:"vendor/lib/plupload-2.1.6","socket.io":"vendor/lib/socket.io-0.9.10",store:"node_modules/store/store",emojione:"node_modules/emojione/lib/js/emojione","resig-class":"node_modules/resig_class/class",triejs:"node_modules/triejs/src/trie",svg4everybody:"node_modules/svg4everybody/dist/svg4everybody","squire-rte":"node_modules/squire-rte/build/squire-raw",text:"node_modules/requirejs-text/text",json:"node_modules/requirejs-json/json",css:"node_modules/require-css/css","css-builder":"node_modules/require-css/css-builder",stache:"node_modules/requirejs-mustache/stache",requirejs:"requirejs"},map:{"*":{html:"stache",Backbone:"backbone"}},shim:{"jquery-watermark":{deps:["jquery"],init:function(a){return a.watermark.options.className="yj-watermark",a.watermark.options.useNative=!0,a.watermark.options.hideBeforeUnload=!1,a.watermark}},"jquery-ujs":{deps:["jquery"]},emojione:{init:function(){return this.emojione.imagePathPNG="/assets/images/emojione/png/",this.emojione.cacheBustParam="",this.emojione}}},stache:{extension:".html"},separateCSS:!0,pragmasOnSave:{excludeRequireCss:!0}}),define("requirejs_config",function(){});